ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.699863851070404, "acc": 0.5224924087524414, "length": 3.5357422828674316, "mode": "train", "epoch": 1}
{"loss": 0.6945317387580872, "acc": 0.4902343451976776, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.692642331123352, "acc": 0.5213200449943542, "length": 3.479292154312134, "mode": "train", "epoch": 2}
{"loss": 0.6958850622177124, "acc": 0.49863284826278687, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6911637187004089, "acc": 0.5194109678268433, "length": 3.446117877960205, "mode": "train", "epoch": 3}
{"loss": 0.6945415139198303, "acc": 0.4863280951976776, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6900280117988586, "acc": 0.5321230292320251, "length": 3.3773107528686523, "mode": "train", "epoch": 4}
{"loss": 0.6947715878486633, "acc": 0.49277350306510925, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6882858872413635, "acc": 0.5431297421455383, "length": 3.280395984649658, "mode": "train", "epoch": 5}
{"loss": 0.691702663898468, "acc": 0.5289855599403381, "length": 1.14453125, "mode": "test", "epoch": 5}
{"loss": 0.6842132210731506, "acc": 0.5596970915794373, "length": 3.089961528778076, "mode": "train", "epoch": 6}
{"loss": 0.6800144910812378, "acc": 0.5823348760604858, "length": 1.59765625, "mode": "test", "epoch": 6}
{"loss": 0.6758696436882019, "acc": 0.5905164480209351, "length": 2.9644200801849365, "mode": "train", "epoch": 7}
{"loss": 0.6565439701080322, "acc": 0.6530898809432983, "length": 2.390625, "mode": "test", "epoch": 7}
{"loss": 0.6608861088752747, "acc": 0.6422232389450073, "length": 2.979797601699829, "mode": "train", "epoch": 8}
{"loss": 0.6328669786453247, "acc": 0.6871078014373779, "length": 2.82421875, "mode": "test", "epoch": 8}
{"loss": 0.6359273195266724, "acc": 0.6914924383163452, "length": 3.0574517250061035, "mode": "train", "epoch": 9}
{"loss": 0.6038994789123535, "acc": 0.7196334600448608, "length": 3.16015625, "mode": "test", "epoch": 9}
{"loss": 0.6041310429573059, "acc": 0.7079368233680725, "length": 3.1337437629699707, "mode": "train", "epoch": 10}
{"loss": 0.57790207862854, "acc": 0.7257751822471619, "length": 3.38671875, "mode": "test", "epoch": 10}
{"loss": 0.5662468671798706, "acc": 0.7373136281967163, "length": 3.3176586627960205, "mode": "train", "epoch": 11}
{"loss": 0.5463968515396118, "acc": 0.7489257454872131, "length": 3.6484375, "mode": "test", "epoch": 11}
{"loss": 0.5307461619377136, "acc": 0.7620084881782532, "length": 3.4178566932678223, "mode": "train", "epoch": 12}
{"loss": 0.5099384784698486, "acc": 0.7908294200897217, "length": 3.74609375, "mode": "test", "epoch": 12}
{"loss": 0.4903945326805115, "acc": 0.7837799191474915, "length": 3.4778308868408203, "mode": "train", "epoch": 13}
{"loss": 0.480853796005249, "acc": 0.7842788696289062, "length": 3.79296875, "mode": "test", "epoch": 13}
{"loss": 0.44760969281196594, "acc": 0.8025496602058411, "length": 3.6424920558929443, "mode": "train", "epoch": 14}
{"loss": 0.4504651427268982, "acc": 0.7960829734802246, "length": 3.82421875, "mode": "test", "epoch": 14}
{"loss": 0.41368216276168823, "acc": 0.8211466073989868, "length": 3.7530746459960938, "mode": "train", "epoch": 15}
{"loss": 0.4289296269416809, "acc": 0.8162339329719543, "length": 3.87890625, "mode": "test", "epoch": 15}
{"loss": 0.3883097767829895, "acc": 0.8357970118522644, "length": 3.7974369525909424, "mode": "train", "epoch": 16}
{"loss": 0.40883082151412964, "acc": 0.8268982172012329, "length": 3.83203125, "mode": "test", "epoch": 16}
{"loss": 0.3700217306613922, "acc": 0.8450132012367249, "length": 3.7835798263549805, "mode": "train", "epoch": 17}
{"loss": 0.3948230445384979, "acc": 0.8426316380500793, "length": 3.81640625, "mode": "test", "epoch": 17}
{"loss": 0.35177168250083923, "acc": 0.8465912938117981, "length": 3.7977776527404785, "mode": "train", "epoch": 18}
{"loss": 0.37804949283599854, "acc": 0.8400816917419434, "length": 3.87109375, "mode": "test", "epoch": 18}
{"loss": 0.336209774017334, "acc": 0.8551492691040039, "length": 3.812464714050293, "mode": "train", "epoch": 19}
{"loss": 0.3670489490032196, "acc": 0.8498794436454773, "length": 3.9765625, "mode": "test", "epoch": 19}
{"loss": 0.3171672523021698, "acc": 0.8657399415969849, "length": 3.858201026916504, "mode": "train", "epoch": 20}
{"loss": 0.3632699251174927, "acc": 0.8445311784744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.30359557271003723, "acc": 0.8717852234840393, "length": 3.91035532951355, "mode": "train", "epoch": 21}
{"loss": 0.35043367743492126, "acc": 0.8537110686302185, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2951209545135498, "acc": 0.875338613986969, "length": 3.9444522857666016, "mode": "train", "epoch": 22}
{"loss": 0.3573463261127472, "acc": 0.8531249761581421, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2860686779022217, "acc": 0.8750029802322388, "length": 3.9506444931030273, "mode": "train", "epoch": 23}
{"loss": 0.35523608326911926, "acc": 0.8396483659744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.27857714891433716, "acc": 0.8818746209144592, "length": 3.9684133529663086, "mode": "train", "epoch": 24}
{"loss": 0.360626757144928, "acc": 0.8353515267372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.27317172288894653, "acc": 0.8853349089622498, "length": 3.968883991241455, "mode": "train", "epoch": 25}
{"loss": 0.353507399559021, "acc": 0.8490234017372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2677198052406311, "acc": 0.8859648108482361, "length": 3.9735631942749023, "mode": "train", "epoch": 26}
{"loss": 0.3522152006626129, "acc": 0.8498047590255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2659951150417328, "acc": 0.8817929625511169, "length": 3.978410005569458, "mode": "train", "epoch": 27}
{"loss": 0.34006986021995544, "acc": 0.8513671159744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.25945600867271423, "acc": 0.8932695388793945, "length": 3.9816722869873047, "mode": "train", "epoch": 28}
{"loss": 0.3466074764728546, "acc": 0.8476561903953552, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.25712984800338745, "acc": 0.8876858353614807, "length": 3.984525442123413, "mode": "train", "epoch": 29}
{"loss": 0.3397451639175415, "acc": 0.8548827171325684, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2555079758167267, "acc": 0.8923539519309998, "length": 3.9839699268341064, "mode": "train", "epoch": 30}
{"loss": 0.3288576900959015, "acc": 0.8494139909744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.24791426956653595, "acc": 0.894202470779419, "length": 3.9844324588775635, "mode": "train", "epoch": 31}
{"loss": 0.3083876669406891, "acc": 0.8697266578674316, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2506990432739258, "acc": 0.8921294212341309, "length": 3.9847774505615234, "mode": "train", "epoch": 32}
{"loss": 0.3004564940929413, "acc": 0.8642577528953552, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.24397817254066467, "acc": 0.8975769281387329, "length": 3.986637592315674, "mode": "train", "epoch": 33}
{"loss": 0.31427767872810364, "acc": 0.8646484017372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.241533562541008, "acc": 0.900364100933075, "length": 3.987513780593872, "mode": "train", "epoch": 34}
{"loss": 0.30425888299942017, "acc": 0.8689452409744263, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2379458248615265, "acc": 0.8985645771026611, "length": 3.9889795780181885, "mode": "train", "epoch": 35}
{"loss": 0.29510682821273804, "acc": 0.8732422590255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.23564957082271576, "acc": 0.9004926681518555, "length": 3.988250494003296, "mode": "train", "epoch": 36}
{"loss": 0.2777594327926636, "acc": 0.8826171159744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.23807553946971893, "acc": 0.9001777172088623, "length": 3.99070405960083, "mode": "train", "epoch": 37}
{"loss": 0.2856311500072479, "acc": 0.8820313215255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.23410438001155853, "acc": 0.9026252031326294, "length": 3.9919371604919434, "mode": "train", "epoch": 38}
{"loss": 0.2830260396003723, "acc": 0.8853515982627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.22870014607906342, "acc": 0.9049656987190247, "length": 3.9918136596679688, "mode": "train", "epoch": 39}
{"loss": 0.2637820243835449, "acc": 0.8937500715255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2275862842798233, "acc": 0.9080544114112854, "length": 3.99259614944458, "mode": "train", "epoch": 40}
{"loss": 0.26843833923339844, "acc": 0.8939452767372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.22381332516670227, "acc": 0.9085854291915894, "length": 3.9935860633850098, "mode": "train", "epoch": 41}
{"loss": 0.25712481141090393, "acc": 0.9017577767372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.22337865829467773, "acc": 0.9073689579963684, "length": 3.993608236312866, "mode": "train", "epoch": 42}
{"loss": 0.26313406229019165, "acc": 0.8994140625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.22142931818962097, "acc": 0.9091102480888367, "length": 3.994128704071045, "mode": "train", "epoch": 43}
{"loss": 0.25091615319252014, "acc": 0.9048828482627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.22077211737632751, "acc": 0.9107193946838379, "length": 3.995549201965332, "mode": "train", "epoch": 44}
{"loss": 0.2518419921398163, "acc": 0.9011717438697815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2192225456237793, "acc": 0.9118035435676575, "length": 3.9938392639160156, "mode": "train", "epoch": 45}
{"loss": 0.24779874086380005, "acc": 0.8994140028953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.21567168831825256, "acc": 0.9152506589889526, "length": 3.9946134090423584, "mode": "train", "epoch": 46}
{"loss": 0.2446340173482895, "acc": 0.8966797590255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.21581868827342987, "acc": 0.9143818616867065, "length": 3.9939467906951904, "mode": "train", "epoch": 47}
{"loss": 0.23781980574131012, "acc": 0.9029297232627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.20939253270626068, "acc": 0.9186927676200867, "length": 3.9948368072509766, "mode": "train", "epoch": 48}
{"loss": 0.23265540599822998, "acc": 0.9025391340255737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.20489104092121124, "acc": 0.919364869594574, "length": 3.995189666748047, "mode": "train", "epoch": 49}
{"loss": 0.23431521654129028, "acc": 0.9039062261581421, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.20183488726615906, "acc": 0.9201776385307312, "length": 3.996039390563965, "mode": "train", "epoch": 50}
{"loss": 0.2388988733291626, "acc": 0.8996094465255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2036827802658081, "acc": 0.9195120334625244, "length": 3.995579242706299, "mode": "train", "epoch": 51}
{"loss": 0.2311708927154541, "acc": 0.9085936546325684, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.20279811322689056, "acc": 0.9176216721534729, "length": 3.996391534805298, "mode": "train", "epoch": 52}
{"loss": 0.23001310229301453, "acc": 0.9054688215255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1989707499742508, "acc": 0.9190648198127747, "length": 3.997412919998169, "mode": "train", "epoch": 53}
{"loss": 0.23121845722198486, "acc": 0.9037109613418579, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1972426325082779, "acc": 0.9217751026153564, "length": 3.997011423110962, "mode": "train", "epoch": 54}
{"loss": 0.23057374358177185, "acc": 0.9009765982627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.19708837568759918, "acc": 0.9192381501197815, "length": 3.9977195262908936, "mode": "train", "epoch": 55}
{"loss": 0.23396247625350952, "acc": 0.9054688215255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.19715473055839539, "acc": 0.9239968657493591, "length": 3.997666120529175, "mode": "train", "epoch": 56}
{"loss": 0.22964832186698914, "acc": 0.9052734971046448, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.19174480438232422, "acc": 0.9222946166992188, "length": 3.997183322906494, "mode": "train", "epoch": 57}
{"loss": 0.21717393398284912, "acc": 0.9124999642372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.18834498524665833, "acc": 0.9265046715736389, "length": 3.998140335083008, "mode": "train", "epoch": 58}
{"loss": 0.22665554285049438, "acc": 0.9109374284744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1890253871679306, "acc": 0.9257433414459229, "length": 3.9976003170013428, "mode": "train", "epoch": 59}
{"loss": 0.2187301218509674, "acc": 0.9130858778953552, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.18911300599575043, "acc": 0.9244253635406494, "length": 3.998304843902588, "mode": "train", "epoch": 60}
{"loss": 0.22270071506500244, "acc": 0.9130859375, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.855172336101532
