ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6985583901405334, "acc": 0.5051676630973816, "length": 3.5406787395477295, "mode": "train", "epoch": 1}
{"loss": 0.692804217338562, "acc": 0.5187499523162842, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6911813020706177, "acc": 0.534033477306366, "length": 3.4696102142333984, "mode": "train", "epoch": 2}
{"loss": 0.689685583114624, "acc": 0.5365707278251648, "length": 1.00390625, "mode": "test", "epoch": 2}
{"loss": 0.6905975937843323, "acc": 0.5366109609603882, "length": 3.4561209678649902, "mode": "train", "epoch": 3}
{"loss": 0.6870825290679932, "acc": 0.5439925789833069, "length": 1.1953125, "mode": "test", "epoch": 3}
{"loss": 0.6865646243095398, "acc": 0.5400457382202148, "length": 3.3605563640594482, "mode": "train", "epoch": 4}
{"loss": 0.6802104115486145, "acc": 0.585430920124054, "length": 1.59375, "mode": "test", "epoch": 4}
{"loss": 0.6822992563247681, "acc": 0.5654717087745667, "length": 3.238522529602051, "mode": "train", "epoch": 5}
{"loss": 0.6641823053359985, "acc": 0.6461883783340454, "length": 2.76171875, "mode": "test", "epoch": 5}
{"loss": 0.671665370464325, "acc": 0.6087540984153748, "length": 3.2987353801727295, "mode": "train", "epoch": 6}
{"loss": 0.6413177251815796, "acc": 0.7019394636154175, "length": 3.73046875, "mode": "test", "epoch": 6}
{"loss": 0.6455978155136108, "acc": 0.6745433807373047, "length": 3.5718626976013184, "mode": "train", "epoch": 7}
{"loss": 0.6142143607139587, "acc": 0.7121093273162842, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.6089805364608765, "acc": 0.7066370844841003, "length": 3.8117153644561768, "mode": "train", "epoch": 8}
{"loss": 0.58652663230896, "acc": 0.7117186784744263, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5778437852859497, "acc": 0.71197909116745, "length": 3.934434413909912, "mode": "train", "epoch": 9}
{"loss": 0.5811219811439514, "acc": 0.7144531607627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5686637163162231, "acc": 0.7100481986999512, "length": 3.956613540649414, "mode": "train", "epoch": 10}
{"loss": 0.5899178385734558, "acc": 0.6964844465255737, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5671932101249695, "acc": 0.7019035220146179, "length": 3.9619433879852295, "mode": "train", "epoch": 11}
{"loss": 0.5842042565345764, "acc": 0.6941405534744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.5594922304153442, "acc": 0.7141948938369751, "length": 3.957751512527466, "mode": "train", "epoch": 12}
{"loss": 0.5801866054534912, "acc": 0.7052733898162842, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.5549891591072083, "acc": 0.72107994556427, "length": 3.9412388801574707, "mode": "train", "epoch": 13}
{"loss": 0.5643444061279297, "acc": 0.7210937142372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.5483728051185608, "acc": 0.7308813333511353, "length": 3.954162836074829, "mode": "train", "epoch": 14}
{"loss": 0.5620602965354919, "acc": 0.7201171517372131, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.537235677242279, "acc": 0.7400528788566589, "length": 3.9480416774749756, "mode": "train", "epoch": 15}
{"loss": 0.5451071262359619, "acc": 0.7277343273162842, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.5247111320495605, "acc": 0.7497486472129822, "length": 3.9597811698913574, "mode": "train", "epoch": 16}
{"loss": 0.5191712379455566, "acc": 0.7517578601837158, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.5040010213851929, "acc": 0.7679661512374878, "length": 3.981106996536255, "mode": "train", "epoch": 17}
{"loss": 0.4970002770423889, "acc": 0.7914061546325684, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.48034176230430603, "acc": 0.7896254658699036, "length": 3.973365068435669, "mode": "train", "epoch": 18}
{"loss": 0.46852320432662964, "acc": 0.8042969107627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.45425495505332947, "acc": 0.811873197555542, "length": 3.991610050201416, "mode": "train", "epoch": 19}
{"loss": 0.44582727551460266, "acc": 0.8191404938697815, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.4316592216491699, "acc": 0.8203731179237366, "length": 3.994760274887085, "mode": "train", "epoch": 20}
{"loss": 0.4354483485221863, "acc": 0.8167968392372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.4196804463863373, "acc": 0.8182737827301025, "length": 3.9935028553009033, "mode": "train", "epoch": 21}
{"loss": 0.42382586002349854, "acc": 0.8185547590255737, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.4098054766654968, "acc": 0.8230123519897461, "length": 3.9954302310943604, "mode": "train", "epoch": 22}
{"loss": 0.4300823211669922, "acc": 0.8208984732627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.39867278933525085, "acc": 0.829876184463501, "length": 3.9927752017974854, "mode": "train", "epoch": 23}
{"loss": 0.4120115041732788, "acc": 0.8291015625, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3855963349342346, "acc": 0.8338673114776611, "length": 3.997642993927002, "mode": "train", "epoch": 24}
{"loss": 0.4085950255393982, "acc": 0.8322266340255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3733465373516083, "acc": 0.8428546190261841, "length": 3.9943907260894775, "mode": "train", "epoch": 25}
{"loss": 0.3945586681365967, "acc": 0.8339844346046448, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.35952261090278625, "acc": 0.8455358147621155, "length": 3.997138261795044, "mode": "train", "epoch": 26}
{"loss": 0.3704058527946472, "acc": 0.8445311784744263, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.34708982706069946, "acc": 0.8507490158081055, "length": 3.990973472595215, "mode": "train", "epoch": 27}
{"loss": 0.3568497896194458, "acc": 0.8470702767372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.33818531036376953, "acc": 0.8567572236061096, "length": 3.9975407123565674, "mode": "train", "epoch": 28}
{"loss": 0.342462956905365, "acc": 0.8599609732627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3245973289012909, "acc": 0.8646712303161621, "length": 3.996006727218628, "mode": "train", "epoch": 29}
{"loss": 0.32635051012039185, "acc": 0.8605469465255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3191492259502411, "acc": 0.8676438927650452, "length": 3.9987025260925293, "mode": "train", "epoch": 30}
{"loss": 0.32672327756881714, "acc": 0.8589844703674316, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.30833545327186584, "acc": 0.8704200387001038, "length": 3.996227979660034, "mode": "train", "epoch": 31}
{"loss": 0.31199684739112854, "acc": 0.8699217438697815, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3033626675605774, "acc": 0.8719223141670227, "length": 3.99531888961792, "mode": "train", "epoch": 32}
{"loss": 0.3108178377151489, "acc": 0.8736328482627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3015250265598297, "acc": 0.8776905536651611, "length": 3.992570161819458, "mode": "train", "epoch": 33}
{"loss": 0.3117656409740448, "acc": 0.8687499761581421, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.29555007815361023, "acc": 0.8794885277748108, "length": 3.998203992843628, "mode": "train", "epoch": 34}
{"loss": 0.30731385946273804, "acc": 0.8712891936302185, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2985912263393402, "acc": 0.8752326369285583, "length": 3.997732400894165, "mode": "train", "epoch": 35}
{"loss": 0.3035472631454468, "acc": 0.873046875, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.29060572385787964, "acc": 0.8863690495491028, "length": 3.9903666973114014, "mode": "train", "epoch": 36}
{"loss": 0.2903851270675659, "acc": 0.8812499642372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2850199341773987, "acc": 0.8829628825187683, "length": 3.9956307411193848, "mode": "train", "epoch": 37}
{"loss": 0.28914374113082886, "acc": 0.8820310831069946, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.27448660135269165, "acc": 0.8869889378547668, "length": 3.996372938156128, "mode": "train", "epoch": 38}
{"loss": 0.2946714460849762, "acc": 0.8763670921325684, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2735786736011505, "acc": 0.8892437219619751, "length": 3.996356725692749, "mode": "train", "epoch": 39}
{"loss": 0.2825470566749573, "acc": 0.8847655653953552, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2722497284412384, "acc": 0.8906599879264832, "length": 3.994852066040039, "mode": "train", "epoch": 40}
{"loss": 0.27268388867378235, "acc": 0.8910155892372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.26783522963523865, "acc": 0.8919802904129028, "length": 3.992187976837158, "mode": "train", "epoch": 41}
{"loss": 0.26930463314056396, "acc": 0.8884764313697815, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2581459879875183, "acc": 0.8949297666549683, "length": 3.9966557025909424, "mode": "train", "epoch": 42}
{"loss": 0.2669523358345032, "acc": 0.8951172828674316, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2566497325897217, "acc": 0.8918262720108032, "length": 3.9965951442718506, "mode": "train", "epoch": 43}
{"loss": 0.26355957984924316, "acc": 0.8955078721046448, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.25567153096199036, "acc": 0.8985773324966431, "length": 3.9973883628845215, "mode": "train", "epoch": 44}
{"loss": 0.25218042731285095, "acc": 0.8960938453674316, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.25230100750923157, "acc": 0.8976578116416931, "length": 3.9954257011413574, "mode": "train", "epoch": 45}
{"loss": 0.25109416246414185, "acc": 0.8996094465255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.248185396194458, "acc": 0.894035816192627, "length": 3.99699330329895, "mode": "train", "epoch": 46}
{"loss": 0.2600046992301941, "acc": 0.8958983421325684, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2472284883260727, "acc": 0.8977966904640198, "length": 3.9988622665405273, "mode": "train", "epoch": 47}
{"loss": 0.24043363332748413, "acc": 0.9011717438697815, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2425624281167984, "acc": 0.9009762406349182, "length": 3.992335557937622, "mode": "train", "epoch": 48}
{"loss": 0.24347621202468872, "acc": 0.9046874642372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2408241331577301, "acc": 0.9043105244636536, "length": 3.9929583072662354, "mode": "train", "epoch": 49}
{"loss": 0.24860501289367676, "acc": 0.9007812142372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.23726390302181244, "acc": 0.9033147096633911, "length": 3.99444842338562, "mode": "train", "epoch": 50}
{"loss": 0.23361653089523315, "acc": 0.9039063453674316, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.23215000331401825, "acc": 0.9055605530738831, "length": 3.9977259635925293, "mode": "train", "epoch": 51}
{"loss": 0.2267688363790512, "acc": 0.9146484732627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2284361571073532, "acc": 0.9069846868515015, "length": 3.9979238510131836, "mode": "train", "epoch": 52}
{"loss": 0.21174457669258118, "acc": 0.9201173186302185, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.22407563030719757, "acc": 0.9092437624931335, "length": 3.9922571182250977, "mode": "train", "epoch": 53}
{"loss": 0.21712729334831238, "acc": 0.9208984971046448, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.22429288923740387, "acc": 0.9087943434715271, "length": 3.9879069328308105, "mode": "train", "epoch": 54}
{"loss": 0.21083927154541016, "acc": 0.9279297590255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2157648801803589, "acc": 0.9134226441383362, "length": 3.9933621883392334, "mode": "train", "epoch": 55}
{"loss": 0.20086508989334106, "acc": 0.9279298186302185, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.21441873908042908, "acc": 0.9098075032234192, "length": 3.9927382469177246, "mode": "train", "epoch": 56}
{"loss": 0.21234630048274994, "acc": 0.9236329793930054, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.21592339873313904, "acc": 0.9134271740913391, "length": 3.9974398612976074, "mode": "train", "epoch": 57}
{"loss": 0.21096062660217285, "acc": 0.9242186546325684, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.21450471878051758, "acc": 0.9134521484375, "length": 3.995863437652588, "mode": "train", "epoch": 58}
{"loss": 0.1971440315246582, "acc": 0.9312500357627869, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.20578332245349884, "acc": 0.9159234762191772, "length": 3.9983692169189453, "mode": "train", "epoch": 59}
{"loss": 0.19148093461990356, "acc": 0.9324217438697815, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.20586667954921722, "acc": 0.918653666973114, "length": 3.9956908226013184, "mode": "train", "epoch": 60}
{"loss": 0.1872214525938034, "acc": 0.9302734732627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7873213887214661
