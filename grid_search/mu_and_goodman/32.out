ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6979240775108337, "acc": 0.5122432112693787, "length": 3.5260133743286133, "mode": "train", "epoch": 1}
{"loss": 0.6941507458686829, "acc": 0.5083984732627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.690424382686615, "acc": 0.5179927349090576, "length": 3.4425129890441895, "mode": "train", "epoch": 2}
{"loss": 0.6916314959526062, "acc": 0.5326263308525085, "length": 1.015625, "mode": "test", "epoch": 2}
{"loss": 0.6887553334236145, "acc": 0.5392946004867554, "length": 3.298625946044922, "mode": "train", "epoch": 3}
{"loss": 0.6800663471221924, "acc": 0.572222888469696, "length": 1.51171875, "mode": "test", "epoch": 3}
{"loss": 0.6798195838928223, "acc": 0.5742841958999634, "length": 3.1043972969055176, "mode": "train", "epoch": 4}
{"loss": 0.6589924097061157, "acc": 0.6510711908340454, "length": 2.46484375, "mode": "test", "epoch": 4}
{"loss": 0.6548250317573547, "acc": 0.6619271636009216, "length": 3.256927490234375, "mode": "train", "epoch": 5}
{"loss": 0.6051616072654724, "acc": 0.7456146478652954, "length": 3.93359375, "mode": "test", "epoch": 5}
{"loss": 0.5869172811508179, "acc": 0.7426296472549438, "length": 3.5978758335113525, "mode": "train", "epoch": 6}
{"loss": 0.5474605560302734, "acc": 0.7271484732627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5068731904029846, "acc": 0.7754586338996887, "length": 3.8463990688323975, "mode": "train", "epoch": 7}
{"loss": 0.5254491567611694, "acc": 0.7810546159744263, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.48929378390312195, "acc": 0.7812892198562622, "length": 3.92732572555542, "mode": "train", "epoch": 8}
{"loss": 0.5237259864807129, "acc": 0.779296875, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.47012338042259216, "acc": 0.7957857251167297, "length": 3.9466867446899414, "mode": "train", "epoch": 9}
{"loss": 0.5054469108581543, "acc": 0.7833983898162842, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4336194097995758, "acc": 0.8028047680854797, "length": 3.9509005546569824, "mode": "train", "epoch": 10}
{"loss": 0.503887951374054, "acc": 0.7912110090255737, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.41400855779647827, "acc": 0.8201400637626648, "length": 3.9585065841674805, "mode": "train", "epoch": 11}
{"loss": 0.467165470123291, "acc": 0.8019531965255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.38885024189949036, "acc": 0.8264109492301941, "length": 3.9721148014068604, "mode": "train", "epoch": 12}
{"loss": 0.4329663813114166, "acc": 0.8193359375, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3615683913230896, "acc": 0.8437157869338989, "length": 3.9783191680908203, "mode": "train", "epoch": 13}
{"loss": 0.40104323625564575, "acc": 0.8359375, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.34851935505867004, "acc": 0.8473399877548218, "length": 3.982482433319092, "mode": "train", "epoch": 14}
{"loss": 0.39701318740844727, "acc": 0.8400391340255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3369467556476593, "acc": 0.8537296652793884, "length": 3.98754620552063, "mode": "train", "epoch": 15}
{"loss": 0.38238245248794556, "acc": 0.8433594107627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3353349566459656, "acc": 0.8548192381858826, "length": 3.987605571746826, "mode": "train", "epoch": 16}
{"loss": 0.36499643325805664, "acc": 0.8490234017372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3309045433998108, "acc": 0.8606082201004028, "length": 3.993372678756714, "mode": "train", "epoch": 17}
{"loss": 0.36497586965560913, "acc": 0.8470702767372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3278768062591553, "acc": 0.859944224357605, "length": 3.993774890899658, "mode": "train", "epoch": 18}
{"loss": 0.3616909980773926, "acc": 0.8515625, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.30195459723472595, "acc": 0.8664637207984924, "length": 3.99507212638855, "mode": "train", "epoch": 19}
{"loss": 0.3441551923751831, "acc": 0.865234375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.30789119005203247, "acc": 0.8740663528442383, "length": 3.9938881397247314, "mode": "train", "epoch": 20}
{"loss": 0.34529000520706177, "acc": 0.8660155534744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2848377227783203, "acc": 0.8740382790565491, "length": 3.9962687492370605, "mode": "train", "epoch": 21}
{"loss": 0.3304711580276489, "acc": 0.8669921159744263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2832207977771759, "acc": 0.8774344325065613, "length": 3.9969353675842285, "mode": "train", "epoch": 22}
{"loss": 0.318556010723114, "acc": 0.8707031011581421, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27283772826194763, "acc": 0.8835626840591431, "length": 3.9936063289642334, "mode": "train", "epoch": 23}
{"loss": 0.30719536542892456, "acc": 0.8802734017372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2736643850803375, "acc": 0.8841714262962341, "length": 3.996932029724121, "mode": "train", "epoch": 24}
{"loss": 0.30007404088974, "acc": 0.8820313215255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2674315273761749, "acc": 0.8862183094024658, "length": 3.9986469745635986, "mode": "train", "epoch": 25}
{"loss": 0.29451125860214233, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2611919045448303, "acc": 0.8912206292152405, "length": 3.9984216690063477, "mode": "train", "epoch": 26}
{"loss": 0.302855521440506, "acc": 0.8800781965255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.25862330198287964, "acc": 0.8905163407325745, "length": 3.999267101287842, "mode": "train", "epoch": 27}
{"loss": 0.2799040973186493, "acc": 0.8791016936302185, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2436358630657196, "acc": 0.8934939503669739, "length": 3.9992072582244873, "mode": "train", "epoch": 28}
{"loss": 0.27884483337402344, "acc": 0.8859376311302185, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2428750842809677, "acc": 0.8990923166275024, "length": 3.9991884231567383, "mode": "train", "epoch": 29}
{"loss": 0.2669661045074463, "acc": 0.8837890625, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.23843654990196228, "acc": 0.8999820947647095, "length": 3.998661518096924, "mode": "train", "epoch": 30}
{"loss": 0.265453577041626, "acc": 0.8861327767372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.22687950730323792, "acc": 0.9012891054153442, "length": 3.998941421508789, "mode": "train", "epoch": 31}
{"loss": 0.2640840709209442, "acc": 0.8898438215255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2469308227300644, "acc": 0.9041077494621277, "length": 3.9996960163116455, "mode": "train", "epoch": 32}
{"loss": 0.26265227794647217, "acc": 0.8892578482627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.22477789223194122, "acc": 0.9043446779251099, "length": 3.9996490478515625, "mode": "train", "epoch": 33}
{"loss": 0.2537691593170166, "acc": 0.8962889909744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.22309955954551697, "acc": 0.9066720604896545, "length": 3.99984073638916, "mode": "train", "epoch": 34}
{"loss": 0.24771744012832642, "acc": 0.8986328840255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.22697235643863678, "acc": 0.9055891036987305, "length": 3.999394655227661, "mode": "train", "epoch": 35}
{"loss": 0.24555131793022156, "acc": 0.9021483659744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21796180307865143, "acc": 0.9065544009208679, "length": 3.999023675918579, "mode": "train", "epoch": 36}
{"loss": 0.23706357181072235, "acc": 0.8990234732627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2221093624830246, "acc": 0.9129887223243713, "length": 3.9998230934143066, "mode": "train", "epoch": 37}
{"loss": 0.23262886703014374, "acc": 0.9080077409744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.19988620281219482, "acc": 0.9127527475357056, "length": 3.9999513626098633, "mode": "train", "epoch": 38}
{"loss": 0.22605553269386292, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20999570190906525, "acc": 0.911200225353241, "length": 3.9998340606689453, "mode": "train", "epoch": 39}
{"loss": 0.21592971682548523, "acc": 0.9185547232627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19687530398368835, "acc": 0.9146586656570435, "length": 3.999924898147583, "mode": "train", "epoch": 40}
{"loss": 0.22162312269210815, "acc": 0.9076171517372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1963501125574112, "acc": 0.9158382415771484, "length": 3.999020576477051, "mode": "train", "epoch": 41}
{"loss": 0.2107294201850891, "acc": 0.9177736043930054, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.19783411920070648, "acc": 0.9210365414619446, "length": 3.999943733215332, "mode": "train", "epoch": 42}
{"loss": 0.20938685536384583, "acc": 0.9171876311302185, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1896686851978302, "acc": 0.9254239797592163, "length": 3.999002456665039, "mode": "train", "epoch": 43}
{"loss": 0.2158694863319397, "acc": 0.912109375, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.18835029006004333, "acc": 0.9262688755989075, "length": 3.9995853900909424, "mode": "train", "epoch": 44}
{"loss": 0.20541906356811523, "acc": 0.9144530892372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.19280047714710236, "acc": 0.9240732789039612, "length": 3.9998130798339844, "mode": "train", "epoch": 45}
{"loss": 0.20508722960948944, "acc": 0.9214843511581421, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18411113321781158, "acc": 0.9258630871772766, "length": 3.999952793121338, "mode": "train", "epoch": 46}
{"loss": 0.19619649648666382, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.18772169947624207, "acc": 0.9247186779975891, "length": 3.998807430267334, "mode": "train", "epoch": 47}
{"loss": 0.20679756999015808, "acc": 0.9150390028953552, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.19018492102622986, "acc": 0.925446093082428, "length": 3.99996018409729, "mode": "train", "epoch": 48}
{"loss": 0.19206379354000092, "acc": 0.9308594465255737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.19320283830165863, "acc": 0.9233608245849609, "length": 3.999985933303833, "mode": "train", "epoch": 49}
{"loss": 0.19920587539672852, "acc": 0.9181641340255737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.18210472166538239, "acc": 0.9254425168037415, "length": 3.999877691268921, "mode": "train", "epoch": 50}
{"loss": 0.19231286644935608, "acc": 0.9253907203674316, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.18014644086360931, "acc": 0.9271740913391113, "length": 3.9999608993530273, "mode": "train", "epoch": 51}
{"loss": 0.19042524695396423, "acc": 0.9220703840255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.18232408165931702, "acc": 0.9228845238685608, "length": 3.9999747276306152, "mode": "train", "epoch": 52}
{"loss": 0.19993287324905396, "acc": 0.9169921875, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.17361269891262054, "acc": 0.9292587041854858, "length": 3.999922037124634, "mode": "train", "epoch": 53}
{"loss": 0.20603981614112854, "acc": 0.9201172590255737, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.17412157356739044, "acc": 0.929916501045227, "length": 3.9999959468841553, "mode": "train", "epoch": 54}
{"loss": 0.20465795695781708, "acc": 0.9216796159744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.16671685874462128, "acc": 0.9281286597251892, "length": 3.9999947547912598, "mode": "train", "epoch": 55}
{"loss": 0.18154995143413544, "acc": 0.9210938215255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.16830675303936005, "acc": 0.9294991493225098, "length": 3.9999897480010986, "mode": "train", "epoch": 56}
{"loss": 0.17649292945861816, "acc": 0.9326171875, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.17006991803646088, "acc": 0.9306895732879639, "length": 3.999934434890747, "mode": "train", "epoch": 57}
{"loss": 0.1762925088405609, "acc": 0.9296875596046448, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.16335907578468323, "acc": 0.9307507872581482, "length": 3.9999961853027344, "mode": "train", "epoch": 58}
{"loss": 0.17625615000724792, "acc": 0.9208984375, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.16493414342403412, "acc": 0.9341473579406738, "length": 3.999985933303833, "mode": "train", "epoch": 59}
{"loss": 0.17265567183494568, "acc": 0.9275389909744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.16049262881278992, "acc": 0.9372467398643494, "length": 3.9999988079071045, "mode": "train", "epoch": 60}
{"loss": 0.16942188143730164, "acc": 0.9294921159744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8570312261581421
