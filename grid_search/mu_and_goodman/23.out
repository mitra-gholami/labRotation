ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6916594505310059, "acc": 0.5397170186042786, "length": 3.073591470718384, "mode": "train", "epoch": 1}
{"loss": 0.6792376041412354, "acc": 0.5775390267372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6502053141593933, "acc": 0.632681667804718, "length": 2.385274887084961, "mode": "train", "epoch": 2}
{"loss": 0.5891242623329163, "acc": 0.7103332877159119, "length": 2.58203125, "mode": "test", "epoch": 2}
{"loss": 0.5738475322723389, "acc": 0.7097822427749634, "length": 2.63792085647583, "mode": "train", "epoch": 3}
{"loss": 0.5548335313796997, "acc": 0.7521483898162842, "length": 2.62890625, "mode": "test", "epoch": 3}
{"loss": 0.5394078493118286, "acc": 0.7375203371047974, "length": 2.8267881870269775, "mode": "train", "epoch": 4}
{"loss": 0.5182837843894958, "acc": 0.7755371332168579, "length": 2.7578125, "mode": "test", "epoch": 4}
{"loss": 0.4825579822063446, "acc": 0.7817981243133545, "length": 2.994791030883789, "mode": "train", "epoch": 5}
{"loss": 0.4582149386405945, "acc": 0.8165100812911987, "length": 2.86328125, "mode": "test", "epoch": 5}
{"loss": 0.42800307273864746, "acc": 0.8157108426094055, "length": 3.1744210720062256, "mode": "train", "epoch": 6}
{"loss": 0.4274100959300995, "acc": 0.8242737054824829, "length": 2.98046875, "mode": "test", "epoch": 6}
{"loss": 0.3722503185272217, "acc": 0.8475574851036072, "length": 3.279031753540039, "mode": "train", "epoch": 7}
{"loss": 0.3683522641658783, "acc": 0.856005847454071, "length": 3.26171875, "mode": "test", "epoch": 7}
{"loss": 0.32283854484558105, "acc": 0.8698951601982117, "length": 3.6215198040008545, "mode": "train", "epoch": 8}
{"loss": 0.38099953532218933, "acc": 0.8492797613143921, "length": 3.56640625, "mode": "test", "epoch": 8}
{"loss": 0.29093801975250244, "acc": 0.8854384422302246, "length": 3.767500877380371, "mode": "train", "epoch": 9}
{"loss": 0.298123836517334, "acc": 0.8877869248390198, "length": 3.953125, "mode": "test", "epoch": 9}
{"loss": 0.2687940001487732, "acc": 0.8939492106437683, "length": 3.901149034500122, "mode": "train", "epoch": 10}
{"loss": 0.3165581226348877, "acc": 0.8816404938697815, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.253811240196228, "acc": 0.9018153548240662, "length": 3.966672897338867, "mode": "train", "epoch": 11}
{"loss": 0.30380070209503174, "acc": 0.8863281607627869, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2303357869386673, "acc": 0.9118292927742004, "length": 3.9747400283813477, "mode": "train", "epoch": 12}
{"loss": 0.2906733453273773, "acc": 0.896484375, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.22603875398635864, "acc": 0.9113991856575012, "length": 3.9859862327575684, "mode": "train", "epoch": 13}
{"loss": 0.2999959886074066, "acc": 0.8851562142372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.22167488932609558, "acc": 0.9174039959907532, "length": 3.9887828826904297, "mode": "train", "epoch": 14}
{"loss": 0.27943167090415955, "acc": 0.90625, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2142258584499359, "acc": 0.9176158308982849, "length": 3.991511583328247, "mode": "train", "epoch": 15}
{"loss": 0.275669664144516, "acc": 0.90625, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.20673958957195282, "acc": 0.9213100075721741, "length": 3.992152690887451, "mode": "train", "epoch": 16}
{"loss": 0.2728031575679779, "acc": 0.9058594107627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.205078586935997, "acc": 0.9200085401535034, "length": 3.9915409088134766, "mode": "train", "epoch": 17}
{"loss": 0.29279011487960815, "acc": 0.888671875, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.201228529214859, "acc": 0.9210668206214905, "length": 3.9942526817321777, "mode": "train", "epoch": 18}
{"loss": 0.28773564100265503, "acc": 0.8992186784744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.19698350131511688, "acc": 0.9252171516418457, "length": 3.994389295578003, "mode": "train", "epoch": 19}
{"loss": 0.25548040866851807, "acc": 0.912109375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.19122102856636047, "acc": 0.9277318716049194, "length": 3.9945085048675537, "mode": "train", "epoch": 20}
{"loss": 0.26539576053619385, "acc": 0.9138671159744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.18899494409561157, "acc": 0.9291691780090332, "length": 3.9954283237457275, "mode": "train", "epoch": 21}
{"loss": 0.25698643922805786, "acc": 0.9158204793930054, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.1797218918800354, "acc": 0.9339621067047119, "length": 3.9955525398254395, "mode": "train", "epoch": 22}
{"loss": 0.2737741768360138, "acc": 0.9134765267372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.17670582234859467, "acc": 0.9304291605949402, "length": 3.996539831161499, "mode": "train", "epoch": 23}
{"loss": 0.2472614198923111, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.17073717713356018, "acc": 0.9355690479278564, "length": 3.996619939804077, "mode": "train", "epoch": 24}
{"loss": 0.2866835594177246, "acc": 0.9089843034744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1627536118030548, "acc": 0.9392725825309753, "length": 3.9971425533294678, "mode": "train", "epoch": 25}
{"loss": 0.2366970032453537, "acc": 0.9191407561302185, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1441614031791687, "acc": 0.9470208287239075, "length": 3.9957807064056396, "mode": "train", "epoch": 26}
{"loss": 0.2361285388469696, "acc": 0.9216795563697815, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1472276896238327, "acc": 0.9438745975494385, "length": 3.996304750442505, "mode": "train", "epoch": 27}
{"loss": 0.25066936016082764, "acc": 0.9187499284744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1318696141242981, "acc": 0.9527212381362915, "length": 3.9967758655548096, "mode": "train", "epoch": 28}
{"loss": 0.24481821060180664, "acc": 0.9234375357627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.12544547021389008, "acc": 0.9526858925819397, "length": 3.997485876083374, "mode": "train", "epoch": 29}
{"loss": 0.24242421984672546, "acc": 0.9289063215255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.12531191110610962, "acc": 0.9499945640563965, "length": 3.9972236156463623, "mode": "train", "epoch": 30}
{"loss": 0.23686262965202332, "acc": 0.9259766340255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.12183289229869843, "acc": 0.9559648633003235, "length": 3.9977500438690186, "mode": "train", "epoch": 31}
{"loss": 0.2513711452484131, "acc": 0.9281249642372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.11886313557624817, "acc": 0.9587848782539368, "length": 3.9981484413146973, "mode": "train", "epoch": 32}
{"loss": 0.22524915635585785, "acc": 0.931640625, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.104572594165802, "acc": 0.9633634686470032, "length": 3.998371124267578, "mode": "train", "epoch": 33}
{"loss": 0.20124152302742004, "acc": 0.9408203363418579, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.10146914422512054, "acc": 0.966269850730896, "length": 3.9977073669433594, "mode": "train", "epoch": 34}
{"loss": 0.22061073780059814, "acc": 0.9359374642372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.09029347449541092, "acc": 0.970724880695343, "length": 3.998284101486206, "mode": "train", "epoch": 35}
{"loss": 0.21369768679141998, "acc": 0.9283204078674316, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.08414692431688309, "acc": 0.974513053894043, "length": 3.9982736110687256, "mode": "train", "epoch": 36}
{"loss": 0.21720434725284576, "acc": 0.9333983659744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.0798308402299881, "acc": 0.9744378328323364, "length": 3.998945474624634, "mode": "train", "epoch": 37}
{"loss": 0.2158675491809845, "acc": 0.935546875, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.08068785816431046, "acc": 0.9754321575164795, "length": 3.9990956783294678, "mode": "train", "epoch": 38}
{"loss": 0.21725663542747498, "acc": 0.9322265982627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.09171837568283081, "acc": 0.9698143005371094, "length": 3.9990179538726807, "mode": "train", "epoch": 39}
{"loss": 0.19279256463050842, "acc": 0.9400390982627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.08139690011739731, "acc": 0.9742666482925415, "length": 3.9991939067840576, "mode": "train", "epoch": 40}
{"loss": 0.20441047847270966, "acc": 0.9416016340255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08093825727701187, "acc": 0.9719217419624329, "length": 3.9990761280059814, "mode": "train", "epoch": 41}
{"loss": 0.2506425380706787, "acc": 0.9191406965255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.07824379950761795, "acc": 0.973690390586853, "length": 3.9993910789489746, "mode": "train", "epoch": 42}
{"loss": 0.21787254512310028, "acc": 0.9380859732627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.07373625785112381, "acc": 0.9752717614173889, "length": 3.9994618892669678, "mode": "train", "epoch": 43}
{"loss": 0.20527571439743042, "acc": 0.9468750357627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06309222429990768, "acc": 0.9801884293556213, "length": 3.9994356632232666, "mode": "train", "epoch": 44}
{"loss": 0.1979699730873108, "acc": 0.935546875, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.06478151679039001, "acc": 0.9781461358070374, "length": 3.999615430831909, "mode": "train", "epoch": 45}
{"loss": 0.14119359850883484, "acc": 0.9517578482627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.057607416063547134, "acc": 0.9825354218482971, "length": 3.9994990825653076, "mode": "train", "epoch": 46}
{"loss": 0.18430441617965698, "acc": 0.9449219107627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.0603080652654171, "acc": 0.9813646078109741, "length": 3.999570846557617, "mode": "train", "epoch": 47}
{"loss": 0.15350928902626038, "acc": 0.9548827409744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.05786525458097458, "acc": 0.9832971096038818, "length": 3.999598979949951, "mode": "train", "epoch": 48}
{"loss": 0.1825023740530014, "acc": 0.95703125, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.05853651091456413, "acc": 0.9802590608596802, "length": 3.999732494354248, "mode": "train", "epoch": 49}
{"loss": 0.18854571878910065, "acc": 0.9470701813697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0512869767844677, "acc": 0.982483983039856, "length": 3.9997572898864746, "mode": "train", "epoch": 50}
{"loss": 0.1638585478067398, "acc": 0.9572266340255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.05312100052833557, "acc": 0.9827725887298584, "length": 3.9996678829193115, "mode": "train", "epoch": 51}
{"loss": 0.17669539153575897, "acc": 0.9529296159744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.04190502315759659, "acc": 0.9871072769165039, "length": 3.9997386932373047, "mode": "train", "epoch": 52}
{"loss": 0.1725923717021942, "acc": 0.9486327767372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.036139413714408875, "acc": 0.9885181784629822, "length": 3.9998459815979004, "mode": "train", "epoch": 53}
{"loss": 0.19619017839431763, "acc": 0.9507812857627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.0405275858938694, "acc": 0.9892211556434631, "length": 3.9998652935028076, "mode": "train", "epoch": 54}
{"loss": 0.18400663137435913, "acc": 0.9478515982627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03751835599541664, "acc": 0.9894553422927856, "length": 3.9998645782470703, "mode": "train", "epoch": 55}
{"loss": 0.19304808974266052, "acc": 0.9513672590255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.04167047515511513, "acc": 0.9868227243423462, "length": 3.999891757965088, "mode": "train", "epoch": 56}
{"loss": 0.2237364500761032, "acc": 0.9460936784744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.040582943707704544, "acc": 0.9890459775924683, "length": 3.9998908042907715, "mode": "train", "epoch": 57}
{"loss": 0.15456625819206238, "acc": 0.9541016221046448, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.03288092091679573, "acc": 0.9898648858070374, "length": 3.999866247177124, "mode": "train", "epoch": 58}
{"loss": 0.19246117770671844, "acc": 0.9533203840255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03944707661867142, "acc": 0.9864124655723572, "length": 3.999899387359619, "mode": "train", "epoch": 59}
{"loss": 0.17629481852054596, "acc": 0.9558593034744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.0337027870118618, "acc": 0.9885798692703247, "length": 3.9999141693115234, "mode": "train", "epoch": 60}
{"loss": 0.16823826730251312, "acc": 0.9458984732627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8209999799728394
