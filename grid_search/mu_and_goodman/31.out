ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6970626711845398, "acc": 0.527306318283081, "length": 3.5547420978546143, "mode": "train", "epoch": 1}
{"loss": 0.6917372941970825, "acc": 0.5108307600021362, "length": 2.95703125, "mode": "test", "epoch": 1}
{"loss": 0.687890887260437, "acc": 0.5406703352928162, "length": 3.4941530227661133, "mode": "train", "epoch": 2}
{"loss": 0.6722173094749451, "acc": 0.6166900992393494, "length": 3.0859375, "mode": "test", "epoch": 2}
{"loss": 0.6842366456985474, "acc": 0.5479747653007507, "length": 3.417667865753174, "mode": "train", "epoch": 3}
{"loss": 0.6631615161895752, "acc": 0.6276001334190369, "length": 3.0859375, "mode": "test", "epoch": 3}
{"loss": 0.6664119958877563, "acc": 0.6231305599212646, "length": 3.383240222930908, "mode": "train", "epoch": 4}
{"loss": 0.642444908618927, "acc": 0.6448639631271362, "length": 3.625, "mode": "test", "epoch": 4}
{"loss": 0.6200312376022339, "acc": 0.6777240633964539, "length": 3.533159017562866, "mode": "train", "epoch": 5}
{"loss": 0.5907925963401794, "acc": 0.662890613079071, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5737380981445312, "acc": 0.7071687579154968, "length": 3.8154900074005127, "mode": "train", "epoch": 6}
{"loss": 0.5692424774169922, "acc": 0.7205077409744263, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5431060194969177, "acc": 0.7297600507736206, "length": 3.9175968170166016, "mode": "train", "epoch": 7}
{"loss": 0.5312086343765259, "acc": 0.7585936784744263, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5114063620567322, "acc": 0.7645997405052185, "length": 3.949949264526367, "mode": "train", "epoch": 8}
{"loss": 0.5007279515266418, "acc": 0.7955078482627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4585585296154022, "acc": 0.8106822371482849, "length": 3.970256805419922, "mode": "train", "epoch": 9}
{"loss": 0.46031653881073, "acc": 0.8048828840255737, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4111543595790863, "acc": 0.8245140910148621, "length": 3.9863040447235107, "mode": "train", "epoch": 10}
{"loss": 0.43739569187164307, "acc": 0.8257812857627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.370193749666214, "acc": 0.8495923280715942, "length": 3.987473964691162, "mode": "train", "epoch": 11}
{"loss": 0.4197591543197632, "acc": 0.8361328840255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.33941078186035156, "acc": 0.865375280380249, "length": 3.9876394271850586, "mode": "train", "epoch": 12}
{"loss": 0.39286571741104126, "acc": 0.8404297232627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3263664245605469, "acc": 0.8690114617347717, "length": 3.992393970489502, "mode": "train", "epoch": 13}
{"loss": 0.3757234811782837, "acc": 0.8453125357627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.30869200825691223, "acc": 0.8749886155128479, "length": 3.9913437366485596, "mode": "train", "epoch": 14}
{"loss": 0.3613240718841553, "acc": 0.8498047590255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.30224815011024475, "acc": 0.8780279755592346, "length": 3.996039867401123, "mode": "train", "epoch": 15}
{"loss": 0.36843350529670715, "acc": 0.8472656607627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3018720746040344, "acc": 0.8778198957443237, "length": 3.9955198764801025, "mode": "train", "epoch": 16}
{"loss": 0.3566092252731323, "acc": 0.8544921875, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.29181885719299316, "acc": 0.8829043507575989, "length": 3.9973959922790527, "mode": "train", "epoch": 17}
{"loss": 0.3544069230556488, "acc": 0.8498048186302185, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.28794437646865845, "acc": 0.8825249075889587, "length": 3.9959774017333984, "mode": "train", "epoch": 18}
{"loss": 0.3501281142234802, "acc": 0.8501953482627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.273393839597702, "acc": 0.8913114070892334, "length": 3.9976491928100586, "mode": "train", "epoch": 19}
{"loss": 0.35836637020111084, "acc": 0.8539062142372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.28122204542160034, "acc": 0.8900386691093445, "length": 3.997892141342163, "mode": "train", "epoch": 20}
{"loss": 0.34147393703460693, "acc": 0.8593750596046448, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2688765823841095, "acc": 0.8917662501335144, "length": 3.9971914291381836, "mode": "train", "epoch": 21}
{"loss": 0.3208199441432953, "acc": 0.8751953840255737, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.26233404874801636, "acc": 0.8992184996604919, "length": 3.9984090328216553, "mode": "train", "epoch": 22}
{"loss": 0.3161587417125702, "acc": 0.8728514909744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.26167452335357666, "acc": 0.8957360982894897, "length": 3.9981038570404053, "mode": "train", "epoch": 23}
{"loss": 0.3122256100177765, "acc": 0.87109375, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2521600127220154, "acc": 0.9026524424552917, "length": 3.9994194507598877, "mode": "train", "epoch": 24}
{"loss": 0.2996182143688202, "acc": 0.8787108659744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2547490894794464, "acc": 0.9012631177902222, "length": 3.9993205070495605, "mode": "train", "epoch": 25}
{"loss": 0.2957333028316498, "acc": 0.8861327767372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2481977492570877, "acc": 0.9041078090667725, "length": 3.999568462371826, "mode": "train", "epoch": 26}
{"loss": 0.29638952016830444, "acc": 0.8833984732627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.24946317076683044, "acc": 0.9026657938957214, "length": 3.995060920715332, "mode": "train", "epoch": 27}
{"loss": 0.28333503007888794, "acc": 0.8914061784744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.239724263548851, "acc": 0.9060186743736267, "length": 3.9991302490234375, "mode": "train", "epoch": 28}
{"loss": 0.28606343269348145, "acc": 0.89453125, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.23412905633449554, "acc": 0.9124203324317932, "length": 3.996835708618164, "mode": "train", "epoch": 29}
{"loss": 0.27872535586357117, "acc": 0.8974609375, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2331935465335846, "acc": 0.9100322723388672, "length": 3.9999146461486816, "mode": "train", "epoch": 30}
{"loss": 0.2853081524372101, "acc": 0.9035156965255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.23309700191020966, "acc": 0.9162043929100037, "length": 3.9987692832946777, "mode": "train", "epoch": 31}
{"loss": 0.2794870436191559, "acc": 0.9031249284744263, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.22332289814949036, "acc": 0.9148555397987366, "length": 3.9988653659820557, "mode": "train", "epoch": 32}
{"loss": 0.2708585262298584, "acc": 0.90234375, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.22148139774799347, "acc": 0.918816328048706, "length": 3.9992194175720215, "mode": "train", "epoch": 33}
{"loss": 0.2678178548812866, "acc": 0.9132813215255737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2241147756576538, "acc": 0.915236234664917, "length": 3.9983041286468506, "mode": "train", "epoch": 34}
{"loss": 0.27137288451194763, "acc": 0.90234375, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21674537658691406, "acc": 0.9149039387702942, "length": 3.9998247623443604, "mode": "train", "epoch": 35}
{"loss": 0.2723943591117859, "acc": 0.9062500596046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21090440452098846, "acc": 0.9227901101112366, "length": 3.9997751712799072, "mode": "train", "epoch": 36}
{"loss": 0.2448471486568451, "acc": 0.916015625, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2171160727739334, "acc": 0.9176316857337952, "length": 3.9999287128448486, "mode": "train", "epoch": 37}
{"loss": 0.2658765912055969, "acc": 0.91015625, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.21359169483184814, "acc": 0.9224469661712646, "length": 3.999969244003296, "mode": "train", "epoch": 38}
{"loss": 0.2580573260784149, "acc": 0.9123048186302185, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.21032573282718658, "acc": 0.9238314032554626, "length": 3.9960765838623047, "mode": "train", "epoch": 39}
{"loss": 0.2536934018135071, "acc": 0.9156250357627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19778823852539062, "acc": 0.927490234375, "length": 3.9999172687530518, "mode": "train", "epoch": 40}
{"loss": 0.2584141194820404, "acc": 0.9142578840255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19412997364997864, "acc": 0.931138277053833, "length": 3.9967939853668213, "mode": "train", "epoch": 41}
{"loss": 0.24919158220291138, "acc": 0.9201172590255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.19559922814369202, "acc": 0.9281282424926758, "length": 3.9998557567596436, "mode": "train", "epoch": 42}
{"loss": 0.25691312551498413, "acc": 0.91015625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1924857348203659, "acc": 0.9294078350067139, "length": 3.999983549118042, "mode": "train", "epoch": 43}
{"loss": 0.26182711124420166, "acc": 0.9179686903953552, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.19097766280174255, "acc": 0.9338738322257996, "length": 3.9999680519104004, "mode": "train", "epoch": 44}
{"loss": 0.24077588319778442, "acc": 0.9238280653953552, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1884661465883255, "acc": 0.9295234680175781, "length": 3.999941825866699, "mode": "train", "epoch": 45}
{"loss": 0.22346392273902893, "acc": 0.9207030534744263, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18557797372341156, "acc": 0.932597279548645, "length": 3.9999349117279053, "mode": "train", "epoch": 46}
{"loss": 0.237643301486969, "acc": 0.9222655892372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.18146052956581116, "acc": 0.9331142902374268, "length": 3.9998116493225098, "mode": "train", "epoch": 47}
{"loss": 0.24293720722198486, "acc": 0.9226561784744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.18294455111026764, "acc": 0.9312638640403748, "length": 3.9999806880950928, "mode": "train", "epoch": 48}
{"loss": 0.23980337381362915, "acc": 0.9195313453674316, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.18638329207897186, "acc": 0.9293105006217957, "length": 3.9988150596618652, "mode": "train", "epoch": 49}
{"loss": 0.23817503452301025, "acc": 0.9279298186302185, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.17951561510562897, "acc": 0.9354403614997864, "length": 3.9999778270721436, "mode": "train", "epoch": 50}
{"loss": 0.23677819967269897, "acc": 0.927734375, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17148295044898987, "acc": 0.9377549886703491, "length": 3.9994843006134033, "mode": "train", "epoch": 51}
{"loss": 0.227016419172287, "acc": 0.9289063215255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.16973502933979034, "acc": 0.9399263858795166, "length": 3.9988534450531006, "mode": "train", "epoch": 52}
{"loss": 0.24457186460494995, "acc": 0.9240235090255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.17498108744621277, "acc": 0.9361211657524109, "length": 3.9974799156188965, "mode": "train", "epoch": 53}
{"loss": 0.2368936836719513, "acc": 0.9277343153953552, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.17015545070171356, "acc": 0.9374098181724548, "length": 3.9984095096588135, "mode": "train", "epoch": 54}
{"loss": 0.24615389108657837, "acc": 0.9240235090255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.16475126147270203, "acc": 0.938339352607727, "length": 3.999936103820801, "mode": "train", "epoch": 55}
{"loss": 0.2208779752254486, "acc": 0.9285154938697815, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.15933020412921906, "acc": 0.94060218334198, "length": 3.99996280670166, "mode": "train", "epoch": 56}
{"loss": 0.208831787109375, "acc": 0.9302734732627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.15763114392757416, "acc": 0.9421874284744263, "length": 3.998809576034546, "mode": "train", "epoch": 57}
{"loss": 0.22552263736724854, "acc": 0.9304686188697815, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.15131191909313202, "acc": 0.9447171688079834, "length": 3.9998884201049805, "mode": "train", "epoch": 58}
{"loss": 0.2220938801765442, "acc": 0.9285155534744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.14630655944347382, "acc": 0.9473548531532288, "length": 3.998483657836914, "mode": "train", "epoch": 59}
{"loss": 0.21907557547092438, "acc": 0.9341797232627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1415426880121231, "acc": 0.9494150876998901, "length": 3.9999146461486816, "mode": "train", "epoch": 60}
{"loss": 0.20341497659683228, "acc": 0.9287108778953552, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7610345482826233
