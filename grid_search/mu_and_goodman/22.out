ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.692604124546051, "acc": 0.5357614159584045, "length": 3.224358320236206, "mode": "train", "epoch": 1}
{"loss": 0.6864639520645142, "acc": 0.5547471642494202, "length": 1.1631944179534912, "mode": "test", "epoch": 1}
{"loss": 0.6292027235031128, "acc": 0.6818697452545166, "length": 2.994363784790039, "mode": "train", "epoch": 2}
{"loss": 0.5395832657814026, "acc": 0.736241340637207, "length": 3.368055582046509, "mode": "test", "epoch": 2}
{"loss": 0.5076760053634644, "acc": 0.7735275030136108, "length": 3.3105814456939697, "mode": "train", "epoch": 3}
{"loss": 0.4901749789714813, "acc": 0.7707682847976685, "length": 3.4201388359069824, "mode": "test", "epoch": 3}
{"loss": 0.4524965286254883, "acc": 0.801851212978363, "length": 3.7816693782806396, "mode": "train", "epoch": 4}
{"loss": 0.4550758898258209, "acc": 0.8102430105209351, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4081665277481079, "acc": 0.8260931372642517, "length": 3.9582343101501465, "mode": "train", "epoch": 5}
{"loss": 0.4362788796424866, "acc": 0.8151041865348816, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.37755492329597473, "acc": 0.8318348526954651, "length": 3.9780454635620117, "mode": "train", "epoch": 6}
{"loss": 0.4247645437717438, "acc": 0.8199653029441833, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.34091630578041077, "acc": 0.8561037182807922, "length": 3.981931209564209, "mode": "train", "epoch": 7}
{"loss": 0.3945406973361969, "acc": 0.8401041030883789, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.307323694229126, "acc": 0.8705937266349792, "length": 3.98478102684021, "mode": "train", "epoch": 8}
{"loss": 0.4233086109161377, "acc": 0.8333332538604736, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.29130861163139343, "acc": 0.876692533493042, "length": 3.990980863571167, "mode": "train", "epoch": 9}
{"loss": 0.3695109784603119, "acc": 0.8574651479721069, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.26689016819000244, "acc": 0.8863283395767212, "length": 3.988973379135132, "mode": "train", "epoch": 10}
{"loss": 0.3774612843990326, "acc": 0.8605902194976807, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.25377458333969116, "acc": 0.900813102722168, "length": 3.9930973052978516, "mode": "train", "epoch": 11}
{"loss": 0.3293677866458893, "acc": 0.8743056058883667, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.25264668464660645, "acc": 0.901256799697876, "length": 3.9905171394348145, "mode": "train", "epoch": 12}
{"loss": 0.32985150814056396, "acc": 0.8727430105209351, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.23767700791358948, "acc": 0.9054965972900391, "length": 3.993058204650879, "mode": "train", "epoch": 13}
{"loss": 0.2762396037578583, "acc": 0.8958333134651184, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.229047492146492, "acc": 0.9121859669685364, "length": 3.9924163818359375, "mode": "train", "epoch": 14}
{"loss": 0.309612900018692, "acc": 0.8852429986000061, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.22047260403633118, "acc": 0.9174692630767822, "length": 3.993950366973877, "mode": "train", "epoch": 15}
{"loss": 0.2699071764945984, "acc": 0.8878471851348877, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2022850215435028, "acc": 0.9266772270202637, "length": 3.995222568511963, "mode": "train", "epoch": 16}
{"loss": 0.254797101020813, "acc": 0.9067709445953369, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.1885097622871399, "acc": 0.9337207674980164, "length": 3.994410276412964, "mode": "train", "epoch": 17}
{"loss": 0.24940980970859528, "acc": 0.9078124165534973, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.183039590716362, "acc": 0.9355196952819824, "length": 3.9945216178894043, "mode": "train", "epoch": 18}
{"loss": 0.26114872097969055, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.17762480676174164, "acc": 0.9345574975013733, "length": 3.995621919631958, "mode": "train", "epoch": 19}
{"loss": 0.23280006647109985, "acc": 0.9164929986000061, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.16913548111915588, "acc": 0.9392980337142944, "length": 3.995046854019165, "mode": "train", "epoch": 20}
{"loss": 0.24238432943820953, "acc": 0.9159722924232483, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.15958625078201294, "acc": 0.9416317939758301, "length": 3.9958088397979736, "mode": "train", "epoch": 21}
{"loss": 0.2071056216955185, "acc": 0.9279513955116272, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.15495802462100983, "acc": 0.9425593614578247, "length": 3.9957730770111084, "mode": "train", "epoch": 22}
{"loss": 0.20115014910697937, "acc": 0.9281250834465027, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.14101524651050568, "acc": 0.947776734828949, "length": 3.9954874515533447, "mode": "train", "epoch": 23}
{"loss": 0.18972796201705933, "acc": 0.9315972924232483, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.13569582998752594, "acc": 0.9521854519844055, "length": 3.996473789215088, "mode": "train", "epoch": 24}
{"loss": 0.2040109634399414, "acc": 0.9260416030883789, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1258668750524521, "acc": 0.9524921178817749, "length": 3.998286485671997, "mode": "train", "epoch": 25}
{"loss": 0.14961522817611694, "acc": 0.9472222924232483, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.12340030819177628, "acc": 0.9532464742660522, "length": 3.9981226921081543, "mode": "train", "epoch": 26}
{"loss": 0.17746645212173462, "acc": 0.9409722089767456, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.12082299590110779, "acc": 0.9549717903137207, "length": 3.9980101585388184, "mode": "train", "epoch": 27}
{"loss": 0.1679627001285553, "acc": 0.9407985210418701, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.10934869199991226, "acc": 0.9587472677230835, "length": 3.9979803562164307, "mode": "train", "epoch": 28}
{"loss": 0.14188024401664734, "acc": 0.9505207538604736, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.11430584639310837, "acc": 0.9584622979164124, "length": 3.9972734451293945, "mode": "train", "epoch": 29}
{"loss": 0.16028481721878052, "acc": 0.9402778148651123, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.10379156470298767, "acc": 0.9605754017829895, "length": 3.998885154724121, "mode": "train", "epoch": 30}
{"loss": 0.15037430822849274, "acc": 0.9425346851348877, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.0905451625585556, "acc": 0.9672332406044006, "length": 3.998830795288086, "mode": "train", "epoch": 31}
{"loss": 0.13494239747524261, "acc": 0.9517361521720886, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.09065550565719604, "acc": 0.9662022590637207, "length": 3.999098539352417, "mode": "train", "epoch": 32}
{"loss": 0.14061714708805084, "acc": 0.949305534362793, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.08940811455249786, "acc": 0.9681851267814636, "length": 3.999300241470337, "mode": "train", "epoch": 33}
{"loss": 0.13910219073295593, "acc": 0.949305534362793, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.08830375224351883, "acc": 0.968241274356842, "length": 3.9991986751556396, "mode": "train", "epoch": 34}
{"loss": 0.13341039419174194, "acc": 0.9529513120651245, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.08741435408592224, "acc": 0.9653650522232056, "length": 3.9987802505493164, "mode": "train", "epoch": 35}
{"loss": 0.13302676379680634, "acc": 0.9505208134651184, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.0784514844417572, "acc": 0.9707386493682861, "length": 3.999392509460449, "mode": "train", "epoch": 36}
{"loss": 0.1515764594078064, "acc": 0.9421875476837158, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.08597765117883682, "acc": 0.9669169187545776, "length": 3.997962236404419, "mode": "train", "epoch": 37}
{"loss": 0.15989458560943604, "acc": 0.9402778148651123, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.09105697274208069, "acc": 0.964698076248169, "length": 3.998342275619507, "mode": "train", "epoch": 38}
{"loss": 0.13874152302742004, "acc": 0.9559028148651123, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.08146686851978302, "acc": 0.9688844084739685, "length": 3.99943208694458, "mode": "train", "epoch": 39}
{"loss": 0.16671603918075562, "acc": 0.9487847089767456, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.07953494042158127, "acc": 0.9697402715682983, "length": 3.9993343353271484, "mode": "train", "epoch": 40}
{"loss": 0.1467558890581131, "acc": 0.9592013955116272, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.07220569998025894, "acc": 0.9725431799888611, "length": 3.9995052814483643, "mode": "train", "epoch": 41}
{"loss": 0.14515872299671173, "acc": 0.9513887763023376, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.07660522311925888, "acc": 0.9711548686027527, "length": 3.9983885288238525, "mode": "train", "epoch": 42}
{"loss": 0.12593667209148407, "acc": 0.9526041746139526, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.06364499777555466, "acc": 0.9756196141242981, "length": 3.9996368885040283, "mode": "train", "epoch": 43}
{"loss": 0.11528762429952621, "acc": 0.9631944298744202, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.0652095153927803, "acc": 0.974564254283905, "length": 3.999204158782959, "mode": "train", "epoch": 44}
{"loss": 0.11263349652290344, "acc": 0.9583333134651184, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.06764696538448334, "acc": 0.9745257496833801, "length": 3.999751329421997, "mode": "train", "epoch": 45}
{"loss": 0.11519908905029297, "acc": 0.9560763835906982, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.057564690709114075, "acc": 0.9799858927726746, "length": 3.9989030361175537, "mode": "train", "epoch": 46}
{"loss": 0.114351786673069, "acc": 0.9638888835906982, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.06154487654566765, "acc": 0.9790382981300354, "length": 3.9995853900909424, "mode": "train", "epoch": 47}
{"loss": 0.13235019147396088, "acc": 0.9539930820465088, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.05125405266880989, "acc": 0.9814739227294922, "length": 3.999582290649414, "mode": "train", "epoch": 48}
{"loss": 0.10490336269140244, "acc": 0.9630208611488342, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.045600078999996185, "acc": 0.9836900234222412, "length": 3.9998090267181396, "mode": "train", "epoch": 49}
{"loss": 0.09310143440961838, "acc": 0.9680556058883667, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.051867254078388214, "acc": 0.9818165302276611, "length": 3.9991378784179688, "mode": "train", "epoch": 50}
{"loss": 0.10025406628847122, "acc": 0.9675347805023193, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04887501895427704, "acc": 0.9833428263664246, "length": 3.999796152114868, "mode": "train", "epoch": 51}
{"loss": 0.09724199026823044, "acc": 0.9692708253860474, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03863830864429474, "acc": 0.9869434833526611, "length": 3.999908208847046, "mode": "train", "epoch": 52}
{"loss": 0.10133454203605652, "acc": 0.964930534362793, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.037215135991573334, "acc": 0.987755537033081, "length": 3.9998974800109863, "mode": "train", "epoch": 53}
{"loss": 0.07759613543748856, "acc": 0.9732639789581299, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.03585235774517059, "acc": 0.9872353076934814, "length": 3.999927282333374, "mode": "train", "epoch": 54}
{"loss": 0.09224119782447815, "acc": 0.9680556058883667, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.038153983652591705, "acc": 0.9878125190734863, "length": 3.999880313873291, "mode": "train", "epoch": 55}
{"loss": 0.09392547607421875, "acc": 0.972222089767456, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.05225333943963051, "acc": 0.9820120334625244, "length": 3.9998857975006104, "mode": "train", "epoch": 56}
{"loss": 0.11164174973964691, "acc": 0.9630208611488342, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.04083579033613205, "acc": 0.9872884154319763, "length": 3.9997916221618652, "mode": "train", "epoch": 57}
{"loss": 0.1376897096633911, "acc": 0.9621527791023254, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.04465266689658165, "acc": 0.9859026670455933, "length": 3.999948501586914, "mode": "train", "epoch": 58}
{"loss": 0.13236698508262634, "acc": 0.9621527791023254, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.032355036586523056, "acc": 0.9881349205970764, "length": 3.9994001388549805, "mode": "train", "epoch": 59}
{"loss": 0.11189476400613785, "acc": 0.9670138955116272, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.033842626959085464, "acc": 0.9886512756347656, "length": 3.998871088027954, "mode": "train", "epoch": 60}
{"loss": 0.09721074998378754, "acc": 0.9703124165534973, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7756896615028381
