ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6950947046279907, "acc": 0.5067199468612671, "length": 3.5293021202087402, "mode": "train", "epoch": 1}
{"loss": 0.6941176652908325, "acc": 0.48499149084091187, "length": 1.05859375, "mode": "test", "epoch": 1}
{"loss": 0.6884225606918335, "acc": 0.5266058444976807, "length": 3.4878602027893066, "mode": "train", "epoch": 2}
{"loss": 0.680415153503418, "acc": 0.5551819205284119, "length": 2.0, "mode": "test", "epoch": 2}
{"loss": 0.6845209002494812, "acc": 0.562847375869751, "length": 3.4240610599517822, "mode": "train", "epoch": 3}
{"loss": 0.6634779572486877, "acc": 0.6605926156044006, "length": 3.00390625, "mode": "test", "epoch": 3}
{"loss": 0.6608868837356567, "acc": 0.6480519771575928, "length": 3.4759504795074463, "mode": "train", "epoch": 4}
{"loss": 0.6126226782798767, "acc": 0.6900849342346191, "length": 3.953125, "mode": "test", "epoch": 4}
{"loss": 0.5954352617263794, "acc": 0.7104127407073975, "length": 3.671182632446289, "mode": "train", "epoch": 5}
{"loss": 0.5384795069694519, "acc": 0.7486328482627869, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.49753811955451965, "acc": 0.7710754871368408, "length": 3.8711020946502686, "mode": "train", "epoch": 6}
{"loss": 0.4965166449546814, "acc": 0.7867187857627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.44923996925354004, "acc": 0.8022142648696899, "length": 3.937958240509033, "mode": "train", "epoch": 7}
{"loss": 0.4904906749725342, "acc": 0.7888671159744263, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.44136476516723633, "acc": 0.8029549717903137, "length": 3.9482626914978027, "mode": "train", "epoch": 8}
{"loss": 0.48011356592178345, "acc": 0.8009766340255737, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4173046946525574, "acc": 0.8089348673820496, "length": 3.9568963050842285, "mode": "train", "epoch": 9}
{"loss": 0.5080996751785278, "acc": 0.8031249642372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4155068099498749, "acc": 0.8124885559082031, "length": 3.9662272930145264, "mode": "train", "epoch": 10}
{"loss": 0.5296728610992432, "acc": 0.8009766340255737, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.41144272685050964, "acc": 0.816999614238739, "length": 3.9742705821990967, "mode": "train", "epoch": 11}
{"loss": 0.471818745136261, "acc": 0.8025389909744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3959466516971588, "acc": 0.8243325352668762, "length": 3.9796640872955322, "mode": "train", "epoch": 12}
{"loss": 0.43871933221817017, "acc": 0.798828125, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3731211721897125, "acc": 0.8278446197509766, "length": 3.9810516834259033, "mode": "train", "epoch": 13}
{"loss": 0.4242592453956604, "acc": 0.8003907203674316, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3710153102874756, "acc": 0.8421300649642944, "length": 3.9889373779296875, "mode": "train", "epoch": 14}
{"loss": 0.4213850498199463, "acc": 0.8015623688697815, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.35961803793907166, "acc": 0.8459597826004028, "length": 3.9910566806793213, "mode": "train", "epoch": 15}
{"loss": 0.41946089267730713, "acc": 0.8089843392372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.35240015387535095, "acc": 0.8513451218605042, "length": 3.992772102355957, "mode": "train", "epoch": 16}
{"loss": 0.40525633096694946, "acc": 0.8226561546325684, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.34400081634521484, "acc": 0.8553000688552856, "length": 3.993436336517334, "mode": "train", "epoch": 17}
{"loss": 0.40265071392059326, "acc": 0.8265624642372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.33562421798706055, "acc": 0.8635081648826599, "length": 3.9940059185028076, "mode": "train", "epoch": 18}
{"loss": 0.37671858072280884, "acc": 0.8406249284744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3171965479850769, "acc": 0.8664168119430542, "length": 3.996022939682007, "mode": "train", "epoch": 19}
{"loss": 0.37039685249328613, "acc": 0.8480468392372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3040204644203186, "acc": 0.8703840970993042, "length": 3.9958717823028564, "mode": "train", "epoch": 20}
{"loss": 0.3643513023853302, "acc": 0.8447265028953552, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2989303171634674, "acc": 0.873992383480072, "length": 3.9974584579467773, "mode": "train", "epoch": 21}
{"loss": 0.3603545129299164, "acc": 0.8511719107627869, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.29303303360939026, "acc": 0.8801729083061218, "length": 3.9962098598480225, "mode": "train", "epoch": 22}
{"loss": 0.3668396472930908, "acc": 0.8562499284744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.28412488102912903, "acc": 0.8901611566543579, "length": 3.997523546218872, "mode": "train", "epoch": 23}
{"loss": 0.3646453619003296, "acc": 0.8582030534744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.27870064973831177, "acc": 0.8914579749107361, "length": 3.9974746704101562, "mode": "train", "epoch": 24}
{"loss": 0.3249589800834656, "acc": 0.8742188215255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.26999303698539734, "acc": 0.8947197794914246, "length": 3.998743772506714, "mode": "train", "epoch": 25}
{"loss": 0.30875363945961, "acc": 0.8826170563697815, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2626244127750397, "acc": 0.8992913365364075, "length": 3.996384382247925, "mode": "train", "epoch": 26}
{"loss": 0.30713561177253723, "acc": 0.8826173543930054, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.257602334022522, "acc": 0.9025700092315674, "length": 3.998666524887085, "mode": "train", "epoch": 27}
{"loss": 0.3032183051109314, "acc": 0.8806639313697815, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2506987750530243, "acc": 0.9021660685539246, "length": 3.999157667160034, "mode": "train", "epoch": 28}
{"loss": 0.30286797881126404, "acc": 0.8863281607627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.24331393837928772, "acc": 0.9090619683265686, "length": 3.998333692550659, "mode": "train", "epoch": 29}
{"loss": 0.2884024977684021, "acc": 0.8898438811302185, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2340618371963501, "acc": 0.9135798215866089, "length": 3.9980506896972656, "mode": "train", "epoch": 30}
{"loss": 0.27554306387901306, "acc": 0.8966797590255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2353428155183792, "acc": 0.9136765003204346, "length": 3.9993112087249756, "mode": "train", "epoch": 31}
{"loss": 0.286613792181015, "acc": 0.8990235328674316, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.23219312727451324, "acc": 0.9167538285255432, "length": 3.999422311782837, "mode": "train", "epoch": 32}
{"loss": 0.27929437160491943, "acc": 0.8916015625, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.222306028008461, "acc": 0.9220645427703857, "length": 3.99950909614563, "mode": "train", "epoch": 33}
{"loss": 0.2652384042739868, "acc": 0.8982420563697815, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.22228525578975677, "acc": 0.9193529486656189, "length": 3.9995226860046387, "mode": "train", "epoch": 34}
{"loss": 0.27211979031562805, "acc": 0.8921875357627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21557150781154633, "acc": 0.9199426174163818, "length": 3.99961256980896, "mode": "train", "epoch": 35}
{"loss": 0.2658330500125885, "acc": 0.90234375, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21286891400814056, "acc": 0.9239518046379089, "length": 3.9994919300079346, "mode": "train", "epoch": 36}
{"loss": 0.2699861526489258, "acc": 0.8955077528953552, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.20676250755786896, "acc": 0.9244148135185242, "length": 3.998728036880493, "mode": "train", "epoch": 37}
{"loss": 0.2662339508533478, "acc": 0.8996094465255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.20296894013881683, "acc": 0.9240092635154724, "length": 3.9992692470550537, "mode": "train", "epoch": 38}
{"loss": 0.2717568278312683, "acc": 0.8988280892372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20719696581363678, "acc": 0.922713577747345, "length": 3.9995369911193848, "mode": "train", "epoch": 39}
{"loss": 0.2630263864994049, "acc": 0.9013671875, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.20370973646640778, "acc": 0.9282720685005188, "length": 3.9998838901519775, "mode": "train", "epoch": 40}
{"loss": 0.27600157260894775, "acc": 0.8966798186302185, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.20207440853118896, "acc": 0.9266111254692078, "length": 3.9964849948883057, "mode": "train", "epoch": 41}
{"loss": 0.27335551381111145, "acc": 0.8998046517372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2032744437456131, "acc": 0.9256041049957275, "length": 3.9987916946411133, "mode": "train", "epoch": 42}
{"loss": 0.2797166705131531, "acc": 0.8996094465255737, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.20377789437770844, "acc": 0.9240809082984924, "length": 3.999830722808838, "mode": "train", "epoch": 43}
{"loss": 0.28443437814712524, "acc": 0.9046874642372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1985345333814621, "acc": 0.9290409684181213, "length": 3.9997355937957764, "mode": "train", "epoch": 44}
{"loss": 0.26545414328575134, "acc": 0.9013671875, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.19342991709709167, "acc": 0.9327553510665894, "length": 3.9998319149017334, "mode": "train", "epoch": 45}
{"loss": 0.2635607123374939, "acc": 0.9052734375, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1901424378156662, "acc": 0.9309727549552917, "length": 3.9996836185455322, "mode": "train", "epoch": 46}
{"loss": 0.25842994451522827, "acc": 0.9093750715255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.17733944952487946, "acc": 0.9359249472618103, "length": 3.9995017051696777, "mode": "train", "epoch": 47}
{"loss": 0.254435658454895, "acc": 0.9070311784744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1801893562078476, "acc": 0.9375433325767517, "length": 3.9999783039093018, "mode": "train", "epoch": 48}
{"loss": 0.24523890018463135, "acc": 0.9123047590255737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.18270452320575714, "acc": 0.9358909130096436, "length": 3.999976873397827, "mode": "train", "epoch": 49}
{"loss": 0.2572505474090576, "acc": 0.9126953482627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1838892549276352, "acc": 0.9334695935249329, "length": 3.999959707260132, "mode": "train", "epoch": 50}
{"loss": 0.25199466943740845, "acc": 0.908203125, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17123624682426453, "acc": 0.9353006482124329, "length": 3.999988079071045, "mode": "train", "epoch": 51}
{"loss": 0.24577876925468445, "acc": 0.9126953482627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.17255578935146332, "acc": 0.9380751848220825, "length": 3.999980926513672, "mode": "train", "epoch": 52}
{"loss": 0.22434040904045105, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1736823469400406, "acc": 0.9390756487846375, "length": 3.9999217987060547, "mode": "train", "epoch": 53}
{"loss": 0.24883320927619934, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.16692101955413818, "acc": 0.9380748271942139, "length": 3.999955415725708, "mode": "train", "epoch": 54}
{"loss": 0.24285274744033813, "acc": 0.9171875715255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.16038914024829865, "acc": 0.9402587413787842, "length": 3.9999802112579346, "mode": "train", "epoch": 55}
{"loss": 0.24085396528244019, "acc": 0.9158202409744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.16311714053153992, "acc": 0.9401192665100098, "length": 3.9996745586395264, "mode": "train", "epoch": 56}
{"loss": 0.25837191939353943, "acc": 0.9134765267372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.16428323090076447, "acc": 0.9413217306137085, "length": 3.999985933303833, "mode": "train", "epoch": 57}
{"loss": 0.24550464749336243, "acc": 0.9197264909744263, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.15574140846729279, "acc": 0.9440677165985107, "length": 3.9986348152160645, "mode": "train", "epoch": 58}
{"loss": 0.23948168754577637, "acc": 0.9142578840255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15454040467739105, "acc": 0.9435062408447266, "length": 3.9999945163726807, "mode": "train", "epoch": 59}
{"loss": 0.23137429356575012, "acc": 0.9255858659744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14944645762443542, "acc": 0.9462769627571106, "length": 3.9998748302459717, "mode": "train", "epoch": 60}
{"loss": 0.22737917304039001, "acc": 0.9304686784744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7983871102333069
