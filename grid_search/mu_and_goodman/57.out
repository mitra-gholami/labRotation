ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6956652402877808, "acc": 0.5181882381439209, "length": 3.5784382820129395, "mode": "train", "epoch": 1}
{"loss": 0.6910175085067749, "acc": 0.537922739982605, "length": 3.98828125, "mode": "test", "epoch": 1}
{"loss": 0.6888012290000916, "acc": 0.5459511280059814, "length": 3.560659646987915, "mode": "train", "epoch": 2}
{"loss": 0.688507080078125, "acc": 0.5578124523162842, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.6892663240432739, "acc": 0.5441567301750183, "length": 3.560149908065796, "mode": "train", "epoch": 3}
{"loss": 0.668721079826355, "acc": 0.6259765028953552, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.6865195631980896, "acc": 0.5538344979286194, "length": 3.562049150466919, "mode": "train", "epoch": 4}
{"loss": 0.6619158387184143, "acc": 0.6380859017372131, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.6814481616020203, "acc": 0.570132851600647, "length": 3.550534248352051, "mode": "train", "epoch": 5}
{"loss": 0.6537709832191467, "acc": 0.6505860686302185, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.6683898568153381, "acc": 0.6130656599998474, "length": 3.6691653728485107, "mode": "train", "epoch": 6}
{"loss": 0.641844630241394, "acc": 0.6591796875, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.6416723132133484, "acc": 0.6626222729682922, "length": 3.8017771244049072, "mode": "train", "epoch": 7}
{"loss": 0.6201504468917847, "acc": 0.6943359375, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.6028891205787659, "acc": 0.7220030426979065, "length": 3.8901240825653076, "mode": "train", "epoch": 8}
{"loss": 0.5817258358001709, "acc": 0.7232422232627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5581472516059875, "acc": 0.7336455583572388, "length": 3.937427282333374, "mode": "train", "epoch": 9}
{"loss": 0.5566302537918091, "acc": 0.7316405773162842, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.523922860622406, "acc": 0.7419090270996094, "length": 3.968027114868164, "mode": "train", "epoch": 10}
{"loss": 0.554565966129303, "acc": 0.7269530892372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5028889775276184, "acc": 0.7678470611572266, "length": 3.9730448722839355, "mode": "train", "epoch": 11}
{"loss": 0.5298441648483276, "acc": 0.7603516578674316, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.47415241599082947, "acc": 0.7799106240272522, "length": 3.971621513366699, "mode": "train", "epoch": 12}
{"loss": 0.4925578832626343, "acc": 0.7796874642372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4455164074897766, "acc": 0.8004266619682312, "length": 3.9812850952148438, "mode": "train", "epoch": 13}
{"loss": 0.4697999954223633, "acc": 0.7845702767372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4251313805580139, "acc": 0.8015296459197998, "length": 3.9883623123168945, "mode": "train", "epoch": 14}
{"loss": 0.45694243907928467, "acc": 0.7986328601837158, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3977430760860443, "acc": 0.8119118809700012, "length": 3.9868555068969727, "mode": "train", "epoch": 15}
{"loss": 0.4361298680305481, "acc": 0.802734375, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.37996140122413635, "acc": 0.8380934596061707, "length": 3.9886486530303955, "mode": "train", "epoch": 16}
{"loss": 0.4226709008216858, "acc": 0.8205078840255737, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3628416061401367, "acc": 0.8494887351989746, "length": 3.9942476749420166, "mode": "train", "epoch": 17}
{"loss": 0.41369080543518066, "acc": 0.8298827409744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.34374862909317017, "acc": 0.8551647067070007, "length": 3.991386651992798, "mode": "train", "epoch": 18}
{"loss": 0.413520872592926, "acc": 0.8253907561302185, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3340010643005371, "acc": 0.8553141355514526, "length": 3.9923202991485596, "mode": "train", "epoch": 19}
{"loss": 0.3974645733833313, "acc": 0.8294920921325684, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3302755653858185, "acc": 0.8599212765693665, "length": 3.9964687824249268, "mode": "train", "epoch": 20}
{"loss": 0.39186549186706543, "acc": 0.8335937857627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.32728734612464905, "acc": 0.8604623079299927, "length": 3.9967594146728516, "mode": "train", "epoch": 21}
{"loss": 0.38089096546173096, "acc": 0.8355469107627869, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3186425268650055, "acc": 0.8658726811408997, "length": 3.9932284355163574, "mode": "train", "epoch": 22}
{"loss": 0.3722332715988159, "acc": 0.8388671875, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.32028332352638245, "acc": 0.8647972345352173, "length": 3.9979093074798584, "mode": "train", "epoch": 23}
{"loss": 0.38887637853622437, "acc": 0.8388672471046448, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3175664246082306, "acc": 0.8641334772109985, "length": 3.998842239379883, "mode": "train", "epoch": 24}
{"loss": 0.3831862211227417, "acc": 0.833984375, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3187248706817627, "acc": 0.8636651635169983, "length": 3.9983601570129395, "mode": "train", "epoch": 25}
{"loss": 0.3761444687843323, "acc": 0.8427734971046448, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.3159753978252411, "acc": 0.8654627799987793, "length": 3.9987692832946777, "mode": "train", "epoch": 26}
{"loss": 0.3608943223953247, "acc": 0.8445311784744263, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3119855225086212, "acc": 0.8665817975997925, "length": 3.993914842605591, "mode": "train", "epoch": 27}
{"loss": 0.36040055751800537, "acc": 0.8468751311302185, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.31034794449806213, "acc": 0.8711594343185425, "length": 3.9992027282714844, "mode": "train", "epoch": 28}
{"loss": 0.3472951650619507, "acc": 0.8544921875, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.30544617772102356, "acc": 0.8694166541099548, "length": 3.9979448318481445, "mode": "train", "epoch": 29}
{"loss": 0.35247647762298584, "acc": 0.8451171517372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3049026429653168, "acc": 0.8673734664916992, "length": 3.9967544078826904, "mode": "train", "epoch": 30}
{"loss": 0.354367196559906, "acc": 0.8537110686302185, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.30258283019065857, "acc": 0.8735378384590149, "length": 3.998542547225952, "mode": "train", "epoch": 31}
{"loss": 0.3416590988636017, "acc": 0.8585938215255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3043201267719269, "acc": 0.8721298575401306, "length": 3.9980406761169434, "mode": "train", "epoch": 32}
{"loss": 0.3501853048801422, "acc": 0.8513671159744263, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.30388113856315613, "acc": 0.8690211176872253, "length": 3.99914813041687, "mode": "train", "epoch": 33}
{"loss": 0.3399689197540283, "acc": 0.8574218153953552, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.30029481649398804, "acc": 0.8716188669204712, "length": 3.9987685680389404, "mode": "train", "epoch": 34}
{"loss": 0.33887937664985657, "acc": 0.8566407561302185, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2992863655090332, "acc": 0.8740485906600952, "length": 3.9984028339385986, "mode": "train", "epoch": 35}
{"loss": 0.34671545028686523, "acc": 0.8517578840255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2963305115699768, "acc": 0.8750554323196411, "length": 3.9997947216033936, "mode": "train", "epoch": 36}
{"loss": 0.3295106887817383, "acc": 0.8630858659744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2935853600502014, "acc": 0.8737186193466187, "length": 3.9996867179870605, "mode": "train", "epoch": 37}
{"loss": 0.3337463140487671, "acc": 0.8564453721046448, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.29245612025260925, "acc": 0.8708954453468323, "length": 3.996457099914551, "mode": "train", "epoch": 38}
{"loss": 0.33271774649620056, "acc": 0.8568359017372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2942139208316803, "acc": 0.8702357411384583, "length": 3.9994425773620605, "mode": "train", "epoch": 39}
{"loss": 0.33189016580581665, "acc": 0.8603515028953552, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2921147346496582, "acc": 0.8752800822257996, "length": 3.9994640350341797, "mode": "train", "epoch": 40}
{"loss": 0.33258557319641113, "acc": 0.8566406965255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.29216623306274414, "acc": 0.8731964230537415, "length": 3.998528003692627, "mode": "train", "epoch": 41}
{"loss": 0.3370886445045471, "acc": 0.8552733659744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.29099979996681213, "acc": 0.8725624680519104, "length": 3.999828577041626, "mode": "train", "epoch": 42}
{"loss": 0.3301711678504944, "acc": 0.8636718392372131, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2856893837451935, "acc": 0.8716316223144531, "length": 3.9992103576660156, "mode": "train", "epoch": 43}
{"loss": 0.33724403381347656, "acc": 0.8554688096046448, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.28954383730888367, "acc": 0.8749397993087769, "length": 3.999823570251465, "mode": "train", "epoch": 44}
{"loss": 0.3284558057785034, "acc": 0.8580078482627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2861386835575104, "acc": 0.8767260909080505, "length": 3.999173641204834, "mode": "train", "epoch": 45}
{"loss": 0.32379618287086487, "acc": 0.8638672232627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.28669241070747375, "acc": 0.8772014379501343, "length": 3.9998669624328613, "mode": "train", "epoch": 46}
{"loss": 0.319582998752594, "acc": 0.8644531965255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2838767468929291, "acc": 0.8780703544616699, "length": 3.999361515045166, "mode": "train", "epoch": 47}
{"loss": 0.3218076825141907, "acc": 0.8597655892372131, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2828393876552582, "acc": 0.8775903582572937, "length": 3.9991419315338135, "mode": "train", "epoch": 48}
{"loss": 0.3247096538543701, "acc": 0.8615235686302185, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.283382385969162, "acc": 0.8769822120666504, "length": 3.99832820892334, "mode": "train", "epoch": 49}
{"loss": 0.3253571093082428, "acc": 0.8578124642372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.28589367866516113, "acc": 0.8740124702453613, "length": 3.9999029636383057, "mode": "train", "epoch": 50}
{"loss": 0.3296055793762207, "acc": 0.861328125, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2811071276664734, "acc": 0.8784084320068359, "length": 3.999485731124878, "mode": "train", "epoch": 51}
{"loss": 0.32160255312919617, "acc": 0.8593749403953552, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2796749472618103, "acc": 0.8788795471191406, "length": 3.999706506729126, "mode": "train", "epoch": 52}
{"loss": 0.32406699657440186, "acc": 0.8621092438697815, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.28008848428726196, "acc": 0.8801549077033997, "length": 3.999790906906128, "mode": "train", "epoch": 53}
{"loss": 0.3225017488002777, "acc": 0.8599609732627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2792227268218994, "acc": 0.8792911767959595, "length": 3.997572660446167, "mode": "train", "epoch": 54}
{"loss": 0.326587975025177, "acc": 0.8611329793930054, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2813648283481598, "acc": 0.8787052035331726, "length": 3.9997034072875977, "mode": "train", "epoch": 55}
{"loss": 0.3235931992530823, "acc": 0.8607422113418579, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.27773091197013855, "acc": 0.8783406615257263, "length": 3.999041795730591, "mode": "train", "epoch": 56}
{"loss": 0.3155055046081543, "acc": 0.8636718392372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2775326371192932, "acc": 0.8783603310585022, "length": 3.999821662902832, "mode": "train", "epoch": 57}
{"loss": 0.33445656299591064, "acc": 0.8636718988418579, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2798689305782318, "acc": 0.8756937384605408, "length": 3.9996485710144043, "mode": "train", "epoch": 58}
{"loss": 0.3304829001426697, "acc": 0.8574218153953552, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2806611657142639, "acc": 0.8802193999290466, "length": 3.999953269958496, "mode": "train", "epoch": 59}
{"loss": 0.3215072751045227, "acc": 0.8634766340255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.2793295979499817, "acc": 0.8783637285232544, "length": 3.999957799911499, "mode": "train", "epoch": 60}
{"loss": 0.32173824310302734, "acc": 0.8634766340255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7215517163276672
