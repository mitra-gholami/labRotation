ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6913142800331116, "acc": 0.5364989638328552, "length": 3.3479957580566406, "mode": "train", "epoch": 1}
{"loss": 0.67503422498703, "acc": 0.561755359172821, "length": 2.125, "mode": "test", "epoch": 1}
{"loss": 0.6158610582351685, "acc": 0.6729541420936584, "length": 3.317608594894409, "mode": "train", "epoch": 2}
{"loss": 0.5190454721450806, "acc": 0.7546874284744263, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.4611137807369232, "acc": 0.7850924730300903, "length": 3.9093568325042725, "mode": "train", "epoch": 3}
{"loss": 0.4163822829723358, "acc": 0.8318358063697815, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.36751142144203186, "acc": 0.8486608266830444, "length": 3.969963788986206, "mode": "train", "epoch": 4}
{"loss": 0.36295968294143677, "acc": 0.85546875, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.31982654333114624, "acc": 0.8763308525085449, "length": 3.9780330657958984, "mode": "train", "epoch": 5}
{"loss": 0.3462580740451813, "acc": 0.8736328482627869, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.29848694801330566, "acc": 0.8830156922340393, "length": 3.9869396686553955, "mode": "train", "epoch": 6}
{"loss": 0.3133089542388916, "acc": 0.8791016340255737, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.28052714467048645, "acc": 0.8928715586662292, "length": 3.9890260696411133, "mode": "train", "epoch": 7}
{"loss": 0.30593395233154297, "acc": 0.8880859017372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.26805880665779114, "acc": 0.8954628109931946, "length": 3.992309808731079, "mode": "train", "epoch": 8}
{"loss": 0.29923251271247864, "acc": 0.8830078840255737, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.2616000473499298, "acc": 0.8955365419387817, "length": 3.9934184551239014, "mode": "train", "epoch": 9}
{"loss": 0.2898608446121216, "acc": 0.8867188096046448, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.2548779547214508, "acc": 0.9008493423461914, "length": 3.9959051609039307, "mode": "train", "epoch": 10}
{"loss": 0.28766539692878723, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.24182499945163727, "acc": 0.9041448831558228, "length": 3.99495792388916, "mode": "train", "epoch": 11}
{"loss": 0.2699376344680786, "acc": 0.9003906846046448, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.23393619060516357, "acc": 0.9108169078826904, "length": 3.9967541694641113, "mode": "train", "epoch": 12}
{"loss": 0.28140467405319214, "acc": 0.8773437142372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.23155544698238373, "acc": 0.9072361588478088, "length": 3.9967246055603027, "mode": "train", "epoch": 13}
{"loss": 0.29274335503578186, "acc": 0.8914061784744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.227549746632576, "acc": 0.9118738770484924, "length": 3.9970862865448, "mode": "train", "epoch": 14}
{"loss": 0.27074316143989563, "acc": 0.9000000357627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.21443241834640503, "acc": 0.9142150282859802, "length": 3.996851921081543, "mode": "train", "epoch": 15}
{"loss": 0.26236096024513245, "acc": 0.8892578482627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.21577192842960358, "acc": 0.9132203459739685, "length": 3.9969563484191895, "mode": "train", "epoch": 16}
{"loss": 0.2653423249721527, "acc": 0.8968749642372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.20120929181575775, "acc": 0.9193258285522461, "length": 3.997802495956421, "mode": "train", "epoch": 17}
{"loss": 0.2414143830537796, "acc": 0.9087890982627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.19621554017066956, "acc": 0.9207854866981506, "length": 3.997770071029663, "mode": "train", "epoch": 18}
{"loss": 0.2640606462955475, "acc": 0.8998045921325684, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.19398055970668793, "acc": 0.9255948662757874, "length": 3.9981470108032227, "mode": "train", "epoch": 19}
{"loss": 0.23189549148082733, "acc": 0.9187499284744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.18743877112865448, "acc": 0.927711009979248, "length": 3.998598337173462, "mode": "train", "epoch": 20}
{"loss": 0.23193225264549255, "acc": 0.9136719107627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.18238651752471924, "acc": 0.9272952675819397, "length": 3.9980742931365967, "mode": "train", "epoch": 21}
{"loss": 0.24135863780975342, "acc": 0.9128905534744263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.1768767535686493, "acc": 0.9346622228622437, "length": 3.997913122177124, "mode": "train", "epoch": 22}
{"loss": 0.23945166170597076, "acc": 0.9124999642372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.16506074368953705, "acc": 0.9349825382232666, "length": 3.998945951461792, "mode": "train", "epoch": 23}
{"loss": 0.23700964450836182, "acc": 0.9187499284744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.16207149624824524, "acc": 0.9379149079322815, "length": 3.998955488204956, "mode": "train", "epoch": 24}
{"loss": 0.21658407151699066, "acc": 0.9189453721046448, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.16441529989242554, "acc": 0.935519278049469, "length": 3.9991934299468994, "mode": "train", "epoch": 25}
{"loss": 0.20865893363952637, "acc": 0.923828125, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.15496356785297394, "acc": 0.9428369998931885, "length": 3.99922776222229, "mode": "train", "epoch": 26}
{"loss": 0.20669373869895935, "acc": 0.9250000715255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1370256543159485, "acc": 0.9490303993225098, "length": 3.998735189437866, "mode": "train", "epoch": 27}
{"loss": 0.18341583013534546, "acc": 0.9267578125, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.132242813706398, "acc": 0.9507949352264404, "length": 3.9987165927886963, "mode": "train", "epoch": 28}
{"loss": 0.1797943264245987, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.1267123818397522, "acc": 0.9514856338500977, "length": 3.9988181591033936, "mode": "train", "epoch": 29}
{"loss": 0.18093211948871613, "acc": 0.9406250715255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.12104038149118423, "acc": 0.9554260969161987, "length": 3.999260187149048, "mode": "train", "epoch": 30}
{"loss": 0.166584312915802, "acc": 0.9359374642372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.11421309411525726, "acc": 0.9588191509246826, "length": 3.9993600845336914, "mode": "train", "epoch": 31}
{"loss": 0.15994535386562347, "acc": 0.9416016340255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.11007367819547653, "acc": 0.9587610960006714, "length": 3.999004602432251, "mode": "train", "epoch": 32}
{"loss": 0.14939740300178528, "acc": 0.9455078840255737, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.10182727873325348, "acc": 0.9632691144943237, "length": 3.99934983253479, "mode": "train", "epoch": 33}
{"loss": 0.17116373777389526, "acc": 0.9429687857627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.10317526757717133, "acc": 0.9600529074668884, "length": 3.999175548553467, "mode": "train", "epoch": 34}
{"loss": 0.15806545317173004, "acc": 0.9429687857627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1041656881570816, "acc": 0.9599868655204773, "length": 3.998967170715332, "mode": "train", "epoch": 35}
{"loss": 0.1479266881942749, "acc": 0.9521484971046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.0993952602148056, "acc": 0.9632147550582886, "length": 3.99938702583313, "mode": "train", "epoch": 36}
{"loss": 0.14410169422626495, "acc": 0.9503906965255737, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.08673233538866043, "acc": 0.9680801630020142, "length": 3.9988741874694824, "mode": "train", "epoch": 37}
{"loss": 0.14856989681720734, "acc": 0.9509764909744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.08591316640377045, "acc": 0.9696614742279053, "length": 3.9996821880340576, "mode": "train", "epoch": 38}
{"loss": 0.17114989459514618, "acc": 0.9517578482627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.08379246294498444, "acc": 0.97100830078125, "length": 3.9996225833892822, "mode": "train", "epoch": 39}
{"loss": 0.16630719602108002, "acc": 0.9458984732627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.08177774399518967, "acc": 0.9696001410484314, "length": 3.999490737915039, "mode": "train", "epoch": 40}
{"loss": 0.1464429497718811, "acc": 0.9591797590255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08211126178503036, "acc": 0.9701341390609741, "length": 3.9997718334198, "mode": "train", "epoch": 41}
{"loss": 0.19097310304641724, "acc": 0.9482421278953552, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.07661846280097961, "acc": 0.9730620384216309, "length": 3.999796152114868, "mode": "train", "epoch": 42}
{"loss": 0.157094806432724, "acc": 0.9505859613418579, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08230704814195633, "acc": 0.9706549644470215, "length": 3.9995901584625244, "mode": "train", "epoch": 43}
{"loss": 0.15124370157718658, "acc": 0.9541015625, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06872612237930298, "acc": 0.9745228886604309, "length": 3.9997358322143555, "mode": "train", "epoch": 44}
{"loss": 0.15093879401683807, "acc": 0.9552735686302185, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.059611883014440536, "acc": 0.9777634143829346, "length": 3.9987335205078125, "mode": "train", "epoch": 45}
{"loss": 0.13821683824062347, "acc": 0.9619140028953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.050641369074583054, "acc": 0.9839729070663452, "length": 3.999347686767578, "mode": "train", "epoch": 46}
{"loss": 0.1234804317355156, "acc": 0.9648436903953552, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.053505681455135345, "acc": 0.9812005758285522, "length": 3.9998579025268555, "mode": "train", "epoch": 47}
{"loss": 0.11192534863948822, "acc": 0.9632812142372131, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.058185406029224396, "acc": 0.979270339012146, "length": 3.9998905658721924, "mode": "train", "epoch": 48}
{"loss": 0.14779946208000183, "acc": 0.9617186784744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.05693208798766136, "acc": 0.9797992706298828, "length": 3.9999423027038574, "mode": "train", "epoch": 49}
{"loss": 0.16367244720458984, "acc": 0.9646483659744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.05769546702504158, "acc": 0.9807327389717102, "length": 3.999807357788086, "mode": "train", "epoch": 50}
{"loss": 0.1517203003168106, "acc": 0.9544921517372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.05630696564912796, "acc": 0.9784523248672485, "length": 3.9999325275421143, "mode": "train", "epoch": 51}
{"loss": 0.1795024573802948, "acc": 0.9498047232627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.08041306585073471, "acc": 0.9713680148124695, "length": 3.9999208450317383, "mode": "train", "epoch": 52}
{"loss": 0.15089504420757294, "acc": 0.9572266340255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06721395254135132, "acc": 0.9768068790435791, "length": 3.999777317047119, "mode": "train", "epoch": 53}
{"loss": 0.15922874212265015, "acc": 0.9501953125, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.05396956577897072, "acc": 0.9829554557800293, "length": 3.999802350997925, "mode": "train", "epoch": 54}
{"loss": 0.11987531185150146, "acc": 0.9679688215255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.044854193925857544, "acc": 0.9836632609367371, "length": 3.999936580657959, "mode": "train", "epoch": 55}
{"loss": 0.1297295093536377, "acc": 0.9666014909744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.04046071320772171, "acc": 0.9854194521903992, "length": 3.999945640563965, "mode": "train", "epoch": 56}
{"loss": 0.12207941710948944, "acc": 0.9658203125, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.03448818624019623, "acc": 0.9907878637313843, "length": 3.9991159439086914, "mode": "train", "epoch": 57}
{"loss": 0.11083734780550003, "acc": 0.9716796875, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.03760635107755661, "acc": 0.9874691367149353, "length": 3.9999465942382812, "mode": "train", "epoch": 58}
{"loss": 0.09545127302408218, "acc": 0.9722656607627869, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03989165276288986, "acc": 0.9882299304008484, "length": 3.9999358654022217, "mode": "train", "epoch": 59}
{"loss": 0.12318428605794907, "acc": 0.9642577767372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.03993654251098633, "acc": 0.9855355024337769, "length": 3.9995462894439697, "mode": "train", "epoch": 60}
{"loss": 0.13220292329788208, "acc": 0.966796875, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.814833402633667
