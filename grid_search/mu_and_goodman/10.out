ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6938846111297607, "acc": 0.5254898071289062, "length": 3.4676899909973145, "mode": "train", "epoch": 1}
{"loss": 0.6806750297546387, "acc": 0.5795897841453552, "length": 1.6319444179534912, "mode": "test", "epoch": 1}
{"loss": 0.6790627837181091, "acc": 0.5711096525192261, "length": 3.245819091796875, "mode": "train", "epoch": 2}
{"loss": 0.6395799517631531, "acc": 0.6928603053092957, "length": 3.4270832538604736, "mode": "test", "epoch": 2}
{"loss": 0.5835873484611511, "acc": 0.7229516506195068, "length": 3.5711498260498047, "mode": "train", "epoch": 3}
{"loss": 0.5399611592292786, "acc": 0.7595486044883728, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.47452735900878906, "acc": 0.7945454716682434, "length": 3.8948633670806885, "mode": "train", "epoch": 4}
{"loss": 0.4822552502155304, "acc": 0.7967013120651245, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.41399991512298584, "acc": 0.8264068961143494, "length": 3.9560837745666504, "mode": "train", "epoch": 5}
{"loss": 0.45788681507110596, "acc": 0.8175346851348877, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3810279965400696, "acc": 0.8440203666687012, "length": 3.972027540206909, "mode": "train", "epoch": 6}
{"loss": 0.4509545564651489, "acc": 0.8140624165534973, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.357880562543869, "acc": 0.8475204706192017, "length": 3.9795031547546387, "mode": "train", "epoch": 7}
{"loss": 0.4322557747364044, "acc": 0.8201388120651245, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3335561752319336, "acc": 0.8590388298034668, "length": 3.9813287258148193, "mode": "train", "epoch": 8}
{"loss": 0.43867290019989014, "acc": 0.8222222924232483, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.31765827536582947, "acc": 0.8635150790214539, "length": 3.9828455448150635, "mode": "train", "epoch": 9}
{"loss": 0.4306376874446869, "acc": 0.8232638239860535, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3093397915363312, "acc": 0.8699941039085388, "length": 3.9859981536865234, "mode": "train", "epoch": 10}
{"loss": 0.40854302048683167, "acc": 0.839062511920929, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3009171783924103, "acc": 0.8758427500724792, "length": 3.9886460304260254, "mode": "train", "epoch": 11}
{"loss": 0.41106706857681274, "acc": 0.8447917103767395, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2981903553009033, "acc": 0.8739501237869263, "length": 3.9930500984191895, "mode": "train", "epoch": 12}
{"loss": 0.3736673891544342, "acc": 0.8605902194976807, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.28724557161331177, "acc": 0.8833068013191223, "length": 3.9932456016540527, "mode": "train", "epoch": 13}
{"loss": 0.36474931240081787, "acc": 0.8583332896232605, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.29084450006484985, "acc": 0.8814817070960999, "length": 3.993143320083618, "mode": "train", "epoch": 14}
{"loss": 0.36586666107177734, "acc": 0.8498263955116272, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2841527462005615, "acc": 0.8811600804328918, "length": 3.995424509048462, "mode": "train", "epoch": 15}
{"loss": 0.36118754744529724, "acc": 0.8517361879348755, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.27659618854522705, "acc": 0.886310338973999, "length": 3.9949586391448975, "mode": "train", "epoch": 16}
{"loss": 0.3461849093437195, "acc": 0.8618054986000061, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2702101469039917, "acc": 0.8887565732002258, "length": 3.9962656497955322, "mode": "train", "epoch": 17}
{"loss": 0.3432413339614868, "acc": 0.8649305105209351, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2673313319683075, "acc": 0.8888640403747559, "length": 3.9946212768554688, "mode": "train", "epoch": 18}
{"loss": 0.340862900018692, "acc": 0.8689236044883728, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.26596859097480774, "acc": 0.8905529975891113, "length": 3.9962666034698486, "mode": "train", "epoch": 19}
{"loss": 0.3339666724205017, "acc": 0.8652777075767517, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2565593421459198, "acc": 0.8940336108207703, "length": 3.9961390495300293, "mode": "train", "epoch": 20}
{"loss": 0.3255542516708374, "acc": 0.8774304389953613, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2475646585226059, "acc": 0.8943782448768616, "length": 3.995877981185913, "mode": "train", "epoch": 21}
{"loss": 0.3155362606048584, "acc": 0.8826388120651245, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23883526027202606, "acc": 0.9017091989517212, "length": 3.997375249862671, "mode": "train", "epoch": 22}
{"loss": 0.2899231016635895, "acc": 0.8972222208976746, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2260996550321579, "acc": 0.9132301211357117, "length": 3.997551202774048, "mode": "train", "epoch": 23}
{"loss": 0.26647675037384033, "acc": 0.8961805701255798, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.20856991410255432, "acc": 0.9217645525932312, "length": 3.997788667678833, "mode": "train", "epoch": 24}
{"loss": 0.2711271643638611, "acc": 0.8954861164093018, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20841100811958313, "acc": 0.918289303779602, "length": 3.998033285140991, "mode": "train", "epoch": 25}
{"loss": 0.2338925451040268, "acc": 0.9074652791023254, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.20163743197917938, "acc": 0.9239855408668518, "length": 3.9984960556030273, "mode": "train", "epoch": 26}
{"loss": 0.2618759870529175, "acc": 0.9050347805023193, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.19994483888149261, "acc": 0.9254277348518372, "length": 3.9984421730041504, "mode": "train", "epoch": 27}
{"loss": 0.24239829182624817, "acc": 0.9112846851348877, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19253012537956238, "acc": 0.9279947876930237, "length": 3.998960018157959, "mode": "train", "epoch": 28}
{"loss": 0.23364035785198212, "acc": 0.9144097566604614, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18515609204769135, "acc": 0.9287377595901489, "length": 3.9980790615081787, "mode": "train", "epoch": 29}
{"loss": 0.23110421001911163, "acc": 0.9126735329627991, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18661993741989136, "acc": 0.9256136417388916, "length": 3.998872756958008, "mode": "train", "epoch": 30}
{"loss": 0.22744522988796234, "acc": 0.9142361879348755, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.18416662514209747, "acc": 0.9250224232673645, "length": 3.998480796813965, "mode": "train", "epoch": 31}
{"loss": 0.23619794845581055, "acc": 0.9104166030883789, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17129173874855042, "acc": 0.9343221187591553, "length": 3.999368190765381, "mode": "train", "epoch": 32}
{"loss": 0.21629033982753754, "acc": 0.9130207896232605, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.16453507542610168, "acc": 0.9333949089050293, "length": 3.9993183612823486, "mode": "train", "epoch": 33}
{"loss": 0.21392448246479034, "acc": 0.9159722924232483, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.16189882159233093, "acc": 0.9328672885894775, "length": 3.9990715980529785, "mode": "train", "epoch": 34}
{"loss": 0.21782320737838745, "acc": 0.9147568941116333, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.15716001391410828, "acc": 0.9383214116096497, "length": 3.999251127243042, "mode": "train", "epoch": 35}
{"loss": 0.20687678456306458, "acc": 0.9173610210418701, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.14760014414787292, "acc": 0.9432469606399536, "length": 3.999046564102173, "mode": "train", "epoch": 36}
{"loss": 0.1936984658241272, "acc": 0.9204861521720886, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.13834524154663086, "acc": 0.9477210640907288, "length": 3.9993484020233154, "mode": "train", "epoch": 37}
{"loss": 0.20374353229999542, "acc": 0.9236111044883728, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1318441480398178, "acc": 0.9514259099960327, "length": 3.9992032051086426, "mode": "train", "epoch": 38}
{"loss": 0.1820615530014038, "acc": 0.9270833134651184, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.12357338517904282, "acc": 0.9547426700592041, "length": 3.9994754791259766, "mode": "train", "epoch": 39}
{"loss": 0.18237367272377014, "acc": 0.9303818941116333, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.11602191627025604, "acc": 0.9544501304626465, "length": 3.9987761974334717, "mode": "train", "epoch": 40}
{"loss": 0.16761663556098938, "acc": 0.9347221851348877, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.11492601037025452, "acc": 0.9581539630889893, "length": 3.999133825302124, "mode": "train", "epoch": 41}
{"loss": 0.17325955629348755, "acc": 0.9326388835906982, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.10628180205821991, "acc": 0.9632053375244141, "length": 3.999335765838623, "mode": "train", "epoch": 42}
{"loss": 0.17032022774219513, "acc": 0.9369791746139526, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.10504084080457687, "acc": 0.9611782431602478, "length": 3.9995203018188477, "mode": "train", "epoch": 43}
{"loss": 0.15933944284915924, "acc": 0.9383680820465088, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.09677223861217499, "acc": 0.9632689356803894, "length": 3.999488592147827, "mode": "train", "epoch": 44}
{"loss": 0.15692898631095886, "acc": 0.9366319179534912, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.09901533275842667, "acc": 0.9630951881408691, "length": 3.9995357990264893, "mode": "train", "epoch": 45}
{"loss": 0.15714944899082184, "acc": 0.9394097924232483, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.09178901463747025, "acc": 0.9630389213562012, "length": 3.999610662460327, "mode": "train", "epoch": 46}
{"loss": 0.16249729692935944, "acc": 0.9411458969116211, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.08999519050121307, "acc": 0.9652936458587646, "length": 3.9993374347686768, "mode": "train", "epoch": 47}
{"loss": 0.1402883231639862, "acc": 0.9439236521720886, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.09222391247749329, "acc": 0.963565468788147, "length": 3.999722480773926, "mode": "train", "epoch": 48}
{"loss": 0.17691974341869354, "acc": 0.9381943941116333, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.08730845898389816, "acc": 0.9671648144721985, "length": 3.9998481273651123, "mode": "train", "epoch": 49}
{"loss": 0.14815647900104523, "acc": 0.9460068941116333, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.08177142590284348, "acc": 0.9691125154495239, "length": 3.9987733364105225, "mode": "train", "epoch": 50}
{"loss": 0.14862173795700073, "acc": 0.9446181058883667, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.08019062131643295, "acc": 0.9710999727249146, "length": 3.9994513988494873, "mode": "train", "epoch": 51}
{"loss": 0.16626039147377014, "acc": 0.9418401718139648, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.0882766917347908, "acc": 0.9662331342697144, "length": 3.9996020793914795, "mode": "train", "epoch": 52}
{"loss": 0.17602749168872833, "acc": 0.9286457896232605, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.08162614703178406, "acc": 0.9678032994270325, "length": 3.9998600482940674, "mode": "train", "epoch": 53}
{"loss": 0.16307173669338226, "acc": 0.9468749165534973, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.0784643366932869, "acc": 0.9670466184616089, "length": 3.9993088245391846, "mode": "train", "epoch": 54}
{"loss": 0.1634523570537567, "acc": 0.933506965637207, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.08444943279027939, "acc": 0.970757007598877, "length": 3.9997570514678955, "mode": "train", "epoch": 55}
{"loss": 0.14541999995708466, "acc": 0.9482638835906982, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.08406447619199753, "acc": 0.9671026468276978, "length": 3.9997498989105225, "mode": "train", "epoch": 56}
{"loss": 0.1498711109161377, "acc": 0.9383680820465088, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.08403588831424713, "acc": 0.9687891006469727, "length": 3.999861240386963, "mode": "train", "epoch": 57}
{"loss": 0.16296833753585815, "acc": 0.9421875476837158, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.07792554050683975, "acc": 0.9721547365188599, "length": 3.9999096393585205, "mode": "train", "epoch": 58}
{"loss": 0.17363394796848297, "acc": 0.9430554509162903, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.07573936879634857, "acc": 0.9722099304199219, "length": 3.9998340606689453, "mode": "train", "epoch": 59}
{"loss": 0.12925662100315094, "acc": 0.9532986879348755, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.0669374018907547, "acc": 0.9763858318328857, "length": 3.9998579025268555, "mode": "train", "epoch": 60}
{"loss": 0.13040581345558167, "acc": 0.9409722089767456, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8548275828361511
