ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7033911347389221, "acc": 0.5281286835670471, "length": 3.5009119510650635, "mode": "train", "epoch": 1}
{"loss": 0.6956195831298828, "acc": 0.5126953125, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6932863593101501, "acc": 0.5224760174751282, "length": 3.3518741130828857, "mode": "train", "epoch": 2}
{"loss": 0.6931536197662354, "acc": 0.5087890625, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6905916333198547, "acc": 0.5290945172309875, "length": 3.1360554695129395, "mode": "train", "epoch": 3}
{"loss": 0.6945338249206543, "acc": 0.49960944056510925, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6854837536811829, "acc": 0.5482375025749207, "length": 2.933244228363037, "mode": "train", "epoch": 4}
{"loss": 0.6785393953323364, "acc": 0.5769622325897217, "length": 1.671875, "mode": "test", "epoch": 4}
{"loss": 0.6730494499206543, "acc": 0.5942004323005676, "length": 3.224705457687378, "mode": "train", "epoch": 5}
{"loss": 0.6440047025680542, "acc": 0.6782699823379517, "length": 3.42578125, "mode": "test", "epoch": 5}
{"loss": 0.6454486846923828, "acc": 0.6764017939567566, "length": 3.418835401535034, "mode": "train", "epoch": 6}
{"loss": 0.601157546043396, "acc": 0.685748279094696, "length": 3.953125, "mode": "test", "epoch": 6}
{"loss": 0.5879682898521423, "acc": 0.7190974354743958, "length": 3.6671507358551025, "mode": "train", "epoch": 7}
{"loss": 0.5477274060249329, "acc": 0.7269530892372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5217440128326416, "acc": 0.7319727540016174, "length": 3.853907346725464, "mode": "train", "epoch": 8}
{"loss": 0.5068213939666748, "acc": 0.7423827648162842, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4740895628929138, "acc": 0.759711742401123, "length": 3.918811082839966, "mode": "train", "epoch": 9}
{"loss": 0.493572860956192, "acc": 0.7755858898162842, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4501144587993622, "acc": 0.7761539816856384, "length": 3.9407739639282227, "mode": "train", "epoch": 10}
{"loss": 0.4973413944244385, "acc": 0.7880859971046448, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4335149824619293, "acc": 0.7943985462188721, "length": 3.9431798458099365, "mode": "train", "epoch": 11}
{"loss": 0.47596004605293274, "acc": 0.7945313453674316, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4132409393787384, "acc": 0.8083043098449707, "length": 3.9505422115325928, "mode": "train", "epoch": 12}
{"loss": 0.4552001655101776, "acc": 0.8093749284744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.40690937638282776, "acc": 0.8138661980628967, "length": 3.9570746421813965, "mode": "train", "epoch": 13}
{"loss": 0.4413929581642151, "acc": 0.8072265982627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.38799405097961426, "acc": 0.8195315003395081, "length": 3.9583284854888916, "mode": "train", "epoch": 14}
{"loss": 0.43555206060409546, "acc": 0.8156250715255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.37762194871902466, "acc": 0.8255434632301331, "length": 3.9684019088745117, "mode": "train", "epoch": 15}
{"loss": 0.4058033227920532, "acc": 0.8378906846046448, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.35706615447998047, "acc": 0.8357909321784973, "length": 3.969183921813965, "mode": "train", "epoch": 16}
{"loss": 0.39592528343200684, "acc": 0.8320311903953552, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.33451834321022034, "acc": 0.8574070334434509, "length": 3.9776973724365234, "mode": "train", "epoch": 17}
{"loss": 0.39341285824775696, "acc": 0.8324217796325684, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3179662227630615, "acc": 0.8598796725273132, "length": 3.9782419204711914, "mode": "train", "epoch": 18}
{"loss": 0.3795480728149414, "acc": 0.8396483659744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.30680474638938904, "acc": 0.8679455518722534, "length": 3.9813902378082275, "mode": "train", "epoch": 19}
{"loss": 0.36552754044532776, "acc": 0.8474608659744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.29717159271240234, "acc": 0.8736688494682312, "length": 3.986009120941162, "mode": "train", "epoch": 20}
{"loss": 0.35584384202957153, "acc": 0.8499999642372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2856774628162384, "acc": 0.8804727792739868, "length": 3.9878718852996826, "mode": "train", "epoch": 21}
{"loss": 0.3453122079372406, "acc": 0.8556638956069946, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2756832242012024, "acc": 0.8856162428855896, "length": 3.9897801876068115, "mode": "train", "epoch": 22}
{"loss": 0.336588978767395, "acc": 0.8580079078674316, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.26498275995254517, "acc": 0.88824462890625, "length": 3.990844488143921, "mode": "train", "epoch": 23}
{"loss": 0.31609565019607544, "acc": 0.8636718392372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.25517624616622925, "acc": 0.8939549326896667, "length": 3.991703510284424, "mode": "train", "epoch": 24}
{"loss": 0.30531811714172363, "acc": 0.8792968392372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.24393250048160553, "acc": 0.9046564102172852, "length": 3.992992877960205, "mode": "train", "epoch": 25}
{"loss": 0.3130439519882202, "acc": 0.8718748688697815, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.23706047236919403, "acc": 0.9029079675674438, "length": 3.9928226470947266, "mode": "train", "epoch": 26}
{"loss": 0.29847753047943115, "acc": 0.8804687857627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.23137691617012024, "acc": 0.9075813293457031, "length": 3.9942023754119873, "mode": "train", "epoch": 27}
{"loss": 0.28066951036453247, "acc": 0.8828125, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2152690440416336, "acc": 0.9140897989273071, "length": 3.9954960346221924, "mode": "train", "epoch": 28}
{"loss": 0.2833510935306549, "acc": 0.8841796517372131, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2146676927804947, "acc": 0.915087103843689, "length": 3.9953551292419434, "mode": "train", "epoch": 29}
{"loss": 0.28181809186935425, "acc": 0.8859375715255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.20350416004657745, "acc": 0.9226146936416626, "length": 3.996511936187744, "mode": "train", "epoch": 30}
{"loss": 0.2440900206565857, "acc": 0.8994140028953552, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.18679384887218475, "acc": 0.9273796677589417, "length": 3.996687412261963, "mode": "train", "epoch": 31}
{"loss": 0.26885271072387695, "acc": 0.8908204436302185, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.18194672465324402, "acc": 0.9301279187202454, "length": 3.9968128204345703, "mode": "train", "epoch": 32}
{"loss": 0.24158865213394165, "acc": 0.9048827886581421, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17083443701267242, "acc": 0.9333087801933289, "length": 3.9976236820220947, "mode": "train", "epoch": 33}
{"loss": 0.26318076252937317, "acc": 0.8873047828674316, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17546220123767853, "acc": 0.9305067658424377, "length": 3.9977211952209473, "mode": "train", "epoch": 34}
{"loss": 0.2584821879863739, "acc": 0.8982421159744263, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1724369376897812, "acc": 0.9357198476791382, "length": 3.99698543548584, "mode": "train", "epoch": 35}
{"loss": 0.2238275706768036, "acc": 0.9119139909744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.16136398911476135, "acc": 0.9432582855224609, "length": 3.9979360103607178, "mode": "train", "epoch": 36}
{"loss": 0.21307790279388428, "acc": 0.9251952171325684, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.14753331243991852, "acc": 0.9442186951637268, "length": 3.9979751110076904, "mode": "train", "epoch": 37}
{"loss": 0.20912879705429077, "acc": 0.9265624284744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.13838309049606323, "acc": 0.9495261311531067, "length": 3.9953107833862305, "mode": "train", "epoch": 38}
{"loss": 0.20010554790496826, "acc": 0.9271484017372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.13284876942634583, "acc": 0.9503700733184814, "length": 3.9984941482543945, "mode": "train", "epoch": 39}
{"loss": 0.18839751183986664, "acc": 0.9261718392372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1255355328321457, "acc": 0.9549475312232971, "length": 3.998520851135254, "mode": "train", "epoch": 40}
{"loss": 0.17289912700653076, "acc": 0.9320312142372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.12068653851747513, "acc": 0.9544317722320557, "length": 3.9988064765930176, "mode": "train", "epoch": 41}
{"loss": 0.17128145694732666, "acc": 0.9337891340255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.11413796246051788, "acc": 0.9574575424194336, "length": 3.998724937438965, "mode": "train", "epoch": 42}
{"loss": 0.18804317712783813, "acc": 0.9279297590255737, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1087907925248146, "acc": 0.9577091336250305, "length": 3.998905897140503, "mode": "train", "epoch": 43}
{"loss": 0.17512187361717224, "acc": 0.93359375, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.11352834850549698, "acc": 0.9580687284469604, "length": 3.999018430709839, "mode": "train", "epoch": 44}
{"loss": 0.16321410238742828, "acc": 0.94140625, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.10547757148742676, "acc": 0.9617025852203369, "length": 3.9990572929382324, "mode": "train", "epoch": 45}
{"loss": 0.15931272506713867, "acc": 0.9382811784744263, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.10105454176664352, "acc": 0.9643769860267639, "length": 3.998966693878174, "mode": "train", "epoch": 46}
{"loss": 0.14660321176052094, "acc": 0.9457030296325684, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.09188085049390793, "acc": 0.9663567543029785, "length": 3.999241352081299, "mode": "train", "epoch": 47}
{"loss": 0.1504809707403183, "acc": 0.9429688453674316, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.08816751092672348, "acc": 0.967072606086731, "length": 3.999300241470337, "mode": "train", "epoch": 48}
{"loss": 0.14386580884456635, "acc": 0.9490233659744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.0891658291220665, "acc": 0.9697995781898499, "length": 3.998950958251953, "mode": "train", "epoch": 49}
{"loss": 0.1423225998878479, "acc": 0.9464844465255737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.08096595853567123, "acc": 0.9717186689376831, "length": 3.999183177947998, "mode": "train", "epoch": 50}
{"loss": 0.13282302021980286, "acc": 0.9527344703674316, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.07934730499982834, "acc": 0.9726790189743042, "length": 3.999391555786133, "mode": "train", "epoch": 51}
{"loss": 0.12871886789798737, "acc": 0.9541016221046448, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.07380587607622147, "acc": 0.9749512076377869, "length": 3.999584436416626, "mode": "train", "epoch": 52}
{"loss": 0.13254231214523315, "acc": 0.9541015028953552, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07244491577148438, "acc": 0.9739201664924622, "length": 3.999187469482422, "mode": "train", "epoch": 53}
{"loss": 0.10903573036193848, "acc": 0.9636718034744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.06757768243551254, "acc": 0.9781126976013184, "length": 3.9996657371520996, "mode": "train", "epoch": 54}
{"loss": 0.11493420600891113, "acc": 0.9634765982627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.06619001924991608, "acc": 0.9769831895828247, "length": 3.9996817111968994, "mode": "train", "epoch": 55}
{"loss": 0.09898483753204346, "acc": 0.9638671278953552, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.0631483793258667, "acc": 0.9788228273391724, "length": 3.999605178833008, "mode": "train", "epoch": 56}
{"loss": 0.13076341152191162, "acc": 0.9560547471046448, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.054949309676885605, "acc": 0.9846660494804382, "length": 3.999685525894165, "mode": "train", "epoch": 57}
{"loss": 0.10226269066333771, "acc": 0.9642577767372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06138836592435837, "acc": 0.9778726696968079, "length": 3.9996557235717773, "mode": "train", "epoch": 58}
{"loss": 0.10104742646217346, "acc": 0.9615234732627869, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.06064644455909729, "acc": 0.9826270937919617, "length": 3.9993624687194824, "mode": "train", "epoch": 59}
{"loss": 0.10308383405208588, "acc": 0.9597655534744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.06259257346391678, "acc": 0.9801412224769592, "length": 3.9997212886810303, "mode": "train", "epoch": 60}
{"loss": 0.09749981760978699, "acc": 0.9695311784744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8595312833786011
