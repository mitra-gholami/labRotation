ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6943458914756775, "acc": 0.524348795413971, "length": 3.0874183177948, "mode": "train", "epoch": 1}
{"loss": 0.6870282292366028, "acc": 0.5103895664215088, "length": 1.3229166269302368, "mode": "test", "epoch": 1}
{"loss": 0.6264423727989197, "acc": 0.6724780201911926, "length": 3.1819565296173096, "mode": "train", "epoch": 2}
{"loss": 0.5363039374351501, "acc": 0.7282335162162781, "length": 3.805555582046509, "mode": "test", "epoch": 2}
{"loss": 0.4853476583957672, "acc": 0.7789263725280762, "length": 3.682874917984009, "mode": "train", "epoch": 3}
{"loss": 0.46908050775527954, "acc": 0.7863009572029114, "length": 3.8854167461395264, "mode": "test", "epoch": 3}
{"loss": 0.40125617384910583, "acc": 0.8269258737564087, "length": 3.6543285846710205, "mode": "train", "epoch": 4}
{"loss": 0.42197561264038086, "acc": 0.8386175632476807, "length": 3.7395832538604736, "mode": "test", "epoch": 4}
{"loss": 0.3458356559276581, "acc": 0.8600149154663086, "length": 3.6237974166870117, "mode": "train", "epoch": 5}
{"loss": 0.3508225679397583, "acc": 0.8537598252296448, "length": 3.850694417953491, "mode": "test", "epoch": 5}
{"loss": 0.3080970346927643, "acc": 0.8770809173583984, "length": 3.6499674320220947, "mode": "train", "epoch": 6}
{"loss": 0.3186492323875427, "acc": 0.8721842765808105, "length": 3.788194417953491, "mode": "test", "epoch": 6}
{"loss": 0.29388001561164856, "acc": 0.8829376101493835, "length": 3.6584346294403076, "mode": "train", "epoch": 7}
{"loss": 0.31195852160453796, "acc": 0.8806803226470947, "length": 3.7916667461395264, "mode": "test", "epoch": 7}
{"loss": 0.28207162022590637, "acc": 0.8891576528549194, "length": 3.654900550842285, "mode": "train", "epoch": 8}
{"loss": 0.2821215093135834, "acc": 0.8923448920249939, "length": 3.7986111640930176, "mode": "test", "epoch": 8}
{"loss": 0.2716134190559387, "acc": 0.890894889831543, "length": 3.6428518295288086, "mode": "train", "epoch": 9}
{"loss": 0.28833526372909546, "acc": 0.8945801258087158, "length": 3.746527671813965, "mode": "test", "epoch": 9}
{"loss": 0.2552139163017273, "acc": 0.9029833078384399, "length": 3.6261954307556152, "mode": "train", "epoch": 10}
{"loss": 0.2560323178768158, "acc": 0.9039279222488403, "length": 3.7673611640930176, "mode": "test", "epoch": 10}
{"loss": 0.23394115269184113, "acc": 0.9058529734611511, "length": 3.6670753955841064, "mode": "train", "epoch": 11}
{"loss": 0.25179919600486755, "acc": 0.9032118320465088, "length": 3.7638888359069824, "mode": "test", "epoch": 11}
{"loss": 0.23021061718463898, "acc": 0.9075549840927124, "length": 3.6436767578125, "mode": "train", "epoch": 12}
{"loss": 0.22295525670051575, "acc": 0.9176160097122192, "length": 3.684027671813965, "mode": "test", "epoch": 12}
{"loss": 0.21258403360843658, "acc": 0.9142906069755554, "length": 3.6562180519104004, "mode": "train", "epoch": 13}
{"loss": 0.2278750240802765, "acc": 0.9070529937744141, "length": 3.8333332538604736, "mode": "test", "epoch": 13}
{"loss": 0.20568884909152985, "acc": 0.9172744154930115, "length": 3.6515026092529297, "mode": "train", "epoch": 14}
{"loss": 0.2063910961151123, "acc": 0.9210394620895386, "length": 3.7673611640930176, "mode": "test", "epoch": 14}
{"loss": 0.18502914905548096, "acc": 0.9264975190162659, "length": 3.6852848529815674, "mode": "train", "epoch": 15}
{"loss": 0.19335044920444489, "acc": 0.9231011271476746, "length": 3.788194417953491, "mode": "test", "epoch": 15}
{"loss": 0.19343243539333344, "acc": 0.9283010959625244, "length": 3.648881196975708, "mode": "train", "epoch": 16}
{"loss": 0.21311348676681519, "acc": 0.9228352308273315, "length": 3.6701388359069824, "mode": "test", "epoch": 16}
{"loss": 0.18172553181648254, "acc": 0.9276100397109985, "length": 3.6740357875823975, "mode": "train", "epoch": 17}
{"loss": 0.17509780824184418, "acc": 0.9405707120895386, "length": 3.78125, "mode": "test", "epoch": 17}
{"loss": 0.16794826090335846, "acc": 0.9378129839897156, "length": 3.669555187225342, "mode": "train", "epoch": 18}
{"loss": 0.16634978353977203, "acc": 0.9462292790412903, "length": 3.7673611640930176, "mode": "test", "epoch": 18}
{"loss": 0.15843454003334045, "acc": 0.9404698014259338, "length": 3.672586679458618, "mode": "train", "epoch": 19}
{"loss": 0.16054457426071167, "acc": 0.9453938007354736, "length": 3.743055582046509, "mode": "test", "epoch": 19}
{"loss": 0.15375077724456787, "acc": 0.9416884779930115, "length": 3.671799898147583, "mode": "train", "epoch": 20}
{"loss": 0.15325337648391724, "acc": 0.9512532353401184, "length": 3.722222328186035, "mode": "test", "epoch": 20}
{"loss": 0.14735868573188782, "acc": 0.9445908069610596, "length": 3.647624969482422, "mode": "train", "epoch": 21}
{"loss": 0.1460016518831253, "acc": 0.9478026628494263, "length": 3.7291667461395264, "mode": "test", "epoch": 21}
{"loss": 0.14544330537319183, "acc": 0.9458000063896179, "length": 3.671682119369507, "mode": "train", "epoch": 22}
{"loss": 0.16018995642662048, "acc": 0.9460394978523254, "length": 3.774305582046509, "mode": "test", "epoch": 22}
{"loss": 0.12988047301769257, "acc": 0.9519298076629639, "length": 3.647937536239624, "mode": "train", "epoch": 23}
{"loss": 0.15118373930454254, "acc": 0.9570854902267456, "length": 3.7013888359069824, "mode": "test", "epoch": 23}
{"loss": 0.12615299224853516, "acc": 0.9558295607566833, "length": 3.6374900341033936, "mode": "train", "epoch": 24}
{"loss": 0.13630340993404388, "acc": 0.9618869423866272, "length": 3.7291667461395264, "mode": "test", "epoch": 24}
{"loss": 0.1293531358242035, "acc": 0.9525265693664551, "length": 3.6505091190338135, "mode": "train", "epoch": 25}
{"loss": 0.14248564839363098, "acc": 0.9543511867523193, "length": 3.743055582046509, "mode": "test", "epoch": 25}
{"loss": 0.1327267438173294, "acc": 0.9511615037918091, "length": 3.6527838706970215, "mode": "train", "epoch": 26}
{"loss": 0.16066864132881165, "acc": 0.9466904401779175, "length": 3.7013888359069824, "mode": "test", "epoch": 26}
{"loss": 0.12113875150680542, "acc": 0.9554409384727478, "length": 3.6655328273773193, "mode": "train", "epoch": 27}
{"loss": 0.1353658139705658, "acc": 0.9604926705360413, "length": 3.7673611640930176, "mode": "test", "epoch": 27}
{"loss": 0.12080540508031845, "acc": 0.9548546075820923, "length": 3.640869140625, "mode": "train", "epoch": 28}
{"loss": 0.1236727237701416, "acc": 0.9609429240226746, "length": 3.7048611640930176, "mode": "test", "epoch": 28}
{"loss": 0.11139184981584549, "acc": 0.9585526585578918, "length": 3.6283926963806152, "mode": "train", "epoch": 29}
{"loss": 0.12183813005685806, "acc": 0.9666667580604553, "length": 3.7013888359069824, "mode": "test", "epoch": 29}
{"loss": 0.12344034761190414, "acc": 0.9542104005813599, "length": 3.6772148609161377, "mode": "train", "epoch": 30}
{"loss": 0.13482026755809784, "acc": 0.9627767205238342, "length": 3.715277671813965, "mode": "test", "epoch": 30}
{"loss": 0.1189560517668724, "acc": 0.9566442370414734, "length": 3.6248865127563477, "mode": "train", "epoch": 31}
{"loss": 0.12355653196573257, "acc": 0.9646539688110352, "length": 3.7361111640930176, "mode": "test", "epoch": 31}
{"loss": 0.10232885181903839, "acc": 0.9613845348358154, "length": 3.6472225189208984, "mode": "train", "epoch": 32}
{"loss": 0.11700895428657532, "acc": 0.9667969942092896, "length": 3.711805582046509, "mode": "test", "epoch": 32}
{"loss": 0.10353779047727585, "acc": 0.9604604244232178, "length": 3.665069341659546, "mode": "train", "epoch": 33}
{"loss": 0.10593078285455704, "acc": 0.9659287333488464, "length": 3.715277671813965, "mode": "test", "epoch": 33}
{"loss": 0.10243513435125351, "acc": 0.9622649550437927, "length": 3.669907808303833, "mode": "train", "epoch": 34}
{"loss": 0.10851293057203293, "acc": 0.9646700620651245, "length": 3.71875, "mode": "test", "epoch": 34}
{"loss": 0.09658558666706085, "acc": 0.9646828174591064, "length": 3.682884931564331, "mode": "train", "epoch": 35}
{"loss": 0.11730758100748062, "acc": 0.9666720628738403, "length": 3.7361111640930176, "mode": "test", "epoch": 35}
{"loss": 0.11049038916826248, "acc": 0.9609636664390564, "length": 3.6933536529541016, "mode": "train", "epoch": 36}
{"loss": 0.12297964096069336, "acc": 0.9636393785476685, "length": 3.756944417953491, "mode": "test", "epoch": 36}
{"loss": 0.09787158668041229, "acc": 0.9644690155982971, "length": 3.66353178024292, "mode": "train", "epoch": 37}
{"loss": 0.12835827469825745, "acc": 0.9639703035354614, "length": 3.7048611640930176, "mode": "test", "epoch": 37}
{"loss": 0.09170268476009369, "acc": 0.9667054414749146, "length": 3.671999216079712, "mode": "train", "epoch": 38}
{"loss": 0.11466114968061447, "acc": 0.9669107794761658, "length": 3.711805582046509, "mode": "test", "epoch": 38}
{"loss": 0.0953388586640358, "acc": 0.965096116065979, "length": 3.686312675476074, "mode": "train", "epoch": 39}
{"loss": 0.11002697050571442, "acc": 0.9678603410720825, "length": 3.756944417953491, "mode": "test", "epoch": 39}
{"loss": 0.09236954897642136, "acc": 0.9662401676177979, "length": 3.6714961528778076, "mode": "train", "epoch": 40}
{"loss": 0.12591445446014404, "acc": 0.9599283933639526, "length": 3.663194417953491, "mode": "test", "epoch": 40}
{"loss": 0.08692972362041473, "acc": 0.9688451290130615, "length": 3.663942337036133, "mode": "train", "epoch": 41}
{"loss": 0.1001073494553566, "acc": 0.9716145396232605, "length": 3.711805582046509, "mode": "test", "epoch": 41}
{"loss": 0.07713974267244339, "acc": 0.9735281467437744, "length": 3.7171504497528076, "mode": "train", "epoch": 42}
{"loss": 0.10257280617952347, "acc": 0.9673068523406982, "length": 3.78125, "mode": "test", "epoch": 42}
{"loss": 0.07601303607225418, "acc": 0.9744349122047424, "length": 3.726428270339966, "mode": "train", "epoch": 43}
{"loss": 0.11440225690603256, "acc": 0.9669378995895386, "length": 3.7951388359069824, "mode": "test", "epoch": 43}
{"loss": 0.07377154380083084, "acc": 0.9758554100990295, "length": 3.725299119949341, "mode": "train", "epoch": 44}
{"loss": 0.09830456972122192, "acc": 0.971538782119751, "length": 3.7708332538604736, "mode": "test", "epoch": 44}
{"loss": 0.06990106403827667, "acc": 0.9770333170890808, "length": 3.7218074798583984, "mode": "train", "epoch": 45}
{"loss": 0.12312400341033936, "acc": 0.9674098491668701, "length": 3.777777671813965, "mode": "test", "epoch": 45}
{"loss": 0.06789856404066086, "acc": 0.9766949415206909, "length": 3.721750020980835, "mode": "train", "epoch": 46}
{"loss": 0.10832703113555908, "acc": 0.9702854156494141, "length": 3.8020832538604736, "mode": "test", "epoch": 46}
{"loss": 0.0783124640583992, "acc": 0.9749249219894409, "length": 3.7481701374053955, "mode": "train", "epoch": 47}
{"loss": 0.09452765434980392, "acc": 0.9707032442092896, "length": 3.777777671813965, "mode": "test", "epoch": 47}
{"loss": 0.0738527700304985, "acc": 0.9727248549461365, "length": 3.739854097366333, "mode": "train", "epoch": 48}
{"loss": 0.10838689655065536, "acc": 0.964024543762207, "length": 3.7291667461395264, "mode": "test", "epoch": 48}
{"loss": 0.07861156016588211, "acc": 0.9754112362861633, "length": 3.7227323055267334, "mode": "train", "epoch": 49}
{"loss": 0.10825283080339432, "acc": 0.9717718958854675, "length": 3.7604167461395264, "mode": "test", "epoch": 49}
{"loss": 0.09357663244009018, "acc": 0.9682391285896301, "length": 3.726238250732422, "mode": "train", "epoch": 50}
{"loss": 0.11547406762838364, "acc": 0.9643229246139526, "length": 3.71875, "mode": "test", "epoch": 50}
{"loss": 0.07852093130350113, "acc": 0.9738507866859436, "length": 3.675877332687378, "mode": "train", "epoch": 51}
{"loss": 0.11229261755943298, "acc": 0.9672418236732483, "length": 3.711805582046509, "mode": "test", "epoch": 51}
{"loss": 0.09110292047262192, "acc": 0.9691023826599121, "length": 3.668102264404297, "mode": "train", "epoch": 52}
{"loss": 0.10744204372167587, "acc": 0.9676649570465088, "length": 3.694444417953491, "mode": "test", "epoch": 52}
{"loss": 0.07508303225040436, "acc": 0.975176215171814, "length": 3.7126729488372803, "mode": "train", "epoch": 53}
{"loss": 0.08385422825813293, "acc": 0.9690538048744202, "length": 3.753472328186035, "mode": "test", "epoch": 53}
{"loss": 0.09562359750270844, "acc": 0.9637057185173035, "length": 3.6320505142211914, "mode": "train", "epoch": 54}
{"loss": 0.13661809265613556, "acc": 0.9545138478279114, "length": 3.6041667461395264, "mode": "test", "epoch": 54}
{"loss": 0.09532640129327774, "acc": 0.9649809002876282, "length": 3.6110808849334717, "mode": "train", "epoch": 55}
{"loss": 0.12605448067188263, "acc": 0.9623644351959229, "length": 3.6666667461395264, "mode": "test", "epoch": 55}
{"loss": 0.06910331547260284, "acc": 0.974307119846344, "length": 3.683439016342163, "mode": "train", "epoch": 56}
{"loss": 0.08942966908216476, "acc": 0.9716525673866272, "length": 3.7604167461395264, "mode": "test", "epoch": 56}
{"loss": 0.06702303141355515, "acc": 0.9773317575454712, "length": 3.7172203063964844, "mode": "train", "epoch": 57}
{"loss": 0.08759559690952301, "acc": 0.9708387851715088, "length": 3.7638888359069824, "mode": "test", "epoch": 57}
{"loss": 0.053121861070394516, "acc": 0.9818571209907532, "length": 3.728040933609009, "mode": "train", "epoch": 58}
{"loss": 0.07544839382171631, "acc": 0.9785590767860413, "length": 3.7604167461395264, "mode": "test", "epoch": 58}
{"loss": 0.0607210211455822, "acc": 0.9791910648345947, "length": 3.7202093601226807, "mode": "train", "epoch": 59}
{"loss": 0.08550423383712769, "acc": 0.9704318642616272, "length": 3.7708332538604736, "mode": "test", "epoch": 59}
{"loss": 0.0610496960580349, "acc": 0.979182779788971, "length": 3.7205276489257812, "mode": "train", "epoch": 60}
{"loss": 0.08622943609952927, "acc": 0.9732314348220825, "length": 3.7708332538604736, "mode": "test", "epoch": 60}
test accuracy: 0.7592688202857971
