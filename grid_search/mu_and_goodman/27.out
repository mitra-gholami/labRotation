ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6973024010658264, "acc": 0.5238012075424194, "length": 3.470731258392334, "mode": "train", "epoch": 1}
{"loss": 0.6895016431808472, "acc": 0.5322265625, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6909841895103455, "acc": 0.5256145000457764, "length": 3.273142099380493, "mode": "train", "epoch": 2}
{"loss": 0.6888487935066223, "acc": 0.534014880657196, "length": 1.0859375, "mode": "test", "epoch": 2}
{"loss": 0.6846305727958679, "acc": 0.5593591928482056, "length": 3.017110824584961, "mode": "train", "epoch": 3}
{"loss": 0.6716861724853516, "acc": 0.5986907482147217, "length": 1.7265625, "mode": "test", "epoch": 3}
{"loss": 0.660433828830719, "acc": 0.6307722926139832, "length": 2.8907957077026367, "mode": "train", "epoch": 4}
{"loss": 0.6191905736923218, "acc": 0.7345397472381592, "length": 3.33203125, "mode": "test", "epoch": 4}
{"loss": 0.6070342063903809, "acc": 0.7112641334533691, "length": 3.146162748336792, "mode": "train", "epoch": 5}
{"loss": 0.5616552829742432, "acc": 0.7365752458572388, "length": 3.4609375, "mode": "test", "epoch": 5}
{"loss": 0.5425220727920532, "acc": 0.7533370852470398, "length": 3.2841169834136963, "mode": "train", "epoch": 6}
{"loss": 0.5137072801589966, "acc": 0.761916995048523, "length": 3.46875, "mode": "test", "epoch": 6}
{"loss": 0.49961045384407043, "acc": 0.7668524980545044, "length": 3.342886447906494, "mode": "train", "epoch": 7}
{"loss": 0.4735049903392792, "acc": 0.789263904094696, "length": 3.5, "mode": "test", "epoch": 7}
{"loss": 0.471060186624527, "acc": 0.7845057249069214, "length": 3.4102139472961426, "mode": "train", "epoch": 8}
{"loss": 0.4513646364212036, "acc": 0.8042327165603638, "length": 3.703125, "mode": "test", "epoch": 8}
{"loss": 0.4523942768573761, "acc": 0.7983105182647705, "length": 3.4963603019714355, "mode": "train", "epoch": 9}
{"loss": 0.43819424510002136, "acc": 0.8201629519462585, "length": 3.72265625, "mode": "test", "epoch": 9}
{"loss": 0.43207865953445435, "acc": 0.8115148544311523, "length": 3.6507203578948975, "mode": "train", "epoch": 10}
{"loss": 0.4131333827972412, "acc": 0.8302153944969177, "length": 3.83203125, "mode": "test", "epoch": 10}
{"loss": 0.403154581785202, "acc": 0.8282680511474609, "length": 3.758389949798584, "mode": "train", "epoch": 11}
{"loss": 0.39692723751068115, "acc": 0.8384490013122559, "length": 3.94140625, "mode": "test", "epoch": 11}
{"loss": 0.3799469470977783, "acc": 0.8358554840087891, "length": 3.8686704635620117, "mode": "train", "epoch": 12}
{"loss": 0.38271236419677734, "acc": 0.8441223502159119, "length": 3.9921875, "mode": "test", "epoch": 12}
{"loss": 0.3648143410682678, "acc": 0.8443527817726135, "length": 3.900230646133423, "mode": "train", "epoch": 13}
{"loss": 0.37625783681869507, "acc": 0.8499999046325684, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3566906452178955, "acc": 0.8472131490707397, "length": 3.9148941040039062, "mode": "train", "epoch": 14}
{"loss": 0.3806673586368561, "acc": 0.8388671875, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3463669717311859, "acc": 0.8511903285980225, "length": 3.968092441558838, "mode": "train", "epoch": 15}
{"loss": 0.35295775532722473, "acc": 0.8566407561302185, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.33551254868507385, "acc": 0.8566117286682129, "length": 3.9790549278259277, "mode": "train", "epoch": 16}
{"loss": 0.34513652324676514, "acc": 0.8566407561302185, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.32808956503868103, "acc": 0.8616653084754944, "length": 3.985532760620117, "mode": "train", "epoch": 17}
{"loss": 0.3473193347454071, "acc": 0.8628907203674316, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3136685788631439, "acc": 0.872703492641449, "length": 3.9875097274780273, "mode": "train", "epoch": 18}
{"loss": 0.3394455313682556, "acc": 0.8636718392372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.30659112334251404, "acc": 0.8700552582740784, "length": 3.99375319480896, "mode": "train", "epoch": 19}
{"loss": 0.32734620571136475, "acc": 0.8708983659744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3034713566303253, "acc": 0.8765051960945129, "length": 3.98976731300354, "mode": "train", "epoch": 20}
{"loss": 0.32922524213790894, "acc": 0.8736328482627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3010251522064209, "acc": 0.883083701133728, "length": 3.994926929473877, "mode": "train", "epoch": 21}
{"loss": 0.3280840814113617, "acc": 0.8707031607627869, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2889114022254944, "acc": 0.8808454275131226, "length": 3.996443748474121, "mode": "train", "epoch": 22}
{"loss": 0.3282274007797241, "acc": 0.8783202767372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.28950706124305725, "acc": 0.8793590068817139, "length": 3.9933509826660156, "mode": "train", "epoch": 23}
{"loss": 0.3149394989013672, "acc": 0.8800782561302185, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.28604942560195923, "acc": 0.8799777626991272, "length": 3.9948668479919434, "mode": "train", "epoch": 24}
{"loss": 0.3179035186767578, "acc": 0.8736329078674316, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2834470868110657, "acc": 0.8821355700492859, "length": 3.997246503829956, "mode": "train", "epoch": 25}
{"loss": 0.30427640676498413, "acc": 0.8783202171325684, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.27862730622291565, "acc": 0.8848939538002014, "length": 3.9960272312164307, "mode": "train", "epoch": 26}
{"loss": 0.31019043922424316, "acc": 0.8779296875, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.27991631627082825, "acc": 0.8822325468063354, "length": 3.9947991371154785, "mode": "train", "epoch": 27}
{"loss": 0.30974724888801575, "acc": 0.8787108659744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2721840739250183, "acc": 0.8850499391555786, "length": 3.9972891807556152, "mode": "train", "epoch": 28}
{"loss": 0.29835155606269836, "acc": 0.8695312142372131, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.273455947637558, "acc": 0.8880612850189209, "length": 3.9955124855041504, "mode": "train", "epoch": 29}
{"loss": 0.29668211936950684, "acc": 0.875, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2754476070404053, "acc": 0.881770670413971, "length": 3.998897075653076, "mode": "train", "epoch": 30}
{"loss": 0.3086109459400177, "acc": 0.8718749284744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2708810269832611, "acc": 0.8872061967849731, "length": 3.99843168258667, "mode": "train", "epoch": 31}
{"loss": 0.2975660264492035, "acc": 0.8734374642372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.269232839345932, "acc": 0.8852820992469788, "length": 3.9974045753479004, "mode": "train", "epoch": 32}
{"loss": 0.2871614992618561, "acc": 0.8822265267372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.26206156611442566, "acc": 0.888587236404419, "length": 3.9976696968078613, "mode": "train", "epoch": 33}
{"loss": 0.28995373845100403, "acc": 0.8800781965255737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2644835412502289, "acc": 0.8885034322738647, "length": 3.9994773864746094, "mode": "train", "epoch": 34}
{"loss": 0.28241056203842163, "acc": 0.8800781965255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2607092559337616, "acc": 0.8910417556762695, "length": 3.998272657394409, "mode": "train", "epoch": 35}
{"loss": 0.27698826789855957, "acc": 0.8796874284744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2574272155761719, "acc": 0.8871501088142395, "length": 3.9983086585998535, "mode": "train", "epoch": 36}
{"loss": 0.292496919631958, "acc": 0.8828124403953552, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2605419456958771, "acc": 0.8913595676422119, "length": 3.9979217052459717, "mode": "train", "epoch": 37}
{"loss": 0.27421432733535767, "acc": 0.8857421278953552, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.251790851354599, "acc": 0.8900099992752075, "length": 3.999431610107422, "mode": "train", "epoch": 38}
{"loss": 0.2668379545211792, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2531941831111908, "acc": 0.8879717588424683, "length": 3.998706579208374, "mode": "train", "epoch": 39}
{"loss": 0.2747887074947357, "acc": 0.8837890625, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.25199657678604126, "acc": 0.8912880420684814, "length": 3.9994871616363525, "mode": "train", "epoch": 40}
{"loss": 0.2654202878475189, "acc": 0.888671875, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.24687829613685608, "acc": 0.8905363082885742, "length": 3.999629259109497, "mode": "train", "epoch": 41}
{"loss": 0.26400914788246155, "acc": 0.8865233659744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.24541008472442627, "acc": 0.8939000964164734, "length": 3.9993252754211426, "mode": "train", "epoch": 42}
{"loss": 0.26953125, "acc": 0.8705077767372131, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2519386112689972, "acc": 0.8903046250343323, "length": 3.9996817111968994, "mode": "train", "epoch": 43}
{"loss": 0.269205242395401, "acc": 0.8804687857627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2459700107574463, "acc": 0.8934388756752014, "length": 3.999514102935791, "mode": "train", "epoch": 44}
{"loss": 0.2611073851585388, "acc": 0.8816405534744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.24363650381565094, "acc": 0.8958917856216431, "length": 3.9982199668884277, "mode": "train", "epoch": 45}
{"loss": 0.2549740672111511, "acc": 0.890625, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.24357250332832336, "acc": 0.8958073258399963, "length": 3.9991586208343506, "mode": "train", "epoch": 46}
{"loss": 0.2655341923236847, "acc": 0.8888672590255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.23825673758983612, "acc": 0.8955907821655273, "length": 3.998319625854492, "mode": "train", "epoch": 47}
{"loss": 0.2622983157634735, "acc": 0.8865233659744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.24239729344844818, "acc": 0.8929160237312317, "length": 3.9996516704559326, "mode": "train", "epoch": 48}
{"loss": 0.2563159763813019, "acc": 0.888671875, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.23542748391628265, "acc": 0.8982460498809814, "length": 3.9995312690734863, "mode": "train", "epoch": 49}
{"loss": 0.255374550819397, "acc": 0.8939452767372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.244685098528862, "acc": 0.8931223154067993, "length": 3.995374917984009, "mode": "train", "epoch": 50}
{"loss": 0.2666964530944824, "acc": 0.8914061784744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.239954873919487, "acc": 0.8984083533287048, "length": 3.9978153705596924, "mode": "train", "epoch": 51}
{"loss": 0.25648462772369385, "acc": 0.8833984732627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.24338330328464508, "acc": 0.8935445547103882, "length": 3.9991159439086914, "mode": "train", "epoch": 52}
{"loss": 0.2573782205581665, "acc": 0.8923827409744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.23734156787395477, "acc": 0.8951716423034668, "length": 3.9973204135894775, "mode": "train", "epoch": 53}
{"loss": 0.25187626481056213, "acc": 0.8980469107627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.23341672122478485, "acc": 0.897096574306488, "length": 3.999866008758545, "mode": "train", "epoch": 54}
{"loss": 0.2454020380973816, "acc": 0.900390625, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.23406599462032318, "acc": 0.8981896638870239, "length": 3.999659538269043, "mode": "train", "epoch": 55}
{"loss": 0.24276645481586456, "acc": 0.8957032561302185, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.23086540400981903, "acc": 0.8999044895172119, "length": 3.9990336894989014, "mode": "train", "epoch": 56}
{"loss": 0.25391289591789246, "acc": 0.8968749642372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.22752627730369568, "acc": 0.9012167453765869, "length": 3.999955177307129, "mode": "train", "epoch": 57}
{"loss": 0.25822514295578003, "acc": 0.892578125, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.23144857585430145, "acc": 0.8969150185585022, "length": 3.999290704727173, "mode": "train", "epoch": 58}
{"loss": 0.24753019213676453, "acc": 0.8964843153953552, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.22535863518714905, "acc": 0.9027243852615356, "length": 3.9999513626098633, "mode": "train", "epoch": 59}
{"loss": 0.2519141137599945, "acc": 0.8927735090255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.2294156551361084, "acc": 0.8982875347137451, "length": 3.99649715423584, "mode": "train", "epoch": 60}
{"loss": 0.2550535202026367, "acc": 0.8978515267372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8262069225311279
