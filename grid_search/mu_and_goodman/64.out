ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6978380084037781, "acc": 0.4931827783584595, "length": 3.5222063064575195, "mode": "train", "epoch": 1}
{"loss": 0.6924314498901367, "acc": 0.507617175579071, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6932135224342346, "acc": 0.5026828646659851, "length": 3.3894972801208496, "mode": "train", "epoch": 2}
{"loss": 0.6920620203018188, "acc": 0.5022857785224915, "length": 1.046875, "mode": "test", "epoch": 2}
{"loss": 0.6882397532463074, "acc": 0.5378782749176025, "length": 3.24721622467041, "mode": "train", "epoch": 3}
{"loss": 0.6699606776237488, "acc": 0.6063247919082642, "length": 2.10546875, "mode": "test", "epoch": 3}
{"loss": 0.6674474477767944, "acc": 0.6225717067718506, "length": 3.3681793212890625, "mode": "train", "epoch": 4}
{"loss": 0.6262624263763428, "acc": 0.6592681407928467, "length": 3.88671875, "mode": "test", "epoch": 4}
{"loss": 0.6141530275344849, "acc": 0.7021192312240601, "length": 3.69140362739563, "mode": "train", "epoch": 5}
{"loss": 0.5812848806381226, "acc": 0.6982421278953552, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5617206692695618, "acc": 0.6994401216506958, "length": 3.874616861343384, "mode": "train", "epoch": 6}
{"loss": 0.608880341053009, "acc": 0.6853514313697815, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5486833453178406, "acc": 0.7054455876350403, "length": 3.933736801147461, "mode": "train", "epoch": 7}
{"loss": 0.5726461410522461, "acc": 0.7224608063697815, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5220961570739746, "acc": 0.7337668538093567, "length": 3.9301652908325195, "mode": "train", "epoch": 8}
{"loss": 0.519967257976532, "acc": 0.7451172471046448, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4849317669868469, "acc": 0.7908760905265808, "length": 3.942542552947998, "mode": "train", "epoch": 9}
{"loss": 0.49431759119033813, "acc": 0.7779297232627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.44402775168418884, "acc": 0.8090800046920776, "length": 3.961347818374634, "mode": "train", "epoch": 10}
{"loss": 0.4640826880931854, "acc": 0.8023437261581421, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4197159707546234, "acc": 0.8300647735595703, "length": 3.9706456661224365, "mode": "train", "epoch": 11}
{"loss": 0.4702872037887573, "acc": 0.8173827528953552, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.40007951855659485, "acc": 0.8340552449226379, "length": 3.979870557785034, "mode": "train", "epoch": 12}
{"loss": 0.4762582778930664, "acc": 0.8103514909744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.38487809896469116, "acc": 0.8398032188415527, "length": 3.9788565635681152, "mode": "train", "epoch": 13}
{"loss": 0.46277618408203125, "acc": 0.8134765028953552, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3713027834892273, "acc": 0.8399125933647156, "length": 3.9847898483276367, "mode": "train", "epoch": 14}
{"loss": 0.4378880262374878, "acc": 0.8283204436302185, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.35793450474739075, "acc": 0.8488031625747681, "length": 3.981604814529419, "mode": "train", "epoch": 15}
{"loss": 0.41306400299072266, "acc": 0.8367186188697815, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3457548916339874, "acc": 0.8600513339042664, "length": 3.98283314704895, "mode": "train", "epoch": 16}
{"loss": 0.4214414358139038, "acc": 0.8388671875, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.33383265137672424, "acc": 0.8613021373748779, "length": 3.988513469696045, "mode": "train", "epoch": 17}
{"loss": 0.4282113313674927, "acc": 0.8263670206069946, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3243970274925232, "acc": 0.8676570653915405, "length": 3.9911372661590576, "mode": "train", "epoch": 18}
{"loss": 0.42681699991226196, "acc": 0.8322266340255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.31575751304626465, "acc": 0.8710853457450867, "length": 3.9904816150665283, "mode": "train", "epoch": 19}
{"loss": 0.4244927763938904, "acc": 0.8394531607627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.31021878123283386, "acc": 0.8730916380882263, "length": 3.9943745136260986, "mode": "train", "epoch": 20}
{"loss": 0.41589224338531494, "acc": 0.8169921636581421, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.29909059405326843, "acc": 0.8791112303733826, "length": 3.9931838512420654, "mode": "train", "epoch": 21}
{"loss": 0.4135746955871582, "acc": 0.8427733778953552, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2869226038455963, "acc": 0.8838755488395691, "length": 3.9961998462677, "mode": "train", "epoch": 22}
{"loss": 0.4055434465408325, "acc": 0.8359375, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27691906690597534, "acc": 0.8858063817024231, "length": 3.9955508708953857, "mode": "train", "epoch": 23}
{"loss": 0.4070760905742645, "acc": 0.8351563215255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.270946741104126, "acc": 0.8876248002052307, "length": 3.995692253112793, "mode": "train", "epoch": 24}
{"loss": 0.4086272418498993, "acc": 0.8386717438697815, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2638964056968689, "acc": 0.8943356275558472, "length": 3.995838165283203, "mode": "train", "epoch": 25}
{"loss": 0.40968644618988037, "acc": 0.8404297232627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2584075629711151, "acc": 0.8961817026138306, "length": 3.996126413345337, "mode": "train", "epoch": 26}
{"loss": 0.3921232223510742, "acc": 0.8499999642372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.25296005606651306, "acc": 0.8962499499320984, "length": 3.9972376823425293, "mode": "train", "epoch": 27}
{"loss": 0.389484167098999, "acc": 0.8460937142372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.24635803699493408, "acc": 0.8985286951065063, "length": 3.997401475906372, "mode": "train", "epoch": 28}
{"loss": 0.3725273013114929, "acc": 0.8580078482627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.23409403860569, "acc": 0.9061716794967651, "length": 3.997650623321533, "mode": "train", "epoch": 29}
{"loss": 0.35230034589767456, "acc": 0.8576170206069946, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2281276136636734, "acc": 0.9118719100952148, "length": 3.9978432655334473, "mode": "train", "epoch": 30}
{"loss": 0.3467054069042206, "acc": 0.8574218153953552, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.22438262403011322, "acc": 0.9109917879104614, "length": 3.9975602626800537, "mode": "train", "epoch": 31}
{"loss": 0.33583641052246094, "acc": 0.8675780892372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.21308648586273193, "acc": 0.9207472205162048, "length": 3.9978952407836914, "mode": "train", "epoch": 32}
{"loss": 0.3389168679714203, "acc": 0.8570312857627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.20831505954265594, "acc": 0.9165086150169373, "length": 3.998823642730713, "mode": "train", "epoch": 33}
{"loss": 0.31355077028274536, "acc": 0.8681640625, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.20765016973018646, "acc": 0.9175357222557068, "length": 3.9989607334136963, "mode": "train", "epoch": 34}
{"loss": 0.3081706166267395, "acc": 0.8701171875, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1982237547636032, "acc": 0.9214098453521729, "length": 3.9989817142486572, "mode": "train", "epoch": 35}
{"loss": 0.2969605326652527, "acc": 0.8664063215255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.19529232382774353, "acc": 0.9206165075302124, "length": 3.9989707469940186, "mode": "train", "epoch": 36}
{"loss": 0.315134197473526, "acc": 0.8689452409744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1947764903306961, "acc": 0.921345055103302, "length": 3.99891996383667, "mode": "train", "epoch": 37}
{"loss": 0.30198490619659424, "acc": 0.8714842796325684, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1904701441526413, "acc": 0.9237536787986755, "length": 3.999192237854004, "mode": "train", "epoch": 38}
{"loss": 0.2852722406387329, "acc": 0.8761719465255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1853695958852768, "acc": 0.9290399551391602, "length": 3.998762369155884, "mode": "train", "epoch": 39}
{"loss": 0.3085947334766388, "acc": 0.8859375715255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.18431563675403595, "acc": 0.9293997287750244, "length": 3.999392509460449, "mode": "train", "epoch": 40}
{"loss": 0.29884397983551025, "acc": 0.880859375, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.18138723075389862, "acc": 0.9266541600227356, "length": 3.999178171157837, "mode": "train", "epoch": 41}
{"loss": 0.267776221036911, "acc": 0.8880858421325684, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1773735135793686, "acc": 0.9260764718055725, "length": 3.998751640319824, "mode": "train", "epoch": 42}
{"loss": 0.28723376989364624, "acc": 0.8900389671325684, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.17999224364757538, "acc": 0.9292802810668945, "length": 3.9991557598114014, "mode": "train", "epoch": 43}
{"loss": 0.2864299714565277, "acc": 0.8876953721046448, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.17362622916698456, "acc": 0.9328250288963318, "length": 3.9995663166046143, "mode": "train", "epoch": 44}
{"loss": 0.28352826833724976, "acc": 0.8865233063697815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.17151077091693878, "acc": 0.9338463544845581, "length": 3.9994866847991943, "mode": "train", "epoch": 45}
{"loss": 0.27041202783584595, "acc": 0.8890624642372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.17000935971736908, "acc": 0.9315718412399292, "length": 3.99936842918396, "mode": "train", "epoch": 46}
{"loss": 0.272675484418869, "acc": 0.8890624642372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.16766011714935303, "acc": 0.9328536987304688, "length": 3.9986441135406494, "mode": "train", "epoch": 47}
{"loss": 0.25295525789260864, "acc": 0.8992189168930054, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.163538858294487, "acc": 0.9379580020904541, "length": 3.9995875358581543, "mode": "train", "epoch": 48}
{"loss": 0.24898111820220947, "acc": 0.9037109017372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.16154661774635315, "acc": 0.9332762360572815, "length": 3.9994523525238037, "mode": "train", "epoch": 49}
{"loss": 0.24549248814582825, "acc": 0.8914061188697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1538269817829132, "acc": 0.9399343132972717, "length": 3.99908447265625, "mode": "train", "epoch": 50}
{"loss": 0.24552582204341888, "acc": 0.9033202528953552, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.1519571989774704, "acc": 0.9400120973587036, "length": 3.999485731124878, "mode": "train", "epoch": 51}
{"loss": 0.26504671573638916, "acc": 0.8929687142372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.15330815315246582, "acc": 0.938234806060791, "length": 3.9990406036376953, "mode": "train", "epoch": 52}
{"loss": 0.2560274004936218, "acc": 0.892578125, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.14386653900146484, "acc": 0.9461604356765747, "length": 3.9995033740997314, "mode": "train", "epoch": 53}
{"loss": 0.24931715428829193, "acc": 0.8992189168930054, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15032967925071716, "acc": 0.9375569224357605, "length": 3.999499797821045, "mode": "train", "epoch": 54}
{"loss": 0.24415214359760284, "acc": 0.9021486043930054, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.14297650754451752, "acc": 0.9463393092155457, "length": 3.999635934829712, "mode": "train", "epoch": 55}
{"loss": 0.2564801871776581, "acc": 0.8976563215255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.14418472349643707, "acc": 0.9412099719047546, "length": 3.9996566772460938, "mode": "train", "epoch": 56}
{"loss": 0.24550628662109375, "acc": 0.9044922590255737, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1398480385541916, "acc": 0.9456201195716858, "length": 3.998584270477295, "mode": "train", "epoch": 57}
{"loss": 0.25853919982910156, "acc": 0.8980469107627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1329469531774521, "acc": 0.9531099796295166, "length": 3.999443531036377, "mode": "train", "epoch": 58}
{"loss": 0.23994463682174683, "acc": 0.9117188453674316, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.12731744349002838, "acc": 0.9535790681838989, "length": 3.999664783477783, "mode": "train", "epoch": 59}
{"loss": 0.2341337651014328, "acc": 0.9144530296325684, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.12094966322183609, "acc": 0.9556184411048889, "length": 3.9980013370513916, "mode": "train", "epoch": 60}
{"loss": 0.24509455263614655, "acc": 0.9115233421325684, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8040740489959717
