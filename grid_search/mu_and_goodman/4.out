ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6924638152122498, "acc": 0.5256590843200684, "length": 3.5304460525512695, "mode": "train", "epoch": 1}
{"loss": 0.673095703125, "acc": 0.6200411915779114, "length": 2.569444417953491, "mode": "test", "epoch": 1}
{"loss": 0.6837533712387085, "acc": 0.5480026602745056, "length": 3.4118406772613525, "mode": "train", "epoch": 2}
{"loss": 0.6526970267295837, "acc": 0.6454264521598816, "length": 3.78125, "mode": "test", "epoch": 2}
{"loss": 0.6209169030189514, "acc": 0.6667872667312622, "length": 3.650665044784546, "mode": "train", "epoch": 3}
{"loss": 0.5372594594955444, "acc": 0.7677083015441895, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4930521845817566, "acc": 0.7688642740249634, "length": 3.9587082862854004, "mode": "train", "epoch": 4}
{"loss": 0.4646173119544983, "acc": 0.8020832538604736, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4467492401599884, "acc": 0.7940506935119629, "length": 3.966695547103882, "mode": "train", "epoch": 5}
{"loss": 0.4439268410205841, "acc": 0.8065972924232483, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.4210972785949707, "acc": 0.8064047694206238, "length": 3.9621827602386475, "mode": "train", "epoch": 6}
{"loss": 0.41097119450569153, "acc": 0.8184027075767517, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.40184420347213745, "acc": 0.814501166343689, "length": 3.9748923778533936, "mode": "train", "epoch": 7}
{"loss": 0.4060443639755249, "acc": 0.831250011920929, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3884182870388031, "acc": 0.8176001310348511, "length": 3.9796106815338135, "mode": "train", "epoch": 8}
{"loss": 0.4005967676639557, "acc": 0.8255207538604736, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.37526679039001465, "acc": 0.8295408487319946, "length": 3.9857544898986816, "mode": "train", "epoch": 9}
{"loss": 0.40278708934783936, "acc": 0.8392360210418701, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3714185357093811, "acc": 0.8338161110877991, "length": 3.9888052940368652, "mode": "train", "epoch": 10}
{"loss": 0.3752151131629944, "acc": 0.8477430939674377, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3500150144100189, "acc": 0.8408380746841431, "length": 3.9898033142089844, "mode": "train", "epoch": 11}
{"loss": 0.3705856502056122, "acc": 0.8569445013999939, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.34551072120666504, "acc": 0.8574103116989136, "length": 3.991956949234009, "mode": "train", "epoch": 12}
{"loss": 0.37356841564178467, "acc": 0.8517361879348755, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.32532408833503723, "acc": 0.8608532547950745, "length": 3.9940428733825684, "mode": "train", "epoch": 13}
{"loss": 0.36268436908721924, "acc": 0.8581597805023193, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.31255435943603516, "acc": 0.8668471574783325, "length": 3.995490789413452, "mode": "train", "epoch": 14}
{"loss": 0.3461517095565796, "acc": 0.8623263835906982, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.29382702708244324, "acc": 0.8759797215461731, "length": 3.995598554611206, "mode": "train", "epoch": 15}
{"loss": 0.33099836111068726, "acc": 0.8692708015441895, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2729611396789551, "acc": 0.8840145468711853, "length": 3.993419647216797, "mode": "train", "epoch": 16}
{"loss": 0.3169035315513611, "acc": 0.8831596970558167, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.25582367181777954, "acc": 0.8986506462097168, "length": 3.9967663288116455, "mode": "train", "epoch": 17}
{"loss": 0.2974700331687927, "acc": 0.8866319060325623, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2518483102321625, "acc": 0.9051507115364075, "length": 3.997196674346924, "mode": "train", "epoch": 18}
{"loss": 0.28833863139152527, "acc": 0.8861110210418701, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.24274243414402008, "acc": 0.9075254797935486, "length": 3.9979195594787598, "mode": "train", "epoch": 19}
{"loss": 0.2795008420944214, "acc": 0.8947916030883789, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.23957645893096924, "acc": 0.9091033339500427, "length": 3.9984517097473145, "mode": "train", "epoch": 20}
{"loss": 0.26353809237480164, "acc": 0.9012153148651123, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.22637154161930084, "acc": 0.9150795340538025, "length": 3.9984827041625977, "mode": "train", "epoch": 21}
{"loss": 0.28200575709342957, "acc": 0.8937499523162842, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23009856045246124, "acc": 0.9151371717453003, "length": 3.9984662532806396, "mode": "train", "epoch": 22}
{"loss": 0.2540770173072815, "acc": 0.9065972566604614, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.21846871078014374, "acc": 0.920560896396637, "length": 3.9989657402038574, "mode": "train", "epoch": 23}
{"loss": 0.2594386637210846, "acc": 0.9041666388511658, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.20559494197368622, "acc": 0.9206759929656982, "length": 3.9986138343811035, "mode": "train", "epoch": 24}
{"loss": 0.2542831301689148, "acc": 0.9005207419395447, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20603406429290771, "acc": 0.924813985824585, "length": 3.998745918273926, "mode": "train", "epoch": 25}
{"loss": 0.23813623189926147, "acc": 0.9088541865348816, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.20355650782585144, "acc": 0.9222384691238403, "length": 3.9990735054016113, "mode": "train", "epoch": 26}
{"loss": 0.2354888617992401, "acc": 0.9107639789581299, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.204721137881279, "acc": 0.9251182675361633, "length": 3.999276638031006, "mode": "train", "epoch": 27}
{"loss": 0.23635339736938477, "acc": 0.9097222089767456, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19317719340324402, "acc": 0.9285376667976379, "length": 3.9982409477233887, "mode": "train", "epoch": 28}
{"loss": 0.25155118107795715, "acc": 0.9098958969116211, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.19233660399913788, "acc": 0.9256455302238464, "length": 3.9994711875915527, "mode": "train", "epoch": 29}
{"loss": 0.2388879507780075, "acc": 0.9098958969116211, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18743912875652313, "acc": 0.932715654373169, "length": 3.9994161128997803, "mode": "train", "epoch": 30}
{"loss": 0.23835335671901703, "acc": 0.9081597924232483, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1875501126050949, "acc": 0.929778516292572, "length": 3.9990670680999756, "mode": "train", "epoch": 31}
{"loss": 0.22716014087200165, "acc": 0.9166666865348816, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17844712734222412, "acc": 0.9343868494033813, "length": 3.9995181560516357, "mode": "train", "epoch": 32}
{"loss": 0.2186598926782608, "acc": 0.9097222089767456, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17258918285369873, "acc": 0.9374980330467224, "length": 3.9995601177215576, "mode": "train", "epoch": 33}
{"loss": 0.22871579229831696, "acc": 0.9147568941116333, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.16911110281944275, "acc": 0.9374376535415649, "length": 3.999494791030884, "mode": "train", "epoch": 34}
{"loss": 0.21835190057754517, "acc": 0.918055534362793, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1717919260263443, "acc": 0.9376024603843689, "length": 3.9991068840026855, "mode": "train", "epoch": 35}
{"loss": 0.23173114657402039, "acc": 0.9178818464279175, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.16409659385681152, "acc": 0.9381349086761475, "length": 3.999695062637329, "mode": "train", "epoch": 36}
{"loss": 0.2109331637620926, "acc": 0.9182291030883789, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16170404851436615, "acc": 0.9415878057479858, "length": 3.9996678829193115, "mode": "train", "epoch": 37}
{"loss": 0.21043580770492554, "acc": 0.9210069179534912, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.16003690659999847, "acc": 0.94100421667099, "length": 3.9995369911193848, "mode": "train", "epoch": 38}
{"loss": 0.22109919786453247, "acc": 0.9152777791023254, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16063259541988373, "acc": 0.9461910724639893, "length": 3.999626398086548, "mode": "train", "epoch": 39}
{"loss": 0.20040303468704224, "acc": 0.9282985329627991, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15309154987335205, "acc": 0.9453639388084412, "length": 3.9992544651031494, "mode": "train", "epoch": 40}
{"loss": 0.19404736161231995, "acc": 0.918055534362793, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.14509077370166779, "acc": 0.9466559886932373, "length": 3.999818801879883, "mode": "train", "epoch": 41}
{"loss": 0.20618408918380737, "acc": 0.9284722208976746, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.14173628389835358, "acc": 0.9479224681854248, "length": 3.999843120574951, "mode": "train", "epoch": 42}
{"loss": 0.19731253385543823, "acc": 0.9307292103767395, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13510064780712128, "acc": 0.9510887265205383, "length": 3.999882936477661, "mode": "train", "epoch": 43}
{"loss": 0.1947135478258133, "acc": 0.933680534362793, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.12817026674747467, "acc": 0.9540801644325256, "length": 3.999891757965088, "mode": "train", "epoch": 44}
{"loss": 0.19935180246829987, "acc": 0.9305555820465088, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.12803611159324646, "acc": 0.9544844627380371, "length": 3.999924421310425, "mode": "train", "epoch": 45}
{"loss": 0.19716927409172058, "acc": 0.9309027791023254, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.12737151980400085, "acc": 0.9539105296134949, "length": 3.999946355819702, "mode": "train", "epoch": 46}
{"loss": 0.18868963420391083, "acc": 0.9324653148651123, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.11905122548341751, "acc": 0.9568395018577576, "length": 3.9997706413269043, "mode": "train", "epoch": 47}
{"loss": 0.18011274933815002, "acc": 0.9279513955116272, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.12381786853075027, "acc": 0.9552332758903503, "length": 3.999938488006592, "mode": "train", "epoch": 48}
{"loss": 0.169327050447464, "acc": 0.9361111521720886, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11843567341566086, "acc": 0.9609304666519165, "length": 3.9999616146087646, "mode": "train", "epoch": 49}
{"loss": 0.16615302860736847, "acc": 0.9388889670372009, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1200735792517662, "acc": 0.9580532312393188, "length": 3.9999594688415527, "mode": "train", "epoch": 50}
{"loss": 0.16469790041446686, "acc": 0.9390624165534973, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.11737556755542755, "acc": 0.9593180418014526, "length": 3.9999403953552246, "mode": "train", "epoch": 51}
{"loss": 0.1806773543357849, "acc": 0.9305555820465088, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11433488875627518, "acc": 0.961098849773407, "length": 3.999875783920288, "mode": "train", "epoch": 52}
{"loss": 0.1701674908399582, "acc": 0.9364582896232605, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.10745967924594879, "acc": 0.961158812046051, "length": 3.999920129776001, "mode": "train", "epoch": 53}
{"loss": 0.1824917197227478, "acc": 0.9352429509162903, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.10610125213861465, "acc": 0.9620228409767151, "length": 3.999922752380371, "mode": "train", "epoch": 54}
{"loss": 0.15442299842834473, "acc": 0.9446181058883667, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1137060895562172, "acc": 0.9613290429115295, "length": 3.999886989593506, "mode": "train", "epoch": 55}
{"loss": 0.15882164239883423, "acc": 0.9456597566604614, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.11710883677005768, "acc": 0.9583993554115295, "length": 3.9999759197235107, "mode": "train", "epoch": 56}
{"loss": 0.1692313402891159, "acc": 0.9359375834465027, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11348013579845428, "acc": 0.960760235786438, "length": 3.9992456436157227, "mode": "train", "epoch": 57}
{"loss": 0.15802806615829468, "acc": 0.9534722566604614, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10196314752101898, "acc": 0.9665117859840393, "length": 3.9999680519104004, "mode": "train", "epoch": 58}
{"loss": 0.14959031343460083, "acc": 0.9451388120651245, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09860096126794815, "acc": 0.9648409485816956, "length": 3.9999165534973145, "mode": "train", "epoch": 59}
{"loss": 0.1446969211101532, "acc": 0.9517361521720886, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09248398244380951, "acc": 0.9683529734611511, "length": 3.9999732971191406, "mode": "train", "epoch": 60}
{"loss": 0.14658010005950928, "acc": 0.9520832896232605, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7105357646942139
