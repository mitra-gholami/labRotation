ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6899639964103699, "acc": 0.5318922400474548, "length": 3.4010379314422607, "mode": "train", "epoch": 1}
{"loss": 0.663215696811676, "acc": 0.634082019329071, "length": 2.796875, "mode": "test", "epoch": 1}
{"loss": 0.6063066124916077, "acc": 0.6857051253318787, "length": 3.4782068729400635, "mode": "train", "epoch": 2}
{"loss": 0.55021733045578, "acc": 0.7369873523712158, "length": 3.3828125, "mode": "test", "epoch": 2}
{"loss": 0.4904320538043976, "acc": 0.7877731919288635, "length": 3.4468019008636475, "mode": "train", "epoch": 3}
{"loss": 0.43987372517585754, "acc": 0.814208984375, "length": 3.84375, "mode": "test", "epoch": 3}
{"loss": 0.3888899087905884, "acc": 0.8409860730171204, "length": 3.888930082321167, "mode": "train", "epoch": 4}
{"loss": 0.3843406140804291, "acc": 0.8279296159744263, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.3438836634159088, "acc": 0.8625257611274719, "length": 3.9617860317230225, "mode": "train", "epoch": 5}
{"loss": 0.34969332814216614, "acc": 0.8539062142372131, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3023523986339569, "acc": 0.8790736198425293, "length": 3.9707415103912354, "mode": "train", "epoch": 6}
{"loss": 0.30330178141593933, "acc": 0.8775390386581421, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.2680499851703644, "acc": 0.8920062184333801, "length": 3.9818592071533203, "mode": "train", "epoch": 7}
{"loss": 0.2879408597946167, "acc": 0.8798828125, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.2673228085041046, "acc": 0.8943161368370056, "length": 3.9853312969207764, "mode": "train", "epoch": 8}
{"loss": 0.2802581489086151, "acc": 0.8835936784744263, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.25264763832092285, "acc": 0.8998607397079468, "length": 3.9906561374664307, "mode": "train", "epoch": 9}
{"loss": 0.2565414607524872, "acc": 0.8898438215255737, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.2355094999074936, "acc": 0.9137312173843384, "length": 3.9853386878967285, "mode": "train", "epoch": 10}
{"loss": 0.22884707152843475, "acc": 0.9160155653953552, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.21811483800411224, "acc": 0.916252076625824, "length": 3.9916534423828125, "mode": "train", "epoch": 11}
{"loss": 0.2234002649784088, "acc": 0.9109374284744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2070702612400055, "acc": 0.9235932230949402, "length": 3.9898879528045654, "mode": "train", "epoch": 12}
{"loss": 0.21710355579853058, "acc": 0.9220704436302185, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.19776880741119385, "acc": 0.9277917146682739, "length": 3.9948370456695557, "mode": "train", "epoch": 13}
{"loss": 0.21858856081962585, "acc": 0.9273437857627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.18932390213012695, "acc": 0.9308553338050842, "length": 3.9952611923217773, "mode": "train", "epoch": 14}
{"loss": 0.2151561677455902, "acc": 0.9277344346046448, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.18592755496501923, "acc": 0.9337695837020874, "length": 3.9992737770080566, "mode": "train", "epoch": 15}
{"loss": 0.19285793602466583, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.18615558743476868, "acc": 0.9307541847229004, "length": 3.9980673789978027, "mode": "train", "epoch": 16}
{"loss": 0.19428890943527222, "acc": 0.9326171875, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.17204344272613525, "acc": 0.9390265941619873, "length": 3.9984960556030273, "mode": "train", "epoch": 17}
{"loss": 0.19899743795394897, "acc": 0.9318360090255737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.17164970934391022, "acc": 0.9390870332717896, "length": 3.9959301948547363, "mode": "train", "epoch": 18}
{"loss": 0.18631190061569214, "acc": 0.9363280534744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.17324282228946686, "acc": 0.9384961724281311, "length": 3.9983997344970703, "mode": "train", "epoch": 19}
{"loss": 0.1839258074760437, "acc": 0.9374999403953552, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.16592350602149963, "acc": 0.9436426758766174, "length": 3.998575448989868, "mode": "train", "epoch": 20}
{"loss": 0.18547843396663666, "acc": 0.9392577409744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.1609143316745758, "acc": 0.9422581791877747, "length": 3.999356746673584, "mode": "train", "epoch": 21}
{"loss": 0.1812799870967865, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.16172629594802856, "acc": 0.9400879144668579, "length": 3.998173475265503, "mode": "train", "epoch": 22}
{"loss": 0.1822827160358429, "acc": 0.9357422590255737, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.15330104529857635, "acc": 0.9480596780776978, "length": 3.999591827392578, "mode": "train", "epoch": 23}
{"loss": 0.17392408847808838, "acc": 0.9384765625, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.15405021607875824, "acc": 0.9431969523429871, "length": 3.9995150566101074, "mode": "train", "epoch": 24}
{"loss": 0.19858048856258392, "acc": 0.9365234375, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1679145246744156, "acc": 0.9406083822250366, "length": 3.9992878437042236, "mode": "train", "epoch": 25}
{"loss": 0.1817055195569992, "acc": 0.9439453482627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.15067215263843536, "acc": 0.9497647285461426, "length": 3.999948024749756, "mode": "train", "epoch": 26}
{"loss": 0.16105300188064575, "acc": 0.9453125596046448, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.14132240414619446, "acc": 0.9505262970924377, "length": 3.9999709129333496, "mode": "train", "epoch": 27}
{"loss": 0.156774640083313, "acc": 0.9458984732627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.14718545973300934, "acc": 0.9462267160415649, "length": 3.9994776248931885, "mode": "train", "epoch": 28}
{"loss": 0.17701737582683563, "acc": 0.9386720061302185, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.1423282027244568, "acc": 0.9456055760383606, "length": 3.9998891353607178, "mode": "train", "epoch": 29}
{"loss": 0.17825819551944733, "acc": 0.9382811784744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.13670693337917328, "acc": 0.950695812702179, "length": 3.999756336212158, "mode": "train", "epoch": 30}
{"loss": 0.1542014628648758, "acc": 0.9496093392372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.12593983113765717, "acc": 0.9514411687850952, "length": 3.998192310333252, "mode": "train", "epoch": 31}
{"loss": 0.1424589902162552, "acc": 0.9498047232627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.1336696743965149, "acc": 0.9492060542106628, "length": 3.9989545345306396, "mode": "train", "epoch": 32}
{"loss": 0.16528800129890442, "acc": 0.9419922232627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1284792721271515, "acc": 0.9526341557502747, "length": 3.99997615814209, "mode": "train", "epoch": 33}
{"loss": 0.1507219672203064, "acc": 0.9380859732627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.12369399517774582, "acc": 0.9513437747955322, "length": 3.9998631477355957, "mode": "train", "epoch": 34}
{"loss": 0.15609964728355408, "acc": 0.943359375, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1328362226486206, "acc": 0.9526336193084717, "length": 3.9999594688415527, "mode": "train", "epoch": 35}
{"loss": 0.15370319783687592, "acc": 0.9380860328674316, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.12854139506816864, "acc": 0.9519370198249817, "length": 3.9989030361175537, "mode": "train", "epoch": 36}
{"loss": 0.15965920686721802, "acc": 0.947265625, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.13230963051319122, "acc": 0.948298454284668, "length": 3.9998626708984375, "mode": "train", "epoch": 37}
{"loss": 0.19912518560886383, "acc": 0.9283203482627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.13978694379329681, "acc": 0.9511648416519165, "length": 3.9997901916503906, "mode": "train", "epoch": 38}
{"loss": 0.1732577681541443, "acc": 0.9443358778953552, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.12477312237024307, "acc": 0.9562625288963318, "length": 3.9999184608459473, "mode": "train", "epoch": 39}
{"loss": 0.14501918852329254, "acc": 0.9503906965255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.12123697996139526, "acc": 0.955144464969635, "length": 3.9996066093444824, "mode": "train", "epoch": 40}
{"loss": 0.15746712684631348, "acc": 0.9468750953674316, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.11911366879940033, "acc": 0.9553769826889038, "length": 3.999817371368408, "mode": "train", "epoch": 41}
{"loss": 0.14724023640155792, "acc": 0.9480467438697815, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.11401842534542084, "acc": 0.9570835828781128, "length": 3.9999804496765137, "mode": "train", "epoch": 42}
{"loss": 0.12996037304401398, "acc": 0.9482421875, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.10488052666187286, "acc": 0.9598199725151062, "length": 3.9993584156036377, "mode": "train", "epoch": 43}
{"loss": 0.1383814513683319, "acc": 0.9501953125, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.09762794524431229, "acc": 0.9591916799545288, "length": 3.9999923706054688, "mode": "train", "epoch": 44}
{"loss": 0.1245235726237297, "acc": 0.9566406607627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.09525278955698013, "acc": 0.9642849564552307, "length": 3.999981164932251, "mode": "train", "epoch": 45}
{"loss": 0.1319771707057953, "acc": 0.9583984017372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.09186769276857376, "acc": 0.9656306505203247, "length": 3.9999659061431885, "mode": "train", "epoch": 46}
{"loss": 0.13353484869003296, "acc": 0.953125, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.0834287479519844, "acc": 0.968910276889801, "length": 3.9999797344207764, "mode": "train", "epoch": 47}
{"loss": 0.13387693464756012, "acc": 0.9542970061302185, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.08168773353099823, "acc": 0.9704912304878235, "length": 3.9999840259552, "mode": "train", "epoch": 48}
{"loss": 0.12485282868146896, "acc": 0.9554687142372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.0800008624792099, "acc": 0.9689689874649048, "length": 3.999983310699463, "mode": "train", "epoch": 49}
{"loss": 0.12611092627048492, "acc": 0.9595703482627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.07469046860933304, "acc": 0.9723607897758484, "length": 3.9998512268066406, "mode": "train", "epoch": 50}
{"loss": 0.12402640283107758, "acc": 0.9591798186302185, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.08137459307909012, "acc": 0.9684993624687195, "length": 3.999932289123535, "mode": "train", "epoch": 51}
{"loss": 0.16785584390163422, "acc": 0.9507812857627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.0806889533996582, "acc": 0.9673882722854614, "length": 3.999981641769409, "mode": "train", "epoch": 52}
{"loss": 0.1115436777472496, "acc": 0.9578124284744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.08007880300283432, "acc": 0.9663931131362915, "length": 3.9999923706054688, "mode": "train", "epoch": 53}
{"loss": 0.14730983972549438, "acc": 0.9443359971046448, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07600890845060349, "acc": 0.9652222394943237, "length": 3.9999771118164062, "mode": "train", "epoch": 54}
{"loss": 0.12214376777410507, "acc": 0.9542969465255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.09013247489929199, "acc": 0.9651049971580505, "length": 3.9999823570251465, "mode": "train", "epoch": 55}
{"loss": 0.1272372603416443, "acc": 0.9607421159744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.07854491472244263, "acc": 0.9693204164505005, "length": 3.9999799728393555, "mode": "train", "epoch": 56}
{"loss": 0.12440332025289536, "acc": 0.9603515267372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.06714216619729996, "acc": 0.9744728207588196, "length": 3.999995231628418, "mode": "train", "epoch": 57}
{"loss": 0.10801014304161072, "acc": 0.9630860090255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06314338743686676, "acc": 0.9749400019645691, "length": 3.9999725818634033, "mode": "train", "epoch": 58}
{"loss": 0.10348861664533615, "acc": 0.9621094465255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.06600538641214371, "acc": 0.974585235118866, "length": 3.999277353286743, "mode": "train", "epoch": 59}
{"loss": 0.10499025136232376, "acc": 0.9679688215255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.06635718047618866, "acc": 0.9734185338020325, "length": 3.9999887943267822, "mode": "train", "epoch": 60}
{"loss": 0.09644817560911179, "acc": 0.96484375, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7593333125114441
