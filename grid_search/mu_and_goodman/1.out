ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6988152861595154, "acc": 0.5117502808570862, "length": 3.4427132606506348, "mode": "train", "epoch": 1}
{"loss": 0.6928666830062866, "acc": 0.5259765982627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6860313415527344, "acc": 0.5500404834747314, "length": 3.101545572280884, "mode": "train", "epoch": 2}
{"loss": 0.6566377878189087, "acc": 0.629260241985321, "length": 2.74609375, "mode": "test", "epoch": 2}
{"loss": 0.6280270218849182, "acc": 0.6743634343147278, "length": 3.5727453231811523, "mode": "train", "epoch": 3}
{"loss": 0.5655336976051331, "acc": 0.7373046875, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5479671955108643, "acc": 0.720256507396698, "length": 3.9126193523406982, "mode": "train", "epoch": 4}
{"loss": 0.5423122048377991, "acc": 0.7185547351837158, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5030685067176819, "acc": 0.7543777227401733, "length": 3.934431552886963, "mode": "train", "epoch": 5}
{"loss": 0.48638731241226196, "acc": 0.7582030892372131, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.45195940136909485, "acc": 0.7915068864822388, "length": 3.957285165786743, "mode": "train", "epoch": 6}
{"loss": 0.4514279067516327, "acc": 0.7976562976837158, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.415038138628006, "acc": 0.8231896758079529, "length": 3.977112054824829, "mode": "train", "epoch": 7}
{"loss": 0.4245851933956146, "acc": 0.7999999523162842, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.38570672273635864, "acc": 0.8339250087738037, "length": 3.9833827018737793, "mode": "train", "epoch": 8}
{"loss": 0.41127657890319824, "acc": 0.7925781607627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.36120015382766724, "acc": 0.8440055251121521, "length": 3.987370491027832, "mode": "train", "epoch": 9}
{"loss": 0.4062691926956177, "acc": 0.7935547232627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3446039855480194, "acc": 0.8510525226593018, "length": 3.9921517372131348, "mode": "train", "epoch": 10}
{"loss": 0.41400346159935, "acc": 0.7964844107627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3358462154865265, "acc": 0.8572002649307251, "length": 3.99343204498291, "mode": "train", "epoch": 11}
{"loss": 0.3917100429534912, "acc": 0.8269530534744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.31677505373954773, "acc": 0.8688466548919678, "length": 3.993772029876709, "mode": "train", "epoch": 12}
{"loss": 0.3537777066230774, "acc": 0.8408203125, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3064630925655365, "acc": 0.87165367603302, "length": 3.9958302974700928, "mode": "train", "epoch": 13}
{"loss": 0.33497342467308044, "acc": 0.8490234017372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.28868991136550903, "acc": 0.8791955709457397, "length": 3.9949517250061035, "mode": "train", "epoch": 14}
{"loss": 0.3157024085521698, "acc": 0.8619140982627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.26944515109062195, "acc": 0.8878213167190552, "length": 3.996981382369995, "mode": "train", "epoch": 15}
{"loss": 0.2939773201942444, "acc": 0.8716797232627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.25929686427116394, "acc": 0.8903516530990601, "length": 3.9976162910461426, "mode": "train", "epoch": 16}
{"loss": 0.28522613644599915, "acc": 0.8738280534744263, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.24947868287563324, "acc": 0.8954585194587708, "length": 3.9960744380950928, "mode": "train", "epoch": 17}
{"loss": 0.28590062260627747, "acc": 0.884765625, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.23684804141521454, "acc": 0.9035837650299072, "length": 3.9972100257873535, "mode": "train", "epoch": 18}
{"loss": 0.2757483720779419, "acc": 0.8902344107627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2310185730457306, "acc": 0.9050893783569336, "length": 3.998622417449951, "mode": "train", "epoch": 19}
{"loss": 0.2734096050262451, "acc": 0.8941406607627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2243274301290512, "acc": 0.9091868996620178, "length": 3.9985251426696777, "mode": "train", "epoch": 20}
{"loss": 0.24266283214092255, "acc": 0.9035156965255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21644237637519836, "acc": 0.9137316346168518, "length": 3.9981918334960938, "mode": "train", "epoch": 21}
{"loss": 0.2335595339536667, "acc": 0.908203125, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.20791245996952057, "acc": 0.9171410799026489, "length": 3.997997522354126, "mode": "train", "epoch": 22}
{"loss": 0.22914151847362518, "acc": 0.9058594107627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1969776749610901, "acc": 0.9222832322120667, "length": 3.9990437030792236, "mode": "train", "epoch": 23}
{"loss": 0.22527724504470825, "acc": 0.9093750715255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.19403189420700073, "acc": 0.9233850836753845, "length": 3.9969112873077393, "mode": "train", "epoch": 24}
{"loss": 0.22173556685447693, "acc": 0.9019531607627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.18582426011562347, "acc": 0.9277384281158447, "length": 3.998433828353882, "mode": "train", "epoch": 25}
{"loss": 0.2067953497171402, "acc": 0.9191406965255737, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1839888095855713, "acc": 0.9294362664222717, "length": 3.9982290267944336, "mode": "train", "epoch": 26}
{"loss": 0.21432332694530487, "acc": 0.916015625, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.17864809930324554, "acc": 0.9322032928466797, "length": 3.99935245513916, "mode": "train", "epoch": 27}
{"loss": 0.19218507409095764, "acc": 0.9203124642372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.18031412363052368, "acc": 0.9282886981964111, "length": 3.998839855194092, "mode": "train", "epoch": 28}
{"loss": 0.19637641310691833, "acc": 0.9189452528953552, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.17123597860336304, "acc": 0.932881772518158, "length": 3.997837543487549, "mode": "train", "epoch": 29}
{"loss": 0.2024221122264862, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.16525878012180328, "acc": 0.9335286021232605, "length": 3.999370813369751, "mode": "train", "epoch": 30}
{"loss": 0.17196179926395416, "acc": 0.9318360090255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1537247896194458, "acc": 0.9438552856445312, "length": 3.9980897903442383, "mode": "train", "epoch": 31}
{"loss": 0.1700017899274826, "acc": 0.9298828840255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.15649539232254028, "acc": 0.9419417977333069, "length": 3.999657154083252, "mode": "train", "epoch": 32}
{"loss": 0.1611533910036087, "acc": 0.9421873688697815, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1462489813566208, "acc": 0.9447088837623596, "length": 3.99985408782959, "mode": "train", "epoch": 33}
{"loss": 0.16718332469463348, "acc": 0.9322265982627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.14835692942142487, "acc": 0.9427616596221924, "length": 3.997631072998047, "mode": "train", "epoch": 34}
{"loss": 0.17270834743976593, "acc": 0.9341797232627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1496923267841339, "acc": 0.9427544474601746, "length": 3.9965641498565674, "mode": "train", "epoch": 35}
{"loss": 0.17275430262088776, "acc": 0.9328125715255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.14346295595169067, "acc": 0.9450640082359314, "length": 3.999377727508545, "mode": "train", "epoch": 36}
{"loss": 0.16141578555107117, "acc": 0.9400390982627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.13817119598388672, "acc": 0.9478498101234436, "length": 3.9958536624908447, "mode": "train", "epoch": 37}
{"loss": 0.14888663589954376, "acc": 0.9445313215255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.13045404851436615, "acc": 0.9499965310096741, "length": 3.9997329711914062, "mode": "train", "epoch": 38}
{"loss": 0.163349449634552, "acc": 0.9388671517372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1305432766675949, "acc": 0.9503592848777771, "length": 3.9998955726623535, "mode": "train", "epoch": 39}
{"loss": 0.16340027749538422, "acc": 0.9398437142372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.13116170465946198, "acc": 0.9513177275657654, "length": 3.999600648880005, "mode": "train", "epoch": 40}
{"loss": 0.15660172700881958, "acc": 0.9388671517372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.13522394001483917, "acc": 0.9469929933547974, "length": 3.999870777130127, "mode": "train", "epoch": 41}
{"loss": 0.15143290162086487, "acc": 0.9419922828674316, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1348189413547516, "acc": 0.9484329223632812, "length": 3.9975550174713135, "mode": "train", "epoch": 42}
{"loss": 0.18707458674907684, "acc": 0.9392577409744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1295163482427597, "acc": 0.9537840485572815, "length": 3.9999356269836426, "mode": "train", "epoch": 43}
{"loss": 0.13811402022838593, "acc": 0.9521484375, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.13382476568222046, "acc": 0.9477676749229431, "length": 3.998904228210449, "mode": "train", "epoch": 44}
{"loss": 0.13384678959846497, "acc": 0.9533203840255737, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.12167263776063919, "acc": 0.9544467926025391, "length": 3.999988317489624, "mode": "train", "epoch": 45}
{"loss": 0.1309693157672882, "acc": 0.9541015625, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.12115112692117691, "acc": 0.9536005854606628, "length": 3.99959135055542, "mode": "train", "epoch": 46}
{"loss": 0.14324136078357697, "acc": 0.9470702409744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.11939254403114319, "acc": 0.9562495946884155, "length": 3.9999241828918457, "mode": "train", "epoch": 47}
{"loss": 0.13820911943912506, "acc": 0.9550781846046448, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11545804888010025, "acc": 0.9556808471679688, "length": 3.9992728233337402, "mode": "train", "epoch": 48}
{"loss": 0.14466872811317444, "acc": 0.9462890625, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11504794657230377, "acc": 0.9548047780990601, "length": 3.9997353553771973, "mode": "train", "epoch": 49}
{"loss": 0.1381794512271881, "acc": 0.9453125, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.10999295115470886, "acc": 0.9572677612304688, "length": 3.9998927116394043, "mode": "train", "epoch": 50}
{"loss": 0.132688969373703, "acc": 0.9529296159744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.10925661027431488, "acc": 0.9570855498313904, "length": 3.9998648166656494, "mode": "train", "epoch": 51}
{"loss": 0.13289481401443481, "acc": 0.9564452767372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11593739688396454, "acc": 0.9563695192337036, "length": 3.9999477863311768, "mode": "train", "epoch": 52}
{"loss": 0.18622857332229614, "acc": 0.9392577409744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.10896002501249313, "acc": 0.9587727785110474, "length": 3.9999184608459473, "mode": "train", "epoch": 53}
{"loss": 0.14036671817302704, "acc": 0.951171875, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.10804256051778793, "acc": 0.9592543244361877, "length": 3.9999616146087646, "mode": "train", "epoch": 54}
{"loss": 0.13481484353542328, "acc": 0.9484375715255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.10274013876914978, "acc": 0.9603953957557678, "length": 3.9999542236328125, "mode": "train", "epoch": 55}
{"loss": 0.12200699001550674, "acc": 0.9521484375, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.09581517428159714, "acc": 0.9642267823219299, "length": 3.999051332473755, "mode": "train", "epoch": 56}
{"loss": 0.12017028778791428, "acc": 0.9541015028953552, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.13078878819942474, "acc": 0.9510722756385803, "length": 3.9994049072265625, "mode": "train", "epoch": 57}
{"loss": 0.17687015235424042, "acc": 0.9326172471046448, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.12967702746391296, "acc": 0.9521609544754028, "length": 3.9997808933258057, "mode": "train", "epoch": 58}
{"loss": 0.15388892590999603, "acc": 0.9398437142372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11137164384126663, "acc": 0.9578031301498413, "length": 3.9997456073760986, "mode": "train", "epoch": 59}
{"loss": 0.13642442226409912, "acc": 0.9517578482627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.0992635190486908, "acc": 0.9640613198280334, "length": 3.999934196472168, "mode": "train", "epoch": 60}
{"loss": 0.1588970422744751, "acc": 0.9453125, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7603030204772949
