ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6977409720420837, "acc": 0.5068609118461609, "length": 3.560842752456665, "mode": "train", "epoch": 1}
{"loss": 0.6873674988746643, "acc": 0.5370543599128723, "length": 1.82421875, "mode": "test", "epoch": 1}
{"loss": 0.6927749514579773, "acc": 0.5271633863449097, "length": 3.4429855346679688, "mode": "train", "epoch": 2}
{"loss": 0.6910692453384399, "acc": 0.5348159670829773, "length": 1.16015625, "mode": "test", "epoch": 2}
{"loss": 0.6867794990539551, "acc": 0.5521677136421204, "length": 3.2426767349243164, "mode": "train", "epoch": 3}
{"loss": 0.6807444095611572, "acc": 0.5724700689315796, "length": 1.80859375, "mode": "test", "epoch": 3}
{"loss": 0.6738275289535522, "acc": 0.6098568439483643, "length": 3.2278881072998047, "mode": "train", "epoch": 4}
{"loss": 0.642534613609314, "acc": 0.6767837405204773, "length": 3.59765625, "mode": "test", "epoch": 4}
{"loss": 0.6379559636116028, "acc": 0.668281078338623, "length": 3.59893536567688, "mode": "train", "epoch": 5}
{"loss": 0.6030162572860718, "acc": 0.7013671398162842, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5692471265792847, "acc": 0.7327350974082947, "length": 3.850682020187378, "mode": "train", "epoch": 6}
{"loss": 0.5470455884933472, "acc": 0.7603515386581421, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5082201361656189, "acc": 0.7639778256416321, "length": 3.9587011337280273, "mode": "train", "epoch": 7}
{"loss": 0.5163406133651733, "acc": 0.7826171517372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.47027984261512756, "acc": 0.7889271974563599, "length": 3.9713778495788574, "mode": "train", "epoch": 8}
{"loss": 0.4806388020515442, "acc": 0.7912110686302185, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4491857886314392, "acc": 0.7936499118804932, "length": 3.9758524894714355, "mode": "train", "epoch": 9}
{"loss": 0.47479310631752014, "acc": 0.7972655892372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.42726820707321167, "acc": 0.8049210906028748, "length": 3.983567953109741, "mode": "train", "epoch": 10}
{"loss": 0.4549490511417389, "acc": 0.8048828840255737, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4100499451160431, "acc": 0.8208873271942139, "length": 3.9907798767089844, "mode": "train", "epoch": 11}
{"loss": 0.4471454620361328, "acc": 0.8011718392372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.39845436811447144, "acc": 0.8253411054611206, "length": 3.9932432174682617, "mode": "train", "epoch": 12}
{"loss": 0.4260960817337036, "acc": 0.8093749284744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3803233206272125, "acc": 0.8396509885787964, "length": 3.9918084144592285, "mode": "train", "epoch": 13}
{"loss": 0.4203808307647705, "acc": 0.8191404938697815, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3726695477962494, "acc": 0.8465235829353333, "length": 3.9979746341705322, "mode": "train", "epoch": 14}
{"loss": 0.4133157730102539, "acc": 0.8298827409744263, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3578275740146637, "acc": 0.853432297706604, "length": 3.9971566200256348, "mode": "train", "epoch": 15}
{"loss": 0.3916695713996887, "acc": 0.8375000953674316, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3382505476474762, "acc": 0.863653302192688, "length": 3.9940531253814697, "mode": "train", "epoch": 16}
{"loss": 0.376121461391449, "acc": 0.8435546159744263, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.32640722393989563, "acc": 0.8633261322975159, "length": 3.996563196182251, "mode": "train", "epoch": 17}
{"loss": 0.35102927684783936, "acc": 0.8585935831069946, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3184499740600586, "acc": 0.8716737031936646, "length": 3.9965014457702637, "mode": "train", "epoch": 18}
{"loss": 0.33349162340164185, "acc": 0.8712891340255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.30194029211997986, "acc": 0.8795381784439087, "length": 3.9955241680145264, "mode": "train", "epoch": 19}
{"loss": 0.3249328136444092, "acc": 0.8726562261581421, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2916286885738373, "acc": 0.8794003129005432, "length": 3.9966626167297363, "mode": "train", "epoch": 20}
{"loss": 0.3160816729068756, "acc": 0.8794922232627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.280067503452301, "acc": 0.8880289793014526, "length": 3.9926857948303223, "mode": "train", "epoch": 21}
{"loss": 0.29892590641975403, "acc": 0.8896483778953552, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.27047863602638245, "acc": 0.8939450979232788, "length": 3.9978935718536377, "mode": "train", "epoch": 22}
{"loss": 0.29040104150772095, "acc": 0.8951172828674316, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.26126617193222046, "acc": 0.8998979330062866, "length": 3.9936561584472656, "mode": "train", "epoch": 23}
{"loss": 0.2750810980796814, "acc": 0.9009765982627869, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.26045718789100647, "acc": 0.9019628763198853, "length": 3.9981963634490967, "mode": "train", "epoch": 24}
{"loss": 0.26636987924575806, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2468307465314865, "acc": 0.9088642001152039, "length": 3.997191905975342, "mode": "train", "epoch": 25}
{"loss": 0.2630050778388977, "acc": 0.9093751311302185, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.23811015486717224, "acc": 0.9092275500297546, "length": 3.99888277053833, "mode": "train", "epoch": 26}
{"loss": 0.24792629480361938, "acc": 0.9136719107627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2335255891084671, "acc": 0.9162058234214783, "length": 3.999648332595825, "mode": "train", "epoch": 27}
{"loss": 0.24593786895275116, "acc": 0.9150390028953552, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23114962875843048, "acc": 0.9114215970039368, "length": 3.996164560317993, "mode": "train", "epoch": 28}
{"loss": 0.23392164707183838, "acc": 0.9160156846046448, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.22812142968177795, "acc": 0.9152176380157471, "length": 3.9997446537017822, "mode": "train", "epoch": 29}
{"loss": 0.23140741884708405, "acc": 0.9171875715255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.21405012905597687, "acc": 0.9161998629570007, "length": 3.998976230621338, "mode": "train", "epoch": 30}
{"loss": 0.23021212220191956, "acc": 0.9179686903953552, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.20566114783287048, "acc": 0.9233520030975342, "length": 3.9994466304779053, "mode": "train", "epoch": 31}
{"loss": 0.22213949263095856, "acc": 0.9183592796325684, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2078518122434616, "acc": 0.9228887557983398, "length": 3.9998621940612793, "mode": "train", "epoch": 32}
{"loss": 0.2191447615623474, "acc": 0.9232421517372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.19763170182704926, "acc": 0.9272234439849854, "length": 3.9999568462371826, "mode": "train", "epoch": 33}
{"loss": 0.21803562343120575, "acc": 0.9185547232627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.20302262902259827, "acc": 0.9258401393890381, "length": 3.999145030975342, "mode": "train", "epoch": 34}
{"loss": 0.22628742456436157, "acc": 0.9181641340255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.19212116301059723, "acc": 0.9268930554389954, "length": 3.9967257976531982, "mode": "train", "epoch": 35}
{"loss": 0.20777779817581177, "acc": 0.9220703840255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.18915532529354095, "acc": 0.9338095784187317, "length": 3.994821548461914, "mode": "train", "epoch": 36}
{"loss": 0.20800569653511047, "acc": 0.9228515028953552, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.18172983825206757, "acc": 0.9372245073318481, "length": 3.999382972717285, "mode": "train", "epoch": 37}
{"loss": 0.19776064157485962, "acc": 0.9216796159744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.18339116871356964, "acc": 0.9327325224876404, "length": 3.9976701736450195, "mode": "train", "epoch": 38}
{"loss": 0.20848199725151062, "acc": 0.9177733659744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.17577455937862396, "acc": 0.9359288215637207, "length": 3.9981045722961426, "mode": "train", "epoch": 39}
{"loss": 0.20233525335788727, "acc": 0.9251952171325684, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.17562760412693024, "acc": 0.9354164004325867, "length": 3.9993791580200195, "mode": "train", "epoch": 40}
{"loss": 0.20486152172088623, "acc": 0.9296874403953552, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.16983163356781006, "acc": 0.9406364560127258, "length": 3.9973950386047363, "mode": "train", "epoch": 41}
{"loss": 0.189533531665802, "acc": 0.9240235686302185, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.16703379154205322, "acc": 0.9406895041465759, "length": 3.9998416900634766, "mode": "train", "epoch": 42}
{"loss": 0.1927562654018402, "acc": 0.9277343153953552, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.16435299813747406, "acc": 0.939558207988739, "length": 3.999296188354492, "mode": "train", "epoch": 43}
{"loss": 0.20979517698287964, "acc": 0.9228516221046448, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.16290120780467987, "acc": 0.9409230947494507, "length": 3.999096155166626, "mode": "train", "epoch": 44}
{"loss": 0.20162993669509888, "acc": 0.9291014671325684, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.15758578479290009, "acc": 0.9444171190261841, "length": 3.9994747638702393, "mode": "train", "epoch": 45}
{"loss": 0.19417063891887665, "acc": 0.9298828840255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.158009335398674, "acc": 0.942753791809082, "length": 3.9954960346221924, "mode": "train", "epoch": 46}
{"loss": 0.19854041934013367, "acc": 0.9279298186302185, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.15178182721138, "acc": 0.9464821219444275, "length": 3.999849796295166, "mode": "train", "epoch": 47}
{"loss": 0.2047114074230194, "acc": 0.9253906607627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1430598497390747, "acc": 0.9481756687164307, "length": 3.9995131492614746, "mode": "train", "epoch": 48}
{"loss": 0.20720668137073517, "acc": 0.9271484017372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.14903901517391205, "acc": 0.9450808167457581, "length": 3.9999613761901855, "mode": "train", "epoch": 49}
{"loss": 0.17771723866462708, "acc": 0.9384766221046448, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.14428181946277618, "acc": 0.9474666118621826, "length": 3.999077558517456, "mode": "train", "epoch": 50}
{"loss": 0.18866753578186035, "acc": 0.9324218034744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.139757439494133, "acc": 0.9498661756515503, "length": 3.9993069171905518, "mode": "train", "epoch": 51}
{"loss": 0.18818704783916473, "acc": 0.9287109375, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1372193992137909, "acc": 0.9485940337181091, "length": 3.9999678134918213, "mode": "train", "epoch": 52}
{"loss": 0.16851818561553955, "acc": 0.9416016936302185, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1323803961277008, "acc": 0.9472747445106506, "length": 3.9970157146453857, "mode": "train", "epoch": 53}
{"loss": 0.1867372691631317, "acc": 0.9322265982627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1348990648984909, "acc": 0.9538570046424866, "length": 3.9984092712402344, "mode": "train", "epoch": 54}
{"loss": 0.18757688999176025, "acc": 0.9365234971046448, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.13040399551391602, "acc": 0.9542468786239624, "length": 3.9984025955200195, "mode": "train", "epoch": 55}
{"loss": 0.18209035694599152, "acc": 0.9394531846046448, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.12872053682804108, "acc": 0.9540899395942688, "length": 3.999408721923828, "mode": "train", "epoch": 56}
{"loss": 0.16532401740550995, "acc": 0.9460936784744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1295040100812912, "acc": 0.9523951411247253, "length": 3.9996981620788574, "mode": "train", "epoch": 57}
{"loss": 0.15667349100112915, "acc": 0.9482422471046448, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.12305468320846558, "acc": 0.9539787173271179, "length": 3.9999377727508545, "mode": "train", "epoch": 58}
{"loss": 0.1759420931339264, "acc": 0.9427734613418579, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11771678924560547, "acc": 0.9543316960334778, "length": 3.999897003173828, "mode": "train", "epoch": 59}
{"loss": 0.16918432712554932, "acc": 0.9392576813697815, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.12061876803636551, "acc": 0.9566144347190857, "length": 3.9999186992645264, "mode": "train", "epoch": 60}
{"loss": 0.16816973686218262, "acc": 0.9398437142372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7110001444816589
