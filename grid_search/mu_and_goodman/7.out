ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6947123408317566, "acc": 0.5081809759140015, "length": 3.531442403793335, "mode": "train", "epoch": 1}
{"loss": 0.6763985753059387, "acc": 0.5903754830360413, "length": 1.9895833730697632, "mode": "test", "epoch": 1}
{"loss": 0.682961106300354, "acc": 0.5659564137458801, "length": 3.3368022441864014, "mode": "train", "epoch": 2}
{"loss": 0.6532794833183289, "acc": 0.6793782711029053, "length": 2.8611111640930176, "mode": "test", "epoch": 2}
{"loss": 0.61627596616745, "acc": 0.717189371585846, "length": 3.5584299564361572, "mode": "train", "epoch": 3}
{"loss": 0.5325987339019775, "acc": 0.7802082896232605, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4892081916332245, "acc": 0.7905763387680054, "length": 3.9001686573028564, "mode": "train", "epoch": 4}
{"loss": 0.4573426842689514, "acc": 0.8130208849906921, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.43363118171691895, "acc": 0.8206061124801636, "length": 3.9690210819244385, "mode": "train", "epoch": 5}
{"loss": 0.4543852210044861, "acc": 0.8140623569488525, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.41348209977149963, "acc": 0.8240882158279419, "length": 3.9797427654266357, "mode": "train", "epoch": 6}
{"loss": 0.42744654417037964, "acc": 0.8208333849906921, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3921446204185486, "acc": 0.8337831497192383, "length": 3.9862165451049805, "mode": "train", "epoch": 7}
{"loss": 0.40263864398002625, "acc": 0.8350694179534912, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3594661355018616, "acc": 0.8545835614204407, "length": 3.9894585609436035, "mode": "train", "epoch": 8}
{"loss": 0.3769373595714569, "acc": 0.840624988079071, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.32989850640296936, "acc": 0.8667815327644348, "length": 3.994133472442627, "mode": "train", "epoch": 9}
{"loss": 0.3496186137199402, "acc": 0.8524305820465088, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3144773840904236, "acc": 0.8692651987075806, "length": 3.990154504776001, "mode": "train", "epoch": 10}
{"loss": 0.326288640499115, "acc": 0.8609374165534973, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.29796573519706726, "acc": 0.8790103793144226, "length": 3.9942119121551514, "mode": "train", "epoch": 11}
{"loss": 0.3307966887950897, "acc": 0.8550347685813904, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2873691916465759, "acc": 0.878844678401947, "length": 3.997309446334839, "mode": "train", "epoch": 12}
{"loss": 0.32028728723526, "acc": 0.859375, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.29366233944892883, "acc": 0.8785752058029175, "length": 3.9912521839141846, "mode": "train", "epoch": 13}
{"loss": 0.324457049369812, "acc": 0.8618054986000061, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2853530943393707, "acc": 0.8820684552192688, "length": 3.9985196590423584, "mode": "train", "epoch": 14}
{"loss": 0.31232595443725586, "acc": 0.8687499165534973, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.28618043661117554, "acc": 0.881321907043457, "length": 3.9984352588653564, "mode": "train", "epoch": 15}
{"loss": 0.30669939517974854, "acc": 0.8699653744697571, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.27173909544944763, "acc": 0.8865116238594055, "length": 3.9984922409057617, "mode": "train", "epoch": 16}
{"loss": 0.30515316128730774, "acc": 0.8689236044883728, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.26757875084877014, "acc": 0.8855535984039307, "length": 3.998922348022461, "mode": "train", "epoch": 17}
{"loss": 0.296853631734848, "acc": 0.8694444298744202, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2709513008594513, "acc": 0.8847380876541138, "length": 3.998781204223633, "mode": "train", "epoch": 18}
{"loss": 0.30410635471343994, "acc": 0.8657985925674438, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.26058679819107056, "acc": 0.8877801895141602, "length": 3.9993155002593994, "mode": "train", "epoch": 19}
{"loss": 0.2811904847621918, "acc": 0.8828125, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2604082226753235, "acc": 0.893711268901825, "length": 3.99957013130188, "mode": "train", "epoch": 20}
{"loss": 0.2945815324783325, "acc": 0.8760417103767395, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.25558286905288696, "acc": 0.8934902548789978, "length": 3.9997012615203857, "mode": "train", "epoch": 21}
{"loss": 0.2716189920902252, "acc": 0.8866319060325623, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.25315019488334656, "acc": 0.8942270278930664, "length": 3.9995779991149902, "mode": "train", "epoch": 22}
{"loss": 0.2866000831127167, "acc": 0.8826387524604797, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2507784068584442, "acc": 0.8929338455200195, "length": 3.998098850250244, "mode": "train", "epoch": 23}
{"loss": 0.27570441365242004, "acc": 0.8817707896232605, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2530037760734558, "acc": 0.8938888311386108, "length": 3.998497247695923, "mode": "train", "epoch": 24}
{"loss": 0.27596309781074524, "acc": 0.8821181654930115, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.250088095664978, "acc": 0.8923459649085999, "length": 3.9995243549346924, "mode": "train", "epoch": 25}
{"loss": 0.2611084580421448, "acc": 0.8914930820465088, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2396707683801651, "acc": 0.904148280620575, "length": 3.9992291927337646, "mode": "train", "epoch": 26}
{"loss": 0.2500408887863159, "acc": 0.8940972089767456, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.23495273292064667, "acc": 0.903755784034729, "length": 3.9998486042022705, "mode": "train", "epoch": 27}
{"loss": 0.2540796101093292, "acc": 0.8932291865348816, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23133209347724915, "acc": 0.9046161770820618, "length": 3.999948024749756, "mode": "train", "epoch": 28}
{"loss": 0.24551838636398315, "acc": 0.8934028148651123, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2374630719423294, "acc": 0.8989084959030151, "length": 3.999760866165161, "mode": "train", "epoch": 29}
{"loss": 0.25453633069992065, "acc": 0.8977431058883667, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.23931685090065002, "acc": 0.8995987772941589, "length": 3.9999420642852783, "mode": "train", "epoch": 30}
{"loss": 0.24832704663276672, "acc": 0.8913193941116333, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2258259505033493, "acc": 0.9110012650489807, "length": 3.9999284744262695, "mode": "train", "epoch": 31}
{"loss": 0.2441617101430893, "acc": 0.8909722566604614, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2301156371831894, "acc": 0.9054084420204163, "length": 3.9997994899749756, "mode": "train", "epoch": 32}
{"loss": 0.2504235804080963, "acc": 0.8902778625488281, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.22546817362308502, "acc": 0.9043321013450623, "length": 3.9999730587005615, "mode": "train", "epoch": 33}
{"loss": 0.24737916886806488, "acc": 0.8979166746139526, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.22461597621440887, "acc": 0.9057408571243286, "length": 3.9997575283050537, "mode": "train", "epoch": 34}
{"loss": 0.2445010542869568, "acc": 0.8942708969116211, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21980954706668854, "acc": 0.9108325242996216, "length": 3.999769687652588, "mode": "train", "epoch": 35}
{"loss": 0.2602215111255646, "acc": 0.8909722566604614, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21787133812904358, "acc": 0.9111731648445129, "length": 3.9999680519104004, "mode": "train", "epoch": 36}
{"loss": 0.23745976388454437, "acc": 0.9052082896232605, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.21266807615756989, "acc": 0.914252519607544, "length": 3.9999866485595703, "mode": "train", "epoch": 37}
{"loss": 0.2386491596698761, "acc": 0.9064236879348755, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.21058568358421326, "acc": 0.9151029586791992, "length": 3.999758005142212, "mode": "train", "epoch": 38}
{"loss": 0.24221989512443542, "acc": 0.9008679986000061, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20649896562099457, "acc": 0.9204092025756836, "length": 3.9999701976776123, "mode": "train", "epoch": 39}
{"loss": 0.22706466913223267, "acc": 0.9053819179534912, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19188430905342102, "acc": 0.9258236289024353, "length": 3.999927043914795, "mode": "train", "epoch": 40}
{"loss": 0.2233516424894333, "acc": 0.9154513478279114, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19015443325042725, "acc": 0.9236590266227722, "length": 3.9999635219573975, "mode": "train", "epoch": 41}
{"loss": 0.21067538857460022, "acc": 0.9189236164093018, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.18927589058876038, "acc": 0.9275927543640137, "length": 3.999973773956299, "mode": "train", "epoch": 42}
{"loss": 0.20520485937595367, "acc": 0.9227430820465088, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.18754760921001434, "acc": 0.9259961843490601, "length": 3.999937057495117, "mode": "train", "epoch": 43}
{"loss": 0.19908089935779572, "acc": 0.9232638478279114, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.17857418954372406, "acc": 0.9300952553749084, "length": 3.9998340606689453, "mode": "train", "epoch": 44}
{"loss": 0.20798523724079132, "acc": 0.9163194298744202, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.18536193668842316, "acc": 0.9298165440559387, "length": 3.999983787536621, "mode": "train", "epoch": 45}
{"loss": 0.19890284538269043, "acc": 0.9241319298744202, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1733710914850235, "acc": 0.9325510859489441, "length": 3.9999351501464844, "mode": "train", "epoch": 46}
{"loss": 0.19048677384853363, "acc": 0.9291666746139526, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1858530342578888, "acc": 0.9304416179656982, "length": 3.99989914894104, "mode": "train", "epoch": 47}
{"loss": 0.20003896951675415, "acc": 0.921875, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1634339839220047, "acc": 0.9395663738250732, "length": 3.9999914169311523, "mode": "train", "epoch": 48}
{"loss": 0.19042083621025085, "acc": 0.9289931058883667, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1706266701221466, "acc": 0.9368868470191956, "length": 3.9999940395355225, "mode": "train", "epoch": 49}
{"loss": 0.18496936559677124, "acc": 0.9307292103767395, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.15716902911663055, "acc": 0.9407029747962952, "length": 3.9999265670776367, "mode": "train", "epoch": 50}
{"loss": 0.18628500401973724, "acc": 0.9249999523162842, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.15771766006946564, "acc": 0.9395089149475098, "length": 3.9999890327453613, "mode": "train", "epoch": 51}
{"loss": 0.177239790558815, "acc": 0.9302083253860474, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.15917566418647766, "acc": 0.9386928081512451, "length": 3.998096466064453, "mode": "train", "epoch": 52}
{"loss": 0.18236173689365387, "acc": 0.9244791865348816, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.16019845008850098, "acc": 0.9375683665275574, "length": 3.9993176460266113, "mode": "train", "epoch": 53}
{"loss": 0.17647618055343628, "acc": 0.9298611879348755, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15502671897411346, "acc": 0.942738950252533, "length": 3.9994592666625977, "mode": "train", "epoch": 54}
{"loss": 0.1766331046819687, "acc": 0.9284719824790955, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.15005840361118317, "acc": 0.9447508454322815, "length": 3.999894857406616, "mode": "train", "epoch": 55}
{"loss": 0.17188799381256104, "acc": 0.9315972924232483, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.15099619328975677, "acc": 0.9399072527885437, "length": 3.999965190887451, "mode": "train", "epoch": 56}
{"loss": 0.18799155950546265, "acc": 0.9253472089767456, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.15815602242946625, "acc": 0.9366570711135864, "length": 3.9999678134918213, "mode": "train", "epoch": 57}
{"loss": 0.1846955120563507, "acc": 0.9296875, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.15302404761314392, "acc": 0.9385371208190918, "length": 3.9993138313293457, "mode": "train", "epoch": 58}
{"loss": 0.16425356268882751, "acc": 0.9352430701255798, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.14131520688533783, "acc": 0.9471351504325867, "length": 3.9997689723968506, "mode": "train", "epoch": 59}
{"loss": 0.16408687829971313, "acc": 0.9362847208976746, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14284442365169525, "acc": 0.9459980130195618, "length": 3.9997215270996094, "mode": "train", "epoch": 60}
{"loss": 0.18832463026046753, "acc": 0.9321179986000061, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7577778697013855
