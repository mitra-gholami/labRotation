ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6983031630516052, "acc": 0.5107086896896362, "length": 3.531764507293701, "mode": "train", "epoch": 1}
{"loss": 0.6894935965538025, "acc": 0.5192612409591675, "length": 1.37890625, "mode": "test", "epoch": 1}
{"loss": 0.6906402707099915, "acc": 0.5353180170059204, "length": 3.4935059547424316, "mode": "train", "epoch": 2}
{"loss": 0.6927564740180969, "acc": 0.5189452767372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6900184750556946, "acc": 0.5382641553878784, "length": 3.4614014625549316, "mode": "train", "epoch": 3}
{"loss": 0.687382698059082, "acc": 0.5410858392715454, "length": 1.28515625, "mode": "test", "epoch": 3}
{"loss": 0.688749372959137, "acc": 0.5394403338432312, "length": 3.397489547729492, "mode": "train", "epoch": 4}
{"loss": 0.6794072389602661, "acc": 0.5868560671806335, "length": 2.32421875, "mode": "test", "epoch": 4}
{"loss": 0.6862635016441345, "acc": 0.5598461031913757, "length": 3.3711841106414795, "mode": "train", "epoch": 5}
{"loss": 0.6662138104438782, "acc": 0.6221129894256592, "length": 3.51953125, "mode": "test", "epoch": 5}
{"loss": 0.6795778870582581, "acc": 0.5988019108772278, "length": 3.369541645050049, "mode": "train", "epoch": 6}
{"loss": 0.6526495218276978, "acc": 0.6688706278800964, "length": 3.94140625, "mode": "test", "epoch": 6}
{"loss": 0.66388338804245, "acc": 0.6443211436271667, "length": 3.494265079498291, "mode": "train", "epoch": 7}
{"loss": 0.6281540989875793, "acc": 0.7175781726837158, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.6345219016075134, "acc": 0.7014147639274597, "length": 3.685739755630493, "mode": "train", "epoch": 8}
{"loss": 0.594283401966095, "acc": 0.7261719107627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.590980589389801, "acc": 0.733829915523529, "length": 3.8322298526763916, "mode": "train", "epoch": 9}
{"loss": 0.5511646270751953, "acc": 0.7603515982627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5439608693122864, "acc": 0.7547414898872375, "length": 3.8936798572540283, "mode": "train", "epoch": 10}
{"loss": 0.5184829831123352, "acc": 0.7609376311302185, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5026925206184387, "acc": 0.7684566378593445, "length": 3.9352660179138184, "mode": "train", "epoch": 11}
{"loss": 0.49171382188796997, "acc": 0.7882813215255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4771260917186737, "acc": 0.7768915295600891, "length": 3.953961133956909, "mode": "train", "epoch": 12}
{"loss": 0.48141881823539734, "acc": 0.7833985686302185, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4654098153114319, "acc": 0.772220253944397, "length": 3.959780216217041, "mode": "train", "epoch": 13}
{"loss": 0.48235607147216797, "acc": 0.7841797471046448, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.459400475025177, "acc": 0.7683858871459961, "length": 3.9724812507629395, "mode": "train", "epoch": 14}
{"loss": 0.4794619083404541, "acc": 0.7884765863418579, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4539129137992859, "acc": 0.7696176767349243, "length": 3.9736995697021484, "mode": "train", "epoch": 15}
{"loss": 0.49173703789711, "acc": 0.7681640982627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.45142456889152527, "acc": 0.7769092917442322, "length": 3.9762189388275146, "mode": "train", "epoch": 16}
{"loss": 0.49473464488983154, "acc": 0.7703125476837158, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.445833683013916, "acc": 0.7874814867973328, "length": 3.984813690185547, "mode": "train", "epoch": 17}
{"loss": 0.5005385279655457, "acc": 0.7746095061302185, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.44048306345939636, "acc": 0.7883184552192688, "length": 3.981736660003662, "mode": "train", "epoch": 18}
{"loss": 0.4980304539203644, "acc": 0.7845702767372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.434498131275177, "acc": 0.7847734689712524, "length": 3.9873740673065186, "mode": "train", "epoch": 19}
{"loss": 0.5052587985992432, "acc": 0.7740234732627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.43102481961250305, "acc": 0.7878095507621765, "length": 3.987262010574341, "mode": "train", "epoch": 20}
{"loss": 0.4995802044868469, "acc": 0.7687500715255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.42460599541664124, "acc": 0.790937602519989, "length": 3.9885168075561523, "mode": "train", "epoch": 21}
{"loss": 0.48998087644577026, "acc": 0.7708984613418579, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.4221513569355011, "acc": 0.7924619317054749, "length": 3.992708683013916, "mode": "train", "epoch": 22}
{"loss": 0.48330289125442505, "acc": 0.7816405892372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.413923054933548, "acc": 0.8001714944839478, "length": 3.991088628768921, "mode": "train", "epoch": 23}
{"loss": 0.4606257379055023, "acc": 0.7904296517372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.4071868360042572, "acc": 0.7979260087013245, "length": 3.9921534061431885, "mode": "train", "epoch": 24}
{"loss": 0.42504942417144775, "acc": 0.7972655892372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.40201684832572937, "acc": 0.803489625453949, "length": 3.991424322128296, "mode": "train", "epoch": 25}
{"loss": 0.4202345609664917, "acc": 0.8037109375, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.4000032842159271, "acc": 0.8044919967651367, "length": 3.994894027709961, "mode": "train", "epoch": 26}
{"loss": 0.41492611169815063, "acc": 0.8148437142372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.389695405960083, "acc": 0.8137998580932617, "length": 3.9940850734710693, "mode": "train", "epoch": 27}
{"loss": 0.4059274196624756, "acc": 0.8062500357627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.38242676854133606, "acc": 0.8176562786102295, "length": 3.997217893600464, "mode": "train", "epoch": 28}
{"loss": 0.39573943614959717, "acc": 0.8181639909744263, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3726787865161896, "acc": 0.8197571039199829, "length": 3.9972095489501953, "mode": "train", "epoch": 29}
{"loss": 0.39226409792900085, "acc": 0.8169922232627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.36787429451942444, "acc": 0.8231218457221985, "length": 3.9977684020996094, "mode": "train", "epoch": 30}
{"loss": 0.3739486634731293, "acc": 0.8283203840255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.35713762044906616, "acc": 0.8282342553138733, "length": 3.9986824989318848, "mode": "train", "epoch": 31}
{"loss": 0.36956560611724854, "acc": 0.8341798186302185, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3468940258026123, "acc": 0.834445059299469, "length": 3.9979970455169678, "mode": "train", "epoch": 32}
{"loss": 0.3684109151363373, "acc": 0.8306640982627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3395046293735504, "acc": 0.8374419808387756, "length": 3.9978673458099365, "mode": "train", "epoch": 33}
{"loss": 0.35505807399749756, "acc": 0.8455077409744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.33538955450057983, "acc": 0.8404195308685303, "length": 3.9992361068725586, "mode": "train", "epoch": 34}
{"loss": 0.3494465947151184, "acc": 0.8484374284744263, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3258435130119324, "acc": 0.8456342220306396, "length": 3.99906325340271, "mode": "train", "epoch": 35}
{"loss": 0.3422981798648834, "acc": 0.8558593988418579, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.3207848370075226, "acc": 0.8523127436637878, "length": 3.9994137287139893, "mode": "train", "epoch": 36}
{"loss": 0.3360809087753296, "acc": 0.8570312857627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.3179612159729004, "acc": 0.8546357750892639, "length": 3.9996657371520996, "mode": "train", "epoch": 37}
{"loss": 0.33088088035583496, "acc": 0.8554686903953552, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.3119456470012665, "acc": 0.8556762337684631, "length": 3.9995598793029785, "mode": "train", "epoch": 38}
{"loss": 0.32424259185791016, "acc": 0.8580077886581421, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.31223222613334656, "acc": 0.8596232533454895, "length": 3.9997758865356445, "mode": "train", "epoch": 39}
{"loss": 0.32990992069244385, "acc": 0.8599610328674316, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.30892035365104675, "acc": 0.8618767261505127, "length": 3.9991300106048584, "mode": "train", "epoch": 40}
{"loss": 0.32285046577453613, "acc": 0.8572264909744263, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.3055889904499054, "acc": 0.8589892387390137, "length": 3.9995834827423096, "mode": "train", "epoch": 41}
{"loss": 0.3208279311656952, "acc": 0.8566407561302185, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.30278152227401733, "acc": 0.861191987991333, "length": 3.9995903968811035, "mode": "train", "epoch": 42}
{"loss": 0.3159372806549072, "acc": 0.8595703840255737, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2963913083076477, "acc": 0.8695452213287354, "length": 3.999837636947632, "mode": "train", "epoch": 43}
{"loss": 0.3108880817890167, "acc": 0.8671875, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.29626184701919556, "acc": 0.8672073483467102, "length": 3.999063014984131, "mode": "train", "epoch": 44}
{"loss": 0.3052690625190735, "acc": 0.8703125715255737, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2933124899864197, "acc": 0.8668580651283264, "length": 3.9965553283691406, "mode": "train", "epoch": 45}
{"loss": 0.30681174993515015, "acc": 0.8630858659744263, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2865830361843109, "acc": 0.8730180859565735, "length": 3.9996159076690674, "mode": "train", "epoch": 46}
{"loss": 0.29915738105773926, "acc": 0.8689452409744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2863287925720215, "acc": 0.8724228143692017, "length": 3.9986703395843506, "mode": "train", "epoch": 47}
{"loss": 0.2975809574127197, "acc": 0.8714843392372131, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.28764989972114563, "acc": 0.871929407119751, "length": 3.996797800064087, "mode": "train", "epoch": 48}
{"loss": 0.29258447885513306, "acc": 0.8738280534744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2789730131626129, "acc": 0.8745342493057251, "length": 3.999908208847046, "mode": "train", "epoch": 49}
{"loss": 0.2970082759857178, "acc": 0.8744140267372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.278865247964859, "acc": 0.8696630597114563, "length": 3.9999213218688965, "mode": "train", "epoch": 50}
{"loss": 0.29446327686309814, "acc": 0.8730469346046448, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.272359699010849, "acc": 0.8790525197982788, "length": 3.999683141708374, "mode": "train", "epoch": 51}
{"loss": 0.2893517017364502, "acc": 0.8830078840255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2741803824901581, "acc": 0.8775412440299988, "length": 3.9975531101226807, "mode": "train", "epoch": 52}
{"loss": 0.2896620035171509, "acc": 0.8796874284744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2643050253391266, "acc": 0.8881074786186218, "length": 3.999929189682007, "mode": "train", "epoch": 53}
{"loss": 0.28899097442626953, "acc": 0.880859375, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2673150897026062, "acc": 0.8807871341705322, "length": 3.9992544651031494, "mode": "train", "epoch": 54}
{"loss": 0.2826383113861084, "acc": 0.8763671517372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2618666887283325, "acc": 0.8867099285125732, "length": 3.999812126159668, "mode": "train", "epoch": 55}
{"loss": 0.28365880250930786, "acc": 0.8824219107627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2574032247066498, "acc": 0.8925151824951172, "length": 3.9998631477355957, "mode": "train", "epoch": 56}
{"loss": 0.2820979356765747, "acc": 0.8861327171325684, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2573260962963104, "acc": 0.8957048654556274, "length": 3.999924898147583, "mode": "train", "epoch": 57}
{"loss": 0.2859756648540497, "acc": 0.8849610090255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.25262102484703064, "acc": 0.8973889946937561, "length": 3.999976396560669, "mode": "train", "epoch": 58}
{"loss": 0.27366310358047485, "acc": 0.8861327767372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.24262605607509613, "acc": 0.8944311738014221, "length": 3.9999935626983643, "mode": "train", "epoch": 59}
{"loss": 0.2807597219944, "acc": 0.88671875, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.2429589182138443, "acc": 0.897376298904419, "length": 3.9997620582580566, "mode": "train", "epoch": 60}
{"loss": 0.26781678199768066, "acc": 0.8919921517372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8074137568473816
