ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6971835494041443, "acc": 0.508485734462738, "length": 3.5005404949188232, "mode": "train", "epoch": 1}
{"loss": 0.6926264762878418, "acc": 0.5423827767372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6932310461997986, "acc": 0.5274204015731812, "length": 3.2758452892303467, "mode": "train", "epoch": 2}
{"loss": 0.6925017833709717, "acc": 0.49648433923721313, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.686077892780304, "acc": 0.5506146550178528, "length": 2.8231961727142334, "mode": "train", "epoch": 3}
{"loss": 0.6860520839691162, "acc": 0.5471847653388977, "length": 1.4921875, "mode": "test", "epoch": 3}
{"loss": 0.6675488352775574, "acc": 0.6204596161842346, "length": 2.827775001525879, "mode": "train", "epoch": 4}
{"loss": 0.6316368579864502, "acc": 0.6925476789474487, "length": 3.578125, "mode": "test", "epoch": 4}
{"loss": 0.6243433356285095, "acc": 0.6987967491149902, "length": 3.298745632171631, "mode": "train", "epoch": 5}
{"loss": 0.5897834897041321, "acc": 0.705426037311554, "length": 3.70703125, "mode": "test", "epoch": 5}
{"loss": 0.5686513781547546, "acc": 0.7090335488319397, "length": 3.598911762237549, "mode": "train", "epoch": 6}
{"loss": 0.5594161152839661, "acc": 0.7284256219863892, "length": 3.91796875, "mode": "test", "epoch": 6}
{"loss": 0.5362954139709473, "acc": 0.7206727862358093, "length": 3.65204119682312, "mode": "train", "epoch": 7}
{"loss": 0.5286044478416443, "acc": 0.7433593273162842, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.49208733439445496, "acc": 0.7541630864143372, "length": 3.7815370559692383, "mode": "train", "epoch": 8}
{"loss": 0.48737049102783203, "acc": 0.7808594107627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4533720314502716, "acc": 0.8008570671081543, "length": 3.91648268699646, "mode": "train", "epoch": 9}
{"loss": 0.4801022410392761, "acc": 0.7816405892372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.43505367636680603, "acc": 0.8055392503738403, "length": 3.958214282989502, "mode": "train", "epoch": 10}
{"loss": 0.45276790857315063, "acc": 0.802734375, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4189141094684601, "acc": 0.8240803480148315, "length": 3.9742140769958496, "mode": "train", "epoch": 11}
{"loss": 0.4509950876235962, "acc": 0.8248047232627869, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4101693034172058, "acc": 0.8294904828071594, "length": 3.9812185764312744, "mode": "train", "epoch": 12}
{"loss": 0.4333651661872864, "acc": 0.8193359971046448, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3981512486934662, "acc": 0.8360816240310669, "length": 3.9854516983032227, "mode": "train", "epoch": 13}
{"loss": 0.4142850339412689, "acc": 0.8347657918930054, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3864898383617401, "acc": 0.8339583873748779, "length": 3.990952491760254, "mode": "train", "epoch": 14}
{"loss": 0.41413554549217224, "acc": 0.8318358659744263, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3700161576271057, "acc": 0.8411009907722473, "length": 3.989879608154297, "mode": "train", "epoch": 15}
{"loss": 0.39172035455703735, "acc": 0.8410156965255737, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.36187344789505005, "acc": 0.8473030924797058, "length": 3.9859402179718018, "mode": "train", "epoch": 16}
{"loss": 0.3853011727333069, "acc": 0.8419922590255737, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3530091345310211, "acc": 0.8508714437484741, "length": 3.991335391998291, "mode": "train", "epoch": 17}
{"loss": 0.3870164155960083, "acc": 0.8453125357627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3465293049812317, "acc": 0.8508780002593994, "length": 3.9939913749694824, "mode": "train", "epoch": 18}
{"loss": 0.3693529963493347, "acc": 0.8396483659744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3354218304157257, "acc": 0.8556509017944336, "length": 3.989166259765625, "mode": "train", "epoch": 19}
{"loss": 0.3614177107810974, "acc": 0.8552733659744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.32745417952537537, "acc": 0.8672723174095154, "length": 3.991581678390503, "mode": "train", "epoch": 20}
{"loss": 0.3430529832839966, "acc": 0.859375, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.32386988401412964, "acc": 0.8645098805427551, "length": 3.995152711868286, "mode": "train", "epoch": 21}
{"loss": 0.356234610080719, "acc": 0.8548827767372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.31235894560813904, "acc": 0.8693706393241882, "length": 3.996999979019165, "mode": "train", "epoch": 22}
{"loss": 0.32880234718322754, "acc": 0.8650389909744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.30607953667640686, "acc": 0.874348521232605, "length": 3.997054100036621, "mode": "train", "epoch": 23}
{"loss": 0.350519061088562, "acc": 0.8572264909744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3044002950191498, "acc": 0.8705668449401855, "length": 3.997169256210327, "mode": "train", "epoch": 24}
{"loss": 0.32554253935813904, "acc": 0.8648437857627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.29951170086860657, "acc": 0.8714337348937988, "length": 3.9967637062072754, "mode": "train", "epoch": 25}
{"loss": 0.31728601455688477, "acc": 0.8679686784744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2908734679222107, "acc": 0.8741171360015869, "length": 3.9980740547180176, "mode": "train", "epoch": 26}
{"loss": 0.3170647621154785, "acc": 0.8783202171325684, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.29227414727211, "acc": 0.876128613948822, "length": 3.9980814456939697, "mode": "train", "epoch": 27}
{"loss": 0.30442100763320923, "acc": 0.8771485686302185, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2860870957374573, "acc": 0.884291410446167, "length": 3.996084451675415, "mode": "train", "epoch": 28}
{"loss": 0.30996575951576233, "acc": 0.8794922828674316, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.27914756536483765, "acc": 0.8893001079559326, "length": 3.9968762397766113, "mode": "train", "epoch": 29}
{"loss": 0.2954728603363037, "acc": 0.8783202767372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.27207520604133606, "acc": 0.8905757069587708, "length": 3.9982149600982666, "mode": "train", "epoch": 30}
{"loss": 0.3034609854221344, "acc": 0.8792968392372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.26616519689559937, "acc": 0.8930336236953735, "length": 3.996922492980957, "mode": "train", "epoch": 31}
{"loss": 0.2853292226791382, "acc": 0.8859375715255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.25572991371154785, "acc": 0.8958486318588257, "length": 3.9948031902313232, "mode": "train", "epoch": 32}
{"loss": 0.292601078748703, "acc": 0.8839844465255737, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2548380196094513, "acc": 0.8990481495857239, "length": 3.9972028732299805, "mode": "train", "epoch": 33}
{"loss": 0.2781466841697693, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2441774606704712, "acc": 0.9061428904533386, "length": 3.9978532791137695, "mode": "train", "epoch": 34}
{"loss": 0.2771267294883728, "acc": 0.8896484375, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.23677928745746613, "acc": 0.904283344745636, "length": 3.999068021774292, "mode": "train", "epoch": 35}
{"loss": 0.2633990943431854, "acc": 0.9029297232627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.22883160412311554, "acc": 0.9092766642570496, "length": 3.997896909713745, "mode": "train", "epoch": 36}
{"loss": 0.2514525055885315, "acc": 0.9060545563697815, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.22694699466228485, "acc": 0.9128189086914062, "length": 3.9951083660125732, "mode": "train", "epoch": 37}
{"loss": 0.23913532495498657, "acc": 0.9119139909744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.21790435910224915, "acc": 0.9136053919792175, "length": 3.9984629154205322, "mode": "train", "epoch": 38}
{"loss": 0.22838462889194489, "acc": 0.9167967438697815, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2172255516052246, "acc": 0.9141378998756409, "length": 3.9985227584838867, "mode": "train", "epoch": 39}
{"loss": 0.23452919721603394, "acc": 0.91796875, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.20658867061138153, "acc": 0.9169821739196777, "length": 3.9965152740478516, "mode": "train", "epoch": 40}
{"loss": 0.2172071933746338, "acc": 0.9158201813697815, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19615130126476288, "acc": 0.9207393527030945, "length": 3.998898983001709, "mode": "train", "epoch": 41}
{"loss": 0.21440677344799042, "acc": 0.9244140982627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.19344966113567352, "acc": 0.9256436228752136, "length": 3.9975759983062744, "mode": "train", "epoch": 42}
{"loss": 0.19351458549499512, "acc": 0.9345703721046448, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.18439467251300812, "acc": 0.9285010695457458, "length": 3.9995272159576416, "mode": "train", "epoch": 43}
{"loss": 0.20569121837615967, "acc": 0.9292968511581421, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1852530986070633, "acc": 0.9255679249763489, "length": 3.9977266788482666, "mode": "train", "epoch": 44}
{"loss": 0.19875723123550415, "acc": 0.931640625, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.18019230663776398, "acc": 0.9294482469558716, "length": 3.9997291564941406, "mode": "train", "epoch": 45}
{"loss": 0.19375324249267578, "acc": 0.9359374046325684, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18145327270030975, "acc": 0.932274341583252, "length": 3.999581813812256, "mode": "train", "epoch": 46}
{"loss": 0.18462055921554565, "acc": 0.9408202767372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.17715279757976532, "acc": 0.9342871904373169, "length": 3.9997217655181885, "mode": "train", "epoch": 47}
{"loss": 0.20134210586547852, "acc": 0.9308594465255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.16691617667675018, "acc": 0.9377186298370361, "length": 3.999912738800049, "mode": "train", "epoch": 48}
{"loss": 0.18584886193275452, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.16200806200504303, "acc": 0.9381300210952759, "length": 3.9998576641082764, "mode": "train", "epoch": 49}
{"loss": 0.1796841025352478, "acc": 0.9337891340255737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.16036738455295563, "acc": 0.9402856826782227, "length": 3.99888277053833, "mode": "train", "epoch": 50}
{"loss": 0.166889488697052, "acc": 0.9431639909744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.16055001318454742, "acc": 0.9362431764602661, "length": 3.9999301433563232, "mode": "train", "epoch": 51}
{"loss": 0.18173135817050934, "acc": 0.9398437142372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.15101365745067596, "acc": 0.9473415613174438, "length": 3.999938488006592, "mode": "train", "epoch": 52}
{"loss": 0.17465731501579285, "acc": 0.9400390982627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.14954879879951477, "acc": 0.9433633089065552, "length": 3.999347448348999, "mode": "train", "epoch": 53}
{"loss": 0.16429272294044495, "acc": 0.9447264671325684, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.14425413310527802, "acc": 0.94627845287323, "length": 3.9999196529388428, "mode": "train", "epoch": 54}
{"loss": 0.17240914702415466, "acc": 0.9378905892372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1376718133687973, "acc": 0.9493491649627686, "length": 3.9999516010284424, "mode": "train", "epoch": 55}
{"loss": 0.15441980957984924, "acc": 0.9484375715255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1385757476091385, "acc": 0.9466516971588135, "length": 3.998856544494629, "mode": "train", "epoch": 56}
{"loss": 0.17123956978321075, "acc": 0.9505859613418579, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.13662824034690857, "acc": 0.948398768901825, "length": 3.999610662460327, "mode": "train", "epoch": 57}
{"loss": 0.15303583443164825, "acc": 0.9476562142372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.141026571393013, "acc": 0.9487555027008057, "length": 3.9999148845672607, "mode": "train", "epoch": 58}
{"loss": 0.17456570267677307, "acc": 0.9492186903953552, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.13728119432926178, "acc": 0.9492318034172058, "length": 3.9999706745147705, "mode": "train", "epoch": 59}
{"loss": 0.16649846732616425, "acc": 0.9451171159744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14082233607769012, "acc": 0.9509350657463074, "length": 3.9996540546417236, "mode": "train", "epoch": 60}
{"loss": 0.16177457571029663, "acc": 0.9488281607627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7901612520217896
