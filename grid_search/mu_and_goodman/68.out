ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6959618330001831, "acc": 0.5085504651069641, "length": 3.5208652019500732, "mode": "train", "epoch": 1}
{"loss": 0.6922740936279297, "acc": 0.513671875, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6930638551712036, "acc": 0.5244359970092773, "length": 3.4124655723571777, "mode": "train", "epoch": 2}
{"loss": 0.692190408706665, "acc": 0.523242175579071, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6891406774520874, "acc": 0.5445431470870972, "length": 3.213548183441162, "mode": "train", "epoch": 3}
{"loss": 0.6820937395095825, "acc": 0.559539794921875, "length": 1.515625, "mode": "test", "epoch": 3}
{"loss": 0.6768726706504822, "acc": 0.6043431758880615, "length": 3.158987522125244, "mode": "train", "epoch": 4}
{"loss": 0.6361618041992188, "acc": 0.7236526608467102, "length": 3.3203125, "mode": "test", "epoch": 4}
{"loss": 0.6449489593505859, "acc": 0.7130243182182312, "length": 3.4310407638549805, "mode": "train", "epoch": 5}
{"loss": 0.5849485397338867, "acc": 0.7444244623184204, "length": 3.8359375, "mode": "test", "epoch": 5}
{"loss": 0.580406665802002, "acc": 0.7260869741439819, "length": 3.655092716217041, "mode": "train", "epoch": 6}
{"loss": 0.5395365953445435, "acc": 0.7556900382041931, "length": 3.94140625, "mode": "test", "epoch": 6}
{"loss": 0.5185059905052185, "acc": 0.7456429600715637, "length": 3.79524827003479, "mode": "train", "epoch": 7}
{"loss": 0.5211702585220337, "acc": 0.7541991472244263, "length": 3.94921875, "mode": "test", "epoch": 7}
{"loss": 0.4845287501811981, "acc": 0.7736383080482483, "length": 3.845113515853882, "mode": "train", "epoch": 8}
{"loss": 0.5246332883834839, "acc": 0.7770842909812927, "length": 3.98828125, "mode": "test", "epoch": 8}
{"loss": 0.4591826796531677, "acc": 0.8004297614097595, "length": 3.851027727127075, "mode": "train", "epoch": 9}
{"loss": 0.47617828845977783, "acc": 0.8068328499794006, "length": 3.89453125, "mode": "test", "epoch": 9}
{"loss": 0.4313346743583679, "acc": 0.8195274472236633, "length": 3.7899606227874756, "mode": "train", "epoch": 10}
{"loss": 0.4446917772293091, "acc": 0.8158660531044006, "length": 3.85546875, "mode": "test", "epoch": 10}
{"loss": 0.4021573066711426, "acc": 0.8337264060974121, "length": 3.739647150039673, "mode": "train", "epoch": 11}
{"loss": 0.4149928689002991, "acc": 0.8242720365524292, "length": 3.88671875, "mode": "test", "epoch": 11}
{"loss": 0.37935808300971985, "acc": 0.8440691232681274, "length": 3.779910087585449, "mode": "train", "epoch": 12}
{"loss": 0.39466238021850586, "acc": 0.8275467157363892, "length": 3.921875, "mode": "test", "epoch": 12}
{"loss": 0.36177751421928406, "acc": 0.8480528593063354, "length": 3.8357317447662354, "mode": "train", "epoch": 13}
{"loss": 0.3970852494239807, "acc": 0.8262527585029602, "length": 3.9765625, "mode": "test", "epoch": 13}
{"loss": 0.34463241696357727, "acc": 0.8545340299606323, "length": 3.8937196731567383, "mode": "train", "epoch": 14}
{"loss": 0.3895941376686096, "acc": 0.8354888558387756, "length": 3.9921875, "mode": "test", "epoch": 14}
{"loss": 0.3267834484577179, "acc": 0.8645650744438171, "length": 3.901040554046631, "mode": "train", "epoch": 15}
{"loss": 0.3761788606643677, "acc": 0.8472656607627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3126063048839569, "acc": 0.8685654997825623, "length": 3.9460608959198, "mode": "train", "epoch": 16}
{"loss": 0.3554203510284424, "acc": 0.8455077409744263, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.29869726300239563, "acc": 0.8787518739700317, "length": 3.9661784172058105, "mode": "train", "epoch": 17}
{"loss": 0.3593849539756775, "acc": 0.8433594107627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2915530800819397, "acc": 0.879604160785675, "length": 3.9731762409210205, "mode": "train", "epoch": 18}
{"loss": 0.352802574634552, "acc": 0.8603515028953552, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2797282636165619, "acc": 0.8856900334358215, "length": 3.9852473735809326, "mode": "train", "epoch": 19}
{"loss": 0.3474898636341095, "acc": 0.8404297232627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2684721052646637, "acc": 0.8869437575340271, "length": 3.990037202835083, "mode": "train", "epoch": 20}
{"loss": 0.3188696503639221, "acc": 0.8662109375, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.26223132014274597, "acc": 0.8889486193656921, "length": 3.991213083267212, "mode": "train", "epoch": 21}
{"loss": 0.32159751653671265, "acc": 0.8568359017372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.25642240047454834, "acc": 0.894582211971283, "length": 3.99173641204834, "mode": "train", "epoch": 22}
{"loss": 0.3061794638633728, "acc": 0.8701172471046448, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.24284307658672333, "acc": 0.9019685387611389, "length": 3.991894006729126, "mode": "train", "epoch": 23}
{"loss": 0.321895569562912, "acc": 0.8619140386581421, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.24151673913002014, "acc": 0.899728536605835, "length": 3.9906044006347656, "mode": "train", "epoch": 24}
{"loss": 0.30358830094337463, "acc": 0.8669920563697815, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.23505957424640656, "acc": 0.9060319066047668, "length": 3.992119789123535, "mode": "train", "epoch": 25}
{"loss": 0.29136940836906433, "acc": 0.8705077767372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.22535589337348938, "acc": 0.9095752239227295, "length": 3.995043992996216, "mode": "train", "epoch": 26}
{"loss": 0.2738046646118164, "acc": 0.8841796517372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2195628136396408, "acc": 0.9109646081924438, "length": 3.995149850845337, "mode": "train", "epoch": 27}
{"loss": 0.269871324300766, "acc": 0.8888672590255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.21742479503154755, "acc": 0.9123947620391846, "length": 3.996900796890259, "mode": "train", "epoch": 28}
{"loss": 0.264729768037796, "acc": 0.8884764909744263, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.21087677776813507, "acc": 0.9159722924232483, "length": 3.9978673458099365, "mode": "train", "epoch": 29}
{"loss": 0.25774839520454407, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.20462600886821747, "acc": 0.9204995632171631, "length": 3.994821310043335, "mode": "train", "epoch": 30}
{"loss": 0.23559492826461792, "acc": 0.9013671875, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1991339921951294, "acc": 0.9233340620994568, "length": 3.9980499744415283, "mode": "train", "epoch": 31}
{"loss": 0.22117385268211365, "acc": 0.9070311784744263, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.20176181197166443, "acc": 0.9202295541763306, "length": 3.99813175201416, "mode": "train", "epoch": 32}
{"loss": 0.23463322222232819, "acc": 0.9009766578674316, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.19537542760372162, "acc": 0.924697995185852, "length": 3.998753309249878, "mode": "train", "epoch": 33}
{"loss": 0.22470620274543762, "acc": 0.9171875715255737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.19026131927967072, "acc": 0.9267363548278809, "length": 3.9983153343200684, "mode": "train", "epoch": 34}
{"loss": 0.21563172340393066, "acc": 0.9076171517372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.191126748919487, "acc": 0.9256017804145813, "length": 3.9990530014038086, "mode": "train", "epoch": 35}
{"loss": 0.21945977210998535, "acc": 0.9056640267372131, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.18551373481750488, "acc": 0.9316524863243103, "length": 3.9991941452026367, "mode": "train", "epoch": 36}
{"loss": 0.21799544990062714, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.18197867274284363, "acc": 0.9285556674003601, "length": 3.9994492530822754, "mode": "train", "epoch": 37}
{"loss": 0.21600341796875, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.18003471195697784, "acc": 0.9312671422958374, "length": 3.999431848526001, "mode": "train", "epoch": 38}
{"loss": 0.20418356359004974, "acc": 0.9234375357627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1771375685930252, "acc": 0.9343229532241821, "length": 3.9995758533477783, "mode": "train", "epoch": 39}
{"loss": 0.20865267515182495, "acc": 0.9214844107627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1708473265171051, "acc": 0.9354817867279053, "length": 3.99830961227417, "mode": "train", "epoch": 40}
{"loss": 0.20325592160224915, "acc": 0.923828125, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.17078976333141327, "acc": 0.9332534074783325, "length": 3.999645948410034, "mode": "train", "epoch": 41}
{"loss": 0.2046942412853241, "acc": 0.9248047471046448, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.16838225722312927, "acc": 0.9369202256202698, "length": 3.998522996902466, "mode": "train", "epoch": 42}
{"loss": 0.19537000358104706, "acc": 0.9251952767372131, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1661161631345749, "acc": 0.9373176693916321, "length": 3.9995336532592773, "mode": "train", "epoch": 43}
{"loss": 0.20074701309204102, "acc": 0.9222655892372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.16630414128303528, "acc": 0.9375544190406799, "length": 3.999831438064575, "mode": "train", "epoch": 44}
{"loss": 0.18790432810783386, "acc": 0.9304686784744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.16773387789726257, "acc": 0.9386308193206787, "length": 3.999953269958496, "mode": "train", "epoch": 45}
{"loss": 0.1964644342660904, "acc": 0.9144530892372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.15965354442596436, "acc": 0.9396374225616455, "length": 3.9993507862091064, "mode": "train", "epoch": 46}
{"loss": 0.2007206678390503, "acc": 0.9250000715255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.16335630416870117, "acc": 0.9416472911834717, "length": 3.998425245285034, "mode": "train", "epoch": 47}
{"loss": 0.18528500199317932, "acc": 0.9312500357627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.16104863584041595, "acc": 0.941555380821228, "length": 3.9987990856170654, "mode": "train", "epoch": 48}
{"loss": 0.1970672607421875, "acc": 0.9281249642372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1603911966085434, "acc": 0.9418445229530334, "length": 3.999558210372925, "mode": "train", "epoch": 49}
{"loss": 0.21014133095741272, "acc": 0.9218749403953552, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.154048889875412, "acc": 0.942872941493988, "length": 3.99997615814209, "mode": "train", "epoch": 50}
{"loss": 0.18543845415115356, "acc": 0.9337891340255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.1537993997335434, "acc": 0.9430394768714905, "length": 3.9998040199279785, "mode": "train", "epoch": 51}
{"loss": 0.2079010307788849, "acc": 0.9208984971046448, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.15197491645812988, "acc": 0.9408929944038391, "length": 3.999967336654663, "mode": "train", "epoch": 52}
{"loss": 0.20550790429115295, "acc": 0.9253907203674316, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.14942146837711334, "acc": 0.9453591108322144, "length": 3.999824047088623, "mode": "train", "epoch": 53}
{"loss": 0.17142730951309204, "acc": 0.9384765028953552, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.14879833161830902, "acc": 0.9428697824478149, "length": 3.999753952026367, "mode": "train", "epoch": 54}
{"loss": 0.1733655035495758, "acc": 0.9339843392372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1505013406276703, "acc": 0.9423348903656006, "length": 3.9975626468658447, "mode": "train", "epoch": 55}
{"loss": 0.18909844756126404, "acc": 0.9392576813697815, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.14567872881889343, "acc": 0.9479448795318604, "length": 3.9979734420776367, "mode": "train", "epoch": 56}
{"loss": 0.170673206448555, "acc": 0.9361327886581421, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.13913050293922424, "acc": 0.9472808241844177, "length": 3.9998607635498047, "mode": "train", "epoch": 57}
{"loss": 0.1889781355857849, "acc": 0.9371094703674316, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1380852311849594, "acc": 0.9524217247962952, "length": 3.998887538909912, "mode": "train", "epoch": 58}
{"loss": 0.1744735836982727, "acc": 0.9404296875, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1377144455909729, "acc": 0.9501098394393921, "length": 3.9998772144317627, "mode": "train", "epoch": 59}
{"loss": 0.1614913046360016, "acc": 0.9453125, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1312316656112671, "acc": 0.9532235264778137, "length": 3.999972343444824, "mode": "train", "epoch": 60}
{"loss": 0.16638106107711792, "acc": 0.9425781965255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8282693028450012
