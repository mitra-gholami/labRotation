ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6975756883621216, "acc": 0.5105247497558594, "length": 3.4578702449798584, "mode": "train", "epoch": 1}
{"loss": 0.6914005279541016, "acc": 0.5201508402824402, "length": 1.00390625, "mode": "test", "epoch": 1}
{"loss": 0.6851438283920288, "acc": 0.563804566860199, "length": 2.710477352142334, "mode": "train", "epoch": 2}
{"loss": 0.6571775078773499, "acc": 0.6667694449424744, "length": 2.16015625, "mode": "test", "epoch": 2}
{"loss": 0.6281778216362, "acc": 0.6904296278953552, "length": 2.719038963317871, "mode": "train", "epoch": 3}
{"loss": 0.5715348720550537, "acc": 0.7287628054618835, "length": 2.94921875, "mode": "test", "epoch": 3}
{"loss": 0.520321786403656, "acc": 0.763725757598877, "length": 3.1192498207092285, "mode": "train", "epoch": 4}
{"loss": 0.4938008785247803, "acc": 0.7845947742462158, "length": 3.37109375, "mode": "test", "epoch": 4}
{"loss": 0.4608023166656494, "acc": 0.8001818656921387, "length": 3.3534581661224365, "mode": "train", "epoch": 5}
{"loss": 0.469839483499527, "acc": 0.7990601062774658, "length": 3.4375, "mode": "test", "epoch": 5}
{"loss": 0.4355868399143219, "acc": 0.806203305721283, "length": 3.3782224655151367, "mode": "train", "epoch": 6}
{"loss": 0.4501420855522156, "acc": 0.7886841297149658, "length": 3.453125, "mode": "test", "epoch": 6}
{"loss": 0.41743114590644836, "acc": 0.8107469081878662, "length": 3.4319941997528076, "mode": "train", "epoch": 7}
{"loss": 0.4403523802757263, "acc": 0.8010101318359375, "length": 3.4765625, "mode": "test", "epoch": 7}
{"loss": 0.39700862765312195, "acc": 0.8264923691749573, "length": 3.447770833969116, "mode": "train", "epoch": 8}
{"loss": 0.4391692280769348, "acc": 0.8121643662452698, "length": 3.55078125, "mode": "test", "epoch": 8}
{"loss": 0.377999484539032, "acc": 0.8420741558074951, "length": 3.666912078857422, "mode": "train", "epoch": 9}
{"loss": 0.4217436909675598, "acc": 0.8271453976631165, "length": 3.87890625, "mode": "test", "epoch": 9}
{"loss": 0.35224097967147827, "acc": 0.855229914188385, "length": 3.861171007156372, "mode": "train", "epoch": 10}
{"loss": 0.39424777030944824, "acc": 0.8363922834396362, "length": 3.97265625, "mode": "test", "epoch": 10}
{"loss": 0.33643850684165955, "acc": 0.8618450164794922, "length": 3.9519340991973877, "mode": "train", "epoch": 11}
{"loss": 0.38295936584472656, "acc": 0.8447265625, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.31497374176979065, "acc": 0.8691762685775757, "length": 3.964817523956299, "mode": "train", "epoch": 12}
{"loss": 0.3579363226890564, "acc": 0.8556641936302185, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.30277034640312195, "acc": 0.8762266635894775, "length": 3.973698616027832, "mode": "train", "epoch": 13}
{"loss": 0.35296252369880676, "acc": 0.8574219346046448, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.28728342056274414, "acc": 0.8870192170143127, "length": 3.98195743560791, "mode": "train", "epoch": 14}
{"loss": 0.34940940141677856, "acc": 0.8628907203674316, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.27994343638420105, "acc": 0.8897771835327148, "length": 3.988574504852295, "mode": "train", "epoch": 15}
{"loss": 0.33982864022254944, "acc": 0.8644531965255737, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2659189999103546, "acc": 0.8980239033699036, "length": 3.9894442558288574, "mode": "train", "epoch": 16}
{"loss": 0.3443688750267029, "acc": 0.8753905296325684, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2535436153411865, "acc": 0.9035203456878662, "length": 3.989781379699707, "mode": "train", "epoch": 17}
{"loss": 0.2722950279712677, "acc": 0.8972655534744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.22991131246089935, "acc": 0.9155831336975098, "length": 3.9941294193267822, "mode": "train", "epoch": 18}
{"loss": 0.2639640271663666, "acc": 0.8974609375, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2198573797941208, "acc": 0.9182378053665161, "length": 3.990415096282959, "mode": "train", "epoch": 19}
{"loss": 0.24478623270988464, "acc": 0.9074219465255737, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21241576969623566, "acc": 0.9202065467834473, "length": 3.9979076385498047, "mode": "train", "epoch": 20}
{"loss": 0.2453402727842331, "acc": 0.9013671278953552, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.19552576541900635, "acc": 0.926348090171814, "length": 3.9969542026519775, "mode": "train", "epoch": 21}
{"loss": 0.21605375409126282, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.19043013453483582, "acc": 0.9295842051506042, "length": 3.997159957885742, "mode": "train", "epoch": 22}
{"loss": 0.21741917729377747, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.18569634854793549, "acc": 0.9286244511604309, "length": 3.9963302612304688, "mode": "train", "epoch": 23}
{"loss": 0.20227134227752686, "acc": 0.9230469465255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1821601241827011, "acc": 0.9320351481437683, "length": 3.9960522651672363, "mode": "train", "epoch": 24}
{"loss": 0.19943445920944214, "acc": 0.9255861043930054, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.18030019104480743, "acc": 0.9285926222801208, "length": 3.9966471195220947, "mode": "train", "epoch": 25}
{"loss": 0.22054770588874817, "acc": 0.9050779938697815, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.17732003331184387, "acc": 0.9342885613441467, "length": 3.997615337371826, "mode": "train", "epoch": 26}
{"loss": 0.1998041868209839, "acc": 0.9222655892372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.17166118323802948, "acc": 0.9313835501670837, "length": 3.9983763694763184, "mode": "train", "epoch": 27}
{"loss": 0.19343075156211853, "acc": 0.9277343153953552, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.17351242899894714, "acc": 0.9329419136047363, "length": 3.995993137359619, "mode": "train", "epoch": 28}
{"loss": 0.1878625750541687, "acc": 0.9289063215255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.16096004843711853, "acc": 0.940891683101654, "length": 3.9976119995117188, "mode": "train", "epoch": 29}
{"loss": 0.17935389280319214, "acc": 0.9292969107627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1600513905286789, "acc": 0.9381235837936401, "length": 3.998610019683838, "mode": "train", "epoch": 30}
{"loss": 0.19008418917655945, "acc": 0.9265624284744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.16434375941753387, "acc": 0.9338200092315674, "length": 3.997309684753418, "mode": "train", "epoch": 31}
{"loss": 0.18849633634090424, "acc": 0.9292969107627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.16365185379981995, "acc": 0.9367709159851074, "length": 3.99596905708313, "mode": "train", "epoch": 32}
{"loss": 0.1771450638771057, "acc": 0.9240235090255737, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.15536653995513916, "acc": 0.9408643245697021, "length": 3.998479127883911, "mode": "train", "epoch": 33}
{"loss": 0.17572247982025146, "acc": 0.9283203482627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.15733452141284943, "acc": 0.9392748475074768, "length": 3.998277425765991, "mode": "train", "epoch": 34}
{"loss": 0.17124682664871216, "acc": 0.9316406846046448, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.16072027385234833, "acc": 0.9376755356788635, "length": 3.999255657196045, "mode": "train", "epoch": 35}
{"loss": 0.17121899127960205, "acc": 0.9267577528953552, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.15702344477176666, "acc": 0.9413884282112122, "length": 3.9998550415039062, "mode": "train", "epoch": 36}
{"loss": 0.18895196914672852, "acc": 0.9273437857627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.15880481898784637, "acc": 0.9402494430541992, "length": 3.9999125003814697, "mode": "train", "epoch": 37}
{"loss": 0.17940327525138855, "acc": 0.9275389909744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.14612282812595367, "acc": 0.9432678818702698, "length": 3.9997620582580566, "mode": "train", "epoch": 38}
{"loss": 0.16531068086624146, "acc": 0.9298829436302185, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1558876782655716, "acc": 0.9357447624206543, "length": 3.999752998352051, "mode": "train", "epoch": 39}
{"loss": 0.17125952243804932, "acc": 0.9306640625, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1460791379213333, "acc": 0.9436402916908264, "length": 3.998572826385498, "mode": "train", "epoch": 40}
{"loss": 0.17998792231082916, "acc": 0.9296875596046448, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.14279219508171082, "acc": 0.9486287236213684, "length": 3.999800205230713, "mode": "train", "epoch": 41}
{"loss": 0.17136824131011963, "acc": 0.9339843392372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1416960507631302, "acc": 0.9468037486076355, "length": 3.999798059463501, "mode": "train", "epoch": 42}
{"loss": 0.18595987558364868, "acc": 0.9226561784744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1361459642648697, "acc": 0.949965238571167, "length": 3.9991607666015625, "mode": "train", "epoch": 43}
{"loss": 0.1627214550971985, "acc": 0.9302734732627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.13751903176307678, "acc": 0.9496555328369141, "length": 3.999814987182617, "mode": "train", "epoch": 44}
{"loss": 0.18549183011054993, "acc": 0.9208984375, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1382261961698532, "acc": 0.9511917233467102, "length": 3.999697685241699, "mode": "train", "epoch": 45}
{"loss": 0.17923614382743835, "acc": 0.9275389313697815, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.13424639403820038, "acc": 0.9499884843826294, "length": 3.9996626377105713, "mode": "train", "epoch": 46}
{"loss": 0.1710025817155838, "acc": 0.9263672828674316, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.13434050977230072, "acc": 0.9508008360862732, "length": 3.997821092605591, "mode": "train", "epoch": 47}
{"loss": 0.17310072481632233, "acc": 0.9322266578674316, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.13234660029411316, "acc": 0.947654128074646, "length": 3.9994547367095947, "mode": "train", "epoch": 48}
{"loss": 0.15549927949905396, "acc": 0.9425782561302185, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.12614688277244568, "acc": 0.9541030526161194, "length": 3.9998621940612793, "mode": "train", "epoch": 49}
{"loss": 0.16643565893173218, "acc": 0.9398437142372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13024184107780457, "acc": 0.9538083672523499, "length": 3.999528646469116, "mode": "train", "epoch": 50}
{"loss": 0.18476389348506927, "acc": 0.9253906607627869, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.13740037381649017, "acc": 0.9482890367507935, "length": 3.999972343444824, "mode": "train", "epoch": 51}
{"loss": 0.17087478935718536, "acc": 0.9253907203674316, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1321408599615097, "acc": 0.9528287053108215, "length": 3.999013662338257, "mode": "train", "epoch": 52}
{"loss": 0.16808384656906128, "acc": 0.9285155534744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.12393192201852798, "acc": 0.9553529024124146, "length": 3.9998137950897217, "mode": "train", "epoch": 53}
{"loss": 0.17160972952842712, "acc": 0.9328125715255737, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1316259801387787, "acc": 0.9524512887001038, "length": 3.9999921321868896, "mode": "train", "epoch": 54}
{"loss": 0.17420594394207, "acc": 0.9277343153953552, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.12440270185470581, "acc": 0.9553013443946838, "length": 3.999939203262329, "mode": "train", "epoch": 55}
{"loss": 0.16247138381004333, "acc": 0.9406250715255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.11734527349472046, "acc": 0.9588926434516907, "length": 3.9999611377716064, "mode": "train", "epoch": 56}
{"loss": 0.1584637612104416, "acc": 0.9400390982627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1115349605679512, "acc": 0.958779513835907, "length": 3.9999704360961914, "mode": "train", "epoch": 57}
{"loss": 0.14194349944591522, "acc": 0.9486327767372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.11130031198263168, "acc": 0.9597347378730774, "length": 3.999553918838501, "mode": "train", "epoch": 58}
{"loss": 0.16169887781143188, "acc": 0.9324218034744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11559897661209106, "acc": 0.9582619667053223, "length": 3.999760627746582, "mode": "train", "epoch": 59}
{"loss": 0.15121454000473022, "acc": 0.9367188215255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.11223780363798141, "acc": 0.9594945311546326, "length": 3.9988815784454346, "mode": "train", "epoch": 60}
{"loss": 0.1614772230386734, "acc": 0.9425782561302185, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7837036848068237
