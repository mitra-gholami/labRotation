ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6936215758323669, "acc": 0.5337144136428833, "length": 3.355255365371704, "mode": "train", "epoch": 1}
{"loss": 0.6842296123504639, "acc": 0.5621826648712158, "length": 1.41015625, "mode": "test", "epoch": 1}
{"loss": 0.6426222920417786, "acc": 0.6329943537712097, "length": 3.2424159049987793, "mode": "train", "epoch": 2}
{"loss": 0.5587425827980042, "acc": 0.7552490830421448, "length": 3.5703125, "mode": "test", "epoch": 2}
{"loss": 0.499051034450531, "acc": 0.7737736701965332, "length": 3.427818775177002, "mode": "train", "epoch": 3}
{"loss": 0.48574572801589966, "acc": 0.7930968999862671, "length": 3.546875, "mode": "test", "epoch": 3}
{"loss": 0.4305039644241333, "acc": 0.8187552690505981, "length": 3.495269775390625, "mode": "train", "epoch": 4}
{"loss": 0.44679495692253113, "acc": 0.8121094107627869, "length": 3.53515625, "mode": "test", "epoch": 4}
{"loss": 0.38409650325775146, "acc": 0.8380284905433655, "length": 3.6926767826080322, "mode": "train", "epoch": 5}
{"loss": 0.39824867248535156, "acc": 0.8299437761306763, "length": 3.99609375, "mode": "test", "epoch": 5}
{"loss": 0.3582831025123596, "acc": 0.8439809083938599, "length": 3.897909641265869, "mode": "train", "epoch": 6}
{"loss": 0.38178810477256775, "acc": 0.8267578482627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.330188125371933, "acc": 0.8630325198173523, "length": 3.9365758895874023, "mode": "train", "epoch": 7}
{"loss": 0.3795340359210968, "acc": 0.8464843034744263, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3154852092266083, "acc": 0.8672037720680237, "length": 3.9512906074523926, "mode": "train", "epoch": 8}
{"loss": 0.34583258628845215, "acc": 0.8564453721046448, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.2913353145122528, "acc": 0.8749448657035828, "length": 3.9496779441833496, "mode": "train", "epoch": 9}
{"loss": 0.3620638847351074, "acc": 0.8539062142372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.27390754222869873, "acc": 0.8797911405563354, "length": 3.966481924057007, "mode": "train", "epoch": 10}
{"loss": 0.36175090074539185, "acc": 0.8542968034744263, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.26712268590927124, "acc": 0.8836952447891235, "length": 3.977262020111084, "mode": "train", "epoch": 11}
{"loss": 0.34599781036376953, "acc": 0.8621093034744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2571004331111908, "acc": 0.8891480565071106, "length": 3.9815666675567627, "mode": "train", "epoch": 12}
{"loss": 0.34974414110183716, "acc": 0.8644531965255737, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.24693912267684937, "acc": 0.8947968482971191, "length": 3.984102964401245, "mode": "train", "epoch": 13}
{"loss": 0.32370591163635254, "acc": 0.8779296278953552, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.23113186657428741, "acc": 0.9029447436332703, "length": 3.9872851371765137, "mode": "train", "epoch": 14}
{"loss": 0.32512277364730835, "acc": 0.8746094107627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2256440967321396, "acc": 0.9069564342498779, "length": 3.990366220474243, "mode": "train", "epoch": 15}
{"loss": 0.3132452964782715, "acc": 0.8755859732627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.21207325160503387, "acc": 0.9154453277587891, "length": 3.9926888942718506, "mode": "train", "epoch": 16}
{"loss": 0.30337363481521606, "acc": 0.8812499642372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2067350298166275, "acc": 0.9157522320747375, "length": 3.992522954940796, "mode": "train", "epoch": 17}
{"loss": 0.2918739914894104, "acc": 0.8794922232627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.1913187950849533, "acc": 0.9254847168922424, "length": 3.9924588203430176, "mode": "train", "epoch": 18}
{"loss": 0.2832735776901245, "acc": 0.9050780534744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.1842791587114334, "acc": 0.9317110180854797, "length": 3.9944238662719727, "mode": "train", "epoch": 19}
{"loss": 0.26151788234710693, "acc": 0.8939452767372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.17204095423221588, "acc": 0.9369494318962097, "length": 3.9938526153564453, "mode": "train", "epoch": 20}
{"loss": 0.27102646231651306, "acc": 0.9019531607627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.15966346859931946, "acc": 0.9436370730400085, "length": 3.994936466217041, "mode": "train", "epoch": 21}
{"loss": 0.22724074125289917, "acc": 0.9130859375, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.16146539151668549, "acc": 0.9392366409301758, "length": 3.994586706161499, "mode": "train", "epoch": 22}
{"loss": 0.24570252001285553, "acc": 0.9070311188697815, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1570432037115097, "acc": 0.9468046426773071, "length": 3.9955828189849854, "mode": "train", "epoch": 23}
{"loss": 0.20456185936927795, "acc": 0.9132813215255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1425771564245224, "acc": 0.9488800168037415, "length": 3.995349645614624, "mode": "train", "epoch": 24}
{"loss": 0.19882898032665253, "acc": 0.9269531965255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.14178015291690826, "acc": 0.9519946575164795, "length": 3.995703935623169, "mode": "train", "epoch": 25}
{"loss": 0.21169207990169525, "acc": 0.9222655892372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.13165409862995148, "acc": 0.9542116522789001, "length": 3.9965736865997314, "mode": "train", "epoch": 26}
{"loss": 0.1848575472831726, "acc": 0.9435548186302185, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.12845727801322937, "acc": 0.9545208215713501, "length": 3.996880292892456, "mode": "train", "epoch": 27}
{"loss": 0.19648092985153198, "acc": 0.9267578125, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1294446438550949, "acc": 0.9561660885810852, "length": 3.9963204860687256, "mode": "train", "epoch": 28}
{"loss": 0.18417403101921082, "acc": 0.9246092438697815, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.12068457156419754, "acc": 0.9573150277137756, "length": 3.9967570304870605, "mode": "train", "epoch": 29}
{"loss": 0.16028662025928497, "acc": 0.947265625, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.11540067940950394, "acc": 0.9616990089416504, "length": 3.99564266204834, "mode": "train", "epoch": 30}
{"loss": 0.17219893634319305, "acc": 0.9435548186302185, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.10308464616537094, "acc": 0.9650699496269226, "length": 3.997433662414551, "mode": "train", "epoch": 31}
{"loss": 0.15172721445560455, "acc": 0.9499999284744263, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.09988751262426376, "acc": 0.9652988314628601, "length": 3.9969968795776367, "mode": "train", "epoch": 32}
{"loss": 0.15413720905780792, "acc": 0.9361328482627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.09714727103710175, "acc": 0.9660685062408447, "length": 3.9965333938598633, "mode": "train", "epoch": 33}
{"loss": 0.15032735466957092, "acc": 0.9378905892372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1041577011346817, "acc": 0.9599471092224121, "length": 3.997169017791748, "mode": "train", "epoch": 34}
{"loss": 0.1752518266439438, "acc": 0.9367188215255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.11710456758737564, "acc": 0.9543510675430298, "length": 3.997390031814575, "mode": "train", "epoch": 35}
{"loss": 0.19983480870723724, "acc": 0.9292969107627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.09786687791347504, "acc": 0.9616678357124329, "length": 3.9971745014190674, "mode": "train", "epoch": 36}
{"loss": 0.14194640517234802, "acc": 0.9392577409744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.08877668529748917, "acc": 0.9675125479698181, "length": 3.9974050521850586, "mode": "train", "epoch": 37}
{"loss": 0.13052012026309967, "acc": 0.9542969465255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.07464321702718735, "acc": 0.9736506938934326, "length": 3.997657537460327, "mode": "train", "epoch": 38}
{"loss": 0.13650347292423248, "acc": 0.9527344703674316, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.07006276398897171, "acc": 0.9777104258537292, "length": 3.9980006217956543, "mode": "train", "epoch": 39}
{"loss": 0.15069204568862915, "acc": 0.9525389671325684, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.06526252627372742, "acc": 0.9776604175567627, "length": 3.9982800483703613, "mode": "train", "epoch": 40}
{"loss": 0.15214063227176666, "acc": 0.9537109732627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.06820417195558548, "acc": 0.9742116928100586, "length": 3.998253107070923, "mode": "train", "epoch": 41}
{"loss": 0.13390856981277466, "acc": 0.9529296159744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.05465352162718773, "acc": 0.9823201894760132, "length": 3.998762369155884, "mode": "train", "epoch": 42}
{"loss": 0.11602920293807983, "acc": 0.9585937857627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.05357290804386139, "acc": 0.98100745677948, "length": 3.9984633922576904, "mode": "train", "epoch": 43}
{"loss": 0.14466306567192078, "acc": 0.9513672590255737, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.053516142070293427, "acc": 0.9830220341682434, "length": 3.9984941482543945, "mode": "train", "epoch": 44}
{"loss": 0.10210631787776947, "acc": 0.9587889909744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04348103329539299, "acc": 0.9866019487380981, "length": 3.9986841678619385, "mode": "train", "epoch": 45}
{"loss": 0.09729482978582382, "acc": 0.9621094465255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.04440857470035553, "acc": 0.9867352247238159, "length": 3.998976945877075, "mode": "train", "epoch": 46}
{"loss": 0.10081861913204193, "acc": 0.9701171517372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.046538807451725006, "acc": 0.9842856526374817, "length": 3.9985036849975586, "mode": "train", "epoch": 47}
{"loss": 0.11695168912410736, "acc": 0.9570311903953552, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.048464059829711914, "acc": 0.9839463829994202, "length": 3.9992806911468506, "mode": "train", "epoch": 48}
{"loss": 0.13231657445430756, "acc": 0.9541016221046448, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.059749726206064224, "acc": 0.9810711741447449, "length": 3.9988276958465576, "mode": "train", "epoch": 49}
{"loss": 0.13597145676612854, "acc": 0.9527344107627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.03808026388287544, "acc": 0.9874429702758789, "length": 3.998817205429077, "mode": "train", "epoch": 50}
{"loss": 0.09506270289421082, "acc": 0.9675780534744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.034442584961652756, "acc": 0.9902656078338623, "length": 3.999439239501953, "mode": "train", "epoch": 51}
{"loss": 0.10063967108726501, "acc": 0.9671874642372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.028172051534056664, "acc": 0.9941418170928955, "length": 3.999516487121582, "mode": "train", "epoch": 52}
{"loss": 0.06426457315683365, "acc": 0.9769530892372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.02904905192553997, "acc": 0.9937225580215454, "length": 3.999509572982788, "mode": "train", "epoch": 53}
{"loss": 0.09276187419891357, "acc": 0.9675780534744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.028056278824806213, "acc": 0.99220871925354, "length": 3.999069929122925, "mode": "train", "epoch": 54}
{"loss": 0.09813863784074783, "acc": 0.9679688215255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.02747492864727974, "acc": 0.9926357269287109, "length": 3.998912811279297, "mode": "train", "epoch": 55}
{"loss": 0.07894665002822876, "acc": 0.9773436784744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.026666954159736633, "acc": 0.9930641055107117, "length": 3.9992618560791016, "mode": "train", "epoch": 56}
{"loss": 0.07168832421302795, "acc": 0.9734374284744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.025614771991968155, "acc": 0.9937915205955505, "length": 3.999727725982666, "mode": "train", "epoch": 57}
{"loss": 0.06752713769674301, "acc": 0.9804688096046448, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.024343539029359818, "acc": 0.993313193321228, "length": 3.9997060298919678, "mode": "train", "epoch": 58}
{"loss": 0.07254045456647873, "acc": 0.9789062142372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.020482972264289856, "acc": 0.9958765506744385, "length": 3.999713659286499, "mode": "train", "epoch": 59}
{"loss": 0.07127538323402405, "acc": 0.9824218153953552, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.01849004253745079, "acc": 0.9974828362464905, "length": 3.9996514320373535, "mode": "train", "epoch": 60}
{"loss": 0.05717112123966217, "acc": 0.9820312857627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.852968692779541
