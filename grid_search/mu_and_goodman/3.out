ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6967394351959229, "acc": 0.5113350749015808, "length": 3.426694393157959, "mode": "train", "epoch": 1}
{"loss": 0.6917035579681396, "acc": 0.5043090581893921, "length": 1.0234375, "mode": "test", "epoch": 1}
{"loss": 0.6841953992843628, "acc": 0.5562899708747864, "length": 3.171922206878662, "mode": "train", "epoch": 2}
{"loss": 0.6525626182556152, "acc": 0.6798889636993408, "length": 3.51953125, "mode": "test", "epoch": 2}
{"loss": 0.6119396686553955, "acc": 0.6896777749061584, "length": 3.653022527694702, "mode": "train", "epoch": 3}
{"loss": 0.5780813097953796, "acc": 0.7023131847381592, "length": 3.859375, "mode": "test", "epoch": 3}
{"loss": 0.5670241713523865, "acc": 0.7049122452735901, "length": 3.6294538974761963, "mode": "train", "epoch": 4}
{"loss": 0.5309650897979736, "acc": 0.752148449420929, "length": 3.9296875, "mode": "test", "epoch": 4}
{"loss": 0.5251786112785339, "acc": 0.7540768980979919, "length": 3.763948678970337, "mode": "train", "epoch": 5}
{"loss": 0.4862233102321625, "acc": 0.7802734375, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.48762989044189453, "acc": 0.7802671194076538, "length": 3.9224488735198975, "mode": "train", "epoch": 6}
{"loss": 0.4739651679992676, "acc": 0.7898436784744263, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.47559601068496704, "acc": 0.7819676995277405, "length": 3.949136972427368, "mode": "train", "epoch": 7}
{"loss": 0.47131118178367615, "acc": 0.7980469465255737, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.45941492915153503, "acc": 0.7953998446464539, "length": 3.9532711505889893, "mode": "train", "epoch": 8}
{"loss": 0.46582144498825073, "acc": 0.8082031607627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4382919371128082, "acc": 0.8090267181396484, "length": 3.948136806488037, "mode": "train", "epoch": 9}
{"loss": 0.4230761229991913, "acc": 0.7998046278953552, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.38925960659980774, "acc": 0.8341978788375854, "length": 3.979736566543579, "mode": "train", "epoch": 10}
{"loss": 0.40183573961257935, "acc": 0.8189453482627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3808686435222626, "acc": 0.8358533978462219, "length": 3.987691879272461, "mode": "train", "epoch": 11}
{"loss": 0.37709900736808777, "acc": 0.8394532203674316, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.35492512583732605, "acc": 0.8449562191963196, "length": 3.991199254989624, "mode": "train", "epoch": 12}
{"loss": 0.3662300109863281, "acc": 0.8451171517372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3492898941040039, "acc": 0.8481605648994446, "length": 3.9904770851135254, "mode": "train", "epoch": 13}
{"loss": 0.36887893080711365, "acc": 0.8486328125, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.340815931558609, "acc": 0.8514964580535889, "length": 3.991307258605957, "mode": "train", "epoch": 14}
{"loss": 0.34174320101737976, "acc": 0.8521484732627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.32123830914497375, "acc": 0.8609219789505005, "length": 3.9941389560699463, "mode": "train", "epoch": 15}
{"loss": 0.33507657051086426, "acc": 0.8572264909744263, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3127300441265106, "acc": 0.8628160357475281, "length": 3.994528293609619, "mode": "train", "epoch": 16}
{"loss": 0.3316750228404999, "acc": 0.8644532561302185, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.31065869331359863, "acc": 0.869202196598053, "length": 3.9960272312164307, "mode": "train", "epoch": 17}
{"loss": 0.32974547147750854, "acc": 0.8664063215255737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.31228896975517273, "acc": 0.8648197650909424, "length": 3.996391773223877, "mode": "train", "epoch": 18}
{"loss": 0.32516464591026306, "acc": 0.8685546517372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3048692047595978, "acc": 0.8708999752998352, "length": 3.995224952697754, "mode": "train", "epoch": 19}
{"loss": 0.32268479466438293, "acc": 0.8685547113418579, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2950421869754791, "acc": 0.8684518337249756, "length": 3.9969546794891357, "mode": "train", "epoch": 20}
{"loss": 0.3191341161727905, "acc": 0.8687500357627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.29650160670280457, "acc": 0.8715209364891052, "length": 3.994908332824707, "mode": "train", "epoch": 21}
{"loss": 0.3197810649871826, "acc": 0.8697265982627869, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2948589026927948, "acc": 0.8785298466682434, "length": 3.997148275375366, "mode": "train", "epoch": 22}
{"loss": 0.32136672735214233, "acc": 0.8699218034744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.29002973437309265, "acc": 0.874058187007904, "length": 3.9980270862579346, "mode": "train", "epoch": 23}
{"loss": 0.3207645118236542, "acc": 0.8601561784744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2884688377380371, "acc": 0.8760837912559509, "length": 3.9986987113952637, "mode": "train", "epoch": 24}
{"loss": 0.3122539520263672, "acc": 0.8664063811302185, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.28552132844924927, "acc": 0.8750925064086914, "length": 3.9961915016174316, "mode": "train", "epoch": 25}
{"loss": 0.31539085507392883, "acc": 0.8642578125, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2803120017051697, "acc": 0.8800181746482849, "length": 3.997713327407837, "mode": "train", "epoch": 26}
{"loss": 0.31020811200141907, "acc": 0.8742188215255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.28468620777130127, "acc": 0.8767307996749878, "length": 3.997615098953247, "mode": "train", "epoch": 27}
{"loss": 0.3088417947292328, "acc": 0.8763671517372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2763642966747284, "acc": 0.8781601786613464, "length": 3.9938712120056152, "mode": "train", "epoch": 28}
{"loss": 0.30510199069976807, "acc": 0.8773437142372131, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2750227451324463, "acc": 0.8821110129356384, "length": 3.995867967605591, "mode": "train", "epoch": 29}
{"loss": 0.29631417989730835, "acc": 0.8777343034744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.26875582337379456, "acc": 0.883834719657898, "length": 3.9987027645111084, "mode": "train", "epoch": 30}
{"loss": 0.2979458272457123, "acc": 0.8804687857627869, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.26340195536613464, "acc": 0.8872158527374268, "length": 3.9981167316436768, "mode": "train", "epoch": 31}
{"loss": 0.29278209805488586, "acc": 0.8796874284744263, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.26114049553871155, "acc": 0.889783501625061, "length": 3.997009754180908, "mode": "train", "epoch": 32}
{"loss": 0.29877644777297974, "acc": 0.8832030296325684, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2582660913467407, "acc": 0.8916965126991272, "length": 3.9963645935058594, "mode": "train", "epoch": 33}
{"loss": 0.2812085449695587, "acc": 0.8884764909744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.24706631898880005, "acc": 0.8990805745124817, "length": 3.998349905014038, "mode": "train", "epoch": 34}
{"loss": 0.27823376655578613, "acc": 0.8908203840255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.25157421827316284, "acc": 0.8938190340995789, "length": 3.9969241619110107, "mode": "train", "epoch": 35}
{"loss": 0.29935115575790405, "acc": 0.8832030892372131, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.23917143046855927, "acc": 0.8993768095970154, "length": 3.9987339973449707, "mode": "train", "epoch": 36}
{"loss": 0.29172277450561523, "acc": 0.8806639909744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.23489616811275482, "acc": 0.905106246471405, "length": 3.9989869594573975, "mode": "train", "epoch": 37}
{"loss": 0.2953367531299591, "acc": 0.8789061903953552, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.23950394988059998, "acc": 0.901975154876709, "length": 3.998063802719116, "mode": "train", "epoch": 38}
{"loss": 0.27460023760795593, "acc": 0.884765625, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.22754961252212524, "acc": 0.9047545790672302, "length": 3.9994263648986816, "mode": "train", "epoch": 39}
{"loss": 0.2747251093387604, "acc": 0.8886718153953552, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.22571280598640442, "acc": 0.9066587686538696, "length": 3.9994566440582275, "mode": "train", "epoch": 40}
{"loss": 0.2674999535083771, "acc": 0.8882812261581421, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.21764665842056274, "acc": 0.9089763760566711, "length": 3.9992148876190186, "mode": "train", "epoch": 41}
{"loss": 0.2776128947734833, "acc": 0.8876952528953552, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2204638123512268, "acc": 0.9081177711486816, "length": 3.996621608734131, "mode": "train", "epoch": 42}
{"loss": 0.2960268557071686, "acc": 0.8839844465255737, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.21686074137687683, "acc": 0.9071357250213623, "length": 3.999265432357788, "mode": "train", "epoch": 43}
{"loss": 0.2529919147491455, "acc": 0.9029297232627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2141934335231781, "acc": 0.9166755080223083, "length": 3.99957275390625, "mode": "train", "epoch": 44}
{"loss": 0.24934238195419312, "acc": 0.8970703482627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.204178586602211, "acc": 0.9166833162307739, "length": 3.999878406524658, "mode": "train", "epoch": 45}
{"loss": 0.2500641942024231, "acc": 0.8957031965255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.21135665476322174, "acc": 0.9153736233711243, "length": 3.999702215194702, "mode": "train", "epoch": 46}
{"loss": 0.25149863958358765, "acc": 0.8972655534744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.20384958386421204, "acc": 0.9179086089134216, "length": 3.999333143234253, "mode": "train", "epoch": 47}
{"loss": 0.2419908195734024, "acc": 0.8986328840255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.20576074719429016, "acc": 0.9185211658477783, "length": 3.9995980262756348, "mode": "train", "epoch": 48}
{"loss": 0.24027679860591888, "acc": 0.9031249284744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.19954977929592133, "acc": 0.916801393032074, "length": 3.999845266342163, "mode": "train", "epoch": 49}
{"loss": 0.24318523705005646, "acc": 0.8990234732627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.19854411482810974, "acc": 0.9167393445968628, "length": 3.999483108520508, "mode": "train", "epoch": 50}
{"loss": 0.2363673448562622, "acc": 0.9035156965255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.1968805342912674, "acc": 0.9167435169219971, "length": 3.9999160766601562, "mode": "train", "epoch": 51}
{"loss": 0.24552005529403687, "acc": 0.8992186784744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1836475282907486, "acc": 0.9216262102127075, "length": 3.9996440410614014, "mode": "train", "epoch": 52}
{"loss": 0.25104889273643494, "acc": 0.8957031965255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.18088926374912262, "acc": 0.9250869750976562, "length": 3.999922513961792, "mode": "train", "epoch": 53}
{"loss": 0.24124664068222046, "acc": 0.9078125357627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.18193495273590088, "acc": 0.9262915253639221, "length": 3.9980859756469727, "mode": "train", "epoch": 54}
{"loss": 0.23715436458587646, "acc": 0.9046874642372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.18562233448028564, "acc": 0.922930121421814, "length": 3.99958872795105, "mode": "train", "epoch": 55}
{"loss": 0.2482505738735199, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1907082498073578, "acc": 0.9237706661224365, "length": 3.9998135566711426, "mode": "train", "epoch": 56}
{"loss": 0.2400319129228592, "acc": 0.9085937142372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1739497184753418, "acc": 0.9290125370025635, "length": 3.999830722808838, "mode": "train", "epoch": 57}
{"loss": 0.20313362777233124, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.16939398646354675, "acc": 0.930392324924469, "length": 3.9999709129333496, "mode": "train", "epoch": 58}
{"loss": 0.23845742642879486, "acc": 0.9070311784744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.16839465498924255, "acc": 0.9289619326591492, "length": 3.999955177307129, "mode": "train", "epoch": 59}
{"loss": 0.20341557264328003, "acc": 0.9207029938697815, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1661801040172577, "acc": 0.934026837348938, "length": 3.9999654293060303, "mode": "train", "epoch": 60}
{"loss": 0.20728880167007446, "acc": 0.919921875, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7985938191413879
