ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6917453408241272, "acc": 0.5279519557952881, "length": 3.529825448989868, "mode": "train", "epoch": 1}
{"loss": 0.6682013869285583, "acc": 0.6027710437774658, "length": 3.59375, "mode": "test", "epoch": 1}
{"loss": 0.6773542761802673, "acc": 0.5714669227600098, "length": 3.538569688796997, "mode": "train", "epoch": 2}
{"loss": 0.6300079226493835, "acc": 0.7365235090255737, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5901231169700623, "acc": 0.7363691329956055, "length": 3.893885374069214, "mode": "train", "epoch": 3}
{"loss": 0.5352909564971924, "acc": 0.7730469107627869, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.48104438185691833, "acc": 0.7928763031959534, "length": 3.973478078842163, "mode": "train", "epoch": 4}
{"loss": 0.44722381234169006, "acc": 0.8087891936302185, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4059380292892456, "acc": 0.8234724402427673, "length": 3.9867379665374756, "mode": "train", "epoch": 5}
{"loss": 0.4379473924636841, "acc": 0.8117188215255737, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.38329240679740906, "acc": 0.8349167108535767, "length": 3.9926486015319824, "mode": "train", "epoch": 6}
{"loss": 0.4297504723072052, "acc": 0.8171874284744263, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3635264039039612, "acc": 0.8448224067687988, "length": 3.9883553981781006, "mode": "train", "epoch": 7}
{"loss": 0.39034605026245117, "acc": 0.8248047232627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3342870771884918, "acc": 0.8597118854522705, "length": 3.994546413421631, "mode": "train", "epoch": 8}
{"loss": 0.37858855724334717, "acc": 0.8396483063697815, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3164890706539154, "acc": 0.8677921295166016, "length": 3.9904279708862305, "mode": "train", "epoch": 9}
{"loss": 0.357500821352005, "acc": 0.849609375, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.30152755975723267, "acc": 0.8752177953720093, "length": 3.9964263439178467, "mode": "train", "epoch": 10}
{"loss": 0.3409625291824341, "acc": 0.8576172590255737, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.29623255133628845, "acc": 0.8754347562789917, "length": 3.994885206222534, "mode": "train", "epoch": 11}
{"loss": 0.3251926898956299, "acc": 0.8582030534744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2869984805583954, "acc": 0.8833394050598145, "length": 3.9961884021759033, "mode": "train", "epoch": 12}
{"loss": 0.3282119631767273, "acc": 0.8646484017372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2741923928260803, "acc": 0.8875966668128967, "length": 3.995429754257202, "mode": "train", "epoch": 13}
{"loss": 0.3111018240451813, "acc": 0.8816405534744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2645874321460724, "acc": 0.8913471102714539, "length": 3.9977285861968994, "mode": "train", "epoch": 14}
{"loss": 0.29534170031547546, "acc": 0.8908203840255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.26492589712142944, "acc": 0.8947724103927612, "length": 3.996119976043701, "mode": "train", "epoch": 15}
{"loss": 0.29052838683128357, "acc": 0.8902344107627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.25936052203178406, "acc": 0.8950227499008179, "length": 3.9990203380584717, "mode": "train", "epoch": 16}
{"loss": 0.2840016186237335, "acc": 0.88671875, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.25295814871788025, "acc": 0.8991584777832031, "length": 3.9990010261535645, "mode": "train", "epoch": 17}
{"loss": 0.27190545201301575, "acc": 0.8982421159744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.248025581240654, "acc": 0.9000561833381653, "length": 3.9995322227478027, "mode": "train", "epoch": 18}
{"loss": 0.2874838709831238, "acc": 0.8970703482627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.24590645730495453, "acc": 0.9017324447631836, "length": 3.996692419052124, "mode": "train", "epoch": 19}
{"loss": 0.2734531760215759, "acc": 0.8914061784744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.24229548871517181, "acc": 0.9024662375450134, "length": 3.999412775039673, "mode": "train", "epoch": 20}
{"loss": 0.25965821743011475, "acc": 0.8968749642372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2410898059606552, "acc": 0.9034734964370728, "length": 3.9974160194396973, "mode": "train", "epoch": 21}
{"loss": 0.24755701422691345, "acc": 0.8978515267372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23241811990737915, "acc": 0.9087737202644348, "length": 3.999337673187256, "mode": "train", "epoch": 22}
{"loss": 0.24964679777622223, "acc": 0.9035157561302185, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2263958603143692, "acc": 0.9118022322654724, "length": 3.9996938705444336, "mode": "train", "epoch": 23}
{"loss": 0.25088804960250854, "acc": 0.8986328840255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.22969523072242737, "acc": 0.909679651260376, "length": 3.999854326248169, "mode": "train", "epoch": 24}
{"loss": 0.2514258027076721, "acc": 0.9027343392372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.22136880457401276, "acc": 0.912244439125061, "length": 3.997467517852783, "mode": "train", "epoch": 25}
{"loss": 0.24765537679195404, "acc": 0.9044922590255737, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2139265239238739, "acc": 0.9162319302558899, "length": 3.99977970123291, "mode": "train", "epoch": 26}
{"loss": 0.2544001042842865, "acc": 0.9023438096046448, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.21682998538017273, "acc": 0.9147945046424866, "length": 3.9976892471313477, "mode": "train", "epoch": 27}
{"loss": 0.2392018437385559, "acc": 0.908203125, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2069246917963028, "acc": 0.9181802272796631, "length": 3.998919725418091, "mode": "train", "epoch": 28}
{"loss": 0.22947120666503906, "acc": 0.9107422232627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2064768224954605, "acc": 0.9220499396324158, "length": 3.997304916381836, "mode": "train", "epoch": 29}
{"loss": 0.23422230780124664, "acc": 0.9138671159744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.20525968074798584, "acc": 0.9172946810722351, "length": 3.999934673309326, "mode": "train", "epoch": 30}
{"loss": 0.23595592379570007, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1993560642004013, "acc": 0.9204766154289246, "length": 3.999622344970703, "mode": "train", "epoch": 31}
{"loss": 0.21313509345054626, "acc": 0.9216795563697815, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.1960822492837906, "acc": 0.9218862652778625, "length": 3.998286008834839, "mode": "train", "epoch": 32}
{"loss": 0.22021451592445374, "acc": 0.9115234017372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1933937817811966, "acc": 0.9238471984863281, "length": 3.9998137950897217, "mode": "train", "epoch": 33}
{"loss": 0.21666017174720764, "acc": 0.9195312857627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.19088229537010193, "acc": 0.9264340996742249, "length": 3.999408006668091, "mode": "train", "epoch": 34}
{"loss": 0.21894679963588715, "acc": 0.9242187142372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.18820476531982422, "acc": 0.9279616475105286, "length": 3.9992458820343018, "mode": "train", "epoch": 35}
{"loss": 0.20368671417236328, "acc": 0.9265624284744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1824902445077896, "acc": 0.9280374646186829, "length": 3.9998719692230225, "mode": "train", "epoch": 36}
{"loss": 0.2016892433166504, "acc": 0.9312500357627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.181538388133049, "acc": 0.9310370683670044, "length": 3.9996745586395264, "mode": "train", "epoch": 37}
{"loss": 0.1953849047422409, "acc": 0.9312500357627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.18593499064445496, "acc": 0.9314616322517395, "length": 3.9998836517333984, "mode": "train", "epoch": 38}
{"loss": 0.21351593732833862, "acc": 0.9197264909744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.17324180901050568, "acc": 0.9316367506980896, "length": 3.999696969985962, "mode": "train", "epoch": 39}
{"loss": 0.19951128959655762, "acc": 0.9294921159744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.16942240297794342, "acc": 0.93370121717453, "length": 3.9997313022613525, "mode": "train", "epoch": 40}
{"loss": 0.19924737513065338, "acc": 0.9357422590255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1620054543018341, "acc": 0.9373074769973755, "length": 3.9999630451202393, "mode": "train", "epoch": 41}
{"loss": 0.20231904089450836, "acc": 0.9269531965255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.15617503225803375, "acc": 0.9370689988136292, "length": 3.9997239112854004, "mode": "train", "epoch": 42}
{"loss": 0.19233140349388123, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15706317126750946, "acc": 0.9379949569702148, "length": 3.9988749027252197, "mode": "train", "epoch": 43}
{"loss": 0.2062816321849823, "acc": 0.9302734732627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1553651988506317, "acc": 0.9422844648361206, "length": 3.9989774227142334, "mode": "train", "epoch": 44}
{"loss": 0.18303540349006653, "acc": 0.9380859732627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.15250732004642487, "acc": 0.9432101249694824, "length": 3.9999570846557617, "mode": "train", "epoch": 45}
{"loss": 0.1888449490070343, "acc": 0.9332031607627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1454397439956665, "acc": 0.9449784159660339, "length": 3.999760150909424, "mode": "train", "epoch": 46}
{"loss": 0.18807457387447357, "acc": 0.9343748688697815, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.14396755397319794, "acc": 0.948341965675354, "length": 3.9998409748077393, "mode": "train", "epoch": 47}
{"loss": 0.1920376867055893, "acc": 0.9373046159744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.143646702170372, "acc": 0.94728022813797, "length": 3.9998698234558105, "mode": "train", "epoch": 48}
{"loss": 0.19413283467292786, "acc": 0.9365234375, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1391286700963974, "acc": 0.9465682506561279, "length": 3.9997169971466064, "mode": "train", "epoch": 49}
{"loss": 0.18630991876125336, "acc": 0.9439453482627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13754327595233917, "acc": 0.9452690482139587, "length": 3.9997787475585938, "mode": "train", "epoch": 50}
{"loss": 0.17902575433254242, "acc": 0.9447265267372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.13159716129302979, "acc": 0.9501702189445496, "length": 3.9995388984680176, "mode": "train", "epoch": 51}
{"loss": 0.17909978330135345, "acc": 0.9421874284744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.13517418503761292, "acc": 0.9495638608932495, "length": 3.996412515640259, "mode": "train", "epoch": 52}
{"loss": 0.1740027368068695, "acc": 0.9408202767372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.137459397315979, "acc": 0.9442732334136963, "length": 3.999974250793457, "mode": "train", "epoch": 53}
{"loss": 0.1936425119638443, "acc": 0.9402343034744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.131607323884964, "acc": 0.9503448605537415, "length": 3.9994895458221436, "mode": "train", "epoch": 54}
{"loss": 0.18024757504463196, "acc": 0.9423828721046448, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.12477460503578186, "acc": 0.9548304677009583, "length": 3.999769449234009, "mode": "train", "epoch": 55}
{"loss": 0.18275810778141022, "acc": 0.9419922232627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.12449362874031067, "acc": 0.955771803855896, "length": 3.9997172355651855, "mode": "train", "epoch": 56}
{"loss": 0.16986912488937378, "acc": 0.9445313215255737, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.13134780526161194, "acc": 0.9494069814682007, "length": 3.9999430179595947, "mode": "train", "epoch": 57}
{"loss": 0.1759384125471115, "acc": 0.9457030892372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.12027689814567566, "acc": 0.9547419548034668, "length": 3.9987950325012207, "mode": "train", "epoch": 58}
{"loss": 0.20250877737998962, "acc": 0.9378905892372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.12168106436729431, "acc": 0.9520056843757629, "length": 3.9999470710754395, "mode": "train", "epoch": 59}
{"loss": 0.17319363355636597, "acc": 0.9457030892372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.11738595366477966, "acc": 0.957725465297699, "length": 3.999875783920288, "mode": "train", "epoch": 60}
{"loss": 0.1773153841495514, "acc": 0.9455078840255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7983871698379517
