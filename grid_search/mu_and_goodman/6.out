ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.697531521320343, "acc": 0.5079963207244873, "length": 3.4006941318511963, "mode": "train", "epoch": 1}
{"loss": 0.6926537752151489, "acc": 0.4920138716697693, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6794995069503784, "acc": 0.5831074118614197, "length": 2.9199941158294678, "mode": "train", "epoch": 2}
{"loss": 0.637584924697876, "acc": 0.6849610209465027, "length": 3.375, "mode": "test", "epoch": 2}
{"loss": 0.5977955460548401, "acc": 0.7257679104804993, "length": 3.4487104415893555, "mode": "train", "epoch": 3}
{"loss": 0.5575171113014221, "acc": 0.7326823472976685, "length": 3.4166667461395264, "mode": "test", "epoch": 3}
{"loss": 0.5154240131378174, "acc": 0.7727195620536804, "length": 3.2356960773468018, "mode": "train", "epoch": 4}
{"loss": 0.5175542235374451, "acc": 0.7887966632843018, "length": 3.190972328186035, "mode": "test", "epoch": 4}
{"loss": 0.4839293360710144, "acc": 0.7986788749694824, "length": 3.1067757606506348, "mode": "train", "epoch": 5}
{"loss": 0.5032422542572021, "acc": 0.7795246839523315, "length": 3.118055582046509, "mode": "test", "epoch": 5}
{"loss": 0.46164995431900024, "acc": 0.805300235748291, "length": 3.2106101512908936, "mode": "train", "epoch": 6}
{"loss": 0.5089710354804993, "acc": 0.8005479574203491, "length": 3.0, "mode": "test", "epoch": 6}
{"loss": 0.4476308822631836, "acc": 0.8111095428466797, "length": 3.2074532508850098, "mode": "train", "epoch": 7}
{"loss": 0.4802168309688568, "acc": 0.7991807460784912, "length": 3.090277671813965, "mode": "test", "epoch": 7}
{"loss": 0.4321323335170746, "acc": 0.8131013512611389, "length": 3.3953981399536133, "mode": "train", "epoch": 8}
{"loss": 0.4576073884963989, "acc": 0.8001790046691895, "length": 3.5486111640930176, "mode": "test", "epoch": 8}
{"loss": 0.4081644117832184, "acc": 0.8150643110275269, "length": 3.674818515777588, "mode": "train", "epoch": 9}
{"loss": 0.4139232933521271, "acc": 0.8088976144790649, "length": 3.8298611640930176, "mode": "test", "epoch": 9}
{"loss": 0.3780262768268585, "acc": 0.8194898366928101, "length": 3.773062229156494, "mode": "train", "epoch": 10}
{"loss": 0.3970479667186737, "acc": 0.8258625864982605, "length": 3.940972328186035, "mode": "test", "epoch": 10}
{"loss": 0.36167216300964355, "acc": 0.8359171748161316, "length": 3.797137498855591, "mode": "train", "epoch": 11}
{"loss": 0.3921254873275757, "acc": 0.829638659954071, "length": 3.774305582046509, "mode": "test", "epoch": 11}
{"loss": 0.3375403881072998, "acc": 0.8501875400543213, "length": 3.766792058944702, "mode": "train", "epoch": 12}
{"loss": 0.3787555992603302, "acc": 0.8378200531005859, "length": 3.8333332538604736, "mode": "test", "epoch": 12}
{"loss": 0.3216896951198578, "acc": 0.8567661643028259, "length": 3.783165454864502, "mode": "train", "epoch": 13}
{"loss": 0.3791514039039612, "acc": 0.8466092348098755, "length": 3.836805582046509, "mode": "test", "epoch": 13}
{"loss": 0.3192823529243469, "acc": 0.8637351989746094, "length": 3.80617618560791, "mode": "train", "epoch": 14}
{"loss": 0.3696497976779938, "acc": 0.8401204943656921, "length": 3.809027671813965, "mode": "test", "epoch": 14}
{"loss": 0.3041171729564667, "acc": 0.8677926659584045, "length": 3.797454833984375, "mode": "train", "epoch": 15}
{"loss": 0.3583860695362091, "acc": 0.8612468242645264, "length": 3.840277671813965, "mode": "test", "epoch": 15}
{"loss": 0.29246073961257935, "acc": 0.87655109167099, "length": 3.7971935272216797, "mode": "train", "epoch": 16}
{"loss": 0.3529353737831116, "acc": 0.8507269620895386, "length": 3.8229167461395264, "mode": "test", "epoch": 16}
{"loss": 0.2826519310474396, "acc": 0.8812721967697144, "length": 3.821155309677124, "mode": "train", "epoch": 17}
{"loss": 0.3374905586242676, "acc": 0.8634819984436035, "length": 3.8958332538604736, "mode": "test", "epoch": 17}
{"loss": 0.27249184250831604, "acc": 0.8892934918403625, "length": 3.8552417755126953, "mode": "train", "epoch": 18}
{"loss": 0.3201846778392792, "acc": 0.8751084804534912, "length": 3.840277671813965, "mode": "test", "epoch": 18}
{"loss": 0.25877028703689575, "acc": 0.8929452300071716, "length": 3.8566205501556396, "mode": "train", "epoch": 19}
{"loss": 0.295890212059021, "acc": 0.8853948712348938, "length": 3.847222328186035, "mode": "test", "epoch": 19}
{"loss": 0.25083431601524353, "acc": 0.8951811194419861, "length": 3.8619375228881836, "mode": "train", "epoch": 20}
{"loss": 0.3042648732662201, "acc": 0.8876519799232483, "length": 3.8958332538604736, "mode": "test", "epoch": 20}
{"loss": 0.24350450932979584, "acc": 0.9053741693496704, "length": 3.852695941925049, "mode": "train", "epoch": 21}
{"loss": 0.2866821587085724, "acc": 0.8948025107383728, "length": 3.878472328186035, "mode": "test", "epoch": 21}
{"loss": 0.24121388792991638, "acc": 0.9071136116981506, "length": 3.8702821731567383, "mode": "train", "epoch": 22}
{"loss": 0.2894420921802521, "acc": 0.8973686695098877, "length": 3.8645832538604736, "mode": "test", "epoch": 22}
{"loss": 0.2300034463405609, "acc": 0.9128478169441223, "length": 3.8775672912597656, "mode": "train", "epoch": 23}
{"loss": 0.27030330896377563, "acc": 0.8947157263755798, "length": 3.868055582046509, "mode": "test", "epoch": 23}
{"loss": 0.22451266646385193, "acc": 0.9139547348022461, "length": 3.8523457050323486, "mode": "train", "epoch": 24}
{"loss": 0.2782284915447235, "acc": 0.9003363847732544, "length": 3.868055582046509, "mode": "test", "epoch": 24}
{"loss": 0.22362853586673737, "acc": 0.9163650274276733, "length": 3.8609373569488525, "mode": "train", "epoch": 25}
{"loss": 0.26416274905204773, "acc": 0.9009385704994202, "length": 3.871527671813965, "mode": "test", "epoch": 25}
{"loss": 0.2169838398694992, "acc": 0.9185498356819153, "length": 3.8495161533355713, "mode": "train", "epoch": 26}
{"loss": 0.27075040340423584, "acc": 0.8969347476959229, "length": 3.881944417953491, "mode": "test", "epoch": 26}
{"loss": 0.21005208790302277, "acc": 0.9208607077598572, "length": 3.8501336574554443, "mode": "train", "epoch": 27}
{"loss": 0.2587326765060425, "acc": 0.9040201902389526, "length": 3.930555582046509, "mode": "test", "epoch": 27}
{"loss": 0.20513318479061127, "acc": 0.9216436147689819, "length": 3.8655104637145996, "mode": "train", "epoch": 28}
{"loss": 0.2535718083381653, "acc": 0.9050562977790833, "length": 3.871527671813965, "mode": "test", "epoch": 28}
{"loss": 0.2043122947216034, "acc": 0.9254546761512756, "length": 3.8513777256011963, "mode": "train", "epoch": 29}
{"loss": 0.26097673177719116, "acc": 0.9039658308029175, "length": 3.8854167461395264, "mode": "test", "epoch": 29}
{"loss": 0.19805899262428284, "acc": 0.9247053265571594, "length": 3.8777987957000732, "mode": "train", "epoch": 30}
{"loss": 0.2523283362388611, "acc": 0.8997557759284973, "length": 3.8854167461395264, "mode": "test", "epoch": 30}
{"loss": 0.19536755979061127, "acc": 0.9245626330375671, "length": 3.866523265838623, "mode": "train", "epoch": 31}
{"loss": 0.2537579834461212, "acc": 0.9052788615226746, "length": 3.9375, "mode": "test", "epoch": 31}
{"loss": 0.1925048977136612, "acc": 0.9250854253768921, "length": 3.8801352977752686, "mode": "train", "epoch": 32}
{"loss": 0.2496112436056137, "acc": 0.9076388478279114, "length": 3.8888888359069824, "mode": "test", "epoch": 32}
{"loss": 0.19129368662834167, "acc": 0.9252874255180359, "length": 3.885133743286133, "mode": "train", "epoch": 33}
{"loss": 0.2655142843723297, "acc": 0.9027235507965088, "length": 3.8923611640930176, "mode": "test", "epoch": 33}
{"loss": 0.1909608691930771, "acc": 0.9249760508537292, "length": 3.887436866760254, "mode": "train", "epoch": 34}
{"loss": 0.2509435713291168, "acc": 0.9015678763389587, "length": 3.899305582046509, "mode": "test", "epoch": 34}
{"loss": 0.19763623178005219, "acc": 0.9251511693000793, "length": 3.8643903732299805, "mode": "train", "epoch": 35}
{"loss": 0.25609827041625977, "acc": 0.8911783695220947, "length": 3.944444417953491, "mode": "test", "epoch": 35}
{"loss": 0.19798490405082703, "acc": 0.9239290356636047, "length": 3.910405158996582, "mode": "train", "epoch": 36}
{"loss": 0.2524712383747101, "acc": 0.9025607705116272, "length": 3.90625, "mode": "test", "epoch": 36}
{"loss": 0.19448602199554443, "acc": 0.9284018278121948, "length": 3.870434284210205, "mode": "train", "epoch": 37}
{"loss": 0.2574194371700287, "acc": 0.9018175601959229, "length": 3.8888888359069824, "mode": "test", "epoch": 37}
{"loss": 0.1851460188627243, "acc": 0.9249884486198425, "length": 3.890289068222046, "mode": "train", "epoch": 38}
{"loss": 0.24612824618816376, "acc": 0.9020670652389526, "length": 3.909722328186035, "mode": "test", "epoch": 38}
{"loss": 0.187935933470726, "acc": 0.9286929368972778, "length": 3.8936665058135986, "mode": "train", "epoch": 39}
{"loss": 0.2869068384170532, "acc": 0.8983452320098877, "length": 3.8854167461395264, "mode": "test", "epoch": 39}
{"loss": 0.19843359291553497, "acc": 0.9199411273002625, "length": 3.86676287651062, "mode": "train", "epoch": 40}
{"loss": 0.2500884532928467, "acc": 0.9011991024017334, "length": 3.8958332538604736, "mode": "test", "epoch": 40}
{"loss": 0.1844296157360077, "acc": 0.928086519241333, "length": 3.883901834487915, "mode": "train", "epoch": 41}
{"loss": 0.2639870345592499, "acc": 0.9053765535354614, "length": 3.90625, "mode": "test", "epoch": 41}
{"loss": 0.19246675074100494, "acc": 0.9300125241279602, "length": 3.875972032546997, "mode": "train", "epoch": 42}
{"loss": 0.2699289619922638, "acc": 0.9026042222976685, "length": 3.8958332538604736, "mode": "test", "epoch": 42}
{"loss": 0.18116579949855804, "acc": 0.9278287887573242, "length": 3.8755292892456055, "mode": "train", "epoch": 43}
{"loss": 0.2622828185558319, "acc": 0.9074543714523315, "length": 3.899305582046509, "mode": "test", "epoch": 43}
{"loss": 0.1791902333498001, "acc": 0.9317358732223511, "length": 3.876715660095215, "mode": "train", "epoch": 44}
{"loss": 0.2714669108390808, "acc": 0.9019911289215088, "length": 3.8923611640930176, "mode": "test", "epoch": 44}
{"loss": 0.18241368234157562, "acc": 0.9311798810958862, "length": 3.8778436183929443, "mode": "train", "epoch": 45}
{"loss": 0.2742939889431, "acc": 0.9041069746017456, "length": 3.8888888359069824, "mode": "test", "epoch": 45}
{"loss": 0.17876341938972473, "acc": 0.9306003451347351, "length": 3.8708291053771973, "mode": "train", "epoch": 46}
{"loss": 0.2761824429035187, "acc": 0.9052029848098755, "length": 3.8958332538604736, "mode": "test", "epoch": 46}
{"loss": 0.1788109540939331, "acc": 0.9300455451011658, "length": 3.8724024295806885, "mode": "train", "epoch": 47}
{"loss": 0.26707231998443604, "acc": 0.9075736999511719, "length": 3.881944417953491, "mode": "test", "epoch": 47}
{"loss": 0.17367863655090332, "acc": 0.9315934777259827, "length": 3.871082305908203, "mode": "train", "epoch": 48}
{"loss": 0.2531485855579376, "acc": 0.9055446982383728, "length": 3.902777671813965, "mode": "test", "epoch": 48}
{"loss": 0.17717353999614716, "acc": 0.9303918480873108, "length": 3.8914055824279785, "mode": "train", "epoch": 49}
{"loss": 0.27700942754745483, "acc": 0.9034613370895386, "length": 3.878472328186035, "mode": "test", "epoch": 49}
{"loss": 0.17076356709003448, "acc": 0.9334571361541748, "length": 3.843930721282959, "mode": "train", "epoch": 50}
{"loss": 0.26102861762046814, "acc": 0.9041340947151184, "length": 3.8854167461395264, "mode": "test", "epoch": 50}
{"loss": 0.17120051383972168, "acc": 0.9339519739151001, "length": 3.8805463314056396, "mode": "train", "epoch": 51}
{"loss": 0.2680056095123291, "acc": 0.9029350280761719, "length": 3.9236111640930176, "mode": "test", "epoch": 51}
{"loss": 0.17607685923576355, "acc": 0.9333136677742004, "length": 3.897261381149292, "mode": "train", "epoch": 52}
{"loss": 0.2587124705314636, "acc": 0.9062662124633789, "length": 3.8923611640930176, "mode": "test", "epoch": 52}
{"loss": 0.17140066623687744, "acc": 0.9333257079124451, "length": 3.875011682510376, "mode": "train", "epoch": 53}
{"loss": 0.2660099267959595, "acc": 0.9062554240226746, "length": 3.8888888359069824, "mode": "test", "epoch": 53}
{"loss": 0.1701323240995407, "acc": 0.9335152506828308, "length": 3.887820243835449, "mode": "train", "epoch": 54}
{"loss": 0.26338353753089905, "acc": 0.9015137553215027, "length": 3.9270832538604736, "mode": "test", "epoch": 54}
{"loss": 0.17104072868824005, "acc": 0.9346740245819092, "length": 3.8945610523223877, "mode": "train", "epoch": 55}
{"loss": 0.28753548860549927, "acc": 0.9082247614860535, "length": 3.8923611640930176, "mode": "test", "epoch": 55}
{"loss": 0.17234930396080017, "acc": 0.9348101615905762, "length": 3.8919217586517334, "mode": "train", "epoch": 56}
{"loss": 0.25849029421806335, "acc": 0.9092068076133728, "length": 3.8958332538604736, "mode": "test", "epoch": 56}
{"loss": 0.1719619780778885, "acc": 0.9322215914726257, "length": 3.86521577835083, "mode": "train", "epoch": 57}
{"loss": 0.27908843755722046, "acc": 0.9043511152267456, "length": 3.8888888359069824, "mode": "test", "epoch": 57}
{"loss": 0.1667262315750122, "acc": 0.9323276281356812, "length": 3.871731996536255, "mode": "train", "epoch": 58}
{"loss": 0.3102518618106842, "acc": 0.9003417491912842, "length": 3.871527671813965, "mode": "test", "epoch": 58}
{"loss": 0.17395225167274475, "acc": 0.9294975996017456, "length": 3.8710241317749023, "mode": "train", "epoch": 59}
{"loss": 0.2657392919063568, "acc": 0.903510332107544, "length": 3.902777671813965, "mode": "test", "epoch": 59}
{"loss": 0.16484764218330383, "acc": 0.9349892735481262, "length": 3.8831288814544678, "mode": "train", "epoch": 60}
{"loss": 0.27194803953170776, "acc": 0.9053331017494202, "length": 3.899305582046509, "mode": "test", "epoch": 60}
test accuracy: 0.8208315372467041
