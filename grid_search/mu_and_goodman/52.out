ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6953464150428772, "acc": 0.50997394323349, "length": 3.5389366149902344, "mode": "train", "epoch": 1}
{"loss": 0.684391975402832, "acc": 0.5597671270370483, "length": 3.4375, "mode": "test", "epoch": 1}
{"loss": 0.6918357014656067, "acc": 0.5322012901306152, "length": 3.515439748764038, "mode": "train", "epoch": 2}
{"loss": 0.6770390272140503, "acc": 0.6023315191268921, "length": 2.640625, "mode": "test", "epoch": 2}
{"loss": 0.6911973357200623, "acc": 0.5318523645401001, "length": 3.4906585216522217, "mode": "train", "epoch": 3}
{"loss": 0.6707532405853271, "acc": 0.6191177368164062, "length": 2.7890625, "mode": "test", "epoch": 3}
{"loss": 0.6894139051437378, "acc": 0.5404504537582397, "length": 3.4553475379943848, "mode": "train", "epoch": 4}
{"loss": 0.6661844849586487, "acc": 0.659014880657196, "length": 3.00390625, "mode": "test", "epoch": 4}
{"loss": 0.6860077977180481, "acc": 0.5681667327880859, "length": 3.404900312423706, "mode": "train", "epoch": 5}
{"loss": 0.6610020399093628, "acc": 0.6671493649482727, "length": 3.16796875, "mode": "test", "epoch": 5}
{"loss": 0.6766940355300903, "acc": 0.5922383666038513, "length": 3.3418266773223877, "mode": "train", "epoch": 6}
{"loss": 0.6417464017868042, "acc": 0.6627410650253296, "length": 3.5078125, "mode": "test", "epoch": 6}
{"loss": 0.6573861837387085, "acc": 0.6408280730247498, "length": 3.41564679145813, "mode": "train", "epoch": 7}
{"loss": 0.6148391962051392, "acc": 0.7274200320243835, "length": 3.9140625, "mode": "test", "epoch": 7}
{"loss": 0.6217958331108093, "acc": 0.7103146314620972, "length": 3.617435932159424, "mode": "train", "epoch": 8}
{"loss": 0.5827696323394775, "acc": 0.7296874523162842, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.578028678894043, "acc": 0.7182815670967102, "length": 3.7768537998199463, "mode": "train", "epoch": 9}
{"loss": 0.5501682758331299, "acc": 0.7421874403953552, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5427377223968506, "acc": 0.7324782013893127, "length": 3.8832690715789795, "mode": "train", "epoch": 10}
{"loss": 0.527173638343811, "acc": 0.7650390267372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5195425152778625, "acc": 0.7398011684417725, "length": 3.9164741039276123, "mode": "train", "epoch": 11}
{"loss": 0.5154486298561096, "acc": 0.7693358659744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.49295833706855774, "acc": 0.7687718868255615, "length": 3.9492175579071045, "mode": "train", "epoch": 12}
{"loss": 0.5125636458396912, "acc": 0.7697265148162842, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.47165918350219727, "acc": 0.7969498634338379, "length": 3.965217351913452, "mode": "train", "epoch": 13}
{"loss": 0.49654990434646606, "acc": 0.7882813215255737, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4558296799659729, "acc": 0.8038158416748047, "length": 3.97119402885437, "mode": "train", "epoch": 14}
{"loss": 0.49358323216438293, "acc": 0.7906250357627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.43996772170066833, "acc": 0.7988178133964539, "length": 3.9782159328460693, "mode": "train", "epoch": 15}
{"loss": 0.4964963495731354, "acc": 0.7953124642372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4280456602573395, "acc": 0.8224548697471619, "length": 3.9816012382507324, "mode": "train", "epoch": 16}
{"loss": 0.48678135871887207, "acc": 0.7910156846046448, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.41908159852027893, "acc": 0.8197486996650696, "length": 3.9852888584136963, "mode": "train", "epoch": 17}
{"loss": 0.46842706203460693, "acc": 0.7964844107627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.40670540928840637, "acc": 0.8264439702033997, "length": 3.985582113265991, "mode": "train", "epoch": 18}
{"loss": 0.4604429602622986, "acc": 0.7974609136581421, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.39920225739479065, "acc": 0.824435830116272, "length": 3.98513126373291, "mode": "train", "epoch": 19}
{"loss": 0.45576298236846924, "acc": 0.8025389909744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3885350823402405, "acc": 0.8297160863876343, "length": 3.9896645545959473, "mode": "train", "epoch": 20}
{"loss": 0.4497910737991333, "acc": 0.7927733659744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.38158756494522095, "acc": 0.8331873416900635, "length": 3.9908318519592285, "mode": "train", "epoch": 21}
{"loss": 0.4452207088470459, "acc": 0.8035155534744263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3781675398349762, "acc": 0.8294550180435181, "length": 3.9914886951446533, "mode": "train", "epoch": 22}
{"loss": 0.4406372904777527, "acc": 0.7791014909744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3736344277858734, "acc": 0.8303070664405823, "length": 3.9911227226257324, "mode": "train", "epoch": 23}
{"loss": 0.45253804326057434, "acc": 0.7914062738418579, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3662993907928467, "acc": 0.8361725807189941, "length": 3.992072582244873, "mode": "train", "epoch": 24}
{"loss": 0.4400789737701416, "acc": 0.7886719107627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.36588671803474426, "acc": 0.8346109986305237, "length": 3.9933958053588867, "mode": "train", "epoch": 25}
{"loss": 0.44042670726776123, "acc": 0.8048829436302185, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.36117592453956604, "acc": 0.8381512761116028, "length": 3.995465040206909, "mode": "train", "epoch": 26}
{"loss": 0.44474172592163086, "acc": 0.8042969107627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3618943393230438, "acc": 0.8382660150527954, "length": 3.9956257343292236, "mode": "train", "epoch": 27}
{"loss": 0.4300486147403717, "acc": 0.8103517293930054, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.35641050338745117, "acc": 0.8430404663085938, "length": 3.9961252212524414, "mode": "train", "epoch": 28}
{"loss": 0.4300265908241272, "acc": 0.8107422590255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3485150933265686, "acc": 0.85027676820755, "length": 3.995778799057007, "mode": "train", "epoch": 29}
{"loss": 0.4311087131500244, "acc": 0.8025389909744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3477005362510681, "acc": 0.8477803468704224, "length": 3.9966397285461426, "mode": "train", "epoch": 30}
{"loss": 0.4092259407043457, "acc": 0.8011718988418579, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.34489503502845764, "acc": 0.8508908748626709, "length": 3.996622323989868, "mode": "train", "epoch": 31}
{"loss": 0.4168544411659241, "acc": 0.8181639909744263, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3410136103630066, "acc": 0.8515318036079407, "length": 3.9958605766296387, "mode": "train", "epoch": 32}
{"loss": 0.4006192684173584, "acc": 0.8121094107627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3382839858531952, "acc": 0.8541227579116821, "length": 3.9969241619110107, "mode": "train", "epoch": 33}
{"loss": 0.37718671560287476, "acc": 0.8189453482627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.33184385299682617, "acc": 0.8611836433410645, "length": 3.995992660522461, "mode": "train", "epoch": 34}
{"loss": 0.3843066692352295, "acc": 0.8218750357627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.329402357339859, "acc": 0.8579526543617249, "length": 3.993805170059204, "mode": "train", "epoch": 35}
{"loss": 0.374582976102829, "acc": 0.8279296159744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.3269982933998108, "acc": 0.8575170636177063, "length": 3.997684955596924, "mode": "train", "epoch": 36}
{"loss": 0.37365975975990295, "acc": 0.8294921517372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.32495424151420593, "acc": 0.8585485219955444, "length": 3.9969680309295654, "mode": "train", "epoch": 37}
{"loss": 0.3709724545478821, "acc": 0.8294921517372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.32438454031944275, "acc": 0.8595341444015503, "length": 3.9978809356689453, "mode": "train", "epoch": 38}
{"loss": 0.36783134937286377, "acc": 0.8310546278953552, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.3201351761817932, "acc": 0.8607562780380249, "length": 3.997814893722534, "mode": "train", "epoch": 39}
{"loss": 0.35921287536621094, "acc": 0.8357421159744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.32050618529319763, "acc": 0.8621588945388794, "length": 3.9980876445770264, "mode": "train", "epoch": 40}
{"loss": 0.37149515748023987, "acc": 0.8333984613418579, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.3196437656879425, "acc": 0.8570200800895691, "length": 3.997790575027466, "mode": "train", "epoch": 41}
{"loss": 0.36745715141296387, "acc": 0.8355469107627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.313311368227005, "acc": 0.8628426790237427, "length": 3.9983713626861572, "mode": "train", "epoch": 42}
{"loss": 0.35450175404548645, "acc": 0.8416014909744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.3122389316558838, "acc": 0.8609451055526733, "length": 3.998405694961548, "mode": "train", "epoch": 43}
{"loss": 0.3687705993652344, "acc": 0.8314452767372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.3143516182899475, "acc": 0.862390398979187, "length": 3.9987125396728516, "mode": "train", "epoch": 44}
{"loss": 0.35433557629585266, "acc": 0.8421875238418579, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.3077341616153717, "acc": 0.8639287352561951, "length": 3.9980690479278564, "mode": "train", "epoch": 45}
{"loss": 0.35999661684036255, "acc": 0.8375000357627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.30693861842155457, "acc": 0.8626717925071716, "length": 3.9984328746795654, "mode": "train", "epoch": 46}
{"loss": 0.3506619930267334, "acc": 0.8431640267372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.30387017130851746, "acc": 0.865656852722168, "length": 3.9977407455444336, "mode": "train", "epoch": 47}
{"loss": 0.34800878167152405, "acc": 0.8406249284744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.3023240268230438, "acc": 0.8681482076644897, "length": 3.998878002166748, "mode": "train", "epoch": 48}
{"loss": 0.33996015787124634, "acc": 0.8458985090255737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.29805848002433777, "acc": 0.8712252974510193, "length": 3.997992992401123, "mode": "train", "epoch": 49}
{"loss": 0.3449774980545044, "acc": 0.8468750715255737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2913845181465149, "acc": 0.8734471797943115, "length": 3.998807430267334, "mode": "train", "epoch": 50}
{"loss": 0.3291759490966797, "acc": 0.8468751311302185, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2942327857017517, "acc": 0.870796799659729, "length": 3.9987761974334717, "mode": "train", "epoch": 51}
{"loss": 0.32950687408447266, "acc": 0.8478516936302185, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.28435176610946655, "acc": 0.8766303062438965, "length": 3.9974708557128906, "mode": "train", "epoch": 52}
{"loss": 0.3154502511024475, "acc": 0.8531250357627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2756727337837219, "acc": 0.880862295627594, "length": 3.9986963272094727, "mode": "train", "epoch": 53}
{"loss": 0.30656155943870544, "acc": 0.8621093034744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.27500107884407043, "acc": 0.8839768171310425, "length": 3.997478485107422, "mode": "train", "epoch": 54}
{"loss": 0.29983970522880554, "acc": 0.8751954436302185, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2671539783477783, "acc": 0.8890436887741089, "length": 3.9992165565490723, "mode": "train", "epoch": 55}
{"loss": 0.2948530912399292, "acc": 0.8732422590255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2629535496234894, "acc": 0.8907442092895508, "length": 3.996584892272949, "mode": "train", "epoch": 56}
{"loss": 0.2851216197013855, "acc": 0.8710938096046448, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.25519850850105286, "acc": 0.8916419744491577, "length": 3.9995195865631104, "mode": "train", "epoch": 57}
{"loss": 0.28073474764823914, "acc": 0.8736327886581421, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2566480040550232, "acc": 0.8906686305999756, "length": 3.99813175201416, "mode": "train", "epoch": 58}
{"loss": 0.2811392545700073, "acc": 0.8693360090255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.24911710619926453, "acc": 0.8922547101974487, "length": 3.9989306926727295, "mode": "train", "epoch": 59}
{"loss": 0.2817932367324829, "acc": 0.8726562857627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.24570679664611816, "acc": 0.8936559557914734, "length": 3.9995200634002686, "mode": "train", "epoch": 60}
{"loss": 0.277091383934021, "acc": 0.876953125, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8123213648796082
