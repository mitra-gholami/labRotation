ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6890161633491516, "acc": 0.5268006920814514, "length": 3.501786947250366, "mode": "train", "epoch": 1}
{"loss": 0.6852196455001831, "acc": 0.5492278933525085, "length": 1.3125, "mode": "test", "epoch": 1}
{"loss": 0.6880512237548828, "acc": 0.5452977418899536, "length": 3.4165148735046387, "mode": "train", "epoch": 2}
{"loss": 0.6598387956619263, "acc": 0.6459320187568665, "length": 3.0859375, "mode": "test", "epoch": 2}
{"loss": 0.6592453718185425, "acc": 0.5986471176147461, "length": 3.4296886920928955, "mode": "train", "epoch": 3}
{"loss": 0.5976477265357971, "acc": 0.7232422232627869, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.561248779296875, "acc": 0.725461483001709, "length": 3.7932193279266357, "mode": "train", "epoch": 4}
{"loss": 0.5350960493087769, "acc": 0.7328124642372131, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4913645088672638, "acc": 0.7613392472267151, "length": 3.9281651973724365, "mode": "train", "epoch": 5}
{"loss": 0.49850034713745117, "acc": 0.7666015625, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.45283305644989014, "acc": 0.8047918081283569, "length": 3.9171836376190186, "mode": "train", "epoch": 6}
{"loss": 0.4727133512496948, "acc": 0.8035154938697815, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4132838845252991, "acc": 0.8321235179901123, "length": 3.9568161964416504, "mode": "train", "epoch": 7}
{"loss": 0.43457186222076416, "acc": 0.7984375357627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3730572462081909, "acc": 0.8371321558952332, "length": 3.9655139446258545, "mode": "train", "epoch": 8}
{"loss": 0.42708998918533325, "acc": 0.81640625, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.34518182277679443, "acc": 0.8521592617034912, "length": 3.978177785873413, "mode": "train", "epoch": 9}
{"loss": 0.3977316617965698, "acc": 0.8257812857627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3385162949562073, "acc": 0.865199625492096, "length": 3.984571695327759, "mode": "train", "epoch": 10}
{"loss": 0.3992522358894348, "acc": 0.8408203125, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.32040607929229736, "acc": 0.8659709095954895, "length": 3.9869425296783447, "mode": "train", "epoch": 11}
{"loss": 0.3769688904285431, "acc": 0.8429688215255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2958779036998749, "acc": 0.8780401349067688, "length": 3.990530014038086, "mode": "train", "epoch": 12}
{"loss": 0.38643592596054077, "acc": 0.8423828482627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3094751238822937, "acc": 0.8760991096496582, "length": 3.991732597351074, "mode": "train", "epoch": 13}
{"loss": 0.3888291120529175, "acc": 0.8318358659744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.29693159461021423, "acc": 0.8728917241096497, "length": 3.992957353591919, "mode": "train", "epoch": 14}
{"loss": 0.3848026394844055, "acc": 0.8503904938697815, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.28980132937431335, "acc": 0.8797573447227478, "length": 3.9937429428100586, "mode": "train", "epoch": 15}
{"loss": 0.41748112440109253, "acc": 0.8289061188697815, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3038744032382965, "acc": 0.877934992313385, "length": 3.9943878650665283, "mode": "train", "epoch": 16}
{"loss": 0.37237992882728577, "acc": 0.845703125, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.30795419216156006, "acc": 0.8828521370887756, "length": 3.996037483215332, "mode": "train", "epoch": 17}
{"loss": 0.37235724925994873, "acc": 0.8576172590255737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2796732187271118, "acc": 0.8843110203742981, "length": 3.9965150356292725, "mode": "train", "epoch": 18}
{"loss": 0.3699229955673218, "acc": 0.8511719107627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.26400816440582275, "acc": 0.885430097579956, "length": 3.996690034866333, "mode": "train", "epoch": 19}
{"loss": 0.37348946928977966, "acc": 0.8656249642372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2763635516166687, "acc": 0.8899962306022644, "length": 3.9972903728485107, "mode": "train", "epoch": 20}
{"loss": 0.37658002972602844, "acc": 0.8595703840255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2476380616426468, "acc": 0.8918914794921875, "length": 3.997349262237549, "mode": "train", "epoch": 21}
{"loss": 0.37574177980422974, "acc": 0.8564453125, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.25779828429222107, "acc": 0.8958438634872437, "length": 3.997938632965088, "mode": "train", "epoch": 22}
{"loss": 0.3650552034378052, "acc": 0.8595703840255737, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.24474287033081055, "acc": 0.8908370733261108, "length": 3.9979074001312256, "mode": "train", "epoch": 23}
{"loss": 0.36063337326049805, "acc": 0.8527344465255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.23713313043117523, "acc": 0.900290846824646, "length": 3.997767686843872, "mode": "train", "epoch": 24}
{"loss": 0.36540764570236206, "acc": 0.8568359017372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2541755437850952, "acc": 0.8955221772193909, "length": 3.998394012451172, "mode": "train", "epoch": 25}
{"loss": 0.37363067269325256, "acc": 0.8607421517372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2434794157743454, "acc": 0.89285808801651, "length": 3.998600721359253, "mode": "train", "epoch": 26}
{"loss": 0.36275675892829895, "acc": 0.8666015267372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.26193174719810486, "acc": 0.9025325179100037, "length": 3.9985294342041016, "mode": "train", "epoch": 27}
{"loss": 0.33826884627342224, "acc": 0.8615235090255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.24789902567863464, "acc": 0.9036986231803894, "length": 3.998732328414917, "mode": "train", "epoch": 28}
{"loss": 0.3341497480869293, "acc": 0.8623046278953552, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.22935526072978973, "acc": 0.9048667550086975, "length": 3.9985079765319824, "mode": "train", "epoch": 29}
{"loss": 0.330394983291626, "acc": 0.8677734732627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2205507755279541, "acc": 0.9054303765296936, "length": 3.9988839626312256, "mode": "train", "epoch": 30}
{"loss": 0.310109406709671, "acc": 0.8742188215255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.21370454132556915, "acc": 0.9087706208229065, "length": 3.9990272521972656, "mode": "train", "epoch": 31}
{"loss": 0.31302714347839355, "acc": 0.8658203482627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.20922143757343292, "acc": 0.9072578549385071, "length": 3.998596429824829, "mode": "train", "epoch": 32}
{"loss": 0.3121369481086731, "acc": 0.8832030892372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.21771422028541565, "acc": 0.9122782945632935, "length": 3.9991872310638428, "mode": "train", "epoch": 33}
{"loss": 0.2987198233604431, "acc": 0.8833984732627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.21926569938659668, "acc": 0.9101085662841797, "length": 3.9992570877075195, "mode": "train", "epoch": 34}
{"loss": 0.32123538851737976, "acc": 0.8716796636581421, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21289387345314026, "acc": 0.9106646776199341, "length": 3.999201536178589, "mode": "train", "epoch": 35}
{"loss": 0.3093034625053406, "acc": 0.8869141340255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.20007172226905823, "acc": 0.9112221598625183, "length": 3.9991860389709473, "mode": "train", "epoch": 36}
{"loss": 0.2887426018714905, "acc": 0.8949218392372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1974823921918869, "acc": 0.9176209568977356, "length": 3.9993748664855957, "mode": "train", "epoch": 37}
{"loss": 0.3110254108905792, "acc": 0.8861327767372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.22172531485557556, "acc": 0.9180094599723816, "length": 3.9992425441741943, "mode": "train", "epoch": 38}
{"loss": 0.2854643762111664, "acc": 0.8921874761581421, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2077612578868866, "acc": 0.918508768081665, "length": 3.999241352081299, "mode": "train", "epoch": 39}
{"loss": 0.2717260420322418, "acc": 0.89453125, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2037462592124939, "acc": 0.9154501557350159, "length": 3.9992635250091553, "mode": "train", "epoch": 40}
{"loss": 0.2657625377178192, "acc": 0.8917969465255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.20414386689662933, "acc": 0.9208412170410156, "length": 3.9992709159851074, "mode": "train", "epoch": 41}
{"loss": 0.26732680201530457, "acc": 0.8974608778953552, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.20321018993854523, "acc": 0.9208351373672485, "length": 3.998544454574585, "mode": "train", "epoch": 42}
{"loss": 0.271217405796051, "acc": 0.8876953125, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.19609740376472473, "acc": 0.9151641726493835, "length": 3.998887300491333, "mode": "train", "epoch": 43}
{"loss": 0.24965575337409973, "acc": 0.9046874642372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.18967509269714355, "acc": 0.9260685443878174, "length": 3.9991774559020996, "mode": "train", "epoch": 44}
{"loss": 0.24436944723129272, "acc": 0.9105468392372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.18600040674209595, "acc": 0.928516685962677, "length": 3.9991657733917236, "mode": "train", "epoch": 45}
{"loss": 0.24118945002555847, "acc": 0.9058594703674316, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1696186065673828, "acc": 0.9303950667381287, "length": 3.998600721359253, "mode": "train", "epoch": 46}
{"loss": 0.24726474285125732, "acc": 0.9027343392372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1701446920633316, "acc": 0.9346862435340881, "length": 3.999077796936035, "mode": "train", "epoch": 47}
{"loss": 0.2473706305027008, "acc": 0.904296875, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.16618485748767853, "acc": 0.933808445930481, "length": 3.9994328022003174, "mode": "train", "epoch": 48}
{"loss": 0.24046596884727478, "acc": 0.9035156965255737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.15638771653175354, "acc": 0.9348081350326538, "length": 3.999455451965332, "mode": "train", "epoch": 49}
{"loss": 0.22726872563362122, "acc": 0.9205078482627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1591058373451233, "acc": 0.9414169788360596, "length": 3.999267578125, "mode": "train", "epoch": 50}
{"loss": 0.22389820218086243, "acc": 0.9132810831069946, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.15707138180732727, "acc": 0.9360896348953247, "length": 3.999640941619873, "mode": "train", "epoch": 51}
{"loss": 0.21518874168395996, "acc": 0.9207030534744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.18986842036247253, "acc": 0.938255786895752, "length": 3.9994101524353027, "mode": "train", "epoch": 52}
{"loss": 0.21055224537849426, "acc": 0.9189453125, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.18275021016597748, "acc": 0.9262464642524719, "length": 3.9996821880340576, "mode": "train", "epoch": 53}
{"loss": 0.2232297658920288, "acc": 0.9152345061302185, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.16360816359519958, "acc": 0.937758207321167, "length": 3.9996166229248047, "mode": "train", "epoch": 54}
{"loss": 0.2310185730457306, "acc": 0.9105468392372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1462014615535736, "acc": 0.9399842023849487, "length": 3.9996964931488037, "mode": "train", "epoch": 55}
{"loss": 0.20146241784095764, "acc": 0.9207030534744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.14002524316310883, "acc": 0.9475483894348145, "length": 3.9997212886810303, "mode": "train", "epoch": 56}
{"loss": 0.203994020819664, "acc": 0.9207030534744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.13539859652519226, "acc": 0.9494380354881287, "length": 3.9997243881225586, "mode": "train", "epoch": 57}
{"loss": 0.21075570583343506, "acc": 0.9109374284744263, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.12440244853496552, "acc": 0.952052116394043, "length": 3.999699115753174, "mode": "train", "epoch": 58}
{"loss": 0.17749227583408356, "acc": 0.9310546517372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.12470857799053192, "acc": 0.9546121954917908, "length": 3.999791383743286, "mode": "train", "epoch": 59}
{"loss": 0.1898801475763321, "acc": 0.9308594465255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.12851856648921967, "acc": 0.9527778029441833, "length": 3.9998159408569336, "mode": "train", "epoch": 60}
{"loss": 0.20657044649124146, "acc": 0.9386719465255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7727083563804626
