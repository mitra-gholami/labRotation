ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6948957443237305, "acc": 0.5134066939353943, "length": 3.524617910385132, "mode": "train", "epoch": 1}
{"loss": 0.6725823283195496, "acc": 0.5865505337715149, "length": 2.6666667461395264, "mode": "test", "epoch": 1}
{"loss": 0.6767407059669495, "acc": 0.5775966048240662, "length": 3.3654000759124756, "mode": "train", "epoch": 2}
{"loss": 0.6312181353569031, "acc": 0.6809786558151245, "length": 3.5625, "mode": "test", "epoch": 2}
{"loss": 0.5993965864181519, "acc": 0.707019031047821, "length": 3.6834263801574707, "mode": "train", "epoch": 3}
{"loss": 0.5328782200813293, "acc": 0.7638888955116272, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.49508073925971985, "acc": 0.7644349336624146, "length": 3.9460582733154297, "mode": "train", "epoch": 4}
{"loss": 0.4519658088684082, "acc": 0.7873263955116272, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4358038604259491, "acc": 0.7995041608810425, "length": 3.9812629222869873, "mode": "train", "epoch": 5}
{"loss": 0.4192139208316803, "acc": 0.8217014074325562, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.39585599303245544, "acc": 0.8204819560050964, "length": 3.9799652099609375, "mode": "train", "epoch": 6}
{"loss": 0.40737199783325195, "acc": 0.8309028148651123, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.37594082951545715, "acc": 0.8314738273620605, "length": 3.982558488845825, "mode": "train", "epoch": 7}
{"loss": 0.3884110748767853, "acc": 0.8434028029441833, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.35937604308128357, "acc": 0.8441923260688782, "length": 3.985844373703003, "mode": "train", "epoch": 8}
{"loss": 0.35435751080513, "acc": 0.8467013835906982, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3390364944934845, "acc": 0.8528978824615479, "length": 3.9947521686553955, "mode": "train", "epoch": 9}
{"loss": 0.3363061845302582, "acc": 0.8592013120651245, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.314957857131958, "acc": 0.8683651089668274, "length": 3.9913694858551025, "mode": "train", "epoch": 10}
{"loss": 0.30510762333869934, "acc": 0.8744791150093079, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.28893736004829407, "acc": 0.8803869485855103, "length": 3.99302077293396, "mode": "train", "epoch": 11}
{"loss": 0.27295705676078796, "acc": 0.8868055939674377, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.26350241899490356, "acc": 0.8898443579673767, "length": 3.993908405303955, "mode": "train", "epoch": 12}
{"loss": 0.26391518115997314, "acc": 0.8996527791023254, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.24599671363830566, "acc": 0.9006465077400208, "length": 3.9930338859558105, "mode": "train", "epoch": 13}
{"loss": 0.2344387322664261, "acc": 0.9104166030883789, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.235354945063591, "acc": 0.9047338962554932, "length": 3.996180534362793, "mode": "train", "epoch": 14}
{"loss": 0.22712016105651855, "acc": 0.9152777791023254, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.22373519837856293, "acc": 0.9134672284126282, "length": 3.998210906982422, "mode": "train", "epoch": 15}
{"loss": 0.22044971585273743, "acc": 0.9192708134651184, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.21380247175693512, "acc": 0.9159080386161804, "length": 3.9983131885528564, "mode": "train", "epoch": 16}
{"loss": 0.21024148166179657, "acc": 0.9213541746139526, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.20851066708564758, "acc": 0.9207319021224976, "length": 3.995779514312744, "mode": "train", "epoch": 17}
{"loss": 0.20959806442260742, "acc": 0.9208332896232605, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.19227051734924316, "acc": 0.9266635179519653, "length": 3.9987385272979736, "mode": "train", "epoch": 18}
{"loss": 0.20852530002593994, "acc": 0.9189236164093018, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.18335603177547455, "acc": 0.927405059337616, "length": 3.9975428581237793, "mode": "train", "epoch": 19}
{"loss": 0.18142452836036682, "acc": 0.9322916865348816, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.17371796071529388, "acc": 0.9322143197059631, "length": 3.998955726623535, "mode": "train", "epoch": 20}
{"loss": 0.18572741746902466, "acc": 0.933680534362793, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.17146269977092743, "acc": 0.9321739077568054, "length": 3.9976840019226074, "mode": "train", "epoch": 21}
{"loss": 0.18101273477077484, "acc": 0.933680534362793, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.16545651853084564, "acc": 0.9361817836761475, "length": 3.9966158866882324, "mode": "train", "epoch": 22}
{"loss": 0.18317386507987976, "acc": 0.9390624165534973, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.15368874371051788, "acc": 0.9381332993507385, "length": 3.9987926483154297, "mode": "train", "epoch": 23}
{"loss": 0.16882969439029694, "acc": 0.9442707896232605, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1621689796447754, "acc": 0.9396764636039734, "length": 3.9992403984069824, "mode": "train", "epoch": 24}
{"loss": 0.1832290142774582, "acc": 0.9314236044883728, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.14883391559123993, "acc": 0.9392635822296143, "length": 3.99898624420166, "mode": "train", "epoch": 25}
{"loss": 0.147311270236969, "acc": 0.9447916746139526, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.13957278430461884, "acc": 0.9467975497245789, "length": 3.999298334121704, "mode": "train", "epoch": 26}
{"loss": 0.1537514179944992, "acc": 0.9472222924232483, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.14033080637454987, "acc": 0.9450089931488037, "length": 3.999514579772949, "mode": "train", "epoch": 27}
{"loss": 0.15868838131427765, "acc": 0.949131965637207, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.13855600357055664, "acc": 0.9425995945930481, "length": 3.9989967346191406, "mode": "train", "epoch": 28}
{"loss": 0.14352284371852875, "acc": 0.953125, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.13237637281417847, "acc": 0.9489713907241821, "length": 3.9994845390319824, "mode": "train", "epoch": 29}
{"loss": 0.15116846561431885, "acc": 0.9539930820465088, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.127371147274971, "acc": 0.9515185952186584, "length": 3.9997622966766357, "mode": "train", "epoch": 30}
{"loss": 0.16425493359565735, "acc": 0.9442707896232605, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.13489526510238647, "acc": 0.9446919560432434, "length": 3.998288154602051, "mode": "train", "epoch": 31}
{"loss": 0.14843209087848663, "acc": 0.9480903148651123, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.12404375523328781, "acc": 0.9502099752426147, "length": 3.9993011951446533, "mode": "train", "epoch": 32}
{"loss": 0.1379219889640808, "acc": 0.9526041746139526, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1205468624830246, "acc": 0.9528798460960388, "length": 3.9998652935028076, "mode": "train", "epoch": 33}
{"loss": 0.1413336843252182, "acc": 0.9475691914558411, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.11558517068624496, "acc": 0.9532752633094788, "length": 3.9998221397399902, "mode": "train", "epoch": 34}
{"loss": 0.1314135193824768, "acc": 0.9565972089767456, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.11559834331274033, "acc": 0.9525980353355408, "length": 3.9998929500579834, "mode": "train", "epoch": 35}
{"loss": 0.13066568970680237, "acc": 0.9562499523162842, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.11600466072559357, "acc": 0.9551405310630798, "length": 3.9993040561676025, "mode": "train", "epoch": 36}
{"loss": 0.12114527821540833, "acc": 0.9618054628372192, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.10624156147241592, "acc": 0.9614729881286621, "length": 3.999818801879883, "mode": "train", "epoch": 37}
{"loss": 0.1358335316181183, "acc": 0.9557291865348816, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.10154654830694199, "acc": 0.9618539810180664, "length": 3.9996378421783447, "mode": "train", "epoch": 38}
{"loss": 0.11653692275285721, "acc": 0.9595486521720886, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.09595207870006561, "acc": 0.9635010957717896, "length": 3.9996864795684814, "mode": "train", "epoch": 39}
{"loss": 0.1126047745347023, "acc": 0.9645833969116211, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.09416662156581879, "acc": 0.9653611779212952, "length": 3.9993889331817627, "mode": "train", "epoch": 40}
{"loss": 0.10256260633468628, "acc": 0.9659721851348877, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08731674402952194, "acc": 0.9673721790313721, "length": 3.9980289936065674, "mode": "train", "epoch": 41}
{"loss": 0.08470399677753448, "acc": 0.9739583134651184, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.08694281429052353, "acc": 0.9682040214538574, "length": 3.99979305267334, "mode": "train", "epoch": 42}
{"loss": 0.10583817213773727, "acc": 0.9675347208976746, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08883464336395264, "acc": 0.9681527614593506, "length": 3.9999001026153564, "mode": "train", "epoch": 43}
{"loss": 0.10214319825172424, "acc": 0.9666666388511658, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.0821688324213028, "acc": 0.9709224700927734, "length": 3.998711109161377, "mode": "train", "epoch": 44}
{"loss": 0.09706451743841171, "acc": 0.9725693464279175, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.08037508279085159, "acc": 0.9704097509384155, "length": 3.999842643737793, "mode": "train", "epoch": 45}
{"loss": 0.09990236163139343, "acc": 0.9717013835906982, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.08209452778100967, "acc": 0.9697609543800354, "length": 3.998769998550415, "mode": "train", "epoch": 46}
{"loss": 0.11028143763542175, "acc": 0.9701388478279114, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.08285023272037506, "acc": 0.9699336290359497, "length": 3.999596118927002, "mode": "train", "epoch": 47}
{"loss": 0.09680869430303574, "acc": 0.9704861044883728, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.07754572480916977, "acc": 0.971542477607727, "length": 3.9998581409454346, "mode": "train", "epoch": 48}
{"loss": 0.11173728108406067, "acc": 0.9697917103767395, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.07214491069316864, "acc": 0.973945140838623, "length": 3.9991841316223145, "mode": "train", "epoch": 49}
{"loss": 0.10262738168239594, "acc": 0.9729166030883789, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.07184922695159912, "acc": 0.9740898609161377, "length": 3.9998977184295654, "mode": "train", "epoch": 50}
{"loss": 0.10443758219480515, "acc": 0.9694443941116333, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.07472004741430283, "acc": 0.9722194671630859, "length": 3.9998419284820557, "mode": "train", "epoch": 51}
{"loss": 0.12050002068281174, "acc": 0.9638888835906982, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.07462433725595474, "acc": 0.974032461643219, "length": 3.999880075454712, "mode": "train", "epoch": 52}
{"loss": 0.10041962563991547, "acc": 0.971354067325592, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07211721688508987, "acc": 0.9746731519699097, "length": 3.998751163482666, "mode": "train", "epoch": 53}
{"loss": 0.09861794114112854, "acc": 0.9690972566604614, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07096759974956512, "acc": 0.9732449650764465, "length": 3.999955654144287, "mode": "train", "epoch": 54}
{"loss": 0.10931959003210068, "acc": 0.9699652194976807, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.07490148395299911, "acc": 0.9732359647750854, "length": 3.99967885017395, "mode": "train", "epoch": 55}
{"loss": 0.10736066102981567, "acc": 0.9713541865348816, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.0699479952454567, "acc": 0.9756098985671997, "length": 3.9998891353607178, "mode": "train", "epoch": 56}
{"loss": 0.10476711392402649, "acc": 0.9720485210418701, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.06906688958406448, "acc": 0.9753097891807556, "length": 3.997836112976074, "mode": "train", "epoch": 57}
{"loss": 0.10664724558591843, "acc": 0.964756965637207, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06364410370588303, "acc": 0.9771482944488525, "length": 3.999969959259033, "mode": "train", "epoch": 58}
{"loss": 0.10764479637145996, "acc": 0.9657986164093018, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.06825070083141327, "acc": 0.9758478999137878, "length": 3.9999899864196777, "mode": "train", "epoch": 59}
{"loss": 0.10816285014152527, "acc": 0.9699652791023254, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.07701418548822403, "acc": 0.9703866243362427, "length": 3.997258424758911, "mode": "train", "epoch": 60}
{"loss": 0.09708783775568008, "acc": 0.9663195013999939, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7823076844215393
