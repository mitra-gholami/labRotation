ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6937820315361023, "acc": 0.5209773182868958, "length": 3.4714179039001465, "mode": "train", "epoch": 1}
{"loss": 0.689261794090271, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6877320408821106, "acc": 0.5431986451148987, "length": 3.340747117996216, "mode": "train", "epoch": 2}
{"loss": 0.6903282999992371, "acc": 0.520703136920929, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6814917325973511, "acc": 0.5599488615989685, "length": 3.000096082687378, "mode": "train", "epoch": 3}
{"loss": 0.6733945608139038, "acc": 0.5674529671669006, "length": 1.73046875, "mode": "test", "epoch": 3}
{"loss": 0.6543660759925842, "acc": 0.6588670611381531, "length": 2.834900140762329, "mode": "train", "epoch": 4}
{"loss": 0.626907467842102, "acc": 0.7204833626747131, "length": 2.83203125, "mode": "test", "epoch": 4}
{"loss": 0.5972466468811035, "acc": 0.7210370302200317, "length": 2.900993585586548, "mode": "train", "epoch": 5}
{"loss": 0.5788847208023071, "acc": 0.7524718642234802, "length": 2.9140625, "mode": "test", "epoch": 5}
{"loss": 0.5325720906257629, "acc": 0.7618063688278198, "length": 2.972726583480835, "mode": "train", "epoch": 6}
{"loss": 0.5410201549530029, "acc": 0.768658459186554, "length": 2.984375, "mode": "test", "epoch": 6}
{"loss": 0.4815414547920227, "acc": 0.8009428977966309, "length": 3.0512115955352783, "mode": "train", "epoch": 7}
{"loss": 0.5264922380447388, "acc": 0.7595977783203125, "length": 3.16015625, "mode": "test", "epoch": 7}
{"loss": 0.4593091905117035, "acc": 0.8096893429756165, "length": 3.077796697616577, "mode": "train", "epoch": 8}
{"loss": 0.5072752237319946, "acc": 0.7777770757675171, "length": 3.01953125, "mode": "test", "epoch": 8}
{"loss": 0.44564396142959595, "acc": 0.8073219060897827, "length": 3.1531548500061035, "mode": "train", "epoch": 9}
{"loss": 0.5024151802062988, "acc": 0.7710877060890198, "length": 3.109375, "mode": "test", "epoch": 9}
{"loss": 0.43739691376686096, "acc": 0.8073286414146423, "length": 3.1573009490966797, "mode": "train", "epoch": 10}
{"loss": 0.4903765320777893, "acc": 0.7702332139015198, "length": 3.125, "mode": "test", "epoch": 10}
{"loss": 0.42932185530662537, "acc": 0.809730589389801, "length": 3.2118163108825684, "mode": "train", "epoch": 11}
{"loss": 0.4865390658378601, "acc": 0.7680206298828125, "length": 3.19140625, "mode": "test", "epoch": 11}
{"loss": 0.4248385429382324, "acc": 0.8084489107131958, "length": 3.3174099922180176, "mode": "train", "epoch": 12}
{"loss": 0.4705568850040436, "acc": 0.7791563868522644, "length": 3.58984375, "mode": "test", "epoch": 12}
{"loss": 0.4172741770744324, "acc": 0.8076573014259338, "length": 3.5330896377563477, "mode": "train", "epoch": 13}
{"loss": 0.47094863653182983, "acc": 0.7781738042831421, "length": 3.71875, "mode": "test", "epoch": 13}
{"loss": 0.41387128829956055, "acc": 0.8084161877632141, "length": 3.6357576847076416, "mode": "train", "epoch": 14}
{"loss": 0.47705078125, "acc": 0.7811798453330994, "length": 3.7734375, "mode": "test", "epoch": 14}
{"loss": 0.40536290407180786, "acc": 0.8124737739562988, "length": 3.6241302490234375, "mode": "train", "epoch": 15}
{"loss": 0.4614698886871338, "acc": 0.7812041640281677, "length": 3.81640625, "mode": "test", "epoch": 15}
{"loss": 0.3998686671257019, "acc": 0.8093919157981873, "length": 3.6281533241271973, "mode": "train", "epoch": 16}
{"loss": 0.4549110531806946, "acc": 0.7767578363418579, "length": 3.6875, "mode": "test", "epoch": 16}
{"loss": 0.395628422498703, "acc": 0.8083127737045288, "length": 3.6501009464263916, "mode": "train", "epoch": 17}
{"loss": 0.45259714126586914, "acc": 0.778839111328125, "length": 3.6875, "mode": "test", "epoch": 17}
{"loss": 0.38753730058670044, "acc": 0.8150115609169006, "length": 3.6286990642547607, "mode": "train", "epoch": 18}
{"loss": 0.451345831155777, "acc": 0.7802215218544006, "length": 3.671875, "mode": "test", "epoch": 18}
{"loss": 0.38364335894584656, "acc": 0.8106508255004883, "length": 3.667891263961792, "mode": "train", "epoch": 19}
{"loss": 0.44784992933273315, "acc": 0.7801605463027954, "length": 3.82421875, "mode": "test", "epoch": 19}
{"loss": 0.37566304206848145, "acc": 0.8159569501876831, "length": 3.663494110107422, "mode": "train", "epoch": 20}
{"loss": 0.4355993866920471, "acc": 0.7849853038787842, "length": 3.62890625, "mode": "test", "epoch": 20}
{"loss": 0.36883869767189026, "acc": 0.8183454275131226, "length": 3.661212682723999, "mode": "train", "epoch": 21}
{"loss": 0.4339871406555176, "acc": 0.7809509038925171, "length": 3.765625, "mode": "test", "epoch": 21}
{"loss": 0.35964542627334595, "acc": 0.8237135410308838, "length": 3.7159063816070557, "mode": "train", "epoch": 22}
{"loss": 0.4160228967666626, "acc": 0.7897308468818665, "length": 3.73828125, "mode": "test", "epoch": 22}
{"loss": 0.3556270897388458, "acc": 0.823449432849884, "length": 3.7562613487243652, "mode": "train", "epoch": 23}
{"loss": 0.3970944285392761, "acc": 0.7982054948806763, "length": 3.72265625, "mode": "test", "epoch": 23}
{"loss": 0.3471725285053253, "acc": 0.8300327062606812, "length": 3.7262375354766846, "mode": "train", "epoch": 24}
{"loss": 0.3896198272705078, "acc": 0.799029529094696, "length": 3.82421875, "mode": "test", "epoch": 24}
{"loss": 0.3339069187641144, "acc": 0.8396075367927551, "length": 3.7529613971710205, "mode": "train", "epoch": 25}
{"loss": 0.3711152970790863, "acc": 0.8170044422149658, "length": 3.7578125, "mode": "test", "epoch": 25}
{"loss": 0.3228612542152405, "acc": 0.8462718725204468, "length": 3.7854158878326416, "mode": "train", "epoch": 26}
{"loss": 0.35845205187797546, "acc": 0.8318420648574829, "length": 3.79296875, "mode": "test", "epoch": 26}
{"loss": 0.30476516485214233, "acc": 0.8644912242889404, "length": 3.7441506385803223, "mode": "train", "epoch": 27}
{"loss": 0.3427836298942566, "acc": 0.8463531136512756, "length": 3.74609375, "mode": "test", "epoch": 27}
{"loss": 0.29764753580093384, "acc": 0.8651612401008606, "length": 3.7778701782226562, "mode": "train", "epoch": 28}
{"loss": 0.33121156692504883, "acc": 0.8516082763671875, "length": 3.7421875, "mode": "test", "epoch": 28}
{"loss": 0.2834553122520447, "acc": 0.8739702701568604, "length": 3.7740790843963623, "mode": "train", "epoch": 29}
{"loss": 0.31483548879623413, "acc": 0.858199954032898, "length": 3.78515625, "mode": "test", "epoch": 29}
{"loss": 0.2731238901615143, "acc": 0.8837428092956543, "length": 3.768578052520752, "mode": "train", "epoch": 30}
{"loss": 0.31026098132133484, "acc": 0.8676666617393494, "length": 3.78125, "mode": "test", "epoch": 30}
{"loss": 0.2661811411380768, "acc": 0.8865178227424622, "length": 3.7705962657928467, "mode": "train", "epoch": 31}
{"loss": 0.30831968784332275, "acc": 0.86737060546875, "length": 3.75, "mode": "test", "epoch": 31}
{"loss": 0.2583273947238922, "acc": 0.8891251087188721, "length": 3.768307685852051, "mode": "train", "epoch": 32}
{"loss": 0.29953134059906006, "acc": 0.8773406744003296, "length": 3.765625, "mode": "test", "epoch": 32}
{"loss": 0.25609397888183594, "acc": 0.8936622738838196, "length": 3.783447504043579, "mode": "train", "epoch": 33}
{"loss": 0.28700581192970276, "acc": 0.8830932974815369, "length": 3.7890625, "mode": "test", "epoch": 33}
{"loss": 0.25293901562690735, "acc": 0.8948202133178711, "length": 3.787254571914673, "mode": "train", "epoch": 34}
{"loss": 0.28367581963539124, "acc": 0.8875396847724915, "length": 3.77734375, "mode": "test", "epoch": 34}
{"loss": 0.24360907077789307, "acc": 0.8973618149757385, "length": 3.7886850833892822, "mode": "train", "epoch": 35}
{"loss": 0.28428858518600464, "acc": 0.8865996599197388, "length": 3.875, "mode": "test", "epoch": 35}
{"loss": 0.23954088985919952, "acc": 0.9055350422859192, "length": 3.8096776008605957, "mode": "train", "epoch": 36}
{"loss": 0.2781375050544739, "acc": 0.8853821754455566, "length": 3.76953125, "mode": "test", "epoch": 36}
{"loss": 0.2363712340593338, "acc": 0.90057772397995, "length": 3.7711386680603027, "mode": "train", "epoch": 37}
{"loss": 0.2755775451660156, "acc": 0.890167236328125, "length": 3.80859375, "mode": "test", "epoch": 37}
{"loss": 0.23357243835926056, "acc": 0.9027941823005676, "length": 3.790623188018799, "mode": "train", "epoch": 38}
{"loss": 0.26827341318130493, "acc": 0.8984770774841309, "length": 3.7890625, "mode": "test", "epoch": 38}
{"loss": 0.2292158156633377, "acc": 0.9037781357765198, "length": 3.7692806720733643, "mode": "train", "epoch": 39}
{"loss": 0.2800271809101105, "acc": 0.8793700337409973, "length": 3.80859375, "mode": "test", "epoch": 39}
{"loss": 0.22321829199790955, "acc": 0.9081140160560608, "length": 3.7892630100250244, "mode": "train", "epoch": 40}
{"loss": 0.2548809349536896, "acc": 0.900177001953125, "length": 3.8125, "mode": "test", "epoch": 40}
{"loss": 0.22420334815979004, "acc": 0.9061359763145447, "length": 3.7869436740875244, "mode": "train", "epoch": 41}
{"loss": 0.26406317949295044, "acc": 0.8939636945724487, "length": 3.76953125, "mode": "test", "epoch": 41}
{"loss": 0.22578510642051697, "acc": 0.9055296778678894, "length": 3.7826943397521973, "mode": "train", "epoch": 42}
{"loss": 0.27321335673332214, "acc": 0.8952880501747131, "length": 3.85546875, "mode": "test", "epoch": 42}
{"loss": 0.2188689410686493, "acc": 0.9061368107795715, "length": 3.8137450218200684, "mode": "train", "epoch": 43}
{"loss": 0.25435054302215576, "acc": 0.8973875641822815, "length": 3.80859375, "mode": "test", "epoch": 43}
{"loss": 0.2112884223461151, "acc": 0.9120293259620667, "length": 3.7816050052642822, "mode": "train", "epoch": 44}
{"loss": 0.2584392726421356, "acc": 0.899078369140625, "length": 3.8359375, "mode": "test", "epoch": 44}
{"loss": 0.20982439815998077, "acc": 0.9143798351287842, "length": 3.8543787002563477, "mode": "train", "epoch": 45}
{"loss": 0.2520303726196289, "acc": 0.9059234857559204, "length": 3.8515625, "mode": "test", "epoch": 45}
{"loss": 0.2115032821893692, "acc": 0.9132824540138245, "length": 3.832935333251953, "mode": "train", "epoch": 46}
{"loss": 0.254644513130188, "acc": 0.9042022824287415, "length": 3.83984375, "mode": "test", "epoch": 46}
{"loss": 0.20368541777133942, "acc": 0.918231725692749, "length": 3.824066162109375, "mode": "train", "epoch": 47}
{"loss": 0.24946781992912292, "acc": 0.907214343547821, "length": 3.88671875, "mode": "test", "epoch": 47}
{"loss": 0.20052985846996307, "acc": 0.9196564555168152, "length": 3.8674285411834717, "mode": "train", "epoch": 48}
{"loss": 0.2571547031402588, "acc": 0.906097412109375, "length": 3.875, "mode": "test", "epoch": 48}
{"loss": 0.19880829751491547, "acc": 0.9210602641105652, "length": 3.8222103118896484, "mode": "train", "epoch": 49}
{"loss": 0.2553331255912781, "acc": 0.9082214832305908, "length": 3.81640625, "mode": "test", "epoch": 49}
{"loss": 0.1961817592382431, "acc": 0.921727180480957, "length": 3.808603286743164, "mode": "train", "epoch": 50}
{"loss": 0.24615979194641113, "acc": 0.907794177532196, "length": 3.85546875, "mode": "test", "epoch": 50}
{"loss": 0.1927059441804886, "acc": 0.9250970482826233, "length": 3.8539137840270996, "mode": "train", "epoch": 51}
{"loss": 0.24937264621257782, "acc": 0.9063109159469604, "length": 3.8828125, "mode": "test", "epoch": 51}
{"loss": 0.18916770815849304, "acc": 0.926151692867279, "length": 3.8492770195007324, "mode": "train", "epoch": 52}
{"loss": 0.25650298595428467, "acc": 0.9093781113624573, "length": 3.8359375, "mode": "test", "epoch": 52}
{"loss": 0.1881115734577179, "acc": 0.9269284605979919, "length": 3.8465688228607178, "mode": "train", "epoch": 53}
{"loss": 0.24149490892887115, "acc": 0.9148772954940796, "length": 3.89453125, "mode": "test", "epoch": 53}
{"loss": 0.19028618931770325, "acc": 0.9246038794517517, "length": 3.876430034637451, "mode": "train", "epoch": 54}
{"loss": 0.2436230182647705, "acc": 0.9103423357009888, "length": 3.89453125, "mode": "test", "epoch": 54}
{"loss": 0.19534192979335785, "acc": 0.9189534783363342, "length": 3.8934097290039062, "mode": "train", "epoch": 55}
{"loss": 0.23927924036979675, "acc": 0.9073700308799744, "length": 3.84375, "mode": "test", "epoch": 55}
{"loss": 0.19033873081207275, "acc": 0.9243953824043274, "length": 3.8088483810424805, "mode": "train", "epoch": 56}
{"loss": 0.24147647619247437, "acc": 0.9108001589775085, "length": 3.8359375, "mode": "test", "epoch": 56}
{"loss": 0.18307903409004211, "acc": 0.9301156401634216, "length": 3.8575081825256348, "mode": "train", "epoch": 57}
{"loss": 0.23509365320205688, "acc": 0.9120635390281677, "length": 3.8984375, "mode": "test", "epoch": 57}
{"loss": 0.17592717707157135, "acc": 0.9304059147834778, "length": 3.8871922492980957, "mode": "train", "epoch": 58}
{"loss": 0.24599558115005493, "acc": 0.9092316627502441, "length": 3.89453125, "mode": "test", "epoch": 58}
{"loss": 0.17801345884799957, "acc": 0.9288608431816101, "length": 3.8577284812927246, "mode": "train", "epoch": 59}
{"loss": 0.2318468987941742, "acc": 0.9085784554481506, "length": 3.8359375, "mode": "test", "epoch": 59}
{"loss": 0.17229625582695007, "acc": 0.9311174750328064, "length": 3.851698875427246, "mode": "train", "epoch": 60}
{"loss": 0.2231607437133789, "acc": 0.915026843547821, "length": 3.8984375, "mode": "test", "epoch": 60}
test accuracy: 0.7427198886871338
