ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6938276886940002, "acc": 0.5282094478607178, "length": 3.4835190773010254, "mode": "train", "epoch": 1}
{"loss": 0.6907820701599121, "acc": 0.5277343392372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.684989869594574, "acc": 0.5548630952835083, "length": 3.0711917877197266, "mode": "train", "epoch": 2}
{"loss": 0.6718845367431641, "acc": 0.6204254031181335, "length": 1.85546875, "mode": "test", "epoch": 2}
{"loss": 0.6493442058563232, "acc": 0.6549730896949768, "length": 3.185819149017334, "mode": "train", "epoch": 3}
{"loss": 0.5922695994377136, "acc": 0.7526001930236816, "length": 3.70703125, "mode": "test", "epoch": 3}
{"loss": 0.546049952507019, "acc": 0.7655691504478455, "length": 3.7334694862365723, "mode": "train", "epoch": 4}
{"loss": 0.4923807382583618, "acc": 0.7810547351837158, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4565933644771576, "acc": 0.793565034866333, "length": 3.928429365158081, "mode": "train", "epoch": 5}
{"loss": 0.45459190011024475, "acc": 0.8083983659744263, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.41004717350006104, "acc": 0.8184238076210022, "length": 3.9544050693511963, "mode": "train", "epoch": 6}
{"loss": 0.4249791204929352, "acc": 0.81640625, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.37190815806388855, "acc": 0.8292111158370972, "length": 3.9631946086883545, "mode": "train", "epoch": 7}
{"loss": 0.40062496066093445, "acc": 0.8292969465255737, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.34594058990478516, "acc": 0.8440666794776917, "length": 3.978527545928955, "mode": "train", "epoch": 8}
{"loss": 0.36712443828582764, "acc": 0.8302735686302185, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3254593312740326, "acc": 0.8587612509727478, "length": 3.9879026412963867, "mode": "train", "epoch": 9}
{"loss": 0.3471216857433319, "acc": 0.8419922590255737, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.302408903837204, "acc": 0.867781400680542, "length": 3.9838998317718506, "mode": "train", "epoch": 10}
{"loss": 0.32726529240608215, "acc": 0.8541015982627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2782842814922333, "acc": 0.8783742785453796, "length": 3.9935669898986816, "mode": "train", "epoch": 11}
{"loss": 0.3054133653640747, "acc": 0.8664063215255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2636455297470093, "acc": 0.890950083732605, "length": 3.9952635765075684, "mode": "train", "epoch": 12}
{"loss": 0.28503334522247314, "acc": 0.8837890625, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.25421637296676636, "acc": 0.8959195017814636, "length": 3.9950246810913086, "mode": "train", "epoch": 13}
{"loss": 0.282737135887146, "acc": 0.8908203840255737, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.23734940588474274, "acc": 0.9031605124473572, "length": 3.994318962097168, "mode": "train", "epoch": 14}
{"loss": 0.26488354802131653, "acc": 0.8923827409744263, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.23239585757255554, "acc": 0.9033533334732056, "length": 3.9950642585754395, "mode": "train", "epoch": 15}
{"loss": 0.2782077491283417, "acc": 0.8955077528953552, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.23118597269058228, "acc": 0.8997771739959717, "length": 3.995776653289795, "mode": "train", "epoch": 16}
{"loss": 0.26004114747047424, "acc": 0.9039062857627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.22793054580688477, "acc": 0.9044458270072937, "length": 3.994570255279541, "mode": "train", "epoch": 17}
{"loss": 0.25154945254325867, "acc": 0.90625, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2146414816379547, "acc": 0.910119354724884, "length": 3.997267723083496, "mode": "train", "epoch": 18}
{"loss": 0.2506852447986603, "acc": 0.9000000357627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.21578191220760345, "acc": 0.9112522006034851, "length": 3.9984238147735596, "mode": "train", "epoch": 19}
{"loss": 0.2287236899137497, "acc": 0.912109375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.19438403844833374, "acc": 0.9225353598594666, "length": 3.9981493949890137, "mode": "train", "epoch": 20}
{"loss": 0.20895817875862122, "acc": 0.9269531965255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.19521990418434143, "acc": 0.9184115529060364, "length": 3.9986698627471924, "mode": "train", "epoch": 21}
{"loss": 0.19734622538089752, "acc": 0.9240235090255737, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.19055785238742828, "acc": 0.922538161277771, "length": 3.9985580444335938, "mode": "train", "epoch": 22}
{"loss": 0.1980263888835907, "acc": 0.9203124642372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.18608178198337555, "acc": 0.926844596862793, "length": 3.998685598373413, "mode": "train", "epoch": 23}
{"loss": 0.19950146973133087, "acc": 0.9232421517372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.17730237543582916, "acc": 0.9309247136116028, "length": 3.9990804195404053, "mode": "train", "epoch": 24}
{"loss": 0.18831409513950348, "acc": 0.9312500953674316, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.17489486932754517, "acc": 0.9299429059028625, "length": 3.997920036315918, "mode": "train", "epoch": 25}
{"loss": 0.1829245686531067, "acc": 0.9251952767372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.16403084993362427, "acc": 0.9340523481369019, "length": 3.9985082149505615, "mode": "train", "epoch": 26}
{"loss": 0.1692826896905899, "acc": 0.9318360090255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.16239000856876373, "acc": 0.9359647035598755, "length": 3.9970717430114746, "mode": "train", "epoch": 27}
{"loss": 0.15725962817668915, "acc": 0.9390625357627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.15782001614570618, "acc": 0.9397292733192444, "length": 3.9992313385009766, "mode": "train", "epoch": 28}
{"loss": 0.1790643036365509, "acc": 0.9296875, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.15801456570625305, "acc": 0.936389148235321, "length": 3.9993107318878174, "mode": "train", "epoch": 29}
{"loss": 0.16435465216636658, "acc": 0.9390625357627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1575472503900528, "acc": 0.9409451484680176, "length": 3.9995999336242676, "mode": "train", "epoch": 30}
{"loss": 0.17566049098968506, "acc": 0.9333983659744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.16304312646389008, "acc": 0.9364001154899597, "length": 3.9996395111083984, "mode": "train", "epoch": 31}
{"loss": 0.17260056734085083, "acc": 0.9306640625, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.167488232254982, "acc": 0.9333277344703674, "length": 3.998004913330078, "mode": "train", "epoch": 32}
{"loss": 0.1659255027770996, "acc": 0.9361328482627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.15091659128665924, "acc": 0.9407711029052734, "length": 3.9996113777160645, "mode": "train", "epoch": 33}
{"loss": 0.1444799304008484, "acc": 0.9439453482627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.14020150899887085, "acc": 0.9458053708076477, "length": 3.9995410442352295, "mode": "train", "epoch": 34}
{"loss": 0.13677243888378143, "acc": 0.9531250596046448, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.13662561774253845, "acc": 0.9455986618995667, "length": 3.9982008934020996, "mode": "train", "epoch": 35}
{"loss": 0.14834226667881012, "acc": 0.9423828721046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.13382384181022644, "acc": 0.9494504928588867, "length": 3.9998512268066406, "mode": "train", "epoch": 36}
{"loss": 0.1368100643157959, "acc": 0.9490233063697815, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.12700572609901428, "acc": 0.9569132328033447, "length": 3.999845266342163, "mode": "train", "epoch": 37}
{"loss": 0.1272052675485611, "acc": 0.9548827409744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.12596634030342102, "acc": 0.9558744430541992, "length": 3.999709367752075, "mode": "train", "epoch": 38}
{"loss": 0.12978677451610565, "acc": 0.9509764909744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.12485188990831375, "acc": 0.951755166053772, "length": 3.999875545501709, "mode": "train", "epoch": 39}
{"loss": 0.12592236697673798, "acc": 0.9558593034744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.12153978645801544, "acc": 0.9569646120071411, "length": 3.999368906021118, "mode": "train", "epoch": 40}
{"loss": 0.1290721893310547, "acc": 0.9531250596046448, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.12589050829410553, "acc": 0.9536358118057251, "length": 3.9996178150177, "mode": "train", "epoch": 41}
{"loss": 0.13125863671302795, "acc": 0.9503904581069946, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.11703555285930634, "acc": 0.9596373438835144, "length": 3.999567747116089, "mode": "train", "epoch": 42}
{"loss": 0.13247579336166382, "acc": 0.9560546875, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.11798422783613205, "acc": 0.9560657739639282, "length": 3.999936580657959, "mode": "train", "epoch": 43}
{"loss": 0.12225838750600815, "acc": 0.9630860090255737, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.11344069987535477, "acc": 0.9611024856567383, "length": 3.9999353885650635, "mode": "train", "epoch": 44}
{"loss": 0.11775747686624527, "acc": 0.9601563215255737, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.10581210255622864, "acc": 0.9615268111228943, "length": 3.999936580657959, "mode": "train", "epoch": 45}
{"loss": 0.11229482293128967, "acc": 0.9605469107627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.10715163499116898, "acc": 0.9617679119110107, "length": 3.999758005142212, "mode": "train", "epoch": 46}
{"loss": 0.12646782398223877, "acc": 0.9566406011581421, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.10881917923688889, "acc": 0.9624382853507996, "length": 3.9999635219573975, "mode": "train", "epoch": 47}
{"loss": 0.12724079191684723, "acc": 0.9601563215255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1110704094171524, "acc": 0.9612835049629211, "length": 3.9999377727508545, "mode": "train", "epoch": 48}
{"loss": 0.1185944452881813, "acc": 0.9613281488418579, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.09829945862293243, "acc": 0.9639545679092407, "length": 3.99994158744812, "mode": "train", "epoch": 49}
{"loss": 0.11349709331989288, "acc": 0.9603515267372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.10298196226358414, "acc": 0.9650471806526184, "length": 3.9999523162841797, "mode": "train", "epoch": 50}
{"loss": 0.13704803586006165, "acc": 0.9492186903953552, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.09808668494224548, "acc": 0.9618315696716309, "length": 3.9999120235443115, "mode": "train", "epoch": 51}
{"loss": 0.11846714466810226, "acc": 0.9595703482627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.10227552801370621, "acc": 0.9634084701538086, "length": 3.999974012374878, "mode": "train", "epoch": 52}
{"loss": 0.12860891222953796, "acc": 0.9619141221046448, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.09658411145210266, "acc": 0.9681423306465149, "length": 3.9999656677246094, "mode": "train", "epoch": 53}
{"loss": 0.12096384167671204, "acc": 0.9603515267372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.08965767174959183, "acc": 0.971297562122345, "length": 3.999974250793457, "mode": "train", "epoch": 54}
{"loss": 0.11308480054140091, "acc": 0.9626952409744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.08543499559164047, "acc": 0.9705086350440979, "length": 3.9999570846557617, "mode": "train", "epoch": 55}
{"loss": 0.11814294755458832, "acc": 0.9595703482627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.09120944887399673, "acc": 0.9686864614486694, "length": 3.999887466430664, "mode": "train", "epoch": 56}
{"loss": 0.10485240817070007, "acc": 0.9634765982627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.08736404031515121, "acc": 0.9694030284881592, "length": 3.9995946884155273, "mode": "train", "epoch": 57}
{"loss": 0.12373349070549011, "acc": 0.9572266340255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.08917245268821716, "acc": 0.9674753546714783, "length": 3.9999802112579346, "mode": "train", "epoch": 58}
{"loss": 0.12100648134946823, "acc": 0.9548827409744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09335099905729294, "acc": 0.9699434638023376, "length": 3.999511241912842, "mode": "train", "epoch": 59}
{"loss": 0.11591996997594833, "acc": 0.9623046517372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.08906739205121994, "acc": 0.9714177846908569, "length": 3.999959707260132, "mode": "train", "epoch": 60}
{"loss": 0.11158095300197601, "acc": 0.9605469107627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8733822703361511
