ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6964191198348999, "acc": 0.5180566310882568, "length": 3.1155786514282227, "mode": "train", "epoch": 1}
{"loss": 0.6914246082305908, "acc": 0.535351574420929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6561369299888611, "acc": 0.6287035942077637, "length": 2.367602825164795, "mode": "train", "epoch": 2}
{"loss": 0.5955222845077515, "acc": 0.7210266590118408, "length": 2.453125, "mode": "test", "epoch": 2}
{"loss": 0.5664590001106262, "acc": 0.7260444760322571, "length": 2.462273597717285, "mode": "train", "epoch": 3}
{"loss": 0.5385401844978333, "acc": 0.7569457292556763, "length": 2.78125, "mode": "test", "epoch": 3}
{"loss": 0.49869319796562195, "acc": 0.7804539799690247, "length": 2.805462121963501, "mode": "train", "epoch": 4}
{"loss": 0.48325204849243164, "acc": 0.7829529047012329, "length": 2.9453125, "mode": "test", "epoch": 4}
{"loss": 0.43285518884658813, "acc": 0.8094420433044434, "length": 3.0401418209075928, "mode": "train", "epoch": 5}
{"loss": 0.4410306513309479, "acc": 0.8092041611671448, "length": 3.3671875, "mode": "test", "epoch": 5}
{"loss": 0.3735675513744354, "acc": 0.8411552309989929, "length": 3.4188435077667236, "mode": "train", "epoch": 6}
{"loss": 0.4328591823577881, "acc": 0.8252868056297302, "length": 3.63671875, "mode": "test", "epoch": 6}
{"loss": 0.33432766795158386, "acc": 0.8576787114143372, "length": 3.5288236141204834, "mode": "train", "epoch": 7}
{"loss": 0.4301334023475647, "acc": 0.8184692859649658, "length": 3.63671875, "mode": "test", "epoch": 7}
{"loss": 0.30906587839126587, "acc": 0.8732366561889648, "length": 3.564317464828491, "mode": "train", "epoch": 8}
{"loss": 0.3884165585041046, "acc": 0.8372009992599487, "length": 3.6640625, "mode": "test", "epoch": 8}
{"loss": 0.2782858610153198, "acc": 0.8867801427841187, "length": 3.6018173694610596, "mode": "train", "epoch": 9}
{"loss": 0.37054264545440674, "acc": 0.8425659537315369, "length": 3.78515625, "mode": "test", "epoch": 9}
{"loss": 0.2603752613067627, "acc": 0.8959680795669556, "length": 3.621346950531006, "mode": "train", "epoch": 10}
{"loss": 0.3673418164253235, "acc": 0.8694519996643066, "length": 3.7265625, "mode": "test", "epoch": 10}
{"loss": 0.24672777950763702, "acc": 0.9033695459365845, "length": 3.6088597774505615, "mode": "train", "epoch": 11}
{"loss": 0.31789129972457886, "acc": 0.8735595941543579, "length": 3.6328125, "mode": "test", "epoch": 11}
{"loss": 0.2300042062997818, "acc": 0.9108471870422363, "length": 3.6535091400146484, "mode": "train", "epoch": 12}
{"loss": 0.3176235854625702, "acc": 0.8716980218887329, "length": 3.7265625, "mode": "test", "epoch": 12}
{"loss": 0.2193065583705902, "acc": 0.9178187847137451, "length": 3.6654815673828125, "mode": "train", "epoch": 13}
{"loss": 0.28745582699775696, "acc": 0.879241943359375, "length": 3.6015625, "mode": "test", "epoch": 13}
{"loss": 0.20503321290016174, "acc": 0.9211068749427795, "length": 3.644368886947632, "mode": "train", "epoch": 14}
{"loss": 0.29443973302841187, "acc": 0.887054443359375, "length": 3.66015625, "mode": "test", "epoch": 14}
{"loss": 0.19883993268013, "acc": 0.9261606931686401, "length": 3.678471326828003, "mode": "train", "epoch": 15}
{"loss": 0.3215365409851074, "acc": 0.8861510753631592, "length": 3.8125, "mode": "test", "epoch": 15}
{"loss": 0.19493593275547028, "acc": 0.9263409376144409, "length": 3.694027900695801, "mode": "train", "epoch": 16}
{"loss": 0.3084675967693329, "acc": 0.8920410871505737, "length": 3.84375, "mode": "test", "epoch": 16}
{"loss": 0.19351328909397125, "acc": 0.9288530349731445, "length": 3.688851833343506, "mode": "train", "epoch": 17}
{"loss": 0.2822619080543518, "acc": 0.8984558582305908, "length": 3.87109375, "mode": "test", "epoch": 17}
{"loss": 0.1837887018918991, "acc": 0.9317600131034851, "length": 3.7161314487457275, "mode": "train", "epoch": 18}
{"loss": 0.2830072045326233, "acc": 0.9100586771965027, "length": 3.77734375, "mode": "test", "epoch": 18}
{"loss": 0.1849227249622345, "acc": 0.9295470714569092, "length": 3.718071699142456, "mode": "train", "epoch": 19}
{"loss": 0.25185155868530273, "acc": 0.9109619855880737, "length": 3.7734375, "mode": "test", "epoch": 19}
{"loss": 0.1782975047826767, "acc": 0.9335103631019592, "length": 3.6963305473327637, "mode": "train", "epoch": 20}
{"loss": 0.24562190473079681, "acc": 0.9177612066268921, "length": 3.75390625, "mode": "test", "epoch": 20}
{"loss": 0.17397236824035645, "acc": 0.9362131357192993, "length": 3.700525999069214, "mode": "train", "epoch": 21}
{"loss": 0.23992948234081268, "acc": 0.9199462532997131, "length": 3.77734375, "mode": "test", "epoch": 21}
{"loss": 0.16476541757583618, "acc": 0.9381479024887085, "length": 3.727029323577881, "mode": "train", "epoch": 22}
{"loss": 0.2459956705570221, "acc": 0.9161621332168579, "length": 3.80078125, "mode": "test", "epoch": 22}
{"loss": 0.16786609590053558, "acc": 0.9347220659255981, "length": 3.7146263122558594, "mode": "train", "epoch": 23}
{"loss": 0.23459133505821228, "acc": 0.917144775390625, "length": 3.765625, "mode": "test", "epoch": 23}
{"loss": 0.16068361699581146, "acc": 0.9387093186378479, "length": 3.728560447692871, "mode": "train", "epoch": 24}
{"loss": 0.20493899285793304, "acc": 0.929290771484375, "length": 3.7265625, "mode": "test", "epoch": 24}
{"loss": 0.15378549695014954, "acc": 0.9415711760520935, "length": 3.7727785110473633, "mode": "train", "epoch": 25}
{"loss": 0.20443694293498993, "acc": 0.9336181282997131, "length": 3.671875, "mode": "test", "epoch": 25}
{"loss": 0.1498604118824005, "acc": 0.9421461224555969, "length": 3.7503364086151123, "mode": "train", "epoch": 26}
{"loss": 0.2089906930923462, "acc": 0.9291077256202698, "length": 3.6875, "mode": "test", "epoch": 26}
{"loss": 0.1473478376865387, "acc": 0.9450852274894714, "length": 3.7426323890686035, "mode": "train", "epoch": 27}
{"loss": 0.19092854857444763, "acc": 0.935028076171875, "length": 3.67578125, "mode": "test", "epoch": 27}
{"loss": 0.14350488781929016, "acc": 0.9456808567047119, "length": 3.7622764110565186, "mode": "train", "epoch": 28}
{"loss": 0.18014904856681824, "acc": 0.9356812238693237, "length": 3.66015625, "mode": "test", "epoch": 28}
{"loss": 0.1383884698152542, "acc": 0.9519222378730774, "length": 3.7427241802215576, "mode": "train", "epoch": 29}
{"loss": 0.1799813210964203, "acc": 0.9369385242462158, "length": 3.69140625, "mode": "test", "epoch": 29}
{"loss": 0.1327851563692093, "acc": 0.9510073661804199, "length": 3.797045946121216, "mode": "train", "epoch": 30}
{"loss": 0.18289130926132202, "acc": 0.9380127191543579, "length": 3.74609375, "mode": "test", "epoch": 30}
{"loss": 0.1341712325811386, "acc": 0.948695719242096, "length": 3.7927327156066895, "mode": "train", "epoch": 31}
{"loss": 0.1991182267665863, "acc": 0.9418762922286987, "length": 3.76953125, "mode": "test", "epoch": 31}
{"loss": 0.12184055149555206, "acc": 0.9540005326271057, "length": 3.804090738296509, "mode": "train", "epoch": 32}
{"loss": 0.1851951628923416, "acc": 0.9425841569900513, "length": 3.890625, "mode": "test", "epoch": 32}
{"loss": 0.127287358045578, "acc": 0.9529021978378296, "length": 3.8633155822753906, "mode": "train", "epoch": 33}
{"loss": 0.1794569343328476, "acc": 0.9445129036903381, "length": 3.9140625, "mode": "test", "epoch": 33}
{"loss": 0.11053519695997238, "acc": 0.959968626499176, "length": 3.917795181274414, "mode": "train", "epoch": 34}
{"loss": 0.17182999849319458, "acc": 0.9430236220359802, "length": 3.98828125, "mode": "test", "epoch": 34}
{"loss": 0.11099627614021301, "acc": 0.9595823884010315, "length": 3.9441981315612793, "mode": "train", "epoch": 35}
{"loss": 0.14749263226985931, "acc": 0.9541442394256592, "length": 3.984375, "mode": "test", "epoch": 35}
{"loss": 0.10313504189252853, "acc": 0.9620732069015503, "length": 3.9652745723724365, "mode": "train", "epoch": 36}
{"loss": 0.14701776206493378, "acc": 0.9525390267372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.09866345673799515, "acc": 0.9640328884124756, "length": 3.9832003116607666, "mode": "train", "epoch": 37}
{"loss": 0.14664937555789948, "acc": 0.9548827409744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.09383214265108109, "acc": 0.9625366926193237, "length": 3.985183000564575, "mode": "train", "epoch": 38}
{"loss": 0.1786264032125473, "acc": 0.9396485090255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.10651417821645737, "acc": 0.9631885290145874, "length": 3.9902236461639404, "mode": "train", "epoch": 39}
{"loss": 0.15947853028774261, "acc": 0.9513672590255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.0991324707865715, "acc": 0.9608576893806458, "length": 3.9864485263824463, "mode": "train", "epoch": 40}
{"loss": 0.14568528532981873, "acc": 0.9457031488418579, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.09093789011240005, "acc": 0.9644356966018677, "length": 3.9885363578796387, "mode": "train", "epoch": 41}
{"loss": 0.13636863231658936, "acc": 0.9490233659744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.07876508682966232, "acc": 0.9710255861282349, "length": 3.9977781772613525, "mode": "train", "epoch": 42}
{"loss": 0.1655731350183487, "acc": 0.9478515982627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08945558965206146, "acc": 0.9664471745491028, "length": 3.9981002807617188, "mode": "train", "epoch": 43}
{"loss": 0.14595931768417358, "acc": 0.9476562142372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.08056196570396423, "acc": 0.9709469676017761, "length": 3.996840238571167, "mode": "train", "epoch": 44}
{"loss": 0.149125874042511, "acc": 0.9503907561302185, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.092497818171978, "acc": 0.9664127230644226, "length": 3.997842788696289, "mode": "train", "epoch": 45}
{"loss": 0.16142939031124115, "acc": 0.9445313215255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.10004686564207077, "acc": 0.963610053062439, "length": 3.997368812561035, "mode": "train", "epoch": 46}
{"loss": 0.14821757376194, "acc": 0.9519532918930054, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.08924924582242966, "acc": 0.965171217918396, "length": 3.997793674468994, "mode": "train", "epoch": 47}
{"loss": 0.12789812684059143, "acc": 0.9529296159744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.08388800919055939, "acc": 0.9680113792419434, "length": 3.9980123043060303, "mode": "train", "epoch": 48}
{"loss": 0.1409485787153244, "acc": 0.9476562738418579, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.08224111050367355, "acc": 0.9686365723609924, "length": 3.993753433227539, "mode": "train", "epoch": 49}
{"loss": 0.1211385503411293, "acc": 0.9597654938697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.07491543889045715, "acc": 0.9731000065803528, "length": 3.995849609375, "mode": "train", "epoch": 50}
{"loss": 0.12132184952497482, "acc": 0.9566406607627869, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.07185959815979004, "acc": 0.9722274541854858, "length": 3.9972152709960938, "mode": "train", "epoch": 51}
{"loss": 0.1323181539773941, "acc": 0.9539061784744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.06479775905609131, "acc": 0.9735566973686218, "length": 3.999331474304199, "mode": "train", "epoch": 52}
{"loss": 0.12276598066091537, "acc": 0.9593749642372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07321842759847641, "acc": 0.9727558493614197, "length": 3.9951963424682617, "mode": "train", "epoch": 53}
{"loss": 0.11969512701034546, "acc": 0.9607421159744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07096198946237564, "acc": 0.9746184945106506, "length": 3.9973816871643066, "mode": "train", "epoch": 54}
{"loss": 0.12521682679653168, "acc": 0.9556640982627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.05598992109298706, "acc": 0.9785279035568237, "length": 3.9986205101013184, "mode": "train", "epoch": 55}
{"loss": 0.148600235581398, "acc": 0.9544921517372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.05823437497019768, "acc": 0.9777701497077942, "length": 3.999462604522705, "mode": "train", "epoch": 56}
{"loss": 0.1189197525382042, "acc": 0.9582031965255737, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.05973629653453827, "acc": 0.9767335653305054, "length": 3.99951171875, "mode": "train", "epoch": 57}
{"loss": 0.1936476081609726, "acc": 0.9347656965255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.07185284793376923, "acc": 0.9734330177307129, "length": 3.9988560676574707, "mode": "train", "epoch": 58}
{"loss": 0.14398182928562164, "acc": 0.9548826813697815, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.06067340821027756, "acc": 0.9770480394363403, "length": 3.9999122619628906, "mode": "train", "epoch": 59}
{"loss": 0.13914114236831665, "acc": 0.9548827409744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.0617951937019825, "acc": 0.9781486392021179, "length": 3.999910354614258, "mode": "train", "epoch": 60}
{"loss": 0.1350468397140503, "acc": 0.9607421159744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.864142894744873
