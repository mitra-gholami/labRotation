ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6926345229148865, "acc": 0.524321973323822, "length": 3.1560845375061035, "mode": "train", "epoch": 1}
{"loss": 0.6835495233535767, "acc": 0.5298990607261658, "length": 1.4583333730697632, "mode": "test", "epoch": 1}
{"loss": 0.6271129846572876, "acc": 0.6542121171951294, "length": 3.331519842147827, "mode": "train", "epoch": 2}
{"loss": 0.5757212042808533, "acc": 0.7225694060325623, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5190691351890564, "acc": 0.7519671320915222, "length": 3.8876302242279053, "mode": "train", "epoch": 3}
{"loss": 0.4941520094871521, "acc": 0.7774088382720947, "length": 3.993055582046509, "mode": "test", "epoch": 3}
{"loss": 0.42149925231933594, "acc": 0.8148482441902161, "length": 3.9081404209136963, "mode": "train", "epoch": 4}
{"loss": 0.4030200242996216, "acc": 0.8241319060325623, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.3536592423915863, "acc": 0.8505569100379944, "length": 3.9634578227996826, "mode": "train", "epoch": 5}
{"loss": 0.3978508412837982, "acc": 0.8342013955116272, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3325393497943878, "acc": 0.852220356464386, "length": 3.9861741065979004, "mode": "train", "epoch": 6}
{"loss": 0.35586774349212646, "acc": 0.8541666865348816, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3122096657752991, "acc": 0.8665876984596252, "length": 3.9957473278045654, "mode": "train", "epoch": 7}
{"loss": 0.3582187592983246, "acc": 0.8623263835906982, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3060162365436554, "acc": 0.8697083592414856, "length": 3.991401433944702, "mode": "train", "epoch": 8}
{"loss": 0.3309715986251831, "acc": 0.8715277910232544, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3010545074939728, "acc": 0.873691976070404, "length": 3.9973793029785156, "mode": "train", "epoch": 9}
{"loss": 0.32748809456825256, "acc": 0.8730901479721069, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.28904247283935547, "acc": 0.8753761053085327, "length": 3.997394561767578, "mode": "train", "epoch": 10}
{"loss": 0.3250628113746643, "acc": 0.8685764074325562, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2766890823841095, "acc": 0.8847305178642273, "length": 3.997938632965088, "mode": "train", "epoch": 11}
{"loss": 0.35256266593933105, "acc": 0.8586806654930115, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2762455940246582, "acc": 0.8819893002510071, "length": 3.998263359069824, "mode": "train", "epoch": 12}
{"loss": 0.314949095249176, "acc": 0.8677083849906921, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2608039677143097, "acc": 0.8916304707527161, "length": 3.995932102203369, "mode": "train", "epoch": 13}
{"loss": 0.3267381191253662, "acc": 0.878125011920929, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.25001242756843567, "acc": 0.8980364799499512, "length": 3.9983718395233154, "mode": "train", "epoch": 14}
{"loss": 0.29366740584373474, "acc": 0.8940972089767456, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.24412517249584198, "acc": 0.9039042592048645, "length": 3.9975192546844482, "mode": "train", "epoch": 15}
{"loss": 0.2744564712047577, "acc": 0.9092013835906982, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.23213714361190796, "acc": 0.9091959595680237, "length": 3.9983482360839844, "mode": "train", "epoch": 16}
{"loss": 0.2791231870651245, "acc": 0.9071180820465088, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.23906271159648895, "acc": 0.9078643321990967, "length": 3.998000144958496, "mode": "train", "epoch": 17}
{"loss": 0.27680861949920654, "acc": 0.9114583134651184, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.22965161502361298, "acc": 0.9118703603744507, "length": 3.9986093044281006, "mode": "train", "epoch": 18}
{"loss": 0.26186370849609375, "acc": 0.9131944179534912, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2247278392314911, "acc": 0.9157119393348694, "length": 3.9997177124023438, "mode": "train", "epoch": 19}
{"loss": 0.2605656385421753, "acc": 0.9118055701255798, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21608708798885345, "acc": 0.9192923903465271, "length": 3.9954564571380615, "mode": "train", "epoch": 20}
{"loss": 0.2520844340324402, "acc": 0.9199652075767517, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2184726595878601, "acc": 0.9179806709289551, "length": 3.9999074935913086, "mode": "train", "epoch": 21}
{"loss": 0.28026196360588074, "acc": 0.9163194298744202, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23306407034397125, "acc": 0.9110775589942932, "length": 3.9998068809509277, "mode": "train", "epoch": 22}
{"loss": 0.2654167711734772, "acc": 0.9166666865348816, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.22290419042110443, "acc": 0.9174765944480896, "length": 3.9954848289489746, "mode": "train", "epoch": 23}
{"loss": 0.23343181610107422, "acc": 0.9279513955116272, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.20726068317890167, "acc": 0.9259810447692871, "length": 3.9998271465301514, "mode": "train", "epoch": 24}
{"loss": 0.23129695653915405, "acc": 0.9281250834465027, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20108966529369354, "acc": 0.9270858764648438, "length": 3.9998135566711426, "mode": "train", "epoch": 25}
{"loss": 0.22748547792434692, "acc": 0.9303818941116333, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.202334463596344, "acc": 0.9275344014167786, "length": 3.99895977973938, "mode": "train", "epoch": 26}
{"loss": 0.230940043926239, "acc": 0.9236111044883728, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.19691245257854462, "acc": 0.9291541576385498, "length": 3.998762607574463, "mode": "train", "epoch": 27}
{"loss": 0.2277224361896515, "acc": 0.9293402433395386, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19097429513931274, "acc": 0.9324117302894592, "length": 3.999161958694458, "mode": "train", "epoch": 28}
{"loss": 0.21020248532295227, "acc": 0.9354166388511658, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.1836642324924469, "acc": 0.9336999654769897, "length": 3.9976413249969482, "mode": "train", "epoch": 29}
{"loss": 0.20096856355667114, "acc": 0.9347221851348877, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18474414944648743, "acc": 0.9356722235679626, "length": 3.9999685287475586, "mode": "train", "epoch": 30}
{"loss": 0.20109397172927856, "acc": 0.9388889670372009, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.18085812032222748, "acc": 0.9344464540481567, "length": 3.999610185623169, "mode": "train", "epoch": 31}
{"loss": 0.19607269763946533, "acc": 0.9362847208976746, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17267635464668274, "acc": 0.9362524151802063, "length": 3.9999136924743652, "mode": "train", "epoch": 32}
{"loss": 0.19819937646389008, "acc": 0.9414931535720825, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.16865254938602448, "acc": 0.9407100677490234, "length": 3.9990525245666504, "mode": "train", "epoch": 33}
{"loss": 0.1880655288696289, "acc": 0.9432291388511658, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.15985806286334991, "acc": 0.9428630471229553, "length": 3.9999029636383057, "mode": "train", "epoch": 34}
{"loss": 0.192787304520607, "acc": 0.9376736879348755, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1699860841035843, "acc": 0.9385150074958801, "length": 3.9999496936798096, "mode": "train", "epoch": 35}
{"loss": 0.2069283127784729, "acc": 0.9270833134651184, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.18435946106910706, "acc": 0.9330551028251648, "length": 3.9987003803253174, "mode": "train", "epoch": 36}
{"loss": 0.2082560807466507, "acc": 0.9345486760139465, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.15960191190242767, "acc": 0.9451851844787598, "length": 3.9999732971191406, "mode": "train", "epoch": 37}
{"loss": 0.18774676322937012, "acc": 0.9439236521720886, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1571885347366333, "acc": 0.9439666867256165, "length": 3.999967098236084, "mode": "train", "epoch": 38}
{"loss": 0.1934741735458374, "acc": 0.9432289600372314, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.14486484229564667, "acc": 0.9480290412902832, "length": 3.9994027614593506, "mode": "train", "epoch": 39}
{"loss": 0.1896032989025116, "acc": 0.9369791746139526, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.142458975315094, "acc": 0.9464612603187561, "length": 3.999986171722412, "mode": "train", "epoch": 40}
{"loss": 0.19576650857925415, "acc": 0.941319465637207, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.14410388469696045, "acc": 0.9512524604797363, "length": 3.998640537261963, "mode": "train", "epoch": 41}
{"loss": 0.19820502400398254, "acc": 0.9397569298744202, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.14514373242855072, "acc": 0.9491878151893616, "length": 3.9999938011169434, "mode": "train", "epoch": 42}
{"loss": 0.1904326230287552, "acc": 0.9465277791023254, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.13650761544704437, "acc": 0.951740026473999, "length": 3.9999759197235107, "mode": "train", "epoch": 43}
{"loss": 0.19868719577789307, "acc": 0.9435763955116272, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.13679996132850647, "acc": 0.9532382488250732, "length": 3.9996895790100098, "mode": "train", "epoch": 44}
{"loss": 0.2059999704360962, "acc": 0.9437500834465027, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.139582559466362, "acc": 0.9505749344825745, "length": 3.9997122287750244, "mode": "train", "epoch": 45}
{"loss": 0.1986701786518097, "acc": 0.9437500834465027, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.13357152044773102, "acc": 0.9535947442054749, "length": 3.999885320663452, "mode": "train", "epoch": 46}
{"loss": 0.19937440752983093, "acc": 0.9444444179534912, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.12719418108463287, "acc": 0.9543498754501343, "length": 3.9999427795410156, "mode": "train", "epoch": 47}
{"loss": 0.20047560334205627, "acc": 0.9463542103767395, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.13392724096775055, "acc": 0.9502891898155212, "length": 3.999964714050293, "mode": "train", "epoch": 48}
{"loss": 0.17377229034900665, "acc": 0.9468749165534973, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.12241784483194351, "acc": 0.95684415102005, "length": 3.9999868869781494, "mode": "train", "epoch": 49}
{"loss": 0.16973641514778137, "acc": 0.949305534362793, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.12317471951246262, "acc": 0.954697847366333, "length": 3.9999828338623047, "mode": "train", "epoch": 50}
{"loss": 0.2078300267457962, "acc": 0.9435763955116272, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12572255730628967, "acc": 0.9572498798370361, "length": 3.9999778270721436, "mode": "train", "epoch": 51}
{"loss": 0.19486980140209198, "acc": 0.9364582896232605, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.129970520734787, "acc": 0.9540539979934692, "length": 3.99983286857605, "mode": "train", "epoch": 52}
{"loss": 0.16938795149326324, "acc": 0.9489583969116211, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1197124794125557, "acc": 0.9582940340042114, "length": 3.9999659061431885, "mode": "train", "epoch": 53}
{"loss": 0.17647844552993774, "acc": 0.9484374523162842, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11852056533098221, "acc": 0.9607879519462585, "length": 3.999945640563965, "mode": "train", "epoch": 54}
{"loss": 0.19820041954517365, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11728261411190033, "acc": 0.9578304886817932, "length": 3.9999966621398926, "mode": "train", "epoch": 55}
{"loss": 0.1828170269727707, "acc": 0.9468749165534973, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.11390534043312073, "acc": 0.9581185579299927, "length": 3.9999423027038574, "mode": "train", "epoch": 56}
{"loss": 0.17624600231647491, "acc": 0.953125, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.12034542113542557, "acc": 0.9561476707458496, "length": 3.999969720840454, "mode": "train", "epoch": 57}
{"loss": 0.18551219999790192, "acc": 0.9489583969116211, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.13204362988471985, "acc": 0.9557362198829651, "length": 3.999694585800171, "mode": "train", "epoch": 58}
{"loss": 0.17918892204761505, "acc": 0.9510417580604553, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11874271929264069, "acc": 0.9591817259788513, "length": 3.9987711906433105, "mode": "train", "epoch": 59}
{"loss": 0.19889847934246063, "acc": 0.9432291388511658, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.11906284838914871, "acc": 0.9581746459007263, "length": 3.9996848106384277, "mode": "train", "epoch": 60}
{"loss": 0.18645043671131134, "acc": 0.9489583969116211, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8320690393447876
