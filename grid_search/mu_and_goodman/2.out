ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7000393867492676, "acc": 0.5000507831573486, "length": 3.4726152420043945, "mode": "train", "epoch": 1}
{"loss": 0.6915276050567627, "acc": 0.5328124761581421, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6880201697349548, "acc": 0.5469829440116882, "length": 3.1762146949768066, "mode": "train", "epoch": 2}
{"loss": 0.6621967554092407, "acc": 0.6537706255912781, "length": 2.90625, "mode": "test", "epoch": 2}
{"loss": 0.641773521900177, "acc": 0.7084808945655823, "length": 3.372600793838501, "mode": "train", "epoch": 3}
{"loss": 0.5834217071533203, "acc": 0.7345215678215027, "length": 3.743055582046509, "mode": "test", "epoch": 3}
{"loss": 0.5350428819656372, "acc": 0.7719377279281616, "length": 3.638706922531128, "mode": "train", "epoch": 4}
{"loss": 0.5312240123748779, "acc": 0.7663574814796448, "length": 3.506944417953491, "mode": "test", "epoch": 4}
{"loss": 0.4593490660190582, "acc": 0.8136002421379089, "length": 3.7449629306793213, "mode": "train", "epoch": 5}
{"loss": 0.479586660861969, "acc": 0.7748264074325562, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.4061729609966278, "acc": 0.8276001811027527, "length": 3.903437852859497, "mode": "train", "epoch": 6}
{"loss": 0.45890024304389954, "acc": 0.8032985925674438, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3813636004924774, "acc": 0.8387570381164551, "length": 3.950913906097412, "mode": "train", "epoch": 7}
{"loss": 0.4503015875816345, "acc": 0.8001735210418701, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.36068078875541687, "acc": 0.8431934714317322, "length": 3.9671082496643066, "mode": "train", "epoch": 8}
{"loss": 0.43920236825942993, "acc": 0.8083334565162659, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3460921049118042, "acc": 0.8546205759048462, "length": 3.976520538330078, "mode": "train", "epoch": 9}
{"loss": 0.4222797155380249, "acc": 0.8109375834465027, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3277597725391388, "acc": 0.8607273101806641, "length": 3.9783742427825928, "mode": "train", "epoch": 10}
{"loss": 0.42355260252952576, "acc": 0.8230903148651123, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3155531585216522, "acc": 0.8699272871017456, "length": 3.979572057723999, "mode": "train", "epoch": 11}
{"loss": 0.4394778609275818, "acc": 0.8175346255302429, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.308645635843277, "acc": 0.86919105052948, "length": 3.9840235710144043, "mode": "train", "epoch": 12}
{"loss": 0.42437976598739624, "acc": 0.8225695490837097, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3019137680530548, "acc": 0.8757467269897461, "length": 3.9871795177459717, "mode": "train", "epoch": 13}
{"loss": 0.4248751401901245, "acc": 0.8347222805023193, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.28884345293045044, "acc": 0.8827669620513916, "length": 3.987788438796997, "mode": "train", "epoch": 14}
{"loss": 0.4080784320831299, "acc": 0.8401040434837341, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.281925231218338, "acc": 0.8861594796180725, "length": 3.992359161376953, "mode": "train", "epoch": 15}
{"loss": 0.39287227392196655, "acc": 0.8442708849906921, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2774335741996765, "acc": 0.8891494870185852, "length": 3.9930121898651123, "mode": "train", "epoch": 16}
{"loss": 0.37343481183052063, "acc": 0.8532986044883728, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.26909664273262024, "acc": 0.8957669734954834, "length": 3.993311643600464, "mode": "train", "epoch": 17}
{"loss": 0.3688925504684448, "acc": 0.8453124165534973, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2663470506668091, "acc": 0.8989545106887817, "length": 3.994145154953003, "mode": "train", "epoch": 18}
{"loss": 0.3600558340549469, "acc": 0.8626735210418701, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.26136380434036255, "acc": 0.8987706899642944, "length": 3.995980978012085, "mode": "train", "epoch": 19}
{"loss": 0.33790045976638794, "acc": 0.8703124523162842, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.25019413232803345, "acc": 0.902854859828949, "length": 3.99666690826416, "mode": "train", "epoch": 20}
{"loss": 0.3269177973270416, "acc": 0.8767361044883728, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2453480362892151, "acc": 0.903891921043396, "length": 3.9968421459198, "mode": "train", "epoch": 21}
{"loss": 0.2986992597579956, "acc": 0.8765624165534973, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23980462551116943, "acc": 0.9110952615737915, "length": 3.9977896213531494, "mode": "train", "epoch": 22}
{"loss": 0.30080077052116394, "acc": 0.8817707300186157, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2254711389541626, "acc": 0.9173354506492615, "length": 3.99606990814209, "mode": "train", "epoch": 23}
{"loss": 0.28715968132019043, "acc": 0.8862847089767456, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.22064602375030518, "acc": 0.9150997996330261, "length": 3.9977784156799316, "mode": "train", "epoch": 24}
{"loss": 0.28981873393058777, "acc": 0.885937511920929, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.21645553410053253, "acc": 0.9218637943267822, "length": 3.996906280517578, "mode": "train", "epoch": 25}
{"loss": 0.29411548376083374, "acc": 0.8810763359069824, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.21355454623699188, "acc": 0.9181735515594482, "length": 3.997776985168457, "mode": "train", "epoch": 26}
{"loss": 0.2757927179336548, "acc": 0.8960070013999939, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.20817290246486664, "acc": 0.9204316139221191, "length": 3.99723219871521, "mode": "train", "epoch": 27}
{"loss": 0.26450708508491516, "acc": 0.8965277075767517, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1955242156982422, "acc": 0.9273562431335449, "length": 3.999079465866089, "mode": "train", "epoch": 28}
{"loss": 0.24796120822429657, "acc": 0.9026041030883789, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18638573586940765, "acc": 0.927238404750824, "length": 3.9986510276794434, "mode": "train", "epoch": 29}
{"loss": 0.2409968078136444, "acc": 0.9059027433395386, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18260373175144196, "acc": 0.9282494187355042, "length": 3.9977426528930664, "mode": "train", "epoch": 30}
{"loss": 0.23637288808822632, "acc": 0.9059028625488281, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.17083416879177094, "acc": 0.9339401125907898, "length": 3.9983606338500977, "mode": "train", "epoch": 31}
{"loss": 0.2213721126317978, "acc": 0.9121527075767517, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.163913756608963, "acc": 0.9360454082489014, "length": 3.9987471103668213, "mode": "train", "epoch": 32}
{"loss": 0.22852563858032227, "acc": 0.9163194298744202, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.16147449612617493, "acc": 0.9376536011695862, "length": 3.99802565574646, "mode": "train", "epoch": 33}
{"loss": 0.20882821083068848, "acc": 0.9230902791023254, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.15300136804580688, "acc": 0.9412789344787598, "length": 3.998434066772461, "mode": "train", "epoch": 34}
{"loss": 0.1960814893245697, "acc": 0.9282985329627991, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1458977609872818, "acc": 0.9447954893112183, "length": 3.9986069202423096, "mode": "train", "epoch": 35}
{"loss": 0.18467634916305542, "acc": 0.9321179986000061, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1458398550748825, "acc": 0.9411951303482056, "length": 3.998598098754883, "mode": "train", "epoch": 36}
{"loss": 0.1978471875190735, "acc": 0.9251735210418701, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.14285911619663239, "acc": 0.9447454810142517, "length": 3.998990535736084, "mode": "train", "epoch": 37}
{"loss": 0.19622263312339783, "acc": 0.9315972924232483, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.13713793456554413, "acc": 0.9483051896095276, "length": 3.9993114471435547, "mode": "train", "epoch": 38}
{"loss": 0.2184457778930664, "acc": 0.9163195490837097, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.14657063782215118, "acc": 0.9483664035797119, "length": 3.9996893405914307, "mode": "train", "epoch": 39}
{"loss": 0.20130783319473267, "acc": 0.9263889789581299, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.13368242979049683, "acc": 0.9506323337554932, "length": 3.9997336864471436, "mode": "train", "epoch": 40}
{"loss": 0.2264145463705063, "acc": 0.9189236164093018, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.13590608537197113, "acc": 0.9502061605453491, "length": 3.999464511871338, "mode": "train", "epoch": 41}
{"loss": 0.19487406313419342, "acc": 0.9347221851348877, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1286037713289261, "acc": 0.9523735046386719, "length": 3.9997787475585938, "mode": "train", "epoch": 42}
{"loss": 0.17346280813217163, "acc": 0.9407985210418701, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1226135715842247, "acc": 0.9550955295562744, "length": 3.999528408050537, "mode": "train", "epoch": 43}
{"loss": 0.17943277955055237, "acc": 0.9383680820465088, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1207742691040039, "acc": 0.9551015496253967, "length": 3.9999303817749023, "mode": "train", "epoch": 44}
{"loss": 0.16037900745868683, "acc": 0.9465277791023254, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.11139906197786331, "acc": 0.9629918932914734, "length": 3.9999608993530273, "mode": "train", "epoch": 45}
{"loss": 0.15798793733119965, "acc": 0.9406250715255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.11273689568042755, "acc": 0.9576548933982849, "length": 3.9999547004699707, "mode": "train", "epoch": 46}
{"loss": 0.1674555242061615, "acc": 0.9420139789581299, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.10857148468494415, "acc": 0.9592221975326538, "length": 3.999988555908203, "mode": "train", "epoch": 47}
{"loss": 0.16903848946094513, "acc": 0.9428820013999939, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11132749915122986, "acc": 0.9582933187484741, "length": 3.99997615814209, "mode": "train", "epoch": 48}
{"loss": 0.15530353784561157, "acc": 0.9392361044883728, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.10982412844896317, "acc": 0.9604970812797546, "length": 3.999955892562866, "mode": "train", "epoch": 49}
{"loss": 0.15067364275455475, "acc": 0.9423611164093018, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0997840091586113, "acc": 0.9663560390472412, "length": 3.999969244003296, "mode": "train", "epoch": 50}
{"loss": 0.1404760479927063, "acc": 0.9520832896232605, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.09615660458803177, "acc": 0.9668206572532654, "length": 3.9999794960021973, "mode": "train", "epoch": 51}
{"loss": 0.15370644629001617, "acc": 0.9416666030883789, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.09243879467248917, "acc": 0.9684493541717529, "length": 3.9991021156311035, "mode": "train", "epoch": 52}
{"loss": 0.1560254991054535, "acc": 0.9449652433395386, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.09094680100679398, "acc": 0.966349184513092, "length": 3.999760150909424, "mode": "train", "epoch": 53}
{"loss": 0.15861862897872925, "acc": 0.9489583969116211, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1026151105761528, "acc": 0.9638456702232361, "length": 3.9995172023773193, "mode": "train", "epoch": 54}
{"loss": 0.16621823608875275, "acc": 0.9407985210418701, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.09310759603977203, "acc": 0.967314600944519, "length": 3.9993932247161865, "mode": "train", "epoch": 55}
{"loss": 0.14718806743621826, "acc": 0.9418402910232544, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.08385338634252548, "acc": 0.9720414876937866, "length": 3.9999969005584717, "mode": "train", "epoch": 56}
{"loss": 0.13480891287326813, "acc": 0.9536459445953369, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.08244800567626953, "acc": 0.9740699529647827, "length": 3.999946355819702, "mode": "train", "epoch": 57}
{"loss": 0.13417308032512665, "acc": 0.9536459445953369, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.08244871348142624, "acc": 0.9718031883239746, "length": 3.9998488426208496, "mode": "train", "epoch": 58}
{"loss": 0.1400773674249649, "acc": 0.9524306058883667, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.08172906190156937, "acc": 0.9741270542144775, "length": 3.9999349117279053, "mode": "train", "epoch": 59}
{"loss": 0.19191113114356995, "acc": 0.9420139789581299, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.08618216216564178, "acc": 0.970431387424469, "length": 3.99812912940979, "mode": "train", "epoch": 60}
{"loss": 0.13935647904872894, "acc": 0.9532986879348755, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7999999523162842
