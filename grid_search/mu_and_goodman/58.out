ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6944096684455872, "acc": 0.5046392679214478, "length": 3.5923943519592285, "mode": "train", "epoch": 1}
{"loss": 0.686650812625885, "acc": 0.5528824329376221, "length": 3.98828125, "mode": "test", "epoch": 1}
{"loss": 0.6913286447525024, "acc": 0.5211129784584045, "length": 3.5993473529815674, "mode": "train", "epoch": 2}
{"loss": 0.6813527941703796, "acc": 0.5397658944129944, "length": 3.9765625, "mode": "test", "epoch": 2}
{"loss": 0.6913700103759766, "acc": 0.5315789580345154, "length": 3.596918821334839, "mode": "train", "epoch": 3}
{"loss": 0.6733158826828003, "acc": 0.5529724359512329, "length": 3.90625, "mode": "test", "epoch": 3}
{"loss": 0.6892299056053162, "acc": 0.5386330485343933, "length": 3.6112287044525146, "mode": "train", "epoch": 4}
{"loss": 0.6615557074546814, "acc": 0.6408310532569885, "length": 3.61328125, "mode": "test", "epoch": 4}
{"loss": 0.6865710020065308, "acc": 0.5542367696762085, "length": 3.5886168479919434, "mode": "train", "epoch": 5}
{"loss": 0.6546425819396973, "acc": 0.6839447021484375, "length": 3.34375, "mode": "test", "epoch": 5}
{"loss": 0.6763147115707397, "acc": 0.5942159295082092, "length": 3.5387346744537354, "mode": "train", "epoch": 6}
{"loss": 0.6450520753860474, "acc": 0.7061492800712585, "length": 3.26953125, "mode": "test", "epoch": 6}
{"loss": 0.6571345925331116, "acc": 0.654325544834137, "length": 3.426671266555786, "mode": "train", "epoch": 7}
{"loss": 0.6259952783584595, "acc": 0.7246719598770142, "length": 3.203125, "mode": "test", "epoch": 7}
{"loss": 0.6250665783882141, "acc": 0.7258054614067078, "length": 3.3676390647888184, "mode": "train", "epoch": 8}
{"loss": 0.5877373218536377, "acc": 0.7505813241004944, "length": 3.51953125, "mode": "test", "epoch": 8}
{"loss": 0.5829652547836304, "acc": 0.7522461414337158, "length": 3.4853763580322266, "mode": "train", "epoch": 9}
{"loss": 0.5499328374862671, "acc": 0.75390625, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.535000741481781, "acc": 0.7600245475769043, "length": 3.7255518436431885, "mode": "train", "epoch": 10}
{"loss": 0.5340781211853027, "acc": 0.7646483778953552, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5004916787147522, "acc": 0.7656838893890381, "length": 3.8645031452178955, "mode": "train", "epoch": 11}
{"loss": 0.5220544338226318, "acc": 0.7824219465255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4776758551597595, "acc": 0.7879967093467712, "length": 3.9334824085235596, "mode": "train", "epoch": 12}
{"loss": 0.5134410858154297, "acc": 0.7826171517372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4564395546913147, "acc": 0.7981566190719604, "length": 3.947188377380371, "mode": "train", "epoch": 13}
{"loss": 0.501800000667572, "acc": 0.7978515028953552, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4395512044429779, "acc": 0.8075709342956543, "length": 3.9533658027648926, "mode": "train", "epoch": 14}
{"loss": 0.48619186878204346, "acc": 0.7937499284744263, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4231852889060974, "acc": 0.8246880769729614, "length": 3.9608383178710938, "mode": "train", "epoch": 15}
{"loss": 0.47505155205726624, "acc": 0.8021484017372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4030449688434601, "acc": 0.8386582136154175, "length": 3.9591429233551025, "mode": "train", "epoch": 16}
{"loss": 0.46007978916168213, "acc": 0.8021484017372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3779805600643158, "acc": 0.8469246625900269, "length": 3.9669458866119385, "mode": "train", "epoch": 17}
{"loss": 0.4385228753089905, "acc": 0.8205079436302185, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3560974597930908, "acc": 0.8551291823387146, "length": 3.9695401191711426, "mode": "train", "epoch": 18}
{"loss": 0.42996692657470703, "acc": 0.8238281011581421, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3362191617488861, "acc": 0.8568994402885437, "length": 3.9789304733276367, "mode": "train", "epoch": 19}
{"loss": 0.4303176999092102, "acc": 0.8367186188697815, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.32298538088798523, "acc": 0.8627468943595886, "length": 3.984086275100708, "mode": "train", "epoch": 20}
{"loss": 0.409246563911438, "acc": 0.8441405892372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.30783960223197937, "acc": 0.8699763417243958, "length": 3.985649347305298, "mode": "train", "epoch": 21}
{"loss": 0.39894604682922363, "acc": 0.8457030653953552, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.30093950033187866, "acc": 0.8767375349998474, "length": 3.9867751598358154, "mode": "train", "epoch": 22}
{"loss": 0.37029722332954407, "acc": 0.8585938811302185, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.28910380601882935, "acc": 0.8852052092552185, "length": 3.9869678020477295, "mode": "train", "epoch": 23}
{"loss": 0.3745211362838745, "acc": 0.8572264909744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2784425616264343, "acc": 0.8867628574371338, "length": 3.9907941818237305, "mode": "train", "epoch": 24}
{"loss": 0.3554832935333252, "acc": 0.8669921159744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2690695822238922, "acc": 0.8909962773323059, "length": 3.988713264465332, "mode": "train", "epoch": 25}
{"loss": 0.3455091714859009, "acc": 0.8648437261581421, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.26166605949401855, "acc": 0.8985535502433777, "length": 3.9879114627838135, "mode": "train", "epoch": 26}
{"loss": 0.33700937032699585, "acc": 0.8646484017372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2565899193286896, "acc": 0.8939156532287598, "length": 3.991847276687622, "mode": "train", "epoch": 27}
{"loss": 0.34686005115509033, "acc": 0.8666015267372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.24721156060695648, "acc": 0.9033730030059814, "length": 3.99402117729187, "mode": "train", "epoch": 28}
{"loss": 0.33005475997924805, "acc": 0.8714843392372131, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.24354693293571472, "acc": 0.902649998664856, "length": 3.9937760829925537, "mode": "train", "epoch": 29}
{"loss": 0.32435160875320435, "acc": 0.8759765028953552, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.23908983170986176, "acc": 0.9072511196136475, "length": 3.9927148818969727, "mode": "train", "epoch": 30}
{"loss": 0.3244480490684509, "acc": 0.8767579793930054, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.22734776139259338, "acc": 0.9166783690452576, "length": 3.993285655975342, "mode": "train", "epoch": 31}
{"loss": 0.3377516269683838, "acc": 0.8722657561302185, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.22404144704341888, "acc": 0.9157726764678955, "length": 3.9947214126586914, "mode": "train", "epoch": 32}
{"loss": 0.32014912366867065, "acc": 0.8761720061302185, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.21959863603115082, "acc": 0.918633222579956, "length": 3.996384859085083, "mode": "train", "epoch": 33}
{"loss": 0.3247462511062622, "acc": 0.8748046159744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.21479728817939758, "acc": 0.9219731688499451, "length": 3.9961326122283936, "mode": "train", "epoch": 34}
{"loss": 0.330622136592865, "acc": 0.8742188215255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21705840528011322, "acc": 0.9205628037452698, "length": 3.996964693069458, "mode": "train", "epoch": 35}
{"loss": 0.32898950576782227, "acc": 0.8755860328674316, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2179708480834961, "acc": 0.9195621013641357, "length": 3.9971749782562256, "mode": "train", "epoch": 36}
{"loss": 0.3220353126525879, "acc": 0.8828124403953552, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2105286419391632, "acc": 0.9233570098876953, "length": 3.9970688819885254, "mode": "train", "epoch": 37}
{"loss": 0.32065126299858093, "acc": 0.8804687857627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.20634344220161438, "acc": 0.9273395538330078, "length": 3.997175931930542, "mode": "train", "epoch": 38}
{"loss": 0.30872833728790283, "acc": 0.8867188096046448, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.21065577864646912, "acc": 0.9241859912872314, "length": 3.9977002143859863, "mode": "train", "epoch": 39}
{"loss": 0.31531816720962524, "acc": 0.8845702409744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2070891559123993, "acc": 0.9232644438743591, "length": 3.9975907802581787, "mode": "train", "epoch": 40}
{"loss": 0.3140260577201843, "acc": 0.8884764909744263, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19740650057792664, "acc": 0.9330123662948608, "length": 3.9955852031707764, "mode": "train", "epoch": 41}
{"loss": 0.297066330909729, "acc": 0.8972655534744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.20178720355033875, "acc": 0.9292042851448059, "length": 3.996671199798584, "mode": "train", "epoch": 42}
{"loss": 0.29725414514541626, "acc": 0.8935546278953552, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.20060591399669647, "acc": 0.9286608695983887, "length": 3.997091054916382, "mode": "train", "epoch": 43}
{"loss": 0.2769394516944885, "acc": 0.9023436903953552, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.19725432991981506, "acc": 0.9282919764518738, "length": 3.998448133468628, "mode": "train", "epoch": 44}
{"loss": 0.2945423722267151, "acc": 0.8986328840255737, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1931145340204239, "acc": 0.933020830154419, "length": 3.9987473487854004, "mode": "train", "epoch": 45}
{"loss": 0.2851483225822449, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18948093056678772, "acc": 0.9331698417663574, "length": 3.99826717376709, "mode": "train", "epoch": 46}
{"loss": 0.2886502146720886, "acc": 0.9046874642372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.190558061003685, "acc": 0.9336958527565002, "length": 3.998629331588745, "mode": "train", "epoch": 47}
{"loss": 0.2696212828159332, "acc": 0.9068359732627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.18438217043876648, "acc": 0.9385213851928711, "length": 3.9957973957061768, "mode": "train", "epoch": 48}
{"loss": 0.2681818902492523, "acc": 0.9058594703674316, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.188548281788826, "acc": 0.9345744252204895, "length": 3.998426675796509, "mode": "train", "epoch": 49}
{"loss": 0.27157241106033325, "acc": 0.9099608659744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.17853689193725586, "acc": 0.93971848487854, "length": 3.9977195262908936, "mode": "train", "epoch": 50}
{"loss": 0.2760235667228699, "acc": 0.9048827886581421, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.1800183802843094, "acc": 0.9373877644538879, "length": 3.998887777328491, "mode": "train", "epoch": 51}
{"loss": 0.2689995765686035, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.18263819813728333, "acc": 0.937457799911499, "length": 3.998900890350342, "mode": "train", "epoch": 52}
{"loss": 0.25437501072883606, "acc": 0.9105468988418579, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.17855194211006165, "acc": 0.9378970265388489, "length": 3.9988832473754883, "mode": "train", "epoch": 53}
{"loss": 0.25813359022140503, "acc": 0.9101563096046448, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.17452092468738556, "acc": 0.9397165775299072, "length": 3.999351978302002, "mode": "train", "epoch": 54}
{"loss": 0.24623431265354156, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.16970105469226837, "acc": 0.9442435503005981, "length": 3.999255895614624, "mode": "train", "epoch": 55}
{"loss": 0.267535924911499, "acc": 0.9080079793930054, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.17404678463935852, "acc": 0.9407023191452026, "length": 3.9988701343536377, "mode": "train", "epoch": 56}
{"loss": 0.25313323736190796, "acc": 0.9138671159744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1722765415906906, "acc": 0.941092312335968, "length": 3.9989545345306396, "mode": "train", "epoch": 57}
{"loss": 0.2584882974624634, "acc": 0.9121093153953552, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.16924640536308289, "acc": 0.9425941109657288, "length": 3.9987146854400635, "mode": "train", "epoch": 58}
{"loss": 0.2789071798324585, "acc": 0.9080077409744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.16800639033317566, "acc": 0.9420118927955627, "length": 3.999239206314087, "mode": "train", "epoch": 59}
{"loss": 0.25567469000816345, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1676730066537857, "acc": 0.9439237713813782, "length": 3.9993598461151123, "mode": "train", "epoch": 60}
{"loss": 0.2559046745300293, "acc": 0.9226561784744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8157999515533447
