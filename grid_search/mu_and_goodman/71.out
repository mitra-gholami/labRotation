ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6943540573120117, "acc": 0.5282371044158936, "length": 3.514026403427124, "mode": "train", "epoch": 1}
{"loss": 0.6792597770690918, "acc": 0.5523101091384888, "length": 2.0859375, "mode": "test", "epoch": 1}
{"loss": 0.6875416040420532, "acc": 0.554408073425293, "length": 3.5032403469085693, "mode": "train", "epoch": 2}
{"loss": 0.6799787282943726, "acc": 0.5549377799034119, "length": 1.9296875, "mode": "test", "epoch": 2}
{"loss": 0.6840572953224182, "acc": 0.5644049048423767, "length": 3.4301300048828125, "mode": "train", "epoch": 3}
{"loss": 0.668845534324646, "acc": 0.5962677001953125, "length": 2.5, "mode": "test", "epoch": 3}
{"loss": 0.6708473563194275, "acc": 0.5991737842559814, "length": 3.3881444931030273, "mode": "train", "epoch": 4}
{"loss": 0.631452202796936, "acc": 0.6743438243865967, "length": 3.4609375, "mode": "test", "epoch": 4}
{"loss": 0.6319926381111145, "acc": 0.67268306016922, "length": 3.46532940864563, "mode": "train", "epoch": 5}
{"loss": 0.582398533821106, "acc": 0.7262924909591675, "length": 3.94140625, "mode": "test", "epoch": 5}
{"loss": 0.5679033398628235, "acc": 0.7479219436645508, "length": 3.6602559089660645, "mode": "train", "epoch": 6}
{"loss": 0.5296782851219177, "acc": 0.7656249403953552, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5087224841117859, "acc": 0.764788031578064, "length": 3.8414626121520996, "mode": "train", "epoch": 7}
{"loss": 0.5203090906143188, "acc": 0.7810546159744263, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4695712924003601, "acc": 0.7968488335609436, "length": 3.918107032775879, "mode": "train", "epoch": 8}
{"loss": 0.48865339159965515, "acc": 0.8130859732627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.43346115946769714, "acc": 0.8181530237197876, "length": 3.942830801010132, "mode": "train", "epoch": 9}
{"loss": 0.5016686916351318, "acc": 0.8035155534744263, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4084133505821228, "acc": 0.8214307427406311, "length": 3.9433236122131348, "mode": "train", "epoch": 10}
{"loss": 0.47044479846954346, "acc": 0.8095703721046448, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3735862076282501, "acc": 0.8432343602180481, "length": 3.95723819732666, "mode": "train", "epoch": 11}
{"loss": 0.44528549909591675, "acc": 0.8181642293930054, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3363410532474518, "acc": 0.8596500754356384, "length": 3.960665464401245, "mode": "train", "epoch": 12}
{"loss": 0.41841772198677063, "acc": 0.8199219107627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.30958589911460876, "acc": 0.8722651600837708, "length": 3.9717280864715576, "mode": "train", "epoch": 13}
{"loss": 0.4219466745853424, "acc": 0.8386720418930054, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.29070767760276794, "acc": 0.8814525604248047, "length": 3.9801526069641113, "mode": "train", "epoch": 14}
{"loss": 0.425862193107605, "acc": 0.8281250596046448, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.28589683771133423, "acc": 0.885712206363678, "length": 3.983474016189575, "mode": "train", "epoch": 15}
{"loss": 0.40690553188323975, "acc": 0.8550781607627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.27503934502601624, "acc": 0.8862583041191101, "length": 3.986624240875244, "mode": "train", "epoch": 16}
{"loss": 0.40351343154907227, "acc": 0.8488279581069946, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.26245686411857605, "acc": 0.8992683291435242, "length": 3.9878714084625244, "mode": "train", "epoch": 17}
{"loss": 0.40244781970977783, "acc": 0.8306640982627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.25128719210624695, "acc": 0.9042549133300781, "length": 3.98994517326355, "mode": "train", "epoch": 18}
{"loss": 0.35868149995803833, "acc": 0.8587890267372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.241609126329422, "acc": 0.9067403078079224, "length": 3.991173267364502, "mode": "train", "epoch": 19}
{"loss": 0.3802427053451538, "acc": 0.8390625715255737, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.23439204692840576, "acc": 0.907502293586731, "length": 3.992136240005493, "mode": "train", "epoch": 20}
{"loss": 0.3806701898574829, "acc": 0.8478516340255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.22889243066310883, "acc": 0.9122788906097412, "length": 3.993281364440918, "mode": "train", "epoch": 21}
{"loss": 0.3491101562976837, "acc": 0.8648437261581421, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2147984653711319, "acc": 0.9141784906387329, "length": 3.9937524795532227, "mode": "train", "epoch": 22}
{"loss": 0.3533923625946045, "acc": 0.8701171875, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.21610590815544128, "acc": 0.918443500995636, "length": 3.994903802871704, "mode": "train", "epoch": 23}
{"loss": 0.31405630707740784, "acc": 0.8941406607627869, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.21578986942768097, "acc": 0.9164285063743591, "length": 3.9948606491088867, "mode": "train", "epoch": 24}
{"loss": 0.3397553861141205, "acc": 0.8740234971046448, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20899081230163574, "acc": 0.9206421971321106, "length": 3.9950408935546875, "mode": "train", "epoch": 25}
{"loss": 0.30219024419784546, "acc": 0.8896483778953552, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2010468989610672, "acc": 0.9225985407829285, "length": 3.9958362579345703, "mode": "train", "epoch": 26}
{"loss": 0.3020150065422058, "acc": 0.8853515982627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.19505620002746582, "acc": 0.9270274043083191, "length": 3.9955928325653076, "mode": "train", "epoch": 27}
{"loss": 0.31123703718185425, "acc": 0.8933595418930054, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19583402574062347, "acc": 0.9248433113098145, "length": 3.996476888656616, "mode": "train", "epoch": 28}
{"loss": 0.2955920696258545, "acc": 0.8933592438697815, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.19345501065254211, "acc": 0.9271528720855713, "length": 3.9966368675231934, "mode": "train", "epoch": 29}
{"loss": 0.29490411281585693, "acc": 0.8998046517372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1891028881072998, "acc": 0.9284016489982605, "length": 3.9972031116485596, "mode": "train", "epoch": 30}
{"loss": 0.2783413529396057, "acc": 0.9027343988418579, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.18505261838436127, "acc": 0.9312406778335571, "length": 3.9972853660583496, "mode": "train", "epoch": 31}
{"loss": 0.28663206100463867, "acc": 0.8982421159744263, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.18402476608753204, "acc": 0.9328374266624451, "length": 3.9978067874908447, "mode": "train", "epoch": 32}
{"loss": 0.27653998136520386, "acc": 0.9095702767372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17525134980678558, "acc": 0.9357262253761292, "length": 3.997448444366455, "mode": "train", "epoch": 33}
{"loss": 0.2673901617527008, "acc": 0.9046874642372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1736588031053543, "acc": 0.9329605102539062, "length": 3.997706651687622, "mode": "train", "epoch": 34}
{"loss": 0.281477689743042, "acc": 0.9062499403953552, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1761549711227417, "acc": 0.9312532544136047, "length": 3.997809410095215, "mode": "train", "epoch": 35}
{"loss": 0.26643481850624084, "acc": 0.9085937142372131, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.17365595698356628, "acc": 0.9339089393615723, "length": 3.997697353363037, "mode": "train", "epoch": 36}
{"loss": 0.28044766187667847, "acc": 0.9050780534744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16636863350868225, "acc": 0.939104437828064, "length": 3.9982497692108154, "mode": "train", "epoch": 37}
{"loss": 0.24933898448944092, "acc": 0.9085937142372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.16358835995197296, "acc": 0.9376915097236633, "length": 3.9983956813812256, "mode": "train", "epoch": 38}
{"loss": 0.2576812505722046, "acc": 0.9021483659744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16441930830478668, "acc": 0.9341602921485901, "length": 3.9987757205963135, "mode": "train", "epoch": 39}
{"loss": 0.2459411323070526, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15622183680534363, "acc": 0.9400572180747986, "length": 3.9981045722961426, "mode": "train", "epoch": 40}
{"loss": 0.2616865932941437, "acc": 0.9056640267372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.15443745255470276, "acc": 0.940122127532959, "length": 3.998807907104492, "mode": "train", "epoch": 41}
{"loss": 0.23761799931526184, "acc": 0.9148436784744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1506037712097168, "acc": 0.9404730796813965, "length": 3.998745918273926, "mode": "train", "epoch": 42}
{"loss": 0.22615550458431244, "acc": 0.9156250953674316, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.14669743180274963, "acc": 0.9427189230918884, "length": 3.9988417625427246, "mode": "train", "epoch": 43}
{"loss": 0.22438561916351318, "acc": 0.9156249761581421, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1461831033229828, "acc": 0.9466008543968201, "length": 3.9978249073028564, "mode": "train", "epoch": 44}
{"loss": 0.22429516911506653, "acc": 0.9119142293930054, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.14443539083003998, "acc": 0.9423704743385315, "length": 3.9988934993743896, "mode": "train", "epoch": 45}
{"loss": 0.2100277841091156, "acc": 0.9132813215255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1416429728269577, "acc": 0.9449034929275513, "length": 3.9988722801208496, "mode": "train", "epoch": 46}
{"loss": 0.20647723972797394, "acc": 0.9177733659744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.13875243067741394, "acc": 0.9493960738182068, "length": 3.999112844467163, "mode": "train", "epoch": 47}
{"loss": 0.22505417466163635, "acc": 0.9099608063697815, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1332695037126541, "acc": 0.9498682022094727, "length": 3.9990391731262207, "mode": "train", "epoch": 48}
{"loss": 0.2357122004032135, "acc": 0.9066405892372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1250525712966919, "acc": 0.9534679651260376, "length": 3.9991490840911865, "mode": "train", "epoch": 49}
{"loss": 0.21105408668518066, "acc": 0.9195312261581421, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.12449172884225845, "acc": 0.9524011611938477, "length": 3.9990265369415283, "mode": "train", "epoch": 50}
{"loss": 0.21060577034950256, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.11895085126161575, "acc": 0.9541166424751282, "length": 3.999016046524048, "mode": "train", "epoch": 51}
{"loss": 0.18350331485271454, "acc": 0.9320312142372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12237775325775146, "acc": 0.953886091709137, "length": 3.999436140060425, "mode": "train", "epoch": 52}
{"loss": 0.19023145735263824, "acc": 0.9230469465255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11797541379928589, "acc": 0.9542967677116394, "length": 3.999267578125, "mode": "train", "epoch": 53}
{"loss": 0.1680518388748169, "acc": 0.939453125, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11023475974798203, "acc": 0.9607885479927063, "length": 3.999131917953491, "mode": "train", "epoch": 54}
{"loss": 0.17724022269248962, "acc": 0.9304686784744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11195886135101318, "acc": 0.9578343629837036, "length": 3.99932861328125, "mode": "train", "epoch": 55}
{"loss": 0.17880868911743164, "acc": 0.9271483421325684, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1082945317029953, "acc": 0.9583151340484619, "length": 3.999439001083374, "mode": "train", "epoch": 56}
{"loss": 0.18512476980686188, "acc": 0.9283202886581421, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.10754352807998657, "acc": 0.9582570791244507, "length": 3.9995217323303223, "mode": "train", "epoch": 57}
{"loss": 0.18455709517002106, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.09859580546617508, "acc": 0.9664488434791565, "length": 3.9986984729766846, "mode": "train", "epoch": 58}
{"loss": 0.1636030673980713, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09620509296655655, "acc": 0.9626847505569458, "length": 3.999593496322632, "mode": "train", "epoch": 59}
{"loss": 0.19031211733818054, "acc": 0.9320311546325684, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09073289483785629, "acc": 0.9671618342399597, "length": 3.9993338584899902, "mode": "train", "epoch": 60}
{"loss": 0.16040268540382385, "acc": 0.9351562857627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8600001335144043
