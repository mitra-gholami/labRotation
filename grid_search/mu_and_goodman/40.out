ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6955627799034119, "acc": 0.5201587080955505, "length": 3.5673301219940186, "mode": "train", "epoch": 1}
{"loss": 0.6782960891723633, "acc": 0.5915100574493408, "length": 1.8203125, "mode": "test", "epoch": 1}
{"loss": 0.6840211153030396, "acc": 0.5619141459465027, "length": 3.311823844909668, "mode": "train", "epoch": 2}
{"loss": 0.6632558107376099, "acc": 0.6206909418106079, "length": 2.34765625, "mode": "test", "epoch": 2}
{"loss": 0.6265987753868103, "acc": 0.6682838797569275, "length": 3.1640772819519043, "mode": "train", "epoch": 3}
{"loss": 0.5760852098464966, "acc": 0.7115234732627869, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5573793053627014, "acc": 0.7253662347793579, "length": 3.8480567932128906, "mode": "train", "epoch": 4}
{"loss": 0.535866916179657, "acc": 0.7328124642372131, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5073748826980591, "acc": 0.7607792019844055, "length": 3.9543378353118896, "mode": "train", "epoch": 5}
{"loss": 0.49303585290908813, "acc": 0.7996092438697815, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.45181113481521606, "acc": 0.7909463047981262, "length": 3.9699056148529053, "mode": "train", "epoch": 6}
{"loss": 0.4599010646343231, "acc": 0.8166016936302185, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4258635640144348, "acc": 0.8228826522827148, "length": 3.977530002593994, "mode": "train", "epoch": 7}
{"loss": 0.4491402506828308, "acc": 0.8152343034744263, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.41219308972358704, "acc": 0.8278519511222839, "length": 3.973848819732666, "mode": "train", "epoch": 8}
{"loss": 0.42540621757507324, "acc": 0.8285156488418579, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3909685015678406, "acc": 0.8399624824523926, "length": 3.9768083095550537, "mode": "train", "epoch": 9}
{"loss": 0.39571958780288696, "acc": 0.8384765386581421, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3664894700050354, "acc": 0.8427466750144958, "length": 3.986900806427002, "mode": "train", "epoch": 10}
{"loss": 0.37779903411865234, "acc": 0.8451170921325684, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.33996763825416565, "acc": 0.8586491346359253, "length": 3.9841742515563965, "mode": "train", "epoch": 11}
{"loss": 0.365418404340744, "acc": 0.8470702767372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.32714468240737915, "acc": 0.8660821914672852, "length": 3.9849209785461426, "mode": "train", "epoch": 12}
{"loss": 0.3656693994998932, "acc": 0.8505858778953552, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3071591854095459, "acc": 0.8799933195114136, "length": 3.9862418174743652, "mode": "train", "epoch": 13}
{"loss": 0.36319732666015625, "acc": 0.8550781607627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2969795763492584, "acc": 0.8829906582832336, "length": 3.98868465423584, "mode": "train", "epoch": 14}
{"loss": 0.3697409927845001, "acc": 0.8609375357627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.29092708230018616, "acc": 0.879130482673645, "length": 3.9894914627075195, "mode": "train", "epoch": 15}
{"loss": 0.37679123878479004, "acc": 0.8603515028953552, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.28379762172698975, "acc": 0.8872352242469788, "length": 3.9903175830841064, "mode": "train", "epoch": 16}
{"loss": 0.37906649708747864, "acc": 0.8589844107627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.27189603447914124, "acc": 0.887985110282898, "length": 3.987487554550171, "mode": "train", "epoch": 17}
{"loss": 0.36847180128097534, "acc": 0.8671875, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.26242882013320923, "acc": 0.8929314613342285, "length": 3.993124485015869, "mode": "train", "epoch": 18}
{"loss": 0.3505818843841553, "acc": 0.8609375357627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.25507062673568726, "acc": 0.8991556763648987, "length": 3.9917168617248535, "mode": "train", "epoch": 19}
{"loss": 0.3541611135005951, "acc": 0.869140625, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.26205047965049744, "acc": 0.8982910513877869, "length": 3.9934911727905273, "mode": "train", "epoch": 20}
{"loss": 0.3326140344142914, "acc": 0.8746094703674316, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2487679421901703, "acc": 0.9038771390914917, "length": 3.995243787765503, "mode": "train", "epoch": 21}
{"loss": 0.3286837935447693, "acc": 0.8851562142372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23905782401561737, "acc": 0.9077145457267761, "length": 3.995471477508545, "mode": "train", "epoch": 22}
{"loss": 0.32547035813331604, "acc": 0.8589844107627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.22708015143871307, "acc": 0.9092413187026978, "length": 3.996074676513672, "mode": "train", "epoch": 23}
{"loss": 0.31248992681503296, "acc": 0.8658203482627869, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.22462449967861176, "acc": 0.9118208885192871, "length": 3.996534824371338, "mode": "train", "epoch": 24}
{"loss": 0.2960752546787262, "acc": 0.8861327767372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.22459638118743896, "acc": 0.9120664000511169, "length": 3.997490882873535, "mode": "train", "epoch": 25}
{"loss": 0.2706332504749298, "acc": 0.8962889909744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.22239363193511963, "acc": 0.9110077023506165, "length": 3.9966886043548584, "mode": "train", "epoch": 26}
{"loss": 0.29130819439888, "acc": 0.8828125, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2143748700618744, "acc": 0.9137506484985352, "length": 3.997319221496582, "mode": "train", "epoch": 27}
{"loss": 0.2951248586177826, "acc": 0.8896484375, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.20773310959339142, "acc": 0.9196488261222839, "length": 3.9973087310791016, "mode": "train", "epoch": 28}
{"loss": 0.271689236164093, "acc": 0.8824219107627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2081073820590973, "acc": 0.9170425534248352, "length": 3.996798515319824, "mode": "train", "epoch": 29}
{"loss": 0.26247525215148926, "acc": 0.8986329436302185, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.19884885847568512, "acc": 0.9218729734420776, "length": 3.998115301132202, "mode": "train", "epoch": 30}
{"loss": 0.25659728050231934, "acc": 0.9015625715255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.19473783671855927, "acc": 0.9267505407333374, "length": 3.9981565475463867, "mode": "train", "epoch": 31}
{"loss": 0.26329901814460754, "acc": 0.8857421875, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.18980170786380768, "acc": 0.9272243976593018, "length": 3.9986026287078857, "mode": "train", "epoch": 32}
{"loss": 0.24567925930023193, "acc": 0.9111328125, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.18440178036689758, "acc": 0.9295951724052429, "length": 3.998591423034668, "mode": "train", "epoch": 33}
{"loss": 0.24679207801818848, "acc": 0.8982421159744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.18208107352256775, "acc": 0.9307353496551514, "length": 3.9977223873138428, "mode": "train", "epoch": 34}
{"loss": 0.22948136925697327, "acc": 0.9136719107627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.17891144752502441, "acc": 0.9292410016059875, "length": 3.998169183731079, "mode": "train", "epoch": 35}
{"loss": 0.2362596094608307, "acc": 0.9158202409744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.18434001505374908, "acc": 0.926594614982605, "length": 3.9982211589813232, "mode": "train", "epoch": 36}
{"loss": 0.21216054260730743, "acc": 0.9220703840255737, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1772170215845108, "acc": 0.9314592480659485, "length": 3.998565673828125, "mode": "train", "epoch": 37}
{"loss": 0.20684188604354858, "acc": 0.9197264909744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.17401358485221863, "acc": 0.934359610080719, "length": 3.998678207397461, "mode": "train", "epoch": 38}
{"loss": 0.22134362161159515, "acc": 0.9128904938697815, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16358080506324768, "acc": 0.9393452405929565, "length": 3.9991872310638428, "mode": "train", "epoch": 39}
{"loss": 0.23355618119239807, "acc": 0.9162110090255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.155648872256279, "acc": 0.940983235836029, "length": 3.9991445541381836, "mode": "train", "epoch": 40}
{"loss": 0.2191496342420578, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.156111478805542, "acc": 0.9398118853569031, "length": 3.9967384338378906, "mode": "train", "epoch": 41}
{"loss": 0.2085464894771576, "acc": 0.9144530892372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.15475532412528992, "acc": 0.9388835430145264, "length": 3.9989709854125977, "mode": "train", "epoch": 42}
{"loss": 0.20796826481819153, "acc": 0.9222655296325684, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.14865867793560028, "acc": 0.9438279271125793, "length": 3.9994091987609863, "mode": "train", "epoch": 43}
{"loss": 0.22336721420288086, "acc": 0.9222655296325684, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1442108005285263, "acc": 0.9497725367546082, "length": 3.9989821910858154, "mode": "train", "epoch": 44}
{"loss": 0.19808363914489746, "acc": 0.9330078363418579, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.13906577229499817, "acc": 0.9478989243507385, "length": 3.999582529067993, "mode": "train", "epoch": 45}
{"loss": 0.19748303294181824, "acc": 0.9312500357627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.13721045851707458, "acc": 0.9510298371315002, "length": 3.999640941619873, "mode": "train", "epoch": 46}
{"loss": 0.20433282852172852, "acc": 0.9253906607627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.13724534213542938, "acc": 0.9501609206199646, "length": 3.9993696212768555, "mode": "train", "epoch": 47}
{"loss": 0.2217952013015747, "acc": 0.9294921159744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.13074573874473572, "acc": 0.9552663564682007, "length": 3.9997341632843018, "mode": "train", "epoch": 48}
{"loss": 0.19386500120162964, "acc": 0.9359374642372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.12638349831104279, "acc": 0.95462965965271, "length": 3.9996986389160156, "mode": "train", "epoch": 49}
{"loss": 0.20395812392234802, "acc": 0.9312500953674316, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13202467560768127, "acc": 0.9574691653251648, "length": 3.999683380126953, "mode": "train", "epoch": 50}
{"loss": 0.18573680520057678, "acc": 0.9357423186302185, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.13344214856624603, "acc": 0.9556576013565063, "length": 3.999403715133667, "mode": "train", "epoch": 51}
{"loss": 0.2040448784828186, "acc": 0.9294920563697815, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1264304369688034, "acc": 0.9579399228096008, "length": 3.9998011589050293, "mode": "train", "epoch": 52}
{"loss": 0.1790199875831604, "acc": 0.94140625, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.12057504802942276, "acc": 0.9615897536277771, "length": 3.999795436859131, "mode": "train", "epoch": 53}
{"loss": 0.1830640435218811, "acc": 0.9367188215255737, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11495361477136612, "acc": 0.9631521701812744, "length": 3.999692916870117, "mode": "train", "epoch": 54}
{"loss": 0.18213951587677002, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11127270013093948, "acc": 0.9638316631317139, "length": 3.9987847805023193, "mode": "train", "epoch": 55}
{"loss": 0.1892189383506775, "acc": 0.9357422590255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.11884814500808716, "acc": 0.9597409963607788, "length": 3.9999287128448486, "mode": "train", "epoch": 56}
{"loss": 0.18701060116291046, "acc": 0.9337891936302185, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11500372737646103, "acc": 0.9614166021347046, "length": 3.9997527599334717, "mode": "train", "epoch": 57}
{"loss": 0.18492451310157776, "acc": 0.9367188215255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.11187563836574554, "acc": 0.9636278748512268, "length": 3.999941110610962, "mode": "train", "epoch": 58}
{"loss": 0.21245667338371277, "acc": 0.9287108778953552, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11365590989589691, "acc": 0.961642324924469, "length": 3.999784231185913, "mode": "train", "epoch": 59}
{"loss": 0.1950947642326355, "acc": 0.9437499642372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10800550878047943, "acc": 0.9640254378318787, "length": 3.999823808670044, "mode": "train", "epoch": 60}
{"loss": 0.17913877964019775, "acc": 0.9369140267372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7229311466217041
