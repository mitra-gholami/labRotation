ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6937599778175354, "acc": 0.5262832641601562, "length": 3.4624741077423096, "mode": "train", "epoch": 1}
{"loss": 0.6694412231445312, "acc": 0.6077636480331421, "length": 2.625, "mode": "test", "epoch": 1}
{"loss": 0.6303697824478149, "acc": 0.6613608598709106, "length": 3.621065378189087, "mode": "train", "epoch": 2}
{"loss": 0.5205522775650024, "acc": 0.7837890982627869, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.5037962794303894, "acc": 0.7645364999771118, "length": 3.969928741455078, "mode": "train", "epoch": 3}
{"loss": 0.49183958768844604, "acc": 0.7998046278953552, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.47587716579437256, "acc": 0.786697506904602, "length": 3.9861035346984863, "mode": "train", "epoch": 4}
{"loss": 0.4667823910713196, "acc": 0.8087891340255737, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4536896049976349, "acc": 0.7930410504341125, "length": 3.9920761585235596, "mode": "train", "epoch": 5}
{"loss": 0.4378378391265869, "acc": 0.8203125, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.4095049500465393, "acc": 0.8134932518005371, "length": 3.9908130168914795, "mode": "train", "epoch": 6}
{"loss": 0.427560418844223, "acc": 0.8013672232627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3676708936691284, "acc": 0.8289075493812561, "length": 3.9964206218719482, "mode": "train", "epoch": 7}
{"loss": 0.3827865719795227, "acc": 0.8238281607627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.34484127163887024, "acc": 0.8416804075241089, "length": 3.996417284011841, "mode": "train", "epoch": 8}
{"loss": 0.3707362711429596, "acc": 0.8253906965255737, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.33041244745254517, "acc": 0.8470081090927124, "length": 3.9981603622436523, "mode": "train", "epoch": 9}
{"loss": 0.3585873246192932, "acc": 0.8412109017372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.31571313738822937, "acc": 0.853426456451416, "length": 3.9939322471618652, "mode": "train", "epoch": 10}
{"loss": 0.34878164529800415, "acc": 0.8384765982627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.31338122487068176, "acc": 0.8586632609367371, "length": 3.9991588592529297, "mode": "train", "epoch": 11}
{"loss": 0.338202565908432, "acc": 0.8548827767372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.29037100076675415, "acc": 0.8651508688926697, "length": 3.9989559650421143, "mode": "train", "epoch": 12}
{"loss": 0.31867513060569763, "acc": 0.8626952767372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2852410674095154, "acc": 0.8767412900924683, "length": 3.999236583709717, "mode": "train", "epoch": 13}
{"loss": 0.32193684577941895, "acc": 0.8625000715255737, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2740640640258789, "acc": 0.8837274312973022, "length": 3.9994869232177734, "mode": "train", "epoch": 14}
{"loss": 0.28396809101104736, "acc": 0.8849610090255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.25509244203567505, "acc": 0.8934420943260193, "length": 3.999508857727051, "mode": "train", "epoch": 15}
{"loss": 0.2628873586654663, "acc": 0.8960937857627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.24302268028259277, "acc": 0.901563823223114, "length": 3.9995241165161133, "mode": "train", "epoch": 16}
{"loss": 0.2630978226661682, "acc": 0.9029297232627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.23645076155662537, "acc": 0.9092130661010742, "length": 3.999645233154297, "mode": "train", "epoch": 17}
{"loss": 0.25458216667175293, "acc": 0.9058594107627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.21975678205490112, "acc": 0.9181850552558899, "length": 3.9994823932647705, "mode": "train", "epoch": 18}
{"loss": 0.23244886100292206, "acc": 0.9101561903953552, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.20877815783023834, "acc": 0.9257196187973022, "length": 3.9997718334198, "mode": "train", "epoch": 19}
{"loss": 0.2600890100002289, "acc": 0.9050780534744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21415826678276062, "acc": 0.9198977947235107, "length": 3.99988055229187, "mode": "train", "epoch": 20}
{"loss": 0.24143952131271362, "acc": 0.9117187857627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.19622041285037994, "acc": 0.928887128829956, "length": 3.998788833618164, "mode": "train", "epoch": 21}
{"loss": 0.21392999589443207, "acc": 0.9201172590255737, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.18974685668945312, "acc": 0.9323900938034058, "length": 3.9997031688690186, "mode": "train", "epoch": 22}
{"loss": 0.22274233400821686, "acc": 0.9099608659744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.18798524141311646, "acc": 0.933856189250946, "length": 3.999910831451416, "mode": "train", "epoch": 23}
{"loss": 0.20657338201999664, "acc": 0.9269531965255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1817539781332016, "acc": 0.9327408671379089, "length": 3.9995779991149902, "mode": "train", "epoch": 24}
{"loss": 0.20954859256744385, "acc": 0.9205078482627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.18421509861946106, "acc": 0.9331172704696655, "length": 3.9992711544036865, "mode": "train", "epoch": 25}
{"loss": 0.2131551206111908, "acc": 0.9158202409744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.17756080627441406, "acc": 0.9342793822288513, "length": 3.9998934268951416, "mode": "train", "epoch": 26}
{"loss": 0.2044057697057724, "acc": 0.9326171875, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.16769038140773773, "acc": 0.9393160343170166, "length": 3.9999120235443115, "mode": "train", "epoch": 27}
{"loss": 0.2116011381149292, "acc": 0.9328125715255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.16987274587154388, "acc": 0.9402260780334473, "length": 3.9998905658721924, "mode": "train", "epoch": 28}
{"loss": 0.19589321315288544, "acc": 0.9269532561302185, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.17226789891719818, "acc": 0.9385856986045837, "length": 3.9998743534088135, "mode": "train", "epoch": 29}
{"loss": 0.19405566155910492, "acc": 0.9246093034744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.17206232249736786, "acc": 0.9390706419944763, "length": 3.9984045028686523, "mode": "train", "epoch": 30}
{"loss": 0.22370338439941406, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.16000458598136902, "acc": 0.9449012279510498, "length": 3.9999196529388428, "mode": "train", "epoch": 31}
{"loss": 0.19834448397159576, "acc": 0.9345703125, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.15070840716362, "acc": 0.9476901888847351, "length": 3.999894618988037, "mode": "train", "epoch": 32}
{"loss": 0.18401716649532318, "acc": 0.9361328482627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.15029948949813843, "acc": 0.9484214186668396, "length": 3.999976396560669, "mode": "train", "epoch": 33}
{"loss": 0.23136787116527557, "acc": 0.91796875, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.16350896656513214, "acc": 0.9394405484199524, "length": 3.99995493888855, "mode": "train", "epoch": 34}
{"loss": 0.19672414660453796, "acc": 0.9259766340255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1498129516839981, "acc": 0.9477545619010925, "length": 3.999990463256836, "mode": "train", "epoch": 35}
{"loss": 0.16763240098953247, "acc": 0.9433594346046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.14480029046535492, "acc": 0.9492716193199158, "length": 3.9999961853027344, "mode": "train", "epoch": 36}
{"loss": 0.14751723408699036, "acc": 0.9527344107627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.14053334295749664, "acc": 0.9492083787918091, "length": 3.9999544620513916, "mode": "train", "epoch": 37}
{"loss": 0.16689348220825195, "acc": 0.9386720061302185, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.14982718229293823, "acc": 0.942354142665863, "length": 3.999990463256836, "mode": "train", "epoch": 38}
{"loss": 0.1854904145002365, "acc": 0.9330077767372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.15502499043941498, "acc": 0.9450836181640625, "length": 3.9999752044677734, "mode": "train", "epoch": 39}
{"loss": 0.18754160404205322, "acc": 0.9289063215255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1338920146226883, "acc": 0.9535797834396362, "length": 3.9999935626983643, "mode": "train", "epoch": 40}
{"loss": 0.15858417749404907, "acc": 0.9457030892372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.12435082346200943, "acc": 0.9575844407081604, "length": 3.9999890327453613, "mode": "train", "epoch": 41}
{"loss": 0.17914551496505737, "acc": 0.9388671517372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.13343331217765808, "acc": 0.952305257320404, "length": 3.999990224838257, "mode": "train", "epoch": 42}
{"loss": 0.16050855815410614, "acc": 0.9410156607627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.14198185503482819, "acc": 0.9514550566673279, "length": 3.9999747276306152, "mode": "train", "epoch": 43}
{"loss": 0.17634809017181396, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.12298405170440674, "acc": 0.9542473554611206, "length": 3.99999737739563, "mode": "train", "epoch": 44}
{"loss": 0.16014286875724792, "acc": 0.9402343034744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.12981489300727844, "acc": 0.947931170463562, "length": 3.9999210834503174, "mode": "train", "epoch": 45}
{"loss": 0.18135902285575867, "acc": 0.9410156607627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.14347507059574127, "acc": 0.9485436677932739, "length": 3.9999988079071045, "mode": "train", "epoch": 46}
{"loss": 0.20139877498149872, "acc": 0.9326171875, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.12372004240751266, "acc": 0.9516381621360779, "length": 3.999995231628418, "mode": "train", "epoch": 47}
{"loss": 0.1509326696395874, "acc": 0.9464844465255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11924935132265091, "acc": 0.9580704569816589, "length": 3.9999985694885254, "mode": "train", "epoch": 48}
{"loss": 0.1411096602678299, "acc": 0.9515624642372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.10094260424375534, "acc": 0.9607400894165039, "length": 3.999997615814209, "mode": "train", "epoch": 49}
{"loss": 0.13706785440444946, "acc": 0.9541015028953552, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.11590426415205002, "acc": 0.9557620286941528, "length": 3.9999470710754395, "mode": "train", "epoch": 50}
{"loss": 0.17039893567562103, "acc": 0.94921875, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.11106710880994797, "acc": 0.9609218239784241, "length": 3.999990701675415, "mode": "train", "epoch": 51}
{"loss": 0.1452053189277649, "acc": 0.9560546278953552, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.0993206799030304, "acc": 0.9611010551452637, "length": 3.999943733215332, "mode": "train", "epoch": 52}
{"loss": 0.15709728002548218, "acc": 0.9527344107627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1007145345211029, "acc": 0.9645010232925415, "length": 3.999974012374878, "mode": "train", "epoch": 53}
{"loss": 0.12638120353221893, "acc": 0.955078125, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.08663952350616455, "acc": 0.9695946574211121, "length": 3.999837636947632, "mode": "train", "epoch": 54}
{"loss": 0.11151441931724548, "acc": 0.9626952409744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.08138391375541687, "acc": 0.9701433777809143, "length": 3.9999568462371826, "mode": "train", "epoch": 55}
{"loss": 0.11516698449850082, "acc": 0.9650391340255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.07722801715135574, "acc": 0.970812976360321, "length": 3.9999935626983643, "mode": "train", "epoch": 56}
{"loss": 0.10079987347126007, "acc": 0.966796875, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.08939039707183838, "acc": 0.9678961634635925, "length": 3.9999351501464844, "mode": "train", "epoch": 57}
{"loss": 0.1428481489419937, "acc": 0.9542970061302185, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.09878508746623993, "acc": 0.9646369218826294, "length": 3.9991981983184814, "mode": "train", "epoch": 58}
{"loss": 0.13466331362724304, "acc": 0.9599609375, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.08466600626707077, "acc": 0.969841718673706, "length": 3.9999911785125732, "mode": "train", "epoch": 59}
{"loss": 0.13922585546970367, "acc": 0.9523438215255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.08700399845838547, "acc": 0.9661403894424438, "length": 3.999983310699463, "mode": "train", "epoch": 60}
{"loss": 0.12911181151866913, "acc": 0.9591798186302185, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8529411554336548
