ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6982129216194153, "acc": 0.520225465297699, "length": 3.4945852756500244, "mode": "train", "epoch": 1}
{"loss": 0.6869707107543945, "acc": 0.5546875, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.692058265209198, "acc": 0.5276097655296326, "length": 3.2151877880096436, "mode": "train", "epoch": 2}
{"loss": 0.694455623626709, "acc": 0.49492189288139343, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6878042221069336, "acc": 0.5491860508918762, "length": 2.6372716426849365, "mode": "train", "epoch": 3}
{"loss": 0.6825799345970154, "acc": 0.5206634998321533, "length": 1.37890625, "mode": "test", "epoch": 3}
{"loss": 0.6709230542182922, "acc": 0.608818531036377, "length": 2.497077226638794, "mode": "train", "epoch": 4}
{"loss": 0.6391901969909668, "acc": 0.7155579328536987, "length": 2.375, "mode": "test", "epoch": 4}
{"loss": 0.6328312158584595, "acc": 0.6777551174163818, "length": 2.804321765899658, "mode": "train", "epoch": 5}
{"loss": 0.5989745855331421, "acc": 0.7193679809570312, "length": 2.41015625, "mode": "test", "epoch": 5}
{"loss": 0.5794435739517212, "acc": 0.717113196849823, "length": 2.931088447570801, "mode": "train", "epoch": 6}
{"loss": 0.5364995002746582, "acc": 0.7742065787315369, "length": 3.5625, "mode": "test", "epoch": 6}
{"loss": 0.5338231325149536, "acc": 0.7550294995307922, "length": 3.4877238273620605, "mode": "train", "epoch": 7}
{"loss": 0.4980388283729553, "acc": 0.7718749642372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.48555564880371094, "acc": 0.7739771604537964, "length": 3.863853931427002, "mode": "train", "epoch": 8}
{"loss": 0.45836341381073, "acc": 0.7939453721046448, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.44724225997924805, "acc": 0.8022218346595764, "length": 3.9353113174438477, "mode": "train", "epoch": 9}
{"loss": 0.4536784291267395, "acc": 0.8093749284744263, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4374482035636902, "acc": 0.8123299479484558, "length": 3.9671854972839355, "mode": "train", "epoch": 10}
{"loss": 0.45667776465415955, "acc": 0.8099609017372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.43463650345802307, "acc": 0.8149834871292114, "length": 3.953120708465576, "mode": "train", "epoch": 11}
{"loss": 0.4462854266166687, "acc": 0.8103514909744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4224286675453186, "acc": 0.8251088857650757, "length": 3.8599448204040527, "mode": "train", "epoch": 12}
{"loss": 0.4325173795223236, "acc": 0.8258284330368042, "length": 3.890625, "mode": "test", "epoch": 12}
{"loss": 0.421487957239151, "acc": 0.8214201927185059, "length": 3.7402920722961426, "mode": "train", "epoch": 13}
{"loss": 0.4307910203933716, "acc": 0.8173446655273438, "length": 3.953125, "mode": "test", "epoch": 13}
{"loss": 0.4130028188228607, "acc": 0.8219494223594666, "length": 3.8080101013183594, "mode": "train", "epoch": 14}
{"loss": 0.43305039405822754, "acc": 0.8201523423194885, "length": 3.921875, "mode": "test", "epoch": 14}
{"loss": 0.4062599539756775, "acc": 0.832051694393158, "length": 3.745849132537842, "mode": "train", "epoch": 15}
{"loss": 0.42687442898750305, "acc": 0.8295104503631592, "length": 3.859375, "mode": "test", "epoch": 15}
{"loss": 0.40090513229370117, "acc": 0.8344639539718628, "length": 3.7026150226593018, "mode": "train", "epoch": 16}
{"loss": 0.41933345794677734, "acc": 0.8304795026779175, "length": 3.87109375, "mode": "test", "epoch": 16}
{"loss": 0.393486887216568, "acc": 0.8396267890930176, "length": 3.7168076038360596, "mode": "train", "epoch": 17}
{"loss": 0.40862223505973816, "acc": 0.8380247950553894, "length": 3.6953125, "mode": "test", "epoch": 17}
{"loss": 0.38812991976737976, "acc": 0.8452244997024536, "length": 3.6018288135528564, "mode": "train", "epoch": 18}
{"loss": 0.4111905097961426, "acc": 0.8317840695381165, "length": 3.81640625, "mode": "test", "epoch": 18}
{"loss": 0.3848626911640167, "acc": 0.8401281833648682, "length": 3.675814390182495, "mode": "train", "epoch": 19}
{"loss": 0.41223371028900146, "acc": 0.8277283310890198, "length": 3.74609375, "mode": "test", "epoch": 19}
{"loss": 0.37586671113967896, "acc": 0.8425000309944153, "length": 3.689185857772827, "mode": "train", "epoch": 20}
{"loss": 0.39656850695610046, "acc": 0.8393799066543579, "length": 3.7265625, "mode": "test", "epoch": 20}
{"loss": 0.3705795109272003, "acc": 0.8441576957702637, "length": 3.649442434310913, "mode": "train", "epoch": 21}
{"loss": 0.37801557779312134, "acc": 0.8401839733123779, "length": 3.6171875, "mode": "test", "epoch": 21}
{"loss": 0.3609791398048401, "acc": 0.8435729742050171, "length": 3.627915143966675, "mode": "train", "epoch": 22}
{"loss": 0.36419665813446045, "acc": 0.8537947535514832, "length": 3.51171875, "mode": "test", "epoch": 22}
{"loss": 0.35600924491882324, "acc": 0.8457626700401306, "length": 3.6306142807006836, "mode": "train", "epoch": 23}
{"loss": 0.35706761479377747, "acc": 0.8530212640762329, "length": 3.5546875, "mode": "test", "epoch": 23}
{"loss": 0.3461526930332184, "acc": 0.8531426191329956, "length": 3.621586322784424, "mode": "train", "epoch": 24}
{"loss": 0.3584568500518799, "acc": 0.8532868027687073, "length": 3.53515625, "mode": "test", "epoch": 24}
{"loss": 0.3412618339061737, "acc": 0.8551862239837646, "length": 3.587599515914917, "mode": "train", "epoch": 25}
{"loss": 0.3425127863883972, "acc": 0.8617919087409973, "length": 3.5, "mode": "test", "epoch": 25}
{"loss": 0.328936904668808, "acc": 0.8622788190841675, "length": 3.643996477127075, "mode": "train", "epoch": 26}
{"loss": 0.3417454957962036, "acc": 0.8562926650047302, "length": 3.5078125, "mode": "test", "epoch": 26}
{"loss": 0.3218849003314972, "acc": 0.8696925640106201, "length": 3.652911424636841, "mode": "train", "epoch": 27}
{"loss": 0.32260406017303467, "acc": 0.8685379028320312, "length": 3.58203125, "mode": "test", "epoch": 27}
{"loss": 0.31056836247444153, "acc": 0.8726472854614258, "length": 3.6218278408050537, "mode": "train", "epoch": 28}
{"loss": 0.3152323365211487, "acc": 0.8707382678985596, "length": 3.55859375, "mode": "test", "epoch": 28}
{"loss": 0.3096056878566742, "acc": 0.8771543502807617, "length": 3.667336940765381, "mode": "train", "epoch": 29}
{"loss": 0.3148742914199829, "acc": 0.8740324974060059, "length": 3.51953125, "mode": "test", "epoch": 29}
{"loss": 0.29928871989250183, "acc": 0.8783125877380371, "length": 3.6722843647003174, "mode": "train", "epoch": 30}
{"loss": 0.3050006628036499, "acc": 0.8737243413925171, "length": 3.59765625, "mode": "test", "epoch": 30}
{"loss": 0.2885715663433075, "acc": 0.8803344368934631, "length": 3.6547231674194336, "mode": "train", "epoch": 31}
{"loss": 0.2872456908226013, "acc": 0.8896224498748779, "length": 3.58984375, "mode": "test", "epoch": 31}
{"loss": 0.2727500796318054, "acc": 0.8924399614334106, "length": 3.6642370223999023, "mode": "train", "epoch": 32}
{"loss": 0.26774346828460693, "acc": 0.8976027369499207, "length": 3.54296875, "mode": "test", "epoch": 32}
{"loss": 0.26138970255851746, "acc": 0.8983541131019592, "length": 3.66910457611084, "mode": "train", "epoch": 33}
{"loss": 0.2668524384498596, "acc": 0.897952139377594, "length": 3.57421875, "mode": "test", "epoch": 33}
{"loss": 0.25103145837783813, "acc": 0.9031401872634888, "length": 3.672746181488037, "mode": "train", "epoch": 34}
{"loss": 0.2509373426437378, "acc": 0.8998809456825256, "length": 3.546875, "mode": "test", "epoch": 34}
{"loss": 0.24298223853111267, "acc": 0.9088062047958374, "length": 3.6704421043395996, "mode": "train", "epoch": 35}
{"loss": 0.2481500506401062, "acc": 0.9033294916152954, "length": 3.58984375, "mode": "test", "epoch": 35}
{"loss": 0.23919692635536194, "acc": 0.9099951386451721, "length": 3.707587957382202, "mode": "train", "epoch": 36}
{"loss": 0.2360040545463562, "acc": 0.9103316068649292, "length": 3.609375, "mode": "test", "epoch": 36}
{"loss": 0.2385004311800003, "acc": 0.9090143442153931, "length": 3.6620073318481445, "mode": "train", "epoch": 37}
{"loss": 0.23457735776901245, "acc": 0.9102645516395569, "length": 3.55078125, "mode": "test", "epoch": 37}
{"loss": 0.22888493537902832, "acc": 0.9150891900062561, "length": 3.6706924438476562, "mode": "train", "epoch": 38}
{"loss": 0.2357744574546814, "acc": 0.9138504266738892, "length": 3.5546875, "mode": "test", "epoch": 38}
{"loss": 0.2244844138622284, "acc": 0.9148752689361572, "length": 3.6650025844573975, "mode": "train", "epoch": 39}
{"loss": 0.23198142647743225, "acc": 0.9051788449287415, "length": 3.6015625, "mode": "test", "epoch": 39}
{"loss": 0.2255895882844925, "acc": 0.9131951332092285, "length": 3.6515679359436035, "mode": "train", "epoch": 40}
{"loss": 0.22811341285705566, "acc": 0.918609619140625, "length": 3.58984375, "mode": "test", "epoch": 40}
{"loss": 0.2205481082201004, "acc": 0.9202554225921631, "length": 3.666203022003174, "mode": "train", "epoch": 41}
{"loss": 0.2299243062734604, "acc": 0.9148695468902588, "length": 3.59375, "mode": "test", "epoch": 41}
{"loss": 0.2118796855211258, "acc": 0.92174232006073, "length": 3.676623821258545, "mode": "train", "epoch": 42}
{"loss": 0.21787215769290924, "acc": 0.9195297360420227, "length": 3.6015625, "mode": "test", "epoch": 42}
{"loss": 0.2075287401676178, "acc": 0.9237841367721558, "length": 3.675224542617798, "mode": "train", "epoch": 43}
{"loss": 0.21113696694374084, "acc": 0.9234191179275513, "length": 3.5703125, "mode": "test", "epoch": 43}
{"loss": 0.2018873691558838, "acc": 0.9239881038665771, "length": 3.6680264472961426, "mode": "train", "epoch": 44}
{"loss": 0.2145860195159912, "acc": 0.920707643032074, "length": 3.609375, "mode": "test", "epoch": 44}
{"loss": 0.20348525047302246, "acc": 0.9253374338150024, "length": 3.696345090866089, "mode": "train", "epoch": 45}
{"loss": 0.20349523425102234, "acc": 0.9244475960731506, "length": 3.6171875, "mode": "test", "epoch": 45}
{"loss": 0.19866512715816498, "acc": 0.9269551038742065, "length": 3.6928234100341797, "mode": "train", "epoch": 46}
{"loss": 0.20492568612098694, "acc": 0.9260147213935852, "length": 3.5859375, "mode": "test", "epoch": 46}
{"loss": 0.19184112548828125, "acc": 0.930706262588501, "length": 3.670250654220581, "mode": "train", "epoch": 47}
{"loss": 0.20898222923278809, "acc": 0.9226685166358948, "length": 3.62109375, "mode": "test", "epoch": 47}
{"loss": 0.1935136765241623, "acc": 0.9291516542434692, "length": 3.6765005588531494, "mode": "train", "epoch": 48}
{"loss": 0.2028540074825287, "acc": 0.9267302751541138, "length": 3.58203125, "mode": "test", "epoch": 48}
{"loss": 0.18545874953269958, "acc": 0.9325031042098999, "length": 3.6725423336029053, "mode": "train", "epoch": 49}
{"loss": 0.1960349977016449, "acc": 0.9282166361808777, "length": 3.61328125, "mode": "test", "epoch": 49}
{"loss": 0.18350274860858917, "acc": 0.935305118560791, "length": 3.6947021484375, "mode": "train", "epoch": 50}
{"loss": 0.19054867327213287, "acc": 0.9305770397186279, "length": 3.60546875, "mode": "test", "epoch": 50}
{"loss": 0.17819932103157043, "acc": 0.9339376091957092, "length": 3.688253164291382, "mode": "train", "epoch": 51}
{"loss": 0.18924714624881744, "acc": 0.9302917718887329, "length": 3.640625, "mode": "test", "epoch": 51}
{"loss": 0.17756566405296326, "acc": 0.9332637190818787, "length": 3.709489345550537, "mode": "train", "epoch": 52}
{"loss": 0.19082097709178925, "acc": 0.929923951625824, "length": 3.57421875, "mode": "test", "epoch": 52}
{"loss": 0.17283327877521515, "acc": 0.9367081522941589, "length": 3.663985013961792, "mode": "train", "epoch": 53}
{"loss": 0.1848946213722229, "acc": 0.9324859380722046, "length": 3.625, "mode": "test", "epoch": 53}
{"loss": 0.16866067051887512, "acc": 0.9392055869102478, "length": 3.7056007385253906, "mode": "train", "epoch": 54}
{"loss": 0.1773070991039276, "acc": 0.9366454482078552, "length": 3.625, "mode": "test", "epoch": 54}
{"loss": 0.1703920215368271, "acc": 0.9371744990348816, "length": 3.6977503299713135, "mode": "train", "epoch": 55}
{"loss": 0.1858847737312317, "acc": 0.9327651858329773, "length": 3.6875, "mode": "test", "epoch": 55}
{"loss": 0.16911008954048157, "acc": 0.9383455514907837, "length": 3.7232697010040283, "mode": "train", "epoch": 56}
{"loss": 0.1780395805835724, "acc": 0.9366956949234009, "length": 3.5859375, "mode": "test", "epoch": 56}
{"loss": 0.1671295464038849, "acc": 0.9376824498176575, "length": 3.678600311279297, "mode": "train", "epoch": 57}
{"loss": 0.20030826330184937, "acc": 0.92931067943573, "length": 3.66015625, "mode": "test", "epoch": 57}
{"loss": 0.16966094076633453, "acc": 0.9390736222267151, "length": 3.727834463119507, "mode": "train", "epoch": 58}
{"loss": 0.18960162997245789, "acc": 0.93121337890625, "length": 3.66796875, "mode": "test", "epoch": 58}
{"loss": 0.16462311148643494, "acc": 0.9410626292228699, "length": 3.741642475128174, "mode": "train", "epoch": 59}
{"loss": 0.1907084882259369, "acc": 0.936549186706543, "length": 3.6640625, "mode": "test", "epoch": 59}
{"loss": 0.15765060484409332, "acc": 0.9414693117141724, "length": 3.722010612487793, "mode": "train", "epoch": 60}
{"loss": 0.18281984329223633, "acc": 0.935272216796875, "length": 3.61328125, "mode": "test", "epoch": 60}
test accuracy: 0.8058019876480103
