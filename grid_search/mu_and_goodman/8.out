ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6939539909362793, "acc": 0.5231849551200867, "length": 3.4266326427459717, "mode": "train", "epoch": 1}
{"loss": 0.6919639110565186, "acc": 0.510937511920929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.684071958065033, "acc": 0.5495420694351196, "length": 3.2411937713623047, "mode": "train", "epoch": 2}
{"loss": 0.6568126678466797, "acc": 0.6467339396476746, "length": 3.659722328186035, "mode": "test", "epoch": 2}
{"loss": 0.6278681755065918, "acc": 0.6862940192222595, "length": 3.676225423812866, "mode": "train", "epoch": 3}
{"loss": 0.5658582448959351, "acc": 0.7364583015441895, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5380597114562988, "acc": 0.7450142502784729, "length": 3.919064521789551, "mode": "train", "epoch": 4}
{"loss": 0.537848174571991, "acc": 0.7574653029441833, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4927302598953247, "acc": 0.781332790851593, "length": 3.937878370285034, "mode": "train", "epoch": 5}
{"loss": 0.5375272631645203, "acc": 0.7307291030883789, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.45849037170410156, "acc": 0.78892982006073, "length": 3.964244842529297, "mode": "train", "epoch": 6}
{"loss": 0.48847469687461853, "acc": 0.7805556058883667, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4332510530948639, "acc": 0.8023976683616638, "length": 3.970614194869995, "mode": "train", "epoch": 7}
{"loss": 0.47791311144828796, "acc": 0.7967012524604797, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4150759279727936, "acc": 0.8155443668365479, "length": 3.978172540664673, "mode": "train", "epoch": 8}
{"loss": 0.475582480430603, "acc": 0.8104166388511658, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.39864036440849304, "acc": 0.8259421586990356, "length": 3.9748036861419678, "mode": "train", "epoch": 9}
{"loss": 0.4600672721862793, "acc": 0.8034722805023193, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.37743207812309265, "acc": 0.8244181871414185, "length": 3.9754226207733154, "mode": "train", "epoch": 10}
{"loss": 0.41598615050315857, "acc": 0.8190972805023193, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3414978086948395, "acc": 0.8488751649856567, "length": 3.978257894515991, "mode": "train", "epoch": 11}
{"loss": 0.3716454803943634, "acc": 0.8340277075767517, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.31215476989746094, "acc": 0.8641232848167419, "length": 3.9865646362304688, "mode": "train", "epoch": 12}
{"loss": 0.36012718081474304, "acc": 0.8434028029441833, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2944522798061371, "acc": 0.8739538788795471, "length": 3.99164080619812, "mode": "train", "epoch": 13}
{"loss": 0.3475283682346344, "acc": 0.8480902910232544, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2795272171497345, "acc": 0.8829493522644043, "length": 3.9942786693573, "mode": "train", "epoch": 14}
{"loss": 0.3184139132499695, "acc": 0.8644096851348877, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.26482832431793213, "acc": 0.8923729062080383, "length": 3.994936466217041, "mode": "train", "epoch": 15}
{"loss": 0.2999180853366852, "acc": 0.8847222924232483, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2594057023525238, "acc": 0.8966843485832214, "length": 3.9972193241119385, "mode": "train", "epoch": 16}
{"loss": 0.29815906286239624, "acc": 0.8824653029441833, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2519341707229614, "acc": 0.899141788482666, "length": 3.9979350566864014, "mode": "train", "epoch": 17}
{"loss": 0.286914587020874, "acc": 0.8821181058883667, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.24882227182388306, "acc": 0.90388023853302, "length": 3.9973626136779785, "mode": "train", "epoch": 18}
{"loss": 0.2833091914653778, "acc": 0.8939235210418701, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.24172455072402954, "acc": 0.9063482880592346, "length": 3.9985594749450684, "mode": "train", "epoch": 19}
{"loss": 0.27405422925949097, "acc": 0.8972222208976746, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.23372529447078705, "acc": 0.9145297408103943, "length": 3.99884295463562, "mode": "train", "epoch": 20}
{"loss": 0.26992785930633545, "acc": 0.8996527791023254, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2269320785999298, "acc": 0.913374125957489, "length": 3.9990484714508057, "mode": "train", "epoch": 21}
{"loss": 0.2592143416404724, "acc": 0.9059027433395386, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.22508300840854645, "acc": 0.916109561920166, "length": 3.9993486404418945, "mode": "train", "epoch": 22}
{"loss": 0.2666817009449005, "acc": 0.9031249284744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.22165396809577942, "acc": 0.9122145175933838, "length": 3.999107599258423, "mode": "train", "epoch": 23}
{"loss": 0.25650930404663086, "acc": 0.9072917103767395, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2228141576051712, "acc": 0.9172192811965942, "length": 3.999676465988159, "mode": "train", "epoch": 24}
{"loss": 0.25038793683052063, "acc": 0.9055556058883667, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.21610145270824432, "acc": 0.9191371202468872, "length": 3.9997358322143555, "mode": "train", "epoch": 25}
{"loss": 0.2374778836965561, "acc": 0.9184027910232544, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2171233892440796, "acc": 0.917686939239502, "length": 3.99979305267334, "mode": "train", "epoch": 26}
{"loss": 0.2388927936553955, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2124514877796173, "acc": 0.9179752469062805, "length": 3.9996273517608643, "mode": "train", "epoch": 27}
{"loss": 0.23392987251281738, "acc": 0.9227430820465088, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.20971208810806274, "acc": 0.9188463091850281, "length": 3.9997289180755615, "mode": "train", "epoch": 28}
{"loss": 0.21997560560703278, "acc": 0.9185764789581299, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.20516420900821686, "acc": 0.9255197048187256, "length": 3.999871015548706, "mode": "train", "epoch": 29}
{"loss": 0.2205987423658371, "acc": 0.9274305701255798, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2101506143808365, "acc": 0.9202993512153625, "length": 3.999889612197876, "mode": "train", "epoch": 30}
{"loss": 0.21444015204906464, "acc": 0.9298611879348755, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.20900461077690125, "acc": 0.9201834201812744, "length": 3.9999125003814697, "mode": "train", "epoch": 31}
{"loss": 0.23615704476833344, "acc": 0.9194445013999939, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.19819825887680054, "acc": 0.9256957769393921, "length": 3.9998526573181152, "mode": "train", "epoch": 32}
{"loss": 0.21527396142482758, "acc": 0.9236111044883728, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.20048797130584717, "acc": 0.9258061051368713, "length": 3.9997780323028564, "mode": "train", "epoch": 33}
{"loss": 0.20464399456977844, "acc": 0.9260416030883789, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.20649582147598267, "acc": 0.9216829538345337, "length": 3.9995388984680176, "mode": "train", "epoch": 34}
{"loss": 0.21087263524532318, "acc": 0.9253472089767456, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.20188948512077332, "acc": 0.9213452339172363, "length": 3.9999659061431885, "mode": "train", "epoch": 35}
{"loss": 0.20637652277946472, "acc": 0.9331597089767456, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.19290274381637573, "acc": 0.9284802079200745, "length": 3.9999940395355225, "mode": "train", "epoch": 36}
{"loss": 0.2047862410545349, "acc": 0.925868034362793, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.19769756495952606, "acc": 0.9245938062667847, "length": 3.9999852180480957, "mode": "train", "epoch": 37}
{"loss": 0.23171135783195496, "acc": 0.9262152910232544, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1934853494167328, "acc": 0.9273779392242432, "length": 3.999986410140991, "mode": "train", "epoch": 38}
{"loss": 0.2102336585521698, "acc": 0.9281250834465027, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.19259077310562134, "acc": 0.9302204847335815, "length": 3.999983310699463, "mode": "train", "epoch": 39}
{"loss": 0.21639937162399292, "acc": 0.9298611879348755, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19443024694919586, "acc": 0.928244948387146, "length": 3.9998631477355957, "mode": "train", "epoch": 40}
{"loss": 0.19897669553756714, "acc": 0.9305555820465088, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.18852394819259644, "acc": 0.929408073425293, "length": 3.9999921321868896, "mode": "train", "epoch": 41}
{"loss": 0.1961645483970642, "acc": 0.9312499165534973, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1836247742176056, "acc": 0.9304496049880981, "length": 3.9997072219848633, "mode": "train", "epoch": 42}
{"loss": 0.20082122087478638, "acc": 0.9291666746139526, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.18674419820308685, "acc": 0.9308004379272461, "length": 3.99999737739563, "mode": "train", "epoch": 43}
{"loss": 0.1997859627008438, "acc": 0.9236111044883728, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.18421144783496857, "acc": 0.9328885078430176, "length": 3.999999523162842, "mode": "train", "epoch": 44}
{"loss": 0.19587010145187378, "acc": 0.9340277910232544, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.18222177028656006, "acc": 0.9312642216682434, "length": 3.999985933303833, "mode": "train", "epoch": 45}
{"loss": 0.20234069228172302, "acc": 0.9322916865348816, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.17876605689525604, "acc": 0.9356727600097656, "length": 3.9999959468841553, "mode": "train", "epoch": 46}
{"loss": 0.1964816451072693, "acc": 0.9366319179534912, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.17802554368972778, "acc": 0.9341645836830139, "length": 3.9999969005584717, "mode": "train", "epoch": 47}
{"loss": 0.1995002180337906, "acc": 0.9338541030883789, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.17534516751766205, "acc": 0.937122642993927, "length": 3.999992609024048, "mode": "train", "epoch": 48}
{"loss": 0.19586925208568573, "acc": 0.9319444298744202, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.17475102841854095, "acc": 0.9375869631767273, "length": 3.999999523162842, "mode": "train", "epoch": 49}
{"loss": 0.20659783482551575, "acc": 0.9348958134651184, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.17336004972457886, "acc": 0.9364846348762512, "length": 3.999992847442627, "mode": "train", "epoch": 50}
{"loss": 0.1987432986497879, "acc": 0.9359375834465027, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.16675184667110443, "acc": 0.9400231838226318, "length": 3.9999983310699463, "mode": "train", "epoch": 51}
{"loss": 0.1906222105026245, "acc": 0.9380208253860474, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.18221698701381683, "acc": 0.9360788464546204, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.2071181833744049, "acc": 0.9295138120651245, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.17256976664066315, "acc": 0.9377602934837341, "length": 3.9999771118164062, "mode": "train", "epoch": 53}
{"loss": 0.19259116053581238, "acc": 0.9362847208976746, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.17151327431201935, "acc": 0.935904860496521, "length": 3.999995470046997, "mode": "train", "epoch": 54}
{"loss": 0.1915571093559265, "acc": 0.9331597089767456, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1661301851272583, "acc": 0.9392691850662231, "length": 3.999999761581421, "mode": "train", "epoch": 55}
{"loss": 0.19569003582000732, "acc": 0.9378474354743958, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.16355669498443604, "acc": 0.9419952034950256, "length": 3.99999737739563, "mode": "train", "epoch": 56}
{"loss": 0.1886955201625824, "acc": 0.9397570490837097, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.16160325706005096, "acc": 0.9418790936470032, "length": 3.9999959468841553, "mode": "train", "epoch": 57}
{"loss": 0.20059388875961304, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1694207787513733, "acc": 0.9398491978645325, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.17714381217956543, "acc": 0.9395833611488342, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1598631739616394, "acc": 0.94199538230896, "length": 3.9999983310699463, "mode": "train", "epoch": 59}
{"loss": 0.1918555349111557, "acc": 0.9395832419395447, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.15936531126499176, "acc": 0.944779634475708, "length": 3.9999983310699463, "mode": "train", "epoch": 60}
{"loss": 0.18160170316696167, "acc": 0.9421875476837158, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8149999976158142
