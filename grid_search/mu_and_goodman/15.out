ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6929551959037781, "acc": 0.5190443992614746, "length": 3.1065564155578613, "mode": "train", "epoch": 1}
{"loss": 0.6829392313957214, "acc": 0.5696180462837219, "length": 1.6875, "mode": "test", "epoch": 1}
{"loss": 0.6050514578819275, "acc": 0.6893067359924316, "length": 2.919750452041626, "mode": "train", "epoch": 2}
{"loss": 0.5365793704986572, "acc": 0.7747287154197693, "length": 3.1875, "mode": "test", "epoch": 2}
{"loss": 0.4861482083797455, "acc": 0.7886261343955994, "length": 3.079291582107544, "mode": "train", "epoch": 3}
{"loss": 0.5042720437049866, "acc": 0.7967827320098877, "length": 3.024305582046509, "mode": "test", "epoch": 3}
{"loss": 0.45848697423934937, "acc": 0.8126735687255859, "length": 2.9594883918762207, "mode": "train", "epoch": 4}
{"loss": 0.494651734828949, "acc": 0.8003146648406982, "length": 2.961805582046509, "mode": "test", "epoch": 4}
{"loss": 0.4363836646080017, "acc": 0.8162336945533752, "length": 2.9722330570220947, "mode": "train", "epoch": 5}
{"loss": 0.4614907503128052, "acc": 0.8045409321784973, "length": 3.0763888359069824, "mode": "test", "epoch": 5}
{"loss": 0.4122459888458252, "acc": 0.8177063465118408, "length": 3.0697851181030273, "mode": "train", "epoch": 6}
{"loss": 0.439075231552124, "acc": 0.8095378279685974, "length": 3.1041667461395264, "mode": "test", "epoch": 6}
{"loss": 0.38649001717567444, "acc": 0.8282666206359863, "length": 3.119889974594116, "mode": "train", "epoch": 7}
{"loss": 0.4303446412086487, "acc": 0.8099663257598877, "length": 3.0729167461395264, "mode": "test", "epoch": 7}
{"loss": 0.3747771680355072, "acc": 0.8296788930892944, "length": 3.183967351913452, "mode": "train", "epoch": 8}
{"loss": 0.4003039598464966, "acc": 0.8205458521842957, "length": 3.3333332538604736, "mode": "test", "epoch": 8}
{"loss": 0.34672513604164124, "acc": 0.842271625995636, "length": 3.3945910930633545, "mode": "train", "epoch": 9}
{"loss": 0.3699237108230591, "acc": 0.8349664211273193, "length": 3.7291667461395264, "mode": "test", "epoch": 9}
{"loss": 0.30712437629699707, "acc": 0.8747143149375916, "length": 3.5864105224609375, "mode": "train", "epoch": 10}
{"loss": 0.3416341245174408, "acc": 0.8597384691238403, "length": 3.7604167461395264, "mode": "test", "epoch": 10}
{"loss": 0.2797324061393738, "acc": 0.8846456408500671, "length": 3.7117063999176025, "mode": "train", "epoch": 11}
{"loss": 0.30415618419647217, "acc": 0.8759331107139587, "length": 3.9791667461395264, "mode": "test", "epoch": 11}
{"loss": 0.2611035108566284, "acc": 0.8942488431930542, "length": 3.892571449279785, "mode": "train", "epoch": 12}
{"loss": 0.29756662249565125, "acc": 0.8792535066604614, "length": 3.9791667461395264, "mode": "test", "epoch": 12}
{"loss": 0.25645652413368225, "acc": 0.8955731987953186, "length": 3.9382164478302, "mode": "train", "epoch": 13}
{"loss": 0.3079957962036133, "acc": 0.8735894560813904, "length": 3.9791667461395264, "mode": "test", "epoch": 13}
{"loss": 0.2510454058647156, "acc": 0.9011046886444092, "length": 3.9331276416778564, "mode": "train", "epoch": 14}
{"loss": 0.29569244384765625, "acc": 0.8854166865348816, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2358299046754837, "acc": 0.9079852104187012, "length": 3.959512948989868, "mode": "train", "epoch": 15}
{"loss": 0.29353153705596924, "acc": 0.8861110210418701, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2354421466588974, "acc": 0.9100651741027832, "length": 3.9309725761413574, "mode": "train", "epoch": 16}
{"loss": 0.28804731369018555, "acc": 0.8970485329627991, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.23297689855098724, "acc": 0.9119035005569458, "length": 3.968864917755127, "mode": "train", "epoch": 17}
{"loss": 0.29220473766326904, "acc": 0.8852429986000061, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.23091915249824524, "acc": 0.9096306562423706, "length": 3.9802417755126953, "mode": "train", "epoch": 18}
{"loss": 0.2858738601207733, "acc": 0.8909722566604614, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2215946763753891, "acc": 0.9117934107780457, "length": 3.9896364212036133, "mode": "train", "epoch": 19}
{"loss": 0.2731342315673828, "acc": 0.9005208611488342, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21490086615085602, "acc": 0.9165396094322205, "length": 3.9965476989746094, "mode": "train", "epoch": 20}
{"loss": 0.2695479691028595, "acc": 0.8951389789581299, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21054522693157196, "acc": 0.9176349639892578, "length": 3.995406150817871, "mode": "train", "epoch": 21}
{"loss": 0.2675151228904724, "acc": 0.8951389789581299, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.19891710579395294, "acc": 0.9208975434303284, "length": 3.99858021736145, "mode": "train", "epoch": 22}
{"loss": 0.2611125409603119, "acc": 0.9032986164093018, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.20065279304981232, "acc": 0.9214088916778564, "length": 3.9986891746520996, "mode": "train", "epoch": 23}
{"loss": 0.26890814304351807, "acc": 0.8973957896232605, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.19888080656528473, "acc": 0.9197108745574951, "length": 3.998732089996338, "mode": "train", "epoch": 24}
{"loss": 0.24844203889369965, "acc": 0.90625, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1859624683856964, "acc": 0.9286407232284546, "length": 3.998159885406494, "mode": "train", "epoch": 25}
{"loss": 0.2558649182319641, "acc": 0.9008679986000061, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.18685376644134521, "acc": 0.9267277121543884, "length": 3.9955503940582275, "mode": "train", "epoch": 26}
{"loss": 0.25892287492752075, "acc": 0.9050347805023193, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.20142146944999695, "acc": 0.9166713953018188, "length": 3.998293399810791, "mode": "train", "epoch": 27}
{"loss": 0.264763742685318, "acc": 0.9039930701255798, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19568420946598053, "acc": 0.9208627343177795, "length": 3.9995086193084717, "mode": "train", "epoch": 28}
{"loss": 0.27045467495918274, "acc": 0.9043402075767517, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.1930210143327713, "acc": 0.9263990521430969, "length": 3.997136354446411, "mode": "train", "epoch": 29}
{"loss": 0.2541642189025879, "acc": 0.9079861044883728, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18000461161136627, "acc": 0.9281983971595764, "length": 3.9984443187713623, "mode": "train", "epoch": 30}
{"loss": 0.22666682302951813, "acc": 0.9187500476837158, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.174961656332016, "acc": 0.9308571815490723, "length": 3.9991438388824463, "mode": "train", "epoch": 31}
{"loss": 0.22132448852062225, "acc": 0.9243054986000061, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17465005815029144, "acc": 0.933864951133728, "length": 3.9994187355041504, "mode": "train", "epoch": 32}
{"loss": 0.21314917504787445, "acc": 0.9262152910232544, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17418910562992096, "acc": 0.9344498515129089, "length": 3.995908737182617, "mode": "train", "epoch": 33}
{"loss": 0.2062840461730957, "acc": 0.9249999523162842, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1702599674463272, "acc": 0.9358006119728088, "length": 3.999919891357422, "mode": "train", "epoch": 34}
{"loss": 0.20128220319747925, "acc": 0.9276041388511658, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.16908815503120422, "acc": 0.9353340864181519, "length": 3.998278856277466, "mode": "train", "epoch": 35}
{"loss": 0.25448736548423767, "acc": 0.9088541865348816, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.18177847564220428, "acc": 0.9277693033218384, "length": 3.999919891357422, "mode": "train", "epoch": 36}
{"loss": 0.2238474190235138, "acc": 0.9249999523162842, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.17000670731067657, "acc": 0.9366497993469238, "length": 3.999873399734497, "mode": "train", "epoch": 37}
{"loss": 0.22063255310058594, "acc": 0.9279513955116272, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.16448955237865448, "acc": 0.9377087354660034, "length": 3.9994633197784424, "mode": "train", "epoch": 38}
{"loss": 0.21426281332969666, "acc": 0.933159589767456, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16250653564929962, "acc": 0.9402682185173035, "length": 3.9999146461486816, "mode": "train", "epoch": 39}
{"loss": 0.18437154591083527, "acc": 0.9378472566604614, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15794742107391357, "acc": 0.9427525401115417, "length": 3.9997599124908447, "mode": "train", "epoch": 40}
{"loss": 0.2132217288017273, "acc": 0.9340277910232544, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.17003343999385834, "acc": 0.9365372657775879, "length": 3.999955892562866, "mode": "train", "epoch": 41}
{"loss": 0.24299833178520203, "acc": 0.9128472208976746, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1731896698474884, "acc": 0.9350100159645081, "length": 3.999929904937744, "mode": "train", "epoch": 42}
{"loss": 0.2134442925453186, "acc": 0.9227430820465088, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.17593319714069366, "acc": 0.9295688271522522, "length": 3.99955415725708, "mode": "train", "epoch": 43}
{"loss": 0.23707059025764465, "acc": 0.9230902791023254, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.17048504948616028, "acc": 0.9343112111091614, "length": 3.9967470169067383, "mode": "train", "epoch": 44}
{"loss": 0.20844240486621857, "acc": 0.9307292103767395, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.16307613253593445, "acc": 0.9361988306045532, "length": 3.9999923706054688, "mode": "train", "epoch": 45}
{"loss": 0.21498502790927887, "acc": 0.9319444298744202, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1589948832988739, "acc": 0.941176176071167, "length": 3.9999940395355225, "mode": "train", "epoch": 46}
{"loss": 0.20525743067264557, "acc": 0.9255208969116211, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.16124869883060455, "acc": 0.9363064169883728, "length": 3.9998281002044678, "mode": "train", "epoch": 47}
{"loss": 0.2015068233013153, "acc": 0.9350695013999939, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1572113037109375, "acc": 0.9422464370727539, "length": 3.999866247177124, "mode": "train", "epoch": 48}
{"loss": 0.2067880928516388, "acc": 0.9326388835906982, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1677987277507782, "acc": 0.9374426007270813, "length": 3.9999794960021973, "mode": "train", "epoch": 49}
{"loss": 0.20492778718471527, "acc": 0.9319444298744202, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.15909849107265472, "acc": 0.9400964379310608, "length": 3.9998645782470703, "mode": "train", "epoch": 50}
{"loss": 0.17506754398345947, "acc": 0.9401042461395264, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.15955714881420135, "acc": 0.9407227635383606, "length": 3.9999685287475586, "mode": "train", "epoch": 51}
{"loss": 0.19998307526111603, "acc": 0.9333333969116211, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1536014974117279, "acc": 0.9426469206809998, "length": 3.9999942779541016, "mode": "train", "epoch": 52}
{"loss": 0.17597860097885132, "acc": 0.9392361044883728, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.15296997129917145, "acc": 0.9407798647880554, "length": 3.9999616146087646, "mode": "train", "epoch": 53}
{"loss": 0.1839788854122162, "acc": 0.9383680820465088, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15158577263355255, "acc": 0.941400945186615, "length": 3.998222827911377, "mode": "train", "epoch": 54}
{"loss": 0.18943427503108978, "acc": 0.9394097924232483, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.14920546114444733, "acc": 0.9413447976112366, "length": 3.999952554702759, "mode": "train", "epoch": 55}
{"loss": 0.18353703618049622, "acc": 0.9376736879348755, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1418561488389969, "acc": 0.9438908696174622, "length": 3.9999847412109375, "mode": "train", "epoch": 56}
{"loss": 0.1866454780101776, "acc": 0.9401041865348816, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1397634744644165, "acc": 0.9477799534797668, "length": 3.99967622756958, "mode": "train", "epoch": 57}
{"loss": 0.1830081343650818, "acc": 0.9395833611488342, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.14227864146232605, "acc": 0.9463218450546265, "length": 3.999964714050293, "mode": "train", "epoch": 58}
{"loss": 0.19420023262500763, "acc": 0.9357638955116272, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.14521348476409912, "acc": 0.9445135593414307, "length": 3.999997854232788, "mode": "train", "epoch": 59}
{"loss": 0.188905268907547, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.13709600269794464, "acc": 0.9466623067855835, "length": 3.9999916553497314, "mode": "train", "epoch": 60}
{"loss": 0.17579978704452515, "acc": 0.9402778148651123, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7057693004608154
