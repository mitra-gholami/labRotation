ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6954209208488464, "acc": 0.5215913653373718, "length": 3.5235252380371094, "mode": "train", "epoch": 1}
{"loss": 0.6898189783096313, "acc": 0.5490737557411194, "length": 1.046875, "mode": "test", "epoch": 1}
{"loss": 0.6893965601921082, "acc": 0.5327736139297485, "length": 3.4617607593536377, "mode": "train", "epoch": 2}
{"loss": 0.6790353059768677, "acc": 0.5958175659179688, "length": 1.7421875, "mode": "test", "epoch": 2}
{"loss": 0.6882108449935913, "acc": 0.5284679532051086, "length": 3.4138879776000977, "mode": "train", "epoch": 3}
{"loss": 0.6668218374252319, "acc": 0.6188018321990967, "length": 2.72265625, "mode": "test", "epoch": 3}
{"loss": 0.6766106486320496, "acc": 0.5660041570663452, "length": 3.4132513999938965, "mode": "train", "epoch": 4}
{"loss": 0.6362696886062622, "acc": 0.6268951892852783, "length": 3.49609375, "mode": "test", "epoch": 4}
{"loss": 0.6438409090042114, "acc": 0.647484302520752, "length": 3.4833555221557617, "mode": "train", "epoch": 5}
{"loss": 0.5787643194198608, "acc": 0.7328475713729858, "length": 3.96484375, "mode": "test", "epoch": 5}
{"loss": 0.5712687373161316, "acc": 0.7397750616073608, "length": 3.7117016315460205, "mode": "train", "epoch": 6}
{"loss": 0.5123316049575806, "acc": 0.7603515982627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5114958882331848, "acc": 0.7536489367485046, "length": 3.88612699508667, "mode": "train", "epoch": 7}
{"loss": 0.4895595908164978, "acc": 0.7876953482627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.48341935873031616, "acc": 0.761987030506134, "length": 3.954505681991577, "mode": "train", "epoch": 8}
{"loss": 0.47945860028266907, "acc": 0.7826171517372131, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4782788157463074, "acc": 0.7688844203948975, "length": 3.958717107772827, "mode": "train", "epoch": 9}
{"loss": 0.482289582490921, "acc": 0.7835937142372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4579800069332123, "acc": 0.7751715779304504, "length": 3.9601082801818848, "mode": "train", "epoch": 10}
{"loss": 0.4723588228225708, "acc": 0.7957031726837158, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4428010880947113, "acc": 0.7956977486610413, "length": 3.9642229080200195, "mode": "train", "epoch": 11}
{"loss": 0.46816205978393555, "acc": 0.7998046875, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.425067275762558, "acc": 0.8023065328598022, "length": 3.974071502685547, "mode": "train", "epoch": 12}
{"loss": 0.45276975631713867, "acc": 0.8042968511581421, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.39913153648376465, "acc": 0.8168901205062866, "length": 3.9804675579071045, "mode": "train", "epoch": 13}
{"loss": 0.44519877433776855, "acc": 0.8113282918930054, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.37266993522644043, "acc": 0.8327882289886475, "length": 3.989283323287964, "mode": "train", "epoch": 14}
{"loss": 0.42665377259254456, "acc": 0.8156251311302185, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3447377383708954, "acc": 0.8393120169639587, "length": 3.9921441078186035, "mode": "train", "epoch": 15}
{"loss": 0.4119090735912323, "acc": 0.8251953721046448, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.32959872484207153, "acc": 0.8448149561882019, "length": 3.9933481216430664, "mode": "train", "epoch": 16}
{"loss": 0.39278244972229004, "acc": 0.8376952409744263, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.32390204071998596, "acc": 0.8544785976409912, "length": 3.9945170879364014, "mode": "train", "epoch": 17}
{"loss": 0.3517717123031616, "acc": 0.8449219465255737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.30833402276039124, "acc": 0.8656665682792664, "length": 3.9946091175079346, "mode": "train", "epoch": 18}
{"loss": 0.3702971339225769, "acc": 0.8470702767372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.29801562428474426, "acc": 0.8655155897140503, "length": 3.994333267211914, "mode": "train", "epoch": 19}
{"loss": 0.3533364534378052, "acc": 0.8548827767372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2923416793346405, "acc": 0.8720452785491943, "length": 3.996448516845703, "mode": "train", "epoch": 20}
{"loss": 0.34950488805770874, "acc": 0.8568359017372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.28716138005256653, "acc": 0.8748769760131836, "length": 3.9958090782165527, "mode": "train", "epoch": 21}
{"loss": 0.32815980911254883, "acc": 0.8646484017372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.28464218974113464, "acc": 0.875004231929779, "length": 3.9974005222320557, "mode": "train", "epoch": 22}
{"loss": 0.3189685344696045, "acc": 0.8703125715255737, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.28312620520591736, "acc": 0.8850440382957458, "length": 3.9981939792633057, "mode": "train", "epoch": 23}
{"loss": 0.31520867347717285, "acc": 0.8736328482627869, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.27328792214393616, "acc": 0.8863275647163391, "length": 3.9984428882598877, "mode": "train", "epoch": 24}
{"loss": 0.2948329448699951, "acc": 0.8781250715255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.25936928391456604, "acc": 0.8920183777809143, "length": 3.9984371662139893, "mode": "train", "epoch": 25}
{"loss": 0.29210853576660156, "acc": 0.8796874284744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2533778250217438, "acc": 0.8962158560752869, "length": 3.996960401535034, "mode": "train", "epoch": 26}
{"loss": 0.2630758285522461, "acc": 0.8931641578674316, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.24572409689426422, "acc": 0.8985763788223267, "length": 3.99812388420105, "mode": "train", "epoch": 27}
{"loss": 0.256202757358551, "acc": 0.9048828482627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23774755001068115, "acc": 0.9022464752197266, "length": 3.998180866241455, "mode": "train", "epoch": 28}
{"loss": 0.26699239015579224, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.234249547123909, "acc": 0.9051612019538879, "length": 3.997246265411377, "mode": "train", "epoch": 29}
{"loss": 0.2517210841178894, "acc": 0.9005860090255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2283851057291031, "acc": 0.9103853702545166, "length": 3.9984171390533447, "mode": "train", "epoch": 30}
{"loss": 0.23862522840499878, "acc": 0.9078125357627869, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.21549253165721893, "acc": 0.9159601926803589, "length": 3.998324155807495, "mode": "train", "epoch": 31}
{"loss": 0.23577582836151123, "acc": 0.9072265625, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2157820463180542, "acc": 0.9163138270378113, "length": 3.9983420372009277, "mode": "train", "epoch": 32}
{"loss": 0.21760357916355133, "acc": 0.9205078482627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2018446922302246, "acc": 0.9257570505142212, "length": 3.9995195865631104, "mode": "train", "epoch": 33}
{"loss": 0.22187775373458862, "acc": 0.9130859375, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.20527896285057068, "acc": 0.9212875962257385, "length": 3.999429941177368, "mode": "train", "epoch": 34}
{"loss": 0.21930868923664093, "acc": 0.9097656607627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1948925405740738, "acc": 0.9258593320846558, "length": 3.9982104301452637, "mode": "train", "epoch": 35}
{"loss": 0.2047327160835266, "acc": 0.9187498688697815, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1883305162191391, "acc": 0.9246542453765869, "length": 3.9996590614318848, "mode": "train", "epoch": 36}
{"loss": 0.20227426290512085, "acc": 0.9224610328674316, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.19267116487026215, "acc": 0.9296199083328247, "length": 3.9991860389709473, "mode": "train", "epoch": 37}
{"loss": 0.2077709287405014, "acc": 0.9169922471046448, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.18054251372814178, "acc": 0.9310816526412964, "length": 3.9995081424713135, "mode": "train", "epoch": 38}
{"loss": 0.1959877610206604, "acc": 0.921875, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.18322958052158356, "acc": 0.9297267198562622, "length": 3.9995837211608887, "mode": "train", "epoch": 39}
{"loss": 0.19718152284622192, "acc": 0.9222655892372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.17632082104682922, "acc": 0.9340749979019165, "length": 3.9987194538116455, "mode": "train", "epoch": 40}
{"loss": 0.20543056726455688, "acc": 0.9195312857627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1777370125055313, "acc": 0.9334011077880859, "length": 3.9988975524902344, "mode": "train", "epoch": 41}
{"loss": 0.18965524435043335, "acc": 0.9273438453674316, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.17273585498332977, "acc": 0.93327796459198, "length": 3.9992384910583496, "mode": "train", "epoch": 42}
{"loss": 0.18615293502807617, "acc": 0.9314452409744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.16377457976341248, "acc": 0.9378795623779297, "length": 3.99975323677063, "mode": "train", "epoch": 43}
{"loss": 0.18420051038265228, "acc": 0.9304686188697815, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.17026837170124054, "acc": 0.9376320242881775, "length": 3.999751567840576, "mode": "train", "epoch": 44}
{"loss": 0.19905070960521698, "acc": 0.9244140982627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.16061046719551086, "acc": 0.9385342597961426, "length": 3.999143362045288, "mode": "train", "epoch": 45}
{"loss": 0.17987439036369324, "acc": 0.9306641221046448, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.16482608020305634, "acc": 0.9384909272193909, "length": 3.9998674392700195, "mode": "train", "epoch": 46}
{"loss": 0.18413667380809784, "acc": 0.9330077171325684, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.16960380971431732, "acc": 0.9386776089668274, "length": 3.9999821186065674, "mode": "train", "epoch": 47}
{"loss": 0.1800917237997055, "acc": 0.9324218034744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.16641990840435028, "acc": 0.94044029712677, "length": 3.99908447265625, "mode": "train", "epoch": 48}
{"loss": 0.1806229054927826, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1528339833021164, "acc": 0.9424721002578735, "length": 3.999988555908203, "mode": "train", "epoch": 49}
{"loss": 0.18817710876464844, "acc": 0.9302734732627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.15213263034820557, "acc": 0.9454678893089294, "length": 3.99989652633667, "mode": "train", "epoch": 50}
{"loss": 0.1756894588470459, "acc": 0.9359374642372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.145977184176445, "acc": 0.9429002404212952, "length": 3.999962329864502, "mode": "train", "epoch": 51}
{"loss": 0.17469272017478943, "acc": 0.9343749284744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.14933562278747559, "acc": 0.9435694217681885, "length": 3.999907970428467, "mode": "train", "epoch": 52}
{"loss": 0.172274649143219, "acc": 0.9398437142372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.14634431898593903, "acc": 0.9449200630187988, "length": 3.999992609024048, "mode": "train", "epoch": 53}
{"loss": 0.17125844955444336, "acc": 0.9361329078674316, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1490509808063507, "acc": 0.9473423957824707, "length": 3.999462366104126, "mode": "train", "epoch": 54}
{"loss": 0.17790712416172028, "acc": 0.9337891340255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.14868225157260895, "acc": 0.945593535900116, "length": 3.999994993209839, "mode": "train", "epoch": 55}
{"loss": 0.15904857218265533, "acc": 0.9392577409744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1448335200548172, "acc": 0.9498156309127808, "length": 3.9999582767486572, "mode": "train", "epoch": 56}
{"loss": 0.19146588444709778, "acc": 0.9367188811302185, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.14694806933403015, "acc": 0.9472450613975525, "length": 3.9999749660491943, "mode": "train", "epoch": 57}
{"loss": 0.16710758209228516, "acc": 0.9367188215255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.14135807752609253, "acc": 0.9481638669967651, "length": 3.9999988079071045, "mode": "train", "epoch": 58}
{"loss": 0.15425986051559448, "acc": 0.9488281607627869, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.13828027248382568, "acc": 0.9490144848823547, "length": 3.999608039855957, "mode": "train", "epoch": 59}
{"loss": 0.15219882130622864, "acc": 0.9460939168930054, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.12552262842655182, "acc": 0.9539158940315247, "length": 3.99997615814209, "mode": "train", "epoch": 60}
{"loss": 0.1604243516921997, "acc": 0.9419922232627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8712856769561768
