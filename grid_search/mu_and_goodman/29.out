ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6943608522415161, "acc": 0.5240928530693054, "length": 3.534271001815796, "mode": "train", "epoch": 1}
{"loss": 0.692359209060669, "acc": 0.5259765982627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6898022890090942, "acc": 0.522417426109314, "length": 3.458338975906372, "mode": "train", "epoch": 2}
{"loss": 0.6906717419624329, "acc": 0.5347656607627869, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6880366206169128, "acc": 0.5459825396537781, "length": 3.3560032844543457, "mode": "train", "epoch": 3}
{"loss": 0.6702004671096802, "acc": 0.5939575433731079, "length": 2.23828125, "mode": "test", "epoch": 3}
{"loss": 0.6701962351799011, "acc": 0.6010667681694031, "length": 3.373350143432617, "mode": "train", "epoch": 4}
{"loss": 0.637007474899292, "acc": 0.6815735101699829, "length": 3.94140625, "mode": "test", "epoch": 4}
{"loss": 0.6427996754646301, "acc": 0.6596084833145142, "length": 3.6950271129608154, "mode": "train", "epoch": 5}
{"loss": 0.5891171097755432, "acc": 0.7042968273162842, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5840663909912109, "acc": 0.7033087611198425, "length": 3.8492627143859863, "mode": "train", "epoch": 6}
{"loss": 0.5627461075782776, "acc": 0.7208985090255737, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.53568035364151, "acc": 0.7404031753540039, "length": 3.8838255405426025, "mode": "train", "epoch": 7}
{"loss": 0.5251005291938782, "acc": 0.7394530773162842, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.49039170145988464, "acc": 0.7733643054962158, "length": 3.903496742248535, "mode": "train", "epoch": 8}
{"loss": 0.4940917491912842, "acc": 0.7818359732627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4361984431743622, "acc": 0.8153488636016846, "length": 3.9322268962860107, "mode": "train", "epoch": 9}
{"loss": 0.4661214351654053, "acc": 0.7976562976837158, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3997025489807129, "acc": 0.8207621574401855, "length": 3.9531092643737793, "mode": "train", "epoch": 10}
{"loss": 0.460726261138916, "acc": 0.7962890267372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3825458884239197, "acc": 0.8327745199203491, "length": 3.968189239501953, "mode": "train", "epoch": 11}
{"loss": 0.4455152750015259, "acc": 0.8021484017372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.38067421317100525, "acc": 0.8345596790313721, "length": 3.971080780029297, "mode": "train", "epoch": 12}
{"loss": 0.4406278729438782, "acc": 0.8091797232627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.36250853538513184, "acc": 0.845769464969635, "length": 3.9757442474365234, "mode": "train", "epoch": 13}
{"loss": 0.4187588393688202, "acc": 0.81640625, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3377203047275543, "acc": 0.8534957766532898, "length": 3.977529287338257, "mode": "train", "epoch": 14}
{"loss": 0.4033164978027344, "acc": 0.8193359375, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.32549625635147095, "acc": 0.8624454736709595, "length": 3.979356527328491, "mode": "train", "epoch": 15}
{"loss": 0.3885961174964905, "acc": 0.8369140625, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.29822906851768494, "acc": 0.8791958093643188, "length": 3.9824914932250977, "mode": "train", "epoch": 16}
{"loss": 0.3808366060256958, "acc": 0.8408203125, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2879912555217743, "acc": 0.8844199180603027, "length": 3.985327959060669, "mode": "train", "epoch": 17}
{"loss": 0.3771953582763672, "acc": 0.8511719107627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.27530330419540405, "acc": 0.8888939619064331, "length": 3.9866409301757812, "mode": "train", "epoch": 18}
{"loss": 0.3694559335708618, "acc": 0.8474608063697815, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2640704810619354, "acc": 0.8927714228630066, "length": 3.988250970840454, "mode": "train", "epoch": 19}
{"loss": 0.36258837580680847, "acc": 0.8621093034744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2577592730522156, "acc": 0.897057056427002, "length": 3.9888710975646973, "mode": "train", "epoch": 20}
{"loss": 0.33968257904052734, "acc": 0.8685546517372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.24507896602153778, "acc": 0.8986674547195435, "length": 3.990316152572632, "mode": "train", "epoch": 21}
{"loss": 0.32300835847854614, "acc": 0.8783202767372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23290720582008362, "acc": 0.9082393050193787, "length": 3.989755392074585, "mode": "train", "epoch": 22}
{"loss": 0.3067586123943329, "acc": 0.8841796517372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.22547774016857147, "acc": 0.9097020626068115, "length": 3.9907500743865967, "mode": "train", "epoch": 23}
{"loss": 0.3197470009326935, "acc": 0.8792968988418579, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.21255218982696533, "acc": 0.9161142706871033, "length": 3.991311550140381, "mode": "train", "epoch": 24}
{"loss": 0.3111025094985962, "acc": 0.8816405534744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20045766234397888, "acc": 0.9227718114852905, "length": 3.992424964904785, "mode": "train", "epoch": 25}
{"loss": 0.33831164240837097, "acc": 0.8712891936302185, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.19597084820270538, "acc": 0.924426257610321, "length": 3.9912025928497314, "mode": "train", "epoch": 26}
{"loss": 0.32700449228286743, "acc": 0.8759765625, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.18705740571022034, "acc": 0.9302563071250916, "length": 3.9927802085876465, "mode": "train", "epoch": 27}
{"loss": 0.31862539052963257, "acc": 0.8763671517372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19137072563171387, "acc": 0.9291813373565674, "length": 3.9927868843078613, "mode": "train", "epoch": 28}
{"loss": 0.3254282474517822, "acc": 0.865234375, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18301822245121002, "acc": 0.9300217628479004, "length": 3.994027614593506, "mode": "train", "epoch": 29}
{"loss": 0.3164161741733551, "acc": 0.8742188215255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.17741715908050537, "acc": 0.9358985424041748, "length": 3.994263172149658, "mode": "train", "epoch": 30}
{"loss": 0.31797584891319275, "acc": 0.8779296875, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1739332675933838, "acc": 0.9373792409896851, "length": 3.994490623474121, "mode": "train", "epoch": 31}
{"loss": 0.3102429211139679, "acc": 0.8712891340255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17537817358970642, "acc": 0.9358107447624207, "length": 3.9956459999084473, "mode": "train", "epoch": 32}
{"loss": 0.30155691504478455, "acc": 0.8806639909744263, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17019018530845642, "acc": 0.9355019927024841, "length": 3.995743989944458, "mode": "train", "epoch": 33}
{"loss": 0.28681549429893494, "acc": 0.8734374642372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.16555628180503845, "acc": 0.9416666626930237, "length": 3.995623826980591, "mode": "train", "epoch": 34}
{"loss": 0.2850703001022339, "acc": 0.880859375, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.16467498242855072, "acc": 0.9397312998771667, "length": 3.995776891708374, "mode": "train", "epoch": 35}
{"loss": 0.3320102095603943, "acc": 0.8648437857627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.17663346230983734, "acc": 0.936033308506012, "length": 3.996927499771118, "mode": "train", "epoch": 36}
{"loss": 0.29531291127204895, "acc": 0.8890624642372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1546773463487625, "acc": 0.9451872110366821, "length": 3.996690273284912, "mode": "train", "epoch": 37}
{"loss": 0.30695533752441406, "acc": 0.8728514313697815, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.15632477402687073, "acc": 0.9453334808349609, "length": 3.996825695037842, "mode": "train", "epoch": 38}
{"loss": 0.3122785687446594, "acc": 0.8761719465255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.14603599905967712, "acc": 0.949699342250824, "length": 3.9972727298736572, "mode": "train", "epoch": 39}
{"loss": 0.29177728295326233, "acc": 0.8861327767372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.14772841334342957, "acc": 0.9499573111534119, "length": 3.9975998401641846, "mode": "train", "epoch": 40}
{"loss": 0.2835239768028259, "acc": 0.8927735686302185, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.134614035487175, "acc": 0.9508376717567444, "length": 3.997655153274536, "mode": "train", "epoch": 41}
{"loss": 0.26697567105293274, "acc": 0.8906249403953552, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.13731972873210907, "acc": 0.9499180912971497, "length": 3.9972774982452393, "mode": "train", "epoch": 42}
{"loss": 0.27456673979759216, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.14119626581668854, "acc": 0.9497331976890564, "length": 3.9980392456054688, "mode": "train", "epoch": 43}
{"loss": 0.2556832730770111, "acc": 0.8818359375, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.13347405195236206, "acc": 0.9500271677970886, "length": 3.997903347015381, "mode": "train", "epoch": 44}
{"loss": 0.25801801681518555, "acc": 0.8953123688697815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.13468308746814728, "acc": 0.9536156058311462, "length": 3.998288631439209, "mode": "train", "epoch": 45}
{"loss": 0.24680227041244507, "acc": 0.9033203125, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1278659850358963, "acc": 0.9531846642494202, "length": 3.9979424476623535, "mode": "train", "epoch": 46}
{"loss": 0.23972412943840027, "acc": 0.9058594703674316, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.13156811892986298, "acc": 0.952039361000061, "length": 3.998007297515869, "mode": "train", "epoch": 47}
{"loss": 0.2533321678638458, "acc": 0.8970703482627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.12177085876464844, "acc": 0.953926682472229, "length": 3.998591423034668, "mode": "train", "epoch": 48}
{"loss": 0.2579334080219269, "acc": 0.8960937857627869, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.12066676467657089, "acc": 0.953275203704834, "length": 3.998460054397583, "mode": "train", "epoch": 49}
{"loss": 0.23500275611877441, "acc": 0.9013672471046448, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.11677789688110352, "acc": 0.9570332169532776, "length": 3.9974172115325928, "mode": "train", "epoch": 50}
{"loss": 0.22469165921211243, "acc": 0.9111328721046448, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.11563169211149216, "acc": 0.9570603966712952, "length": 3.9984519481658936, "mode": "train", "epoch": 51}
{"loss": 0.2135346531867981, "acc": 0.9158202409744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12757806479930878, "acc": 0.9601965546607971, "length": 3.9988317489624023, "mode": "train", "epoch": 52}
{"loss": 0.1982717514038086, "acc": 0.9283203482627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.13490846753120422, "acc": 0.9506656527519226, "length": 3.9986824989318848, "mode": "train", "epoch": 53}
{"loss": 0.2205791175365448, "acc": 0.9197264313697815, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.12109233438968658, "acc": 0.9563064575195312, "length": 3.99863862991333, "mode": "train", "epoch": 54}
{"loss": 0.21718919277191162, "acc": 0.9181641340255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.10836689919233322, "acc": 0.9597726464271545, "length": 3.9989166259765625, "mode": "train", "epoch": 55}
{"loss": 0.21262449026107788, "acc": 0.9248046875, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1051894947886467, "acc": 0.9640645384788513, "length": 3.997415781021118, "mode": "train", "epoch": 56}
{"loss": 0.20373564958572388, "acc": 0.9232421517372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11383640766143799, "acc": 0.9622963070869446, "length": 3.9991466999053955, "mode": "train", "epoch": 57}
{"loss": 0.1936843991279602, "acc": 0.9326172471046448, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10129117965698242, "acc": 0.9596019387245178, "length": 3.9985480308532715, "mode": "train", "epoch": 58}
{"loss": 0.19367891550064087, "acc": 0.9361329078674316, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09355415403842926, "acc": 0.9658774137496948, "length": 3.99932599067688, "mode": "train", "epoch": 59}
{"loss": 0.20246534049510956, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09435778111219406, "acc": 0.9664218425750732, "length": 3.999451160430908, "mode": "train", "epoch": 60}
{"loss": 0.19083547592163086, "acc": 0.9376954436302185, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8876563310623169
