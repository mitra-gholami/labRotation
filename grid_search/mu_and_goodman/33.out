ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6952877044677734, "acc": 0.5023637413978577, "length": 3.580500364303589, "mode": "train", "epoch": 1}
{"loss": 0.682555079460144, "acc": 0.5851684212684631, "length": 3.09765625, "mode": "test", "epoch": 1}
{"loss": 0.6908920407295227, "acc": 0.537243127822876, "length": 3.529264450073242, "mode": "train", "epoch": 2}
{"loss": 0.672572135925293, "acc": 0.6043548583984375, "length": 2.96875, "mode": "test", "epoch": 2}
{"loss": 0.6852999925613403, "acc": 0.5706731081008911, "length": 3.435182809829712, "mode": "train", "epoch": 3}
{"loss": 0.6585871577262878, "acc": 0.66046142578125, "length": 3.14453125, "mode": "test", "epoch": 3}
{"loss": 0.6616668701171875, "acc": 0.6501267552375793, "length": 3.369140148162842, "mode": "train", "epoch": 4}
{"loss": 0.6121976375579834, "acc": 0.766815185546875, "length": 3.5078125, "mode": "test", "epoch": 4}
{"loss": 0.5943946838378906, "acc": 0.7788944840431213, "length": 3.5245184898376465, "mode": "train", "epoch": 5}
{"loss": 0.5260971784591675, "acc": 0.8044769167900085, "length": 3.87109375, "mode": "test", "epoch": 5}
{"loss": 0.48688584566116333, "acc": 0.8176820278167725, "length": 3.7285349369049072, "mode": "train", "epoch": 6}
{"loss": 0.44469988346099854, "acc": 0.825518786907196, "length": 3.89453125, "mode": "test", "epoch": 6}
{"loss": 0.4112323820590973, "acc": 0.8297157287597656, "length": 3.7902779579162598, "mode": "train", "epoch": 7}
{"loss": 0.4087723195552826, "acc": 0.8254822492599487, "length": 3.8046875, "mode": "test", "epoch": 7}
{"loss": 0.38244906067848206, "acc": 0.8379913568496704, "length": 3.8021936416625977, "mode": "train", "epoch": 8}
{"loss": 0.37247127294540405, "acc": 0.8419342637062073, "length": 3.82421875, "mode": "test", "epoch": 8}
{"loss": 0.3582777976989746, "acc": 0.8523769378662109, "length": 3.8412346839904785, "mode": "train", "epoch": 9}
{"loss": 0.36573314666748047, "acc": 0.8504882454872131, "length": 3.82421875, "mode": "test", "epoch": 9}
{"loss": 0.34545639157295227, "acc": 0.8553748726844788, "length": 3.8482680320739746, "mode": "train", "epoch": 10}
{"loss": 0.35648977756500244, "acc": 0.8446563482284546, "length": 3.84765625, "mode": "test", "epoch": 10}
{"loss": 0.33601588010787964, "acc": 0.855032742023468, "length": 3.9054818153381348, "mode": "train", "epoch": 11}
{"loss": 0.3360782265663147, "acc": 0.857452392578125, "length": 3.890625, "mode": "test", "epoch": 11}
{"loss": 0.32932281494140625, "acc": 0.8607432842254639, "length": 3.921027421951294, "mode": "train", "epoch": 12}
{"loss": 0.32833486795425415, "acc": 0.8641631603240967, "length": 3.94921875, "mode": "test", "epoch": 12}
{"loss": 0.3228268325328827, "acc": 0.8647927045822144, "length": 3.9337055683135986, "mode": "train", "epoch": 13}
{"loss": 0.32294610142707825, "acc": 0.8677582740783691, "length": 3.9921875, "mode": "test", "epoch": 13}
{"loss": 0.31493332982063293, "acc": 0.8702911138534546, "length": 3.955122232437134, "mode": "train", "epoch": 14}
{"loss": 0.30823183059692383, "acc": 0.8707031607627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3094436824321747, "acc": 0.8728049397468567, "length": 3.9721150398254395, "mode": "train", "epoch": 15}
{"loss": 0.313079833984375, "acc": 0.8597655892372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.30698809027671814, "acc": 0.8730765581130981, "length": 3.9816999435424805, "mode": "train", "epoch": 16}
{"loss": 0.3033461272716522, "acc": 0.8748045563697815, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2976095378398895, "acc": 0.8766340017318726, "length": 3.9854116439819336, "mode": "train", "epoch": 17}
{"loss": 0.30456796288490295, "acc": 0.8804687857627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2929667830467224, "acc": 0.8773199915885925, "length": 3.9904775619506836, "mode": "train", "epoch": 18}
{"loss": 0.2970297336578369, "acc": 0.8773437142372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.29230833053588867, "acc": 0.874006986618042, "length": 3.984575033187866, "mode": "train", "epoch": 19}
{"loss": 0.2890903949737549, "acc": 0.8824219107627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.283867746591568, "acc": 0.8807029128074646, "length": 3.9875221252441406, "mode": "train", "epoch": 20}
{"loss": 0.28233805298805237, "acc": 0.8855468034744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.27844589948654175, "acc": 0.8838936686515808, "length": 3.993218183517456, "mode": "train", "epoch": 21}
{"loss": 0.2779789865016937, "acc": 0.8826171159744263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.27517011761665344, "acc": 0.8840799331665039, "length": 3.993917465209961, "mode": "train", "epoch": 22}
{"loss": 0.27482613921165466, "acc": 0.8863281607627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27339479327201843, "acc": 0.8887238502502441, "length": 3.994065999984741, "mode": "train", "epoch": 23}
{"loss": 0.27546608448028564, "acc": 0.8929687142372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2713744342327118, "acc": 0.8882118463516235, "length": 3.994785785675049, "mode": "train", "epoch": 24}
{"loss": 0.26452064514160156, "acc": 0.8972655534744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.26258519291877747, "acc": 0.8951519727706909, "length": 3.9940948486328125, "mode": "train", "epoch": 25}
{"loss": 0.2529139220714569, "acc": 0.9011718034744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2666754424571991, "acc": 0.8927197456359863, "length": 3.9958486557006836, "mode": "train", "epoch": 26}
{"loss": 0.25624850392341614, "acc": 0.8992186188697815, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.26120874285697937, "acc": 0.8943473100662231, "length": 3.990147590637207, "mode": "train", "epoch": 27}
{"loss": 0.2527550458908081, "acc": 0.9011718034744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.25363296270370483, "acc": 0.8983764052391052, "length": 3.9956023693084717, "mode": "train", "epoch": 28}
{"loss": 0.2470618188381195, "acc": 0.9013671875, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.25309398770332336, "acc": 0.8984096050262451, "length": 3.9967117309570312, "mode": "train", "epoch": 29}
{"loss": 0.24711379408836365, "acc": 0.9033203125, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.25196129083633423, "acc": 0.8982768058776855, "length": 3.9957776069641113, "mode": "train", "epoch": 30}
{"loss": 0.2432224154472351, "acc": 0.9074219465255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.24977228045463562, "acc": 0.8950247764587402, "length": 3.9973156452178955, "mode": "train", "epoch": 31}
{"loss": 0.24621888995170593, "acc": 0.9009765982627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.24619047343730927, "acc": 0.9007663130760193, "length": 3.9960482120513916, "mode": "train", "epoch": 32}
{"loss": 0.24041205644607544, "acc": 0.9076171517372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.24371714890003204, "acc": 0.89549320936203, "length": 3.9986767768859863, "mode": "train", "epoch": 33}
{"loss": 0.24140672385692596, "acc": 0.9029297828674316, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.24472589790821075, "acc": 0.900499165058136, "length": 3.9962329864501953, "mode": "train", "epoch": 34}
{"loss": 0.2362918257713318, "acc": 0.9111328721046448, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.24385537207126617, "acc": 0.9026330709457397, "length": 3.994235038757324, "mode": "train", "epoch": 35}
{"loss": 0.23950719833374023, "acc": 0.9054688215255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.23848436772823334, "acc": 0.9023808240890503, "length": 3.9979732036590576, "mode": "train", "epoch": 36}
{"loss": 0.24195778369903564, "acc": 0.9085937142372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.23572863638401031, "acc": 0.905811071395874, "length": 3.9980850219726562, "mode": "train", "epoch": 37}
{"loss": 0.23750603199005127, "acc": 0.900390625, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.23081691563129425, "acc": 0.9024075269699097, "length": 3.9994709491729736, "mode": "train", "epoch": 38}
{"loss": 0.2354176640510559, "acc": 0.9033203125, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.23388351500034332, "acc": 0.9030697345733643, "length": 3.996947765350342, "mode": "train", "epoch": 39}
{"loss": 0.23043695092201233, "acc": 0.9072265028953552, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.23117247223854065, "acc": 0.9053869247436523, "length": 3.999241352081299, "mode": "train", "epoch": 40}
{"loss": 0.22594499588012695, "acc": 0.9056640267372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.22621352970600128, "acc": 0.9059739708900452, "length": 3.9993531703948975, "mode": "train", "epoch": 41}
{"loss": 0.22958002984523773, "acc": 0.9066405892372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.22866903245449066, "acc": 0.9060488939285278, "length": 3.996006488800049, "mode": "train", "epoch": 42}
{"loss": 0.23509791493415833, "acc": 0.9050780534744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.22519369423389435, "acc": 0.9070442914962769, "length": 3.999001979827881, "mode": "train", "epoch": 43}
{"loss": 0.23888909816741943, "acc": 0.9021483659744263, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.22354434430599213, "acc": 0.9094247817993164, "length": 3.9996607303619385, "mode": "train", "epoch": 44}
{"loss": 0.22499239444732666, "acc": 0.9070311188697815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.22375079989433289, "acc": 0.9067791700363159, "length": 3.9979727268218994, "mode": "train", "epoch": 45}
{"loss": 0.2239913046360016, "acc": 0.9072266221046448, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.21784397959709167, "acc": 0.9041947722434998, "length": 3.999793767929077, "mode": "train", "epoch": 46}
{"loss": 0.22532472014427185, "acc": 0.9056640267372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.21378685534000397, "acc": 0.9128552079200745, "length": 3.998914957046509, "mode": "train", "epoch": 47}
{"loss": 0.22478240728378296, "acc": 0.9111328125, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.21877670288085938, "acc": 0.907406210899353, "length": 3.9994771480560303, "mode": "train", "epoch": 48}
{"loss": 0.23428970575332642, "acc": 0.9076171517372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.217936173081398, "acc": 0.9114402532577515, "length": 3.999769687652588, "mode": "train", "epoch": 49}
{"loss": 0.21822136640548706, "acc": 0.9177733063697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2177518755197525, "acc": 0.911899209022522, "length": 3.9996893405914307, "mode": "train", "epoch": 50}
{"loss": 0.22448238730430603, "acc": 0.9029296636581421, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.20998071134090424, "acc": 0.9117375016212463, "length": 3.9988229274749756, "mode": "train", "epoch": 51}
{"loss": 0.2127733826637268, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.20785079896450043, "acc": 0.9144937992095947, "length": 3.99988055229187, "mode": "train", "epoch": 52}
{"loss": 0.21198660135269165, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.20635847747325897, "acc": 0.9159247279167175, "length": 3.998013496398926, "mode": "train", "epoch": 53}
{"loss": 0.21581688523292542, "acc": 0.9160155653953552, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.20315146446228027, "acc": 0.9173962473869324, "length": 3.9967477321624756, "mode": "train", "epoch": 54}
{"loss": 0.21501950919628143, "acc": 0.9134765267372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.20564328134059906, "acc": 0.914488673210144, "length": 3.999748468399048, "mode": "train", "epoch": 55}
{"loss": 0.22394487261772156, "acc": 0.9107422232627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.20908474922180176, "acc": 0.9146405458450317, "length": 3.9989447593688965, "mode": "train", "epoch": 56}
{"loss": 0.2206217348575592, "acc": 0.9095702767372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.21177610754966736, "acc": 0.9101240634918213, "length": 3.9999427795410156, "mode": "train", "epoch": 57}
{"loss": 0.21595394611358643, "acc": 0.9126953482627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1988678127527237, "acc": 0.9165688753128052, "length": 3.999951124191284, "mode": "train", "epoch": 58}
{"loss": 0.2096434086561203, "acc": 0.9193358421325684, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.20020775496959686, "acc": 0.9204802513122559, "length": 3.999934196472168, "mode": "train", "epoch": 59}
{"loss": 0.21572080254554749, "acc": 0.9097656607627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1955239623785019, "acc": 0.9176629185676575, "length": 3.9999730587005615, "mode": "train", "epoch": 60}
{"loss": 0.21193543076515198, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7673214077949524
