ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6958699226379395, "acc": 0.5137225985527039, "length": 3.5296552181243896, "mode": "train", "epoch": 1}
{"loss": 0.685393214225769, "acc": 0.5687347650527954, "length": 2.1953125, "mode": "test", "epoch": 1}
{"loss": 0.6925869584083557, "acc": 0.5223404169082642, "length": 3.524716377258301, "mode": "train", "epoch": 2}
{"loss": 0.6839629411697388, "acc": 0.5734755992889404, "length": 2.32421875, "mode": "test", "epoch": 2}
{"loss": 0.6908493041992188, "acc": 0.5343950390815735, "length": 3.4877262115478516, "mode": "train", "epoch": 3}
{"loss": 0.6822017431259155, "acc": 0.5694260001182556, "length": 2.5703125, "mode": "test", "epoch": 3}
{"loss": 0.6900185346603394, "acc": 0.5276373028755188, "length": 3.5009219646453857, "mode": "train", "epoch": 4}
{"loss": 0.6775257587432861, "acc": 0.5988021492958069, "length": 2.81640625, "mode": "test", "epoch": 4}
{"loss": 0.6873167157173157, "acc": 0.5485261082649231, "length": 3.478817939758301, "mode": "train", "epoch": 5}
{"loss": 0.6726884841918945, "acc": 0.6139053106307983, "length": 3.30859375, "mode": "test", "epoch": 5}
{"loss": 0.6797983050346375, "acc": 0.5998259782791138, "length": 3.5409419536590576, "mode": "train", "epoch": 6}
{"loss": 0.6607012748718262, "acc": 0.6369674205780029, "length": 3.58984375, "mode": "test", "epoch": 6}
{"loss": 0.6622002720832825, "acc": 0.6420956254005432, "length": 3.6043972969055176, "mode": "train", "epoch": 7}
{"loss": 0.628741443157196, "acc": 0.700114369392395, "length": 3.8828125, "mode": "test", "epoch": 7}
{"loss": 0.6298378705978394, "acc": 0.7074995636940002, "length": 3.733443021774292, "mode": "train", "epoch": 8}
{"loss": 0.5963641405105591, "acc": 0.7052031755447388, "length": 3.9765625, "mode": "test", "epoch": 8}
{"loss": 0.589227020740509, "acc": 0.712708592414856, "length": 3.8445935249328613, "mode": "train", "epoch": 9}
{"loss": 0.5665907859802246, "acc": 0.716796875, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5609282851219177, "acc": 0.7153792977333069, "length": 3.911139726638794, "mode": "train", "epoch": 10}
{"loss": 0.5661054849624634, "acc": 0.7125000357627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.5505982637405396, "acc": 0.7148979902267456, "length": 3.917484998703003, "mode": "train", "epoch": 11}
{"loss": 0.5636327266693115, "acc": 0.7232422232627869, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.5404015183448792, "acc": 0.7276647090911865, "length": 3.9250614643096924, "mode": "train", "epoch": 12}
{"loss": 0.5347012281417847, "acc": 0.7392578125, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.5256947875022888, "acc": 0.741170346736908, "length": 3.9164583683013916, "mode": "train", "epoch": 13}
{"loss": 0.525836706161499, "acc": 0.771484375, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.5037124752998352, "acc": 0.7737407088279724, "length": 3.9425556659698486, "mode": "train", "epoch": 14}
{"loss": 0.4925709068775177, "acc": 0.7777343392372131, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4765266478061676, "acc": 0.7839885354042053, "length": 3.957104206085205, "mode": "train", "epoch": 15}
{"loss": 0.46122586727142334, "acc": 0.8025389313697815, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.44951972365379333, "acc": 0.7909400463104248, "length": 3.9715588092803955, "mode": "train", "epoch": 16}
{"loss": 0.43944990634918213, "acc": 0.8234375715255737, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.42854923009872437, "acc": 0.807476818561554, "length": 3.96976375579834, "mode": "train", "epoch": 17}
{"loss": 0.4210256338119507, "acc": 0.8263673186302185, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.41329172253608704, "acc": 0.8148196935653687, "length": 3.983273983001709, "mode": "train", "epoch": 18}
{"loss": 0.41654157638549805, "acc": 0.828125, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.40064284205436707, "acc": 0.8199347257614136, "length": 3.9865760803222656, "mode": "train", "epoch": 19}
{"loss": 0.40365248918533325, "acc": 0.8341797590255737, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.38568535447120667, "acc": 0.8324134945869446, "length": 3.9900550842285156, "mode": "train", "epoch": 20}
{"loss": 0.4004873037338257, "acc": 0.8332029581069946, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3744959533214569, "acc": 0.8384486436843872, "length": 3.9926092624664307, "mode": "train", "epoch": 21}
{"loss": 0.37835121154785156, "acc": 0.8417969346046448, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3639725148677826, "acc": 0.8453518748283386, "length": 3.994276285171509, "mode": "train", "epoch": 22}
{"loss": 0.3631834387779236, "acc": 0.8478516340255737, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.34876424074172974, "acc": 0.8527076244354248, "length": 3.9943912029266357, "mode": "train", "epoch": 23}
{"loss": 0.35858049988746643, "acc": 0.8488282561302185, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.34081611037254333, "acc": 0.8537335991859436, "length": 3.994311571121216, "mode": "train", "epoch": 24}
{"loss": 0.3519402742385864, "acc": 0.8585938215255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3316649794578552, "acc": 0.8573217988014221, "length": 3.994818925857544, "mode": "train", "epoch": 25}
{"loss": 0.3475315570831299, "acc": 0.8589844107627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.32877951860427856, "acc": 0.8602328300476074, "length": 3.996246337890625, "mode": "train", "epoch": 26}
{"loss": 0.34023043513298035, "acc": 0.8611327409744263, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.321134090423584, "acc": 0.860516369342804, "length": 3.99542498588562, "mode": "train", "epoch": 27}
{"loss": 0.3409944772720337, "acc": 0.8582030534744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.31594815850257874, "acc": 0.8658245205879211, "length": 3.9971728324890137, "mode": "train", "epoch": 28}
{"loss": 0.3226531147956848, "acc": 0.8701171875, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.31095147132873535, "acc": 0.8669629693031311, "length": 3.997009038925171, "mode": "train", "epoch": 29}
{"loss": 0.3353208601474762, "acc": 0.8576172590255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3101075291633606, "acc": 0.8677526116371155, "length": 3.9963326454162598, "mode": "train", "epoch": 30}
{"loss": 0.31980621814727783, "acc": 0.8687500953674316, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.30304399132728577, "acc": 0.8701724410057068, "length": 3.998448371887207, "mode": "train", "epoch": 31}
{"loss": 0.31211724877357483, "acc": 0.8695312142372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3013336956501007, "acc": 0.8730139136314392, "length": 3.9986162185668945, "mode": "train", "epoch": 32}
{"loss": 0.3166772425174713, "acc": 0.8644532561302185, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.29594555497169495, "acc": 0.8729056715965271, "length": 3.9987919330596924, "mode": "train", "epoch": 33}
{"loss": 0.31660717725753784, "acc": 0.8750000596046448, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.29909273982048035, "acc": 0.8761016130447388, "length": 3.9977707862854004, "mode": "train", "epoch": 34}
{"loss": 0.3129996359348297, "acc": 0.8669921159744263, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2938036322593689, "acc": 0.8742620348930359, "length": 3.9959404468536377, "mode": "train", "epoch": 35}
{"loss": 0.3012239336967468, "acc": 0.8767576813697815, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2925609052181244, "acc": 0.8759910464286804, "length": 3.999335527420044, "mode": "train", "epoch": 36}
{"loss": 0.31426864862442017, "acc": 0.8755859732627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.29005247354507446, "acc": 0.876725435256958, "length": 3.9992079734802246, "mode": "train", "epoch": 37}
{"loss": 0.30124354362487793, "acc": 0.8751951456069946, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2871650159358978, "acc": 0.8787872195243835, "length": 3.9996097087860107, "mode": "train", "epoch": 38}
{"loss": 0.2986116409301758, "acc": 0.8794922232627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.287952721118927, "acc": 0.8782131671905518, "length": 3.9989850521087646, "mode": "train", "epoch": 39}
{"loss": 0.30057260394096375, "acc": 0.8726562261581421, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2810092866420746, "acc": 0.8790178298950195, "length": 3.9998886585235596, "mode": "train", "epoch": 40}
{"loss": 0.30016469955444336, "acc": 0.8806639909744263, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.28116950392723083, "acc": 0.8800438642501831, "length": 3.9998910427093506, "mode": "train", "epoch": 41}
{"loss": 0.3002956509590149, "acc": 0.8781250715255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2782362401485443, "acc": 0.8802559971809387, "length": 3.9994754791259766, "mode": "train", "epoch": 42}
{"loss": 0.29873836040496826, "acc": 0.8828124403953552, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.27619293332099915, "acc": 0.8835203051567078, "length": 3.999871015548706, "mode": "train", "epoch": 43}
{"loss": 0.2915878891944885, "acc": 0.8873046636581421, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2708297669887543, "acc": 0.8864024877548218, "length": 3.9982895851135254, "mode": "train", "epoch": 44}
{"loss": 0.2949380874633789, "acc": 0.8882812857627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.27051499485969543, "acc": 0.882952094078064, "length": 3.999927520751953, "mode": "train", "epoch": 45}
{"loss": 0.2808338403701782, "acc": 0.8890624642372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.268042653799057, "acc": 0.8864143490791321, "length": 3.997465133666992, "mode": "train", "epoch": 46}
{"loss": 0.2850964665412903, "acc": 0.8914061784744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.26653268933296204, "acc": 0.8843747973442078, "length": 3.9997339248657227, "mode": "train", "epoch": 47}
{"loss": 0.28491589426994324, "acc": 0.8996094465255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.26364201307296753, "acc": 0.8889904022216797, "length": 3.9997146129608154, "mode": "train", "epoch": 48}
{"loss": 0.28367698192596436, "acc": 0.8976563811302185, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.25699716806411743, "acc": 0.8937494158744812, "length": 3.9964311122894287, "mode": "train", "epoch": 49}
{"loss": 0.28372982144355774, "acc": 0.8949218392372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.25794750452041626, "acc": 0.8945782780647278, "length": 3.9992096424102783, "mode": "train", "epoch": 50}
{"loss": 0.28110605478286743, "acc": 0.8978515267372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2522612512111664, "acc": 0.8953782916069031, "length": 3.9997990131378174, "mode": "train", "epoch": 51}
{"loss": 0.2718728184700012, "acc": 0.8964843153953552, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.247654989361763, "acc": 0.8980505466461182, "length": 3.998905897140503, "mode": "train", "epoch": 52}
{"loss": 0.28108781576156616, "acc": 0.8933592438697815, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.25161847472190857, "acc": 0.8957595229148865, "length": 3.9995932579040527, "mode": "train", "epoch": 53}
{"loss": 0.26450029015541077, "acc": 0.9007812142372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.24659226834774017, "acc": 0.900225818157196, "length": 3.999905586242676, "mode": "train", "epoch": 54}
{"loss": 0.26223281025886536, "acc": 0.9074220061302185, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2405426800251007, "acc": 0.9025043845176697, "length": 3.999643087387085, "mode": "train", "epoch": 55}
{"loss": 0.259787917137146, "acc": 0.9052733778953552, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.23987933993339539, "acc": 0.9042734503746033, "length": 3.999833345413208, "mode": "train", "epoch": 56}
{"loss": 0.2571926414966583, "acc": 0.9083982706069946, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.24331225454807281, "acc": 0.9043322205543518, "length": 3.999964714050293, "mode": "train", "epoch": 57}
{"loss": 0.2677958011627197, "acc": 0.9000000357627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.24019412696361542, "acc": 0.9046958088874817, "length": 3.9986352920532227, "mode": "train", "epoch": 58}
{"loss": 0.26068490743637085, "acc": 0.904296875, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2338140904903412, "acc": 0.9053568243980408, "length": 3.999891757965088, "mode": "train", "epoch": 59}
{"loss": 0.26440978050231934, "acc": 0.9074219465255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.23065559566020966, "acc": 0.9062706828117371, "length": 3.9999852180480957, "mode": "train", "epoch": 60}
{"loss": 0.25595641136169434, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7774074077606201
