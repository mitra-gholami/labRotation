ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6963756680488586, "acc": 0.5228866338729858, "length": 3.4937844276428223, "mode": "train", "epoch": 1}
{"loss": 0.6878414750099182, "acc": 0.546948254108429, "length": 1.046875, "mode": "test", "epoch": 1}
{"loss": 0.6861146092414856, "acc": 0.5460526943206787, "length": 3.3395755290985107, "mode": "train", "epoch": 2}
{"loss": 0.6656593084335327, "acc": 0.6280945539474487, "length": 2.51171875, "mode": "test", "epoch": 2}
{"loss": 0.624382734298706, "acc": 0.6927286386489868, "length": 3.5014147758483887, "mode": "train", "epoch": 3}
{"loss": 0.5808354616165161, "acc": 0.7015624642372131, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5000497698783875, "acc": 0.7829174399375916, "length": 3.8416197299957275, "mode": "train", "epoch": 4}
{"loss": 0.5060306787490845, "acc": 0.7763671875, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4156061112880707, "acc": 0.8224582076072693, "length": 3.9414308071136475, "mode": "train", "epoch": 5}
{"loss": 0.442915678024292, "acc": 0.8146485090255737, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.37644270062446594, "acc": 0.8419519662857056, "length": 3.952848196029663, "mode": "train", "epoch": 6}
{"loss": 0.42767655849456787, "acc": 0.8248047232627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.35801461338996887, "acc": 0.8538057804107666, "length": 3.963728427886963, "mode": "train", "epoch": 7}
{"loss": 0.4625703990459442, "acc": 0.8156250715255737, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.34111881256103516, "acc": 0.8540448546409607, "length": 3.970487117767334, "mode": "train", "epoch": 8}
{"loss": 0.42918285727500916, "acc": 0.8111328482627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.32339027523994446, "acc": 0.8658547401428223, "length": 3.97519588470459, "mode": "train", "epoch": 9}
{"loss": 0.38957828283309937, "acc": 0.8287109732627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.31235358119010925, "acc": 0.8737552165985107, "length": 3.979739189147949, "mode": "train", "epoch": 10}
{"loss": 0.37964171171188354, "acc": 0.8289061188697815, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2997409999370575, "acc": 0.878738522529602, "length": 3.9812443256378174, "mode": "train", "epoch": 11}
{"loss": 0.3653881251811981, "acc": 0.8480468392372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2946051061153412, "acc": 0.8811561465263367, "length": 3.985917329788208, "mode": "train", "epoch": 12}
{"loss": 0.3782660663127899, "acc": 0.8455077409744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.29275888204574585, "acc": 0.8827648758888245, "length": 3.9864046573638916, "mode": "train", "epoch": 13}
{"loss": 0.3658130168914795, "acc": 0.8499999642372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2864784896373749, "acc": 0.8835312128067017, "length": 3.9890530109405518, "mode": "train", "epoch": 14}
{"loss": 0.35858774185180664, "acc": 0.8531250357627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2815544605255127, "acc": 0.8800976276397705, "length": 3.9913971424102783, "mode": "train", "epoch": 15}
{"loss": 0.37188324332237244, "acc": 0.8507813215255737, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.27575576305389404, "acc": 0.885438084602356, "length": 3.992018938064575, "mode": "train", "epoch": 16}
{"loss": 0.34797415137290955, "acc": 0.8564453125, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2708732783794403, "acc": 0.8829815983772278, "length": 3.992720603942871, "mode": "train", "epoch": 17}
{"loss": 0.3675527274608612, "acc": 0.8582030534744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2695229947566986, "acc": 0.8856233954429626, "length": 3.993504285812378, "mode": "train", "epoch": 18}
{"loss": 0.3668254613876343, "acc": 0.8533202409744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2664667069911957, "acc": 0.8859000205993652, "length": 3.9934704303741455, "mode": "train", "epoch": 19}
{"loss": 0.35243043303489685, "acc": 0.8548827767372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2617446184158325, "acc": 0.8886225819587708, "length": 3.995196580886841, "mode": "train", "epoch": 20}
{"loss": 0.33381712436676025, "acc": 0.8687500357627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2569257616996765, "acc": 0.8858264684677124, "length": 3.99577260017395, "mode": "train", "epoch": 21}
{"loss": 0.3259321451187134, "acc": 0.8662109375, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.25177451968193054, "acc": 0.8963486552238464, "length": 3.9958713054656982, "mode": "train", "epoch": 22}
{"loss": 0.3300814926624298, "acc": 0.8679686784744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.25009647011756897, "acc": 0.8908659219741821, "length": 3.996464252471924, "mode": "train", "epoch": 23}
{"loss": 0.32792964577674866, "acc": 0.8728514313697815, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.24949632585048676, "acc": 0.8935579657554626, "length": 3.9967827796936035, "mode": "train", "epoch": 24}
{"loss": 0.3216455578804016, "acc": 0.8753905892372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.24293415248394012, "acc": 0.8951413631439209, "length": 3.9969184398651123, "mode": "train", "epoch": 25}
{"loss": 0.31488391757011414, "acc": 0.8744140267372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2418377846479416, "acc": 0.8986073136329651, "length": 3.99767804145813, "mode": "train", "epoch": 26}
{"loss": 0.31850293278694153, "acc": 0.8791016340255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.23610833287239075, "acc": 0.9036381840705872, "length": 3.997612953186035, "mode": "train", "epoch": 27}
{"loss": 0.3013722002506256, "acc": 0.8884764909744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23255787789821625, "acc": 0.9031788110733032, "length": 3.9980273246765137, "mode": "train", "epoch": 28}
{"loss": 0.2995729446411133, "acc": 0.8835936784744263, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.22230297327041626, "acc": 0.9072239995002747, "length": 3.9980955123901367, "mode": "train", "epoch": 29}
{"loss": 0.28391581773757935, "acc": 0.8962889909744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.21446837484836578, "acc": 0.9121346473693848, "length": 3.9981257915496826, "mode": "train", "epoch": 30}
{"loss": 0.2555881142616272, "acc": 0.9031249284744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2085360437631607, "acc": 0.9141339063644409, "length": 3.998486042022705, "mode": "train", "epoch": 31}
{"loss": 0.26766976714134216, "acc": 0.8910155892372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.20157493650913239, "acc": 0.9174739718437195, "length": 3.9985036849975586, "mode": "train", "epoch": 32}
{"loss": 0.2396518886089325, "acc": 0.9007812142372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1945432722568512, "acc": 0.9187650680541992, "length": 3.998739242553711, "mode": "train", "epoch": 33}
{"loss": 0.24396297335624695, "acc": 0.9044922590255737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.19444778561592102, "acc": 0.9228544235229492, "length": 3.998622179031372, "mode": "train", "epoch": 34}
{"loss": 0.23520559072494507, "acc": 0.9035156965255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.18933694064617157, "acc": 0.9243215322494507, "length": 3.9987034797668457, "mode": "train", "epoch": 35}
{"loss": 0.23746244609355927, "acc": 0.9058594107627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1772727072238922, "acc": 0.9291265606880188, "length": 3.9987478256225586, "mode": "train", "epoch": 36}
{"loss": 0.233760803937912, "acc": 0.9070311784744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.17245298624038696, "acc": 0.9308836460113525, "length": 3.998945713043213, "mode": "train", "epoch": 37}
{"loss": 0.216978520154953, "acc": 0.9105468392372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.17482396960258484, "acc": 0.9291849136352539, "length": 3.998910427093506, "mode": "train", "epoch": 38}
{"loss": 0.22922974824905396, "acc": 0.9089843034744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.16645459830760956, "acc": 0.9297218322753906, "length": 3.9991559982299805, "mode": "train", "epoch": 39}
{"loss": 0.22601011395454407, "acc": 0.9087890982627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1683540642261505, "acc": 0.9319356679916382, "length": 3.9986085891723633, "mode": "train", "epoch": 40}
{"loss": 0.24759405851364136, "acc": 0.9064454436302185, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.16925345361232758, "acc": 0.9289047122001648, "length": 3.99933123588562, "mode": "train", "epoch": 41}
{"loss": 0.2187419831752777, "acc": 0.912109375, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1597680002450943, "acc": 0.9332929849624634, "length": 3.9992752075195312, "mode": "train", "epoch": 42}
{"loss": 0.20419315993785858, "acc": 0.91796875, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15363816916942596, "acc": 0.9376877546310425, "length": 3.9994499683380127, "mode": "train", "epoch": 43}
{"loss": 0.2063576579093933, "acc": 0.9134765267372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1531858742237091, "acc": 0.9373345971107483, "length": 3.9994301795959473, "mode": "train", "epoch": 44}
{"loss": 0.1940537393093109, "acc": 0.9232421517372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.146088108420372, "acc": 0.9400766491889954, "length": 3.99934983253479, "mode": "train", "epoch": 45}
{"loss": 0.2030349224805832, "acc": 0.9226561784744263, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1468275636434555, "acc": 0.9397385716438293, "length": 3.999558210372925, "mode": "train", "epoch": 46}
{"loss": 0.20406123995780945, "acc": 0.9201172590255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1507716178894043, "acc": 0.942193865776062, "length": 3.99947452545166, "mode": "train", "epoch": 47}
{"loss": 0.20063655078411102, "acc": 0.9244140982627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.14199016988277435, "acc": 0.9448310732841492, "length": 3.999598979949951, "mode": "train", "epoch": 48}
{"loss": 0.19535966217517853, "acc": 0.9197264909744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.13680225610733032, "acc": 0.9446508288383484, "length": 3.999444007873535, "mode": "train", "epoch": 49}
{"loss": 0.19784337282180786, "acc": 0.9291015863418579, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1357736438512802, "acc": 0.9438368678092957, "length": 3.999661922454834, "mode": "train", "epoch": 50}
{"loss": 0.21408650279045105, "acc": 0.9167967438697815, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.13707607984542847, "acc": 0.9428226351737976, "length": 3.9988441467285156, "mode": "train", "epoch": 51}
{"loss": 0.19234146177768707, "acc": 0.9250000715255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.13191500306129456, "acc": 0.9463571906089783, "length": 3.999682903289795, "mode": "train", "epoch": 52}
{"loss": 0.19519191980361938, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.13017362356185913, "acc": 0.9462413191795349, "length": 3.9997406005859375, "mode": "train", "epoch": 53}
{"loss": 0.19063039124011993, "acc": 0.9236327409744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.12556849420070648, "acc": 0.9470605850219727, "length": 3.9997470378875732, "mode": "train", "epoch": 54}
{"loss": 0.20962932705879211, "acc": 0.9167968034744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.12403350323438644, "acc": 0.9496394991874695, "length": 3.99980092048645, "mode": "train", "epoch": 55}
{"loss": 0.19163629412651062, "acc": 0.9248046875, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.12041179090738297, "acc": 0.9488791823387146, "length": 3.999756336212158, "mode": "train", "epoch": 56}
{"loss": 0.19190888106822968, "acc": 0.9234375357627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.12577296793460846, "acc": 0.9529179334640503, "length": 3.999800682067871, "mode": "train", "epoch": 57}
{"loss": 0.17714789509773254, "acc": 0.9302734732627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.11390380561351776, "acc": 0.9522742033004761, "length": 3.999762773513794, "mode": "train", "epoch": 58}
{"loss": 0.18308286368846893, "acc": 0.9304686188697815, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.12123114615678787, "acc": 0.9527427554130554, "length": 3.9998180866241455, "mode": "train", "epoch": 59}
{"loss": 0.18864965438842773, "acc": 0.9234375357627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.11404296010732651, "acc": 0.9538578987121582, "length": 3.9998550415039062, "mode": "train", "epoch": 60}
{"loss": 0.17001615464687347, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8510000705718994
