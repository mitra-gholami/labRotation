ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6982003450393677, "acc": 0.510157585144043, "length": 3.5782179832458496, "mode": "train", "epoch": 1}
{"loss": 0.6869924068450928, "acc": 0.533203125, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.6903384327888489, "acc": 0.5244037508964539, "length": 3.5690605640411377, "mode": "train", "epoch": 2}
{"loss": 0.6862053275108337, "acc": 0.5537109971046448, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.6893962025642395, "acc": 0.5292569994926453, "length": 3.6189863681793213, "mode": "train", "epoch": 3}
{"loss": 0.676068902015686, "acc": 0.595507800579071, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.686926543712616, "acc": 0.5377517342567444, "length": 3.607273578643799, "mode": "train", "epoch": 4}
{"loss": 0.6698499917984009, "acc": 0.6179686188697815, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.6820291876792908, "acc": 0.5606074929237366, "length": 3.5798840522766113, "mode": "train", "epoch": 5}
{"loss": 0.6637259125709534, "acc": 0.6034256219863892, "length": 3.98046875, "mode": "test", "epoch": 5}
{"loss": 0.6700062155723572, "acc": 0.6090953350067139, "length": 3.5842926502227783, "mode": "train", "epoch": 6}
{"loss": 0.6467943787574768, "acc": 0.6382812857627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.6445258855819702, "acc": 0.6592323184013367, "length": 3.72261905670166, "mode": "train", "epoch": 7}
{"loss": 0.6187061667442322, "acc": 0.6888671517372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.6080784201622009, "acc": 0.7080559134483337, "length": 3.843463182449341, "mode": "train", "epoch": 8}
{"loss": 0.58155357837677, "acc": 0.7162109613418579, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5658046007156372, "acc": 0.7462800145149231, "length": 3.9037487506866455, "mode": "train", "epoch": 9}
{"loss": 0.5421910285949707, "acc": 0.7621093392372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5305415391921997, "acc": 0.7834902405738831, "length": 3.869708776473999, "mode": "train", "epoch": 10}
{"loss": 0.49604201316833496, "acc": 0.8054689168930054, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.49364036321640015, "acc": 0.8079639077186584, "length": 3.893223285675049, "mode": "train", "epoch": 11}
{"loss": 0.46464669704437256, "acc": 0.8142577409744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.45960235595703125, "acc": 0.8162752389907837, "length": 3.9466991424560547, "mode": "train", "epoch": 12}
{"loss": 0.43762296438217163, "acc": 0.8142577409744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4332294762134552, "acc": 0.8190236687660217, "length": 3.9759182929992676, "mode": "train", "epoch": 13}
{"loss": 0.41805505752563477, "acc": 0.8218750357627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4150814116001129, "acc": 0.826708972454071, "length": 3.982219696044922, "mode": "train", "epoch": 14}
{"loss": 0.4040740728378296, "acc": 0.8232421875, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3979520797729492, "acc": 0.8340587019920349, "length": 3.987769365310669, "mode": "train", "epoch": 15}
{"loss": 0.4091094136238098, "acc": 0.8236327171325684, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3834563195705414, "acc": 0.8384954333305359, "length": 3.991821050643921, "mode": "train", "epoch": 16}
{"loss": 0.4039616584777832, "acc": 0.8294922113418579, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.37809619307518005, "acc": 0.8421338200569153, "length": 3.995269298553467, "mode": "train", "epoch": 17}
{"loss": 0.39379048347473145, "acc": 0.8347654938697815, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.37475451827049255, "acc": 0.8444574475288391, "length": 3.995103120803833, "mode": "train", "epoch": 18}
{"loss": 0.3915824294090271, "acc": 0.8402343392372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3737929165363312, "acc": 0.8445554375648499, "length": 3.9895851612091064, "mode": "train", "epoch": 19}
{"loss": 0.3799007833003998, "acc": 0.837890625, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.36481210589408875, "acc": 0.8454580903053284, "length": 3.9975357055664062, "mode": "train", "epoch": 20}
{"loss": 0.3729628324508667, "acc": 0.8453125357627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3617400527000427, "acc": 0.8494041562080383, "length": 3.9932591915130615, "mode": "train", "epoch": 21}
{"loss": 0.3611074388027191, "acc": 0.8558593392372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.35931453108787537, "acc": 0.8497591018676758, "length": 3.996887683868408, "mode": "train", "epoch": 22}
{"loss": 0.3548111021518707, "acc": 0.8619140386581421, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3572339117527008, "acc": 0.8532769083976746, "length": 3.996422290802002, "mode": "train", "epoch": 23}
{"loss": 0.3524458706378937, "acc": 0.8597655892372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.35534968972206116, "acc": 0.8519837260246277, "length": 3.9951586723327637, "mode": "train", "epoch": 24}
{"loss": 0.3547075390815735, "acc": 0.8585938215255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.35129377245903015, "acc": 0.8546521067619324, "length": 3.9988529682159424, "mode": "train", "epoch": 25}
{"loss": 0.34854161739349365, "acc": 0.8626952767372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.34760531783103943, "acc": 0.8586276769638062, "length": 3.9981062412261963, "mode": "train", "epoch": 26}
{"loss": 0.34629836678504944, "acc": 0.8628907203674316, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3431815505027771, "acc": 0.8577774167060852, "length": 3.9981460571289062, "mode": "train", "epoch": 27}
{"loss": 0.3488749861717224, "acc": 0.8652343153953552, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3428216278553009, "acc": 0.8570982217788696, "length": 3.99753475189209, "mode": "train", "epoch": 28}
{"loss": 0.3452751636505127, "acc": 0.8660155534744263, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3402354419231415, "acc": 0.861737847328186, "length": 3.9980998039245605, "mode": "train", "epoch": 29}
{"loss": 0.346499502658844, "acc": 0.8624998331069946, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.3372202515602112, "acc": 0.8628873229026794, "length": 3.999499559402466, "mode": "train", "epoch": 30}
{"loss": 0.3439180850982666, "acc": 0.8611327409744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.32972392439842224, "acc": 0.8656412363052368, "length": 3.9989776611328125, "mode": "train", "epoch": 31}
{"loss": 0.33881765604019165, "acc": 0.8636718392372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3287600576877594, "acc": 0.8634615540504456, "length": 3.9969112873077393, "mode": "train", "epoch": 32}
{"loss": 0.3281673192977905, "acc": 0.8675780892372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3265758156776428, "acc": 0.8628314733505249, "length": 3.997831106185913, "mode": "train", "epoch": 33}
{"loss": 0.32696813344955444, "acc": 0.8701171875, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.3218436539173126, "acc": 0.8677598834037781, "length": 3.9987447261810303, "mode": "train", "epoch": 34}
{"loss": 0.32207274436950684, "acc": 0.8818359375, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.3161008656024933, "acc": 0.8683281540870667, "length": 3.9972381591796875, "mode": "train", "epoch": 35}
{"loss": 0.3123433589935303, "acc": 0.8775390982627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.31292515993118286, "acc": 0.869667649269104, "length": 3.997115135192871, "mode": "train", "epoch": 36}
{"loss": 0.3227318525314331, "acc": 0.8744140267372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.30716079473495483, "acc": 0.8743745684623718, "length": 3.999171733856201, "mode": "train", "epoch": 37}
{"loss": 0.31573256850242615, "acc": 0.8800781965255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.3010585904121399, "acc": 0.8776888251304626, "length": 3.997365713119507, "mode": "train", "epoch": 38}
{"loss": 0.3141409456729889, "acc": 0.8826171159744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2965480387210846, "acc": 0.8819373250007629, "length": 3.9976754188537598, "mode": "train", "epoch": 39}
{"loss": 0.308660626411438, "acc": 0.8845702409744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.29327231645584106, "acc": 0.8805286288261414, "length": 3.9981367588043213, "mode": "train", "epoch": 40}
{"loss": 0.30492883920669556, "acc": 0.8863281607627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.28800004720687866, "acc": 0.8857948780059814, "length": 3.997316598892212, "mode": "train", "epoch": 41}
{"loss": 0.29950767755508423, "acc": 0.8865233063697815, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2831438183784485, "acc": 0.8839106559753418, "length": 3.9997386932373047, "mode": "train", "epoch": 42}
{"loss": 0.3002081513404846, "acc": 0.8957031965255737, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.28132250905036926, "acc": 0.8883240818977356, "length": 3.9956281185150146, "mode": "train", "epoch": 43}
{"loss": 0.2905983328819275, "acc": 0.9011717438697815, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2712065279483795, "acc": 0.8897359371185303, "length": 3.999410390853882, "mode": "train", "epoch": 44}
{"loss": 0.2920593321323395, "acc": 0.8970703482627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.26812437176704407, "acc": 0.891795814037323, "length": 3.9968643188476562, "mode": "train", "epoch": 45}
{"loss": 0.2873016595840454, "acc": 0.8966797590255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.26434093713760376, "acc": 0.8922908902168274, "length": 3.995676040649414, "mode": "train", "epoch": 46}
{"loss": 0.29217153787612915, "acc": 0.9000000357627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.262470543384552, "acc": 0.8940483331680298, "length": 3.9986233711242676, "mode": "train", "epoch": 47}
{"loss": 0.2879638671875, "acc": 0.8935546875, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.2536786198616028, "acc": 0.8995780944824219, "length": 3.9926719665527344, "mode": "train", "epoch": 48}
{"loss": 0.27350425720214844, "acc": 0.8958984017372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.25115329027175903, "acc": 0.8983160257339478, "length": 3.9998209476470947, "mode": "train", "epoch": 49}
{"loss": 0.26346537470817566, "acc": 0.8998047113418579, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.24882987141609192, "acc": 0.9039674997329712, "length": 3.999196767807007, "mode": "train", "epoch": 50}
{"loss": 0.279842734336853, "acc": 0.8951172232627869, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.24700145423412323, "acc": 0.9012607932090759, "length": 3.9980523586273193, "mode": "train", "epoch": 51}
{"loss": 0.2642548680305481, "acc": 0.8953124284744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2468636929988861, "acc": 0.9003726840019226, "length": 3.998781204223633, "mode": "train", "epoch": 52}
{"loss": 0.2771162986755371, "acc": 0.9031249284744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.24062640964984894, "acc": 0.9053745269775391, "length": 3.9991750717163086, "mode": "train", "epoch": 53}
{"loss": 0.2629459500312805, "acc": 0.9005860090255737, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.2410639375448227, "acc": 0.90665602684021, "length": 3.998554229736328, "mode": "train", "epoch": 54}
{"loss": 0.25534170866012573, "acc": 0.8992186188697815, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.23241575062274933, "acc": 0.9090186953544617, "length": 3.9996612071990967, "mode": "train", "epoch": 55}
{"loss": 0.2630283832550049, "acc": 0.9037108421325684, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.23497864603996277, "acc": 0.9084903001785278, "length": 3.998650312423706, "mode": "train", "epoch": 56}
{"loss": 0.25283652544021606, "acc": 0.9039062261581421, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.2317599207162857, "acc": 0.9088935256004333, "length": 3.998788356781006, "mode": "train", "epoch": 57}
{"loss": 0.2507515549659729, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.22749564051628113, "acc": 0.912666380405426, "length": 3.9998745918273926, "mode": "train", "epoch": 58}
{"loss": 0.2605317234992981, "acc": 0.904296875, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.2290600687265396, "acc": 0.9116575121879578, "length": 3.995875358581543, "mode": "train", "epoch": 59}
{"loss": 0.24848443269729614, "acc": 0.9083985686302185, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.21497590839862823, "acc": 0.921069324016571, "length": 3.999680757522583, "mode": "train", "epoch": 60}
{"loss": 0.2403677999973297, "acc": 0.9156249761581421, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.677600085735321
