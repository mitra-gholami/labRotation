ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6958990097045898, "acc": 0.5144687294960022, "length": 3.5358593463897705, "mode": "train", "epoch": 1}
{"loss": 0.6955959796905518, "acc": 0.5375762581825256, "length": 3.578125, "mode": "test", "epoch": 1}
{"loss": 0.6905115246772766, "acc": 0.5236557126045227, "length": 3.474975347518921, "mode": "train", "epoch": 2}
{"loss": 0.6786072254180908, "acc": 0.5614227056503296, "length": 2.515625, "mode": "test", "epoch": 2}
{"loss": 0.6850441694259644, "acc": 0.5464257597923279, "length": 3.458054780960083, "mode": "train", "epoch": 3}
{"loss": 0.6715848445892334, "acc": 0.5923675298690796, "length": 3.6796875, "mode": "test", "epoch": 3}
{"loss": 0.6582993268966675, "acc": 0.636678159236908, "length": 3.6140224933624268, "mode": "train", "epoch": 4}
{"loss": 0.6121081709861755, "acc": 0.7314453125, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5941081047058105, "acc": 0.7379821538925171, "length": 3.7780227661132812, "mode": "train", "epoch": 5}
{"loss": 0.5428465604782104, "acc": 0.7685547471046448, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5260902047157288, "acc": 0.764885663986206, "length": 3.913708209991455, "mode": "train", "epoch": 6}
{"loss": 0.5043435096740723, "acc": 0.771484375, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.48072853684425354, "acc": 0.7788033485412598, "length": 3.9619131088256836, "mode": "train", "epoch": 7}
{"loss": 0.4788072109222412, "acc": 0.7955078482627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.47065800428390503, "acc": 0.7972482442855835, "length": 3.972412347793579, "mode": "train", "epoch": 8}
{"loss": 0.47033315896987915, "acc": 0.7941405773162842, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.45504969358444214, "acc": 0.7946845293045044, "length": 3.9819469451904297, "mode": "train", "epoch": 9}
{"loss": 0.4578314423561096, "acc": 0.7970703840255737, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4476877748966217, "acc": 0.7990114688873291, "length": 3.9777209758758545, "mode": "train", "epoch": 10}
{"loss": 0.4599650502204895, "acc": 0.8021484613418579, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.44440513849258423, "acc": 0.8035681247711182, "length": 3.9843802452087402, "mode": "train", "epoch": 11}
{"loss": 0.4463823437690735, "acc": 0.8103514909744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.43395304679870605, "acc": 0.8119274377822876, "length": 3.986591100692749, "mode": "train", "epoch": 12}
{"loss": 0.4413597583770752, "acc": 0.8189454078674316, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.41999244689941406, "acc": 0.8163551092147827, "length": 3.9860990047454834, "mode": "train", "epoch": 13}
{"loss": 0.4333302974700928, "acc": 0.8195313215255737, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4083598554134369, "acc": 0.8203327059745789, "length": 3.986879825592041, "mode": "train", "epoch": 14}
{"loss": 0.4151272773742676, "acc": 0.8226562142372131, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3979623317718506, "acc": 0.8289193511009216, "length": 3.989351511001587, "mode": "train", "epoch": 15}
{"loss": 0.41802382469177246, "acc": 0.8236327767372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3838682770729065, "acc": 0.8286557793617249, "length": 3.991753101348877, "mode": "train", "epoch": 16}
{"loss": 0.40818166732788086, "acc": 0.8189453482627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3593897819519043, "acc": 0.8392761945724487, "length": 3.993060350418091, "mode": "train", "epoch": 17}
{"loss": 0.3952423632144928, "acc": 0.8312500715255737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.36064237356185913, "acc": 0.8424668312072754, "length": 3.9969308376312256, "mode": "train", "epoch": 18}
{"loss": 0.37815746665000916, "acc": 0.8392577767372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.35251355171203613, "acc": 0.8476739525794983, "length": 3.9934098720550537, "mode": "train", "epoch": 19}
{"loss": 0.37017199397087097, "acc": 0.8451171517372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.33741995692253113, "acc": 0.8506371974945068, "length": 3.994298219680786, "mode": "train", "epoch": 20}
{"loss": 0.3662392497062683, "acc": 0.8322266340255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3377096951007843, "acc": 0.8559184074401855, "length": 3.9973058700561523, "mode": "train", "epoch": 21}
{"loss": 0.34599292278289795, "acc": 0.8460937142372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.319570392370224, "acc": 0.8596842885017395, "length": 3.995671510696411, "mode": "train", "epoch": 22}
{"loss": 0.3337745666503906, "acc": 0.853515625, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.30177927017211914, "acc": 0.870047390460968, "length": 3.9972991943359375, "mode": "train", "epoch": 23}
{"loss": 0.31424468755722046, "acc": 0.8660155534744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2925143837928772, "acc": 0.8749930262565613, "length": 3.997011423110962, "mode": "train", "epoch": 24}
{"loss": 0.3028806746006012, "acc": 0.8707031607627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.28076332807540894, "acc": 0.8840557336807251, "length": 3.9969279766082764, "mode": "train", "epoch": 25}
{"loss": 0.300189733505249, "acc": 0.8771485686302185, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.27227678894996643, "acc": 0.8857554197311401, "length": 3.99933123588562, "mode": "train", "epoch": 26}
{"loss": 0.29536259174346924, "acc": 0.8810547590255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.25865438580513, "acc": 0.8918347358703613, "length": 3.9992246627807617, "mode": "train", "epoch": 27}
{"loss": 0.2894361913204193, "acc": 0.8837890625, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2490338385105133, "acc": 0.8948044180870056, "length": 3.9986491203308105, "mode": "train", "epoch": 28}
{"loss": 0.2802686095237732, "acc": 0.8878907561302185, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.25459569692611694, "acc": 0.8972938060760498, "length": 3.9979135990142822, "mode": "train", "epoch": 29}
{"loss": 0.2807433307170868, "acc": 0.8876953125, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.23309841752052307, "acc": 0.9057736992835999, "length": 3.9997379779815674, "mode": "train", "epoch": 30}
{"loss": 0.28035783767700195, "acc": 0.8871093392372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.24865397810935974, "acc": 0.899415910243988, "length": 3.998424530029297, "mode": "train", "epoch": 31}
{"loss": 0.2686382830142975, "acc": 0.8912109732627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.23823027312755585, "acc": 0.9011055827140808, "length": 3.9978058338165283, "mode": "train", "epoch": 32}
{"loss": 0.2567523121833801, "acc": 0.8933593034744263, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.23508596420288086, "acc": 0.9057331085205078, "length": 3.998150110244751, "mode": "train", "epoch": 33}
{"loss": 0.25067150592803955, "acc": 0.8990234732627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.22433359920978546, "acc": 0.908732533454895, "length": 3.999910593032837, "mode": "train", "epoch": 34}
{"loss": 0.2358626127243042, "acc": 0.9027343392372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.22599796950817108, "acc": 0.9072534441947937, "length": 3.999812602996826, "mode": "train", "epoch": 35}
{"loss": 0.24842897057533264, "acc": 0.8964843153953552, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.22804157435894012, "acc": 0.9115710258483887, "length": 3.9980785846710205, "mode": "train", "epoch": 36}
{"loss": 0.23593875765800476, "acc": 0.904296875, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.22657190263271332, "acc": 0.9116274118423462, "length": 3.9999470710754395, "mode": "train", "epoch": 37}
{"loss": 0.2345273196697235, "acc": 0.9062500596046448, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.22482718527317047, "acc": 0.9098560214042664, "length": 3.99994158744812, "mode": "train", "epoch": 38}
{"loss": 0.22901292145252228, "acc": 0.9072265625, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.21141698956489563, "acc": 0.9128679037094116, "length": 3.9999332427978516, "mode": "train", "epoch": 39}
{"loss": 0.22062569856643677, "acc": 0.9113282561302185, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2049562633037567, "acc": 0.9191715121269226, "length": 3.9997527599334717, "mode": "train", "epoch": 40}
{"loss": 0.23671644926071167, "acc": 0.9107422232627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19973526895046234, "acc": 0.9209612011909485, "length": 3.998321771621704, "mode": "train", "epoch": 41}
{"loss": 0.21000376343727112, "acc": 0.9181641340255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1945227086544037, "acc": 0.920774519443512, "length": 3.9979257583618164, "mode": "train", "epoch": 42}
{"loss": 0.21218642592430115, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.18960784375667572, "acc": 0.9210141897201538, "length": 3.999976634979248, "mode": "train", "epoch": 43}
{"loss": 0.20894092321395874, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1839606612920761, "acc": 0.928570032119751, "length": 3.999934673309326, "mode": "train", "epoch": 44}
{"loss": 0.20877450704574585, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.19388088583946228, "acc": 0.9224897623062134, "length": 3.9999711513519287, "mode": "train", "epoch": 45}
{"loss": 0.20055100321769714, "acc": 0.9203124642372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18873049318790436, "acc": 0.9259640574455261, "length": 3.999708414077759, "mode": "train", "epoch": 46}
{"loss": 0.1879655420780182, "acc": 0.9300780892372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.18943285942077637, "acc": 0.924433708190918, "length": 3.999903440475464, "mode": "train", "epoch": 47}
{"loss": 0.20092567801475525, "acc": 0.9203124642372131, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.17853522300720215, "acc": 0.9324662685394287, "length": 3.999979019165039, "mode": "train", "epoch": 48}
{"loss": 0.21124936640262604, "acc": 0.9156250357627869, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.17124506831169128, "acc": 0.9335260391235352, "length": 3.9999237060546875, "mode": "train", "epoch": 49}
{"loss": 0.19735321402549744, "acc": 0.9291015267372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.16667909920215607, "acc": 0.9364809393882751, "length": 3.999976634979248, "mode": "train", "epoch": 50}
{"loss": 0.18560495972633362, "acc": 0.9253906607627869, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.16710923612117767, "acc": 0.9334514737129211, "length": 3.9995803833007812, "mode": "train", "epoch": 51}
{"loss": 0.17830929160118103, "acc": 0.9228515625, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.16342231631278992, "acc": 0.9348868131637573, "length": 3.999957323074341, "mode": "train", "epoch": 52}
{"loss": 0.17566655576229095, "acc": 0.9285155534744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1629089117050171, "acc": 0.9329288601875305, "length": 3.9997637271881104, "mode": "train", "epoch": 53}
{"loss": 0.18296967446804047, "acc": 0.9320312142372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15246126055717468, "acc": 0.9426165223121643, "length": 3.999915361404419, "mode": "train", "epoch": 54}
{"loss": 0.1764144003391266, "acc": 0.9269531965255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1438860148191452, "acc": 0.9414982199668884, "length": 3.9999711513519287, "mode": "train", "epoch": 55}
{"loss": 0.16041205823421478, "acc": 0.9361327886581421, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.14451195299625397, "acc": 0.9414395689964294, "length": 3.999988555908203, "mode": "train", "epoch": 56}
{"loss": 0.169683575630188, "acc": 0.9365234971046448, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.14199288189411163, "acc": 0.9457494020462036, "length": 3.9999918937683105, "mode": "train", "epoch": 57}
{"loss": 0.1617998331785202, "acc": 0.9365234375, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1380167305469513, "acc": 0.9461524486541748, "length": 3.9998795986175537, "mode": "train", "epoch": 58}
{"loss": 0.18528541922569275, "acc": 0.9273437857627869, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.14359132945537567, "acc": 0.9451575875282288, "length": 3.9999561309814453, "mode": "train", "epoch": 59}
{"loss": 0.16181768476963043, "acc": 0.94140625, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.13176515698432922, "acc": 0.9489953517913818, "length": 3.9999754428863525, "mode": "train", "epoch": 60}
{"loss": 0.16970764100551605, "acc": 0.9392577409744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7790323495864868
