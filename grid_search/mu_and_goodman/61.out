ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.692343533039093, "acc": 0.5196413397789001, "length": 3.536885976791382, "mode": "train", "epoch": 1}
{"loss": 0.6821517944335938, "acc": 0.5291916131973267, "length": 1.9609375, "mode": "test", "epoch": 1}
{"loss": 0.6912282705307007, "acc": 0.525723397731781, "length": 3.4858100414276123, "mode": "train", "epoch": 2}
{"loss": 0.6894607543945312, "acc": 0.5278915762901306, "length": 1.15234375, "mode": "test", "epoch": 2}
{"loss": 0.6875030398368835, "acc": 0.5370621085166931, "length": 3.244605779647827, "mode": "train", "epoch": 3}
{"loss": 0.6750073432922363, "acc": 0.6023620963096619, "length": 1.6953125, "mode": "test", "epoch": 3}
{"loss": 0.6712483763694763, "acc": 0.6155157089233398, "length": 3.1590754985809326, "mode": "train", "epoch": 4}
{"loss": 0.6329792737960815, "acc": 0.7190489768981934, "length": 2.9765625, "mode": "test", "epoch": 4}
{"loss": 0.6323179602622986, "acc": 0.7118551731109619, "length": 3.3899149894714355, "mode": "train", "epoch": 5}
{"loss": 0.5642003417015076, "acc": 0.7738280892372131, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5593565106391907, "acc": 0.7677554488182068, "length": 3.7635245323181152, "mode": "train", "epoch": 6}
{"loss": 0.4920104742050171, "acc": 0.7890624403953552, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4912051260471344, "acc": 0.7832528352737427, "length": 3.909294843673706, "mode": "train", "epoch": 7}
{"loss": 0.4565362334251404, "acc": 0.8011718392372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4446883499622345, "acc": 0.7994340062141418, "length": 3.9644274711608887, "mode": "train", "epoch": 8}
{"loss": 0.44353172183036804, "acc": 0.8123046159744263, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.41044187545776367, "acc": 0.8195831179618835, "length": 3.976048231124878, "mode": "train", "epoch": 9}
{"loss": 0.43879592418670654, "acc": 0.8150390982627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3747108280658722, "acc": 0.8375625014305115, "length": 3.9857945442199707, "mode": "train", "epoch": 10}
{"loss": 0.38545936346054077, "acc": 0.8353515267372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.35054200887680054, "acc": 0.8500651121139526, "length": 3.987222909927368, "mode": "train", "epoch": 11}
{"loss": 0.3886644244194031, "acc": 0.8451171517372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3384349048137665, "acc": 0.8542689085006714, "length": 3.9906258583068848, "mode": "train", "epoch": 12}
{"loss": 0.39043182134628296, "acc": 0.8394531607627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3240942060947418, "acc": 0.8594112396240234, "length": 3.9903206825256348, "mode": "train", "epoch": 13}
{"loss": 0.39084357023239136, "acc": 0.8458985090255737, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3261321485042572, "acc": 0.8566574454307556, "length": 3.9931564331054688, "mode": "train", "epoch": 14}
{"loss": 0.3632354140281677, "acc": 0.8511719107627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3129338324069977, "acc": 0.8667308688163757, "length": 3.9936611652374268, "mode": "train", "epoch": 15}
{"loss": 0.3513060212135315, "acc": 0.8556641936302185, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3056735098361969, "acc": 0.8718830943107605, "length": 3.995975971221924, "mode": "train", "epoch": 16}
{"loss": 0.3346061408519745, "acc": 0.8615235090255737, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2965918183326721, "acc": 0.8750682473182678, "length": 3.995310068130493, "mode": "train", "epoch": 17}
{"loss": 0.3161137104034424, "acc": 0.8722654581069946, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.28137677907943726, "acc": 0.8862916231155396, "length": 3.996588945388794, "mode": "train", "epoch": 18}
{"loss": 0.3120180070400238, "acc": 0.8707032203674316, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.27455106377601624, "acc": 0.8887150883674622, "length": 3.996365547180176, "mode": "train", "epoch": 19}
{"loss": 0.3073408603668213, "acc": 0.8642577528953552, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.27098801732063293, "acc": 0.8892832398414612, "length": 3.997903347015381, "mode": "train", "epoch": 20}
{"loss": 0.3098309338092804, "acc": 0.865234375, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2670738399028778, "acc": 0.8893187046051025, "length": 3.997882843017578, "mode": "train", "epoch": 21}
{"loss": 0.2925834059715271, "acc": 0.8808593153953552, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2572981119155884, "acc": 0.8969855904579163, "length": 3.9982824325561523, "mode": "train", "epoch": 22}
{"loss": 0.2845713198184967, "acc": 0.8847655653953552, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2563197612762451, "acc": 0.894250214099884, "length": 3.996934652328491, "mode": "train", "epoch": 23}
{"loss": 0.2849109470844269, "acc": 0.8749999403953552, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.24990873038768768, "acc": 0.8948248028755188, "length": 3.9966466426849365, "mode": "train", "epoch": 24}
{"loss": 0.2716215252876282, "acc": 0.8919921517372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.24757669866085052, "acc": 0.8972209692001343, "length": 3.9981625080108643, "mode": "train", "epoch": 25}
{"loss": 0.2784779667854309, "acc": 0.8873047232627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.24062936007976532, "acc": 0.9022299647331238, "length": 3.9992597103118896, "mode": "train", "epoch": 26}
{"loss": 0.279965877532959, "acc": 0.8748045563697815, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2387266904115677, "acc": 0.8994542360305786, "length": 3.999069929122925, "mode": "train", "epoch": 27}
{"loss": 0.2646339535713196, "acc": 0.8902344703674316, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23321355879306793, "acc": 0.9030306935310364, "length": 3.998414993286133, "mode": "train", "epoch": 28}
{"loss": 0.27790510654449463, "acc": 0.888671875, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.22816134989261627, "acc": 0.9086786508560181, "length": 3.999417304992676, "mode": "train", "epoch": 29}
{"loss": 0.2628497779369354, "acc": 0.8958984017372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.23257681727409363, "acc": 0.9065173864364624, "length": 3.998582363128662, "mode": "train", "epoch": 30}
{"loss": 0.2685815691947937, "acc": 0.8855468034744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.22352777421474457, "acc": 0.9119848012924194, "length": 3.9968321323394775, "mode": "train", "epoch": 31}
{"loss": 0.254693865776062, "acc": 0.8964843153953552, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.22146619856357574, "acc": 0.9104928374290466, "length": 3.999854326248169, "mode": "train", "epoch": 32}
{"loss": 0.24501103162765503, "acc": 0.8960937857627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.21632549166679382, "acc": 0.9113051295280457, "length": 3.999790668487549, "mode": "train", "epoch": 33}
{"loss": 0.24646979570388794, "acc": 0.8970703482627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.21679024398326874, "acc": 0.9114760756492615, "length": 3.9998106956481934, "mode": "train", "epoch": 34}
{"loss": 0.25107282400131226, "acc": 0.9068359136581421, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.21349835395812988, "acc": 0.9136253595352173, "length": 3.9998056888580322, "mode": "train", "epoch": 35}
{"loss": 0.25637441873550415, "acc": 0.8935546278953552, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.21750053763389587, "acc": 0.9079667925834656, "length": 3.998417377471924, "mode": "train", "epoch": 36}
{"loss": 0.25297823548316956, "acc": 0.8943358063697815, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.20565496385097504, "acc": 0.914614200592041, "length": 3.9999425411224365, "mode": "train", "epoch": 37}
{"loss": 0.23638293147087097, "acc": 0.9037109017372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.20803837478160858, "acc": 0.917222797870636, "length": 3.999847412109375, "mode": "train", "epoch": 38}
{"loss": 0.2447165846824646, "acc": 0.9021483063697815, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20817086100578308, "acc": 0.9190236330032349, "length": 3.999948263168335, "mode": "train", "epoch": 39}
{"loss": 0.23982620239257812, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1974746733903885, "acc": 0.9200690388679504, "length": 3.9999852180480957, "mode": "train", "epoch": 40}
{"loss": 0.23208600282669067, "acc": 0.9056640267372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.19358554482460022, "acc": 0.9206663966178894, "length": 3.9986658096313477, "mode": "train", "epoch": 41}
{"loss": 0.23057805001735687, "acc": 0.9044922590255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.19818301498889923, "acc": 0.92128586769104, "length": 3.9999685287475586, "mode": "train", "epoch": 42}
{"loss": 0.2297619879245758, "acc": 0.9015625715255737, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.19701191782951355, "acc": 0.9217506647109985, "length": 3.999971628189087, "mode": "train", "epoch": 43}
{"loss": 0.23119182884693146, "acc": 0.9039063453674316, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.19406840205192566, "acc": 0.9230232238769531, "length": 3.9998416900634766, "mode": "train", "epoch": 44}
{"loss": 0.22773590683937073, "acc": 0.9031248688697815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1895374357700348, "acc": 0.9235865473747253, "length": 3.9996957778930664, "mode": "train", "epoch": 45}
{"loss": 0.22563791275024414, "acc": 0.9072265028953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18583402037620544, "acc": 0.9280133247375488, "length": 3.9998791217803955, "mode": "train", "epoch": 46}
{"loss": 0.23697614669799805, "acc": 0.9021483063697815, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.18408775329589844, "acc": 0.924034059047699, "length": 3.9987804889678955, "mode": "train", "epoch": 47}
{"loss": 0.21440953016281128, "acc": 0.9179686903953552, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.17616449296474457, "acc": 0.9285956621170044, "length": 3.999981641769409, "mode": "train", "epoch": 48}
{"loss": 0.20869803428649902, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.17237558960914612, "acc": 0.9295234680175781, "length": 3.999964714050293, "mode": "train", "epoch": 49}
{"loss": 0.20403645932674408, "acc": 0.9208984375, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.16980068385601044, "acc": 0.9303266406059265, "length": 3.999718427658081, "mode": "train", "epoch": 50}
{"loss": 0.22078293561935425, "acc": 0.9132813215255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17263074219226837, "acc": 0.9339873194694519, "length": 3.999946117401123, "mode": "train", "epoch": 51}
{"loss": 0.20835793018341064, "acc": 0.9148436188697815, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1680847704410553, "acc": 0.9339877367019653, "length": 3.999894618988037, "mode": "train", "epoch": 52}
{"loss": 0.20619943737983704, "acc": 0.9205079078674316, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.16088593006134033, "acc": 0.9354398250579834, "length": 3.999974250793457, "mode": "train", "epoch": 53}
{"loss": 0.2064344882965088, "acc": 0.9146485328674316, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.16639219224452972, "acc": 0.9305055141448975, "length": 3.9998435974121094, "mode": "train", "epoch": 54}
{"loss": 0.19791723787784576, "acc": 0.9265624284744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1639774888753891, "acc": 0.9346140623092651, "length": 3.996779680252075, "mode": "train", "epoch": 55}
{"loss": 0.21967659890651703, "acc": 0.919921875, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.16199925541877747, "acc": 0.9378172159194946, "length": 3.9999501705169678, "mode": "train", "epoch": 56}
{"loss": 0.20680689811706543, "acc": 0.921875, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1626475751399994, "acc": 0.9368271827697754, "length": 3.999915361404419, "mode": "train", "epoch": 57}
{"loss": 0.18659792840480804, "acc": 0.9246093034744263, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.15917594730854034, "acc": 0.9389197826385498, "length": 3.999972343444824, "mode": "train", "epoch": 58}
{"loss": 0.2008378803730011, "acc": 0.9201172590255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15680862963199615, "acc": 0.9365351796150208, "length": 3.999894618988037, "mode": "train", "epoch": 59}
{"loss": 0.2027822732925415, "acc": 0.9292969107627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.15570363402366638, "acc": 0.9433872103691101, "length": 3.999995708465576, "mode": "train", "epoch": 60}
{"loss": 0.2021733522415161, "acc": 0.9238280653953552, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8405173420906067
