ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6964591145515442, "acc": 0.507369875907898, "length": 3.5043022632598877, "mode": "train", "epoch": 1}
{"loss": 0.6928598880767822, "acc": 0.5069915056228638, "length": 1.0859375, "mode": "test", "epoch": 1}
{"loss": 0.692663311958313, "acc": 0.5184394121170044, "length": 3.4363012313842773, "mode": "train", "epoch": 2}
{"loss": 0.682665228843689, "acc": 0.5755188465118408, "length": 1.61328125, "mode": "test", "epoch": 2}
{"loss": 0.6867020726203918, "acc": 0.5560818314552307, "length": 3.2491977214813232, "mode": "train", "epoch": 3}
{"loss": 0.6683958768844604, "acc": 0.6544128656387329, "length": 2.5078125, "mode": "test", "epoch": 3}
{"loss": 0.6661809682846069, "acc": 0.6498148441314697, "length": 3.235644578933716, "mode": "train", "epoch": 4}
{"loss": 0.6369380950927734, "acc": 0.7224884629249573, "length": 3.33203125, "mode": "test", "epoch": 4}
{"loss": 0.6198015213012695, "acc": 0.7419843077659607, "length": 3.5252833366394043, "mode": "train", "epoch": 5}
{"loss": 0.5771016478538513, "acc": 0.7582764625549316, "length": 3.8359375, "mode": "test", "epoch": 5}
{"loss": 0.543067216873169, "acc": 0.7515017986297607, "length": 3.8638644218444824, "mode": "train", "epoch": 6}
{"loss": 0.5327025651931763, "acc": 0.7531249523162842, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4783340394496918, "acc": 0.7717339992523193, "length": 3.9153740406036377, "mode": "train", "epoch": 7}
{"loss": 0.4791540205478668, "acc": 0.7726563811302185, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4339398443698883, "acc": 0.8050926327705383, "length": 3.928828001022339, "mode": "train", "epoch": 8}
{"loss": 0.4702979028224945, "acc": 0.7710937857627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4036560356616974, "acc": 0.8173155188560486, "length": 3.963958263397217, "mode": "train", "epoch": 9}
{"loss": 0.45058679580688477, "acc": 0.7908202409744263, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3880705237388611, "acc": 0.8282678127288818, "length": 3.9748799800872803, "mode": "train", "epoch": 10}
{"loss": 0.44931870698928833, "acc": 0.7960937023162842, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3761580288410187, "acc": 0.8406455516815186, "length": 3.977756977081299, "mode": "train", "epoch": 11}
{"loss": 0.4348805844783783, "acc": 0.7958984971046448, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3670220673084259, "acc": 0.8451561331748962, "length": 3.9868133068084717, "mode": "train", "epoch": 12}
{"loss": 0.43862614035606384, "acc": 0.7937499284744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.36136966943740845, "acc": 0.8486283421516418, "length": 3.9870784282684326, "mode": "train", "epoch": 13}
{"loss": 0.4226253032684326, "acc": 0.8107423186302185, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3546217381954193, "acc": 0.8493284583091736, "length": 3.9909415245056152, "mode": "train", "epoch": 14}
{"loss": 0.4188704490661621, "acc": 0.8123045563697815, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3490441143512726, "acc": 0.8520025014877319, "length": 3.9907994270324707, "mode": "train", "epoch": 15}
{"loss": 0.43404775857925415, "acc": 0.8148436546325684, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3448673188686371, "acc": 0.8542516827583313, "length": 3.9935057163238525, "mode": "train", "epoch": 16}
{"loss": 0.41633909940719604, "acc": 0.8183593153953552, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3408079445362091, "acc": 0.8560594916343689, "length": 3.992318630218506, "mode": "train", "epoch": 17}
{"loss": 0.4130348563194275, "acc": 0.8226562142372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.3334459364414215, "acc": 0.8559490442276001, "length": 3.991513967514038, "mode": "train", "epoch": 18}
{"loss": 0.4023562967777252, "acc": 0.8300780653953552, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3265620768070221, "acc": 0.8607854843139648, "length": 3.9937124252319336, "mode": "train", "epoch": 19}
{"loss": 0.3913455009460449, "acc": 0.8378906846046448, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3158859610557556, "acc": 0.8663455843925476, "length": 3.9929893016815186, "mode": "train", "epoch": 20}
{"loss": 0.3730580508708954, "acc": 0.8451171517372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.30713415145874023, "acc": 0.8693926930427551, "length": 3.995293617248535, "mode": "train", "epoch": 21}
{"loss": 0.36324554681777954, "acc": 0.8548827767372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.29921427369117737, "acc": 0.8761479258537292, "length": 3.9948906898498535, "mode": "train", "epoch": 22}
{"loss": 0.3784095048904419, "acc": 0.8466796875, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.296129047870636, "acc": 0.8750870823860168, "length": 3.9949276447296143, "mode": "train", "epoch": 23}
{"loss": 0.36263254284858704, "acc": 0.8369140625, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.28492993116378784, "acc": 0.8823513388633728, "length": 3.99662709236145, "mode": "train", "epoch": 24}
{"loss": 0.36131832003593445, "acc": 0.8552733659744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.28376108407974243, "acc": 0.8787246942520142, "length": 3.996271848678589, "mode": "train", "epoch": 25}
{"loss": 0.35787394642829895, "acc": 0.8531250357627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2817229926586151, "acc": 0.8827287554740906, "length": 3.997549057006836, "mode": "train", "epoch": 26}
{"loss": 0.35537445545196533, "acc": 0.8458985090255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.26884177327156067, "acc": 0.8855307102203369, "length": 3.9957053661346436, "mode": "train", "epoch": 27}
{"loss": 0.3460087180137634, "acc": 0.8632813096046448, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.26689356565475464, "acc": 0.8865249156951904, "length": 3.998091220855713, "mode": "train", "epoch": 28}
{"loss": 0.3477383553981781, "acc": 0.8576172590255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2598165273666382, "acc": 0.890442967414856, "length": 3.998108148574829, "mode": "train", "epoch": 29}
{"loss": 0.3686066269874573, "acc": 0.8562499284744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2610752284526825, "acc": 0.8880895972251892, "length": 3.997175931930542, "mode": "train", "epoch": 30}
{"loss": 0.32152849435806274, "acc": 0.8677734732627869, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.24922947585582733, "acc": 0.8969424962997437, "length": 3.998483180999756, "mode": "train", "epoch": 31}
{"loss": 0.3150649666786194, "acc": 0.8671875, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2435387521982193, "acc": 0.8953413367271423, "length": 3.9984426498413086, "mode": "train", "epoch": 32}
{"loss": 0.3062165379524231, "acc": 0.8691406846046448, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.23352329432964325, "acc": 0.9046914577484131, "length": 3.9982755184173584, "mode": "train", "epoch": 33}
{"loss": 0.288950651884079, "acc": 0.8744140267372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.23537813127040863, "acc": 0.9010097980499268, "length": 3.998077869415283, "mode": "train", "epoch": 34}
{"loss": 0.28449320793151855, "acc": 0.8763671517372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.22571416199207306, "acc": 0.9065622687339783, "length": 3.9988393783569336, "mode": "train", "epoch": 35}
{"loss": 0.28445523977279663, "acc": 0.8843750357627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.222945898771286, "acc": 0.9060565233230591, "length": 3.999102830886841, "mode": "train", "epoch": 36}
{"loss": 0.2894640564918518, "acc": 0.8814454078674316, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2211797535419464, "acc": 0.9056239128112793, "length": 3.9987380504608154, "mode": "train", "epoch": 37}
{"loss": 0.27447807788848877, "acc": 0.8888672590255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.21162258088588715, "acc": 0.9121617674827576, "length": 3.9993326663970947, "mode": "train", "epoch": 38}
{"loss": 0.2716383635997772, "acc": 0.8869141340255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20968946814537048, "acc": 0.9140905141830444, "length": 3.99897837638855, "mode": "train", "epoch": 39}
{"loss": 0.25678423047065735, "acc": 0.8822265267372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.20694632828235626, "acc": 0.913465142250061, "length": 3.99908185005188, "mode": "train", "epoch": 40}
{"loss": 0.2505226731300354, "acc": 0.8964843153953552, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.20082645118236542, "acc": 0.9177928566932678, "length": 3.9993340969085693, "mode": "train", "epoch": 41}
{"loss": 0.2563389837741852, "acc": 0.9013671875, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.19695203006267548, "acc": 0.9196210503578186, "length": 3.9991955757141113, "mode": "train", "epoch": 42}
{"loss": 0.25046974420547485, "acc": 0.9021483063697815, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.19200004637241364, "acc": 0.9238716959953308, "length": 3.998960494995117, "mode": "train", "epoch": 43}
{"loss": 0.24411094188690186, "acc": 0.8994140625, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.18590502440929413, "acc": 0.9265454411506653, "length": 3.9994492530822754, "mode": "train", "epoch": 44}
{"loss": 0.2391379177570343, "acc": 0.8999999761581421, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.18495430052280426, "acc": 0.9270338416099548, "length": 3.9991683959960938, "mode": "train", "epoch": 45}
{"loss": 0.24245098233222961, "acc": 0.9076172113418579, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18054163455963135, "acc": 0.9258801341056824, "length": 3.999204635620117, "mode": "train", "epoch": 46}
{"loss": 0.23238670825958252, "acc": 0.8982420563697815, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1767943948507309, "acc": 0.9261934161186218, "length": 3.9991867542266846, "mode": "train", "epoch": 47}
{"loss": 0.22285056114196777, "acc": 0.9095702767372131, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.17354489862918854, "acc": 0.9325332045555115, "length": 3.9995791912078857, "mode": "train", "epoch": 48}
{"loss": 0.23420223593711853, "acc": 0.9109374284744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.17464101314544678, "acc": 0.9274280667304993, "length": 3.999730348587036, "mode": "train", "epoch": 49}
{"loss": 0.23390018939971924, "acc": 0.8955078125, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.17544512450695038, "acc": 0.9302303791046143, "length": 3.999542713165283, "mode": "train", "epoch": 50}
{"loss": 0.2265087217092514, "acc": 0.9035156965255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17214037477970123, "acc": 0.9320247173309326, "length": 3.9996650218963623, "mode": "train", "epoch": 51}
{"loss": 0.21649004518985748, "acc": 0.9095702767372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.16550490260124207, "acc": 0.9326487183570862, "length": 3.999204397201538, "mode": "train", "epoch": 52}
{"loss": 0.2202145755290985, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1616859883069992, "acc": 0.9338712692260742, "length": 3.99977445602417, "mode": "train", "epoch": 53}
{"loss": 0.22470039129257202, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15934757888317108, "acc": 0.9362249374389648, "length": 3.9996771812438965, "mode": "train", "epoch": 54}
{"loss": 0.21490615606307983, "acc": 0.9074220061302185, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1630316525697708, "acc": 0.9329516291618347, "length": 3.999790668487549, "mode": "train", "epoch": 55}
{"loss": 0.21792647242546082, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.16684098541736603, "acc": 0.9325497150421143, "length": 3.999549388885498, "mode": "train", "epoch": 56}
{"loss": 0.21507582068443298, "acc": 0.9095702767372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.15982405841350555, "acc": 0.9350252747535706, "length": 3.9997634887695312, "mode": "train", "epoch": 57}
{"loss": 0.22789627313613892, "acc": 0.9037108421325684, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.1612900048494339, "acc": 0.9316895008087158, "length": 3.9998371601104736, "mode": "train", "epoch": 58}
{"loss": 0.2246900498867035, "acc": 0.9011718034744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.16035521030426025, "acc": 0.9309385418891907, "length": 3.999781608581543, "mode": "train", "epoch": 59}
{"loss": 0.21042297780513763, "acc": 0.9087890386581421, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.15308961272239685, "acc": 0.9369876980781555, "length": 3.999887704849243, "mode": "train", "epoch": 60}
{"loss": 0.21375146508216858, "acc": 0.9001952409744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8114284873008728
