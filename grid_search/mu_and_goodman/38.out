ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6979385018348694, "acc": 0.5169414281845093, "length": 3.408559560775757, "mode": "train", "epoch": 1}
{"loss": 0.6919013261795044, "acc": 0.513476550579071, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6891795992851257, "acc": 0.5397400259971619, "length": 2.627981662750244, "mode": "train", "epoch": 2}
{"loss": 0.6732309460639954, "acc": 0.6029998660087585, "length": 1.65625, "mode": "test", "epoch": 2}
{"loss": 0.6567869782447815, "acc": 0.6410826444625854, "length": 2.361029863357544, "mode": "train", "epoch": 3}
{"loss": 0.6089577078819275, "acc": 0.6957488656044006, "length": 2.4921875, "mode": "test", "epoch": 3}
{"loss": 0.5810484290122986, "acc": 0.7180096507072449, "length": 2.7993624210357666, "mode": "train", "epoch": 4}
{"loss": 0.5515848398208618, "acc": 0.7539703249931335, "length": 3.05078125, "mode": "test", "epoch": 4}
{"loss": 0.517169713973999, "acc": 0.7682586908340454, "length": 2.9925971031188965, "mode": "train", "epoch": 5}
{"loss": 0.5280042886734009, "acc": 0.755905270576477, "length": 3.14453125, "mode": "test", "epoch": 5}
{"loss": 0.48340198397636414, "acc": 0.778094470500946, "length": 2.9276363849639893, "mode": "train", "epoch": 6}
{"loss": 0.5089894533157349, "acc": 0.7681823968887329, "length": 3.0859375, "mode": "test", "epoch": 6}
{"loss": 0.45707565546035767, "acc": 0.7961657047271729, "length": 2.9813919067382812, "mode": "train", "epoch": 7}
{"loss": 0.4931434094905853, "acc": 0.785900890827179, "length": 3.15625, "mode": "test", "epoch": 7}
{"loss": 0.4347619116306305, "acc": 0.8048844933509827, "length": 2.9840190410614014, "mode": "train", "epoch": 8}
{"loss": 0.45850247144699097, "acc": 0.7940460443496704, "length": 3.39453125, "mode": "test", "epoch": 8}
{"loss": 0.4090273976325989, "acc": 0.8211585879325867, "length": 3.2304863929748535, "mode": "train", "epoch": 9}
{"loss": 0.4346533715724945, "acc": 0.7960876226425171, "length": 3.7421875, "mode": "test", "epoch": 9}
{"loss": 0.3817462921142578, "acc": 0.8307445645332336, "length": 3.5400941371917725, "mode": "train", "epoch": 10}
{"loss": 0.4034420847892761, "acc": 0.8239471912384033, "length": 3.92578125, "mode": "test", "epoch": 10}
{"loss": 0.36468005180358887, "acc": 0.8445307016372681, "length": 3.737603187561035, "mode": "train", "epoch": 11}
{"loss": 0.406853586435318, "acc": 0.823254406452179, "length": 3.96484375, "mode": "test", "epoch": 11}
{"loss": 0.35503873229026794, "acc": 0.8475659489631653, "length": 3.817444324493408, "mode": "train", "epoch": 12}
{"loss": 0.39360785484313965, "acc": 0.8302735090255737, "length": 3.98828125, "mode": "test", "epoch": 12}
{"loss": 0.33733701705932617, "acc": 0.8523839712142944, "length": 3.85628080368042, "mode": "train", "epoch": 13}
{"loss": 0.3812810182571411, "acc": 0.8393798470497131, "length": 3.984375, "mode": "test", "epoch": 13}
{"loss": 0.33134374022483826, "acc": 0.8514215350151062, "length": 3.853358507156372, "mode": "train", "epoch": 14}
{"loss": 0.37045276165008545, "acc": 0.826385498046875, "length": 3.984375, "mode": "test", "epoch": 14}
{"loss": 0.32297447323799133, "acc": 0.8605471849441528, "length": 3.888171434402466, "mode": "train", "epoch": 15}
{"loss": 0.3735113739967346, "acc": 0.8392577767372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3154822289943695, "acc": 0.8629280924797058, "length": 3.936307191848755, "mode": "train", "epoch": 16}
{"loss": 0.33522284030914307, "acc": 0.8509765267372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.31229186058044434, "acc": 0.8655088543891907, "length": 3.9324162006378174, "mode": "train", "epoch": 17}
{"loss": 0.3387819826602936, "acc": 0.8443359732627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.30487483739852905, "acc": 0.8598673343658447, "length": 3.961008310317993, "mode": "train", "epoch": 18}
{"loss": 0.3465873599052429, "acc": 0.8492187857627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2930128574371338, "acc": 0.8735764026641846, "length": 3.9831788539886475, "mode": "train", "epoch": 19}
{"loss": 0.3221258819103241, "acc": 0.8539062142372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2874825894832611, "acc": 0.873481810092926, "length": 3.9895145893096924, "mode": "train", "epoch": 20}
{"loss": 0.3146674931049347, "acc": 0.8771485090255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2845391631126404, "acc": 0.8806390762329102, "length": 3.9882519245147705, "mode": "train", "epoch": 21}
{"loss": 0.29781484603881836, "acc": 0.8718748688697815, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2767639756202698, "acc": 0.8761768937110901, "length": 3.992063522338867, "mode": "train", "epoch": 22}
{"loss": 0.29882916808128357, "acc": 0.8714843988418579, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.27112171053886414, "acc": 0.8826660513877869, "length": 3.994002342224121, "mode": "train", "epoch": 23}
{"loss": 0.2923462390899658, "acc": 0.8806639909744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.26812124252319336, "acc": 0.881460964679718, "length": 3.996105670928955, "mode": "train", "epoch": 24}
{"loss": 0.30277207493782043, "acc": 0.8654297590255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.26467961072921753, "acc": 0.8876746296882629, "length": 3.997774124145508, "mode": "train", "epoch": 25}
{"loss": 0.28903162479400635, "acc": 0.8828125, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2699691355228424, "acc": 0.8850131034851074, "length": 3.9975154399871826, "mode": "train", "epoch": 26}
{"loss": 0.278576523065567, "acc": 0.8849607706069946, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.26443952322006226, "acc": 0.8868631720542908, "length": 3.9983668327331543, "mode": "train", "epoch": 27}
{"loss": 0.2858697772026062, "acc": 0.8775390982627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.25473716855049133, "acc": 0.8886319398880005, "length": 3.998745918273926, "mode": "train", "epoch": 28}
{"loss": 0.2731671631336212, "acc": 0.8931640982627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2580944001674652, "acc": 0.8906891942024231, "length": 3.997180938720703, "mode": "train", "epoch": 29}
{"loss": 0.2660478949546814, "acc": 0.8828125, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.25438177585601807, "acc": 0.8912480473518372, "length": 3.9994170665740967, "mode": "train", "epoch": 30}
{"loss": 0.26707011461257935, "acc": 0.8857421875, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.24962912499904633, "acc": 0.8956784605979919, "length": 3.999600410461426, "mode": "train", "epoch": 31}
{"loss": 0.2586590647697449, "acc": 0.8880859017372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.23832587897777557, "acc": 0.9023197293281555, "length": 3.997178792953491, "mode": "train", "epoch": 32}
{"loss": 0.2532600462436676, "acc": 0.8894530534744263, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2290715128183365, "acc": 0.9048728346824646, "length": 3.99924635887146, "mode": "train", "epoch": 33}
{"loss": 0.2550942599773407, "acc": 0.8861327171325684, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.22019006311893463, "acc": 0.9068865776062012, "length": 3.9994328022003174, "mode": "train", "epoch": 34}
{"loss": 0.23608508706092834, "acc": 0.9029296636581421, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.20584909617900848, "acc": 0.9166962504386902, "length": 3.9997599124908447, "mode": "train", "epoch": 35}
{"loss": 0.2147923707962036, "acc": 0.9119139909744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.20358900725841522, "acc": 0.9166239500045776, "length": 3.9994306564331055, "mode": "train", "epoch": 36}
{"loss": 0.20458829402923584, "acc": 0.9189452528953552, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2060171514749527, "acc": 0.9152663350105286, "length": 3.9994845390319824, "mode": "train", "epoch": 37}
{"loss": 0.2060241401195526, "acc": 0.9117187857627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.20098671317100525, "acc": 0.916341245174408, "length": 3.9996707439422607, "mode": "train", "epoch": 38}
{"loss": 0.20514120161533356, "acc": 0.9236327409744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.18978847563266754, "acc": 0.9221819639205933, "length": 3.999692678451538, "mode": "train", "epoch": 39}
{"loss": 0.22375987470149994, "acc": 0.9128905534744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19480262696743011, "acc": 0.9191838502883911, "length": 3.996668577194214, "mode": "train", "epoch": 40}
{"loss": 0.21504093706607819, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.18928880989551544, "acc": 0.921190083026886, "length": 3.999917507171631, "mode": "train", "epoch": 41}
{"loss": 0.2110695242881775, "acc": 0.9246093034744263, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.18924815952777863, "acc": 0.9226050972938538, "length": 3.9998598098754883, "mode": "train", "epoch": 42}
{"loss": 0.20295560359954834, "acc": 0.9255858659744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1954345852136612, "acc": 0.9232568740844727, "length": 3.9999630451202393, "mode": "train", "epoch": 43}
{"loss": 0.21118830144405365, "acc": 0.9160155653953552, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2068205624818802, "acc": 0.9149553179740906, "length": 3.999016284942627, "mode": "train", "epoch": 44}
{"loss": 0.20579154789447784, "acc": 0.9177733659744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1776951253414154, "acc": 0.9240190982818604, "length": 3.9998700618743896, "mode": "train", "epoch": 45}
{"loss": 0.19909393787384033, "acc": 0.9205078482627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.17925985157489777, "acc": 0.9303401708602905, "length": 3.9999489784240723, "mode": "train", "epoch": 46}
{"loss": 0.1799233853816986, "acc": 0.9324218034744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.174331396818161, "acc": 0.9312261939048767, "length": 3.9999654293060303, "mode": "train", "epoch": 47}
{"loss": 0.19207513332366943, "acc": 0.9314451813697815, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.17387227714061737, "acc": 0.9300856590270996, "length": 3.9996211528778076, "mode": "train", "epoch": 48}
{"loss": 0.18574635684490204, "acc": 0.9312499761581421, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.17826847732067108, "acc": 0.930164098739624, "length": 3.999969482421875, "mode": "train", "epoch": 49}
{"loss": 0.17478196322917938, "acc": 0.9371094107627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.20640161633491516, "acc": 0.9163970351219177, "length": 3.999549388885498, "mode": "train", "epoch": 50}
{"loss": 0.17476236820220947, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.19954897463321686, "acc": 0.9261950254440308, "length": 3.99957537651062, "mode": "train", "epoch": 51}
{"loss": 0.169370636343956, "acc": 0.9369140267372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2187773883342743, "acc": 0.9208205938339233, "length": 3.9995946884155273, "mode": "train", "epoch": 52}
{"loss": 0.21393389999866486, "acc": 0.9255858659744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1969863474369049, "acc": 0.9251455068588257, "length": 3.999960422515869, "mode": "train", "epoch": 53}
{"loss": 0.1924273669719696, "acc": 0.9378905892372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.17024646699428558, "acc": 0.9348087310791016, "length": 3.9995553493499756, "mode": "train", "epoch": 54}
{"loss": 0.18306399881839752, "acc": 0.9349609613418579, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.16860316693782806, "acc": 0.9341471791267395, "length": 3.998090982437134, "mode": "train", "epoch": 55}
{"loss": 0.18442238867282867, "acc": 0.9279298186302185, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1560095250606537, "acc": 0.9388253092765808, "length": 3.9996845722198486, "mode": "train", "epoch": 56}
{"loss": 0.16240157186985016, "acc": 0.9416016340255737, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.14910361170768738, "acc": 0.9396673440933228, "length": 3.9998691082000732, "mode": "train", "epoch": 57}
{"loss": 0.1660839170217514, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.14804832637310028, "acc": 0.9427977800369263, "length": 3.999995708465576, "mode": "train", "epoch": 58}
{"loss": 0.16041095554828644, "acc": 0.9419922232627869, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.14919577538967133, "acc": 0.9400821924209595, "length": 3.999993085861206, "mode": "train", "epoch": 59}
{"loss": 0.17062051594257355, "acc": 0.9357422590255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14309366047382355, "acc": 0.9442734122276306, "length": 3.9999935626983643, "mode": "train", "epoch": 60}
{"loss": 0.16061578691005707, "acc": 0.947265625, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8125806450843811
