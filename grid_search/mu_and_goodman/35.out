ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6926063895225525, "acc": 0.5196921825408936, "length": 3.530472993850708, "mode": "train", "epoch": 1}
{"loss": 0.6909725069999695, "acc": 0.5349608063697815, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6895195245742798, "acc": 0.5327205657958984, "length": 3.441422462463379, "mode": "train", "epoch": 2}
{"loss": 0.6899816393852234, "acc": 0.5253418684005737, "length": 1.06640625, "mode": "test", "epoch": 2}
{"loss": 0.6844538450241089, "acc": 0.5573511123657227, "length": 3.3354430198669434, "mode": "train", "epoch": 3}
{"loss": 0.6650941371917725, "acc": 0.6284546256065369, "length": 2.25390625, "mode": "test", "epoch": 3}
{"loss": 0.6669939756393433, "acc": 0.5993028879165649, "length": 3.3394227027893066, "mode": "train", "epoch": 4}
{"loss": 0.6257495880126953, "acc": 0.7093933820724487, "length": 3.90625, "mode": "test", "epoch": 4}
{"loss": 0.6166490316390991, "acc": 0.7054784297943115, "length": 3.5950422286987305, "mode": "train", "epoch": 5}
{"loss": 0.5581121444702148, "acc": 0.7373046875, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5272775292396545, "acc": 0.7544297575950623, "length": 3.8463003635406494, "mode": "train", "epoch": 6}
{"loss": 0.5196244716644287, "acc": 0.7431641221046448, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.46987980604171753, "acc": 0.7806525826454163, "length": 3.9248647689819336, "mode": "train", "epoch": 7}
{"loss": 0.5113157629966736, "acc": 0.7824219465255737, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.43892768025398254, "acc": 0.791978657245636, "length": 3.9228835105895996, "mode": "train", "epoch": 8}
{"loss": 0.47235924005508423, "acc": 0.7953124642372131, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.41079381108283997, "acc": 0.8117822408676147, "length": 3.9305732250213623, "mode": "train", "epoch": 9}
{"loss": 0.4371345043182373, "acc": 0.8029297590255737, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.39626601338386536, "acc": 0.8220347762107849, "length": 3.9487838745117188, "mode": "train", "epoch": 10}
{"loss": 0.4214116334915161, "acc": 0.8060546517372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.38722673058509827, "acc": 0.8224074840545654, "length": 3.9622843265533447, "mode": "train", "epoch": 11}
{"loss": 0.426800012588501, "acc": 0.8082032203674316, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3775465190410614, "acc": 0.832863450050354, "length": 3.964310884475708, "mode": "train", "epoch": 12}
{"loss": 0.4220660328865051, "acc": 0.8111328482627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3698543608188629, "acc": 0.8399308919906616, "length": 3.9706079959869385, "mode": "train", "epoch": 13}
{"loss": 0.4064914584159851, "acc": 0.8210936784744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.35730603337287903, "acc": 0.8438329696655273, "length": 3.9728100299835205, "mode": "train", "epoch": 14}
{"loss": 0.3944705128669739, "acc": 0.8267578482627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3466677665710449, "acc": 0.8509626984596252, "length": 3.9753472805023193, "mode": "train", "epoch": 15}
{"loss": 0.3805238604545593, "acc": 0.8412109017372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3323397636413574, "acc": 0.8545403480529785, "length": 3.98250675201416, "mode": "train", "epoch": 16}
{"loss": 0.35903334617614746, "acc": 0.8574218153953552, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.30591750144958496, "acc": 0.8655245304107666, "length": 3.984941244125366, "mode": "train", "epoch": 17}
{"loss": 0.36243119835853577, "acc": 0.8556641340255737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.29596272110939026, "acc": 0.8779318928718567, "length": 3.9882121086120605, "mode": "train", "epoch": 18}
{"loss": 0.3685464560985565, "acc": 0.8593750596046448, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.28594163060188293, "acc": 0.8832123279571533, "length": 3.9892759323120117, "mode": "train", "epoch": 19}
{"loss": 0.3790320158004761, "acc": 0.859375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.28607869148254395, "acc": 0.8815996050834656, "length": 3.990844488143921, "mode": "train", "epoch": 20}
{"loss": 0.37466394901275635, "acc": 0.8646484613418579, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.27300578355789185, "acc": 0.8913573026657104, "length": 3.991692066192627, "mode": "train", "epoch": 21}
{"loss": 0.3528324365615845, "acc": 0.8636718392372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2642722725868225, "acc": 0.8937015533447266, "length": 3.9921200275421143, "mode": "train", "epoch": 22}
{"loss": 0.3443790674209595, "acc": 0.865234375, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.25915512442588806, "acc": 0.895072340965271, "length": 3.9944915771484375, "mode": "train", "epoch": 23}
{"loss": 0.34357210993766785, "acc": 0.8701171875, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.24432359635829926, "acc": 0.8995299935340881, "length": 3.9949913024902344, "mode": "train", "epoch": 24}
{"loss": 0.3443136513233185, "acc": 0.8648437857627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.23960158228874207, "acc": 0.8998348116874695, "length": 3.994938850402832, "mode": "train", "epoch": 25}
{"loss": 0.35343077778816223, "acc": 0.8705078363418579, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.23653264343738556, "acc": 0.9028222560882568, "length": 3.995563268661499, "mode": "train", "epoch": 26}
{"loss": 0.3483390212059021, "acc": 0.8720703721046448, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.23450306057929993, "acc": 0.9061563611030579, "length": 3.9956910610198975, "mode": "train", "epoch": 27}
{"loss": 0.34308362007141113, "acc": 0.8673829436302185, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23218880593776703, "acc": 0.9079228043556213, "length": 3.996065139770508, "mode": "train", "epoch": 28}
{"loss": 0.32335740327835083, "acc": 0.8775390386581421, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2183905988931656, "acc": 0.908900260925293, "length": 3.9957118034362793, "mode": "train", "epoch": 29}
{"loss": 0.33139944076538086, "acc": 0.8707031607627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.21499228477478027, "acc": 0.9154608249664307, "length": 3.9961788654327393, "mode": "train", "epoch": 30}
{"loss": 0.33462387323379517, "acc": 0.8714843392372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.21646542847156525, "acc": 0.9109155535697937, "length": 3.996990203857422, "mode": "train", "epoch": 31}
{"loss": 0.31654906272888184, "acc": 0.8804687261581421, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.20748314261436462, "acc": 0.9171645641326904, "length": 3.996849536895752, "mode": "train", "epoch": 32}
{"loss": 0.30930936336517334, "acc": 0.8869141340255737, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2079535573720932, "acc": 0.9167024493217468, "length": 3.996887445449829, "mode": "train", "epoch": 33}
{"loss": 0.3233222961425781, "acc": 0.876953125, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.20112493634223938, "acc": 0.9215533137321472, "length": 3.9968435764312744, "mode": "train", "epoch": 34}
{"loss": 0.31120455265045166, "acc": 0.8812499642372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2016439288854599, "acc": 0.9193912148475647, "length": 3.996856451034546, "mode": "train", "epoch": 35}
{"loss": 0.3164260685443878, "acc": 0.8728514909744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.20043814182281494, "acc": 0.9198234677314758, "length": 3.998476505279541, "mode": "train", "epoch": 36}
{"loss": 0.30162695050239563, "acc": 0.888671875, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1923704594373703, "acc": 0.9247967004776001, "length": 3.9983315467834473, "mode": "train", "epoch": 37}
{"loss": 0.29567813873291016, "acc": 0.890625, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1909472942352295, "acc": 0.9243922233581543, "length": 3.9985756874084473, "mode": "train", "epoch": 38}
{"loss": 0.3079849183559418, "acc": 0.8746094107627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.19035938382148743, "acc": 0.9267886877059937, "length": 3.998556613922119, "mode": "train", "epoch": 39}
{"loss": 0.30090799927711487, "acc": 0.8888672590255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.18656417727470398, "acc": 0.9284344911575317, "length": 3.9988300800323486, "mode": "train", "epoch": 40}
{"loss": 0.2919427454471588, "acc": 0.8855467438697815, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.18971936404705048, "acc": 0.9300712943077087, "length": 3.998830556869507, "mode": "train", "epoch": 41}
{"loss": 0.3051438629627228, "acc": 0.8792968392372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.17376257479190826, "acc": 0.9361546039581299, "length": 3.9986040592193604, "mode": "train", "epoch": 42}
{"loss": 0.29552650451660156, "acc": 0.8884764909744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.17351622879505157, "acc": 0.9364541172981262, "length": 3.9988598823547363, "mode": "train", "epoch": 43}
{"loss": 0.29560959339141846, "acc": 0.8619140982627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.16842438280582428, "acc": 0.9343474507331848, "length": 3.998924493789673, "mode": "train", "epoch": 44}
{"loss": 0.2652340233325958, "acc": 0.8943358659744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.17075075209140778, "acc": 0.932828962802887, "length": 3.9991753101348877, "mode": "train", "epoch": 45}
{"loss": 0.2655320465564728, "acc": 0.890625, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.16625337302684784, "acc": 0.9373388886451721, "length": 3.9992053508758545, "mode": "train", "epoch": 46}
{"loss": 0.24186338484287262, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.16804338991641998, "acc": 0.9355210065841675, "length": 3.9991424083709717, "mode": "train", "epoch": 47}
{"loss": 0.2494013011455536, "acc": 0.9138670563697815, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.16348710656166077, "acc": 0.9413729906082153, "length": 3.9991188049316406, "mode": "train", "epoch": 48}
{"loss": 0.23898687958717346, "acc": 0.9109373688697815, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.16433580219745636, "acc": 0.9417228102684021, "length": 3.9989726543426514, "mode": "train", "epoch": 49}
{"loss": 0.2468961477279663, "acc": 0.8914061784744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.15484562516212463, "acc": 0.9421945810317993, "length": 3.99916934967041, "mode": "train", "epoch": 50}
{"loss": 0.24274176359176636, "acc": 0.9101561903953552, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.15606151521205902, "acc": 0.938216507434845, "length": 3.99930477142334, "mode": "train", "epoch": 51}
{"loss": 0.2389475703239441, "acc": 0.9152344465255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.14672626554965973, "acc": 0.9462398290634155, "length": 3.999370574951172, "mode": "train", "epoch": 52}
{"loss": 0.23834076523780823, "acc": 0.9136719107627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.14853453636169434, "acc": 0.9471174478530884, "length": 3.9993293285369873, "mode": "train", "epoch": 53}
{"loss": 0.21785634756088257, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.14224018156528473, "acc": 0.947878360748291, "length": 3.999387264251709, "mode": "train", "epoch": 54}
{"loss": 0.23172010481357574, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.14169225096702576, "acc": 0.9472886323928833, "length": 3.9991631507873535, "mode": "train", "epoch": 55}
{"loss": 0.20944744348526, "acc": 0.9203124642372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.13858012855052948, "acc": 0.9484092593193054, "length": 3.9994471073150635, "mode": "train", "epoch": 56}
{"loss": 0.20444682240486145, "acc": 0.9224609732627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.13562044501304626, "acc": 0.9536763429641724, "length": 3.9995245933532715, "mode": "train", "epoch": 57}
{"loss": 0.19326427578926086, "acc": 0.9306640625, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.13391007483005524, "acc": 0.9526727199554443, "length": 3.9990530014038086, "mode": "train", "epoch": 58}
{"loss": 0.19440239667892456, "acc": 0.9300780892372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.135224848985672, "acc": 0.9535013437271118, "length": 3.9995365142822266, "mode": "train", "epoch": 59}
{"loss": 0.1972055435180664, "acc": 0.927734375, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.12548668682575226, "acc": 0.954729437828064, "length": 3.9995133876800537, "mode": "train", "epoch": 60}
{"loss": 0.1861383616924286, "acc": 0.9205078482627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8086666464805603
