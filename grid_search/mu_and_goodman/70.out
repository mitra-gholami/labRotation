ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6973844170570374, "acc": 0.5041412115097046, "length": 3.5429232120513916, "mode": "train", "epoch": 1}
{"loss": 0.6926023960113525, "acc": 0.5173828601837158, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.691925048828125, "acc": 0.5247552394866943, "length": 3.3764567375183105, "mode": "train", "epoch": 2}
{"loss": 0.6930296421051025, "acc": 0.5019531846046448, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6895440220832825, "acc": 0.5279953479766846, "length": 3.176299571990967, "mode": "train", "epoch": 3}
{"loss": 0.6811373233795166, "acc": 0.6080397963523865, "length": 1.73828125, "mode": "test", "epoch": 3}
{"loss": 0.6797372698783875, "acc": 0.5734766125679016, "length": 3.1995723247528076, "mode": "train", "epoch": 4}
{"loss": 0.6495476365089417, "acc": 0.7229171991348267, "length": 3.0625, "mode": "test", "epoch": 4}
{"loss": 0.6535791158676147, "acc": 0.6541137099266052, "length": 3.460144281387329, "mode": "train", "epoch": 5}
{"loss": 0.6093344688415527, "acc": 0.738932728767395, "length": 3.671875, "mode": "test", "epoch": 5}
{"loss": 0.6021930575370789, "acc": 0.7533692717552185, "length": 3.6652112007141113, "mode": "train", "epoch": 6}
{"loss": 0.5467314720153809, "acc": 0.7798828482627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5292454361915588, "acc": 0.7699576616287231, "length": 3.831472635269165, "mode": "train", "epoch": 7}
{"loss": 0.5015997290611267, "acc": 0.7916015982627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4672408103942871, "acc": 0.7877525091171265, "length": 3.906964063644409, "mode": "train", "epoch": 8}
{"loss": 0.45511817932128906, "acc": 0.8207031488418579, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.41788360476493835, "acc": 0.8228009939193726, "length": 3.934406042098999, "mode": "train", "epoch": 9}
{"loss": 0.411543607711792, "acc": 0.8281250596046448, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.388049840927124, "acc": 0.8305312395095825, "length": 3.9443557262420654, "mode": "train", "epoch": 10}
{"loss": 0.39778971672058105, "acc": 0.8343749642372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.34947460889816284, "acc": 0.8551325798034668, "length": 3.948951482772827, "mode": "train", "epoch": 11}
{"loss": 0.37487179040908813, "acc": 0.8539062142372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3219080865383148, "acc": 0.8681177496910095, "length": 3.964566469192505, "mode": "train", "epoch": 12}
{"loss": 0.3452427387237549, "acc": 0.8648437857627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2923838198184967, "acc": 0.8826059699058533, "length": 3.9761903285980225, "mode": "train", "epoch": 13}
{"loss": 0.33434656262397766, "acc": 0.8738280534744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.27644819021224976, "acc": 0.8900535702705383, "length": 3.9827895164489746, "mode": "train", "epoch": 14}
{"loss": 0.3234577178955078, "acc": 0.8843750357627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.26530852913856506, "acc": 0.8934755325317383, "length": 3.9863269329071045, "mode": "train", "epoch": 15}
{"loss": 0.30535632371902466, "acc": 0.8777345418930054, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.25131848454475403, "acc": 0.8962339162826538, "length": 3.9877357482910156, "mode": "train", "epoch": 16}
{"loss": 0.29999423027038574, "acc": 0.8763671517372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.24293658137321472, "acc": 0.9050225615501404, "length": 3.992500066757202, "mode": "train", "epoch": 17}
{"loss": 0.2956525683403015, "acc": 0.8814453482627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.23270432651042938, "acc": 0.9082627892494202, "length": 3.9916861057281494, "mode": "train", "epoch": 18}
{"loss": 0.3008534610271454, "acc": 0.8759766221046448, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.21807561814785004, "acc": 0.9169409275054932, "length": 3.9936115741729736, "mode": "train", "epoch": 19}
{"loss": 0.3021391034126282, "acc": 0.8777342438697815, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21381886303424835, "acc": 0.9193224906921387, "length": 3.9926364421844482, "mode": "train", "epoch": 20}
{"loss": 0.2761439383029938, "acc": 0.9080077409744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2022506296634674, "acc": 0.9264825582504272, "length": 3.9945228099823, "mode": "train", "epoch": 21}
{"loss": 0.27465760707855225, "acc": 0.8972655534744263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.1987149566411972, "acc": 0.9206593036651611, "length": 3.995284080505371, "mode": "train", "epoch": 22}
{"loss": 0.2571626901626587, "acc": 0.9052733778953552, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1866953819990158, "acc": 0.9343572854995728, "length": 3.9951417446136475, "mode": "train", "epoch": 23}
{"loss": 0.2579566538333893, "acc": 0.9128905534744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.184739351272583, "acc": 0.931222140789032, "length": 3.9962198734283447, "mode": "train", "epoch": 24}
{"loss": 0.26723694801330566, "acc": 0.9074219465255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.17411217093467712, "acc": 0.9366699457168579, "length": 3.9943439960479736, "mode": "train", "epoch": 25}
{"loss": 0.2534317374229431, "acc": 0.9125000238418579, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1675323098897934, "acc": 0.9372321963310242, "length": 3.9957973957061768, "mode": "train", "epoch": 26}
{"loss": 0.25398680567741394, "acc": 0.9152345061302185, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1649494618177414, "acc": 0.9404610991477966, "length": 3.9969499111175537, "mode": "train", "epoch": 27}
{"loss": 0.25870251655578613, "acc": 0.9152344465255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.16145841777324677, "acc": 0.9420718550682068, "length": 3.9979724884033203, "mode": "train", "epoch": 28}
{"loss": 0.22897624969482422, "acc": 0.9216795563697815, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.16015051305294037, "acc": 0.9362499713897705, "length": 3.9972169399261475, "mode": "train", "epoch": 29}
{"loss": 0.2278488129377365, "acc": 0.9199219346046448, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.15340615808963776, "acc": 0.9480599164962769, "length": 3.9984853267669678, "mode": "train", "epoch": 30}
{"loss": 0.2171037793159485, "acc": 0.9279298186302185, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.15487103164196014, "acc": 0.9431828260421753, "length": 3.9970223903656006, "mode": "train", "epoch": 31}
{"loss": 0.22260217368602753, "acc": 0.9277343153953552, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.14909349381923676, "acc": 0.9444929361343384, "length": 3.9979772567749023, "mode": "train", "epoch": 32}
{"loss": 0.19124141335487366, "acc": 0.9328125715255737, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.14192557334899902, "acc": 0.9498687386512756, "length": 3.9986727237701416, "mode": "train", "epoch": 33}
{"loss": 0.2101789116859436, "acc": 0.9343749284744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.14150279760360718, "acc": 0.9488211870193481, "length": 3.998181104660034, "mode": "train", "epoch": 34}
{"loss": 0.207489013671875, "acc": 0.9287109375, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.13436077535152435, "acc": 0.9546918272972107, "length": 3.998156785964966, "mode": "train", "epoch": 35}
{"loss": 0.1903260350227356, "acc": 0.9390625357627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.13386990129947662, "acc": 0.9511756896972656, "length": 3.9991328716278076, "mode": "train", "epoch": 36}
{"loss": 0.185949444770813, "acc": 0.9419922232627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.13384290039539337, "acc": 0.9498505592346191, "length": 3.9977774620056152, "mode": "train", "epoch": 37}
{"loss": 0.19842202961444855, "acc": 0.9404296875, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.13405601680278778, "acc": 0.9517596960067749, "length": 3.998246908187866, "mode": "train", "epoch": 38}
{"loss": 0.16569413244724274, "acc": 0.9505859017372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1312163919210434, "acc": 0.9545475244522095, "length": 3.9990386962890625, "mode": "train", "epoch": 39}
{"loss": 0.1794838011264801, "acc": 0.9515624642372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1296093463897705, "acc": 0.9504415988922119, "length": 3.9994146823883057, "mode": "train", "epoch": 40}
{"loss": 0.14784589409828186, "acc": 0.9589843153953552, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.12507979571819305, "acc": 0.9572098255157471, "length": 3.9990620613098145, "mode": "train", "epoch": 41}
{"loss": 0.16561874747276306, "acc": 0.9541016221046448, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.12113869935274124, "acc": 0.9569298624992371, "length": 3.998378038406372, "mode": "train", "epoch": 42}
{"loss": 0.17010276019573212, "acc": 0.9527344107627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.11168581247329712, "acc": 0.962087869644165, "length": 3.9991979598999023, "mode": "train", "epoch": 43}
{"loss": 0.1433192491531372, "acc": 0.9583984017372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.11529358476400375, "acc": 0.9592562913894653, "length": 3.9994513988494873, "mode": "train", "epoch": 44}
{"loss": 0.14349247515201569, "acc": 0.9582031965255737, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.11520153284072876, "acc": 0.9568865299224854, "length": 3.9996278285980225, "mode": "train", "epoch": 45}
{"loss": 0.1444622278213501, "acc": 0.9595703482627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1124279648065567, "acc": 0.9604225754737854, "length": 3.999621868133545, "mode": "train", "epoch": 46}
{"loss": 0.1167662963271141, "acc": 0.9662109017372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.11068658530712128, "acc": 0.9580453634262085, "length": 3.999643087387085, "mode": "train", "epoch": 47}
{"loss": 0.12321394681930542, "acc": 0.9615235328674316, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11129070818424225, "acc": 0.9599470496177673, "length": 3.998917579650879, "mode": "train", "epoch": 48}
{"loss": 0.13120880722999573, "acc": 0.9650391340255737, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.10265123844146729, "acc": 0.9616352319717407, "length": 3.999398946762085, "mode": "train", "epoch": 49}
{"loss": 0.12756560742855072, "acc": 0.9636717438697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.10790252685546875, "acc": 0.9600819945335388, "length": 3.999713659286499, "mode": "train", "epoch": 50}
{"loss": 0.11623451113700867, "acc": 0.9650391340255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.10446804016828537, "acc": 0.9618791341781616, "length": 3.999584197998047, "mode": "train", "epoch": 51}
{"loss": 0.12518689036369324, "acc": 0.9638672471046448, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.10410548001527786, "acc": 0.9630400538444519, "length": 3.9996237754821777, "mode": "train", "epoch": 52}
{"loss": 0.13238321244716644, "acc": 0.9644532203674316, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.09791304171085358, "acc": 0.9643746614456177, "length": 3.999734878540039, "mode": "train", "epoch": 53}
{"loss": 0.1094377338886261, "acc": 0.9687499403953552, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.10115693509578705, "acc": 0.9636231064796448, "length": 3.999746561050415, "mode": "train", "epoch": 54}
{"loss": 0.11334767937660217, "acc": 0.9671875238418579, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.10327676683664322, "acc": 0.9642643928527832, "length": 3.9998679161071777, "mode": "train", "epoch": 55}
{"loss": 0.12300921976566315, "acc": 0.962890625, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.09838175028562546, "acc": 0.964493453502655, "length": 3.9998111724853516, "mode": "train", "epoch": 56}
{"loss": 0.11126318573951721, "acc": 0.9673828482627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1011805608868599, "acc": 0.9604350328445435, "length": 3.9996745586395264, "mode": "train", "epoch": 57}
{"loss": 0.10387168079614639, "acc": 0.9705077409744263, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.0919056087732315, "acc": 0.9667028188705444, "length": 3.998568058013916, "mode": "train", "epoch": 58}
{"loss": 0.11968261003494263, "acc": 0.9640625715255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09384594857692719, "acc": 0.964547336101532, "length": 3.9997334480285645, "mode": "train", "epoch": 59}
{"loss": 0.09122925996780396, "acc": 0.9693359732627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.08988337218761444, "acc": 0.9651352763175964, "length": 3.9999003410339355, "mode": "train", "epoch": 60}
{"loss": 0.12225084006786346, "acc": 0.9603515267372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8467240929603577
