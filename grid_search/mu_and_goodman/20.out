ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6967029571533203, "acc": 0.5085471272468567, "length": 3.1856980323791504, "mode": "train", "epoch": 1}
{"loss": 0.6926440596580505, "acc": 0.4934753179550171, "length": 1.15234375, "mode": "test", "epoch": 1}
{"loss": 0.6186840534210205, "acc": 0.6822097301483154, "length": 3.071791648864746, "mode": "train", "epoch": 2}
{"loss": 0.5664591789245605, "acc": 0.7472900152206421, "length": 3.49609375, "mode": "test", "epoch": 2}
{"loss": 0.5152493715286255, "acc": 0.7528737187385559, "length": 2.9534130096435547, "mode": "train", "epoch": 3}
{"loss": 0.520442545413971, "acc": 0.7620788812637329, "length": 3.09375, "mode": "test", "epoch": 3}
{"loss": 0.47526583075523376, "acc": 0.7901399731636047, "length": 2.941021203994751, "mode": "train", "epoch": 4}
{"loss": 0.4988236427307129, "acc": 0.7806640863418579, "length": 3.03515625, "mode": "test", "epoch": 4}
{"loss": 0.4543362855911255, "acc": 0.7969760298728943, "length": 2.91867995262146, "mode": "train", "epoch": 5}
{"loss": 0.48486006259918213, "acc": 0.7929443120956421, "length": 3.015625, "mode": "test", "epoch": 5}
{"loss": 0.4297370910644531, "acc": 0.8105151653289795, "length": 3.1445963382720947, "mode": "train", "epoch": 6}
{"loss": 0.48733675479888916, "acc": 0.780773937702179, "length": 3.38671875, "mode": "test", "epoch": 6}
{"loss": 0.3861599564552307, "acc": 0.8311505317687988, "length": 3.6103317737579346, "mode": "train", "epoch": 7}
{"loss": 0.3906392753124237, "acc": 0.830078125, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.34650155901908875, "acc": 0.8498596549034119, "length": 3.8864428997039795, "mode": "train", "epoch": 8}
{"loss": 0.3537389039993286, "acc": 0.8500000238418579, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.30524638295173645, "acc": 0.8707125782966614, "length": 3.928135395050049, "mode": "train", "epoch": 9}
{"loss": 0.33257877826690674, "acc": 0.8501953482627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.2887361943721771, "acc": 0.8815475702285767, "length": 3.953108310699463, "mode": "train", "epoch": 10}
{"loss": 0.32450947165489197, "acc": 0.8550781607627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2761874794960022, "acc": 0.8831572532653809, "length": 3.9730284214019775, "mode": "train", "epoch": 11}
{"loss": 0.2955058813095093, "acc": 0.8744140267372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2743331789970398, "acc": 0.8847562670707703, "length": 3.98039174079895, "mode": "train", "epoch": 12}
{"loss": 0.2911561131477356, "acc": 0.8791016340255737, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.25784847140312195, "acc": 0.894224226474762, "length": 3.9863975048065186, "mode": "train", "epoch": 13}
{"loss": 0.29322344064712524, "acc": 0.876953125, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.24722805619239807, "acc": 0.9007726907730103, "length": 3.9900717735290527, "mode": "train", "epoch": 14}
{"loss": 0.29576176404953003, "acc": 0.8771485090255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.23805750906467438, "acc": 0.9037581086158752, "length": 3.9939932823181152, "mode": "train", "epoch": 15}
{"loss": 0.2896520495414734, "acc": 0.8857421875, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.23941481113433838, "acc": 0.9044785499572754, "length": 3.9933066368103027, "mode": "train", "epoch": 16}
{"loss": 0.29270389676094055, "acc": 0.8874999284744263, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2291724979877472, "acc": 0.9101468920707703, "length": 3.995408296585083, "mode": "train", "epoch": 17}
{"loss": 0.2534584701061249, "acc": 0.9017577767372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.22159956395626068, "acc": 0.9124623537063599, "length": 3.995488405227661, "mode": "train", "epoch": 18}
{"loss": 0.27675125002861023, "acc": 0.8937500715255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2149261236190796, "acc": 0.9182859659194946, "length": 3.995739698410034, "mode": "train", "epoch": 19}
{"loss": 0.2542720437049866, "acc": 0.9130859375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.20737464725971222, "acc": 0.9218764305114746, "length": 3.9982404708862305, "mode": "train", "epoch": 20}
{"loss": 0.23381470143795013, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.20418541133403778, "acc": 0.9248839020729065, "length": 3.9983911514282227, "mode": "train", "epoch": 21}
{"loss": 0.23063723742961884, "acc": 0.9187498688697815, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.19314561784267426, "acc": 0.9279621839523315, "length": 3.9986579418182373, "mode": "train", "epoch": 22}
{"loss": 0.20966944098472595, "acc": 0.9224609732627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.18807223439216614, "acc": 0.9284878373146057, "length": 3.9977548122406006, "mode": "train", "epoch": 23}
{"loss": 0.2055342197418213, "acc": 0.9298828840255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.17951761186122894, "acc": 0.9324551224708557, "length": 3.9987452030181885, "mode": "train", "epoch": 24}
{"loss": 0.20147107541561127, "acc": 0.9308594465255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.17774717509746552, "acc": 0.9349358081817627, "length": 3.9994521141052246, "mode": "train", "epoch": 25}
{"loss": 0.22113287448883057, "acc": 0.9257813096046448, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.17966991662979126, "acc": 0.9343463778495789, "length": 3.999488115310669, "mode": "train", "epoch": 26}
{"loss": 0.20758098363876343, "acc": 0.9285155534744263, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.17215551435947418, "acc": 0.9355811476707458, "length": 3.9988114833831787, "mode": "train", "epoch": 27}
{"loss": 0.18701478838920593, "acc": 0.9300780892372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.17140890657901764, "acc": 0.9329919219017029, "length": 3.99950909614563, "mode": "train", "epoch": 28}
{"loss": 0.18557430803775787, "acc": 0.9404296875, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.16144229471683502, "acc": 0.9361841678619385, "length": 3.9997684955596924, "mode": "train", "epoch": 29}
{"loss": 0.1902846097946167, "acc": 0.9312500357627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.15609396994113922, "acc": 0.9398998022079468, "length": 3.999696731567383, "mode": "train", "epoch": 30}
{"loss": 0.18011727929115295, "acc": 0.9353514909744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.15456677973270416, "acc": 0.9416094422340393, "length": 3.999588966369629, "mode": "train", "epoch": 31}
{"loss": 0.1783471703529358, "acc": 0.9408202767372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.1439909040927887, "acc": 0.9473381042480469, "length": 3.999765396118164, "mode": "train", "epoch": 32}
{"loss": 0.1718561351299286, "acc": 0.9417968392372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.14042750000953674, "acc": 0.9494048953056335, "length": 3.9998443126678467, "mode": "train", "epoch": 33}
{"loss": 0.18526577949523926, "acc": 0.9353514909744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.13343985378742218, "acc": 0.9518163800239563, "length": 3.999149799346924, "mode": "train", "epoch": 34}
{"loss": 0.1550779789686203, "acc": 0.9464844465255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.12742961943149567, "acc": 0.9517664909362793, "length": 3.9998369216918945, "mode": "train", "epoch": 35}
{"loss": 0.15708233416080475, "acc": 0.9470702409744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.12850946187973022, "acc": 0.9543028473854065, "length": 3.9996416568756104, "mode": "train", "epoch": 36}
{"loss": 0.16010750830173492, "acc": 0.9474610090255737, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.14153675734996796, "acc": 0.9478142857551575, "length": 3.999913454055786, "mode": "train", "epoch": 37}
{"loss": 0.1574808657169342, "acc": 0.9429687857627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1302574723958969, "acc": 0.9520576596260071, "length": 3.9995713233947754, "mode": "train", "epoch": 38}
{"loss": 0.18224157392978668, "acc": 0.9406250715255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.13409489393234253, "acc": 0.9511794447898865, "length": 3.9999403953552246, "mode": "train", "epoch": 39}
{"loss": 0.12975195050239563, "acc": 0.9515624642372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.12483612447977066, "acc": 0.9520630240440369, "length": 3.9998953342437744, "mode": "train", "epoch": 40}
{"loss": 0.12593118846416473, "acc": 0.9556640982627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.11262626945972443, "acc": 0.9597957730293274, "length": 3.9998719692230225, "mode": "train", "epoch": 41}
{"loss": 0.15764252841472626, "acc": 0.9476562142372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.11836078763008118, "acc": 0.9591402411460876, "length": 3.996530771255493, "mode": "train", "epoch": 42}
{"loss": 0.1326238065958023, "acc": 0.9556640982627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.11760147660970688, "acc": 0.95784991979599, "length": 3.9999544620513916, "mode": "train", "epoch": 43}
{"loss": 0.15590281784534454, "acc": 0.9529296159744263, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1215910017490387, "acc": 0.9530094265937805, "length": 3.999922513961792, "mode": "train", "epoch": 44}
{"loss": 0.14119085669517517, "acc": 0.9525390267372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.11976173520088196, "acc": 0.9558411836624146, "length": 3.9998743534088135, "mode": "train", "epoch": 45}
{"loss": 0.15293064713478088, "acc": 0.9416016936302185, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.11977561563253403, "acc": 0.9553553462028503, "length": 3.999469041824341, "mode": "train", "epoch": 46}
{"loss": 0.141750305891037, "acc": 0.9478515982627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1289464235305786, "acc": 0.9530693888664246, "length": 3.9999804496765137, "mode": "train", "epoch": 47}
{"loss": 0.17011436820030212, "acc": 0.9410156011581421, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.12386281043291092, "acc": 0.9511795043945312, "length": 3.999969959259033, "mode": "train", "epoch": 48}
{"loss": 0.14364294707775116, "acc": 0.9501953125, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1184251606464386, "acc": 0.9553698301315308, "length": 3.999887704849243, "mode": "train", "epoch": 49}
{"loss": 0.16693314909934998, "acc": 0.9503906965255737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.10865873098373413, "acc": 0.9613088965415955, "length": 3.998863935470581, "mode": "train", "epoch": 50}
{"loss": 0.12634123861789703, "acc": 0.9539061784744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.09674353897571564, "acc": 0.9669659733772278, "length": 3.9993627071380615, "mode": "train", "epoch": 51}
{"loss": 0.1271570473909378, "acc": 0.9562500715255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.10637907683849335, "acc": 0.9619239568710327, "length": 3.9999818801879883, "mode": "train", "epoch": 52}
{"loss": 0.11974669992923737, "acc": 0.9554687142372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.09197491407394409, "acc": 0.9667620062828064, "length": 3.9998786449432373, "mode": "train", "epoch": 53}
{"loss": 0.11402952671051025, "acc": 0.9613281488418579, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.08912882953882217, "acc": 0.9681735038757324, "length": 3.9997215270996094, "mode": "train", "epoch": 54}
{"loss": 0.11296651512384415, "acc": 0.9623046517372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.09669766575098038, "acc": 0.9661144614219666, "length": 3.999969482421875, "mode": "train", "epoch": 55}
{"loss": 0.13286057114601135, "acc": 0.9576172232627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1025049164891243, "acc": 0.963446855545044, "length": 3.999636173248291, "mode": "train", "epoch": 56}
{"loss": 0.14505286514759064, "acc": 0.9529295563697815, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1004057228565216, "acc": 0.9640824794769287, "length": 3.9990954399108887, "mode": "train", "epoch": 57}
{"loss": 0.144901305437088, "acc": 0.9537109732627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.09390787035226822, "acc": 0.9668238759040833, "length": 3.999976396560669, "mode": "train", "epoch": 58}
{"loss": 0.15041431784629822, "acc": 0.9523438215255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.0951010063290596, "acc": 0.9626327753067017, "length": 3.9999899864196777, "mode": "train", "epoch": 59}
{"loss": 0.127376988530159, "acc": 0.9554687738418579, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09188183397054672, "acc": 0.9639305472373962, "length": 3.999976634979248, "mode": "train", "epoch": 60}
{"loss": 0.17486344277858734, "acc": 0.9546875357627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.819193422794342
