ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6952856779098511, "acc": 0.5084441900253296, "length": 3.519108295440674, "mode": "train", "epoch": 1}
{"loss": 0.6920449733734131, "acc": 0.51446533203125, "length": 1.03515625, "mode": "test", "epoch": 1}
{"loss": 0.6917470693588257, "acc": 0.5187623500823975, "length": 3.4191646575927734, "mode": "train", "epoch": 2}
{"loss": 0.6769381761550903, "acc": 0.6089264154434204, "length": 1.91015625, "mode": "test", "epoch": 2}
{"loss": 0.6840275526046753, "acc": 0.5664610862731934, "length": 3.3484506607055664, "mode": "train", "epoch": 3}
{"loss": 0.6541321873664856, "acc": 0.6481232047080994, "length": 3.0859375, "mode": "test", "epoch": 3}
{"loss": 0.6435778737068176, "acc": 0.6735756993293762, "length": 3.4048147201538086, "mode": "train", "epoch": 4}
{"loss": 0.599574863910675, "acc": 0.7048827409744263, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5803192853927612, "acc": 0.7037742733955383, "length": 3.7849903106689453, "mode": "train", "epoch": 5}
{"loss": 0.6020566821098328, "acc": 0.7113281488418579, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5581822395324707, "acc": 0.7110717296600342, "length": 3.9229390621185303, "mode": "train", "epoch": 6}
{"loss": 0.5599161982536316, "acc": 0.7177733778953552, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5324611663818359, "acc": 0.7342123985290527, "length": 3.949134588241577, "mode": "train", "epoch": 7}
{"loss": 0.5449198484420776, "acc": 0.7353515625, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5000367164611816, "acc": 0.7611361145973206, "length": 3.9599480628967285, "mode": "train", "epoch": 8}
{"loss": 0.5276976823806763, "acc": 0.7437500357627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4717186391353607, "acc": 0.7822619080543518, "length": 3.966120719909668, "mode": "train", "epoch": 9}
{"loss": 0.52869713306427, "acc": 0.771484375, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.44315558671951294, "acc": 0.8041654229164124, "length": 3.96185040473938, "mode": "train", "epoch": 10}
{"loss": 0.4879071116447449, "acc": 0.8099609017372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4132031798362732, "acc": 0.8315101861953735, "length": 3.9670603275299072, "mode": "train", "epoch": 11}
{"loss": 0.4488949775695801, "acc": 0.8107422590255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3815233111381531, "acc": 0.8428531289100647, "length": 3.9761738777160645, "mode": "train", "epoch": 12}
{"loss": 0.4302695393562317, "acc": 0.8279296159744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.35194000601768494, "acc": 0.8499588966369629, "length": 3.979254722595215, "mode": "train", "epoch": 13}
{"loss": 0.4143715500831604, "acc": 0.8296875357627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.32832661271095276, "acc": 0.8682928085327148, "length": 3.985295295715332, "mode": "train", "epoch": 14}
{"loss": 0.40930646657943726, "acc": 0.82421875, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3138958811759949, "acc": 0.8709834814071655, "length": 3.990142822265625, "mode": "train", "epoch": 15}
{"loss": 0.38915520906448364, "acc": 0.8421874642372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.296644389629364, "acc": 0.8762268424034119, "length": 3.992154598236084, "mode": "train", "epoch": 16}
{"loss": 0.38580721616744995, "acc": 0.8447265625, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2864813804626465, "acc": 0.8803311586380005, "length": 3.9927239418029785, "mode": "train", "epoch": 17}
{"loss": 0.3429405093193054, "acc": 0.8566407561302185, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2725673317909241, "acc": 0.8858151435852051, "length": 3.994199752807617, "mode": "train", "epoch": 18}
{"loss": 0.3470580577850342, "acc": 0.8544921875, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2671124339103699, "acc": 0.8882156014442444, "length": 3.9943153858184814, "mode": "train", "epoch": 19}
{"loss": 0.3305143117904663, "acc": 0.8560547232627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.252994567155838, "acc": 0.8968425393104553, "length": 3.9937987327575684, "mode": "train", "epoch": 20}
{"loss": 0.31707555055618286, "acc": 0.8705077767372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.24038206040859222, "acc": 0.9025376439094543, "length": 3.9960291385650635, "mode": "train", "epoch": 21}
{"loss": 0.30812495946884155, "acc": 0.869140625, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23439179360866547, "acc": 0.9026893377304077, "length": 3.995594024658203, "mode": "train", "epoch": 22}
{"loss": 0.2807500660419464, "acc": 0.8716797232627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.22035105526447296, "acc": 0.9084725379943848, "length": 3.9971439838409424, "mode": "train", "epoch": 23}
{"loss": 0.27258700132369995, "acc": 0.8869141340255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.21052707731723785, "acc": 0.9205020666122437, "length": 3.9973459243774414, "mode": "train", "epoch": 24}
{"loss": 0.26328790187835693, "acc": 0.8869141936302185, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1998862475156784, "acc": 0.9256631731987, "length": 3.9969239234924316, "mode": "train", "epoch": 25}
{"loss": 0.24386930465698242, "acc": 0.8988280892372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.18834416568279266, "acc": 0.9312174320220947, "length": 3.997265100479126, "mode": "train", "epoch": 26}
{"loss": 0.23468193411827087, "acc": 0.9105468392372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.18110300600528717, "acc": 0.9320662021636963, "length": 3.9972994327545166, "mode": "train", "epoch": 27}
{"loss": 0.22898897528648376, "acc": 0.9181641340255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.17875291407108307, "acc": 0.9358904957771301, "length": 3.997899293899536, "mode": "train", "epoch": 28}
{"loss": 0.23824524879455566, "acc": 0.9146484136581421, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.17189191281795502, "acc": 0.935648500919342, "length": 3.9975171089172363, "mode": "train", "epoch": 29}
{"loss": 0.2187352478504181, "acc": 0.9181641340255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.16128751635551453, "acc": 0.9401625990867615, "length": 3.9980714321136475, "mode": "train", "epoch": 30}
{"loss": 0.2123364806175232, "acc": 0.9226561188697815, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.15716294944286346, "acc": 0.9448723793029785, "length": 3.998640298843384, "mode": "train", "epoch": 31}
{"loss": 0.2151210755109787, "acc": 0.9203124642372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.1593206226825714, "acc": 0.9427117705345154, "length": 3.99828839302063, "mode": "train", "epoch": 32}
{"loss": 0.1962253749370575, "acc": 0.9300780892372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.15235702693462372, "acc": 0.9474325180053711, "length": 3.998251438140869, "mode": "train", "epoch": 33}
{"loss": 0.1997857689857483, "acc": 0.9275389909744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.15092162787914276, "acc": 0.9476776719093323, "length": 3.9990792274475098, "mode": "train", "epoch": 34}
{"loss": 0.18500152230262756, "acc": 0.9357422590255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1504439264535904, "acc": 0.9468662738800049, "length": 3.9985852241516113, "mode": "train", "epoch": 35}
{"loss": 0.1886059045791626, "acc": 0.9361329078674316, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1442197561264038, "acc": 0.9479234218597412, "length": 3.9994025230407715, "mode": "train", "epoch": 36}
{"loss": 0.1867550015449524, "acc": 0.9392576813697815, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1413012146949768, "acc": 0.950486958026886, "length": 3.9993345737457275, "mode": "train", "epoch": 37}
{"loss": 0.1776638627052307, "acc": 0.9361328482627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1330898553133011, "acc": 0.9551194906234741, "length": 3.9987449645996094, "mode": "train", "epoch": 38}
{"loss": 0.17167936265468597, "acc": 0.9386719465255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.13662484288215637, "acc": 0.9527616500854492, "length": 3.9978153705596924, "mode": "train", "epoch": 39}
{"loss": 0.17083662748336792, "acc": 0.94140625, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.13254152238368988, "acc": 0.9544280767440796, "length": 3.99957537651062, "mode": "train", "epoch": 40}
{"loss": 0.18513759970664978, "acc": 0.9341797828674316, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1300136297941208, "acc": 0.9556673169136047, "length": 3.9990320205688477, "mode": "train", "epoch": 41}
{"loss": 0.1836775243282318, "acc": 0.9371094107627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.12986202538013458, "acc": 0.9557369351387024, "length": 3.9994359016418457, "mode": "train", "epoch": 42}
{"loss": 0.19045861065387726, "acc": 0.9304686784744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1303618848323822, "acc": 0.9557334780693054, "length": 3.9994492530822754, "mode": "train", "epoch": 43}
{"loss": 0.16853010654449463, "acc": 0.9380859732627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.12925513088703156, "acc": 0.9562023878097534, "length": 3.999727725982666, "mode": "train", "epoch": 44}
{"loss": 0.1747840791940689, "acc": 0.9378905892372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1188683956861496, "acc": 0.9602742791175842, "length": 3.9992690086364746, "mode": "train", "epoch": 45}
{"loss": 0.15866242349147797, "acc": 0.9488281607627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.12076534330844879, "acc": 0.9577346444129944, "length": 3.999647378921509, "mode": "train", "epoch": 46}
{"loss": 0.17104172706604004, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.12098269909620285, "acc": 0.9587135910987854, "length": 3.999690055847168, "mode": "train", "epoch": 47}
{"loss": 0.14898012578487396, "acc": 0.9468750357627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.11946737766265869, "acc": 0.9577453136444092, "length": 3.9997808933258057, "mode": "train", "epoch": 48}
{"loss": 0.17705288529396057, "acc": 0.9373045563697815, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.11614179611206055, "acc": 0.960276186466217, "length": 3.9976887702941895, "mode": "train", "epoch": 49}
{"loss": 0.15722841024398804, "acc": 0.9408202767372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.11064740270376205, "acc": 0.9616782665252686, "length": 3.999744415283203, "mode": "train", "epoch": 50}
{"loss": 0.1565232276916504, "acc": 0.9394530653953552, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.11795914173126221, "acc": 0.959168553352356, "length": 3.99971604347229, "mode": "train", "epoch": 51}
{"loss": 0.15960916876792908, "acc": 0.9333983659744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.11272792518138885, "acc": 0.960997462272644, "length": 3.9998228549957275, "mode": "train", "epoch": 52}
{"loss": 0.15978291630744934, "acc": 0.9396485090255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.11105885356664658, "acc": 0.9605882167816162, "length": 3.9996612071990967, "mode": "train", "epoch": 53}
{"loss": 0.15144489705562592, "acc": 0.9361328482627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.11012063175439835, "acc": 0.9611101746559143, "length": 3.9998245239257812, "mode": "train", "epoch": 54}
{"loss": 0.1825403869152069, "acc": 0.9324218034744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11078543961048126, "acc": 0.9574061632156372, "length": 3.9998366832733154, "mode": "train", "epoch": 55}
{"loss": 0.15470364689826965, "acc": 0.9441405534744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.10586868226528168, "acc": 0.9660711884498596, "length": 3.9998533725738525, "mode": "train", "epoch": 56}
{"loss": 0.1426132172346115, "acc": 0.9486327767372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.09996670484542847, "acc": 0.9673004150390625, "length": 3.9993340969085693, "mode": "train", "epoch": 57}
{"loss": 0.1514921337366104, "acc": 0.9474610090255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10791181027889252, "acc": 0.9647591710090637, "length": 3.9998092651367188, "mode": "train", "epoch": 58}
{"loss": 0.14097478985786438, "acc": 0.9447264671325684, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09980399161577225, "acc": 0.9669243097305298, "length": 3.9986162185668945, "mode": "train", "epoch": 59}
{"loss": 0.1503058224916458, "acc": 0.9439453482627869, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.10120809078216553, "acc": 0.9672686457633972, "length": 3.9997074604034424, "mode": "train", "epoch": 60}
{"loss": 0.15070907771587372, "acc": 0.9451171159744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8062963485717773
