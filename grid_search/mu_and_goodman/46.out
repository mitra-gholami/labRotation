ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6967406272888184, "acc": 0.5231950283050537, "length": 3.340010404586792, "mode": "train", "epoch": 1}
{"loss": 0.693020224571228, "acc": 0.5074219107627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6841936111450195, "acc": 0.5598351955413818, "length": 2.5114471912384033, "mode": "train", "epoch": 2}
{"loss": 0.6710538864135742, "acc": 0.6055266857147217, "length": 2.05078125, "mode": "test", "epoch": 2}
{"loss": 0.6425557732582092, "acc": 0.6745116710662842, "length": 2.8923428058624268, "mode": "train", "epoch": 3}
{"loss": 0.5735887885093689, "acc": 0.757342517375946, "length": 3.296875, "mode": "test", "epoch": 3}
{"loss": 0.5180692672729492, "acc": 0.785942554473877, "length": 3.3072893619537354, "mode": "train", "epoch": 4}
{"loss": 0.45419108867645264, "acc": 0.8033508658409119, "length": 3.69140625, "mode": "test", "epoch": 4}
{"loss": 0.4421710669994354, "acc": 0.8056957721710205, "length": 3.4769468307495117, "mode": "train", "epoch": 5}
{"loss": 0.41763201355934143, "acc": 0.829486072063446, "length": 3.69921875, "mode": "test", "epoch": 5}
{"loss": 0.41243717074394226, "acc": 0.8286308646202087, "length": 3.4968161582946777, "mode": "train", "epoch": 6}
{"loss": 0.40260422229766846, "acc": 0.8280884623527527, "length": 3.69140625, "mode": "test", "epoch": 6}
{"loss": 0.3897734582424164, "acc": 0.8395715355873108, "length": 3.5375311374664307, "mode": "train", "epoch": 7}
{"loss": 0.3674215078353882, "acc": 0.8376404047012329, "length": 3.68359375, "mode": "test", "epoch": 7}
{"loss": 0.37741297483444214, "acc": 0.8402644991874695, "length": 3.5733790397644043, "mode": "train", "epoch": 8}
{"loss": 0.3556763231754303, "acc": 0.8461822867393494, "length": 3.60546875, "mode": "test", "epoch": 8}
{"loss": 0.36653661727905273, "acc": 0.8453048467636108, "length": 3.580470323562622, "mode": "train", "epoch": 9}
{"loss": 0.35290634632110596, "acc": 0.8443968892097473, "length": 3.609375, "mode": "test", "epoch": 9}
{"loss": 0.359726220369339, "acc": 0.8488514423370361, "length": 3.5946249961853027, "mode": "train", "epoch": 10}
{"loss": 0.3567236065864563, "acc": 0.8414093255996704, "length": 3.609375, "mode": "test", "epoch": 10}
{"loss": 0.3519602119922638, "acc": 0.8503417372703552, "length": 3.6389963626861572, "mode": "train", "epoch": 11}
{"loss": 0.3415687084197998, "acc": 0.848968505859375, "length": 3.625, "mode": "test", "epoch": 11}
{"loss": 0.3441581428050995, "acc": 0.8528057336807251, "length": 3.6990292072296143, "mode": "train", "epoch": 12}
{"loss": 0.34107834100723267, "acc": 0.8565490245819092, "length": 3.80859375, "mode": "test", "epoch": 12}
{"loss": 0.3465292453765869, "acc": 0.8548948764801025, "length": 3.8483526706695557, "mode": "train", "epoch": 13}
{"loss": 0.339426726102829, "acc": 0.8517578840255737, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.34213343262672424, "acc": 0.8545211553573608, "length": 3.9141294956207275, "mode": "train", "epoch": 14}
{"loss": 0.3309544026851654, "acc": 0.8566406965255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.334979772567749, "acc": 0.8577154874801636, "length": 3.8868885040283203, "mode": "train", "epoch": 15}
{"loss": 0.3297450542449951, "acc": 0.8625854253768921, "length": 3.984375, "mode": "test", "epoch": 15}
{"loss": 0.33755865693092346, "acc": 0.8580089211463928, "length": 3.8700428009033203, "mode": "train", "epoch": 16}
{"loss": 0.3306543827056885, "acc": 0.8479430079460144, "length": 3.84375, "mode": "test", "epoch": 16}
{"loss": 0.3368911147117615, "acc": 0.8566291332244873, "length": 3.86441969871521, "mode": "train", "epoch": 17}
{"loss": 0.33689677715301514, "acc": 0.8493255376815796, "length": 3.9140625, "mode": "test", "epoch": 17}
{"loss": 0.3363577425479889, "acc": 0.8571122884750366, "length": 3.872929573059082, "mode": "train", "epoch": 18}
{"loss": 0.3276734948158264, "acc": 0.8626862168312073, "length": 3.90625, "mode": "test", "epoch": 18}
{"loss": 0.33776432275772095, "acc": 0.8560915589332581, "length": 3.848841428756714, "mode": "train", "epoch": 19}
{"loss": 0.32833659648895264, "acc": 0.8613556027412415, "length": 3.8125, "mode": "test", "epoch": 19}
{"loss": 0.3250123858451843, "acc": 0.8589223027229309, "length": 3.855619430541992, "mode": "train", "epoch": 20}
{"loss": 0.3239844739437103, "acc": 0.8620361685752869, "length": 3.80859375, "mode": "test", "epoch": 20}
{"loss": 0.32348915934562683, "acc": 0.8583641052246094, "length": 3.838306188583374, "mode": "train", "epoch": 21}
{"loss": 0.34172603487968445, "acc": 0.8585631847381592, "length": 3.8359375, "mode": "test", "epoch": 21}
{"loss": 0.32971248030662537, "acc": 0.8625286221504211, "length": 3.879098892211914, "mode": "train", "epoch": 22}
{"loss": 0.3483112156391144, "acc": 0.8565337657928467, "length": 3.82421875, "mode": "test", "epoch": 22}
{"loss": 0.31924542784690857, "acc": 0.8596169948577881, "length": 3.8584136962890625, "mode": "train", "epoch": 23}
{"loss": 0.33545929193496704, "acc": 0.8573943376541138, "length": 3.828125, "mode": "test", "epoch": 23}
{"loss": 0.3189619183540344, "acc": 0.8618227243423462, "length": 3.8504533767700195, "mode": "train", "epoch": 24}
{"loss": 0.34310802817344666, "acc": 0.8441650867462158, "length": 3.8046875, "mode": "test", "epoch": 24}
{"loss": 0.3215372562408447, "acc": 0.8604843616485596, "length": 3.8541858196258545, "mode": "train", "epoch": 25}
{"loss": 0.34670737385749817, "acc": 0.8519682884216309, "length": 3.859375, "mode": "test", "epoch": 25}
{"loss": 0.3136533200740814, "acc": 0.855334460735321, "length": 3.8622183799743652, "mode": "train", "epoch": 26}
{"loss": 0.34423166513442993, "acc": 0.8542603254318237, "length": 3.80859375, "mode": "test", "epoch": 26}
{"loss": 0.3145393431186676, "acc": 0.8584840297698975, "length": 3.862950086593628, "mode": "train", "epoch": 27}
{"loss": 0.3484104871749878, "acc": 0.8494415283203125, "length": 3.8125, "mode": "test", "epoch": 27}
{"loss": 0.31774160265922546, "acc": 0.8598072528839111, "length": 3.8728549480438232, "mode": "train", "epoch": 28}
{"loss": 0.3405300974845886, "acc": 0.8554473519325256, "length": 3.8515625, "mode": "test", "epoch": 28}
{"loss": 0.310883104801178, "acc": 0.8639647960662842, "length": 3.870460033416748, "mode": "train", "epoch": 29}
{"loss": 0.33472496271133423, "acc": 0.85516357421875, "length": 3.8203125, "mode": "test", "epoch": 29}
{"loss": 0.3086107075214386, "acc": 0.8650667071342468, "length": 3.8720099925994873, "mode": "train", "epoch": 30}
{"loss": 0.32969215512275696, "acc": 0.8552246689796448, "length": 3.8359375, "mode": "test", "epoch": 30}
{"loss": 0.2980184555053711, "acc": 0.868780791759491, "length": 3.864126205444336, "mode": "train", "epoch": 31}
{"loss": 0.32715457677841187, "acc": 0.8534972667694092, "length": 3.8125, "mode": "test", "epoch": 31}
{"loss": 0.29582929611206055, "acc": 0.8721702694892883, "length": 3.867875337600708, "mode": "train", "epoch": 32}
{"loss": 0.31654849648475647, "acc": 0.8683562874794006, "length": 3.81640625, "mode": "test", "epoch": 32}
{"loss": 0.289766788482666, "acc": 0.8712081909179688, "length": 3.862330436706543, "mode": "train", "epoch": 33}
{"loss": 0.31478527188301086, "acc": 0.8644134998321533, "length": 3.81640625, "mode": "test", "epoch": 33}
{"loss": 0.2924230694770813, "acc": 0.8756605982780457, "length": 3.8514041900634766, "mode": "train", "epoch": 34}
{"loss": 0.3180251717567444, "acc": 0.8659058213233948, "length": 3.81640625, "mode": "test", "epoch": 34}
{"loss": 0.2901689410209656, "acc": 0.8772709965705872, "length": 3.877769708633423, "mode": "train", "epoch": 35}
{"loss": 0.3103998899459839, "acc": 0.8705901503562927, "length": 3.8515625, "mode": "test", "epoch": 35}
{"loss": 0.28406861424446106, "acc": 0.878140926361084, "length": 3.848062753677368, "mode": "train", "epoch": 36}
{"loss": 0.31507909297943115, "acc": 0.8653808832168579, "length": 3.8125, "mode": "test", "epoch": 36}
{"loss": 0.28006336092948914, "acc": 0.8781743049621582, "length": 3.8498618602752686, "mode": "train", "epoch": 37}
{"loss": 0.29904627799987793, "acc": 0.8653839826583862, "length": 3.828125, "mode": "test", "epoch": 37}
{"loss": 0.2792171537876129, "acc": 0.8789816498756409, "length": 3.867607831954956, "mode": "train", "epoch": 38}
{"loss": 0.3043925166130066, "acc": 0.872357189655304, "length": 3.8125, "mode": "test", "epoch": 38}
{"loss": 0.2855391800403595, "acc": 0.879472017288208, "length": 3.850590229034424, "mode": "train", "epoch": 39}
{"loss": 0.2913995385169983, "acc": 0.8763183951377869, "length": 3.796875, "mode": "test", "epoch": 39}
{"loss": 0.2755875587463379, "acc": 0.8833443522453308, "length": 3.8688559532165527, "mode": "train", "epoch": 40}
{"loss": 0.3038123846054077, "acc": 0.8771300911903381, "length": 3.8671875, "mode": "test", "epoch": 40}
{"loss": 0.2724955379962921, "acc": 0.8821763396263123, "length": 3.8851962089538574, "mode": "train", "epoch": 41}
{"loss": 0.3005049228668213, "acc": 0.8747802972793579, "length": 3.8515625, "mode": "test", "epoch": 41}
{"loss": 0.2684950530529022, "acc": 0.8826793432235718, "length": 3.866504192352295, "mode": "train", "epoch": 42}
{"loss": 0.3082870841026306, "acc": 0.8689881563186646, "length": 3.84765625, "mode": "test", "epoch": 42}
{"loss": 0.2760970890522003, "acc": 0.8816972970962524, "length": 3.854729175567627, "mode": "train", "epoch": 43}
{"loss": 0.28604060411453247, "acc": 0.8756318688392639, "length": 3.83203125, "mode": "test", "epoch": 43}
{"loss": 0.2666233479976654, "acc": 0.8851242661476135, "length": 3.864698886871338, "mode": "train", "epoch": 44}
{"loss": 0.2888822555541992, "acc": 0.8748840093612671, "length": 3.8359375, "mode": "test", "epoch": 44}
{"loss": 0.26803258061408997, "acc": 0.8852311968803406, "length": 3.8691132068634033, "mode": "train", "epoch": 45}
{"loss": 0.2845301032066345, "acc": 0.8828522562980652, "length": 3.87890625, "mode": "test", "epoch": 45}
{"loss": 0.267044335603714, "acc": 0.8868383169174194, "length": 3.8845643997192383, "mode": "train", "epoch": 46}
{"loss": 0.2807161808013916, "acc": 0.8771637678146362, "length": 3.88671875, "mode": "test", "epoch": 46}
{"loss": 0.2611217498779297, "acc": 0.8877437114715576, "length": 3.8758127689361572, "mode": "train", "epoch": 47}
{"loss": 0.27760472893714905, "acc": 0.8840728402137756, "length": 3.8828125, "mode": "test", "epoch": 47}
{"loss": 0.26778021454811096, "acc": 0.8901250958442688, "length": 3.8885984420776367, "mode": "train", "epoch": 48}
{"loss": 0.28581684827804565, "acc": 0.8832213878631592, "length": 3.9140625, "mode": "test", "epoch": 48}
{"loss": 0.26191040873527527, "acc": 0.8902605175971985, "length": 3.886491298675537, "mode": "train", "epoch": 49}
{"loss": 0.28706419467926025, "acc": 0.8835204839706421, "length": 3.87890625, "mode": "test", "epoch": 49}
{"loss": 0.2577579617500305, "acc": 0.8909850716590881, "length": 3.9058194160461426, "mode": "train", "epoch": 50}
{"loss": 0.27180689573287964, "acc": 0.8887420296669006, "length": 3.90625, "mode": "test", "epoch": 50}
{"loss": 0.2573813498020172, "acc": 0.891473114490509, "length": 3.880723237991333, "mode": "train", "epoch": 51}
{"loss": 0.27290424704551697, "acc": 0.8891143798828125, "length": 3.890625, "mode": "test", "epoch": 51}
{"loss": 0.259616494178772, "acc": 0.8936335444450378, "length": 3.9107871055603027, "mode": "train", "epoch": 52}
{"loss": 0.2736777067184448, "acc": 0.8854186534881592, "length": 3.9140625, "mode": "test", "epoch": 52}
{"loss": 0.2537933886051178, "acc": 0.8952109217643738, "length": 3.897033929824829, "mode": "train", "epoch": 53}
{"loss": 0.2705609202384949, "acc": 0.8891692757606506, "length": 3.90234375, "mode": "test", "epoch": 53}
{"loss": 0.2494611293077469, "acc": 0.8950852751731873, "length": 3.9056293964385986, "mode": "train", "epoch": 54}
{"loss": 0.27447113394737244, "acc": 0.8902984261512756, "length": 3.9140625, "mode": "test", "epoch": 54}
{"loss": 0.24900077283382416, "acc": 0.894580066204071, "length": 3.909827709197998, "mode": "train", "epoch": 55}
{"loss": 0.31732624769210815, "acc": 0.880474865436554, "length": 3.89453125, "mode": "test", "epoch": 55}
{"loss": 0.2649662494659424, "acc": 0.8880818486213684, "length": 3.906466007232666, "mode": "train", "epoch": 56}
{"loss": 0.29317277669906616, "acc": 0.8814147710800171, "length": 3.9453125, "mode": "test", "epoch": 56}
{"loss": 0.2532329261302948, "acc": 0.8944599032402039, "length": 3.8995559215545654, "mode": "train", "epoch": 57}
{"loss": 0.2937924265861511, "acc": 0.8815460205078125, "length": 3.8671875, "mode": "test", "epoch": 57}
{"loss": 0.2548351585865021, "acc": 0.8949426412582397, "length": 3.909421443939209, "mode": "train", "epoch": 58}
{"loss": 0.2692009210586548, "acc": 0.8857513070106506, "length": 3.91796875, "mode": "test", "epoch": 58}
{"loss": 0.2475735992193222, "acc": 0.8987423777580261, "length": 3.903961181640625, "mode": "train", "epoch": 59}
{"loss": 0.2605534791946411, "acc": 0.8941558003425598, "length": 3.890625, "mode": "test", "epoch": 59}
{"loss": 0.24195240437984467, "acc": 0.8980714082717896, "length": 3.894528865814209, "mode": "train", "epoch": 60}
{"loss": 0.2566413879394531, "acc": 0.8966766595840454, "length": 3.921875, "mode": "test", "epoch": 60}
test accuracy: 0.8170567750930786
