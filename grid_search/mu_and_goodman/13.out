ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6921382546424866, "acc": 0.5363453030586243, "length": 3.2884461879730225, "mode": "train", "epoch": 1}
{"loss": 0.678715705871582, "acc": 0.5909606218338013, "length": 1.453125, "mode": "test", "epoch": 1}
{"loss": 0.6144998073577881, "acc": 0.6806614398956299, "length": 2.895023822784424, "mode": "train", "epoch": 2}
{"loss": 0.5132807493209839, "acc": 0.761187732219696, "length": 3.2265625, "mode": "test", "epoch": 2}
{"loss": 0.4590817093849182, "acc": 0.785426914691925, "length": 3.742835283279419, "mode": "train", "epoch": 3}
{"loss": 0.4513035714626312, "acc": 0.7943359017372131, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4103108048439026, "acc": 0.8179880976676941, "length": 3.9732825756073, "mode": "train", "epoch": 4}
{"loss": 0.438118040561676, "acc": 0.8203125, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.3841850757598877, "acc": 0.8318033814430237, "length": 3.9852185249328613, "mode": "train", "epoch": 5}
{"loss": 0.4090256094932556, "acc": 0.8289061784744263, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.36379024386405945, "acc": 0.8414992094039917, "length": 3.9890553951263428, "mode": "train", "epoch": 6}
{"loss": 0.3978465497493744, "acc": 0.8275390863418579, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.34852999448776245, "acc": 0.851427435874939, "length": 3.992544174194336, "mode": "train", "epoch": 7}
{"loss": 0.382930725812912, "acc": 0.8333984017372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.338765949010849, "acc": 0.8561509847640991, "length": 3.9941117763519287, "mode": "train", "epoch": 8}
{"loss": 0.3778720796108246, "acc": 0.84375, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.32903918623924255, "acc": 0.86376953125, "length": 3.995147228240967, "mode": "train", "epoch": 9}
{"loss": 0.3733765482902527, "acc": 0.8474608063697815, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3152555823326111, "acc": 0.8662184476852417, "length": 3.9938747882843018, "mode": "train", "epoch": 10}
{"loss": 0.34136998653411865, "acc": 0.8572264909744263, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3005176782608032, "acc": 0.878117561340332, "length": 3.991050958633423, "mode": "train", "epoch": 11}
{"loss": 0.33279022574424744, "acc": 0.8701171875, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2831229567527771, "acc": 0.8838533163070679, "length": 3.990732431411743, "mode": "train", "epoch": 12}
{"loss": 0.3146316707134247, "acc": 0.8755859732627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2833505868911743, "acc": 0.8860430121421814, "length": 3.993497610092163, "mode": "train", "epoch": 13}
{"loss": 0.29796648025512695, "acc": 0.8882813453674316, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2677605152130127, "acc": 0.8908070921897888, "length": 3.995431900024414, "mode": "train", "epoch": 14}
{"loss": 0.30232399702072144, "acc": 0.8863281607627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.26338571310043335, "acc": 0.8926905989646912, "length": 3.9967575073242188, "mode": "train", "epoch": 15}
{"loss": 0.2920536398887634, "acc": 0.8910155892372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2619830369949341, "acc": 0.894058346748352, "length": 3.9980969429016113, "mode": "train", "epoch": 16}
{"loss": 0.2872888445854187, "acc": 0.8892578482627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2518271505832672, "acc": 0.8999084830284119, "length": 3.998392105102539, "mode": "train", "epoch": 17}
{"loss": 0.27510613203048706, "acc": 0.8947266340255737, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.25843939185142517, "acc": 0.8988082408905029, "length": 3.9985780715942383, "mode": "train", "epoch": 18}
{"loss": 0.2723570168018341, "acc": 0.8923827409744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.24907150864601135, "acc": 0.9021331071853638, "length": 3.9982011318206787, "mode": "train", "epoch": 19}
{"loss": 0.26732099056243896, "acc": 0.8941406607627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.23935037851333618, "acc": 0.9020371437072754, "length": 3.999152421951294, "mode": "train", "epoch": 20}
{"loss": 0.2728206515312195, "acc": 0.8974609971046448, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2361719012260437, "acc": 0.9069351553916931, "length": 3.99831223487854, "mode": "train", "epoch": 21}
{"loss": 0.2702045738697052, "acc": 0.8978515267372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23338082432746887, "acc": 0.9074207544326782, "length": 3.999234914779663, "mode": "train", "epoch": 22}
{"loss": 0.264301598072052, "acc": 0.8982420563697815, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.22854241728782654, "acc": 0.9080034494400024, "length": 3.9993207454681396, "mode": "train", "epoch": 23}
{"loss": 0.2728946805000305, "acc": 0.8921875357627869, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.22681370377540588, "acc": 0.9070780277252197, "length": 3.999751567840576, "mode": "train", "epoch": 24}
{"loss": 0.2643677890300751, "acc": 0.9017577767372131, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2250492125749588, "acc": 0.9173157811164856, "length": 3.999582529067993, "mode": "train", "epoch": 25}
{"loss": 0.25828200578689575, "acc": 0.9080077409744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.22726351022720337, "acc": 0.9123885631561279, "length": 3.9966211318969727, "mode": "train", "epoch": 26}
{"loss": 0.24884910881519318, "acc": 0.8994140028953552, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2231065034866333, "acc": 0.9125803112983704, "length": 3.999744415283203, "mode": "train", "epoch": 27}
{"loss": 0.2480572611093521, "acc": 0.9076172113418579, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.21697284281253815, "acc": 0.9182049036026001, "length": 3.9998295307159424, "mode": "train", "epoch": 28}
{"loss": 0.23791590332984924, "acc": 0.9142578840255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.20520374178886414, "acc": 0.9220085740089417, "length": 3.9996652603149414, "mode": "train", "epoch": 29}
{"loss": 0.23854507505893707, "acc": 0.9132813215255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.21184934675693512, "acc": 0.9204750657081604, "length": 3.9993951320648193, "mode": "train", "epoch": 30}
{"loss": 0.22017107903957367, "acc": 0.9189453125, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.206493079662323, "acc": 0.9236905574798584, "length": 3.999211549758911, "mode": "train", "epoch": 31}
{"loss": 0.23611177504062653, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.1941969245672226, "acc": 0.9288579225540161, "length": 3.9997670650482178, "mode": "train", "epoch": 32}
{"loss": 0.21091222763061523, "acc": 0.9248047471046448, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.19276802241802216, "acc": 0.9294373989105225, "length": 3.999675750732422, "mode": "train", "epoch": 33}
{"loss": 0.26618140935897827, "acc": 0.8904296159744263, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2046358287334442, "acc": 0.9199053049087524, "length": 3.999966859817505, "mode": "train", "epoch": 34}
{"loss": 0.23090599477291107, "acc": 0.9119139909744263, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.20782960951328278, "acc": 0.919199526309967, "length": 3.999858856201172, "mode": "train", "epoch": 35}
{"loss": 0.24824650585651398, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2134852111339569, "acc": 0.9184995293617249, "length": 3.9999284744262695, "mode": "train", "epoch": 36}
{"loss": 0.26074114441871643, "acc": 0.9070311188697815, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2086804211139679, "acc": 0.9186171889305115, "length": 3.9999358654022217, "mode": "train", "epoch": 37}
{"loss": 0.2386874109506607, "acc": 0.9175781607627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.19651378691196442, "acc": 0.9228873252868652, "length": 3.9992992877960205, "mode": "train", "epoch": 38}
{"loss": 0.23085130751132965, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20287388563156128, "acc": 0.9221856594085693, "length": 3.9998552799224854, "mode": "train", "epoch": 39}
{"loss": 0.23712649941444397, "acc": 0.9232421517372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.250995934009552, "acc": 0.9074344635009766, "length": 3.9999442100524902, "mode": "train", "epoch": 40}
{"loss": 0.2515121400356293, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2290119230747223, "acc": 0.9156856536865234, "length": 3.999847650527954, "mode": "train", "epoch": 41}
{"loss": 0.22393587231636047, "acc": 0.9150391221046448, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.2052031308412552, "acc": 0.9224073886871338, "length": 3.9995839595794678, "mode": "train", "epoch": 42}
{"loss": 0.23097501695156097, "acc": 0.9146485328674316, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.18793600797653198, "acc": 0.927309513092041, "length": 3.999175548553467, "mode": "train", "epoch": 43}
{"loss": 0.20736917853355408, "acc": 0.9224609732627869, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.18268682062625885, "acc": 0.9290570020675659, "length": 3.998791217803955, "mode": "train", "epoch": 44}
{"loss": 0.2127588391304016, "acc": 0.9203124642372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1736583560705185, "acc": 0.933195173740387, "length": 3.9998903274536133, "mode": "train", "epoch": 45}
{"loss": 0.20858649909496307, "acc": 0.9222655892372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.18824660778045654, "acc": 0.9289762377738953, "length": 3.999831438064575, "mode": "train", "epoch": 46}
{"loss": 0.22255569696426392, "acc": 0.9134765267372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.19306252896785736, "acc": 0.9223636984825134, "length": 3.9999656677246094, "mode": "train", "epoch": 47}
{"loss": 0.21390070021152496, "acc": 0.9197264313697815, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.17216657102108002, "acc": 0.9334341287612915, "length": 3.9985511302948, "mode": "train", "epoch": 48}
{"loss": 0.21331360936164856, "acc": 0.9193359017372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.16978922486305237, "acc": 0.9326674938201904, "length": 3.9999144077301025, "mode": "train", "epoch": 49}
{"loss": 0.2181091010570526, "acc": 0.9261718392372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.16284207999706268, "acc": 0.9378798604011536, "length": 3.999972343444824, "mode": "train", "epoch": 50}
{"loss": 0.19122706353664398, "acc": 0.9318360090255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.15574398636817932, "acc": 0.9405864477157593, "length": 3.9980645179748535, "mode": "train", "epoch": 51}
{"loss": 0.18626709282398224, "acc": 0.9386720061302185, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.14926636219024658, "acc": 0.9456648230552673, "length": 3.9999027252197266, "mode": "train", "epoch": 52}
{"loss": 0.1965024769306183, "acc": 0.9359374642372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.152279794216156, "acc": 0.945197582244873, "length": 3.9999585151672363, "mode": "train", "epoch": 53}
{"loss": 0.20492935180664062, "acc": 0.9296875, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15027950704097748, "acc": 0.9446120858192444, "length": 3.9999585151672363, "mode": "train", "epoch": 54}
{"loss": 0.1972920000553131, "acc": 0.9320311546325684, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1442088782787323, "acc": 0.9501306414604187, "length": 3.9989616870880127, "mode": "train", "epoch": 55}
{"loss": 0.1903274953365326, "acc": 0.9289063215255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.14125768840312958, "acc": 0.9472364783287048, "length": 3.999652862548828, "mode": "train", "epoch": 56}
{"loss": 0.19756503403186798, "acc": 0.9330077767372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1690276861190796, "acc": 0.9323911070823669, "length": 3.9990317821502686, "mode": "train", "epoch": 57}
{"loss": 0.27327051758766174, "acc": 0.9087890982627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.19865106046199799, "acc": 0.9233390092849731, "length": 3.9987027645111084, "mode": "train", "epoch": 58}
{"loss": 0.2429138720035553, "acc": 0.9142578840255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1803435981273651, "acc": 0.931850016117096, "length": 3.9999701976776123, "mode": "train", "epoch": 59}
{"loss": 0.2229183316230774, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1680624634027481, "acc": 0.9342455267906189, "length": 3.999757766723633, "mode": "train", "epoch": 60}
{"loss": 0.22943401336669922, "acc": 0.9037109017372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7373332977294922
