ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6979283094406128, "acc": 0.49910587072372437, "length": 3.5512406826019287, "mode": "train", "epoch": 1}
{"loss": 0.6845507621765137, "acc": 0.6028227806091309, "length": 2.16015625, "mode": "test", "epoch": 1}
{"loss": 0.6927725076675415, "acc": 0.5141831040382385, "length": 3.5304160118103027, "mode": "train", "epoch": 2}
{"loss": 0.6819099187850952, "acc": 0.6068374514579773, "length": 1.484375, "mode": "test", "epoch": 2}
{"loss": 0.6912107467651367, "acc": 0.5295569896697998, "length": 3.495896100997925, "mode": "train", "epoch": 3}
{"loss": 0.6791917085647583, "acc": 0.6132979989051819, "length": 1.63671875, "mode": "test", "epoch": 3}
{"loss": 0.6904259324073792, "acc": 0.528438925743103, "length": 3.4736409187316895, "mode": "train", "epoch": 4}
{"loss": 0.6744938492774963, "acc": 0.6392624378204346, "length": 2.07421875, "mode": "test", "epoch": 4}
{"loss": 0.6864796280860901, "acc": 0.5635578036308289, "length": 3.4496960639953613, "mode": "train", "epoch": 5}
{"loss": 0.6650627851486206, "acc": 0.6827606558799744, "length": 2.86328125, "mode": "test", "epoch": 5}
{"loss": 0.6793370842933655, "acc": 0.6111727356910706, "length": 3.399135112762451, "mode": "train", "epoch": 6}
{"loss": 0.6514180898666382, "acc": 0.6907119750976562, "length": 3.34375, "mode": "test", "epoch": 6}
{"loss": 0.6626033782958984, "acc": 0.6656989455223083, "length": 3.412513494491577, "mode": "train", "epoch": 7}
{"loss": 0.6259336471557617, "acc": 0.7343810796737671, "length": 3.8828125, "mode": "test", "epoch": 7}
{"loss": 0.6342167258262634, "acc": 0.7125200629234314, "length": 3.603914499282837, "mode": "train", "epoch": 8}
{"loss": 0.5960919857025146, "acc": 0.7337890267372131, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5906974673271179, "acc": 0.7460244297981262, "length": 3.7779219150543213, "mode": "train", "epoch": 9}
{"loss": 0.5571001768112183, "acc": 0.7542968392372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5382987260818481, "acc": 0.768919825553894, "length": 3.900996208190918, "mode": "train", "epoch": 10}
{"loss": 0.5286943912506104, "acc": 0.7521485090255737, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4922235310077667, "acc": 0.7656846046447754, "length": 3.9433095455169678, "mode": "train", "epoch": 11}
{"loss": 0.5082230567932129, "acc": 0.7667969465255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4597616195678711, "acc": 0.783348023891449, "length": 3.964177370071411, "mode": "train", "epoch": 12}
{"loss": 0.5079076290130615, "acc": 0.7857422232627869, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.43822458386421204, "acc": 0.8001714944839478, "length": 3.9712576866149902, "mode": "train", "epoch": 13}
{"loss": 0.5014630556106567, "acc": 0.775390625, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4221458435058594, "acc": 0.8051280975341797, "length": 3.9788856506347656, "mode": "train", "epoch": 14}
{"loss": 0.46688711643218994, "acc": 0.8074217438697815, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.40971484780311584, "acc": 0.8168758153915405, "length": 3.9877851009368896, "mode": "train", "epoch": 15}
{"loss": 0.46626096963882446, "acc": 0.8070312142372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.40400931239128113, "acc": 0.8221907615661621, "length": 3.9900951385498047, "mode": "train", "epoch": 16}
{"loss": 0.45822930335998535, "acc": 0.8111329078674316, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3947067856788635, "acc": 0.8270601630210876, "length": 3.983456611633301, "mode": "train", "epoch": 17}
{"loss": 0.4491133689880371, "acc": 0.8181639909744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.390022337436676, "acc": 0.8191367387771606, "length": 3.9884541034698486, "mode": "train", "epoch": 18}
{"loss": 0.44702351093292236, "acc": 0.8134765028953552, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3786456882953644, "acc": 0.8305456638336182, "length": 3.989565134048462, "mode": "train", "epoch": 19}
{"loss": 0.42369064688682556, "acc": 0.8191405534744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.372789591550827, "acc": 0.8327968716621399, "length": 3.9932966232299805, "mode": "train", "epoch": 20}
{"loss": 0.42505013942718506, "acc": 0.8232421875, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.36820119619369507, "acc": 0.8357934951782227, "length": 3.9950873851776123, "mode": "train", "epoch": 21}
{"loss": 0.41563624143600464, "acc": 0.8167968392372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3578915297985077, "acc": 0.8413903713226318, "length": 3.996070146560669, "mode": "train", "epoch": 22}
{"loss": 0.399581640958786, "acc": 0.8298827409744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3454839289188385, "acc": 0.8492717146873474, "length": 3.9980969429016113, "mode": "train", "epoch": 23}
{"loss": 0.3884028196334839, "acc": 0.8382812142372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3442454934120178, "acc": 0.8528296947479248, "length": 3.99511981010437, "mode": "train", "epoch": 24}
{"loss": 0.3641447424888611, "acc": 0.841796875, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3346885144710541, "acc": 0.849202573299408, "length": 3.995532751083374, "mode": "train", "epoch": 25}
{"loss": 0.35851651430130005, "acc": 0.8486328721046448, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.31918954849243164, "acc": 0.86137455701828, "length": 3.9980690479278564, "mode": "train", "epoch": 26}
{"loss": 0.34856319427490234, "acc": 0.8505859375, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3173232674598694, "acc": 0.8591268062591553, "length": 3.9971818923950195, "mode": "train", "epoch": 27}
{"loss": 0.34005260467529297, "acc": 0.8417969346046448, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3105245530605316, "acc": 0.8613794445991516, "length": 3.9987998008728027, "mode": "train", "epoch": 28}
{"loss": 0.3368007242679596, "acc": 0.8425779938697815, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.30032703280448914, "acc": 0.8676995038986206, "length": 3.9992527961730957, "mode": "train", "epoch": 29}
{"loss": 0.32860302925109863, "acc": 0.8490234613418579, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.29853489995002747, "acc": 0.865397036075592, "length": 3.9989514350891113, "mode": "train", "epoch": 30}
{"loss": 0.32603543996810913, "acc": 0.8507810831069946, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.3004898428916931, "acc": 0.8694689273834229, "length": 3.9993019104003906, "mode": "train", "epoch": 31}
{"loss": 0.3356889486312866, "acc": 0.8546876311302185, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.29837220907211304, "acc": 0.865615963935852, "length": 3.998408794403076, "mode": "train", "epoch": 32}
{"loss": 0.3217254877090454, "acc": 0.8546875715255737, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2945682108402252, "acc": 0.8731632232666016, "length": 3.996516227722168, "mode": "train", "epoch": 33}
{"loss": 0.31319063901901245, "acc": 0.8617187142372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2949604392051697, "acc": 0.8696992993354797, "length": 3.99702787399292, "mode": "train", "epoch": 34}
{"loss": 0.3064418435096741, "acc": 0.8736328482627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2883909046649933, "acc": 0.8772664666175842, "length": 3.9997241497039795, "mode": "train", "epoch": 35}
{"loss": 0.29985278844833374, "acc": 0.8675780892372131, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.28317347168922424, "acc": 0.8720278143882751, "length": 3.99723744392395, "mode": "train", "epoch": 36}
{"loss": 0.30298346281051636, "acc": 0.8669920563697815, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.2873916029930115, "acc": 0.8782593011856079, "length": 3.999249219894409, "mode": "train", "epoch": 37}
{"loss": 0.2984303832054138, "acc": 0.8742188215255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2751968204975128, "acc": 0.8799667358398438, "length": 3.998635768890381, "mode": "train", "epoch": 38}
{"loss": 0.2910007834434509, "acc": 0.8728514909744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2776546776294708, "acc": 0.878803014755249, "length": 3.9997878074645996, "mode": "train", "epoch": 39}
{"loss": 0.3032286763191223, "acc": 0.8615232706069946, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2749115824699402, "acc": 0.8820652365684509, "length": 3.9965929985046387, "mode": "train", "epoch": 40}
{"loss": 0.28056132793426514, "acc": 0.8777342438697815, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.26972445845603943, "acc": 0.8818055391311646, "length": 3.9992456436157227, "mode": "train", "epoch": 41}
{"loss": 0.2780900001525879, "acc": 0.8792968392372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.26437458395957947, "acc": 0.8858563303947449, "length": 3.995732545852661, "mode": "train", "epoch": 42}
{"loss": 0.27911221981048584, "acc": 0.8847656846046448, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.2631540596485138, "acc": 0.8856488466262817, "length": 3.9996097087860107, "mode": "train", "epoch": 43}
{"loss": 0.2777864336967468, "acc": 0.8804688453674316, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2513887882232666, "acc": 0.8906309008598328, "length": 3.9989829063415527, "mode": "train", "epoch": 44}
{"loss": 0.2763446867465973, "acc": 0.8878907561302185, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.254855215549469, "acc": 0.8937808871269226, "length": 3.9972152709960938, "mode": "train", "epoch": 45}
{"loss": 0.2678104341030121, "acc": 0.8767576813697815, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2457161694765091, "acc": 0.8961606621742249, "length": 3.999910831451416, "mode": "train", "epoch": 46}
{"loss": 0.2562255859375, "acc": 0.8912109732627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.24356722831726074, "acc": 0.8986599445343018, "length": 3.9968316555023193, "mode": "train", "epoch": 47}
{"loss": 0.2502284646034241, "acc": 0.8976563811302185, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.23899081349372864, "acc": 0.9005881547927856, "length": 3.9999279975891113, "mode": "train", "epoch": 48}
{"loss": 0.24565067887306213, "acc": 0.8988280892372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2274463027715683, "acc": 0.9056006669998169, "length": 3.9998514652252197, "mode": "train", "epoch": 49}
{"loss": 0.24568872153759003, "acc": 0.90234375, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.22529493272304535, "acc": 0.9084033370018005, "length": 3.9991679191589355, "mode": "train", "epoch": 50}
{"loss": 0.24131596088409424, "acc": 0.9044922590255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.23136557638645172, "acc": 0.9050129652023315, "length": 3.9997568130493164, "mode": "train", "epoch": 51}
{"loss": 0.23537522554397583, "acc": 0.9058594107627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2215191125869751, "acc": 0.9119679927825928, "length": 3.999626398086548, "mode": "train", "epoch": 52}
{"loss": 0.23623692989349365, "acc": 0.9072265625, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.22146174311637878, "acc": 0.9111552834510803, "length": 3.999894618988037, "mode": "train", "epoch": 53}
{"loss": 0.2346380054950714, "acc": 0.9058594107627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.21554207801818848, "acc": 0.9091962575912476, "length": 3.99682879447937, "mode": "train", "epoch": 54}
{"loss": 0.23405274748802185, "acc": 0.9044922590255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.21632440388202667, "acc": 0.913972795009613, "length": 3.9996519088745117, "mode": "train", "epoch": 55}
{"loss": 0.23637886345386505, "acc": 0.9074219465255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.21168696880340576, "acc": 0.915143609046936, "length": 3.995757579803467, "mode": "train", "epoch": 56}
{"loss": 0.23071254789829254, "acc": 0.9068359136581421, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.21017016470432281, "acc": 0.9183564782142639, "length": 3.999927282333374, "mode": "train", "epoch": 57}
{"loss": 0.21772676706314087, "acc": 0.9169921875, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2047828882932663, "acc": 0.9189488887786865, "length": 3.9999921321868896, "mode": "train", "epoch": 58}
{"loss": 0.23464196920394897, "acc": 0.9124999642372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.20826418697834015, "acc": 0.9194191098213196, "length": 3.9999520778656006, "mode": "train", "epoch": 59}
{"loss": 0.22566825151443481, "acc": 0.9148436784744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.20699048042297363, "acc": 0.9194176197052002, "length": 3.999913215637207, "mode": "train", "epoch": 60}
{"loss": 0.2167453169822693, "acc": 0.9193358421325684, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.853709876537323
