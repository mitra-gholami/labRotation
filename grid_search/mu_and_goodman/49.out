ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6962147355079651, "acc": 0.5078384280204773, "length": 3.56148624420166, "mode": "train", "epoch": 1}
{"loss": 0.6861673593521118, "acc": 0.5563903450965881, "length": 2.125, "mode": "test", "epoch": 1}
{"loss": 0.69235759973526, "acc": 0.5261757373809814, "length": 3.550156831741333, "mode": "train", "epoch": 2}
{"loss": 0.6834728121757507, "acc": 0.573254406452179, "length": 1.97265625, "mode": "test", "epoch": 2}
{"loss": 0.6910019516944885, "acc": 0.5217781066894531, "length": 3.504124164581299, "mode": "train", "epoch": 3}
{"loss": 0.6761558055877686, "acc": 0.6239486932754517, "length": 2.42578125, "mode": "test", "epoch": 3}
{"loss": 0.6901990175247192, "acc": 0.5305616855621338, "length": 3.509247303009033, "mode": "train", "epoch": 4}
{"loss": 0.6700329780578613, "acc": 0.6768218874931335, "length": 2.75, "mode": "test", "epoch": 4}
{"loss": 0.6876692175865173, "acc": 0.547951340675354, "length": 3.476154327392578, "mode": "train", "epoch": 5}
{"loss": 0.6671427488327026, "acc": 0.6744323968887329, "length": 2.7109375, "mode": "test", "epoch": 5}
{"loss": 0.6802312731742859, "acc": 0.5834854245185852, "length": 3.298772096633911, "mode": "train", "epoch": 6}
{"loss": 0.6604152917861938, "acc": 0.6700012683868408, "length": 2.83203125, "mode": "test", "epoch": 6}
{"loss": 0.6648741364479065, "acc": 0.6326003670692444, "length": 3.2438559532165527, "mode": "train", "epoch": 7}
{"loss": 0.642318844795227, "acc": 0.6592956185340881, "length": 3.53125, "mode": "test", "epoch": 7}
{"loss": 0.6379922032356262, "acc": 0.6903855204582214, "length": 3.4020559787750244, "mode": "train", "epoch": 8}
{"loss": 0.6125620603561401, "acc": 0.6805832386016846, "length": 3.95703125, "mode": "test", "epoch": 8}
{"loss": 0.5999864935874939, "acc": 0.7061780095100403, "length": 3.6892480850219727, "mode": "train", "epoch": 9}
{"loss": 0.5843825340270996, "acc": 0.6839843392372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5659627318382263, "acc": 0.7100467085838318, "length": 3.8639309406280518, "mode": "train", "epoch": 10}
{"loss": 0.5722734928131104, "acc": 0.7054687142372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.549022376537323, "acc": 0.711831271648407, "length": 3.9078145027160645, "mode": "train", "epoch": 11}
{"loss": 0.5605132579803467, "acc": 0.7263671159744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.5313925743103027, "acc": 0.7197082042694092, "length": 3.9280078411102295, "mode": "train", "epoch": 12}
{"loss": 0.5379904508590698, "acc": 0.7298827767372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.5033512711524963, "acc": 0.7662346363067627, "length": 3.9012653827667236, "mode": "train", "epoch": 13}
{"loss": 0.5186977386474609, "acc": 0.7642578482627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4814063012599945, "acc": 0.7784431576728821, "length": 3.9180240631103516, "mode": "train", "epoch": 14}
{"loss": 0.5132664442062378, "acc": 0.7726563215255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.45581763982772827, "acc": 0.7901414036750793, "length": 3.939790725708008, "mode": "train", "epoch": 15}
{"loss": 0.5026031136512756, "acc": 0.7740234732627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4362965226173401, "acc": 0.8063405156135559, "length": 3.955803394317627, "mode": "train", "epoch": 16}
{"loss": 0.48444652557373047, "acc": 0.7873047590255737, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.42012691497802734, "acc": 0.8212520480155945, "length": 3.9580352306365967, "mode": "train", "epoch": 17}
{"loss": 0.4586980640888214, "acc": 0.7972655892372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.4003666937351227, "acc": 0.8246191740036011, "length": 3.9668545722961426, "mode": "train", "epoch": 18}
{"loss": 0.446351021528244, "acc": 0.8132811784744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3822217285633087, "acc": 0.8308228254318237, "length": 3.9762516021728516, "mode": "train", "epoch": 19}
{"loss": 0.41943633556365967, "acc": 0.8193359375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.37113282084465027, "acc": 0.8439924120903015, "length": 3.9762563705444336, "mode": "train", "epoch": 20}
{"loss": 0.41524630784988403, "acc": 0.8212890028953552, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3542928099632263, "acc": 0.8464444279670715, "length": 3.9781882762908936, "mode": "train", "epoch": 21}
{"loss": 0.41040879487991333, "acc": 0.8199219107627869, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.34928199648857117, "acc": 0.8511741757392883, "length": 3.980645179748535, "mode": "train", "epoch": 22}
{"loss": 0.4028521180152893, "acc": 0.8251953721046448, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.34476304054260254, "acc": 0.8551991581916809, "length": 3.9844744205474854, "mode": "train", "epoch": 23}
{"loss": 0.4001082181930542, "acc": 0.8212891221046448, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3368953764438629, "acc": 0.8571316599845886, "length": 3.9887962341308594, "mode": "train", "epoch": 24}
{"loss": 0.38856634497642517, "acc": 0.8240233659744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3289662003517151, "acc": 0.8548820614814758, "length": 3.993391275405884, "mode": "train", "epoch": 25}
{"loss": 0.3680166006088257, "acc": 0.8355469107627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.32191890478134155, "acc": 0.8645064234733582, "length": 3.9957311153411865, "mode": "train", "epoch": 26}
{"loss": 0.36755096912384033, "acc": 0.8335937857627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3147936165332794, "acc": 0.8674911856651306, "length": 3.9909682273864746, "mode": "train", "epoch": 27}
{"loss": 0.35802948474884033, "acc": 0.8326172232627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.30938905477523804, "acc": 0.8633761405944824, "length": 3.9929022789001465, "mode": "train", "epoch": 28}
{"loss": 0.3435867428779602, "acc": 0.8458985090255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.30376195907592773, "acc": 0.8619195818901062, "length": 3.9958691596984863, "mode": "train", "epoch": 29}
{"loss": 0.33716875314712524, "acc": 0.8513671159744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2968564033508301, "acc": 0.8689578771591187, "length": 3.996185302734375, "mode": "train", "epoch": 30}
{"loss": 0.3388180732727051, "acc": 0.8429688215255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2942637801170349, "acc": 0.8697734475135803, "length": 3.995574951171875, "mode": "train", "epoch": 31}
{"loss": 0.334006130695343, "acc": 0.8599609732627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2900501787662506, "acc": 0.8753176927566528, "length": 3.994976758956909, "mode": "train", "epoch": 32}
{"loss": 0.3132461905479431, "acc": 0.8656249046325684, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2849350869655609, "acc": 0.8732953667640686, "length": 3.998074531555176, "mode": "train", "epoch": 33}
{"loss": 0.31702619791030884, "acc": 0.8509764671325684, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.27794191241264343, "acc": 0.879287838935852, "length": 3.9961209297180176, "mode": "train", "epoch": 34}
{"loss": 0.3138229250907898, "acc": 0.8648437261581421, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.27826544642448425, "acc": 0.8823916912078857, "length": 3.9983887672424316, "mode": "train", "epoch": 35}
{"loss": 0.30427074432373047, "acc": 0.8791016936302185, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.27385571599006653, "acc": 0.8841842412948608, "length": 3.996469020843506, "mode": "train", "epoch": 36}
{"loss": 0.29748934507369995, "acc": 0.8822265267372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.26767662167549133, "acc": 0.8896029591560364, "length": 3.9995157718658447, "mode": "train", "epoch": 37}
{"loss": 0.29792606830596924, "acc": 0.8759765625, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.26636651158332825, "acc": 0.886065661907196, "length": 3.9998366832733154, "mode": "train", "epoch": 38}
{"loss": 0.3035736382007599, "acc": 0.8802733421325684, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.26345640420913696, "acc": 0.8901263475418091, "length": 3.998091220855713, "mode": "train", "epoch": 39}
{"loss": 0.2982344329357147, "acc": 0.8646484017372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.25052520632743835, "acc": 0.8988516926765442, "length": 3.998488187789917, "mode": "train", "epoch": 40}
{"loss": 0.29413971304893494, "acc": 0.8738280534744263, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2497551590204239, "acc": 0.8962695598602295, "length": 3.998323917388916, "mode": "train", "epoch": 41}
{"loss": 0.2883632183074951, "acc": 0.8804687261581421, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.23818673193454742, "acc": 0.905873715877533, "length": 3.9987692832946777, "mode": "train", "epoch": 42}
{"loss": 0.2874317169189453, "acc": 0.8906249403953552, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.23061241209506989, "acc": 0.9112300276756287, "length": 3.996767997741699, "mode": "train", "epoch": 43}
{"loss": 0.2863502502441406, "acc": 0.8841796517372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.22685600817203522, "acc": 0.9114789366722107, "length": 3.994328498840332, "mode": "train", "epoch": 44}
{"loss": 0.28391677141189575, "acc": 0.8755859732627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2207626849412918, "acc": 0.9162908792495728, "length": 3.9998111724853516, "mode": "train", "epoch": 45}
{"loss": 0.27563291788101196, "acc": 0.8867186903953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.21857483685016632, "acc": 0.9152101278305054, "length": 3.9993104934692383, "mode": "train", "epoch": 46}
{"loss": 0.2768746316432953, "acc": 0.8882813453674316, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.21908865869045258, "acc": 0.9190679788589478, "length": 3.996673345565796, "mode": "train", "epoch": 47}
{"loss": 0.26266753673553467, "acc": 0.9039062857627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.21321704983711243, "acc": 0.9185200929641724, "length": 3.998945951461792, "mode": "train", "epoch": 48}
{"loss": 0.26107826828956604, "acc": 0.8958983421325684, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.20261095464229584, "acc": 0.9216727018356323, "length": 3.996366500854492, "mode": "train", "epoch": 49}
{"loss": 0.27233773469924927, "acc": 0.8984375, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.20169909298419952, "acc": 0.9241100549697876, "length": 3.9970951080322266, "mode": "train", "epoch": 50}
{"loss": 0.2608771324157715, "acc": 0.8970702886581421, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.2012440264225006, "acc": 0.9264975190162659, "length": 3.9997003078460693, "mode": "train", "epoch": 51}
{"loss": 0.26141953468322754, "acc": 0.9013672471046448, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.19689933955669403, "acc": 0.9245427250862122, "length": 3.998617649078369, "mode": "train", "epoch": 52}
{"loss": 0.2424238920211792, "acc": 0.9095702171325684, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.19475412368774414, "acc": 0.9287205934524536, "length": 3.9972429275512695, "mode": "train", "epoch": 53}
{"loss": 0.26207998394966125, "acc": 0.9037109017372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.19458980858325958, "acc": 0.9288047552108765, "length": 3.9999043941497803, "mode": "train", "epoch": 54}
{"loss": 0.2617167830467224, "acc": 0.9070311784744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.19082827866077423, "acc": 0.9278322458267212, "length": 3.9983763694763184, "mode": "train", "epoch": 55}
{"loss": 0.26912450790405273, "acc": 0.9005860090255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.19351936876773834, "acc": 0.9281622767448425, "length": 3.9980342388153076, "mode": "train", "epoch": 56}
{"loss": 0.2507522702217102, "acc": 0.9054688215255737, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1936657726764679, "acc": 0.9301013350486755, "length": 3.99983549118042, "mode": "train", "epoch": 57}
{"loss": 0.24285006523132324, "acc": 0.9062500596046448, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.19547830522060394, "acc": 0.9271887540817261, "length": 3.9984729290008545, "mode": "train", "epoch": 58}
{"loss": 0.24751156568527222, "acc": 0.9128904938697815, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.19015304744243622, "acc": 0.9294565320014954, "length": 3.9996728897094727, "mode": "train", "epoch": 59}
{"loss": 0.23478230834007263, "acc": 0.9093750715255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1877969652414322, "acc": 0.9298688173294067, "length": 3.9999032020568848, "mode": "train", "epoch": 60}
{"loss": 0.22993505001068115, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8229031562805176
