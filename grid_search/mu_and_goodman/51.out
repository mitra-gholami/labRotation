ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6991571187973022, "acc": 0.4983789920806885, "length": 3.5254552364349365, "mode": "train", "epoch": 1}
{"loss": 0.6920719146728516, "acc": 0.516899049282074, "length": 1.05859375, "mode": "test", "epoch": 1}
{"loss": 0.6885181665420532, "acc": 0.5397427678108215, "length": 3.510727882385254, "mode": "train", "epoch": 2}
{"loss": 0.687347948551178, "acc": 0.527069091796875, "length": 1.25, "mode": "test", "epoch": 2}
{"loss": 0.6879857182502747, "acc": 0.543102502822876, "length": 3.4905714988708496, "mode": "train", "epoch": 3}
{"loss": 0.678747296333313, "acc": 0.5858260989189148, "length": 1.87109375, "mode": "test", "epoch": 3}
{"loss": 0.6862460374832153, "acc": 0.554266095161438, "length": 3.404001235961914, "mode": "train", "epoch": 4}
{"loss": 0.6697287559509277, "acc": 0.6201843023300171, "length": 2.42578125, "mode": "test", "epoch": 4}
{"loss": 0.6825470924377441, "acc": 0.561028778553009, "length": 3.470668315887451, "mode": "train", "epoch": 5}
{"loss": 0.6562949419021606, "acc": 0.64326012134552, "length": 3.36328125, "mode": "test", "epoch": 5}
{"loss": 0.6717837452888489, "acc": 0.5982427000999451, "length": 3.517374277114868, "mode": "train", "epoch": 6}
{"loss": 0.6428707838058472, "acc": 0.6698105335235596, "length": 3.7890625, "mode": "test", "epoch": 6}
{"loss": 0.6485943794250488, "acc": 0.6632685661315918, "length": 3.576310396194458, "mode": "train", "epoch": 7}
{"loss": 0.6192952394485474, "acc": 0.7076019048690796, "length": 3.953125, "mode": "test", "epoch": 7}
{"loss": 0.6121256947517395, "acc": 0.7280611991882324, "length": 3.688391923904419, "mode": "train", "epoch": 8}
{"loss": 0.5864822864532471, "acc": 0.7230468392372131, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5621379613876343, "acc": 0.7731650471687317, "length": 3.8331048488616943, "mode": "train", "epoch": 9}
{"loss": 0.5405160784721375, "acc": 0.7601562142372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.5075935125350952, "acc": 0.7893472909927368, "length": 3.924696445465088, "mode": "train", "epoch": 10}
{"loss": 0.5020202398300171, "acc": 0.7710937857627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.46515780687332153, "acc": 0.7957867383956909, "length": 3.9675564765930176, "mode": "train", "epoch": 11}
{"loss": 0.48679816722869873, "acc": 0.7826171517372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.44762322306632996, "acc": 0.7948781251907349, "length": 3.9766390323638916, "mode": "train", "epoch": 12}
{"loss": 0.4840679168701172, "acc": 0.7794921398162842, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.43652865290641785, "acc": 0.7992722988128662, "length": 3.9810383319854736, "mode": "train", "epoch": 13}
{"loss": 0.4815704822540283, "acc": 0.8025389909744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.4301481544971466, "acc": 0.8130781650543213, "length": 3.9806196689605713, "mode": "train", "epoch": 14}
{"loss": 0.4759988784790039, "acc": 0.7910156846046448, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.41959133744239807, "acc": 0.8239596486091614, "length": 3.989865303039551, "mode": "train", "epoch": 15}
{"loss": 0.4670611619949341, "acc": 0.7869139313697815, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4127495586872101, "acc": 0.8233449459075928, "length": 3.982975959777832, "mode": "train", "epoch": 16}
{"loss": 0.46373283863067627, "acc": 0.7964844703674316, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.41167396306991577, "acc": 0.8303510546684265, "length": 3.9879379272460938, "mode": "train", "epoch": 17}
{"loss": 0.45080360770225525, "acc": 0.8070312142372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.4043550193309784, "acc": 0.8267610669136047, "length": 3.982349157333374, "mode": "train", "epoch": 18}
{"loss": 0.4479126036167145, "acc": 0.8087891340255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3994533121585846, "acc": 0.8274058699607849, "length": 3.980970621109009, "mode": "train", "epoch": 19}
{"loss": 0.44200098514556885, "acc": 0.8089842796325684, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3900146782398224, "acc": 0.8329299092292786, "length": 3.985466480255127, "mode": "train", "epoch": 20}
{"loss": 0.42146557569503784, "acc": 0.8185547590255737, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3821483254432678, "acc": 0.8384658098220825, "length": 3.9835805892944336, "mode": "train", "epoch": 21}
{"loss": 0.4266035556793213, "acc": 0.8113280534744263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3725666403770447, "acc": 0.8413119912147522, "length": 3.991971731185913, "mode": "train", "epoch": 22}
{"loss": 0.4085295796394348, "acc": 0.8224610686302185, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.3561692237854004, "acc": 0.8570178151130676, "length": 3.987731695175171, "mode": "train", "epoch": 23}
{"loss": 0.39272886514663696, "acc": 0.8417968153953552, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3437845706939697, "acc": 0.867439866065979, "length": 3.9874889850616455, "mode": "train", "epoch": 24}
{"loss": 0.3835448622703552, "acc": 0.8496093153953552, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3238314688205719, "acc": 0.8763170838356018, "length": 3.98420786857605, "mode": "train", "epoch": 25}
{"loss": 0.3595266044139862, "acc": 0.8580079078674316, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.3144368827342987, "acc": 0.8780512809753418, "length": 3.9909679889678955, "mode": "train", "epoch": 26}
{"loss": 0.3586781322956085, "acc": 0.8548827171325684, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3034341335296631, "acc": 0.8846397399902344, "length": 3.9966204166412354, "mode": "train", "epoch": 27}
{"loss": 0.356021910905838, "acc": 0.8597655892372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.29545164108276367, "acc": 0.8854573965072632, "length": 3.9952852725982666, "mode": "train", "epoch": 28}
{"loss": 0.34779468178749084, "acc": 0.8638672232627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.28645771741867065, "acc": 0.8847546577453613, "length": 3.9974942207336426, "mode": "train", "epoch": 29}
{"loss": 0.3404473066329956, "acc": 0.8650389313697815, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.28201740980148315, "acc": 0.8884437680244446, "length": 3.9949417114257812, "mode": "train", "epoch": 30}
{"loss": 0.3326336145401001, "acc": 0.8689452409744263, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.27835020422935486, "acc": 0.8876627087593079, "length": 3.997074842453003, "mode": "train", "epoch": 31}
{"loss": 0.33896011114120483, "acc": 0.8623046278953552, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.2754937410354614, "acc": 0.891325056552887, "length": 3.9957029819488525, "mode": "train", "epoch": 32}
{"loss": 0.3324226140975952, "acc": 0.8675780296325684, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2766050696372986, "acc": 0.8899292349815369, "length": 3.9965567588806152, "mode": "train", "epoch": 33}
{"loss": 0.3384360671043396, "acc": 0.865234375, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2684832215309143, "acc": 0.8942168951034546, "length": 3.9974606037139893, "mode": "train", "epoch": 34}
{"loss": 0.32349279522895813, "acc": 0.8699217438697815, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.26280155777931213, "acc": 0.895494818687439, "length": 3.9987621307373047, "mode": "train", "epoch": 35}
{"loss": 0.3224327564239502, "acc": 0.8705077171325684, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.2573615610599518, "acc": 0.8957634568214417, "length": 3.995838165283203, "mode": "train", "epoch": 36}
{"loss": 0.32384738326072693, "acc": 0.8683594465255737, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.25875964760780334, "acc": 0.8996321558952332, "length": 3.997210741043091, "mode": "train", "epoch": 37}
{"loss": 0.31677794456481934, "acc": 0.8730468153953552, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2589799761772156, "acc": 0.8967074155807495, "length": 3.999375820159912, "mode": "train", "epoch": 38}
{"loss": 0.31684088706970215, "acc": 0.8714842796325684, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.25175046920776367, "acc": 0.8988829851150513, "length": 3.9986348152160645, "mode": "train", "epoch": 39}
{"loss": 0.3040168285369873, "acc": 0.87890625, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.24813556671142578, "acc": 0.9025406837463379, "length": 3.9955174922943115, "mode": "train", "epoch": 40}
{"loss": 0.29958316683769226, "acc": 0.8759766221046448, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2532992959022522, "acc": 0.8966706991195679, "length": 3.9987828731536865, "mode": "train", "epoch": 41}
{"loss": 0.2964707612991333, "acc": 0.8853515982627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.24697254598140717, "acc": 0.9019598960876465, "length": 3.998335123062134, "mode": "train", "epoch": 42}
{"loss": 0.2969735562801361, "acc": 0.880859375, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.24561746418476105, "acc": 0.8984276652336121, "length": 3.9986190795898438, "mode": "train", "epoch": 43}
{"loss": 0.2829163372516632, "acc": 0.8900390267372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.24482770264148712, "acc": 0.9018849730491638, "length": 3.999281883239746, "mode": "train", "epoch": 44}
{"loss": 0.29099225997924805, "acc": 0.8820313811302185, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.2419663518667221, "acc": 0.9007035493850708, "length": 3.995394229888916, "mode": "train", "epoch": 45}
{"loss": 0.2763736844062805, "acc": 0.8935546278953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.23573194444179535, "acc": 0.9042487144470215, "length": 3.9992892742156982, "mode": "train", "epoch": 46}
{"loss": 0.2756595015525818, "acc": 0.892578125, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.22989943623542786, "acc": 0.9068053364753723, "length": 3.9971835613250732, "mode": "train", "epoch": 47}
{"loss": 0.27129656076431274, "acc": 0.9001952409744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.22877979278564453, "acc": 0.9076542854309082, "length": 3.998319625854492, "mode": "train", "epoch": 48}
{"loss": 0.2674752473831177, "acc": 0.8933595418930054, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.22491320967674255, "acc": 0.9074000716209412, "length": 3.998995065689087, "mode": "train", "epoch": 49}
{"loss": 0.25439614057540894, "acc": 0.8968749642372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.2188454568386078, "acc": 0.9143021702766418, "length": 3.99922251701355, "mode": "train", "epoch": 50}
{"loss": 0.25144094228744507, "acc": 0.8974608778953552, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.21942831575870514, "acc": 0.9117902517318726, "length": 3.9996323585510254, "mode": "train", "epoch": 51}
{"loss": 0.2581174075603485, "acc": 0.8941406607627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.22280369699001312, "acc": 0.9118420481681824, "length": 3.999368906021118, "mode": "train", "epoch": 52}
{"loss": 0.25928908586502075, "acc": 0.8990235328674316, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.2237158566713333, "acc": 0.9115499258041382, "length": 3.999516248703003, "mode": "train", "epoch": 53}
{"loss": 0.27174365520477295, "acc": 0.8962889909744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.21917465329170227, "acc": 0.9159314632415771, "length": 3.999772548675537, "mode": "train", "epoch": 54}
{"loss": 0.2578752934932709, "acc": 0.9046874046325684, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.2164788395166397, "acc": 0.9174656271934509, "length": 3.999541759490967, "mode": "train", "epoch": 55}
{"loss": 0.2699294686317444, "acc": 0.9009765982627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.21060363948345184, "acc": 0.9185168743133545, "length": 3.9973392486572266, "mode": "train", "epoch": 56}
{"loss": 0.2639670968055725, "acc": 0.9019531607627869, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.21027979254722595, "acc": 0.9200720191001892, "length": 3.9997241497039795, "mode": "train", "epoch": 57}
{"loss": 0.2567961513996124, "acc": 0.9082030653953552, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.2073136419057846, "acc": 0.9209837913513184, "length": 3.9995710849761963, "mode": "train", "epoch": 58}
{"loss": 0.2592218816280365, "acc": 0.9066405892372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.20356424152851105, "acc": 0.9252273440361023, "length": 3.9992284774780273, "mode": "train", "epoch": 59}
{"loss": 0.2612440884113312, "acc": 0.9095702171325684, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.20417141914367676, "acc": 0.9230114221572876, "length": 3.9998373985290527, "mode": "train", "epoch": 60}
{"loss": 0.25696784257888794, "acc": 0.9089843034744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7883927822113037
