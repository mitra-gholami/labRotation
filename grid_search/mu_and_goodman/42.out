ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7018865346908569, "acc": 0.5077676177024841, "length": 3.315734624862671, "mode": "train", "epoch": 1}
{"loss": 0.693342924118042, "acc": 0.49941402673721313, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6877554655075073, "acc": 0.5450241565704346, "length": 2.104551315307617, "mode": "train", "epoch": 2}
{"loss": 0.6905933618545532, "acc": 0.5171966552734375, "length": 1.17578125, "mode": "test", "epoch": 2}
{"loss": 0.6607264280319214, "acc": 0.6141523122787476, "length": 2.64943790435791, "mode": "train", "epoch": 3}
{"loss": 0.6203442215919495, "acc": 0.7176330089569092, "length": 2.81640625, "mode": "test", "epoch": 3}
{"loss": 0.5920169949531555, "acc": 0.7252897024154663, "length": 2.901226043701172, "mode": "train", "epoch": 4}
{"loss": 0.536740779876709, "acc": 0.7759215831756592, "length": 3.05078125, "mode": "test", "epoch": 4}
{"loss": 0.5133606195449829, "acc": 0.7797467708587646, "length": 3.077939987182617, "mode": "train", "epoch": 5}
{"loss": 0.48423945903778076, "acc": 0.8033844232559204, "length": 3.203125, "mode": "test", "epoch": 5}
{"loss": 0.42997583746910095, "acc": 0.8150107264518738, "length": 3.2088773250579834, "mode": "train", "epoch": 6}
{"loss": 0.42700475454330444, "acc": 0.8154144287109375, "length": 3.44921875, "mode": "test", "epoch": 6}
{"loss": 0.4014805853366852, "acc": 0.8347876667976379, "length": 3.4541659355163574, "mode": "train", "epoch": 7}
{"loss": 0.44035232067108154, "acc": 0.8137878179550171, "length": 3.37890625, "mode": "test", "epoch": 7}
{"loss": 0.3808635175228119, "acc": 0.8380906581878662, "length": 3.4432640075683594, "mode": "train", "epoch": 8}
{"loss": 0.40357506275177, "acc": 0.8323822021484375, "length": 3.42578125, "mode": "test", "epoch": 8}
{"loss": 0.36793452501296997, "acc": 0.8463342189788818, "length": 3.4221973419189453, "mode": "train", "epoch": 9}
{"loss": 0.40450340509414673, "acc": 0.8329163193702698, "length": 3.47265625, "mode": "test", "epoch": 9}
{"loss": 0.34903040528297424, "acc": 0.8559823632240295, "length": 3.50435209274292, "mode": "train", "epoch": 10}
{"loss": 0.3740948736667633, "acc": 0.8368775248527527, "length": 3.6953125, "mode": "test", "epoch": 10}
{"loss": 0.3435661196708679, "acc": 0.8576257228851318, "length": 3.625063180923462, "mode": "train", "epoch": 11}
{"loss": 0.36277318000793457, "acc": 0.8423217535018921, "length": 3.84765625, "mode": "test", "epoch": 11}
{"loss": 0.3099138140678406, "acc": 0.8689272999763489, "length": 3.796708583831787, "mode": "train", "epoch": 12}
{"loss": 0.3554922342300415, "acc": 0.8546813130378723, "length": 3.90625, "mode": "test", "epoch": 12}
{"loss": 0.2986559271812439, "acc": 0.8825235962867737, "length": 3.7748830318450928, "mode": "train", "epoch": 13}
{"loss": 0.3384931683540344, "acc": 0.8511718511581421, "length": 3.96484375, "mode": "test", "epoch": 13}
{"loss": 0.2867518961429596, "acc": 0.8780805468559265, "length": 3.855774402618408, "mode": "train", "epoch": 14}
{"loss": 0.3424379229545593, "acc": 0.8495086431503296, "length": 3.98828125, "mode": "test", "epoch": 14}
{"loss": 0.2806127965450287, "acc": 0.8750116229057312, "length": 3.891540765762329, "mode": "train", "epoch": 15}
{"loss": 0.3121422231197357, "acc": 0.8636627793312073, "length": 3.98828125, "mode": "test", "epoch": 15}
{"loss": 0.27462807297706604, "acc": 0.8860441446304321, "length": 3.870526075363159, "mode": "train", "epoch": 16}
{"loss": 0.3042486011981964, "acc": 0.8731719851493835, "length": 3.96484375, "mode": "test", "epoch": 16}
{"loss": 0.27745160460472107, "acc": 0.8901346325874329, "length": 3.8731725215911865, "mode": "train", "epoch": 17}
{"loss": 0.3034206032752991, "acc": 0.8791016936302185, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.25268301367759705, "acc": 0.8925876021385193, "length": 3.950815439224243, "mode": "train", "epoch": 18}
{"loss": 0.2718138098716736, "acc": 0.8914061188697815, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.24960768222808838, "acc": 0.8968598246574402, "length": 3.9676718711853027, "mode": "train", "epoch": 19}
{"loss": 0.2728612720966339, "acc": 0.8890625238418579, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.24046076834201813, "acc": 0.8996585607528687, "length": 3.978844404220581, "mode": "train", "epoch": 20}
{"loss": 0.2591322362422943, "acc": 0.8964843153953552, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.23078250885009766, "acc": 0.906353235244751, "length": 3.979128360748291, "mode": "train", "epoch": 21}
{"loss": 0.2503923773765564, "acc": 0.9019532203674316, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23969848453998566, "acc": 0.9075543880462646, "length": 3.9951367378234863, "mode": "train", "epoch": 22}
{"loss": 0.24347802996635437, "acc": 0.9052734375, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.21827168762683868, "acc": 0.9125722050666809, "length": 3.992656946182251, "mode": "train", "epoch": 23}
{"loss": 0.25060003995895386, "acc": 0.9017577767372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.22703950107097626, "acc": 0.9137338399887085, "length": 3.9927031993865967, "mode": "train", "epoch": 24}
{"loss": 0.2598833739757538, "acc": 0.9033203125, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.23343656957149506, "acc": 0.9056763648986816, "length": 3.990758180618286, "mode": "train", "epoch": 25}
{"loss": 0.233964204788208, "acc": 0.908203125, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.2200712263584137, "acc": 0.9154059886932373, "length": 3.9857420921325684, "mode": "train", "epoch": 26}
{"loss": 0.24682123959064484, "acc": 0.9076171517372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.21610493957996368, "acc": 0.9149529933929443, "length": 3.994580030441284, "mode": "train", "epoch": 27}
{"loss": 0.23299533128738403, "acc": 0.9119139909744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.19418834149837494, "acc": 0.9180149435997009, "length": 3.9932773113250732, "mode": "train", "epoch": 28}
{"loss": 0.21765443682670593, "acc": 0.9208983778953552, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18909676373004913, "acc": 0.9220142364501953, "length": 3.997025489807129, "mode": "train", "epoch": 29}
{"loss": 0.2180178016424179, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18237487971782684, "acc": 0.9266059398651123, "length": 3.98860239982605, "mode": "train", "epoch": 30}
{"loss": 0.22820985317230225, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1979704648256302, "acc": 0.9276027083396912, "length": 3.9970505237579346, "mode": "train", "epoch": 31}
{"loss": 0.23421010375022888, "acc": 0.9144530892372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.19300493597984314, "acc": 0.9228251576423645, "length": 3.995668411254883, "mode": "train", "epoch": 32}
{"loss": 0.23072874546051025, "acc": 0.9115234017372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.17976035177707672, "acc": 0.9335829019546509, "length": 3.998354196548462, "mode": "train", "epoch": 33}
{"loss": 0.22739171981811523, "acc": 0.9203124046325684, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.18612149357795715, "acc": 0.9331047534942627, "length": 3.996417284011841, "mode": "train", "epoch": 34}
{"loss": 0.21169497072696686, "acc": 0.9269532561302185, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.17612890899181366, "acc": 0.9320042133331299, "length": 3.9955856800079346, "mode": "train", "epoch": 35}
{"loss": 0.2229842245578766, "acc": 0.9152345061302185, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.16828401386737823, "acc": 0.9329213500022888, "length": 3.9985928535461426, "mode": "train", "epoch": 36}
{"loss": 0.1964511126279831, "acc": 0.9296874403953552, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.17492343485355377, "acc": 0.9341977834701538, "length": 3.9995028972625732, "mode": "train", "epoch": 37}
{"loss": 0.2121219038963318, "acc": 0.9224609732627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.17581939697265625, "acc": 0.9333000779151917, "length": 3.9964287281036377, "mode": "train", "epoch": 38}
{"loss": 0.21454757452011108, "acc": 0.9244140982627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.18379761278629303, "acc": 0.931185781955719, "length": 3.9979665279388428, "mode": "train", "epoch": 39}
{"loss": 0.19628122448921204, "acc": 0.9318360090255737, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.17023704946041107, "acc": 0.9325229525566101, "length": 3.9986159801483154, "mode": "train", "epoch": 40}
{"loss": 0.22248435020446777, "acc": 0.9189453125, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.17609678208827972, "acc": 0.9347293972969055, "length": 3.999258279800415, "mode": "train", "epoch": 41}
{"loss": 0.20241832733154297, "acc": 0.9275389313697815, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.16312600672245026, "acc": 0.9372798204421997, "length": 3.9991002082824707, "mode": "train", "epoch": 42}
{"loss": 0.22650432586669922, "acc": 0.9177733659744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.17495553195476532, "acc": 0.9291982054710388, "length": 3.999854326248169, "mode": "train", "epoch": 43}
{"loss": 0.23108959197998047, "acc": 0.91015625, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1740269660949707, "acc": 0.9347678422927856, "length": 3.998410940170288, "mode": "train", "epoch": 44}
{"loss": 0.21539148688316345, "acc": 0.9236327409744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.152711883187294, "acc": 0.9375696182250977, "length": 3.997495651245117, "mode": "train", "epoch": 45}
{"loss": 0.20307311415672302, "acc": 0.921875, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.15860913693904877, "acc": 0.9392614364624023, "length": 3.999523878097534, "mode": "train", "epoch": 46}
{"loss": 0.24557605385780334, "acc": 0.9181641340255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.16262996196746826, "acc": 0.9361628293991089, "length": 3.9994330406188965, "mode": "train", "epoch": 47}
{"loss": 0.21009770035743713, "acc": 0.9279298186302185, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.16487087309360504, "acc": 0.939428448677063, "length": 3.9948389530181885, "mode": "train", "epoch": 48}
{"loss": 0.21639606356620789, "acc": 0.9251952767372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.14859281480312347, "acc": 0.9413554072380066, "length": 3.9997975826263428, "mode": "train", "epoch": 49}
{"loss": 0.22022750973701477, "acc": 0.9207029938697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.14291949570178986, "acc": 0.940558910369873, "length": 3.997647285461426, "mode": "train", "epoch": 50}
{"loss": 0.1916944831609726, "acc": 0.9337891340255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.14098845422267914, "acc": 0.9439116716384888, "length": 3.999513864517212, "mode": "train", "epoch": 51}
{"loss": 0.1945609152317047, "acc": 0.9341797232627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.13790172338485718, "acc": 0.9450322985649109, "length": 3.9989466667175293, "mode": "train", "epoch": 52}
{"loss": 0.20060795545578003, "acc": 0.9283203482627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.14795193076133728, "acc": 0.9433794617652893, "length": 3.9996187686920166, "mode": "train", "epoch": 53}
{"loss": 0.20044541358947754, "acc": 0.9304686784744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.13843075931072235, "acc": 0.9466188549995422, "length": 3.9979889392852783, "mode": "train", "epoch": 54}
{"loss": 0.2139604091644287, "acc": 0.9283203482627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.15314753353595734, "acc": 0.9452589750289917, "length": 3.9984142780303955, "mode": "train", "epoch": 55}
{"loss": 0.21693944931030273, "acc": 0.9291015267372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.14932894706726074, "acc": 0.9379915595054626, "length": 3.9985406398773193, "mode": "train", "epoch": 56}
{"loss": 0.21596522629261017, "acc": 0.9320312142372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.15278935432434082, "acc": 0.9409416317939758, "length": 3.9998250007629395, "mode": "train", "epoch": 57}
{"loss": 0.21959853172302246, "acc": 0.9214844107627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.16226401925086975, "acc": 0.9393231868743896, "length": 3.99953293800354, "mode": "train", "epoch": 58}
{"loss": 0.1973820924758911, "acc": 0.9365234375, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.13884089887142181, "acc": 0.9458792209625244, "length": 3.999657154083252, "mode": "train", "epoch": 59}
{"loss": 0.19485661387443542, "acc": 0.93359375, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.13355039060115814, "acc": 0.9503978490829468, "length": 3.9992451667785645, "mode": "train", "epoch": 60}
{"loss": 0.18761608004570007, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7748436331748962
