ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6974338889122009, "acc": 0.5222858190536499, "length": 3.5598056316375732, "mode": "train", "epoch": 1}
{"loss": 0.6783097982406616, "acc": 0.589343249797821, "length": 2.67578125, "mode": "test", "epoch": 1}
{"loss": 0.693352222442627, "acc": 0.5120406150817871, "length": 3.515958547592163, "mode": "train", "epoch": 2}
{"loss": 0.6818066239356995, "acc": 0.5811142325401306, "length": 1.43359375, "mode": "test", "epoch": 2}
{"loss": 0.6890753507614136, "acc": 0.5317358374595642, "length": 3.345980405807495, "mode": "train", "epoch": 3}
{"loss": 0.6742748618125916, "acc": 0.631172239780426, "length": 1.9375, "mode": "test", "epoch": 3}
{"loss": 0.6749511957168579, "acc": 0.5826535224914551, "length": 3.215547800064087, "mode": "train", "epoch": 4}
{"loss": 0.6516916155815125, "acc": 0.6785094738006592, "length": 2.734375, "mode": "test", "epoch": 4}
{"loss": 0.6455861330032349, "acc": 0.6573755145072937, "length": 3.2335073947906494, "mode": "train", "epoch": 5}
{"loss": 0.6119116544723511, "acc": 0.7339752316474915, "length": 3.08984375, "mode": "test", "epoch": 5}
{"loss": 0.5847653150558472, "acc": 0.7504048943519592, "length": 3.376094102859497, "mode": "train", "epoch": 6}
{"loss": 0.5396873950958252, "acc": 0.7766861319541931, "length": 3.703125, "mode": "test", "epoch": 6}
{"loss": 0.4993610084056854, "acc": 0.7844192385673523, "length": 3.6817541122436523, "mode": "train", "epoch": 7}
{"loss": 0.49169468879699707, "acc": 0.7659790515899658, "length": 3.984375, "mode": "test", "epoch": 7}
{"loss": 0.4364597201347351, "acc": 0.8018396496772766, "length": 3.8980417251586914, "mode": "train", "epoch": 8}
{"loss": 0.49288007616996765, "acc": 0.7781249284744263, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4248867928981781, "acc": 0.8057806491851807, "length": 3.9659481048583984, "mode": "train", "epoch": 9}
{"loss": 0.4960992932319641, "acc": 0.7843749523162842, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.40119656920433044, "acc": 0.8160315155982971, "length": 3.976527452468872, "mode": "train", "epoch": 10}
{"loss": 0.45532286167144775, "acc": 0.7984374761581421, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3808510899543762, "acc": 0.8197055459022522, "length": 3.9846854209899902, "mode": "train", "epoch": 11}
{"loss": 0.4383145570755005, "acc": 0.8017577528953552, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.35986199975013733, "acc": 0.8357752561569214, "length": 3.990130662918091, "mode": "train", "epoch": 12}
{"loss": 0.4131576418876648, "acc": 0.8099608421325684, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.33937278389930725, "acc": 0.8546833395957947, "length": 3.989074468612671, "mode": "train", "epoch": 13}
{"loss": 0.40715646743774414, "acc": 0.8148437142372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3226430416107178, "acc": 0.8668309450149536, "length": 3.9937222003936768, "mode": "train", "epoch": 14}
{"loss": 0.39038559794425964, "acc": 0.8248047232627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.30756551027297974, "acc": 0.8714867830276489, "length": 3.9930367469787598, "mode": "train", "epoch": 15}
{"loss": 0.39416801929473877, "acc": 0.8384765982627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2955668568611145, "acc": 0.8782703280448914, "length": 3.995913505554199, "mode": "train", "epoch": 16}
{"loss": 0.38967829942703247, "acc": 0.8376952409744263, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2827429175376892, "acc": 0.8822749853134155, "length": 3.9962563514709473, "mode": "train", "epoch": 17}
{"loss": 0.3645024299621582, "acc": 0.8521484136581421, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2746206521987915, "acc": 0.8858118653297424, "length": 3.995767831802368, "mode": "train", "epoch": 18}
{"loss": 0.3654978275299072, "acc": 0.8457030653953552, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2702247202396393, "acc": 0.8840823173522949, "length": 3.993753433227539, "mode": "train", "epoch": 19}
{"loss": 0.3571751117706299, "acc": 0.8552733659744263, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.26045769453048706, "acc": 0.8938234448432922, "length": 3.9975106716156006, "mode": "train", "epoch": 20}
{"loss": 0.3572356104850769, "acc": 0.8587890267372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.25888341665267944, "acc": 0.8928234577178955, "length": 3.9989700317382812, "mode": "train", "epoch": 21}
{"loss": 0.3426540493965149, "acc": 0.8613281846046448, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2501852214336395, "acc": 0.8943411111831665, "length": 3.999000310897827, "mode": "train", "epoch": 22}
{"loss": 0.33285897970199585, "acc": 0.8638671636581421, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.24031947553157806, "acc": 0.9011175632476807, "length": 3.9986889362335205, "mode": "train", "epoch": 23}
{"loss": 0.3183732032775879, "acc": 0.8664063215255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.23083779215812683, "acc": 0.9049596190452576, "length": 3.9991414546966553, "mode": "train", "epoch": 24}
{"loss": 0.31992006301879883, "acc": 0.8751954436302185, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.22440175712108612, "acc": 0.9031497240066528, "length": 3.9997189044952393, "mode": "train", "epoch": 25}
{"loss": 0.2975583076477051, "acc": 0.8796873688697815, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.21393652260303497, "acc": 0.9142761826515198, "length": 3.996528387069702, "mode": "train", "epoch": 26}
{"loss": 0.28760337829589844, "acc": 0.8978515267372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.20821897685527802, "acc": 0.9152155518531799, "length": 3.999232053756714, "mode": "train", "epoch": 27}
{"loss": 0.27867889404296875, "acc": 0.8996092081069946, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.20046952366828918, "acc": 0.9203036427497864, "length": 3.997699737548828, "mode": "train", "epoch": 28}
{"loss": 0.2821579575538635, "acc": 0.8951172232627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.20453667640686035, "acc": 0.9204989075660706, "length": 3.999445915222168, "mode": "train", "epoch": 29}
{"loss": 0.2692852020263672, "acc": 0.9085937142372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.19866137206554413, "acc": 0.9223737120628357, "length": 3.997990608215332, "mode": "train", "epoch": 30}
{"loss": 0.25102561712265015, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.19003227353096008, "acc": 0.9255978465080261, "length": 3.999652147293091, "mode": "train", "epoch": 31}
{"loss": 0.2713465094566345, "acc": 0.8996094465255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.18101827800273895, "acc": 0.9289407730102539, "length": 3.9999072551727295, "mode": "train", "epoch": 32}
{"loss": 0.2524991035461426, "acc": 0.9076171517372131, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.18560096621513367, "acc": 0.9272443056106567, "length": 3.998349905014038, "mode": "train", "epoch": 33}
{"loss": 0.2347080409526825, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17391923069953918, "acc": 0.9369610548019409, "length": 3.9983808994293213, "mode": "train", "epoch": 34}
{"loss": 0.23626750707626343, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1725129634141922, "acc": 0.9327625632286072, "length": 3.999863624572754, "mode": "train", "epoch": 35}
{"loss": 0.2417563796043396, "acc": 0.9205079078674316, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.16860413551330566, "acc": 0.9391190409660339, "length": 3.9994726181030273, "mode": "train", "epoch": 36}
{"loss": 0.23076382279396057, "acc": 0.9185547232627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.16331610083580017, "acc": 0.9416234493255615, "length": 3.9998927116394043, "mode": "train", "epoch": 37}
{"loss": 0.22900336980819702, "acc": 0.9224609732627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.15952490270137787, "acc": 0.9401077032089233, "length": 3.9999186992645264, "mode": "train", "epoch": 38}
{"loss": 0.2230529487133026, "acc": 0.9177733063697815, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1590898483991623, "acc": 0.939257800579071, "length": 3.9999325275421143, "mode": "train", "epoch": 39}
{"loss": 0.2212803214788437, "acc": 0.9267578721046448, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15907350182533264, "acc": 0.9396741390228271, "length": 3.9987595081329346, "mode": "train", "epoch": 40}
{"loss": 0.22758501768112183, "acc": 0.9228515625, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1622186005115509, "acc": 0.9369524717330933, "length": 3.9999630451202393, "mode": "train", "epoch": 41}
{"loss": 0.208965465426445, "acc": 0.9279298186302185, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.15781114995479584, "acc": 0.9415640234947205, "length": 3.9999594688415527, "mode": "train", "epoch": 42}
{"loss": 0.22494599223136902, "acc": 0.9232421517372131, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15405838191509247, "acc": 0.9452641606330872, "length": 3.9999501705169678, "mode": "train", "epoch": 43}
{"loss": 0.21970489621162415, "acc": 0.9339843988418579, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1466275006532669, "acc": 0.9444672465324402, "length": 3.999447822570801, "mode": "train", "epoch": 44}
{"loss": 0.20195606350898743, "acc": 0.923828125, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.15117676556110382, "acc": 0.9431957006454468, "length": 3.999840497970581, "mode": "train", "epoch": 45}
{"loss": 0.22367368638515472, "acc": 0.9210938811302185, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.14852245151996613, "acc": 0.9434458613395691, "length": 3.9999759197235107, "mode": "train", "epoch": 46}
{"loss": 0.205931156873703, "acc": 0.9316406846046448, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1514068990945816, "acc": 0.9435058832168579, "length": 3.999966859817505, "mode": "train", "epoch": 47}
{"loss": 0.20116961002349854, "acc": 0.9287109375, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.14737750589847565, "acc": 0.944892168045044, "length": 3.999683380126953, "mode": "train", "epoch": 48}
{"loss": 0.21093890070915222, "acc": 0.9257813096046448, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1341738998889923, "acc": 0.9519289135932922, "length": 3.999829053878784, "mode": "train", "epoch": 49}
{"loss": 0.19090881943702698, "acc": 0.9310546517372131, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1266523003578186, "acc": 0.9555812478065491, "length": 3.9999442100524902, "mode": "train", "epoch": 50}
{"loss": 0.18285423517227173, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12483960390090942, "acc": 0.9552181363105774, "length": 3.9999923706054688, "mode": "train", "epoch": 51}
{"loss": 0.18411335349082947, "acc": 0.9269531965255737, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12115620821714401, "acc": 0.958191454410553, "length": 3.9999911785125732, "mode": "train", "epoch": 52}
{"loss": 0.19426962733268738, "acc": 0.9351562857627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1330426186323166, "acc": 0.9571435451507568, "length": 3.9994688034057617, "mode": "train", "epoch": 53}
{"loss": 0.1948893815279007, "acc": 0.9345703125, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.12391699105501175, "acc": 0.9553366899490356, "length": 3.9999196529388428, "mode": "train", "epoch": 54}
{"loss": 0.18481658399105072, "acc": 0.9378905892372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11973579972982407, "acc": 0.9603747129440308, "length": 3.999969959259033, "mode": "train", "epoch": 55}
{"loss": 0.18827401101589203, "acc": 0.9417968392372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.13074028491973877, "acc": 0.9594641923904419, "length": 3.999950885772705, "mode": "train", "epoch": 56}
{"loss": 0.1780110001564026, "acc": 0.9404297471046448, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.12435523420572281, "acc": 0.9568478465080261, "length": 3.9997806549072266, "mode": "train", "epoch": 57}
{"loss": 0.19219747185707092, "acc": 0.9400390982627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.12199073284864426, "acc": 0.9557000398635864, "length": 3.9999473094940186, "mode": "train", "epoch": 58}
{"loss": 0.1905752569437027, "acc": 0.9324217438697815, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.1152348518371582, "acc": 0.9594577550888062, "length": 3.9997761249542236, "mode": "train", "epoch": 59}
{"loss": 0.17424139380455017, "acc": 0.9324218034744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.11026787757873535, "acc": 0.9635301828384399, "length": 3.9999794960021973, "mode": "train", "epoch": 60}
{"loss": 0.16353532671928406, "acc": 0.9482422471046448, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7802940607070923
