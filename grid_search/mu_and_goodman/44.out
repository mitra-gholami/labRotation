ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6936739683151245, "acc": 0.5259846448898315, "length": 3.5161306858062744, "mode": "train", "epoch": 1}
{"loss": 0.693085789680481, "acc": 0.5040496587753296, "length": 1.02734375, "mode": "test", "epoch": 1}
{"loss": 0.6857404708862305, "acc": 0.5512657761573792, "length": 3.1950299739837646, "mode": "train", "epoch": 2}
{"loss": 0.6800962090492249, "acc": 0.5468170046806335, "length": 1.8671875, "mode": "test", "epoch": 2}
{"loss": 0.6494169235229492, "acc": 0.6475051641464233, "length": 3.218982696533203, "mode": "train", "epoch": 3}
{"loss": 0.597342848777771, "acc": 0.6974608898162842, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5367159247398376, "acc": 0.7701098918914795, "length": 3.716521978378296, "mode": "train", "epoch": 4}
{"loss": 0.49380403757095337, "acc": 0.7806640267372131, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4396326243877411, "acc": 0.8082034587860107, "length": 3.926497220993042, "mode": "train", "epoch": 5}
{"loss": 0.4665681719779968, "acc": 0.7996093034744263, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.39950576424598694, "acc": 0.8270435929298401, "length": 3.9575986862182617, "mode": "train", "epoch": 6}
{"loss": 0.4193180203437805, "acc": 0.8187499642372131, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3613424003124237, "acc": 0.8429780006408691, "length": 3.971978187561035, "mode": "train", "epoch": 7}
{"loss": 0.41743823885917664, "acc": 0.8314452767372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.32285037636756897, "acc": 0.8676234483718872, "length": 3.9795589447021484, "mode": "train", "epoch": 8}
{"loss": 0.3918578624725342, "acc": 0.8359375, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.3111395537853241, "acc": 0.8720461130142212, "length": 3.9821033477783203, "mode": "train", "epoch": 9}
{"loss": 0.37185436487197876, "acc": 0.8466797471046448, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.2819303870201111, "acc": 0.8835415244102478, "length": 3.9873430728912354, "mode": "train", "epoch": 10}
{"loss": 0.38466739654541016, "acc": 0.8462890982627869, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.27962857484817505, "acc": 0.8886563181877136, "length": 3.9895308017730713, "mode": "train", "epoch": 11}
{"loss": 0.37008440494537354, "acc": 0.8449220061302185, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2659926414489746, "acc": 0.8953468799591064, "length": 3.993875741958618, "mode": "train", "epoch": 12}
{"loss": 0.35142046213150024, "acc": 0.8572264909744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2518253028392792, "acc": 0.9011695981025696, "length": 3.9949326515197754, "mode": "train", "epoch": 13}
{"loss": 0.3407818078994751, "acc": 0.8757811784744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.267679363489151, "acc": 0.896564781665802, "length": 3.996528148651123, "mode": "train", "epoch": 14}
{"loss": 0.3495223820209503, "acc": 0.8646484017372131, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2491428703069687, "acc": 0.9021254777908325, "length": 3.9972445964813232, "mode": "train", "epoch": 15}
{"loss": 0.32809361815452576, "acc": 0.8748046159744263, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.24015866219997406, "acc": 0.9030272364616394, "length": 3.9975621700286865, "mode": "train", "epoch": 16}
{"loss": 0.30860260128974915, "acc": 0.8876952528953552, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.23467014729976654, "acc": 0.9062005877494812, "length": 3.9970757961273193, "mode": "train", "epoch": 17}
{"loss": 0.3210868239402771, "acc": 0.8841796517372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2265024334192276, "acc": 0.9093537926673889, "length": 3.9983954429626465, "mode": "train", "epoch": 18}
{"loss": 0.30124762654304504, "acc": 0.8968749642372131, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2201983779668808, "acc": 0.9123747944831848, "length": 3.999016046524048, "mode": "train", "epoch": 19}
{"loss": 0.28439149260520935, "acc": 0.896484375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21212342381477356, "acc": 0.9168045520782471, "length": 3.9991071224212646, "mode": "train", "epoch": 20}
{"loss": 0.3286221921443939, "acc": 0.8816404938697815, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2125658541917801, "acc": 0.915274441242218, "length": 3.999452829360962, "mode": "train", "epoch": 21}
{"loss": 0.29670968651771545, "acc": 0.8998046517372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.20258037745952606, "acc": 0.9219461679458618, "length": 3.9994115829467773, "mode": "train", "epoch": 22}
{"loss": 0.2951270639896393, "acc": 0.8914061784744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.19703833758831024, "acc": 0.9214172959327698, "length": 3.9996039867401123, "mode": "train", "epoch": 23}
{"loss": 0.29779666662216187, "acc": 0.8800781965255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.19639162719249725, "acc": 0.9237213134765625, "length": 3.9996488094329834, "mode": "train", "epoch": 24}
{"loss": 0.3091926574707031, "acc": 0.8937500715255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.20075131952762604, "acc": 0.9255520105361938, "length": 3.9996440410614014, "mode": "train", "epoch": 25}
{"loss": 0.2834963798522949, "acc": 0.9000000357627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.19272293150424957, "acc": 0.9258483648300171, "length": 3.9997172355651855, "mode": "train", "epoch": 26}
{"loss": 0.2851651608943939, "acc": 0.8949218392372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.19015491008758545, "acc": 0.9274424314498901, "length": 3.999728202819824, "mode": "train", "epoch": 27}
{"loss": 0.28327909111976624, "acc": 0.9087890982627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1849045753479004, "acc": 0.926323652267456, "length": 3.9997780323028564, "mode": "train", "epoch": 28}
{"loss": 0.27119436860084534, "acc": 0.9009765982627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.18369612097740173, "acc": 0.9291465878486633, "length": 3.9995737075805664, "mode": "train", "epoch": 29}
{"loss": 0.25743386149406433, "acc": 0.9074219465255737, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.18981006741523743, "acc": 0.9292168021202087, "length": 3.999854326248169, "mode": "train", "epoch": 30}
{"loss": 0.2575395703315735, "acc": 0.9142578840255737, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.1853373944759369, "acc": 0.9255592823028564, "length": 3.9999423027038574, "mode": "train", "epoch": 31}
{"loss": 0.2716470956802368, "acc": 0.9107422232627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17931829392910004, "acc": 0.9309290051460266, "length": 3.9998698234558105, "mode": "train", "epoch": 32}
{"loss": 0.2483639419078827, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.18269802629947662, "acc": 0.9329383373260498, "length": 3.9999208450317383, "mode": "train", "epoch": 33}
{"loss": 0.23845282196998596, "acc": 0.9074219465255737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.17708739638328552, "acc": 0.928978443145752, "length": 3.999788999557495, "mode": "train", "epoch": 34}
{"loss": 0.24833756685256958, "acc": 0.90234375, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.18175211548805237, "acc": 0.9324658513069153, "length": 3.999929666519165, "mode": "train", "epoch": 35}
{"loss": 0.26972121000289917, "acc": 0.8947266340255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1860773116350174, "acc": 0.9278628826141357, "length": 3.999988555908203, "mode": "train", "epoch": 36}
{"loss": 0.24527879059314728, "acc": 0.9107422232627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.18390223383903503, "acc": 0.9269770979881287, "length": 3.9999711513519287, "mode": "train", "epoch": 37}
{"loss": 0.26182252168655396, "acc": 0.9027343392372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1767306625843048, "acc": 0.9297515153884888, "length": 3.9999747276306152, "mode": "train", "epoch": 38}
{"loss": 0.2414495348930359, "acc": 0.9130858778953552, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1752840131521225, "acc": 0.9330570697784424, "length": 3.9999709129333496, "mode": "train", "epoch": 39}
{"loss": 0.2403164803981781, "acc": 0.9107422232627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.16867229342460632, "acc": 0.9358322620391846, "length": 3.9999983310699463, "mode": "train", "epoch": 40}
{"loss": 0.24268797039985657, "acc": 0.9078125357627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.17240500450134277, "acc": 0.9314636588096619, "length": 3.99997878074646, "mode": "train", "epoch": 41}
{"loss": 0.24236711859703064, "acc": 0.9091796875, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.17398647964000702, "acc": 0.9353598952293396, "length": 3.9999947547912598, "mode": "train", "epoch": 42}
{"loss": 0.2288987934589386, "acc": 0.9191406965255737, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1658102422952652, "acc": 0.9307555556297302, "length": 3.9999899864196777, "mode": "train", "epoch": 43}
{"loss": 0.2780873775482178, "acc": 0.9046874642372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.17447642982006073, "acc": 0.9318742156028748, "length": 3.999418020248413, "mode": "train", "epoch": 44}
{"loss": 0.24874918162822723, "acc": 0.9148436784744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.16837291419506073, "acc": 0.9330576658248901, "length": 3.99999737739563, "mode": "train", "epoch": 45}
{"loss": 0.2740222215652466, "acc": 0.9140624403953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.1708741933107376, "acc": 0.9336481094360352, "length": 3.9999985694885254, "mode": "train", "epoch": 46}
{"loss": 0.23131555318832397, "acc": 0.9167968034744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.17222638428211212, "acc": 0.933529257774353, "length": 3.9999516010284424, "mode": "train", "epoch": 47}
{"loss": 0.2499973475933075, "acc": 0.91015625, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.19334089756011963, "acc": 0.9231408834457397, "length": 3.9991273880004883, "mode": "train", "epoch": 48}
{"loss": 0.25104397535324097, "acc": 0.9072265625, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1795942783355713, "acc": 0.9271433353424072, "length": 3.99867844581604, "mode": "train", "epoch": 49}
{"loss": 0.2513778507709503, "acc": 0.9152345061302185, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.16700886189937592, "acc": 0.9395514726638794, "length": 3.9999983310699463, "mode": "train", "epoch": 50}
{"loss": 0.2540495693683624, "acc": 0.9156250357627869, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.16897882521152496, "acc": 0.9358906745910645, "length": 3.9999403953552246, "mode": "train", "epoch": 51}
{"loss": 0.2466304898262024, "acc": 0.9203125238418579, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.16175469756126404, "acc": 0.9362452030181885, "length": 3.9999516010284424, "mode": "train", "epoch": 52}
{"loss": 0.2191619575023651, "acc": 0.9197264909744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.15730305016040802, "acc": 0.9396104216575623, "length": 3.999992609024048, "mode": "train", "epoch": 53}
{"loss": 0.23234328627586365, "acc": 0.9169921875, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.1606183797121048, "acc": 0.9397280216217041, "length": 3.999943256378174, "mode": "train", "epoch": 54}
{"loss": 0.21621063351631165, "acc": 0.9289060831069946, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.15605446696281433, "acc": 0.9414389729499817, "length": 3.9999547004699707, "mode": "train", "epoch": 55}
{"loss": 0.2254180610179901, "acc": 0.9201172590255737, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.1588115245103836, "acc": 0.9393742084503174, "length": 3.9999947547912598, "mode": "train", "epoch": 56}
{"loss": 0.27969181537628174, "acc": 0.9115234017372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.16176939010620117, "acc": 0.9391968846321106, "length": 3.999983787536621, "mode": "train", "epoch": 57}
{"loss": 0.23117119073867798, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.17024323344230652, "acc": 0.9347108006477356, "length": 3.9999988079071045, "mode": "train", "epoch": 58}
{"loss": 0.2179868519306183, "acc": 0.9250000715255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.16058789193630219, "acc": 0.9388423562049866, "length": 3.9999706745147705, "mode": "train", "epoch": 59}
{"loss": 0.23210105299949646, "acc": 0.9230470061302185, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1601192206144333, "acc": 0.9370718002319336, "length": 3.9999959468841553, "mode": "train", "epoch": 60}
{"loss": 0.2241114377975464, "acc": 0.9171876311302185, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8143548965454102
