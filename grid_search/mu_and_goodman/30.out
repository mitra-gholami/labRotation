ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6894694566726685, "acc": 0.525119960308075, "length": 3.59907603263855, "mode": "train", "epoch": 1}
{"loss": 0.673358678817749, "acc": 0.612500011920929, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.6884588599205017, "acc": 0.5368640422821045, "length": 3.587254762649536, "mode": "train", "epoch": 2}
{"loss": 0.6696829795837402, "acc": 0.5970702767372131, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.6829977035522461, "acc": 0.5486497282981873, "length": 3.6159071922302246, "mode": "train", "epoch": 3}
{"loss": 0.6555388569831848, "acc": 0.6671874523162842, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.6547747850418091, "acc": 0.6236629486083984, "length": 3.77897047996521, "mode": "train", "epoch": 4}
{"loss": 0.6170756220817566, "acc": 0.6937500238418579, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5846828818321228, "acc": 0.729465663433075, "length": 3.918311595916748, "mode": "train", "epoch": 5}
{"loss": 0.5535587668418884, "acc": 0.7509765625, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.5179423689842224, "acc": 0.7678599953651428, "length": 3.970950126647949, "mode": "train", "epoch": 6}
{"loss": 0.4966544508934021, "acc": 0.7720703482627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.47522929310798645, "acc": 0.794888436794281, "length": 3.986837863922119, "mode": "train", "epoch": 7}
{"loss": 0.47539329528808594, "acc": 0.8085936903953552, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.45425909757614136, "acc": 0.814910352230072, "length": 3.987304210662842, "mode": "train", "epoch": 8}
{"loss": 0.4525649845600128, "acc": 0.8117188215255737, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.4155097007751465, "acc": 0.8212643265724182, "length": 3.9918830394744873, "mode": "train", "epoch": 9}
{"loss": 0.44158560037612915, "acc": 0.8189452886581421, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4115990698337555, "acc": 0.8227807283401489, "length": 3.996469497680664, "mode": "train", "epoch": 10}
{"loss": 0.44436824321746826, "acc": 0.8115234375, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4093380868434906, "acc": 0.8248981237411499, "length": 3.9953575134277344, "mode": "train", "epoch": 11}
{"loss": 0.42394202947616577, "acc": 0.8189453482627869, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3950802981853485, "acc": 0.8246657252311707, "length": 3.997636556625366, "mode": "train", "epoch": 12}
{"loss": 0.4069257974624634, "acc": 0.8318358659744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.38280200958251953, "acc": 0.8340869545936584, "length": 3.996610164642334, "mode": "train", "epoch": 13}
{"loss": 0.4021225571632385, "acc": 0.8289061784744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.36556583642959595, "acc": 0.8375957012176514, "length": 3.9980709552764893, "mode": "train", "epoch": 14}
{"loss": 0.38397419452667236, "acc": 0.8449219465255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3669607937335968, "acc": 0.8440888524055481, "length": 3.9986345767974854, "mode": "train", "epoch": 15}
{"loss": 0.37813225388526917, "acc": 0.8464843034744263, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.36028799414634705, "acc": 0.8420097231864929, "length": 3.9995288848876953, "mode": "train", "epoch": 16}
{"loss": 0.37952712178230286, "acc": 0.8519530892372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3541408181190491, "acc": 0.844692051410675, "length": 3.9995460510253906, "mode": "train", "epoch": 17}
{"loss": 0.37355485558509827, "acc": 0.857421875, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.35048380494117737, "acc": 0.8505153059959412, "length": 3.9978673458099365, "mode": "train", "epoch": 18}
{"loss": 0.364316463470459, "acc": 0.8615235090255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.3407549560070038, "acc": 0.8498594760894775, "length": 3.9973268508911133, "mode": "train", "epoch": 19}
{"loss": 0.38784468173980713, "acc": 0.8546875715255737, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.3491378128528595, "acc": 0.8496836423873901, "length": 3.9984312057495117, "mode": "train", "epoch": 20}
{"loss": 0.3520747423171997, "acc": 0.8650389909744263, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3417058289051056, "acc": 0.8501901030540466, "length": 3.996847152709961, "mode": "train", "epoch": 21}
{"loss": 0.35445842146873474, "acc": 0.8546876311302185, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.33532899618148804, "acc": 0.85637366771698, "length": 3.9996869564056396, "mode": "train", "epoch": 22}
{"loss": 0.33615297079086304, "acc": 0.8642578125, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.334208220243454, "acc": 0.8607072234153748, "length": 3.996346950531006, "mode": "train", "epoch": 23}
{"loss": 0.3368738889694214, "acc": 0.8603515625, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3340738117694855, "acc": 0.86054527759552, "length": 3.9995996952056885, "mode": "train", "epoch": 24}
{"loss": 0.33812499046325684, "acc": 0.8533202409744263, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.30767449736595154, "acc": 0.8654347062110901, "length": 3.9999470710754395, "mode": "train", "epoch": 25}
{"loss": 0.3247666656970978, "acc": 0.8667969107627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.31686049699783325, "acc": 0.8690068125724792, "length": 3.999248743057251, "mode": "train", "epoch": 26}
{"loss": 0.3201766014099121, "acc": 0.8642578125, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.30627942085266113, "acc": 0.8714290261268616, "length": 3.9970993995666504, "mode": "train", "epoch": 27}
{"loss": 0.3120967447757721, "acc": 0.8755860328674316, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3077428638935089, "acc": 0.8717510104179382, "length": 3.999894857406616, "mode": "train", "epoch": 28}
{"loss": 0.30533015727996826, "acc": 0.8771485686302185, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2936881184577942, "acc": 0.8725689053535461, "length": 3.9985854625701904, "mode": "train", "epoch": 29}
{"loss": 0.3006591200828552, "acc": 0.8818359375, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2815689146518707, "acc": 0.877518892288208, "length": 3.99829363822937, "mode": "train", "epoch": 30}
{"loss": 0.3035997450351715, "acc": 0.8816404938697815, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.28626275062561035, "acc": 0.8825294375419617, "length": 3.999570846557617, "mode": "train", "epoch": 31}
{"loss": 0.2986714839935303, "acc": 0.8779296278953552, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.27847161889076233, "acc": 0.8801524043083191, "length": 3.9993793964385986, "mode": "train", "epoch": 32}
{"loss": 0.2915287911891937, "acc": 0.8835936188697815, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.2865994870662689, "acc": 0.8807490468025208, "length": 3.9998230934143066, "mode": "train", "epoch": 33}
{"loss": 0.2767719328403473, "acc": 0.8912109732627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.2669574022293091, "acc": 0.8884350061416626, "length": 3.9996414184570312, "mode": "train", "epoch": 34}
{"loss": 0.27907443046569824, "acc": 0.8949218392372131, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.27969953417778015, "acc": 0.8847389221191406, "length": 3.9994704723358154, "mode": "train", "epoch": 35}
{"loss": 0.27064427733421326, "acc": 0.8917969465255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.25450193881988525, "acc": 0.8891506195068359, "length": 3.9995522499084473, "mode": "train", "epoch": 36}
{"loss": 0.26252347230911255, "acc": 0.8976563215255737, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.255288690328598, "acc": 0.8922987580299377, "length": 3.999293565750122, "mode": "train", "epoch": 37}
{"loss": 0.27328890562057495, "acc": 0.8906250596046448, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2691181004047394, "acc": 0.8925480246543884, "length": 3.999831199645996, "mode": "train", "epoch": 38}
{"loss": 0.2562825381755829, "acc": 0.8976563215255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.2707269787788391, "acc": 0.8928819894790649, "length": 3.997559070587158, "mode": "train", "epoch": 39}
{"loss": 0.2630753219127655, "acc": 0.9000000357627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2539113461971283, "acc": 0.8958832025527954, "length": 3.9996726512908936, "mode": "train", "epoch": 40}
{"loss": 0.2569348216056824, "acc": 0.9007812142372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.24949920177459717, "acc": 0.8954663276672363, "length": 3.999539613723755, "mode": "train", "epoch": 41}
{"loss": 0.25783953070640564, "acc": 0.9029297232627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.24530674517154694, "acc": 0.9021968841552734, "length": 3.999728202819824, "mode": "train", "epoch": 42}
{"loss": 0.24644595384597778, "acc": 0.9150390625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.24894653260707855, "acc": 0.9011300206184387, "length": 3.999713182449341, "mode": "train", "epoch": 43}
{"loss": 0.24440057575702667, "acc": 0.9066405892372131, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2656019330024719, "acc": 0.894098699092865, "length": 3.999901056289673, "mode": "train", "epoch": 44}
{"loss": 0.26486608386039734, "acc": 0.8972655534744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.24758687615394592, "acc": 0.8998013138771057, "length": 3.9990124702453613, "mode": "train", "epoch": 45}
{"loss": 0.24721360206604004, "acc": 0.9109373688697815, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.2418825626373291, "acc": 0.9067317247390747, "length": 3.999830961227417, "mode": "train", "epoch": 46}
{"loss": 0.24268659949302673, "acc": 0.9091796875, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.24321816861629486, "acc": 0.9029781818389893, "length": 3.99979305267334, "mode": "train", "epoch": 47}
{"loss": 0.2393370270729065, "acc": 0.9093750715255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.23839549720287323, "acc": 0.9059026837348938, "length": 3.9978857040405273, "mode": "train", "epoch": 48}
{"loss": 0.24239465594291687, "acc": 0.9091796875, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2336546927690506, "acc": 0.9093485474586487, "length": 3.9996848106384277, "mode": "train", "epoch": 49}
{"loss": 0.23882487416267395, "acc": 0.9150390028953552, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.231672003865242, "acc": 0.9117988348007202, "length": 3.999911308288574, "mode": "train", "epoch": 50}
{"loss": 0.23572055995464325, "acc": 0.9091796278953552, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.22390060126781464, "acc": 0.9124414920806885, "length": 3.9964239597320557, "mode": "train", "epoch": 51}
{"loss": 0.22960439324378967, "acc": 0.9142579436302185, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.2307606041431427, "acc": 0.9080443978309631, "length": 3.999936580657959, "mode": "train", "epoch": 52}
{"loss": 0.22968783974647522, "acc": 0.9150391221046448, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.22254575788974762, "acc": 0.9132881164550781, "length": 3.9998672008514404, "mode": "train", "epoch": 53}
{"loss": 0.23199045658111572, "acc": 0.9154297113418579, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.22105680406093597, "acc": 0.9167401790618896, "length": 3.999014377593994, "mode": "train", "epoch": 54}
{"loss": 0.2361741065979004, "acc": 0.9154296517372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.22785554826259613, "acc": 0.9126896262168884, "length": 3.9996726512908936, "mode": "train", "epoch": 55}
{"loss": 0.2314937710762024, "acc": 0.9181641936302185, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.22056427597999573, "acc": 0.9159106612205505, "length": 3.99883770942688, "mode": "train", "epoch": 56}
{"loss": 0.21410343050956726, "acc": 0.9246093034744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.21544016897678375, "acc": 0.9178763628005981, "length": 3.999918222427368, "mode": "train", "epoch": 57}
{"loss": 0.23440328240394592, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.21292464435100555, "acc": 0.9137595891952515, "length": 3.999448299407959, "mode": "train", "epoch": 58}
{"loss": 0.22355152666568756, "acc": 0.9173827171325684, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.21057257056236267, "acc": 0.920678436756134, "length": 3.999957799911499, "mode": "train", "epoch": 59}
{"loss": 0.22114261984825134, "acc": 0.9207030534744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.22315967082977295, "acc": 0.9194257259368896, "length": 3.9999213218688965, "mode": "train", "epoch": 60}
{"loss": 0.235458105802536, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8246874809265137
