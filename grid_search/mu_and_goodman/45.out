ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.99", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.698072612285614, "acc": 0.5022575259208679, "length": 3.3628146648406982, "mode": "train", "epoch": 1}
{"loss": 0.69548100233078, "acc": 0.500195324420929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6865724325180054, "acc": 0.5546772480010986, "length": 2.654367208480835, "mode": "train", "epoch": 2}
{"loss": 0.6635133028030396, "acc": 0.6538787484169006, "length": 2.25390625, "mode": "test", "epoch": 2}
{"loss": 0.6290873885154724, "acc": 0.6690473556518555, "length": 3.2253096103668213, "mode": "train", "epoch": 3}
{"loss": 0.5911087393760681, "acc": 0.69921875, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5654721856117249, "acc": 0.7075092792510986, "length": 3.8536736965179443, "mode": "train", "epoch": 4}
{"loss": 0.546707272529602, "acc": 0.7664062976837158, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5253182053565979, "acc": 0.7601742744445801, "length": 3.947152853012085, "mode": "train", "epoch": 5}
{"loss": 0.5018549561500549, "acc": 0.7888670563697815, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.47818318009376526, "acc": 0.793654203414917, "length": 3.9425203800201416, "mode": "train", "epoch": 6}
{"loss": 0.4666838049888611, "acc": 0.8023437857627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.44370394945144653, "acc": 0.813356339931488, "length": 3.933410882949829, "mode": "train", "epoch": 7}
{"loss": 0.4391595423221588, "acc": 0.826171875, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.4106583595275879, "acc": 0.8212999105453491, "length": 3.9477884769439697, "mode": "train", "epoch": 8}
{"loss": 0.41434627771377563, "acc": 0.8337889313697815, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.38316580653190613, "acc": 0.8321732878684998, "length": 3.980199098587036, "mode": "train", "epoch": 9}
{"loss": 0.38259443640708923, "acc": 0.8357421159744263, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.35801512002944946, "acc": 0.8451157808303833, "length": 3.9891366958618164, "mode": "train", "epoch": 10}
{"loss": 0.3569731116294861, "acc": 0.8587890267372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3324646055698395, "acc": 0.8596320152282715, "length": 3.9894464015960693, "mode": "train", "epoch": 11}
{"loss": 0.3346221446990967, "acc": 0.8662109375, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3081527054309845, "acc": 0.870467483997345, "length": 3.989683151245117, "mode": "train", "epoch": 12}
{"loss": 0.3149108290672302, "acc": 0.8796874284744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2828418016433716, "acc": 0.8827268481254578, "length": 3.9912850856781006, "mode": "train", "epoch": 13}
{"loss": 0.30734574794769287, "acc": 0.8738280534744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2744627296924591, "acc": 0.8868377804756165, "length": 3.996838092803955, "mode": "train", "epoch": 14}
{"loss": 0.27728042006492615, "acc": 0.888671875, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.25864678621292114, "acc": 0.8927643895149231, "length": 3.9966676235198975, "mode": "train", "epoch": 15}
{"loss": 0.27271658182144165, "acc": 0.8927735090255737, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2515052855014801, "acc": 0.8970741629600525, "length": 3.996729612350464, "mode": "train", "epoch": 16}
{"loss": 0.2548324465751648, "acc": 0.904296875, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.24285061657428741, "acc": 0.8995477557182312, "length": 3.9974498748779297, "mode": "train", "epoch": 17}
{"loss": 0.24490144848823547, "acc": 0.9078125357627869, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2437725067138672, "acc": 0.9041247367858887, "length": 3.995361566543579, "mode": "train", "epoch": 18}
{"loss": 0.24532032012939453, "acc": 0.9050780534744263, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.23241308331489563, "acc": 0.9048408269882202, "length": 3.9951183795928955, "mode": "train", "epoch": 19}
{"loss": 0.27381670475006104, "acc": 0.8888673186302185, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.23088648915290833, "acc": 0.9075102210044861, "length": 3.9985814094543457, "mode": "train", "epoch": 20}
{"loss": 0.241439551115036, "acc": 0.9105468392372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.21566875278949738, "acc": 0.9116900563240051, "length": 3.9988489151000977, "mode": "train", "epoch": 21}
{"loss": 0.22421592473983765, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.20553161203861237, "acc": 0.9158467054367065, "length": 3.9980452060699463, "mode": "train", "epoch": 22}
{"loss": 0.2241370975971222, "acc": 0.9126953482627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.19660969078540802, "acc": 0.9221000671386719, "length": 3.998302936553955, "mode": "train", "epoch": 23}
{"loss": 0.2112586796283722, "acc": 0.921875, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.18674078583717346, "acc": 0.9246951937675476, "length": 3.9991135597229004, "mode": "train", "epoch": 24}
{"loss": 0.22679774463176727, "acc": 0.9138670563697815, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.17474524676799774, "acc": 0.9317754507064819, "length": 3.9993443489074707, "mode": "train", "epoch": 25}
{"loss": 0.19002623856067657, "acc": 0.9312500357627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.16347770392894745, "acc": 0.9372849464416504, "length": 3.9994165897369385, "mode": "train", "epoch": 26}
{"loss": 0.17032146453857422, "acc": 0.9361328482627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.161468505859375, "acc": 0.9400426745414734, "length": 3.9980459213256836, "mode": "train", "epoch": 27}
{"loss": 0.18780478835105896, "acc": 0.9380859732627869, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.157088041305542, "acc": 0.9423643946647644, "length": 3.9986796379089355, "mode": "train", "epoch": 28}
{"loss": 0.20072492957115173, "acc": 0.9298828840255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.14584700763225555, "acc": 0.9473587274551392, "length": 3.9991073608398438, "mode": "train", "epoch": 29}
{"loss": 0.1754792332649231, "acc": 0.9382811784744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.13499252498149872, "acc": 0.9505371451377869, "length": 3.9976954460144043, "mode": "train", "epoch": 30}
{"loss": 0.16933806240558624, "acc": 0.9488281607627869, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.13273391127586365, "acc": 0.9505627751350403, "length": 3.997495174407959, "mode": "train", "epoch": 31}
{"loss": 0.1593017876148224, "acc": 0.9509764909744263, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.1352028250694275, "acc": 0.9496425986289978, "length": 3.999610662460327, "mode": "train", "epoch": 32}
{"loss": 0.14617913961410522, "acc": 0.9527344107627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.12907634675502777, "acc": 0.95387864112854, "length": 3.999533176422119, "mode": "train", "epoch": 33}
{"loss": 0.14495383203029633, "acc": 0.9529295563697815, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.12222214788198471, "acc": 0.9554834365844727, "length": 3.998910427093506, "mode": "train", "epoch": 34}
{"loss": 0.17428375780582428, "acc": 0.9464844465255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.11570928245782852, "acc": 0.9580332040786743, "length": 3.998570203781128, "mode": "train", "epoch": 35}
{"loss": 0.13960564136505127, "acc": 0.9556640982627869, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1138659343123436, "acc": 0.956142008304596, "length": 3.999687671661377, "mode": "train", "epoch": 36}
{"loss": 0.14387822151184082, "acc": 0.9560546875, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.11275850981473923, "acc": 0.9596220850944519, "length": 3.9997975826263428, "mode": "train", "epoch": 37}
{"loss": 0.14816786348819733, "acc": 0.9640625715255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.10684654861688614, "acc": 0.9611027836799622, "length": 3.9987809658050537, "mode": "train", "epoch": 38}
{"loss": 0.1556147038936615, "acc": 0.9546875357627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.11248374730348587, "acc": 0.9567833542823792, "length": 3.9998457431793213, "mode": "train", "epoch": 39}
{"loss": 0.15197080373764038, "acc": 0.9603515267372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.11078672111034393, "acc": 0.9624845385551453, "length": 3.9995369911193848, "mode": "train", "epoch": 40}
{"loss": 0.1637745052576065, "acc": 0.9548827409744263, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.10597117990255356, "acc": 0.9633263945579529, "length": 3.9995357990264893, "mode": "train", "epoch": 41}
{"loss": 0.1401515007019043, "acc": 0.9640625715255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.09675879031419754, "acc": 0.9654231071472168, "length": 3.9997315406799316, "mode": "train", "epoch": 42}
{"loss": 0.13115796446800232, "acc": 0.9646483659744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.09054722636938095, "acc": 0.9661732316017151, "length": 3.999645233154297, "mode": "train", "epoch": 43}
{"loss": 0.13285410404205322, "acc": 0.9656249284744263, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.08871691673994064, "acc": 0.9689552783966064, "length": 3.999459981918335, "mode": "train", "epoch": 44}
{"loss": 0.1396460086107254, "acc": 0.958984375, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.08678101003170013, "acc": 0.9683254361152649, "length": 3.9998698234558105, "mode": "train", "epoch": 45}
{"loss": 0.13980239629745483, "acc": 0.9642577767372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.08241204172372818, "acc": 0.9707582592964172, "length": 3.9997785091400146, "mode": "train", "epoch": 46}
{"loss": 0.12983912229537964, "acc": 0.9617186784744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.08255397528409958, "acc": 0.9725024104118347, "length": 3.999891519546509, "mode": "train", "epoch": 47}
{"loss": 0.12016790360212326, "acc": 0.9718750715255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.08008753508329391, "acc": 0.9720959663391113, "length": 3.9998044967651367, "mode": "train", "epoch": 48}
{"loss": 0.1354553997516632, "acc": 0.9685546159744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.07628347724676132, "acc": 0.9727272391319275, "length": 3.999549388885498, "mode": "train", "epoch": 49}
{"loss": 0.14974550902843475, "acc": 0.9646483659744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0747155100107193, "acc": 0.9738879203796387, "length": 3.9998157024383545, "mode": "train", "epoch": 50}
{"loss": 0.12703552842140198, "acc": 0.9677734375, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.07556066662073135, "acc": 0.973896324634552, "length": 3.9999680519104004, "mode": "train", "epoch": 51}
{"loss": 0.12363816052675247, "acc": 0.9681640267372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.07767927646636963, "acc": 0.9735482931137085, "length": 3.9999489784240723, "mode": "train", "epoch": 52}
{"loss": 0.14946475625038147, "acc": 0.9679688215255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07597418129444122, "acc": 0.9737807512283325, "length": 3.9999654293060303, "mode": "train", "epoch": 53}
{"loss": 0.1313524693250656, "acc": 0.9673828482627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07935725152492523, "acc": 0.9720925092697144, "length": 3.998668670654297, "mode": "train", "epoch": 54}
{"loss": 0.13128891587257385, "acc": 0.9648436903953552, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.06948840618133545, "acc": 0.9759265780448914, "length": 3.9999473094940186, "mode": "train", "epoch": 55}
{"loss": 0.11968914419412613, "acc": 0.9724608659744263, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.08002080023288727, "acc": 0.9738378524780273, "length": 3.999922752380371, "mode": "train", "epoch": 56}
{"loss": 0.12919658422470093, "acc": 0.9685545563697815, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.07095049321651459, "acc": 0.9754056930541992, "length": 3.999990940093994, "mode": "train", "epoch": 57}
{"loss": 0.14799970388412476, "acc": 0.9640626311302185, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06226246431469917, "acc": 0.9787681698799133, "length": 3.999925136566162, "mode": "train", "epoch": 58}
{"loss": 0.13134509325027466, "acc": 0.9664062857627869, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.07500360161066055, "acc": 0.9784790873527527, "length": 3.99997615814209, "mode": "train", "epoch": 59}
{"loss": 0.14887666702270508, "acc": 0.9626952409744263, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.06896111369132996, "acc": 0.9788860082626343, "length": 3.9999921321868896, "mode": "train", "epoch": 60}
{"loss": 0.1327899843454361, "acc": 0.9617186784744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8322414755821228
