ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--speaker_hidden_size=256", "--temp_update=0.97", "--temperature=1"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6973772644996643, "acc": 0.5036800503730774, "length": 3.526867389678955, "mode": "train", "epoch": 1}
{"loss": 0.6912827491760254, "acc": 0.49667972326278687, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.689683735370636, "acc": 0.5347364544868469, "length": 3.2579808235168457, "mode": "train", "epoch": 2}
{"loss": 0.6897066831588745, "acc": 0.5466292500495911, "length": 1.0390625, "mode": "test", "epoch": 2}
{"loss": 0.6839823126792908, "acc": 0.5592350363731384, "length": 2.676422357559204, "mode": "train", "epoch": 3}
{"loss": 0.680591881275177, "acc": 0.5988144278526306, "length": 1.33984375, "mode": "test", "epoch": 3}
{"loss": 0.6666494607925415, "acc": 0.6225973963737488, "length": 2.322425127029419, "mode": "train", "epoch": 4}
{"loss": 0.6536614894866943, "acc": 0.6572097539901733, "length": 1.9375, "mode": "test", "epoch": 4}
{"loss": 0.6342138051986694, "acc": 0.6724517345428467, "length": 2.4117844104766846, "mode": "train", "epoch": 5}
{"loss": 0.6250995993614197, "acc": 0.6551604866981506, "length": 2.421875, "mode": "test", "epoch": 5}
{"loss": 0.5956044793128967, "acc": 0.6929829716682434, "length": 2.48770809173584, "mode": "train", "epoch": 6}
{"loss": 0.5866743922233582, "acc": 0.7230163216590881, "length": 2.45703125, "mode": "test", "epoch": 6}
{"loss": 0.5623162984848022, "acc": 0.7153224945068359, "length": 2.6677894592285156, "mode": "train", "epoch": 7}
{"loss": 0.5443801283836365, "acc": 0.7440567016601562, "length": 3.0078125, "mode": "test", "epoch": 7}
{"loss": 0.5157617926597595, "acc": 0.7710984945297241, "length": 3.3387975692749023, "mode": "train", "epoch": 8}
{"loss": 0.4897618889808655, "acc": 0.7774261236190796, "length": 3.97265625, "mode": "test", "epoch": 8}
{"loss": 0.46367910504341125, "acc": 0.7878519296646118, "length": 3.8747758865356445, "mode": "train", "epoch": 9}
{"loss": 0.4692313075065613, "acc": 0.7808594107627869, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4299258887767792, "acc": 0.8065919280052185, "length": 3.915574312210083, "mode": "train", "epoch": 10}
{"loss": 0.4339647591114044, "acc": 0.8068360686302185, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.396424800157547, "acc": 0.8355472683906555, "length": 3.954350709915161, "mode": "train", "epoch": 11}
{"loss": 0.39049482345581055, "acc": 0.8373045921325684, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.360644668340683, "acc": 0.8551130294799805, "length": 3.984703540802002, "mode": "train", "epoch": 12}
{"loss": 0.3737322688102722, "acc": 0.8449219465255737, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.34143540263175964, "acc": 0.8602257966995239, "length": 3.985656499862671, "mode": "train", "epoch": 13}
{"loss": 0.3717358410358429, "acc": 0.8513671159744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.32964640855789185, "acc": 0.8688982129096985, "length": 3.9927313327789307, "mode": "train", "epoch": 14}
{"loss": 0.37044602632522583, "acc": 0.8478516340255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.31815269589424133, "acc": 0.8785005211830139, "length": 3.988501787185669, "mode": "train", "epoch": 15}
{"loss": 0.3646154999732971, "acc": 0.8554686903953552, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3100645840167999, "acc": 0.8757482767105103, "length": 3.9934232234954834, "mode": "train", "epoch": 16}
{"loss": 0.3463778495788574, "acc": 0.8617187142372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.30033057928085327, "acc": 0.880915105342865, "length": 3.994022846221924, "mode": "train", "epoch": 17}
{"loss": 0.337458997964859, "acc": 0.8660154938697815, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2921464741230011, "acc": 0.8869177103042603, "length": 3.9931118488311768, "mode": "train", "epoch": 18}
{"loss": 0.3278380334377289, "acc": 0.8732422590255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.28644731640815735, "acc": 0.8876516222953796, "length": 3.990999937057495, "mode": "train", "epoch": 19}
{"loss": 0.30414658784866333, "acc": 0.8841795921325684, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.2787442207336426, "acc": 0.8966072797775269, "length": 3.998084306716919, "mode": "train", "epoch": 20}
{"loss": 0.30117982625961304, "acc": 0.8841796517372131, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.2671027183532715, "acc": 0.8988012075424194, "length": 3.9976720809936523, "mode": "train", "epoch": 21}
{"loss": 0.29428666830062866, "acc": 0.8820310831069946, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2651551365852356, "acc": 0.8960359692573547, "length": 3.9946887493133545, "mode": "train", "epoch": 22}
{"loss": 0.2794535458087921, "acc": 0.8874999284744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.25409838557243347, "acc": 0.8943304419517517, "length": 3.997097969055176, "mode": "train", "epoch": 23}
{"loss": 0.2787322700023651, "acc": 0.8898438215255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.24519504606723785, "acc": 0.9029995799064636, "length": 3.9963133335113525, "mode": "train", "epoch": 24}
{"loss": 0.2579744756221771, "acc": 0.8947266340255737, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.241705521941185, "acc": 0.9039922952651978, "length": 3.996434450149536, "mode": "train", "epoch": 25}
{"loss": 0.2802474796772003, "acc": 0.896484375, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.235271617770195, "acc": 0.9037318229675293, "length": 3.9967641830444336, "mode": "train", "epoch": 26}
{"loss": 0.2560192346572876, "acc": 0.9054688215255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.23225347697734833, "acc": 0.9085203409194946, "length": 3.9996354579925537, "mode": "train", "epoch": 27}
{"loss": 0.2472010850906372, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23073630034923553, "acc": 0.9068379998207092, "length": 3.999575138092041, "mode": "train", "epoch": 28}
{"loss": 0.24417316913604736, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.2227342426776886, "acc": 0.9106072783470154, "length": 3.9993793964385986, "mode": "train", "epoch": 29}
{"loss": 0.22998987138271332, "acc": 0.9050780534744263, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.21657487750053406, "acc": 0.9116528630256653, "length": 3.999645233154297, "mode": "train", "epoch": 30}
{"loss": 0.23783031105995178, "acc": 0.912109375, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.20975162088871002, "acc": 0.9177974462509155, "length": 3.9996306896209717, "mode": "train", "epoch": 31}
{"loss": 0.2225116640329361, "acc": 0.9212890863418579, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.20658458769321442, "acc": 0.9210472106933594, "length": 3.999504804611206, "mode": "train", "epoch": 32}
{"loss": 0.2140551209449768, "acc": 0.9234375357627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.20129847526550293, "acc": 0.9238879084587097, "length": 3.9995107650756836, "mode": "train", "epoch": 33}
{"loss": 0.22450566291809082, "acc": 0.9138670563697815, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.20040927827358246, "acc": 0.9239864945411682, "length": 3.9967498779296875, "mode": "train", "epoch": 34}
{"loss": 0.22863095998764038, "acc": 0.9166015982627869, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.19620177149772644, "acc": 0.9278948903083801, "length": 3.999692916870117, "mode": "train", "epoch": 35}
{"loss": 0.2282085120677948, "acc": 0.9179688096046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.1942436397075653, "acc": 0.9276078343391418, "length": 3.999866008758545, "mode": "train", "epoch": 36}
{"loss": 0.20404206216335297, "acc": 0.9222655892372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.18599022924900055, "acc": 0.9326815009117126, "length": 3.997572183609009, "mode": "train", "epoch": 37}
{"loss": 0.21564854681491852, "acc": 0.9177733659744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.18524698913097382, "acc": 0.9334965348243713, "length": 3.997819423675537, "mode": "train", "epoch": 38}
{"loss": 0.2170998454093933, "acc": 0.9128904938697815, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.17970721423625946, "acc": 0.9365991353988647, "length": 3.9999094009399414, "mode": "train", "epoch": 39}
{"loss": 0.2134515345096588, "acc": 0.9218749403953552, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.17782413959503174, "acc": 0.9346833229064941, "length": 3.9998579025268555, "mode": "train", "epoch": 40}
{"loss": 0.20796191692352295, "acc": 0.9271484017372131, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.17858800292015076, "acc": 0.9394851922988892, "length": 3.9991488456726074, "mode": "train", "epoch": 41}
{"loss": 0.22042793035507202, "acc": 0.9294920563697815, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1733054369688034, "acc": 0.9346851110458374, "length": 3.99990177154541, "mode": "train", "epoch": 42}
{"loss": 0.20544278621673584, "acc": 0.9300780296325684, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.17113874852657318, "acc": 0.9362401366233826, "length": 3.9992454051971436, "mode": "train", "epoch": 43}
{"loss": 0.20870937407016754, "acc": 0.9265624284744263, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.16925546526908875, "acc": 0.9393113255500793, "length": 3.9989757537841797, "mode": "train", "epoch": 44}
{"loss": 0.19990821182727814, "acc": 0.9378905892372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.16886986792087555, "acc": 0.9414724707603455, "length": 3.9999632835388184, "mode": "train", "epoch": 45}
{"loss": 0.214974045753479, "acc": 0.9277343153953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.16486850380897522, "acc": 0.9404284358024597, "length": 3.9999499320983887, "mode": "train", "epoch": 46}
{"loss": 0.19727075099945068, "acc": 0.9365234971046448, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1644870936870575, "acc": 0.9416636228561401, "length": 3.998915910720825, "mode": "train", "epoch": 47}
{"loss": 0.2157171368598938, "acc": 0.9374999403953552, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.1569419950246811, "acc": 0.9464564323425293, "length": 3.9996793270111084, "mode": "train", "epoch": 48}
{"loss": 0.21097029745578766, "acc": 0.9371094703674316, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.15347592532634735, "acc": 0.9461701512336731, "length": 3.99992299079895, "mode": "train", "epoch": 49}
{"loss": 0.21595075726509094, "acc": 0.9380859732627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.15453438460826874, "acc": 0.9444300532341003, "length": 3.999932289123535, "mode": "train", "epoch": 50}
{"loss": 0.194129079580307, "acc": 0.9373045563697815, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.15423047542572021, "acc": 0.9488887190818787, "length": 3.999502420425415, "mode": "train", "epoch": 51}
{"loss": 0.22421610355377197, "acc": 0.9382811784744263, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1507939100265503, "acc": 0.9460552334785461, "length": 3.999979019165039, "mode": "train", "epoch": 52}
{"loss": 0.21553760766983032, "acc": 0.9353514909744263, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.15786612033843994, "acc": 0.9449520707130432, "length": 3.9999632835388184, "mode": "train", "epoch": 53}
{"loss": 0.21050766110420227, "acc": 0.9353514909744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15040412545204163, "acc": 0.9494696855545044, "length": 3.9998300075531006, "mode": "train", "epoch": 54}
{"loss": 0.19621098041534424, "acc": 0.9335936903953552, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.15189878642559052, "acc": 0.9474998712539673, "length": 3.999767303466797, "mode": "train", "epoch": 55}
{"loss": 0.20820212364196777, "acc": 0.9345702528953552, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.14494426548480988, "acc": 0.9484332799911499, "length": 3.9999749660491943, "mode": "train", "epoch": 56}
{"loss": 0.21156653761863708, "acc": 0.9357423186302185, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.14827513694763184, "acc": 0.949476420879364, "length": 3.99994158744812, "mode": "train", "epoch": 57}
{"loss": 0.20595581829547882, "acc": 0.9404296278953552, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.14335308969020844, "acc": 0.947446882724762, "length": 3.9999537467956543, "mode": "train", "epoch": 58}
{"loss": 0.21348753571510315, "acc": 0.9396485090255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.14120779931545258, "acc": 0.9506924152374268, "length": 3.9998490810394287, "mode": "train", "epoch": 59}
{"loss": 0.1889910101890564, "acc": 0.9447265267372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14134174585342407, "acc": 0.9524339437484741, "length": 3.9999568462371826, "mode": "train", "epoch": 60}
{"loss": 0.19184604287147522, "acc": 0.9431639313697815, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8282757997512817
