ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6986275911331177, "acc": 0.49948346614837646, "length": 3.516371965408325, "mode": "train", "epoch": 1}
{"loss": 0.6930824518203735, "acc": 0.5092926025390625, "length": 1.03125, "mode": "test", "epoch": 1}
{"loss": 0.6895591616630554, "acc": 0.532650887966156, "length": 3.1755199432373047, "mode": "train", "epoch": 2}
{"loss": 0.6617392897605896, "acc": 0.6382569074630737, "length": 2.96875, "mode": "test", "epoch": 2}
{"loss": 0.6291584372520447, "acc": 0.6774078011512756, "length": 3.622319459915161, "mode": "train", "epoch": 3}
{"loss": 0.580921471118927, "acc": 0.7234374284744263, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.563255250453949, "acc": 0.7130134701728821, "length": 3.939277410507202, "mode": "train", "epoch": 4}
{"loss": 0.5560813546180725, "acc": 0.7357421517372131, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5314764380455017, "acc": 0.7433908581733704, "length": 3.9549007415771484, "mode": "train", "epoch": 5}
{"loss": 0.5201579928398132, "acc": 0.7628907561302185, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.47751909494400024, "acc": 0.7892844676971436, "length": 3.968283176422119, "mode": "train", "epoch": 6}
{"loss": 0.48624318838119507, "acc": 0.7910155653953552, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4315202832221985, "acc": 0.8113937973976135, "length": 3.9828481674194336, "mode": "train", "epoch": 7}
{"loss": 0.4394947290420532, "acc": 0.8179687857627869, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.38796117901802063, "acc": 0.8340872526168823, "length": 3.992234468460083, "mode": "train", "epoch": 8}
{"loss": 0.41796165704727173, "acc": 0.8154296875, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.36670130491256714, "acc": 0.8419144749641418, "length": 3.995265007019043, "mode": "train", "epoch": 9}
{"loss": 0.41069117188453674, "acc": 0.8298827409744263, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.344625324010849, "acc": 0.8552432060241699, "length": 3.9949886798858643, "mode": "train", "epoch": 10}
{"loss": 0.39951732754707336, "acc": 0.8298827409744263, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.34028783440589905, "acc": 0.8604720830917358, "length": 3.9965083599090576, "mode": "train", "epoch": 11}
{"loss": 0.39057016372680664, "acc": 0.8445311784744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3287026286125183, "acc": 0.8600246906280518, "length": 3.997441291809082, "mode": "train", "epoch": 12}
{"loss": 0.38433587551116943, "acc": 0.8408203125, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.32354220747947693, "acc": 0.8690732717514038, "length": 3.998816728591919, "mode": "train", "epoch": 13}
{"loss": 0.359671026468277, "acc": 0.8531250357627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3094231188297272, "acc": 0.8720833659172058, "length": 3.998248815536499, "mode": "train", "epoch": 14}
{"loss": 0.36796998977661133, "acc": 0.8414062857627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3008461594581604, "acc": 0.8793922662734985, "length": 3.998685598373413, "mode": "train", "epoch": 15}
{"loss": 0.3474888205528259, "acc": 0.8574218153953552, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.29030027985572815, "acc": 0.8825897574424744, "length": 3.999217987060547, "mode": "train", "epoch": 16}
{"loss": 0.34183719754219055, "acc": 0.8576172590255737, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2834492027759552, "acc": 0.8832846879959106, "length": 3.9992690086364746, "mode": "train", "epoch": 17}
{"loss": 0.33622312545776367, "acc": 0.8552733659744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.27690330147743225, "acc": 0.8861232399940491, "length": 3.9969027042388916, "mode": "train", "epoch": 18}
{"loss": 0.3205733001232147, "acc": 0.8623046875, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2641085088253021, "acc": 0.892734706401825, "length": 3.9989497661590576, "mode": "train", "epoch": 19}
{"loss": 0.3040712773799896, "acc": 0.87109375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.24880842864513397, "acc": 0.8992037773132324, "length": 3.9981188774108887, "mode": "train", "epoch": 20}
{"loss": 0.2905656099319458, "acc": 0.8833984732627869, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.24439737200737, "acc": 0.9032961130142212, "length": 3.999528408050537, "mode": "train", "epoch": 21}
{"loss": 0.2725609540939331, "acc": 0.8898438811302185, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.23502574861049652, "acc": 0.9077596068382263, "length": 3.999460458755493, "mode": "train", "epoch": 22}
{"loss": 0.2744598984718323, "acc": 0.8855468034744263, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.23090775310993195, "acc": 0.9055454134941101, "length": 3.998854637145996, "mode": "train", "epoch": 23}
{"loss": 0.25992217659950256, "acc": 0.8937500715255737, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.2232152372598648, "acc": 0.9100657105445862, "length": 3.9986212253570557, "mode": "train", "epoch": 24}
{"loss": 0.2693329453468323, "acc": 0.888671875, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2217043936252594, "acc": 0.9117984771728516, "length": 3.9981913566589355, "mode": "train", "epoch": 25}
{"loss": 0.23740190267562866, "acc": 0.8990234732627869, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.21167027950286865, "acc": 0.9163447618484497, "length": 3.9992451667785645, "mode": "train", "epoch": 26}
{"loss": 0.2338857501745224, "acc": 0.9027343392372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.20892898738384247, "acc": 0.9157002568244934, "length": 3.996891498565674, "mode": "train", "epoch": 27}
{"loss": 0.2469637393951416, "acc": 0.9033203721046448, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.20215414464473724, "acc": 0.9197564721107483, "length": 3.99939227104187, "mode": "train", "epoch": 28}
{"loss": 0.2285231649875641, "acc": 0.9107422232627869, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.19367817044258118, "acc": 0.9236528873443604, "length": 3.999589204788208, "mode": "train", "epoch": 29}
{"loss": 0.22131597995758057, "acc": 0.9134765267372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.19535239040851593, "acc": 0.9236652851104736, "length": 3.9999756813049316, "mode": "train", "epoch": 30}
{"loss": 0.22167663276195526, "acc": 0.9037109017372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.19313488900661469, "acc": 0.9260419011116028, "length": 3.999922513961792, "mode": "train", "epoch": 31}
{"loss": 0.22070027887821198, "acc": 0.9083985090255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.19372519850730896, "acc": 0.9231408834457397, "length": 3.999891519546509, "mode": "train", "epoch": 32}
{"loss": 0.21341267228126526, "acc": 0.9115233421325684, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.19203303754329681, "acc": 0.9261595010757446, "length": 3.999985933303833, "mode": "train", "epoch": 33}
{"loss": 0.21167154610157013, "acc": 0.9144530296325684, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1836453676223755, "acc": 0.9278379678726196, "length": 3.9998815059661865, "mode": "train", "epoch": 34}
{"loss": 0.2261137068271637, "acc": 0.9080077409744263, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1891416609287262, "acc": 0.9272534847259521, "length": 3.99981427192688, "mode": "train", "epoch": 35}
{"loss": 0.21414169669151306, "acc": 0.9121094346046448, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.18171142041683197, "acc": 0.9280648231506348, "length": 3.999371290206909, "mode": "train", "epoch": 36}
{"loss": 0.21645385026931763, "acc": 0.9121093153953552, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.18152911961078644, "acc": 0.9282477498054504, "length": 3.999980926513672, "mode": "train", "epoch": 37}
{"loss": 0.22356756031513214, "acc": 0.9087890982627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.18166424334049225, "acc": 0.9287056922912598, "length": 3.9997239112854004, "mode": "train", "epoch": 38}
{"loss": 0.21754759550094604, "acc": 0.9123047590255737, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.17624099552631378, "acc": 0.9291049242019653, "length": 3.999701499938965, "mode": "train", "epoch": 39}
{"loss": 0.2097173035144806, "acc": 0.9126953482627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.17947927117347717, "acc": 0.9262171387672424, "length": 3.9999656677246094, "mode": "train", "epoch": 40}
{"loss": 0.20628854632377625, "acc": 0.9158202409744263, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.17713625729084015, "acc": 0.9275521039962769, "length": 3.999995470046997, "mode": "train", "epoch": 41}
{"loss": 0.21964704990386963, "acc": 0.9140625, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.17625093460083008, "acc": 0.9282481670379639, "length": 3.9999964237213135, "mode": "train", "epoch": 42}
{"loss": 0.2354225069284439, "acc": 0.9097656607627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.17891176044940948, "acc": 0.9313158988952637, "length": 3.999885082244873, "mode": "train", "epoch": 43}
{"loss": 0.2246485948562622, "acc": 0.9068360328674316, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.18052230775356293, "acc": 0.9262181520462036, "length": 3.9999969005584717, "mode": "train", "epoch": 44}
{"loss": 0.22255295515060425, "acc": 0.9140625596046448, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.17619459331035614, "acc": 0.9327141642570496, "length": 3.9999845027923584, "mode": "train", "epoch": 45}
{"loss": 0.23577052354812622, "acc": 0.9097656607627869, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.17391693592071533, "acc": 0.9299882650375366, "length": 3.999995708465576, "mode": "train", "epoch": 46}
{"loss": 0.20083364844322205, "acc": 0.9123047590255737, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.16768208146095276, "acc": 0.9302657246589661, "length": 3.9996204376220703, "mode": "train", "epoch": 47}
{"loss": 0.22119435667991638, "acc": 0.91015625, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.16390620172023773, "acc": 0.9312057495117188, "length": 3.9999687671661377, "mode": "train", "epoch": 48}
{"loss": 0.20889917016029358, "acc": 0.9117187857627869, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1702144891023636, "acc": 0.9292340278625488, "length": 3.9999918937683105, "mode": "train", "epoch": 49}
{"loss": 0.21758408844470978, "acc": 0.9119139909744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.16665507853031158, "acc": 0.9320732355117798, "length": 3.9998629093170166, "mode": "train", "epoch": 50}
{"loss": 0.2097582072019577, "acc": 0.9156249761581421, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.16827301681041718, "acc": 0.9299874305725098, "length": 3.9999561309814453, "mode": "train", "epoch": 51}
{"loss": 0.21167631447315216, "acc": 0.9115234017372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.16116319596767426, "acc": 0.9353246092796326, "length": 3.999988317489624, "mode": "train", "epoch": 52}
{"loss": 0.22413456439971924, "acc": 0.9113281965255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1602860689163208, "acc": 0.9350839257240295, "length": 3.99969744682312, "mode": "train", "epoch": 53}
{"loss": 0.2286132574081421, "acc": 0.9142578840255737, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.15597043931484222, "acc": 0.9341062903404236, "length": 3.9999802112579346, "mode": "train", "epoch": 54}
{"loss": 0.23333661258220673, "acc": 0.9119139909744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.15845130383968353, "acc": 0.9360207319259644, "length": 3.999995470046997, "mode": "train", "epoch": 55}
{"loss": 0.2121153175830841, "acc": 0.9117187261581421, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.15487822890281677, "acc": 0.9371797442436218, "length": 3.999971389770508, "mode": "train", "epoch": 56}
{"loss": 0.2103574275970459, "acc": 0.9175782203674316, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.15123403072357178, "acc": 0.9395012259483337, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.1935233771800995, "acc": 0.9082030653953552, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.14737197756767273, "acc": 0.9381089210510254, "length": 3.9999966621398926, "mode": "train", "epoch": 58}
{"loss": 0.21386228501796722, "acc": 0.912109375, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15542292594909668, "acc": 0.9356147050857544, "length": 3.999995231628418, "mode": "train", "epoch": 59}
{"loss": 0.22405454516410828, "acc": 0.9169921875, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.15317973494529724, "acc": 0.936598539352417, "length": 3.9999561309814453, "mode": "train", "epoch": 60}
{"loss": 0.2028408646583557, "acc": 0.9123047590255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8474138379096985
