ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7064486742019653, "acc": 0.4727577865123749, "length": 3.543795347213745, "mode": "train", "epoch": 1}
{"loss": 0.6941454410552979, "acc": 0.49453118443489075, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6939163208007812, "acc": 0.5199781060218811, "length": 3.5004076957702637, "mode": "train", "epoch": 2}
{"loss": 0.6894332766532898, "acc": 0.534625232219696, "length": 1.19921875, "mode": "test", "epoch": 2}
{"loss": 0.6936348676681519, "acc": 0.5262356996536255, "length": 3.4610743522644043, "mode": "train", "epoch": 3}
{"loss": 0.6910492181777954, "acc": 0.5311385989189148, "length": 1.08203125, "mode": "test", "epoch": 3}
{"loss": 0.6907655000686646, "acc": 0.5396085381507874, "length": 3.3966598510742188, "mode": "train", "epoch": 4}
{"loss": 0.6792532205581665, "acc": 0.5911041498184204, "length": 1.55078125, "mode": "test", "epoch": 4}
{"loss": 0.6882163882255554, "acc": 0.5499493479728699, "length": 3.2982702255249023, "mode": "train", "epoch": 5}
{"loss": 0.6681981682777405, "acc": 0.6289627552032471, "length": 2.1015625, "mode": "test", "epoch": 5}
{"loss": 0.6827071309089661, "acc": 0.572750985622406, "length": 3.2132115364074707, "mode": "train", "epoch": 6}
{"loss": 0.658568263053894, "acc": 0.6546204090118408, "length": 2.453125, "mode": "test", "epoch": 6}
{"loss": 0.6693595051765442, "acc": 0.6224762797355652, "length": 3.166624069213867, "mode": "train", "epoch": 7}
{"loss": 0.6378502249717712, "acc": 0.682533323764801, "length": 2.76953125, "mode": "test", "epoch": 7}
{"loss": 0.6441327333450317, "acc": 0.6891322135925293, "length": 3.188986301422119, "mode": "train", "epoch": 8}
{"loss": 0.6088429689407349, "acc": 0.7422134280204773, "length": 3.015625, "mode": "test", "epoch": 8}
{"loss": 0.6012266874313354, "acc": 0.7519161701202393, "length": 3.3581795692443848, "mode": "train", "epoch": 9}
{"loss": 0.559049665927887, "acc": 0.7770705819129944, "length": 3.5703125, "mode": "test", "epoch": 9}
{"loss": 0.5403188467025757, "acc": 0.7756453156471252, "length": 3.56703519821167, "mode": "train", "epoch": 10}
{"loss": 0.5091478824615479, "acc": 0.7806640267372131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.48162513971328735, "acc": 0.7895641922950745, "length": 3.757371664047241, "mode": "train", "epoch": 11}
{"loss": 0.48662135004997253, "acc": 0.7703124284744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4474887549877167, "acc": 0.7934462428092957, "length": 3.8491241931915283, "mode": "train", "epoch": 12}
{"loss": 0.48678237199783325, "acc": 0.7718749642372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4345236122608185, "acc": 0.7963926792144775, "length": 3.9042487144470215, "mode": "train", "epoch": 13}
{"loss": 0.49156326055526733, "acc": 0.7734374403953552, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.42700400948524475, "acc": 0.801730751991272, "length": 3.932105779647827, "mode": "train", "epoch": 14}
{"loss": 0.4983741044998169, "acc": 0.765625, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.4181849956512451, "acc": 0.8100396990776062, "length": 3.940558433532715, "mode": "train", "epoch": 15}
{"loss": 0.49171245098114014, "acc": 0.7730469107627869, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.4103018343448639, "acc": 0.8107543587684631, "length": 3.9480810165405273, "mode": "train", "epoch": 16}
{"loss": 0.5057230591773987, "acc": 0.7623047232627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.40412434935569763, "acc": 0.8143476247787476, "length": 3.9500958919525146, "mode": "train", "epoch": 17}
{"loss": 0.5037916898727417, "acc": 0.7673828601837158, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.39967188239097595, "acc": 0.8177055716514587, "length": 3.962301731109619, "mode": "train", "epoch": 18}
{"loss": 0.5035552978515625, "acc": 0.7828125357627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.38982337713241577, "acc": 0.828855574131012, "length": 3.9681313037872314, "mode": "train", "epoch": 19}
{"loss": 0.5001425743103027, "acc": 0.7919922471046448, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.38705888390541077, "acc": 0.8323307633399963, "length": 3.9668376445770264, "mode": "train", "epoch": 20}
{"loss": 0.5040735006332397, "acc": 0.7927734851837158, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.3830600082874298, "acc": 0.8403631448745728, "length": 3.9691355228424072, "mode": "train", "epoch": 21}
{"loss": 0.5053993463516235, "acc": 0.7923827767372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.3805830776691437, "acc": 0.8421804904937744, "length": 3.9709901809692383, "mode": "train", "epoch": 22}
{"loss": 0.5004544854164124, "acc": 0.7972655892372131, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.37495213747024536, "acc": 0.8446223735809326, "length": 3.976336717605591, "mode": "train", "epoch": 23}
{"loss": 0.5053392052650452, "acc": 0.791015625, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.3715691566467285, "acc": 0.842625617980957, "length": 3.978245258331299, "mode": "train", "epoch": 24}
{"loss": 0.5002461671829224, "acc": 0.7990233898162842, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.3649050295352936, "acc": 0.848476767539978, "length": 3.9817588329315186, "mode": "train", "epoch": 25}
{"loss": 0.5150296688079834, "acc": 0.7931641936302185, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.36687371134757996, "acc": 0.847048282623291, "length": 3.981095314025879, "mode": "train", "epoch": 26}
{"loss": 0.4858802556991577, "acc": 0.8027343153953552, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.3593485355377197, "acc": 0.8455154299736023, "length": 3.9845571517944336, "mode": "train", "epoch": 27}
{"loss": 0.48790138959884644, "acc": 0.8039063215255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.3513946235179901, "acc": 0.8475329279899597, "length": 3.98449444770813, "mode": "train", "epoch": 28}
{"loss": 0.48156434297561646, "acc": 0.8054686188697815, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.3491753935813904, "acc": 0.8489678502082825, "length": 3.985975503921509, "mode": "train", "epoch": 29}
{"loss": 0.4961608648300171, "acc": 0.7996094226837158, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.34543731808662415, "acc": 0.8514543175697327, "length": 3.98561429977417, "mode": "train", "epoch": 30}
{"loss": 0.4800013303756714, "acc": 0.8052735328674316, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.34017446637153625, "acc": 0.8509211540222168, "length": 3.9887866973876953, "mode": "train", "epoch": 31}
{"loss": 0.4950104355812073, "acc": 0.8033203482627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.3372206389904022, "acc": 0.8508593440055847, "length": 3.9879677295684814, "mode": "train", "epoch": 32}
{"loss": 0.442777544260025, "acc": 0.8142576813697815, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.3298519253730774, "acc": 0.8567900061607361, "length": 3.9901514053344727, "mode": "train", "epoch": 33}
{"loss": 0.4611659646034241, "acc": 0.8208984732627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.32668691873550415, "acc": 0.8569309711456299, "length": 3.991403102874756, "mode": "train", "epoch": 34}
{"loss": 0.442878782749176, "acc": 0.8273438811302185, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.31557801365852356, "acc": 0.8590760231018066, "length": 3.9918742179870605, "mode": "train", "epoch": 35}
{"loss": 0.43768227100372314, "acc": 0.8308593034744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.3094233572483063, "acc": 0.8672224283218384, "length": 3.9915170669555664, "mode": "train", "epoch": 36}
{"loss": 0.426794171333313, "acc": 0.8292969465255737, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.3007662296295166, "acc": 0.8721305131912231, "length": 3.992661714553833, "mode": "train", "epoch": 37}
{"loss": 0.4040263295173645, "acc": 0.8392578363418579, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.29361772537231445, "acc": 0.876150906085968, "length": 3.993785858154297, "mode": "train", "epoch": 38}
{"loss": 0.39310646057128906, "acc": 0.8490234017372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.286460816860199, "acc": 0.8824328184127808, "length": 3.994833469390869, "mode": "train", "epoch": 39}
{"loss": 0.3866989016532898, "acc": 0.8484373688697815, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2804951071739197, "acc": 0.8841658234596252, "length": 3.9950058460235596, "mode": "train", "epoch": 40}
{"loss": 0.37607142329216003, "acc": 0.8564452528953552, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.2741396427154541, "acc": 0.8861242532730103, "length": 3.9956166744232178, "mode": "train", "epoch": 41}
{"loss": 0.3460965156555176, "acc": 0.8666015267372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.265280157327652, "acc": 0.8918083906173706, "length": 3.9953486919403076, "mode": "train", "epoch": 42}
{"loss": 0.36504656076431274, "acc": 0.8675780892372131, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.26716524362564087, "acc": 0.886705219745636, "length": 3.9957218170166016, "mode": "train", "epoch": 43}
{"loss": 0.34947577118873596, "acc": 0.8701171875, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.2622626721858978, "acc": 0.8940743207931519, "length": 3.9967963695526123, "mode": "train", "epoch": 44}
{"loss": 0.34321779012680054, "acc": 0.8683594465255737, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.25314053893089294, "acc": 0.8952250480651855, "length": 3.9971659183502197, "mode": "train", "epoch": 45}
{"loss": 0.3375227153301239, "acc": 0.8740233778953552, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.25083127617836, "acc": 0.8957937955856323, "length": 3.995544195175171, "mode": "train", "epoch": 46}
{"loss": 0.33931201696395874, "acc": 0.8716797232627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.2483687698841095, "acc": 0.8997736573219299, "length": 3.997224807739258, "mode": "train", "epoch": 47}
{"loss": 0.3240840435028076, "acc": 0.8750000596046448, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.23948301374912262, "acc": 0.9009321928024292, "length": 3.997685194015503, "mode": "train", "epoch": 48}
{"loss": 0.32423830032348633, "acc": 0.8828124403953552, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.2335059642791748, "acc": 0.9086302518844604, "length": 3.997026205062866, "mode": "train", "epoch": 49}
{"loss": 0.31126129627227783, "acc": 0.8845701813697815, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.22969773411750793, "acc": 0.9056980013847351, "length": 3.9973580837249756, "mode": "train", "epoch": 50}
{"loss": 0.31010913848876953, "acc": 0.8808594346046448, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.22859860956668854, "acc": 0.9052547812461853, "length": 3.9979612827301025, "mode": "train", "epoch": 51}
{"loss": 0.29533934593200684, "acc": 0.8902344107627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.22540907561779022, "acc": 0.9078458547592163, "length": 3.998371124267578, "mode": "train", "epoch": 52}
{"loss": 0.3038710653781891, "acc": 0.8843750357627869, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.21692225337028503, "acc": 0.9103662371635437, "length": 3.997959852218628, "mode": "train", "epoch": 53}
{"loss": 0.2920142710208893, "acc": 0.8859375715255737, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.21469369530677795, "acc": 0.9130867719650269, "length": 3.9985263347625732, "mode": "train", "epoch": 54}
{"loss": 0.28024423122406006, "acc": 0.8865233063697815, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.21541620790958405, "acc": 0.9129074215888977, "length": 3.998349905014038, "mode": "train", "epoch": 55}
{"loss": 0.28162309527397156, "acc": 0.8880859017372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.2113712877035141, "acc": 0.9122851490974426, "length": 3.9987354278564453, "mode": "train", "epoch": 56}
{"loss": 0.27846360206604004, "acc": 0.8927732706069946, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.20661719143390656, "acc": 0.9147072434425354, "length": 3.9990673065185547, "mode": "train", "epoch": 57}
{"loss": 0.29217344522476196, "acc": 0.8917969465255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.20172324776649475, "acc": 0.9151619076728821, "length": 3.998765707015991, "mode": "train", "epoch": 58}
{"loss": 0.2650422751903534, "acc": 0.8957032561302185, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.19556856155395508, "acc": 0.9177242517471313, "length": 3.9982457160949707, "mode": "train", "epoch": 59}
{"loss": 0.25440913438796997, "acc": 0.900390625, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.19882024824619293, "acc": 0.9181010127067566, "length": 3.9991321563720703, "mode": "train", "epoch": 60}
{"loss": 0.2553118169307709, "acc": 0.9025391936302185, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8001786470413208
