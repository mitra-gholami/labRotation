ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6955831050872803, "acc": 0.5064876079559326, "length": 3.4964003562927246, "mode": "train", "epoch": 1}
{"loss": 0.6905628442764282, "acc": 0.5155273675918579, "length": 1.09375, "mode": "test", "epoch": 1}
{"loss": 0.6885040402412415, "acc": 0.5471991896629333, "length": 3.2001278400421143, "mode": "train", "epoch": 2}
{"loss": 0.6655987501144409, "acc": 0.6615051031112671, "length": 2.23046875, "mode": "test", "epoch": 2}
{"loss": 0.642676830291748, "acc": 0.6876100897789001, "length": 2.9827587604522705, "mode": "train", "epoch": 3}
{"loss": 0.5886136293411255, "acc": 0.7465943098068237, "length": 2.69140625, "mode": "test", "epoch": 3}
{"loss": 0.5413472056388855, "acc": 0.7382059693336487, "length": 3.0921640396118164, "mode": "train", "epoch": 4}
{"loss": 0.5275081396102905, "acc": 0.7756224870681763, "length": 3.1171875, "mode": "test", "epoch": 4}
{"loss": 0.47255492210388184, "acc": 0.7903789281845093, "length": 3.290825128555298, "mode": "train", "epoch": 5}
{"loss": 0.479660302400589, "acc": 0.7896179556846619, "length": 3.45703125, "mode": "test", "epoch": 5}
{"loss": 0.4032512903213501, "acc": 0.8119580149650574, "length": 3.590568780899048, "mode": "train", "epoch": 6}
{"loss": 0.435870498418808, "acc": 0.8076110482215881, "length": 3.85546875, "mode": "test", "epoch": 6}
{"loss": 0.3564433455467224, "acc": 0.8441413640975952, "length": 3.7574150562286377, "mode": "train", "epoch": 7}
{"loss": 0.4080581068992615, "acc": 0.8207030892372131, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.32335013151168823, "acc": 0.8631028532981873, "length": 3.9000747203826904, "mode": "train", "epoch": 8}
{"loss": 0.38640835881233215, "acc": 0.8443359732627869, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.30464860796928406, "acc": 0.8713976144790649, "length": 3.93806791305542, "mode": "train", "epoch": 9}
{"loss": 0.37623873353004456, "acc": 0.8523436784744263, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.29096683859825134, "acc": 0.8819727301597595, "length": 3.9462077617645264, "mode": "train", "epoch": 10}
{"loss": 0.36999574303627014, "acc": 0.84765625, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2737835943698883, "acc": 0.8897284269332886, "length": 3.9606404304504395, "mode": "train", "epoch": 11}
{"loss": 0.3509085178375244, "acc": 0.8499999642372131, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2532432973384857, "acc": 0.8969685435295105, "length": 3.9645118713378906, "mode": "train", "epoch": 12}
{"loss": 0.36088085174560547, "acc": 0.8499999642372131, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.24051617085933685, "acc": 0.9064226746559143, "length": 3.9655308723449707, "mode": "train", "epoch": 13}
{"loss": 0.34396904706954956, "acc": 0.8617186546325684, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.22468803822994232, "acc": 0.9101206064224243, "length": 3.968413829803467, "mode": "train", "epoch": 14}
{"loss": 0.3362821936607361, "acc": 0.8695312142372131, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.21663644909858704, "acc": 0.9146941900253296, "length": 3.974493980407715, "mode": "train", "epoch": 15}
{"loss": 0.3216993510723114, "acc": 0.8673829436302185, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.19889947772026062, "acc": 0.9227443337440491, "length": 3.978419303894043, "mode": "train", "epoch": 16}
{"loss": 0.3272552788257599, "acc": 0.87109375, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.19263887405395508, "acc": 0.9234004020690918, "length": 3.9798877239227295, "mode": "train", "epoch": 17}
{"loss": 0.32708385586738586, "acc": 0.8773437142372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.18469488620758057, "acc": 0.9281092882156372, "length": 3.9831533432006836, "mode": "train", "epoch": 18}
{"loss": 0.3106556236743927, "acc": 0.88671875, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.17793530225753784, "acc": 0.9256054162979126, "length": 3.985433340072632, "mode": "train", "epoch": 19}
{"loss": 0.31339067220687866, "acc": 0.8837890625, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.17539621889591217, "acc": 0.9274046421051025, "length": 3.9878296852111816, "mode": "train", "epoch": 20}
{"loss": 0.3231895864009857, "acc": 0.8898438811302185, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.1787639558315277, "acc": 0.9288705587387085, "length": 3.9878978729248047, "mode": "train", "epoch": 21}
{"loss": 0.30423617362976074, "acc": 0.8927735090255737, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.16730348765850067, "acc": 0.9350250363349915, "length": 3.989741802215576, "mode": "train", "epoch": 22}
{"loss": 0.29900798201560974, "acc": 0.8921875357627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.15934854745864868, "acc": 0.938041627407074, "length": 3.9911437034606934, "mode": "train", "epoch": 23}
{"loss": 0.2917052209377289, "acc": 0.9027343392372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1540636271238327, "acc": 0.9390251636505127, "length": 3.9922707080841064, "mode": "train", "epoch": 24}
{"loss": 0.2794911563396454, "acc": 0.8980469107627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.14884930849075317, "acc": 0.9443166255950928, "length": 3.99187970161438, "mode": "train", "epoch": 25}
{"loss": 0.2701714038848877, "acc": 0.9037109017372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.14630354940891266, "acc": 0.9405514597892761, "length": 3.991626024246216, "mode": "train", "epoch": 26}
{"loss": 0.2702014744281769, "acc": 0.9019531607627869, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1412961632013321, "acc": 0.9461686015129089, "length": 3.9939699172973633, "mode": "train", "epoch": 27}
{"loss": 0.24933704733848572, "acc": 0.9111328125, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1351063847541809, "acc": 0.9476457238197327, "length": 3.994086265563965, "mode": "train", "epoch": 28}
{"loss": 0.23102085292339325, "acc": 0.9220703840255737, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.13147906959056854, "acc": 0.94971764087677, "length": 3.9927995204925537, "mode": "train", "epoch": 29}
{"loss": 0.23734551668167114, "acc": 0.9212890267372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.13424955308437347, "acc": 0.9490929245948792, "length": 3.994555950164795, "mode": "train", "epoch": 30}
{"loss": 0.2229095697402954, "acc": 0.9195313453674316, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.12102583795785904, "acc": 0.9543078541755676, "length": 3.99615740776062, "mode": "train", "epoch": 31}
{"loss": 0.22435550391674042, "acc": 0.9185547232627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.11755137145519257, "acc": 0.9567347168922424, "length": 3.995260715484619, "mode": "train", "epoch": 32}
{"loss": 0.19105643033981323, "acc": 0.935546875, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.11576647311449051, "acc": 0.9567415118217468, "length": 3.9964964389801025, "mode": "train", "epoch": 33}
{"loss": 0.19493882358074188, "acc": 0.9332031607627869, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.11082043498754501, "acc": 0.9575871229171753, "length": 3.9969871044158936, "mode": "train", "epoch": 34}
{"loss": 0.1908436119556427, "acc": 0.9384765625, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.10582737624645233, "acc": 0.9573496580123901, "length": 3.9972307682037354, "mode": "train", "epoch": 35}
{"loss": 0.23402516543865204, "acc": 0.9226561784744263, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.10049933940172195, "acc": 0.9607099890708923, "length": 3.9973490238189697, "mode": "train", "epoch": 36}
{"loss": 0.1852191835641861, "acc": 0.9339843392372131, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.10710763931274414, "acc": 0.9615986347198486, "length": 3.997485637664795, "mode": "train", "epoch": 37}
{"loss": 0.18099012970924377, "acc": 0.9355469346046448, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.10117245465517044, "acc": 0.9618304967880249, "length": 3.9972352981567383, "mode": "train", "epoch": 38}
{"loss": 0.184991717338562, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.09872741997241974, "acc": 0.9635578989982605, "length": 3.9979186058044434, "mode": "train", "epoch": 39}
{"loss": 0.1668074131011963, "acc": 0.9384765625, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.08948144316673279, "acc": 0.9672707319259644, "length": 3.9977915287017822, "mode": "train", "epoch": 40}
{"loss": 0.18235933780670166, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08799909800291061, "acc": 0.9671057462692261, "length": 3.997830629348755, "mode": "train", "epoch": 41}
{"loss": 0.18001589179039001, "acc": 0.9371094107627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.08698462694883347, "acc": 0.9649129509925842, "length": 3.9977035522460938, "mode": "train", "epoch": 42}
{"loss": 0.18946512043476105, "acc": 0.9343749284744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08596757054328918, "acc": 0.9692961573600769, "length": 3.9982166290283203, "mode": "train", "epoch": 43}
{"loss": 0.1747155785560608, "acc": 0.9376953840255737, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.08797912299633026, "acc": 0.9668947458267212, "length": 3.9986321926116943, "mode": "train", "epoch": 44}
{"loss": 0.1665133535861969, "acc": 0.9439453482627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.07831192761659622, "acc": 0.9680662751197815, "length": 3.998598337173462, "mode": "train", "epoch": 45}
{"loss": 0.16938631236553192, "acc": 0.9460936784744263, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.07440496236085892, "acc": 0.9727311134338379, "length": 3.9986789226531982, "mode": "train", "epoch": 46}
{"loss": 0.1489981859922409, "acc": 0.9496093392372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.07911352813243866, "acc": 0.9717430472373962, "length": 3.99889874458313, "mode": "train", "epoch": 47}
{"loss": 0.16600444912910461, "acc": 0.9435547590255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.07820639759302139, "acc": 0.9717943072319031, "length": 3.998563289642334, "mode": "train", "epoch": 48}
{"loss": 0.16286680102348328, "acc": 0.9499999284744263, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.07314478605985641, "acc": 0.9736916422843933, "length": 3.9988949298858643, "mode": "train", "epoch": 49}
{"loss": 0.15491029620170593, "acc": 0.9490233659744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.06997732073068619, "acc": 0.9754669070243835, "length": 3.999100685119629, "mode": "train", "epoch": 50}
{"loss": 0.15184037387371063, "acc": 0.9515624642372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.07080190628767014, "acc": 0.9759324789047241, "length": 3.9990127086639404, "mode": "train", "epoch": 51}
{"loss": 0.14406625926494598, "acc": 0.9453125, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.06268422305583954, "acc": 0.9787822365760803, "length": 3.999342203140259, "mode": "train", "epoch": 52}
{"loss": 0.14972269535064697, "acc": 0.9505859017372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06519133597612381, "acc": 0.9765361547470093, "length": 3.999128818511963, "mode": "train", "epoch": 53}
{"loss": 0.15325747430324554, "acc": 0.9505859017372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.06212937831878662, "acc": 0.9781398177146912, "length": 3.9994747638702393, "mode": "train", "epoch": 54}
{"loss": 0.1318751871585846, "acc": 0.9566406607627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.06556231528520584, "acc": 0.9752466678619385, "length": 3.9994587898254395, "mode": "train", "epoch": 55}
{"loss": 0.1346288025379181, "acc": 0.9554687142372131, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.06597480922937393, "acc": 0.977365255355835, "length": 3.9993507862091064, "mode": "train", "epoch": 56}
{"loss": 0.14066864550113678, "acc": 0.9519530534744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.06031843647360802, "acc": 0.977422297000885, "length": 3.999323844909668, "mode": "train", "epoch": 57}
{"loss": 0.14224447309970856, "acc": 0.9572266340255737, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.05665688216686249, "acc": 0.9800276756286621, "length": 3.999338150024414, "mode": "train", "epoch": 58}
{"loss": 0.10893615335226059, "acc": 0.9621094465255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.05942239612340927, "acc": 0.9820318818092346, "length": 3.999385356903076, "mode": "train", "epoch": 59}
{"loss": 0.12093967944383621, "acc": 0.9601563215255737, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.05380786210298538, "acc": 0.9828060269355774, "length": 3.9995508193969727, "mode": "train", "epoch": 60}
{"loss": 0.11516080051660538, "acc": 0.9626952409744263, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8383870720863342
