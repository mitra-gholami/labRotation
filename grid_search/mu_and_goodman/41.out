ndevices 0
# ["--attributes=4", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--speaker_hidden_size=128", "--temp_update=0.99", "--temperature=2"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7016618847846985, "acc": 0.5146360993385315, "length": 3.412013530731201, "mode": "train", "epoch": 1}
{"loss": 0.6951832175254822, "acc": 0.513867199420929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6878532767295837, "acc": 0.5412321090698242, "length": 2.8525795936584473, "mode": "train", "epoch": 2}
{"loss": 0.6861898899078369, "acc": 0.5383301377296448, "length": 1.15234375, "mode": "test", "epoch": 2}
{"loss": 0.6628183722496033, "acc": 0.610085666179657, "length": 3.169142484664917, "mode": "train", "epoch": 3}
{"loss": 0.6158404350280762, "acc": 0.7182738780975342, "length": 3.85546875, "mode": "test", "epoch": 3}
{"loss": 0.5862492322921753, "acc": 0.7186030745506287, "length": 3.734680414199829, "mode": "train", "epoch": 4}
{"loss": 0.6022685170173645, "acc": 0.7001953125, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.5371138453483582, "acc": 0.7278854250907898, "length": 3.8953258991241455, "mode": "train", "epoch": 5}
{"loss": 0.5399124026298523, "acc": 0.7517578601837158, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.48329660296440125, "acc": 0.7800692915916443, "length": 3.8873674869537354, "mode": "train", "epoch": 6}
{"loss": 0.47911858558654785, "acc": 0.7839844226837158, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.4015800654888153, "acc": 0.8246556520462036, "length": 3.929353952407837, "mode": "train", "epoch": 7}
{"loss": 0.4734227657318115, "acc": 0.7978515028953552, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3643999993801117, "acc": 0.8428071737289429, "length": 3.9551284313201904, "mode": "train", "epoch": 8}
{"loss": 0.4515959620475769, "acc": 0.8156251311302185, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.340651273727417, "acc": 0.8536433577537537, "length": 3.9709818363189697, "mode": "train", "epoch": 9}
{"loss": 0.43315589427948, "acc": 0.8285155892372131, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3093773424625397, "acc": 0.8668354153633118, "length": 3.976653814315796, "mode": "train", "epoch": 10}
{"loss": 0.481634259223938, "acc": 0.8025389909744263, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3057166635990143, "acc": 0.8703151345252991, "length": 3.9817235469818115, "mode": "train", "epoch": 11}
{"loss": 0.45436108112335205, "acc": 0.8205078840255737, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2786658704280853, "acc": 0.8816854953765869, "length": 3.9849395751953125, "mode": "train", "epoch": 12}
{"loss": 0.4434810280799866, "acc": 0.8376951813697815, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.25416597723960876, "acc": 0.8897896409034729, "length": 3.987436532974243, "mode": "train", "epoch": 13}
{"loss": 0.42726629972457886, "acc": 0.8562499284744263, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.24274933338165283, "acc": 0.9033263325691223, "length": 3.991145133972168, "mode": "train", "epoch": 14}
{"loss": 0.45560014247894287, "acc": 0.8388672471046448, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.23351410031318665, "acc": 0.9095735549926758, "length": 3.992734432220459, "mode": "train", "epoch": 15}
{"loss": 0.37252628803253174, "acc": 0.8529296517372131, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.212354376912117, "acc": 0.9160210490226746, "length": 3.9938106536865234, "mode": "train", "epoch": 16}
{"loss": 0.35337209701538086, "acc": 0.8572264313697815, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2058860808610916, "acc": 0.9195639491081238, "length": 3.9943907260894775, "mode": "train", "epoch": 17}
{"loss": 0.38457736372947693, "acc": 0.8542968034744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.19578130543231964, "acc": 0.9250097870826721, "length": 3.995678424835205, "mode": "train", "epoch": 18}
{"loss": 0.38627204298973083, "acc": 0.8519530296325684, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.18576346337795258, "acc": 0.9316511750221252, "length": 3.99648118019104, "mode": "train", "epoch": 19}
{"loss": 0.36363133788108826, "acc": 0.8666015267372131, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.18012379109859467, "acc": 0.9319326281547546, "length": 3.9961583614349365, "mode": "train", "epoch": 20}
{"loss": 0.33297818899154663, "acc": 0.8742188811302185, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.16343428194522858, "acc": 0.9368840456008911, "length": 3.996044635772705, "mode": "train", "epoch": 21}
{"loss": 0.36228346824645996, "acc": 0.8636718392372131, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.1627105176448822, "acc": 0.9377362728118896, "length": 3.9966142177581787, "mode": "train", "epoch": 22}
{"loss": 0.3372229337692261, "acc": 0.8566406965255737, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1578032523393631, "acc": 0.9399319291114807, "length": 3.9975969791412354, "mode": "train", "epoch": 23}
{"loss": 0.3265995979309082, "acc": 0.8699218034744263, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1513003259897232, "acc": 0.9420264363288879, "length": 3.997366189956665, "mode": "train", "epoch": 24}
{"loss": 0.3257046341896057, "acc": 0.8623047471046448, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.15092742443084717, "acc": 0.9416928887367249, "length": 3.997971296310425, "mode": "train", "epoch": 25}
{"loss": 0.3110291659832001, "acc": 0.8679686188697815, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1496446430683136, "acc": 0.9423378109931946, "length": 3.998138189315796, "mode": "train", "epoch": 26}
{"loss": 0.3087305426597595, "acc": 0.8718749284744263, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.13478974997997284, "acc": 0.9475489854812622, "length": 3.998227596282959, "mode": "train", "epoch": 27}
{"loss": 0.27627238631248474, "acc": 0.8822265267372131, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1336805671453476, "acc": 0.9505987167358398, "length": 3.998276472091675, "mode": "train", "epoch": 28}
{"loss": 0.27521443367004395, "acc": 0.8880859017372131, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.12886913120746613, "acc": 0.9490866661071777, "length": 3.998643159866333, "mode": "train", "epoch": 29}
{"loss": 0.27343663573265076, "acc": 0.8919921517372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.12053341418504715, "acc": 0.955810546875, "length": 3.998372793197632, "mode": "train", "epoch": 30}
{"loss": 0.2683178186416626, "acc": 0.8892578482627869, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.11444812268018723, "acc": 0.9563416838645935, "length": 3.998413324356079, "mode": "train", "epoch": 31}
{"loss": 0.25053223967552185, "acc": 0.9007811546325684, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.10233236104249954, "acc": 0.9627255797386169, "length": 3.9986562728881836, "mode": "train", "epoch": 32}
{"loss": 0.24657660722732544, "acc": 0.9107422828674316, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.10414537042379379, "acc": 0.9641831517219543, "length": 3.998628616333008, "mode": "train", "epoch": 33}
{"loss": 0.2555825412273407, "acc": 0.9033203125, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.09839002043008804, "acc": 0.9667065143585205, "length": 3.9988338947296143, "mode": "train", "epoch": 34}
{"loss": 0.23311872780323029, "acc": 0.9162110090255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.08623907715082169, "acc": 0.9699904322624207, "length": 3.999028205871582, "mode": "train", "epoch": 35}
{"loss": 0.20227064192295074, "acc": 0.9250000715255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.08427853882312775, "acc": 0.9709200859069824, "length": 3.998666286468506, "mode": "train", "epoch": 36}
{"loss": 0.201149582862854, "acc": 0.9185547232627869, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.08326024562120438, "acc": 0.9709904193878174, "length": 3.9989373683929443, "mode": "train", "epoch": 37}
{"loss": 0.17837750911712646, "acc": 0.9281249642372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.07939731329679489, "acc": 0.9702373147010803, "length": 3.999265670776367, "mode": "train", "epoch": 38}
{"loss": 0.22786754369735718, "acc": 0.9164062142372131, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.07666007429361343, "acc": 0.9746807217597961, "length": 3.9992198944091797, "mode": "train", "epoch": 39}
{"loss": 0.19237855076789856, "acc": 0.9353514909744263, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.06992686539888382, "acc": 0.97573322057724, "length": 3.9991047382354736, "mode": "train", "epoch": 40}
{"loss": 0.16993427276611328, "acc": 0.9453125, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.06866444647312164, "acc": 0.9774839878082275, "length": 3.9985365867614746, "mode": "train", "epoch": 41}
{"loss": 0.17113730311393738, "acc": 0.9453124403953552, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.06048006936907768, "acc": 0.9814753532409668, "length": 3.999189853668213, "mode": "train", "epoch": 42}
{"loss": 0.19097773730754852, "acc": 0.9384765625, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.05941694974899292, "acc": 0.9796051979064941, "length": 3.999375104904175, "mode": "train", "epoch": 43}
{"loss": 0.17491278052330017, "acc": 0.931640625, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.057638347148895264, "acc": 0.9827147722244263, "length": 3.9995615482330322, "mode": "train", "epoch": 44}
{"loss": 0.18085767328739166, "acc": 0.9480467438697815, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.05977393314242363, "acc": 0.9840575456619263, "length": 3.9994142055511475, "mode": "train", "epoch": 45}
{"loss": 0.17091676592826843, "acc": 0.9433594346046448, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.05646057799458504, "acc": 0.982471764087677, "length": 3.999258041381836, "mode": "train", "epoch": 46}
{"loss": 0.17371028661727905, "acc": 0.9412108063697815, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.049254171550273895, "acc": 0.9866936206817627, "length": 3.9994795322418213, "mode": "train", "epoch": 47}
{"loss": 0.12503403425216675, "acc": 0.9585937857627869, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.050985563546419144, "acc": 0.9859949946403503, "length": 3.9996142387390137, "mode": "train", "epoch": 48}
{"loss": 0.14585424959659576, "acc": 0.9519529938697815, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.049043770879507065, "acc": 0.9849387407302856, "length": 3.9995288848876953, "mode": "train", "epoch": 49}
{"loss": 0.13786062598228455, "acc": 0.9570311903953552, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04521174356341362, "acc": 0.9862859845161438, "length": 3.99947190284729, "mode": "train", "epoch": 50}
{"loss": 0.10810567438602448, "acc": 0.9675780534744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04373716562986374, "acc": 0.9859389066696167, "length": 3.9996540546417236, "mode": "train", "epoch": 51}
{"loss": 0.11556296050548553, "acc": 0.9574218392372131, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03936910256743431, "acc": 0.989215075969696, "length": 3.9994752407073975, "mode": "train", "epoch": 52}
{"loss": 0.15797428786754608, "acc": 0.9541016221046448, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03732261434197426, "acc": 0.9888031482696533, "length": 3.999525547027588, "mode": "train", "epoch": 53}
{"loss": 0.10191266983747482, "acc": 0.97265625, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.04802783206105232, "acc": 0.9834771752357483, "length": 3.99938702583313, "mode": "train", "epoch": 54}
{"loss": 0.12286277860403061, "acc": 0.9617186784744263, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03897508978843689, "acc": 0.989334225654602, "length": 3.999704599380493, "mode": "train", "epoch": 55}
{"loss": 0.08859455585479736, "acc": 0.9736327528953552, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.034997742623090744, "acc": 0.989151656627655, "length": 3.9993653297424316, "mode": "train", "epoch": 56}
{"loss": 0.09527570754289627, "acc": 0.9705076813697815, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.03390636295080185, "acc": 0.9918521642684937, "length": 3.999621868133545, "mode": "train", "epoch": 57}
{"loss": 0.10643963515758514, "acc": 0.9687499403953552, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.03212228789925575, "acc": 0.9922650456428528, "length": 3.9997756481170654, "mode": "train", "epoch": 58}
{"loss": 0.10670480132102966, "acc": 0.9609374403953552, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03246014937758446, "acc": 0.9912688732147217, "length": 3.999790668487549, "mode": "train", "epoch": 59}
{"loss": 0.09701132774353027, "acc": 0.9716796278953552, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.04179936647415161, "acc": 0.9866415858268738, "length": 3.9994516372680664, "mode": "train", "epoch": 60}
{"loss": 0.11737692356109619, "acc": 0.9642577767372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7864999175071716
