# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7170655131340027, "acc": 0.5247341394424438, "length": 2.252249002456665, "mode": "train", "epoch": 1}
{"loss": 0.6978400945663452, "acc": 0.5439236164093018, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7040502429008484, "acc": 0.5102279186248779, "length": 1.0409640073776245, "mode": "train", "epoch": 2}
{"loss": 0.6990969181060791, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7044098973274231, "acc": 0.5164610743522644, "length": 1.0144336223602295, "mode": "train", "epoch": 3}
{"loss": 0.7001180648803711, "acc": 0.5303819179534912, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7007288336753845, "acc": 0.5230912566184998, "length": 1.0087337493896484, "mode": "train", "epoch": 4}
{"loss": 0.6990452408790588, "acc": 0.5385416150093079, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7014625668525696, "acc": 0.5259668827056885, "length": 1.0062522888183594, "mode": "train", "epoch": 5}
{"loss": 0.6976694464683533, "acc": 0.5473958849906921, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.701309859752655, "acc": 0.5219883322715759, "length": 1.0044842958450317, "mode": "train", "epoch": 6}
{"loss": 0.6989458799362183, "acc": 0.5350694060325623, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.700599730014801, "acc": 0.5201447010040283, "length": 1.0034871101379395, "mode": "train", "epoch": 7}
{"loss": 0.6989933848381042, "acc": 0.5501735806465149, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.7016297578811646, "acc": 0.5205397605895996, "length": 1.0026131868362427, "mode": "train", "epoch": 8}
{"loss": 0.7000694274902344, "acc": 0.5319444537162781, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.7010317444801331, "acc": 0.5250789523124695, "length": 1.0021474361419678, "mode": "train", "epoch": 9}
{"loss": 0.6986170411109924, "acc": 0.5366318821907043, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.7021328210830688, "acc": 0.5194536447525024, "length": 1.0017043352127075, "mode": "train", "epoch": 10}
{"loss": 0.6987226009368896, "acc": 0.542187511920929, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6998468041419983, "acc": 0.5277340412139893, "length": 1.0013949871063232, "mode": "train", "epoch": 11}
{"loss": 0.6985533237457275, "acc": 0.542187511920929, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.7014325857162476, "acc": 0.5239373445510864, "length": 1.0011826753616333, "mode": "train", "epoch": 12}
{"loss": 0.6983855366706848, "acc": 0.5487846732139587, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.7005809545516968, "acc": 0.5243950486183167, "length": 1.0010616779327393, "mode": "train", "epoch": 13}
{"loss": 0.6984745860099792, "acc": 0.5404514074325562, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.7010959982872009, "acc": 0.5206559300422668, "length": 1.0008349418640137, "mode": "train", "epoch": 14}
{"loss": 0.6993685364723206, "acc": 0.5305554866790771, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.7003482580184937, "acc": 0.5264095067977905, "length": 1.0006850957870483, "mode": "train", "epoch": 15}
{"loss": 0.698897659778595, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.7005968689918518, "acc": 0.5237042903900146, "length": 1.0006051063537598, "mode": "train", "epoch": 16}
{"loss": 0.6973158717155457, "acc": 0.5447916984558105, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.7010790109634399, "acc": 0.5181823968887329, "length": 1.0005384683609009, "mode": "train", "epoch": 17}
{"loss": 0.6981281042098999, "acc": 0.542187511920929, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6985247731208801, "acc": 0.5253729224205017, "length": 1.0004456043243408, "mode": "train", "epoch": 18}
{"loss": 0.6985324025154114, "acc": 0.5487846732139587, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6992994546890259, "acc": 0.5290560126304626, "length": 1.0003931522369385, "mode": "train", "epoch": 19}
{"loss": 0.6967899203300476, "acc": 0.5487846732139587, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6991757154464722, "acc": 0.5222674608230591, "length": 1.0003387928009033, "mode": "train", "epoch": 20}
{"loss": 0.699346661567688, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6993778944015503, "acc": 0.5291711688041687, "length": 1.0002838373184204, "mode": "train", "epoch": 21}
{"loss": 0.696610689163208, "acc": 0.537326455116272, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6984036564826965, "acc": 0.5214034914970398, "length": 1.000259518623352, "mode": "train", "epoch": 22}
{"loss": 0.6984349489212036, "acc": 0.5406250357627869, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6995176076889038, "acc": 0.52704256772995, "length": 1.0002163648605347, "mode": "train", "epoch": 23}
{"loss": 0.6992166638374329, "acc": 0.5387153029441833, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6981180310249329, "acc": 0.523475170135498, "length": 1.000201940536499, "mode": "train", "epoch": 24}
{"loss": 0.6976388692855835, "acc": 0.5444444417953491, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.69929438829422, "acc": 0.5339462757110596, "length": 1.0001801252365112, "mode": "train", "epoch": 25}
{"loss": 0.6976273655891418, "acc": 0.551562488079071, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6981003880500793, "acc": 0.5258906483650208, "length": 1.0001616477966309, "mode": "train", "epoch": 26}
{"loss": 0.6981540322303772, "acc": 0.5402777194976807, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6983076333999634, "acc": 0.5384916067123413, "length": 1.0001351833343506, "mode": "train", "epoch": 27}
{"loss": 0.697493851184845, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6972034573554993, "acc": 0.5217490196228027, "length": 1.0001206398010254, "mode": "train", "epoch": 28}
{"loss": 0.6986287236213684, "acc": 0.5590277910232544, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6981392502784729, "acc": 0.5386643409729004, "length": 1.000099539756775, "mode": "train", "epoch": 29}
{"loss": 0.6977951526641846, "acc": 0.5241319537162781, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6974058747291565, "acc": 0.5363056063652039, "length": 1.0000909566879272, "mode": "train", "epoch": 30}
{"loss": 0.6979358792304993, "acc": 0.551562488079071, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6963183879852295, "acc": 0.5332567691802979, "length": 1.000077724456787, "mode": "train", "epoch": 31}
{"loss": 0.6975615620613098, "acc": 0.5249999761581421, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6967386603355408, "acc": 0.5258917212486267, "length": 1.0000758171081543, "mode": "train", "epoch": 32}
{"loss": 0.6981636881828308, "acc": 0.5366320610046387, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6966306567192078, "acc": 0.541944146156311, "length": 1.0000580549240112, "mode": "train", "epoch": 33}
{"loss": 0.6985453963279724, "acc": 0.5168402194976807, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6961829662322998, "acc": 0.5310127139091492, "length": 1.000059723854065, "mode": "train", "epoch": 34}
{"loss": 0.6982410550117493, "acc": 0.5293402671813965, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6962950229644775, "acc": 0.5349825620651245, "length": 1.0000441074371338, "mode": "train", "epoch": 35}
{"loss": 0.6989014148712158, "acc": 0.5293402671813965, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6952057480812073, "acc": 0.5425775647163391, "length": 1.0000382661819458, "mode": "train", "epoch": 36}
{"loss": 0.6967981457710266, "acc": 0.5467013716697693, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.695298433303833, "acc": 0.5378021001815796, "length": 1.0000345706939697, "mode": "train", "epoch": 37}
{"loss": 0.6986266374588013, "acc": 0.5394096970558167, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6952111124992371, "acc": 0.5344071984291077, "length": 1.0000349283218384, "mode": "train", "epoch": 38}
{"loss": 0.6990805864334106, "acc": 0.5340278744697571, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6938149929046631, "acc": 0.5371692180633545, "length": 1.0000303983688354, "mode": "train", "epoch": 39}
{"loss": 0.6979466676712036, "acc": 0.5291666984558105, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6954580545425415, "acc": 0.5434408187866211, "length": 1.0000300407409668, "mode": "train", "epoch": 40}
{"loss": 0.698785662651062, "acc": 0.5284722447395325, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6973389983177185, "acc": 0.527215301990509, "length": 1.0000231266021729, "mode": "train", "epoch": 41}
{"loss": 0.697829008102417, "acc": 0.5366319417953491, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6950486898422241, "acc": 0.5368238091468811, "length": 1.0000190734863281, "mode": "train", "epoch": 42}
{"loss": 0.6982136964797974, "acc": 0.5293402671813965, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6958001852035522, "acc": 0.5429227352142334, "length": 1.000017523765564, "mode": "train", "epoch": 43}
{"loss": 0.6992392539978027, "acc": 0.532986044883728, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6949370503425598, "acc": 0.5380899310112, "length": 1.0000159740447998, "mode": "train", "epoch": 44}
{"loss": 0.6980164647102356, "acc": 0.5293402671813965, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6939972043037415, "acc": 0.5412542223930359, "length": 1.0000123977661133, "mode": "train", "epoch": 45}
{"loss": 0.698957085609436, "acc": 0.5440972447395325, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6946653127670288, "acc": 0.5431529879570007, "length": 1.0000137090682983, "mode": "train", "epoch": 46}
{"loss": 0.6991122961044312, "acc": 0.5366320610046387, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6933557391166687, "acc": 0.5423474311828613, "length": 1.0000104904174805, "mode": "train", "epoch": 47}
{"loss": 0.6989908218383789, "acc": 0.5366320610046387, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6949235200881958, "acc": 0.5421174764633179, "length": 1.000009298324585, "mode": "train", "epoch": 48}
{"loss": 0.6992252469062805, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6952089667320251, "acc": 0.5384348630905151, "length": 1.0000091791152954, "mode": "train", "epoch": 49}
{"loss": 0.6980307698249817, "acc": 0.5494791865348816, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6950932145118713, "acc": 0.5387226939201355, "length": 1.0000081062316895, "mode": "train", "epoch": 50}
{"loss": 0.6999608278274536, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6945106387138367, "acc": 0.5428653359413147, "length": 1.0000075101852417, "mode": "train", "epoch": 51}
{"loss": 0.6996619701385498, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6958194971084595, "acc": 0.5361334681510925, "length": 1.0000072717666626, "mode": "train", "epoch": 52}
{"loss": 0.6998242139816284, "acc": 0.5440972447395325, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6944547891616821, "acc": 0.5412542819976807, "length": 1.0000057220458984, "mode": "train", "epoch": 53}
{"loss": 0.6990314722061157, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6949407458305359, "acc": 0.5441311597824097, "length": 1.0000053644180298, "mode": "train", "epoch": 54}
{"loss": 0.6977689862251282, "acc": 0.5440972447395325, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6934972405433655, "acc": 0.5374568104743958, "length": 1.000003695487976, "mode": "train", "epoch": 55}
{"loss": 0.6989651322364807, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6956245303153992, "acc": 0.5402186512947083, "length": 1.000003457069397, "mode": "train", "epoch": 56}
{"loss": 0.698781430721283, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6944286227226257, "acc": 0.5430954694747925, "length": 1.0000026226043701, "mode": "train", "epoch": 57}
{"loss": 0.6985514760017395, "acc": 0.5293402671813965, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6931602358818054, "acc": 0.5402761697769165, "length": 1.0000025033950806, "mode": "train", "epoch": 58}
{"loss": 0.7008138298988342, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6945710778236389, "acc": 0.5380322933197021, "length": 1.0000096559524536, "mode": "train", "epoch": 59}
{"loss": 0.6986499428749084, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6952225565910339, "acc": 0.5394130945205688, "length": 1.0000016689300537, "mode": "train", "epoch": 60}
{"loss": 0.7000518441200256, "acc": 0.5368055105209351, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.33785709738731384
