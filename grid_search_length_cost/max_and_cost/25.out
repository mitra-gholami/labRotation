# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.722956120967865, "acc": 0.4889678657054901, "length": 2.589435577392578, "mode": "train", "epoch": 1}
{"loss": 0.7011850476264954, "acc": 0.5179687142372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7042335271835327, "acc": 0.5083405375480652, "length": 1.0388238430023193, "mode": "train", "epoch": 2}
{"loss": 0.7038429975509644, "acc": 0.49863284826278687, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7039150595664978, "acc": 0.5114719271659851, "length": 1.0149153470993042, "mode": "train", "epoch": 3}
{"loss": 0.7015045285224915, "acc": 0.5285155773162842, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7031720280647278, "acc": 0.5098862051963806, "length": 1.0096944570541382, "mode": "train", "epoch": 4}
{"loss": 0.7038690447807312, "acc": 0.4843749701976776, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7038103342056274, "acc": 0.5057134032249451, "length": 1.0068950653076172, "mode": "train", "epoch": 5}
{"loss": 0.7026140689849854, "acc": 0.511523425579071, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.7033833861351013, "acc": 0.5070157051086426, "length": 1.005314588546753, "mode": "train", "epoch": 6}
{"loss": 0.7031216621398926, "acc": 0.520703136920929, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.7026298642158508, "acc": 0.5270854830741882, "length": 1.0042709112167358, "mode": "train", "epoch": 7}
{"loss": 0.7012000679969788, "acc": 0.542187511920929, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.7027403712272644, "acc": 0.5173667669296265, "length": 1.00352942943573, "mode": "train", "epoch": 8}
{"loss": 0.7027380466461182, "acc": 0.5269531607627869, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.7029110789299011, "acc": 0.5277886390686035, "length": 1.0027902126312256, "mode": "train", "epoch": 9}
{"loss": 0.7005229592323303, "acc": 0.555859386920929, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.7014063000679016, "acc": 0.5295791625976562, "length": 1.0026021003723145, "mode": "train", "epoch": 10}
{"loss": 0.701482892036438, "acc": 0.532421886920929, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.7006374597549438, "acc": 0.5345359444618225, "length": 1.0018962621688843, "mode": "train", "epoch": 11}
{"loss": 0.7011011838912964, "acc": 0.547656238079071, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.701225757598877, "acc": 0.5230258107185364, "length": 1.0015015602111816, "mode": "train", "epoch": 12}
{"loss": 0.6996325850486755, "acc": 0.5484375357627869, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.7013425230979919, "acc": 0.509455144405365, "length": 1.0012973546981812, "mode": "train", "epoch": 13}
{"loss": 0.6994515657424927, "acc": 0.5404296517372131, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.7007032632827759, "acc": 0.5282769799232483, "length": 1.001083254814148, "mode": "train", "epoch": 14}
{"loss": 0.700169026851654, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.7005534768104553, "acc": 0.5314581990242004, "length": 1.0009742975234985, "mode": "train", "epoch": 15}
{"loss": 0.6999490261077881, "acc": 0.543749988079071, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6992611289024353, "acc": 0.5390733480453491, "length": 1.0008306503295898, "mode": "train", "epoch": 16}
{"loss": 0.6991092562675476, "acc": 0.5171875357627869, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6993690729141235, "acc": 0.535594642162323, "length": 1.000679850578308, "mode": "train", "epoch": 17}
{"loss": 0.6992782950401306, "acc": 0.5396484732627869, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6983699202537537, "acc": 0.5409080386161804, "length": 1.0005815029144287, "mode": "train", "epoch": 18}
{"loss": 0.699882447719574, "acc": 0.5263671875, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6978061199188232, "acc": 0.5334112048149109, "length": 1.0005213022232056, "mode": "train", "epoch": 19}
{"loss": 0.6979771852493286, "acc": 0.5287109017372131, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6985460519790649, "acc": 0.5352416038513184, "length": 1.0004483461380005, "mode": "train", "epoch": 20}
{"loss": 0.6990184783935547, "acc": 0.5250000357627869, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6982042789459229, "acc": 0.5315821170806885, "length": 1.0003868341445923, "mode": "train", "epoch": 21}
{"loss": 0.6989306807518005, "acc": 0.5312500596046448, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6971030831336975, "acc": 0.5358930826187134, "length": 1.0003348588943481, "mode": "train", "epoch": 22}
{"loss": 0.6976741552352905, "acc": 0.5521484017372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6971754431724548, "acc": 0.5428547263145447, "length": 1.0002895593643188, "mode": "train", "epoch": 23}
{"loss": 0.7007571458816528, "acc": 0.5185546875, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6956801414489746, "acc": 0.5478746891021729, "length": 1.000287652015686, "mode": "train", "epoch": 24}
{"loss": 0.6965368986129761, "acc": 0.5472655892372131, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6956738233566284, "acc": 0.5504716634750366, "length": 1.0002219676971436, "mode": "train", "epoch": 25}
{"loss": 0.6984498500823975, "acc": 0.5419921875, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6968229413032532, "acc": 0.5390788316726685, "length": 1.0002135038375854, "mode": "train", "epoch": 26}
{"loss": 0.6981028914451599, "acc": 0.5445312857627869, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.69649338722229, "acc": 0.5433291792869568, "length": 1.000172734260559, "mode": "train", "epoch": 27}
{"loss": 0.6988614797592163, "acc": 0.544921875, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6963046789169312, "acc": 0.5485827326774597, "length": 1.0001463890075684, "mode": "train", "epoch": 28}
{"loss": 0.6966691613197327, "acc": 0.546679675579071, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6968715786933899, "acc": 0.5429166555404663, "length": 1.000149130821228, "mode": "train", "epoch": 29}
{"loss": 0.6961751580238342, "acc": 0.54296875, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6965075135231018, "acc": 0.545749306678772, "length": 1.0001128911972046, "mode": "train", "epoch": 30}
{"loss": 0.6967772245407104, "acc": 0.5482421517372131, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6954128742218018, "acc": 0.5464588403701782, "length": 1.0001001358032227, "mode": "train", "epoch": 31}
{"loss": 0.6973891258239746, "acc": 0.546679675579071, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6944059729576111, "acc": 0.5432112216949463, "length": 1.000088095664978, "mode": "train", "epoch": 32}
{"loss": 0.6984270215034485, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6948017477989197, "acc": 0.5449819564819336, "length": 1.0000847578048706, "mode": "train", "epoch": 33}
{"loss": 0.6982089281082153, "acc": 0.5474609732627869, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.694509744644165, "acc": 0.5474615693092346, "length": 1.0000743865966797, "mode": "train", "epoch": 34}
{"loss": 0.6965562105178833, "acc": 0.56640625, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6947027444839478, "acc": 0.5511809587478638, "length": 1.0000749826431274, "mode": "train", "epoch": 35}
{"loss": 0.6985355615615845, "acc": 0.5367187857627869, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6955718398094177, "acc": 0.5548405647277832, "length": 1.0000624656677246, "mode": "train", "epoch": 36}
{"loss": 0.6962788105010986, "acc": 0.5416015982627869, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6938700079917908, "acc": 0.5492326021194458, "length": 1.000046968460083, "mode": "train", "epoch": 37}
{"loss": 0.6983779668807983, "acc": 0.5580077767372131, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6939209699630737, "acc": 0.5512987375259399, "length": 1.000049352645874, "mode": "train", "epoch": 38}
{"loss": 0.6955763697624207, "acc": 0.5521484017372131, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6941398978233337, "acc": 0.5492916703224182, "length": 1.0000369548797607, "mode": "train", "epoch": 39}
{"loss": 0.6980063915252686, "acc": 0.5474609732627869, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6938944458961487, "acc": 0.5517708659172058, "length": 1.0000396966934204, "mode": "train", "epoch": 40}
{"loss": 0.6972004771232605, "acc": 0.555859386920929, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6923874020576477, "acc": 0.5501770973205566, "length": 1.0000311136245728, "mode": "train", "epoch": 41}
{"loss": 0.6982992887496948, "acc": 0.5269531607627869, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.693571925163269, "acc": 0.5534237027168274, "length": 1.0000238418579102, "mode": "train", "epoch": 42}
{"loss": 0.6978262662887573, "acc": 0.5455078482627869, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6931361556053162, "acc": 0.5469303131103516, "length": 1.0000239610671997, "mode": "train", "epoch": 43}
{"loss": 0.6973994374275208, "acc": 0.5361328125, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6937023997306824, "acc": 0.549704909324646, "length": 1.0000241994857788, "mode": "train", "epoch": 44}
{"loss": 0.6992008686065674, "acc": 0.5230469107627869, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6935117840766907, "acc": 0.5461628437042236, "length": 1.0000190734863281, "mode": "train", "epoch": 45}
{"loss": 0.696770966053009, "acc": 0.546679675579071, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6942996978759766, "acc": 0.5508266091346741, "length": 1.0000207424163818, "mode": "train", "epoch": 46}
{"loss": 0.6979523301124573, "acc": 0.5513672232627869, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6927915811538696, "acc": 0.5528334975242615, "length": 1.0000132322311401, "mode": "train", "epoch": 47}
{"loss": 0.6969509124755859, "acc": 0.5445312857627869, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6925705075263977, "acc": 0.5540141463279724, "length": 1.0000125169754028, "mode": "train", "epoch": 48}
{"loss": 0.6966619491577148, "acc": 0.5349609851837158, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6933403015136719, "acc": 0.5548405647277832, "length": 1.0000113248825073, "mode": "train", "epoch": 49}
{"loss": 0.6981459856033325, "acc": 0.5374999642372131, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6936386823654175, "acc": 0.5496457815170288, "length": 1.000012755393982, "mode": "train", "epoch": 50}
{"loss": 0.6966166496276855, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6929066181182861, "acc": 0.5525383949279785, "length": 1.000011920928955, "mode": "train", "epoch": 51}
{"loss": 0.6992667317390442, "acc": 0.5320312976837158, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.693170964717865, "acc": 0.5531877279281616, "length": 1.0000081062316895, "mode": "train", "epoch": 52}
{"loss": 0.6969584822654724, "acc": 0.558398425579071, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6933945417404175, "acc": 0.5496458411216736, "length": 1.0000087022781372, "mode": "train", "epoch": 53}
{"loss": 0.6966339349746704, "acc": 0.5482421517372131, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6926628947257996, "acc": 0.5560802817344666, "length": 1.0000056028366089, "mode": "train", "epoch": 54}
{"loss": 0.6974842548370361, "acc": 0.5482421517372131, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6932364106178284, "acc": 0.5485242009162903, "length": 1.0000065565109253, "mode": "train", "epoch": 55}
{"loss": 0.6982513070106506, "acc": 0.555859386920929, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6922532320022583, "acc": 0.5501771569252014, "length": 1.0000039339065552, "mode": "train", "epoch": 56}
{"loss": 0.6962544322013855, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6945900321006775, "acc": 0.5489963889122009, "length": 1.0000035762786865, "mode": "train", "epoch": 57}
{"loss": 0.6980676651000977, "acc": 0.5394530892372131, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6923824548721313, "acc": 0.549704909324646, "length": 1.0000033378601074, "mode": "train", "epoch": 58}
{"loss": 0.6969988942146301, "acc": 0.5445312857627869, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6945540308952332, "acc": 0.550118088722229, "length": 1.0000044107437134, "mode": "train", "epoch": 59}
{"loss": 0.6981847286224365, "acc": 0.5374999642372131, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6934525370597839, "acc": 0.553955078125, "length": 1.0000025033950806, "mode": "train", "epoch": 60}
{"loss": 0.6969216465950012, "acc": 0.5374999642372131, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.3079032301902771
