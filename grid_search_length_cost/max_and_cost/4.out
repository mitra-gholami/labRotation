# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.707139253616333, "acc": 0.515770435333252, "length": 2.5653133392333984, "mode": "train", "epoch": 1}
{"loss": 0.6960821747779846, "acc": 0.5355468392372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.693841278553009, "acc": 0.5445965528488159, "length": 1.3055914640426636, "mode": "train", "epoch": 2}
{"loss": 0.6700307726860046, "acc": 0.6308227777481079, "length": 1.80859375, "mode": "test", "epoch": 2}
{"loss": 0.6139616966247559, "acc": 0.6955536603927612, "length": 2.2096800804138184, "mode": "train", "epoch": 3}
{"loss": 0.6246857643127441, "acc": 0.708483874797821, "length": 2.1953125, "mode": "test", "epoch": 3}
{"loss": 0.5591565370559692, "acc": 0.7297043800354004, "length": 2.196171522140503, "mode": "train", "epoch": 4}
{"loss": 0.5733572244644165, "acc": 0.7365784049034119, "length": 2.37109375, "mode": "test", "epoch": 4}
{"loss": 0.5050373673439026, "acc": 0.7653409838676453, "length": 2.3498857021331787, "mode": "train", "epoch": 5}
{"loss": 0.5476295351982117, "acc": 0.7471252679824829, "length": 2.3125, "mode": "test", "epoch": 5}
{"loss": 0.4770256280899048, "acc": 0.785367488861084, "length": 2.349701404571533, "mode": "train", "epoch": 6}
{"loss": 0.5479159355163574, "acc": 0.7408997416496277, "length": 2.27734375, "mode": "test", "epoch": 6}
{"loss": 0.4539335072040558, "acc": 0.7949674129486084, "length": 2.338421583175659, "mode": "train", "epoch": 7}
{"loss": 0.568220317363739, "acc": 0.7497619986534119, "length": 2.265625, "mode": "test", "epoch": 7}
{"loss": 0.4410133957862854, "acc": 0.8086063861846924, "length": 2.3786301612854004, "mode": "train", "epoch": 8}
{"loss": 0.5868765115737915, "acc": 0.7517090439796448, "length": 2.2421875, "mode": "test", "epoch": 8}
{"loss": 0.4258021414279938, "acc": 0.8164709806442261, "length": 2.5182979106903076, "mode": "train", "epoch": 9}
{"loss": 0.5273005366325378, "acc": 0.788806140422821, "length": 2.5859375, "mode": "test", "epoch": 9}
{"loss": 0.3870992362499237, "acc": 0.8447070717811584, "length": 3.0101094245910645, "mode": "train", "epoch": 10}
{"loss": 0.46172693371772766, "acc": 0.8159545660018921, "length": 3.171875, "mode": "test", "epoch": 10}
{"loss": 0.35141947865486145, "acc": 0.8571643233299255, "length": 3.2455782890319824, "mode": "train", "epoch": 11}
{"loss": 0.43363720178604126, "acc": 0.8317505121231079, "length": 3.3828125, "mode": "test", "epoch": 11}
{"loss": 0.3313613831996918, "acc": 0.8716884255409241, "length": 3.357180118560791, "mode": "train", "epoch": 12}
{"loss": 0.45361459255218506, "acc": 0.834545910358429, "length": 3.21484375, "mode": "test", "epoch": 12}
{"loss": 0.3102071285247803, "acc": 0.8821361064910889, "length": 3.512694835662842, "mode": "train", "epoch": 13}
{"loss": 0.4093601107597351, "acc": 0.8593078851699829, "length": 3.4765625, "mode": "test", "epoch": 13}
{"loss": 0.28432461619377136, "acc": 0.8975206017494202, "length": 3.5539798736572266, "mode": "train", "epoch": 14}
{"loss": 0.42651060223579407, "acc": 0.8514586687088013, "length": 3.6484375, "mode": "test", "epoch": 14}
{"loss": 0.2778337001800537, "acc": 0.8999216556549072, "length": 3.6343421936035156, "mode": "train", "epoch": 15}
{"loss": 0.40187370777130127, "acc": 0.8662963509559631, "length": 3.74609375, "mode": "test", "epoch": 15}
{"loss": 0.2629263997077942, "acc": 0.9024045467376709, "length": 3.6104090213775635, "mode": "train", "epoch": 16}
{"loss": 0.39536944031715393, "acc": 0.8719605207443237, "length": 3.80078125, "mode": "test", "epoch": 16}
{"loss": 0.2636317014694214, "acc": 0.9086048603057861, "length": 3.6666831970214844, "mode": "train", "epoch": 17}
{"loss": 0.3599708676338196, "acc": 0.878765881061554, "length": 3.640625, "mode": "test", "epoch": 17}
{"loss": 0.23827825486660004, "acc": 0.9122672080993652, "length": 3.659414768218994, "mode": "train", "epoch": 18}
{"loss": 0.36279159784317017, "acc": 0.885498046875, "length": 3.85546875, "mode": "test", "epoch": 18}
{"loss": 0.23145495355129242, "acc": 0.9237611293792725, "length": 3.6974434852600098, "mode": "train", "epoch": 19}
{"loss": 0.3684677481651306, "acc": 0.8879944086074829, "length": 3.8203125, "mode": "test", "epoch": 19}
{"loss": 0.2231464684009552, "acc": 0.9256671667098999, "length": 3.740922212600708, "mode": "train", "epoch": 20}
{"loss": 0.32962802052497864, "acc": 0.8999389410018921, "length": 3.828125, "mode": "test", "epoch": 20}
{"loss": 0.2144213318824768, "acc": 0.9292054176330566, "length": 3.8025295734405518, "mode": "train", "epoch": 21}
{"loss": 0.32808879017829895, "acc": 0.9032288193702698, "length": 3.91015625, "mode": "test", "epoch": 21}
{"loss": 0.20948632061481476, "acc": 0.9329876899719238, "length": 3.8296258449554443, "mode": "train", "epoch": 22}
{"loss": 0.327441543340683, "acc": 0.9002441763877869, "length": 3.96875, "mode": "test", "epoch": 22}
{"loss": 0.20016977190971375, "acc": 0.9323192238807678, "length": 3.8516693115234375, "mode": "train", "epoch": 23}
{"loss": 0.3118573725223541, "acc": 0.8992981314659119, "length": 3.8828125, "mode": "test", "epoch": 23}
{"loss": 0.19980499148368835, "acc": 0.9317810535430908, "length": 3.83716082572937, "mode": "train", "epoch": 24}
{"loss": 0.3163640797138214, "acc": 0.9049438238143921, "length": 3.97265625, "mode": "test", "epoch": 24}
{"loss": 0.18760144710540771, "acc": 0.9386206269264221, "length": 3.8636929988861084, "mode": "train", "epoch": 25}
{"loss": 0.32059523463249207, "acc": 0.9053833484649658, "length": 3.9375, "mode": "test", "epoch": 25}
{"loss": 0.18659690022468567, "acc": 0.9387551546096802, "length": 3.8491876125335693, "mode": "train", "epoch": 26}
{"loss": 0.3129028379917145, "acc": 0.913555920124054, "length": 3.9453125, "mode": "test", "epoch": 26}
{"loss": 0.17947854101657867, "acc": 0.9427740573883057, "length": 3.8592324256896973, "mode": "train", "epoch": 27}
{"loss": 0.30194878578186035, "acc": 0.911694347858429, "length": 3.90234375, "mode": "test", "epoch": 27}
{"loss": 0.17385533452033997, "acc": 0.943852424621582, "length": 3.8695356845855713, "mode": "train", "epoch": 28}
{"loss": 0.29744815826416016, "acc": 0.9159057140350342, "length": 3.875, "mode": "test", "epoch": 28}
{"loss": 0.16920016705989838, "acc": 0.9459149241447449, "length": 3.869999408721924, "mode": "train", "epoch": 29}
{"loss": 0.29791373014450073, "acc": 0.897509753704071, "length": 3.89453125, "mode": "test", "epoch": 29}
{"loss": 0.16204117238521576, "acc": 0.9480527639389038, "length": 3.8819165229797363, "mode": "train", "epoch": 30}
{"loss": 0.28930163383483887, "acc": 0.9071412086486816, "length": 3.9296875, "mode": "test", "epoch": 30}
{"loss": 0.15831682085990906, "acc": 0.9518787860870361, "length": 3.903893232345581, "mode": "train", "epoch": 31}
{"loss": 0.2578933835029602, "acc": 0.9156616926193237, "length": 3.96875, "mode": "test", "epoch": 31}
{"loss": 0.14833280444145203, "acc": 0.952425479888916, "length": 3.9115114212036133, "mode": "train", "epoch": 32}
{"loss": 0.250850111246109, "acc": 0.9203857183456421, "length": 3.96875, "mode": "test", "epoch": 32}
{"loss": 0.13598309457302094, "acc": 0.9597616195678711, "length": 3.919555902481079, "mode": "train", "epoch": 33}
{"loss": 0.24868237972259521, "acc": 0.9214416146278381, "length": 3.9609375, "mode": "test", "epoch": 33}
{"loss": 0.12897540628910065, "acc": 0.9595427513122559, "length": 3.925507068634033, "mode": "train", "epoch": 34}
{"loss": 0.21760991215705872, "acc": 0.9311646223068237, "length": 3.99609375, "mode": "test", "epoch": 34}
{"loss": 0.12392362207174301, "acc": 0.9660923480987549, "length": 3.953932285308838, "mode": "train", "epoch": 35}
{"loss": 0.205974280834198, "acc": 0.9304198622703552, "length": 3.99609375, "mode": "test", "epoch": 35}
{"loss": 0.12135005742311478, "acc": 0.9651600122451782, "length": 3.9579622745513916, "mode": "train", "epoch": 36}
{"loss": 0.20614591240882874, "acc": 0.940386950969696, "length": 3.99609375, "mode": "test", "epoch": 36}
{"loss": 0.11311329901218414, "acc": 0.9701728224754333, "length": 3.957336664199829, "mode": "train", "epoch": 37}
{"loss": 0.20535492897033691, "acc": 0.9416016340255737, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.12024222314357758, "acc": 0.9669036269187927, "length": 3.9661707878112793, "mode": "train", "epoch": 38}
{"loss": 0.19823835790157318, "acc": 0.9382811784744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.12298385053873062, "acc": 0.963326632976532, "length": 3.9578537940979004, "mode": "train", "epoch": 39}
{"loss": 0.22353538870811462, "acc": 0.9384765625, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.11351978778839111, "acc": 0.9679092764854431, "length": 3.973182439804077, "mode": "train", "epoch": 40}
{"loss": 0.18119464814662933, "acc": 0.9566406607627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.09876694530248642, "acc": 0.9760850667953491, "length": 3.982086420059204, "mode": "train", "epoch": 41}
{"loss": 0.18570643663406372, "acc": 0.9566406607627869, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.09003562480211258, "acc": 0.9779534339904785, "length": 3.9831929206848145, "mode": "train", "epoch": 42}
{"loss": 0.17681768536567688, "acc": 0.9507812857627869, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08698191493749619, "acc": 0.9775357246398926, "length": 3.9870071411132812, "mode": "train", "epoch": 43}
{"loss": 0.16876143217086792, "acc": 0.9552735090255737, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.08069616556167603, "acc": 0.9793291687965393, "length": 3.985729217529297, "mode": "train", "epoch": 44}
{"loss": 0.1706685572862625, "acc": 0.9625000357627869, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.08083348721265793, "acc": 0.9797083735466003, "length": 3.983504295349121, "mode": "train", "epoch": 45}
{"loss": 0.1728956401348114, "acc": 0.9564452767372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.07455182820558548, "acc": 0.983487069606781, "length": 3.987813949584961, "mode": "train", "epoch": 46}
{"loss": 0.17540884017944336, "acc": 0.9599609375, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.07453654706478119, "acc": 0.981944739818573, "length": 3.9863929748535156, "mode": "train", "epoch": 47}
{"loss": 0.14019086956977844, "acc": 0.9630860090255737, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.07468099147081375, "acc": 0.9820591807365417, "length": 3.990434408187866, "mode": "train", "epoch": 48}
{"loss": 0.1781415194272995, "acc": 0.9517578482627869, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.08544500172138214, "acc": 0.9785626530647278, "length": 3.9887032508850098, "mode": "train", "epoch": 49}
{"loss": 0.17087005078792572, "acc": 0.9636718034744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0668879821896553, "acc": 0.985124945640564, "length": 3.9895317554473877, "mode": "train", "epoch": 50}
{"loss": 0.1489415168762207, "acc": 0.9656249284744263, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.05567550286650658, "acc": 0.9898521304130554, "length": 3.99434757232666, "mode": "train", "epoch": 51}
{"loss": 0.14406852424144745, "acc": 0.9742187261581421, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.05413400009274483, "acc": 0.9908145070075989, "length": 3.995509147644043, "mode": "train", "epoch": 52}
{"loss": 0.14226055145263672, "acc": 0.9689453840255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.05018417164683342, "acc": 0.9934336543083191, "length": 3.9977364540100098, "mode": "train", "epoch": 53}
{"loss": 0.116130031645298, "acc": 0.9740234017372131, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.05246930569410324, "acc": 0.992159366607666, "length": 3.9963793754577637, "mode": "train", "epoch": 54}
{"loss": 0.11869402229785919, "acc": 0.9771484732627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.04912855476140976, "acc": 0.9931296110153198, "length": 3.997206926345825, "mode": "train", "epoch": 55}
{"loss": 0.13774272799491882, "acc": 0.974609375, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.045970071107149124, "acc": 0.9945521354675293, "length": 3.9976117610931396, "mode": "train", "epoch": 56}
{"loss": 0.12950663268566132, "acc": 0.9763671159744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.0736328586935997, "acc": 0.9868994355201721, "length": 3.9981369972229004, "mode": "train", "epoch": 57}
{"loss": 0.1478232443332672, "acc": 0.9634765982627869, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06493072956800461, "acc": 0.98720782995224, "length": 3.9985435009002686, "mode": "train", "epoch": 58}
{"loss": 0.13748443126678467, "acc": 0.9662109017372131, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04990822449326515, "acc": 0.9929459095001221, "length": 3.9989089965820312, "mode": "train", "epoch": 59}
{"loss": 0.1248512715101242, "acc": 0.9808593392372131, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.038485247641801834, "acc": 0.9974899291992188, "length": 3.998494863510132, "mode": "train", "epoch": 60}
{"loss": 0.13703496754169464, "acc": 0.9791015982627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8026667237281799
