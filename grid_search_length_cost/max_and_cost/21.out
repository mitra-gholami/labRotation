# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7015113234519958, "acc": 0.5021838545799255, "length": 3.358031988143921, "mode": "train", "epoch": 1}
{"loss": 0.6966646313667297, "acc": 0.48222658038139343, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6849133372306824, "acc": 0.551600992679596, "length": 1.8978126049041748, "mode": "train", "epoch": 2}
{"loss": 0.6384012699127197, "acc": 0.6947631239891052, "length": 2.87109375, "mode": "test", "epoch": 2}
{"loss": 0.5713818669319153, "acc": 0.7503104209899902, "length": 3.5533621311187744, "mode": "train", "epoch": 3}
{"loss": 0.5246298909187317, "acc": 0.7730346918106079, "length": 4.7890625, "mode": "test", "epoch": 3}
{"loss": 0.4963221848011017, "acc": 0.791010320186615, "length": 4.119401931762695, "mode": "train", "epoch": 4}
{"loss": 0.5058336853981018, "acc": 0.7816833257675171, "length": 4.65234375, "mode": "test", "epoch": 4}
{"loss": 0.4643392264842987, "acc": 0.8020191192626953, "length": 4.087348937988281, "mode": "train", "epoch": 5}
{"loss": 0.48596811294555664, "acc": 0.7878173589706421, "length": 4.69140625, "mode": "test", "epoch": 5}
{"loss": 0.42273950576782227, "acc": 0.8131933808326721, "length": 4.243506908416748, "mode": "train", "epoch": 6}
{"loss": 0.45522037148475647, "acc": 0.803173840045929, "length": 4.8671875, "mode": "test", "epoch": 6}
{"loss": 0.3802308440208435, "acc": 0.8318802118301392, "length": 4.527209281921387, "mode": "train", "epoch": 7}
{"loss": 0.44414523243904114, "acc": 0.7979492545127869, "length": 4.9453125, "mode": "test", "epoch": 7}
{"loss": 0.3415617346763611, "acc": 0.8488900065422058, "length": 4.748867988586426, "mode": "train", "epoch": 8}
{"loss": 0.43940433859825134, "acc": 0.8189087510108948, "length": 5.12109375, "mode": "test", "epoch": 8}
{"loss": 0.3128426671028137, "acc": 0.8676381707191467, "length": 4.889862537384033, "mode": "train", "epoch": 9}
{"loss": 0.39619916677474976, "acc": 0.826672375202179, "length": 5.08203125, "mode": "test", "epoch": 9}
{"loss": 0.2950151860713959, "acc": 0.8772369623184204, "length": 4.983216285705566, "mode": "train", "epoch": 10}
{"loss": 0.40399637818336487, "acc": 0.8341004252433777, "length": 5.21875, "mode": "test", "epoch": 10}
{"loss": 0.2874603271484375, "acc": 0.8802111744880676, "length": 5.068181991577148, "mode": "train", "epoch": 11}
{"loss": 0.4046620726585388, "acc": 0.8257445693016052, "length": 5.2578125, "mode": "test", "epoch": 11}
{"loss": 0.275740385055542, "acc": 0.8909086585044861, "length": 5.1845927238464355, "mode": "train", "epoch": 12}
{"loss": 0.4059848189353943, "acc": 0.830792248249054, "length": 5.2578125, "mode": "test", "epoch": 12}
{"loss": 0.2549380660057068, "acc": 0.8992617726325989, "length": 5.300935745239258, "mode": "train", "epoch": 13}
{"loss": 0.3481441140174866, "acc": 0.8562256097793579, "length": 5.765625, "mode": "test", "epoch": 13}
{"loss": 0.23020190000534058, "acc": 0.9123775959014893, "length": 5.567172050476074, "mode": "train", "epoch": 14}
{"loss": 0.33129918575286865, "acc": 0.8717650771141052, "length": 5.94921875, "mode": "test", "epoch": 14}
{"loss": 0.21327590942382812, "acc": 0.921853244304657, "length": 5.770816802978516, "mode": "train", "epoch": 15}
{"loss": 0.30738601088523865, "acc": 0.8861327767372131, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.20299071073532104, "acc": 0.9285379648208618, "length": 5.844775676727295, "mode": "train", "epoch": 16}
{"loss": 0.3094194233417511, "acc": 0.8812499642372131, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.1901254653930664, "acc": 0.9326997399330139, "length": 5.885545253753662, "mode": "train", "epoch": 17}
{"loss": 0.2840128540992737, "acc": 0.8876953125, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.17979982495307922, "acc": 0.9353854656219482, "length": 5.924245357513428, "mode": "train", "epoch": 18}
{"loss": 0.24788112938404083, "acc": 0.8974609971046448, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.17687581479549408, "acc": 0.9354133009910583, "length": 5.94196081161499, "mode": "train", "epoch": 19}
{"loss": 0.24740007519721985, "acc": 0.9087890982627869, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.16179855167865753, "acc": 0.9398376941680908, "length": 5.961278438568115, "mode": "train", "epoch": 20}
{"loss": 0.24318282306194305, "acc": 0.9001952409744263, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.16356296837329865, "acc": 0.9405958652496338, "length": 5.971048355102539, "mode": "train", "epoch": 21}
{"loss": 0.2478669136762619, "acc": 0.9019531607627869, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.1543883979320526, "acc": 0.9453558921813965, "length": 5.976463317871094, "mode": "train", "epoch": 22}
{"loss": 0.2481163889169693, "acc": 0.9066405892372131, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.1394897699356079, "acc": 0.9500725269317627, "length": 5.9763994216918945, "mode": "train", "epoch": 23}
{"loss": 0.25970590114593506, "acc": 0.90625, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.1399827003479004, "acc": 0.9474549889564514, "length": 5.982604026794434, "mode": "train", "epoch": 24}
{"loss": 0.2537543773651123, "acc": 0.9152344465255737, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.13554713129997253, "acc": 0.9506435394287109, "length": 5.9857401847839355, "mode": "train", "epoch": 25}
{"loss": 0.21743935346603394, "acc": 0.9246093034744263, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.13328395783901215, "acc": 0.9498394727706909, "length": 5.986630916595459, "mode": "train", "epoch": 26}
{"loss": 0.26690909266471863, "acc": 0.8990234732627869, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.13098612427711487, "acc": 0.9490861296653748, "length": 5.987904071807861, "mode": "train", "epoch": 27}
{"loss": 0.2112598866224289, "acc": 0.9251952767372131, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.11381057649850845, "acc": 0.9585664868354797, "length": 5.991528034210205, "mode": "train", "epoch": 28}
{"loss": 0.22333455085754395, "acc": 0.9242187142372131, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.11921364068984985, "acc": 0.9563963413238525, "length": 5.992866516113281, "mode": "train", "epoch": 29}
{"loss": 0.19671069085597992, "acc": 0.9333983659744263, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.10886611044406891, "acc": 0.959892213344574, "length": 5.988884449005127, "mode": "train", "epoch": 30}
{"loss": 0.19924750924110413, "acc": 0.9240235686302185, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.10373111814260483, "acc": 0.9595323801040649, "length": 5.993866443634033, "mode": "train", "epoch": 31}
{"loss": 0.24199102818965912, "acc": 0.9005860090255737, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.10246624797582626, "acc": 0.9605041146278381, "length": 5.995767593383789, "mode": "train", "epoch": 32}
{"loss": 0.17847928404808044, "acc": 0.9316406846046448, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.10490284860134125, "acc": 0.9597801566123962, "length": 5.995088577270508, "mode": "train", "epoch": 33}
{"loss": 0.17618845403194427, "acc": 0.9287108778953552, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.1065378189086914, "acc": 0.9556081295013428, "length": 5.995822906494141, "mode": "train", "epoch": 34}
{"loss": 0.18665552139282227, "acc": 0.9292969107627869, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.09804802387952805, "acc": 0.9653317332267761, "length": 5.995584487915039, "mode": "train", "epoch": 35}
{"loss": 0.17320546507835388, "acc": 0.9425781965255737, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.08817528933286667, "acc": 0.9673082232475281, "length": 5.997156620025635, "mode": "train", "epoch": 36}
{"loss": 0.17964619398117065, "acc": 0.9388671517372131, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.08813877403736115, "acc": 0.9666621088981628, "length": 5.997427940368652, "mode": "train", "epoch": 37}
{"loss": 0.15878264605998993, "acc": 0.9386719465255737, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.08094891905784607, "acc": 0.9709022045135498, "length": 5.997159004211426, "mode": "train", "epoch": 38}
{"loss": 0.17909596860408783, "acc": 0.9312500357627869, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.08084600418806076, "acc": 0.9697309732437134, "length": 5.99723482131958, "mode": "train", "epoch": 39}
{"loss": 0.17256046831607819, "acc": 0.9320312142372131, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.07300933450460434, "acc": 0.9697816967964172, "length": 5.995845317840576, "mode": "train", "epoch": 40}
{"loss": 0.16640742123126984, "acc": 0.9343749284744263, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.072191521525383, "acc": 0.9746353626251221, "length": 5.997981071472168, "mode": "train", "epoch": 41}
{"loss": 0.14803636074066162, "acc": 0.9425782561302185, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.06859903782606125, "acc": 0.975592851638794, "length": 5.99859094619751, "mode": "train", "epoch": 42}
{"loss": 0.17337489128112793, "acc": 0.943359375, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.06281962990760803, "acc": 0.9800844788551331, "length": 5.999001979827881, "mode": "train", "epoch": 43}
{"loss": 0.1419752985239029, "acc": 0.9455078840255737, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.06251375377178192, "acc": 0.980313241481781, "length": 5.998650074005127, "mode": "train", "epoch": 44}
{"loss": 0.12649033963680267, "acc": 0.9564452767372131, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.06011832132935524, "acc": 0.9793108105659485, "length": 5.998754978179932, "mode": "train", "epoch": 45}
{"loss": 0.146762415766716, "acc": 0.9427734017372131, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.06083120405673981, "acc": 0.9774277210235596, "length": 5.998986721038818, "mode": "train", "epoch": 46}
{"loss": 0.16956020891666412, "acc": 0.9457030892372131, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.05979873612523079, "acc": 0.979434609413147, "length": 5.9991278648376465, "mode": "train", "epoch": 47}
{"loss": 0.14892426133155823, "acc": 0.9486327767372131, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.05085313320159912, "acc": 0.9833382964134216, "length": 5.99939489364624, "mode": "train", "epoch": 48}
{"loss": 0.1309393346309662, "acc": 0.9564452767372131, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.05327064171433449, "acc": 0.9813202619552612, "length": 5.99875020980835, "mode": "train", "epoch": 49}
{"loss": 0.14619630575180054, "acc": 0.9496093392372131, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.05094863846898079, "acc": 0.9845103025436401, "length": 5.9990973472595215, "mode": "train", "epoch": 50}
{"loss": 0.13982273638248444, "acc": 0.9541015625, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.045551300048828125, "acc": 0.9857615232467651, "length": 5.999483585357666, "mode": "train", "epoch": 51}
{"loss": 0.14218337833881378, "acc": 0.9521484971046448, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.0563446506857872, "acc": 0.9835748672485352, "length": 5.999415397644043, "mode": "train", "epoch": 52}
{"loss": 0.2035015970468521, "acc": 0.9416016936302185, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.05647445097565651, "acc": 0.9798014760017395, "length": 5.999589920043945, "mode": "train", "epoch": 53}
{"loss": 0.15142354369163513, "acc": 0.9572266340255737, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.04666934534907341, "acc": 0.9846353530883789, "length": 5.9994120597839355, "mode": "train", "epoch": 54}
{"loss": 0.19119563698768616, "acc": 0.9425782561302185, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.049470141530036926, "acc": 0.9842833876609802, "length": 5.999517917633057, "mode": "train", "epoch": 55}
{"loss": 0.1685638278722763, "acc": 0.9519530534744263, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.045325376093387604, "acc": 0.9874175786972046, "length": 5.999597549438477, "mode": "train", "epoch": 56}
{"loss": 0.13082855939865112, "acc": 0.9632812142372131, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.04034343361854553, "acc": 0.9865326285362244, "length": 5.999667167663574, "mode": "train", "epoch": 57}
{"loss": 0.12766771018505096, "acc": 0.96484375, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.04292929172515869, "acc": 0.9881232380867004, "length": 5.999599456787109, "mode": "train", "epoch": 58}
{"loss": 0.1575198769569397, "acc": 0.9583984017372131, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.0361480750143528, "acc": 0.9895451068878174, "length": 5.999704837799072, "mode": "train", "epoch": 59}
{"loss": 0.14901518821716309, "acc": 0.9591797590255737, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.05900533124804497, "acc": 0.9819312691688538, "length": 5.999790191650391, "mode": "train", "epoch": 60}
{"loss": 0.20041446387767792, "acc": 0.9451171159744263, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.772580623626709
