# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.6960504055023193, "acc": 0.5339419841766357, "length": 4.1544694900512695, "mode": "train", "epoch": 1}
{"loss": 0.6873054504394531, "acc": 0.563671886920929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6780292391777039, "acc": 0.5685176849365234, "length": 1.9109654426574707, "mode": "train", "epoch": 2}
{"loss": 0.6214903593063354, "acc": 0.7206908464431763, "length": 4.90625, "mode": "test", "epoch": 2}
{"loss": 0.5889896154403687, "acc": 0.7137601375579834, "length": 3.0159037113189697, "mode": "train", "epoch": 3}
{"loss": 0.5586034059524536, "acc": 0.7233642935752869, "length": 2.2578125, "mode": "test", "epoch": 3}
{"loss": 0.5521708726882935, "acc": 0.7287152409553528, "length": 2.309966564178467, "mode": "train", "epoch": 4}
{"loss": 0.5281175971031189, "acc": 0.7476135492324829, "length": 2.828125, "mode": "test", "epoch": 4}
{"loss": 0.502151608467102, "acc": 0.7687170505523682, "length": 2.735668659210205, "mode": "train", "epoch": 5}
{"loss": 0.5200477242469788, "acc": 0.7617431879043579, "length": 3.87109375, "mode": "test", "epoch": 5}
{"loss": 0.4598221182823181, "acc": 0.7824405431747437, "length": 2.7533602714538574, "mode": "train", "epoch": 6}
{"loss": 0.492548406124115, "acc": 0.7817139029502869, "length": 3.3984375, "mode": "test", "epoch": 6}
{"loss": 0.4411473870277405, "acc": 0.785222053527832, "length": 2.655703067779541, "mode": "train", "epoch": 7}
{"loss": 0.49037641286849976, "acc": 0.7789978384971619, "length": 2.85546875, "mode": "test", "epoch": 7}
{"loss": 0.4296956956386566, "acc": 0.7999716997146606, "length": 2.666728973388672, "mode": "train", "epoch": 8}
{"loss": 0.47713324427604675, "acc": 0.7942688465118408, "length": 2.75390625, "mode": "test", "epoch": 8}
{"loss": 0.40975674986839294, "acc": 0.8121005892753601, "length": 2.9445812702178955, "mode": "train", "epoch": 9}
{"loss": 0.4672105610370636, "acc": 0.7842040657997131, "length": 2.65234375, "mode": "test", "epoch": 9}
{"loss": 0.38295432925224304, "acc": 0.8262337446212769, "length": 3.5762827396392822, "mode": "train", "epoch": 10}
{"loss": 0.43756547570228577, "acc": 0.798358142375946, "length": 3.43359375, "mode": "test", "epoch": 10}
{"loss": 0.3606487810611725, "acc": 0.8457687497138977, "length": 4.203233242034912, "mode": "train", "epoch": 11}
{"loss": 0.43602174520492554, "acc": 0.814495861530304, "length": 3.48828125, "mode": "test", "epoch": 11}
{"loss": 0.3399375081062317, "acc": 0.8521581292152405, "length": 4.394387722015381, "mode": "train", "epoch": 12}
{"loss": 0.41217872500419617, "acc": 0.817474365234375, "length": 4.30078125, "mode": "test", "epoch": 12}
{"loss": 0.32193851470947266, "acc": 0.8615490794181824, "length": 4.901240348815918, "mode": "train", "epoch": 13}
{"loss": 0.4463234543800354, "acc": 0.8093323111534119, "length": 4.67578125, "mode": "test", "epoch": 13}
{"loss": 0.30512508749961853, "acc": 0.8680698275566101, "length": 5.277583122253418, "mode": "train", "epoch": 14}
{"loss": 0.4467928111553192, "acc": 0.808972179889679, "length": 4.859375, "mode": "test", "epoch": 14}
{"loss": 0.2905769348144531, "acc": 0.8774012327194214, "length": 5.83081579208374, "mode": "train", "epoch": 15}
{"loss": 0.456074595451355, "acc": 0.82196044921875, "length": 5.23046875, "mode": "test", "epoch": 15}
{"loss": 0.2767283320426941, "acc": 0.8870102167129517, "length": 5.866640567779541, "mode": "train", "epoch": 16}
{"loss": 0.34173259139060974, "acc": 0.86920166015625, "length": 5.61328125, "mode": "test", "epoch": 16}
{"loss": 0.26473289728164673, "acc": 0.8901501893997192, "length": 6.144689559936523, "mode": "train", "epoch": 17}
{"loss": 0.33825746178627014, "acc": 0.8686279654502869, "length": 6.359375, "mode": "test", "epoch": 17}
{"loss": 0.2554393708705902, "acc": 0.8958122730255127, "length": 6.406444549560547, "mode": "train", "epoch": 18}
{"loss": 0.3869182765483856, "acc": 0.860198974609375, "length": 6.6171875, "mode": "test", "epoch": 18}
{"loss": 0.2434326708316803, "acc": 0.9001184701919556, "length": 6.675792694091797, "mode": "train", "epoch": 19}
{"loss": 0.37768468260765076, "acc": 0.8564574718475342, "length": 5.859375, "mode": "test", "epoch": 19}
{"loss": 0.22158721089363098, "acc": 0.914011538028717, "length": 6.593120098114014, "mode": "train", "epoch": 20}
{"loss": 0.30546629428863525, "acc": 0.8875976204872131, "length": 6.67578125, "mode": "test", "epoch": 20}
{"loss": 0.20177944004535675, "acc": 0.9232598543167114, "length": 7.377223491668701, "mode": "train", "epoch": 21}
{"loss": 0.326750785112381, "acc": 0.8804566264152527, "length": 7.265625, "mode": "test", "epoch": 21}
{"loss": 0.20561666786670685, "acc": 0.9211072325706482, "length": 7.22567892074585, "mode": "train", "epoch": 22}
{"loss": 0.2857070565223694, "acc": 0.8882812857627869, "length": 6.3046875, "mode": "test", "epoch": 22}
{"loss": 0.17877137660980225, "acc": 0.931756317615509, "length": 7.000449180603027, "mode": "train", "epoch": 23}
{"loss": 0.2738470435142517, "acc": 0.8962158560752869, "length": 7.9375, "mode": "test", "epoch": 23}
{"loss": 0.15926842391490936, "acc": 0.9423655271530151, "length": 8.487494468688965, "mode": "train", "epoch": 24}
{"loss": 0.2367982268333435, "acc": 0.908905029296875, "length": 8.125, "mode": "test", "epoch": 24}
{"loss": 0.14608249068260193, "acc": 0.9490060806274414, "length": 8.5841703414917, "mode": "train", "epoch": 25}
{"loss": 0.23780344426631927, "acc": 0.9099060893058777, "length": 9.0078125, "mode": "test", "epoch": 25}
{"loss": 0.13184142112731934, "acc": 0.9573949575424194, "length": 8.939632415771484, "mode": "train", "epoch": 26}
{"loss": 0.23394088447093964, "acc": 0.9126343131065369, "length": 8.8671875, "mode": "test", "epoch": 26}
{"loss": 0.12316490709781647, "acc": 0.9594745635986328, "length": 9.306551933288574, "mode": "train", "epoch": 27}
{"loss": 0.2092716246843338, "acc": 0.9170349836349487, "length": 9.7421875, "mode": "test", "epoch": 27}
{"loss": 0.12865540385246277, "acc": 0.9552023410797119, "length": 9.155059814453125, "mode": "train", "epoch": 28}
{"loss": 0.21395348012447357, "acc": 0.914624035358429, "length": 9.546875, "mode": "test", "epoch": 28}
{"loss": 0.119486004114151, "acc": 0.9596556425094604, "length": 9.44689655303955, "mode": "train", "epoch": 29}
{"loss": 0.18818171322345734, "acc": 0.9289001226425171, "length": 9.51171875, "mode": "test", "epoch": 29}
{"loss": 0.10463100671768188, "acc": 0.9673976898193359, "length": 9.805797576904297, "mode": "train", "epoch": 30}
{"loss": 0.16926908493041992, "acc": 0.934844970703125, "length": 9.8984375, "mode": "test", "epoch": 30}
{"loss": 0.1007382795214653, "acc": 0.9663964509963989, "length": 9.65007209777832, "mode": "train", "epoch": 31}
{"loss": 0.21546317636966705, "acc": 0.921704113483429, "length": 9.59765625, "mode": "test", "epoch": 31}
{"loss": 0.09712523967027664, "acc": 0.970254123210907, "length": 9.769872665405273, "mode": "train", "epoch": 32}
{"loss": 0.1849755048751831, "acc": 0.9327453970909119, "length": 9.76171875, "mode": "test", "epoch": 32}
{"loss": 0.08988633751869202, "acc": 0.9731975197792053, "length": 9.945531845092773, "mode": "train", "epoch": 33}
{"loss": 0.18235474824905396, "acc": 0.935803234577179, "length": 9.88671875, "mode": "test", "epoch": 33}
{"loss": 0.07959774136543274, "acc": 0.9774738550186157, "length": 10.059017181396484, "mode": "train", "epoch": 34}
{"loss": 0.17663832008838654, "acc": 0.9414917230606079, "length": 10.1484375, "mode": "test", "epoch": 34}
{"loss": 0.07153810560703278, "acc": 0.9818259477615356, "length": 10.27241325378418, "mode": "train", "epoch": 35}
{"loss": 0.16640055179595947, "acc": 0.9436584115028381, "length": 10.30859375, "mode": "test", "epoch": 35}
{"loss": 0.06786628067493439, "acc": 0.9825838208198547, "length": 10.210264205932617, "mode": "train", "epoch": 36}
{"loss": 0.19068188965320587, "acc": 0.9390137195587158, "length": 10.02734375, "mode": "test", "epoch": 36}
{"loss": 0.08554978668689728, "acc": 0.9732180833816528, "length": 9.915716171264648, "mode": "train", "epoch": 37}
{"loss": 0.14701108634471893, "acc": 0.9511963129043579, "length": 10.33984375, "mode": "test", "epoch": 37}
{"loss": 0.06821606308221817, "acc": 0.9819925427436829, "length": 10.02139949798584, "mode": "train", "epoch": 38}
{"loss": 0.14929001033306122, "acc": 0.951129138469696, "length": 10.36328125, "mode": "test", "epoch": 38}
{"loss": 0.06259287893772125, "acc": 0.9846079349517822, "length": 10.359747886657715, "mode": "train", "epoch": 39}
{"loss": 0.1626153588294983, "acc": 0.9569762945175171, "length": 10.30859375, "mode": "test", "epoch": 39}
{"loss": 0.06314928084611893, "acc": 0.9830644726753235, "length": 10.2384614944458, "mode": "train", "epoch": 40}
{"loss": 0.11445523798465729, "acc": 0.9622802734375, "length": 10.60546875, "mode": "test", "epoch": 40}
{"loss": 0.04950395226478577, "acc": 0.9896508455276489, "length": 10.493852615356445, "mode": "train", "epoch": 41}
{"loss": 0.13849681615829468, "acc": 0.9570678472518921, "length": 10.5859375, "mode": "test", "epoch": 41}
{"loss": 0.047892529517412186, "acc": 0.9899908304214478, "length": 10.238897323608398, "mode": "train", "epoch": 42}
{"loss": 0.11817000806331635, "acc": 0.9647766351699829, "length": 10.3203125, "mode": "test", "epoch": 42}
{"loss": 0.03920261189341545, "acc": 0.9940015077590942, "length": 10.311348915100098, "mode": "train", "epoch": 43}
{"loss": 0.10750944912433624, "acc": 0.9721924066543579, "length": 10.54296875, "mode": "test", "epoch": 43}
{"loss": 0.0340297557413578, "acc": 0.9955779910087585, "length": 10.514290809631348, "mode": "train", "epoch": 44}
{"loss": 0.08204273134469986, "acc": 0.9753174185752869, "length": 10.6484375, "mode": "test", "epoch": 44}
{"loss": 0.03139356151223183, "acc": 0.996173620223999, "length": 10.482471466064453, "mode": "train", "epoch": 45}
{"loss": 0.07837920635938644, "acc": 0.9800048470497131, "length": 10.57421875, "mode": "test", "epoch": 45}
{"loss": 0.03061690554022789, "acc": 0.9960381984710693, "length": 10.538006782531738, "mode": "train", "epoch": 46}
{"loss": 0.0819755345582962, "acc": 0.978924572467804, "length": 10.5390625, "mode": "test", "epoch": 46}
{"loss": 0.03428453579545021, "acc": 0.994793176651001, "length": 10.430891990661621, "mode": "train", "epoch": 47}
{"loss": 0.10932743549346924, "acc": 0.977551281452179, "length": 10.44140625, "mode": "test", "epoch": 47}
{"loss": 0.034181781113147736, "acc": 0.9942360520362854, "length": 10.462494850158691, "mode": "train", "epoch": 48}
{"loss": 0.09939046204090118, "acc": 0.9760803580284119, "length": 10.4921875, "mode": "test", "epoch": 48}
{"loss": 0.02717629261314869, "acc": 0.9979627132415771, "length": 10.480973243713379, "mode": "train", "epoch": 49}
{"loss": 0.0733533650636673, "acc": 0.9773560166358948, "length": 10.5078125, "mode": "test", "epoch": 49}
{"loss": 0.022939670830965042, "acc": 0.9987932443618774, "length": 10.532601356506348, "mode": "train", "epoch": 50}
{"loss": 0.08470511436462402, "acc": 0.9800049662590027, "length": 10.671875, "mode": "test", "epoch": 50}
{"loss": 0.020681040361523628, "acc": 0.9994246363639832, "length": 10.604819297790527, "mode": "train", "epoch": 51}
{"loss": 0.07793496549129486, "acc": 0.981048583984375, "length": 10.7734375, "mode": "test", "epoch": 51}
{"loss": 0.02293480932712555, "acc": 0.9984384179115295, "length": 10.669251441955566, "mode": "train", "epoch": 52}
{"loss": 0.10101579129695892, "acc": 0.976275622844696, "length": 10.58984375, "mode": "test", "epoch": 52}
{"loss": 0.022901738062500954, "acc": 0.9982678294181824, "length": 10.616751670837402, "mode": "train", "epoch": 53}
{"loss": 0.07884082198143005, "acc": 0.9791869521141052, "length": 10.734375, "mode": "test", "epoch": 53}
{"loss": 0.024251127615571022, "acc": 0.9971705079078674, "length": 10.627774238586426, "mode": "train", "epoch": 54}
{"loss": 0.07819107174873352, "acc": 0.9786133766174316, "length": 10.70703125, "mode": "test", "epoch": 54}
{"loss": 0.02296334132552147, "acc": 0.9975131154060364, "length": 10.70641040802002, "mode": "train", "epoch": 55}
{"loss": 0.09578113257884979, "acc": 0.9741760492324829, "length": 10.64453125, "mode": "test", "epoch": 55}
{"loss": 0.02592790313065052, "acc": 0.9959279894828796, "length": 10.485624313354492, "mode": "train", "epoch": 56}
{"loss": 0.09489019215106964, "acc": 0.977893054485321, "length": 10.66796875, "mode": "test", "epoch": 56}
{"loss": 0.03804101049900055, "acc": 0.991318941116333, "length": 10.648455619812012, "mode": "train", "epoch": 57}
{"loss": 0.24213388562202454, "acc": 0.9447815418243408, "length": 9.9453125, "mode": "test", "epoch": 57}
{"loss": 0.08704133331775665, "acc": 0.9745898842811584, "length": 9.719943046569824, "mode": "train", "epoch": 58}
{"loss": 0.120690256357193, "acc": 0.962939441204071, "length": 9.671875, "mode": "test", "epoch": 58}
{"loss": 0.05615175887942314, "acc": 0.984534502029419, "length": 9.870080947875977, "mode": "train", "epoch": 59}
{"loss": 0.0638325959444046, "acc": 0.9806640148162842, "length": 9.6875, "mode": "test", "epoch": 59}
{"loss": 0.037836264818906784, "acc": 0.9921278953552246, "length": 9.972114562988281, "mode": "train", "epoch": 60}
{"loss": 0.07893024384975433, "acc": 0.9780639410018921, "length": 10.2421875, "mode": "test", "epoch": 60}
test accuracy: 0.8694217205047607
