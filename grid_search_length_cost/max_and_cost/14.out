# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7304227948188782, "acc": 0.5148043036460876, "length": 3.4758641719818115, "mode": "train", "epoch": 1}
{"loss": 0.7035859227180481, "acc": 0.5050346851348877, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7010477185249329, "acc": 0.5078551769256592, "length": 1.0479774475097656, "mode": "train", "epoch": 2}
{"loss": 0.6995508074760437, "acc": 0.5100694894790649, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7015698552131653, "acc": 0.524580717086792, "length": 1.0242332220077515, "mode": "train", "epoch": 3}
{"loss": 0.6996434330940247, "acc": 0.5067708492279053, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7009024620056152, "acc": 0.5070449113845825, "length": 1.017218828201294, "mode": "train", "epoch": 4}
{"loss": 0.6979660391807556, "acc": 0.5177083015441895, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7001089453697205, "acc": 0.5143861770629883, "length": 1.0123075246810913, "mode": "train", "epoch": 5}
{"loss": 0.7006730437278748, "acc": 0.5126736164093018, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6997923851013184, "acc": 0.5257850289344788, "length": 1.009024739265442, "mode": "train", "epoch": 6}
{"loss": 0.6973194479942322, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6992708444595337, "acc": 0.5133497714996338, "length": 1.0069336891174316, "mode": "train", "epoch": 7}
{"loss": 0.6974719166755676, "acc": 0.5067708492279053, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.7000083923339844, "acc": 0.5182631611824036, "length": 1.0054653882980347, "mode": "train", "epoch": 8}
{"loss": 0.6967697143554688, "acc": 0.5204861164093018, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6974704265594482, "acc": 0.510504961013794, "length": 1.0044173002243042, "mode": "train", "epoch": 9}
{"loss": 0.6966904401779175, "acc": 0.5067708492279053, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6969375610351562, "acc": 0.5196163654327393, "length": 1.0035725831985474, "mode": "train", "epoch": 10}
{"loss": 0.6953098177909851, "acc": 0.5309028029441833, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6975528597831726, "acc": 0.50761479139328, "length": 1.002962350845337, "mode": "train", "epoch": 11}
{"loss": 0.6965604424476624, "acc": 0.5078125596046448, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6953110098838806, "acc": 0.5212544798851013, "length": 1.002388834953308, "mode": "train", "epoch": 12}
{"loss": 0.6953029036521912, "acc": 0.5126736164093018, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6953648328781128, "acc": 0.5241970419883728, "length": 1.0020761489868164, "mode": "train", "epoch": 13}
{"loss": 0.6952795386314392, "acc": 0.5192709565162659, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6947364807128906, "acc": 0.5240225195884705, "length": 1.0018020868301392, "mode": "train", "epoch": 14}
{"loss": 0.6929382085800171, "acc": 0.5114584565162659, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6935230493545532, "acc": 0.5371795892715454, "length": 1.0015151500701904, "mode": "train", "epoch": 15}
{"loss": 0.6909266710281372, "acc": 0.5491319894790649, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6915732622146606, "acc": 0.5349195003509521, "length": 1.0013066530227661, "mode": "train", "epoch": 16}
{"loss": 0.6919636130332947, "acc": 0.5256944894790649, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6920253038406372, "acc": 0.5366644859313965, "length": 1.0011308193206787, "mode": "train", "epoch": 17}
{"loss": 0.6913341879844666, "acc": 0.5274305939674377, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6906995177268982, "acc": 0.5469838976860046, "length": 1.0010340213775635, "mode": "train", "epoch": 18}
{"loss": 0.6918819546699524, "acc": 0.5387153029441833, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6900823712348938, "acc": 0.5274346470832825, "length": 1.0008713006973267, "mode": "train", "epoch": 19}
{"loss": 0.6917831301689148, "acc": 0.5147569179534912, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6890404224395752, "acc": 0.5426934957504272, "length": 1.000706672668457, "mode": "train", "epoch": 20}
{"loss": 0.6876207590103149, "acc": 0.5489583015441895, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6877145171165466, "acc": 0.5545240640640259, "length": 1.0006661415100098, "mode": "train", "epoch": 21}
{"loss": 0.6880231499671936, "acc": 0.5383680462837219, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6898142099380493, "acc": 0.5456482172012329, "length": 1.0005671977996826, "mode": "train", "epoch": 22}
{"loss": 0.6867743730545044, "acc": 0.5406249761581421, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6857174038887024, "acc": 0.563861072063446, "length": 1.000483751296997, "mode": "train", "epoch": 23}
{"loss": 0.6897945404052734, "acc": 0.5383680462837219, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6868301630020142, "acc": 0.5541760921478271, "length": 1.000460147857666, "mode": "train", "epoch": 24}
{"loss": 0.6857574582099915, "acc": 0.5550346970558167, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6867721080780029, "acc": 0.5506399273872375, "length": 1.0003818273544312, "mode": "train", "epoch": 25}
{"loss": 0.687658429145813, "acc": 0.5401041507720947, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.685692548751831, "acc": 0.55527663230896, "length": 1.0003554821014404, "mode": "train", "epoch": 26}
{"loss": 0.6854575276374817, "acc": 0.5536458492279053, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.686539888381958, "acc": 0.555162787437439, "length": 1.0003156661987305, "mode": "train", "epoch": 27}
{"loss": 0.6854375004768372, "acc": 0.5404514074325562, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6863043904304504, "acc": 0.5578857064247131, "length": 1.0002645254135132, "mode": "train", "epoch": 28}
{"loss": 0.6867662668228149, "acc": 0.5585069060325623, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6855747103691101, "acc": 0.5644991397857666, "length": 1.000230073928833, "mode": "train", "epoch": 29}
{"loss": 0.6865914463996887, "acc": 0.5539930462837219, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6851338148117065, "acc": 0.5614839792251587, "length": 1.0002208948135376, "mode": "train", "epoch": 30}
{"loss": 0.6861116886138916, "acc": 0.5623263716697693, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6855393052101135, "acc": 0.562238872051239, "length": 1.0001941919326782, "mode": "train", "epoch": 31}
{"loss": 0.6870033144950867, "acc": 0.5465278029441833, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6857701539993286, "acc": 0.5603816509246826, "length": 1.0001730918884277, "mode": "train", "epoch": 32}
{"loss": 0.6866320967674255, "acc": 0.5583333373069763, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6859585642814636, "acc": 0.5582939982414246, "length": 1.0001394748687744, "mode": "train", "epoch": 33}
{"loss": 0.6870209574699402, "acc": 0.5623263716697693, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6845355033874512, "acc": 0.5610203146934509, "length": 1.0001263618469238, "mode": "train", "epoch": 34}
{"loss": 0.6851204037666321, "acc": 0.5520833134651184, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6845023036003113, "acc": 0.5639776587486267, "length": 1.0001251697540283, "mode": "train", "epoch": 35}
{"loss": 0.6857404708862305, "acc": 0.5475695133209229, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6847696900367737, "acc": 0.5577149987220764, "length": 1.00010347366333, "mode": "train", "epoch": 36}
{"loss": 0.6847613453865051, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6844318509101868, "acc": 0.5593385696411133, "length": 1.0001029968261719, "mode": "train", "epoch": 37}
{"loss": 0.6877931952476501, "acc": 0.5333333015441895, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6864983439445496, "acc": 0.5514500141143799, "length": 1.0000841617584229, "mode": "train", "epoch": 38}
{"loss": 0.6864330768585205, "acc": 0.5536458492279053, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6840256452560425, "acc": 0.5582942962646484, "length": 1.0000914335250854, "mode": "train", "epoch": 39}
{"loss": 0.6850255131721497, "acc": 0.5390625, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6840428709983826, "acc": 0.5627607107162476, "length": 1.0000731945037842, "mode": "train", "epoch": 40}
{"loss": 0.6858041286468506, "acc": 0.5498263835906982, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6839736104011536, "acc": 0.5573073625564575, "length": 1.0000712871551514, "mode": "train", "epoch": 41}
{"loss": 0.6864429116249084, "acc": 0.529340386390686, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6842032670974731, "acc": 0.5625287294387817, "length": 1.0000537633895874, "mode": "train", "epoch": 42}
{"loss": 0.6856558322906494, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6854298114776611, "acc": 0.5578305721282959, "length": 1.0000450611114502, "mode": "train", "epoch": 43}
{"loss": 0.6885579228401184, "acc": 0.5354167222976685, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6841170787811279, "acc": 0.5598604679107666, "length": 1.0000466108322144, "mode": "train", "epoch": 44}
{"loss": 0.6847647428512573, "acc": 0.5569444894790649, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6842143535614014, "acc": 0.5575404763221741, "length": 1.0000361204147339, "mode": "train", "epoch": 45}
{"loss": 0.6871110796928406, "acc": 0.5451388955116272, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6840039491653442, "acc": 0.5668212175369263, "length": 1.0000296831130981, "mode": "train", "epoch": 46}
{"loss": 0.6853379607200623, "acc": 0.5453125238418579, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6843200325965881, "acc": 0.5609045624732971, "length": 1.00002920627594, "mode": "train", "epoch": 47}
{"loss": 0.6858081817626953, "acc": 0.5453125238418579, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6841259598731995, "acc": 0.5624128580093384, "length": 1.0000309944152832, "mode": "train", "epoch": 48}
{"loss": 0.6873817443847656, "acc": 0.5451388955116272, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6836145520210266, "acc": 0.5627029538154602, "length": 1.0000226497650146, "mode": "train", "epoch": 49}
{"loss": 0.6852622628211975, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6841894388198853, "acc": 0.5653131604194641, "length": 1.0000180006027222, "mode": "train", "epoch": 50}
{"loss": 0.6854914426803589, "acc": 0.5524306297302246, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6836062073707581, "acc": 0.5678072571754456, "length": 1.0000202655792236, "mode": "train", "epoch": 51}
{"loss": 0.6860465407371521, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6835952401161194, "acc": 0.5630509257316589, "length": 1.0000160932540894, "mode": "train", "epoch": 52}
{"loss": 0.6864378452301025, "acc": 0.5453125238418579, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6836299300193787, "acc": 0.5586426258087158, "length": 1.000015139579773, "mode": "train", "epoch": 53}
{"loss": 0.6850472092628479, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.683671236038208, "acc": 0.5560904145240784, "length": 1.0000118017196655, "mode": "train", "epoch": 54}
{"loss": 0.6860803961753845, "acc": 0.5451388955116272, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6840845942497253, "acc": 0.567633330821991, "length": 1.0000137090682983, "mode": "train", "epoch": 55}
{"loss": 0.6854909062385559, "acc": 0.5498263835906982, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6828466653823853, "acc": 0.5650231838226318, "length": 1.0000085830688477, "mode": "train", "epoch": 56}
{"loss": 0.6856529712677002, "acc": 0.5362846851348877, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6831070780754089, "acc": 0.5653711557388306, "length": 1.0000073909759521, "mode": "train", "epoch": 57}
{"loss": 0.6867169737815857, "acc": 0.5390625, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6833286285400391, "acc": 0.5639210939407349, "length": 1.0000077486038208, "mode": "train", "epoch": 58}
{"loss": 0.6852154731750488, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6826274394989014, "acc": 0.5667633414268494, "length": 1.0000073909759521, "mode": "train", "epoch": 59}
{"loss": 0.68642657995224, "acc": 0.5255208015441895, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6828827261924744, "acc": 0.5642111301422119, "length": 1.0000053644180298, "mode": "train", "epoch": 60}
{"loss": 0.6867372989654541, "acc": 0.5362846851348877, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.28655171394348145
