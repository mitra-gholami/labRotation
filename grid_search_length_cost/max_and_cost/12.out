# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7159397602081299, "acc": 0.5205974578857422, "length": 2.194655179977417, "mode": "train", "epoch": 1}
{"loss": 0.7031214833259583, "acc": 0.5181640982627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7014008164405823, "acc": 0.5161908864974976, "length": 1.0388048887252808, "mode": "train", "epoch": 2}
{"loss": 0.6996474266052246, "acc": 0.5238280892372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7003859877586365, "acc": 0.5220482349395752, "length": 1.014631986618042, "mode": "train", "epoch": 3}
{"loss": 0.6996535658836365, "acc": 0.5119141936302185, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7004064917564392, "acc": 0.5266769528388977, "length": 1.0097051858901978, "mode": "train", "epoch": 4}
{"loss": 0.7030866146087646, "acc": 0.517578125, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7005550265312195, "acc": 0.5224114060401917, "length": 1.0070862770080566, "mode": "train", "epoch": 5}
{"loss": 0.6987746357917786, "acc": 0.520703136920929, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.7001497745513916, "acc": 0.529679000377655, "length": 1.0050173997879028, "mode": "train", "epoch": 6}
{"loss": 0.6993339657783508, "acc": 0.5183594226837158, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6995289921760559, "acc": 0.5296788811683655, "length": 1.003690242767334, "mode": "train", "epoch": 7}
{"loss": 0.6997485756874084, "acc": 0.537109375, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6999241709709167, "acc": 0.5269301533699036, "length": 1.0030436515808105, "mode": "train", "epoch": 8}
{"loss": 0.6969882249832153, "acc": 0.533984363079071, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.699311375617981, "acc": 0.5266825556755066, "length": 1.002356767654419, "mode": "train", "epoch": 9}
{"loss": 0.6999596357345581, "acc": 0.5283203125, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6995599865913391, "acc": 0.5263489484786987, "length": 1.0019047260284424, "mode": "train", "epoch": 10}
{"loss": 0.6994176506996155, "acc": 0.5183594226837158, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6992404460906982, "acc": 0.5282668471336365, "length": 1.001633882522583, "mode": "train", "epoch": 11}
{"loss": 0.6989616751670837, "acc": 0.515820324420929, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6995387077331543, "acc": 0.5213114023208618, "length": 1.0013200044631958, "mode": "train", "epoch": 12}
{"loss": 0.6999861001968384, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6999454498291016, "acc": 0.5283295512199402, "length": 1.001128911972046, "mode": "train", "epoch": 13}
{"loss": 0.6975433826446533, "acc": 0.529492199420929, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.7012558579444885, "acc": 0.5222464799880981, "length": 1.0009260177612305, "mode": "train", "epoch": 14}
{"loss": 0.7004934549331665, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6997278332710266, "acc": 0.5278617143630981, "length": 1.0008113384246826, "mode": "train", "epoch": 15}
{"loss": 0.6994345188140869, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6980421543121338, "acc": 0.5273988246917725, "length": 1.0007070302963257, "mode": "train", "epoch": 16}
{"loss": 0.6980416178703308, "acc": 0.520703136920929, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6993870735168457, "acc": 0.5249407887458801, "length": 1.000555157661438, "mode": "train", "epoch": 17}
{"loss": 0.6977223753929138, "acc": 0.5251953601837158, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6985678672790527, "acc": 0.5251180529594421, "length": 1.0005096197128296, "mode": "train", "epoch": 18}
{"loss": 0.6987926959991455, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6979443430900574, "acc": 0.5324313044548035, "length": 1.0004361867904663, "mode": "train", "epoch": 19}
{"loss": 0.6978728175163269, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6986716389656067, "acc": 0.5258775353431702, "length": 1.0003736019134521, "mode": "train", "epoch": 20}
{"loss": 0.6981859803199768, "acc": 0.5183594226837158, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6978607177734375, "acc": 0.5327832698822021, "length": 1.0003243684768677, "mode": "train", "epoch": 21}
{"loss": 0.6965716481208801, "acc": 0.5208984017372131, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6984806060791016, "acc": 0.5259336829185486, "length": 1.0003060102462769, "mode": "train", "epoch": 22}
{"loss": 0.6995165348052979, "acc": 0.533203125, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6979297399520874, "acc": 0.5314981937408447, "length": 1.000249981880188, "mode": "train", "epoch": 23}
{"loss": 0.6952816247940063, "acc": 0.532031238079071, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6974149942398071, "acc": 0.5322589874267578, "length": 1.0002169609069824, "mode": "train", "epoch": 24}
{"loss": 0.6982442140579224, "acc": 0.5218749642372131, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6978521943092346, "acc": 0.5314398407936096, "length": 1.000197410583496, "mode": "train", "epoch": 25}
{"loss": 0.6982619762420654, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6968643665313721, "acc": 0.5317891836166382, "length": 1.000173807144165, "mode": "train", "epoch": 26}
{"loss": 0.6962331533432007, "acc": 0.537109375, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6964084506034851, "acc": 0.5327853560447693, "length": 1.0001469850540161, "mode": "train", "epoch": 27}
{"loss": 0.6983779668807983, "acc": 0.523242175579071, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.696779727935791, "acc": 0.5452548265457153, "length": 1.0001521110534668, "mode": "train", "epoch": 28}
{"loss": 0.6972917318344116, "acc": 0.5179687142372131, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6963862776756287, "acc": 0.5348355174064636, "length": 1.0001181364059448, "mode": "train", "epoch": 29}
{"loss": 0.69472736120224, "acc": 0.5515623688697815, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6975954174995422, "acc": 0.5249999165534973, "length": 1.0001064538955688, "mode": "train", "epoch": 30}
{"loss": 0.6951130628585815, "acc": 0.546875, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6965363025665283, "acc": 0.5385233163833618, "length": 1.0000996589660645, "mode": "train", "epoch": 31}
{"loss": 0.6939961910247803, "acc": 0.5490233898162842, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6964991688728333, "acc": 0.5401045680046082, "length": 1.0000736713409424, "mode": "train", "epoch": 32}
{"loss": 0.6963478326797485, "acc": 0.5236327648162842, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6956515908241272, "acc": 0.541275143623352, "length": 1.0000723600387573, "mode": "train", "epoch": 33}
{"loss": 0.6946461200714111, "acc": 0.5398437976837158, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.695315420627594, "acc": 0.5431488156318665, "length": 1.0000636577606201, "mode": "train", "epoch": 34}
{"loss": 0.6948535442352295, "acc": 0.5421874523162842, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6965311169624329, "acc": 0.5420368909835815, "length": 1.0000550746917725, "mode": "train", "epoch": 35}
{"loss": 0.6953120827674866, "acc": 0.5171875357627869, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6957869529724121, "acc": 0.5452565550804138, "length": 1.0000487565994263, "mode": "train", "epoch": 36}
{"loss": 0.6942276954650879, "acc": 0.5273438096046448, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6949947476387024, "acc": 0.5427982211112976, "length": 1.0000394582748413, "mode": "train", "epoch": 37}
{"loss": 0.6938527822494507, "acc": 0.5328125357627869, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6956311464309692, "acc": 0.543148934841156, "length": 1.0000439882278442, "mode": "train", "epoch": 38}
{"loss": 0.6947771310806274, "acc": 0.5308594107627869, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6956669688224792, "acc": 0.5442032814025879, "length": 1.0000311136245728, "mode": "train", "epoch": 39}
{"loss": 0.6954727172851562, "acc": 0.518359363079071, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6945216655731201, "acc": 0.5464281439781189, "length": 1.000027060508728, "mode": "train", "epoch": 40}
{"loss": 0.6938538551330566, "acc": 0.5337890982627869, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6954683661460876, "acc": 0.5432080030441284, "length": 1.0000269412994385, "mode": "train", "epoch": 41}
{"loss": 0.6948468685150146, "acc": 0.5474609732627869, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6944831609725952, "acc": 0.5457842350006104, "length": 1.0000228881835938, "mode": "train", "epoch": 42}
{"loss": 0.6937172412872314, "acc": 0.5166015625, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.694872260093689, "acc": 0.5457842350006104, "length": 1.000022053718567, "mode": "train", "epoch": 43}
{"loss": 0.6951136589050293, "acc": 0.5189452767372131, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6947726011276245, "acc": 0.5423299670219421, "length": 1.0000171661376953, "mode": "train", "epoch": 44}
{"loss": 0.6946655511856079, "acc": 0.541015625, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6948691010475159, "acc": 0.5469552874565125, "length": 1.0000181198120117, "mode": "train", "epoch": 45}
{"loss": 0.6924349665641785, "acc": 0.5314452648162842, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6949203610420227, "acc": 0.5343090891838074, "length": 1.0000147819519043, "mode": "train", "epoch": 46}
{"loss": 0.6951048374176025, "acc": 0.5238280892372131, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6943784952163696, "acc": 0.5446717739105225, "length": 1.000014066696167, "mode": "train", "epoch": 47}
{"loss": 0.6924481391906738, "acc": 0.5277343392372131, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6952880024909973, "acc": 0.5397539734840393, "length": 1.000008463859558, "mode": "train", "epoch": 48}
{"loss": 0.6944172382354736, "acc": 0.5302734971046448, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6947773694992065, "acc": 0.547189474105835, "length": 1.0000088214874268, "mode": "train", "epoch": 49}
{"loss": 0.692810595035553, "acc": 0.525390625, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6935545206069946, "acc": 0.5545666217803955, "length": 1.0000076293945312, "mode": "train", "epoch": 50}
{"loss": 0.694171667098999, "acc": 0.5179687142372131, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6942597031593323, "acc": 0.5531029105186462, "length": 1.0000070333480835, "mode": "train", "epoch": 51}
{"loss": 0.6933682560920715, "acc": 0.5367187857627869, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6936779618263245, "acc": 0.5521661639213562, "length": 1.0000059604644775, "mode": "train", "epoch": 52}
{"loss": 0.6928106546401978, "acc": 0.522265613079071, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6939499974250793, "acc": 0.5442036986351013, "length": 1.0000052452087402, "mode": "train", "epoch": 53}
{"loss": 0.6934884190559387, "acc": 0.5328125357627869, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6935920715332031, "acc": 0.5473066568374634, "length": 1.0000050067901611, "mode": "train", "epoch": 54}
{"loss": 0.6924737691879272, "acc": 0.5523437857627869, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6945356726646423, "acc": 0.5459015369415283, "length": 1.000003695487976, "mode": "train", "epoch": 55}
{"loss": 0.6928287744522095, "acc": 0.5386719107627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6949034333229065, "acc": 0.5469554662704468, "length": 1.0000033378601074, "mode": "train", "epoch": 56}
{"loss": 0.6927989721298218, "acc": 0.522265613079071, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6941319108009338, "acc": 0.5440279841423035, "length": 1.0000033378601074, "mode": "train", "epoch": 57}
{"loss": 0.6929709911346436, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6939606070518494, "acc": 0.5451989769935608, "length": 1.0000033378601074, "mode": "train", "epoch": 58}
{"loss": 0.6926762461662292, "acc": 0.5238280892372131, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6942190527915955, "acc": 0.5502927303314209, "length": 1.000002384185791, "mode": "train", "epoch": 59}
{"loss": 0.6933732032775879, "acc": 0.5189452767372131, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6935814619064331, "acc": 0.5490046739578247, "length": 1.0000019073486328, "mode": "train", "epoch": 60}
{"loss": 0.6934623122215271, "acc": 0.526171863079071, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.3141666352748871
