# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7021477818489075, "acc": 0.5148958563804626, "length": 5.142670631408691, "mode": "train", "epoch": 1}
{"loss": 0.6962330937385559, "acc": 0.515625, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6914762854576111, "acc": 0.5355145335197449, "length": 1.1466248035430908, "mode": "train", "epoch": 2}
{"loss": 0.6949139833450317, "acc": 0.49550777673721313, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6800312995910645, "acc": 0.5614724159240723, "length": 1.7557687759399414, "mode": "train", "epoch": 3}
{"loss": 0.6432924270629883, "acc": 0.6462097764015198, "length": 2.296875, "mode": "test", "epoch": 3}
{"loss": 0.5960032343864441, "acc": 0.6913390159606934, "length": 4.361096382141113, "mode": "train", "epoch": 4}
{"loss": 0.5854210257530212, "acc": 0.6899597644805908, "length": 2.04296875, "mode": "test", "epoch": 4}
{"loss": 0.5468183159828186, "acc": 0.7159848809242249, "length": 2.628922939300537, "mode": "train", "epoch": 5}
{"loss": 0.5880484580993652, "acc": 0.6940184831619263, "length": 2.8359375, "mode": "test", "epoch": 5}
{"loss": 0.4935034215450287, "acc": 0.7597616314888, "length": 3.3935818672180176, "mode": "train", "epoch": 6}
{"loss": 0.7004802227020264, "acc": 0.738067626953125, "length": 12.32421875, "mode": "test", "epoch": 6}
{"loss": 0.4578404426574707, "acc": 0.7780264019966125, "length": 4.32133674621582, "mode": "train", "epoch": 7}
{"loss": 0.5928448438644409, "acc": 0.7415771484375, "length": 15.08203125, "mode": "test", "epoch": 7}
{"loss": 0.42549970746040344, "acc": 0.7966219186782837, "length": 4.979851722717285, "mode": "train", "epoch": 8}
{"loss": 0.589913010597229, "acc": 0.7467346787452698, "length": 13.1796875, "mode": "test", "epoch": 8}
{"loss": 0.40397000312805176, "acc": 0.8069100379943848, "length": 4.889359474182129, "mode": "train", "epoch": 9}
{"loss": 0.6380681991577148, "acc": 0.769268810749054, "length": 10.328125, "mode": "test", "epoch": 9}
{"loss": 0.39068329334259033, "acc": 0.8146573305130005, "length": 5.0252156257629395, "mode": "train", "epoch": 10}
{"loss": 0.46561992168426514, "acc": 0.7984375357627869, "length": 7.0234375, "mode": "test", "epoch": 10}
{"loss": 0.3643583357334137, "acc": 0.8319749236106873, "length": 5.2015252113342285, "mode": "train", "epoch": 11}
{"loss": 0.45518389344215393, "acc": 0.811126708984375, "length": 5.62890625, "mode": "test", "epoch": 11}
{"loss": 0.3449757695198059, "acc": 0.8478738069534302, "length": 5.682788372039795, "mode": "train", "epoch": 12}
{"loss": 0.40115034580230713, "acc": 0.8318970203399658, "length": 5.78125, "mode": "test", "epoch": 12}
{"loss": 0.31686991453170776, "acc": 0.8648476004600525, "length": 6.042594909667969, "mode": "train", "epoch": 13}
{"loss": 0.35156142711639404, "acc": 0.8489868640899658, "length": 6.1015625, "mode": "test", "epoch": 13}
{"loss": 0.29023152589797974, "acc": 0.8787593245506287, "length": 6.37709903717041, "mode": "train", "epoch": 14}
{"loss": 0.3454747796058655, "acc": 0.8562988638877869, "length": 6.17578125, "mode": "test", "epoch": 14}
{"loss": 0.2799290120601654, "acc": 0.8887065649032593, "length": 6.357359409332275, "mode": "train", "epoch": 15}
{"loss": 0.34672126173973083, "acc": 0.864245593547821, "length": 5.203125, "mode": "test", "epoch": 15}
{"loss": 0.26147645711898804, "acc": 0.8952316641807556, "length": 6.296741008758545, "mode": "train", "epoch": 16}
{"loss": 0.3296906650066376, "acc": 0.87115478515625, "length": 5.74609375, "mode": "test", "epoch": 16}
{"loss": 0.2406887263059616, "acc": 0.9068779349327087, "length": 6.924436092376709, "mode": "train", "epoch": 17}
{"loss": 0.30782097578048706, "acc": 0.8859496712684631, "length": 5.82421875, "mode": "test", "epoch": 17}
{"loss": 0.23142440617084503, "acc": 0.9134754538536072, "length": 7.051529884338379, "mode": "train", "epoch": 18}
{"loss": 0.30817821621894836, "acc": 0.8814025521278381, "length": 5.82421875, "mode": "test", "epoch": 18}
{"loss": 0.22516460716724396, "acc": 0.9140462875366211, "length": 6.792020797729492, "mode": "train", "epoch": 19}
{"loss": 0.2798512279987335, "acc": 0.8969238996505737, "length": 5.9140625, "mode": "test", "epoch": 19}
{"loss": 0.20966219902038574, "acc": 0.9232460856437683, "length": 6.713186740875244, "mode": "train", "epoch": 20}
{"loss": 0.2787187993526459, "acc": 0.9007812142372131, "length": 6.46875, "mode": "test", "epoch": 20}
{"loss": 0.19650545716285706, "acc": 0.9271692037582397, "length": 7.424062728881836, "mode": "train", "epoch": 21}
{"loss": 0.2631823420524597, "acc": 0.9046691656112671, "length": 6.59375, "mode": "test", "epoch": 21}
{"loss": 0.18372716009616852, "acc": 0.9331285357475281, "length": 7.714232444763184, "mode": "train", "epoch": 22}
{"loss": 0.21861913800239563, "acc": 0.9223998785018921, "length": 7.18359375, "mode": "test", "epoch": 22}
{"loss": 0.17045794427394867, "acc": 0.9391801357269287, "length": 7.8619065284729, "mode": "train", "epoch": 23}
{"loss": 0.2419092059135437, "acc": 0.9139953255653381, "length": 6.36328125, "mode": "test", "epoch": 23}
{"loss": 0.16436731815338135, "acc": 0.9422855377197266, "length": 7.660214424133301, "mode": "train", "epoch": 24}
{"loss": 0.21593531966209412, "acc": 0.9252196550369263, "length": 7.09765625, "mode": "test", "epoch": 24}
{"loss": 0.15395423769950867, "acc": 0.9495422840118408, "length": 7.36834192276001, "mode": "train", "epoch": 25}
{"loss": 0.21176911890506744, "acc": 0.921002209186554, "length": 6.515625, "mode": "test", "epoch": 25}
{"loss": 0.13599681854248047, "acc": 0.9545177221298218, "length": 7.490478992462158, "mode": "train", "epoch": 26}
{"loss": 0.17705291509628296, "acc": 0.9350219964981079, "length": 6.9453125, "mode": "test", "epoch": 26}
{"loss": 0.12918439507484436, "acc": 0.9582546949386597, "length": 7.855249404907227, "mode": "train", "epoch": 27}
{"loss": 0.18723128736019135, "acc": 0.937164306640625, "length": 7.265625, "mode": "test", "epoch": 27}
{"loss": 0.12051143497228622, "acc": 0.9623517990112305, "length": 8.203575134277344, "mode": "train", "epoch": 28}
{"loss": 0.16439783573150635, "acc": 0.934277355670929, "length": 7.44140625, "mode": "test", "epoch": 28}
{"loss": 0.11355002969503403, "acc": 0.9640609622001648, "length": 7.9059977531433105, "mode": "train", "epoch": 29}
{"loss": 0.19103658199310303, "acc": 0.9265137910842896, "length": 7.53515625, "mode": "test", "epoch": 29}
{"loss": 0.11484461277723312, "acc": 0.9613909125328064, "length": 8.006006240844727, "mode": "train", "epoch": 30}
{"loss": 0.15707549452781677, "acc": 0.9466063976287842, "length": 7.140625, "mode": "test", "epoch": 30}
{"loss": 0.10311680287122726, "acc": 0.9666140079498291, "length": 8.264688491821289, "mode": "train", "epoch": 31}
{"loss": 0.15242646634578705, "acc": 0.943554699420929, "length": 7.53515625, "mode": "test", "epoch": 31}
{"loss": 0.09148432314395905, "acc": 0.970146119594574, "length": 8.562259674072266, "mode": "train", "epoch": 32}
{"loss": 0.13711290061473846, "acc": 0.9508545398712158, "length": 7.953125, "mode": "test", "epoch": 32}
{"loss": 0.09134706109762192, "acc": 0.9734458327293396, "length": 8.915491104125977, "mode": "train", "epoch": 33}
{"loss": 0.169530987739563, "acc": 0.9421326518058777, "length": 8.09375, "mode": "test", "epoch": 33}
{"loss": 0.08333646506071091, "acc": 0.9771057367324829, "length": 8.81460952758789, "mode": "train", "epoch": 34}
{"loss": 0.13700759410858154, "acc": 0.9568420648574829, "length": 7.88671875, "mode": "test", "epoch": 34}
{"loss": 0.07392092049121857, "acc": 0.9787217974662781, "length": 8.777318954467773, "mode": "train", "epoch": 35}
{"loss": 0.10956822335720062, "acc": 0.963787853717804, "length": 8.27734375, "mode": "test", "epoch": 35}
{"loss": 0.06311892718076706, "acc": 0.9858623743057251, "length": 9.028889656066895, "mode": "train", "epoch": 36}
{"loss": 0.10893455147743225, "acc": 0.9636902809143066, "length": 8.23046875, "mode": "test", "epoch": 36}
{"loss": 0.055722497403621674, "acc": 0.9880018830299377, "length": 8.906986236572266, "mode": "train", "epoch": 37}
{"loss": 0.12228833138942719, "acc": 0.9594299793243408, "length": 8.41015625, "mode": "test", "epoch": 37}
{"loss": 0.054826684296131134, "acc": 0.9884665012359619, "length": 9.324148178100586, "mode": "train", "epoch": 38}
{"loss": 0.1133066713809967, "acc": 0.9646300673484802, "length": 8.875, "mode": "test", "epoch": 38}
{"loss": 0.05890432000160217, "acc": 0.9874952435493469, "length": 9.376035690307617, "mode": "train", "epoch": 39}
{"loss": 0.11674803495407104, "acc": 0.968719482421875, "length": 7.984375, "mode": "test", "epoch": 39}
{"loss": 0.05098504200577736, "acc": 0.9891127943992615, "length": 8.775604248046875, "mode": "train", "epoch": 40}
{"loss": 0.10767839848995209, "acc": 0.9626160264015198, "length": 7.859375, "mode": "test", "epoch": 40}
{"loss": 0.04428641125559807, "acc": 0.9914389848709106, "length": 8.61608600616455, "mode": "train", "epoch": 41}
{"loss": 0.10655659437179565, "acc": 0.965960681438446, "length": 8.015625, "mode": "test", "epoch": 41}
{"loss": 0.042847972363233566, "acc": 0.9928176999092102, "length": 8.65229320526123, "mode": "train", "epoch": 42}
{"loss": 0.10933537036180496, "acc": 0.9650391340255737, "length": 7.97265625, "mode": "test", "epoch": 42}
{"loss": 0.038611702620983124, "acc": 0.99349045753479, "length": 8.909528732299805, "mode": "train", "epoch": 43}
{"loss": 0.10780767351388931, "acc": 0.9647826552391052, "length": 8.20703125, "mode": "test", "epoch": 43}
{"loss": 0.037097930908203125, "acc": 0.9943212270736694, "length": 9.095845222473145, "mode": "train", "epoch": 44}
{"loss": 0.07833166420459747, "acc": 0.9759520888328552, "length": 8.03515625, "mode": "test", "epoch": 44}
{"loss": 0.033697087317705154, "acc": 0.9949526190757751, "length": 8.850211143493652, "mode": "train", "epoch": 45}
{"loss": 0.07900945842266083, "acc": 0.9754822254180908, "length": 8.01953125, "mode": "test", "epoch": 45}
{"loss": 0.02929476462304592, "acc": 0.99587082862854, "length": 9.045543670654297, "mode": "train", "epoch": 46}
{"loss": 0.08971172571182251, "acc": 0.971832275390625, "length": 8.35546875, "mode": "test", "epoch": 46}
{"loss": 0.03017139621078968, "acc": 0.9949357509613037, "length": 8.80715274810791, "mode": "train", "epoch": 47}
{"loss": 0.11194288730621338, "acc": 0.9702697992324829, "length": 8.171875, "mode": "test", "epoch": 47}
{"loss": 0.027764398604631424, "acc": 0.9967420101165771, "length": 8.86496353149414, "mode": "train", "epoch": 48}
{"loss": 0.08372180908918381, "acc": 0.9750487804412842, "length": 8.2109375, "mode": "test", "epoch": 48}
{"loss": 0.04635823518037796, "acc": 0.9897176623344421, "length": 8.533230781555176, "mode": "train", "epoch": 49}
{"loss": 0.08681194484233856, "acc": 0.9682251214981079, "length": 7.39453125, "mode": "test", "epoch": 49}
{"loss": 0.03274872153997421, "acc": 0.9944979548454285, "length": 8.123688697814941, "mode": "train", "epoch": 50}
{"loss": 0.09376221150159836, "acc": 0.9705871939659119, "length": 7.99609375, "mode": "test", "epoch": 50}
{"loss": 0.02869044616818428, "acc": 0.9967124462127686, "length": 8.093952178955078, "mode": "train", "epoch": 51}
{"loss": 0.08557040989398956, "acc": 0.9729125499725342, "length": 7.35546875, "mode": "test", "epoch": 51}
{"loss": 0.03775400668382645, "acc": 0.9921574592590332, "length": 8.219719886779785, "mode": "train", "epoch": 52}
{"loss": 0.12965938448905945, "acc": 0.9617798328399658, "length": 8.2265625, "mode": "test", "epoch": 52}
{"loss": 0.03207734599709511, "acc": 0.994495689868927, "length": 8.808426856994629, "mode": "train", "epoch": 53}
{"loss": 0.07105681300163269, "acc": 0.9791259765625, "length": 7.8359375, "mode": "test", "epoch": 53}
{"loss": 0.02497640810906887, "acc": 0.9971160292625427, "length": 8.2621488571167, "mode": "train", "epoch": 54}
{"loss": 0.060806356370449066, "acc": 0.9843993782997131, "length": 7.56640625, "mode": "test", "epoch": 54}
{"loss": 0.02428055740892887, "acc": 0.9964000582695007, "length": 8.144411087036133, "mode": "train", "epoch": 55}
{"loss": 0.06622838228940964, "acc": 0.9826171398162842, "length": 7.46484375, "mode": "test", "epoch": 55}
{"loss": 0.02211872488260269, "acc": 0.9973568916320801, "length": 7.843071460723877, "mode": "train", "epoch": 56}
{"loss": 0.06139425188302994, "acc": 0.9832946062088013, "length": 7.52734375, "mode": "test", "epoch": 56}
{"loss": 0.020201468840241432, "acc": 0.9989537000656128, "length": 8.028327941894531, "mode": "train", "epoch": 57}
{"loss": 0.04887397959828377, "acc": 0.9876525402069092, "length": 7.31640625, "mode": "test", "epoch": 57}
{"loss": 0.021781791001558304, "acc": 0.9975058436393738, "length": 8.08253002166748, "mode": "train", "epoch": 58}
{"loss": 0.08617232739925385, "acc": 0.9786437749862671, "length": 7.5625, "mode": "test", "epoch": 58}
{"loss": 0.023386776447296143, "acc": 0.9968376159667969, "length": 8.053215026855469, "mode": "train", "epoch": 59}
{"loss": 0.0731993094086647, "acc": 0.980664074420929, "length": 7.828125, "mode": "test", "epoch": 59}
{"loss": 0.019780419766902924, "acc": 0.9981253743171692, "length": 8.053057670593262, "mode": "train", "epoch": 60}
{"loss": 0.06588490307331085, "acc": 0.9826904535293579, "length": 7.7109375, "mode": "test", "epoch": 60}
test accuracy: 0.8454635739326477
