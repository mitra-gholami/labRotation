# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7224997282028198, "acc": 0.5075515508651733, "length": 2.7470810413360596, "mode": "train", "epoch": 1}
{"loss": 0.7011431455612183, "acc": 0.5521484017372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7052630186080933, "acc": 0.5207269191741943, "length": 1.0335291624069214, "mode": "train", "epoch": 2}
{"loss": 0.7014524936676025, "acc": 0.5304687023162842, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7025305032730103, "acc": 0.5292738080024719, "length": 1.013952612876892, "mode": "train", "epoch": 3}
{"loss": 0.6994728446006775, "acc": 0.5521484017372131, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7027665376663208, "acc": 0.5298076868057251, "length": 1.0093371868133545, "mode": "train", "epoch": 4}
{"loss": 0.7012714743614197, "acc": 0.5191406607627869, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7030187845230103, "acc": 0.5239185094833374, "length": 1.00721275806427, "mode": "train", "epoch": 5}
{"loss": 0.6991598606109619, "acc": 0.5412108898162842, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.7023768424987793, "acc": 0.5167491436004639, "length": 1.0054298639297485, "mode": "train", "epoch": 6}
{"loss": 0.6997547745704651, "acc": 0.527539074420929, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.7020794749259949, "acc": 0.5313730835914612, "length": 1.0043010711669922, "mode": "train", "epoch": 7}
{"loss": 0.7003574967384338, "acc": 0.537890613079071, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.7026897072792053, "acc": 0.5288519263267517, "length": 1.0036731958389282, "mode": "train", "epoch": 8}
{"loss": 0.6998827457427979, "acc": 0.5439453125, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.7024432420730591, "acc": 0.5197327733039856, "length": 1.002730369567871, "mode": "train", "epoch": 9}
{"loss": 0.6988855600357056, "acc": 0.547070324420929, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.7011179327964783, "acc": 0.5170414447784424, "length": 1.002352237701416, "mode": "train", "epoch": 10}
{"loss": 0.6983014941215515, "acc": 0.5638671517372131, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.7024135589599609, "acc": 0.5289649963378906, "length": 1.0019283294677734, "mode": "train", "epoch": 11}
{"loss": 0.6987934708595276, "acc": 0.562695324420929, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.7028483748435974, "acc": 0.5301575660705566, "length": 1.001740574836731, "mode": "train", "epoch": 12}
{"loss": 0.6980605721473694, "acc": 0.5582031607627869, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.7017085552215576, "acc": 0.5262230634689331, "length": 1.0013813972473145, "mode": "train", "epoch": 13}
{"loss": 0.6982212662696838, "acc": 0.543749988079071, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6997252106666565, "acc": 0.5343914031982422, "length": 1.0011504888534546, "mode": "train", "epoch": 14}
{"loss": 0.6974413990974426, "acc": 0.5601562857627869, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.7000337839126587, "acc": 0.5317618250846863, "length": 1.001000165939331, "mode": "train", "epoch": 15}
{"loss": 0.6981996893882751, "acc": 0.5421876311302185, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6999452710151672, "acc": 0.5246133804321289, "length": 1.0008349418640137, "mode": "train", "epoch": 16}
{"loss": 0.6970938444137573, "acc": 0.562695324420929, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6987301707267761, "acc": 0.534149169921875, "length": 1.0006922483444214, "mode": "train", "epoch": 17}
{"loss": 0.6981450319290161, "acc": 0.5609374642372131, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6999094486236572, "acc": 0.5255677700042725, "length": 1.0006376504898071, "mode": "train", "epoch": 18}
{"loss": 0.6964457035064697, "acc": 0.5683594346046448, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6995984315872192, "acc": 0.5239553451538086, "length": 1.0005217790603638, "mode": "train", "epoch": 19}
{"loss": 0.6948584914207458, "acc": 0.574023425579071, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.699618399143219, "acc": 0.5319445729255676, "length": 1.0004870891571045, "mode": "train", "epoch": 20}
{"loss": 0.6952378153800964, "acc": 0.5710937976837158, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.7000557780265808, "acc": 0.5228239297866821, "length": 1.0003819465637207, "mode": "train", "epoch": 21}
{"loss": 0.696013331413269, "acc": 0.5617187023162842, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6976309418678284, "acc": 0.5486879944801331, "length": 1.000369906425476, "mode": "train", "epoch": 22}
{"loss": 0.695444643497467, "acc": 0.5609374642372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6981371641159058, "acc": 0.5349238514900208, "length": 1.000321388244629, "mode": "train", "epoch": 23}
{"loss": 0.6943241953849792, "acc": 0.5742186903953552, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6968656778335571, "acc": 0.5480346083641052, "length": 1.0002868175506592, "mode": "train", "epoch": 24}
{"loss": 0.6948002576828003, "acc": 0.570507824420929, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6965827941894531, "acc": 0.5382603406906128, "length": 1.0002456903457642, "mode": "train", "epoch": 25}
{"loss": 0.6932888031005859, "acc": 0.5800780653953552, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6975581645965576, "acc": 0.5332536697387695, "length": 1.0002379417419434, "mode": "train", "epoch": 26}
{"loss": 0.6935461759567261, "acc": 0.577929675579071, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6972528696060181, "acc": 0.5401079058647156, "length": 1.0001870393753052, "mode": "train", "epoch": 27}
{"loss": 0.6917197704315186, "acc": 0.5693359375, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6957547068595886, "acc": 0.5419548153877258, "length": 1.0001627206802368, "mode": "train", "epoch": 28}
{"loss": 0.6944587826728821, "acc": 0.5521484017372131, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6950950622558594, "acc": 0.5505959391593933, "length": 1.0001565217971802, "mode": "train", "epoch": 29}
{"loss": 0.6918460726737976, "acc": 0.5751953125, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6938426494598389, "acc": 0.5429074168205261, "length": 1.0001295804977417, "mode": "train", "epoch": 30}
{"loss": 0.6918630599975586, "acc": 0.5751953125, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6939564347267151, "acc": 0.5561974048614502, "length": 1.000125527381897, "mode": "train", "epoch": 31}
{"loss": 0.6921210885047913, "acc": 0.554492175579071, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6924694180488586, "acc": 0.5463647246360779, "length": 1.0001027584075928, "mode": "train", "epoch": 32}
{"loss": 0.6918368339538574, "acc": 0.549023449420929, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6931454539299011, "acc": 0.5513107776641846, "length": 1.0000892877578735, "mode": "train", "epoch": 33}
{"loss": 0.6911747455596924, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6950474977493286, "acc": 0.5446962714195251, "length": 1.000085711479187, "mode": "train", "epoch": 34}
{"loss": 0.6925821304321289, "acc": 0.556640625, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6937941908836365, "acc": 0.545172393321991, "length": 1.0000700950622559, "mode": "train", "epoch": 35}
{"loss": 0.6916319131851196, "acc": 0.563281238079071, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6919752955436707, "acc": 0.5461263656616211, "length": 1.0000602006912231, "mode": "train", "epoch": 36}
{"loss": 0.6914210319519043, "acc": 0.5656251311302185, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6912713050842285, "acc": 0.5542908906936646, "length": 1.000056266784668, "mode": "train", "epoch": 37}
{"loss": 0.6904780864715576, "acc": 0.5679687857627869, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6911175847053528, "acc": 0.5551249384880066, "length": 1.000050663948059, "mode": "train", "epoch": 38}
{"loss": 0.6912029385566711, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.692612886428833, "acc": 0.5563169717788696, "length": 1.0000427961349487, "mode": "train", "epoch": 39}
{"loss": 0.6907762289047241, "acc": 0.554882824420929, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6927417516708374, "acc": 0.5477355122566223, "length": 1.000043511390686, "mode": "train", "epoch": 40}
{"loss": 0.6911171674728394, "acc": 0.5576172471046448, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6918720006942749, "acc": 0.552919864654541, "length": 1.0000340938568115, "mode": "train", "epoch": 41}
{"loss": 0.6904258131980896, "acc": 0.5546875, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6905891299247742, "acc": 0.5525622963905334, "length": 1.000026822090149, "mode": "train", "epoch": 42}
{"loss": 0.6931595802307129, "acc": 0.5576172471046448, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.693899393081665, "acc": 0.5495829582214355, "length": 1.000024676322937, "mode": "train", "epoch": 43}
{"loss": 0.6911234259605408, "acc": 0.5576172471046448, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6936026811599731, "acc": 0.5438616275787354, "length": 1.0000221729278564, "mode": "train", "epoch": 44}
{"loss": 0.6912050247192383, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6906741857528687, "acc": 0.5536351799964905, "length": 1.0000263452529907, "mode": "train", "epoch": 45}
{"loss": 0.6936248540878296, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6919906735420227, "acc": 0.5456494688987732, "length": 1.0000190734863281, "mode": "train", "epoch": 46}
{"loss": 0.6905540227890015, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6909962296485901, "acc": 0.5572108626365662, "length": 1.0000141859054565, "mode": "train", "epoch": 47}
{"loss": 0.6894388198852539, "acc": 0.5642578601837158, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6891533136367798, "acc": 0.5608459115028381, "length": 1.0000183582305908, "mode": "train", "epoch": 48}
{"loss": 0.6917145848274231, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6917045712471008, "acc": 0.554469645023346, "length": 1.0000126361846924, "mode": "train", "epoch": 49}
{"loss": 0.6893351078033447, "acc": 0.5546875, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.689581573009491, "acc": 0.5547675490379333, "length": 1.0000114440917969, "mode": "train", "epoch": 50}
{"loss": 0.6897698640823364, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6907451152801514, "acc": 0.5476161241531372, "length": 1.0000088214874268, "mode": "train", "epoch": 51}
{"loss": 0.6903413534164429, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6903135776519775, "acc": 0.5570918917655945, "length": 1.000010371208191, "mode": "train", "epoch": 52}
{"loss": 0.689736545085907, "acc": 0.5642578601837158, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.691474199295044, "acc": 0.5522050261497498, "length": 1.0000083446502686, "mode": "train", "epoch": 53}
{"loss": 0.6900209784507751, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6900877356529236, "acc": 0.5538736581802368, "length": 1.0000061988830566, "mode": "train", "epoch": 54}
{"loss": 0.6899346113204956, "acc": 0.5546875, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6899102330207825, "acc": 0.5584028363227844, "length": 1.0000075101852417, "mode": "train", "epoch": 55}
{"loss": 0.690665602684021, "acc": 0.552734375, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6896739602088928, "acc": 0.5529200434684753, "length": 1.0000128746032715, "mode": "train", "epoch": 56}
{"loss": 0.6923714876174927, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6884858012199402, "acc": 0.5514898896217346, "length": 1.000004768371582, "mode": "train", "epoch": 57}
{"loss": 0.6914479732513428, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6900067329406738, "acc": 0.553754448890686, "length": 1.000003695487976, "mode": "train", "epoch": 58}
{"loss": 0.6901512145996094, "acc": 0.5546875, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6873819828033447, "acc": 0.5620381832122803, "length": 1.0000038146972656, "mode": "train", "epoch": 59}
{"loss": 0.6908119320869446, "acc": 0.559765636920929, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.690671980381012, "acc": 0.5560786724090576, "length": 1.0000030994415283, "mode": "train", "epoch": 60}
{"loss": 0.6918008327484131, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.285468727350235
