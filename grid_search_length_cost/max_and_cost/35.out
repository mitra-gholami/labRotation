# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.6991370320320129, "acc": 0.5266901850700378, "length": 4.687474727630615, "mode": "train", "epoch": 1}
{"loss": 0.6925995349884033, "acc": 0.5367187857627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6909140348434448, "acc": 0.5319517254829407, "length": 1.1179134845733643, "mode": "train", "epoch": 2}
{"loss": 0.6870623826980591, "acc": 0.5597657561302185, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.660859227180481, "acc": 0.6113211512565613, "length": 2.286907434463501, "mode": "train", "epoch": 3}
{"loss": 0.6119943261146545, "acc": 0.7041382193565369, "length": 9.34765625, "mode": "test", "epoch": 3}
{"loss": 0.5793635249137878, "acc": 0.6988472938537598, "length": 2.939972162246704, "mode": "train", "epoch": 4}
{"loss": 0.577267050743103, "acc": 0.699554443359375, "length": 2.09765625, "mode": "test", "epoch": 4}
{"loss": 0.5603641867637634, "acc": 0.7036412358283997, "length": 1.9412540197372437, "mode": "train", "epoch": 5}
{"loss": 0.570469319820404, "acc": 0.6834229230880737, "length": 1.4140625, "mode": "test", "epoch": 5}
{"loss": 0.5476639270782471, "acc": 0.7029343843460083, "length": 1.8564131259918213, "mode": "train", "epoch": 6}
{"loss": 0.5794730186462402, "acc": 0.6895813345909119, "length": 1.36328125, "mode": "test", "epoch": 6}
{"loss": 0.5360821485519409, "acc": 0.7155309319496155, "length": 2.0823938846588135, "mode": "train", "epoch": 7}
{"loss": 0.5966049432754517, "acc": 0.6808227300643921, "length": 1.86328125, "mode": "test", "epoch": 7}
{"loss": 0.5031788349151611, "acc": 0.7549591064453125, "length": 3.1905508041381836, "mode": "train", "epoch": 8}
{"loss": 0.6234875917434692, "acc": 0.7463989853858948, "length": 3.8203125, "mode": "test", "epoch": 8}
{"loss": 0.4505719244480133, "acc": 0.7901711463928223, "length": 4.561605930328369, "mode": "train", "epoch": 9}
{"loss": 0.5624980926513672, "acc": 0.7715210318565369, "length": 7.4453125, "mode": "test", "epoch": 9}
{"loss": 0.38544899225234985, "acc": 0.834358811378479, "length": 5.043257713317871, "mode": "train", "epoch": 10}
{"loss": 0.5219365954399109, "acc": 0.797320544719696, "length": 12.9453125, "mode": "test", "epoch": 10}
{"loss": 0.3556859791278839, "acc": 0.8502048850059509, "length": 5.166388511657715, "mode": "train", "epoch": 11}
{"loss": 0.4366239607334137, "acc": 0.8214111328125, "length": 9.75390625, "mode": "test", "epoch": 11}
{"loss": 0.3300759494304657, "acc": 0.8614832758903503, "length": 5.262231349945068, "mode": "train", "epoch": 12}
{"loss": 0.4235311448574066, "acc": 0.8257935047149658, "length": 6.61328125, "mode": "test", "epoch": 12}
{"loss": 0.31691962480545044, "acc": 0.8644833564758301, "length": 5.066563129425049, "mode": "train", "epoch": 13}
{"loss": 0.4007740020751953, "acc": 0.8334716558456421, "length": 7.890625, "mode": "test", "epoch": 13}
{"loss": 0.3043128252029419, "acc": 0.8684220314025879, "length": 5.374743938446045, "mode": "train", "epoch": 14}
{"loss": 0.3659209907054901, "acc": 0.8369568586349487, "length": 5.75390625, "mode": "test", "epoch": 14}
{"loss": 0.29457998275756836, "acc": 0.8711462020874023, "length": 5.443735122680664, "mode": "train", "epoch": 15}
{"loss": 0.37564775347709656, "acc": 0.84222412109375, "length": 5.94921875, "mode": "test", "epoch": 15}
{"loss": 0.28566884994506836, "acc": 0.8783015012741089, "length": 5.8051958084106445, "mode": "train", "epoch": 16}
{"loss": 0.37804096937179565, "acc": 0.851123034954071, "length": 6.5390625, "mode": "test", "epoch": 16}
{"loss": 0.2648616135120392, "acc": 0.8899005651473999, "length": 6.087784767150879, "mode": "train", "epoch": 17}
{"loss": 0.35343465209007263, "acc": 0.8563293814659119, "length": 5.1015625, "mode": "test", "epoch": 17}
{"loss": 0.2466600239276886, "acc": 0.8991565108299255, "length": 6.3677825927734375, "mode": "train", "epoch": 18}
{"loss": 0.3299371004104614, "acc": 0.8727478384971619, "length": 6.01953125, "mode": "test", "epoch": 18}
{"loss": 0.22731409966945648, "acc": 0.9097204804420471, "length": 6.675629138946533, "mode": "train", "epoch": 19}
{"loss": 0.33189576864242554, "acc": 0.8741394281387329, "length": 5.71484375, "mode": "test", "epoch": 19}
{"loss": 0.21478071808815002, "acc": 0.9177446365356445, "length": 7.013064861297607, "mode": "train", "epoch": 20}
{"loss": 0.3450264036655426, "acc": 0.8743468523025513, "length": 6.00390625, "mode": "test", "epoch": 20}
{"loss": 0.19431628286838531, "acc": 0.9286440014839172, "length": 6.992096424102783, "mode": "train", "epoch": 21}
{"loss": 0.31959888339042664, "acc": 0.88800048828125, "length": 6.44921875, "mode": "test", "epoch": 21}
{"loss": 0.16963544487953186, "acc": 0.94044429063797, "length": 7.557666301727295, "mode": "train", "epoch": 22}
{"loss": 0.31163352727890015, "acc": 0.8974853157997131, "length": 6.60546875, "mode": "test", "epoch": 22}
{"loss": 0.15903456509113312, "acc": 0.9438704252243042, "length": 7.813504219055176, "mode": "train", "epoch": 23}
{"loss": 0.3258500099182129, "acc": 0.8849608898162842, "length": 6.7421875, "mode": "test", "epoch": 23}
{"loss": 0.14882729947566986, "acc": 0.9478448033332825, "length": 8.266714096069336, "mode": "train", "epoch": 24}
{"loss": 0.2651589810848236, "acc": 0.90484619140625, "length": 8.0, "mode": "test", "epoch": 24}
{"loss": 0.13087008893489838, "acc": 0.9582535624504089, "length": 8.552396774291992, "mode": "train", "epoch": 25}
{"loss": 0.252095490694046, "acc": 0.9153808355331421, "length": 8.81640625, "mode": "test", "epoch": 25}
{"loss": 0.12327937036752701, "acc": 0.9591118693351746, "length": 9.350271224975586, "mode": "train", "epoch": 26}
{"loss": 0.2555560767650604, "acc": 0.9131041765213013, "length": 9.7265625, "mode": "test", "epoch": 26}
{"loss": 0.11227861046791077, "acc": 0.9659052491188049, "length": 8.768790245056152, "mode": "train", "epoch": 27}
{"loss": 0.23491592705249786, "acc": 0.9261474609375, "length": 8.05078125, "mode": "test", "epoch": 27}
{"loss": 0.09455888718366623, "acc": 0.9710807800292969, "length": 9.154790878295898, "mode": "train", "epoch": 28}
{"loss": 0.20588485896587372, "acc": 0.9376038312911987, "length": 9.73828125, "mode": "test", "epoch": 28}
{"loss": 0.08634363114833832, "acc": 0.9743529558181763, "length": 9.261951446533203, "mode": "train", "epoch": 29}
{"loss": 0.20766998827457428, "acc": 0.93121337890625, "length": 10.5078125, "mode": "test", "epoch": 29}
{"loss": 0.07714827358722687, "acc": 0.9777049422264099, "length": 9.515315055847168, "mode": "train", "epoch": 30}
{"loss": 0.20626744627952576, "acc": 0.9346129894256592, "length": 10.765625, "mode": "test", "epoch": 30}
{"loss": 0.07412437349557877, "acc": 0.9787507653236389, "length": 9.769196510314941, "mode": "train", "epoch": 31}
{"loss": 0.1664333939552307, "acc": 0.947967529296875, "length": 10.71875, "mode": "test", "epoch": 31}
{"loss": 0.06578460335731506, "acc": 0.9824802279472351, "length": 9.229795455932617, "mode": "train", "epoch": 32}
{"loss": 0.16829611361026764, "acc": 0.9450988173484802, "length": 9.10546875, "mode": "test", "epoch": 32}
{"loss": 0.06208270043134689, "acc": 0.9826541543006897, "length": 9.227879524230957, "mode": "train", "epoch": 33}
{"loss": 0.14444348216056824, "acc": 0.954205334186554, "length": 10.421875, "mode": "test", "epoch": 33}
{"loss": 0.05540737509727478, "acc": 0.9850415587425232, "length": 9.776317596435547, "mode": "train", "epoch": 34}
{"loss": 0.14863267540931702, "acc": 0.9529968500137329, "length": 10.21875, "mode": "test", "epoch": 34}
{"loss": 0.047313328832387924, "acc": 0.9895420670509338, "length": 9.515562057495117, "mode": "train", "epoch": 35}
{"loss": 0.12020016461610794, "acc": 0.960040271282196, "length": 9.37109375, "mode": "test", "epoch": 35}
{"loss": 0.04621083289384842, "acc": 0.9897173643112183, "length": 9.490351676940918, "mode": "train", "epoch": 36}
{"loss": 0.11659163981676102, "acc": 0.962603747844696, "length": 9.15625, "mode": "test", "epoch": 36}
{"loss": 0.041244544088840485, "acc": 0.9926238059997559, "length": 8.918198585510254, "mode": "train", "epoch": 37}
{"loss": 0.14089445769786835, "acc": 0.9573912620544434, "length": 8.63671875, "mode": "test", "epoch": 37}
{"loss": 0.041487693786621094, "acc": 0.9916864037513733, "length": 9.269185066223145, "mode": "train", "epoch": 38}
{"loss": 0.12244242429733276, "acc": 0.9661560654640198, "length": 8.38671875, "mode": "test", "epoch": 38}
{"loss": 0.049616094678640366, "acc": 0.9898058176040649, "length": 8.941944122314453, "mode": "train", "epoch": 39}
{"loss": 0.17842358350753784, "acc": 0.951220691204071, "length": 9.23828125, "mode": "test", "epoch": 39}
{"loss": 0.05375504121184349, "acc": 0.9863777160644531, "length": 8.93181324005127, "mode": "train", "epoch": 40}
{"loss": 0.15558479726314545, "acc": 0.954864501953125, "length": 8.90234375, "mode": "test", "epoch": 40}
{"loss": 0.040076013654470444, "acc": 0.991510808467865, "length": 9.41639232635498, "mode": "train", "epoch": 41}
{"loss": 0.10182402282953262, "acc": 0.9698059558868408, "length": 8.16015625, "mode": "test", "epoch": 41}
{"loss": 0.03295750543475151, "acc": 0.9942606687545776, "length": 8.848413467407227, "mode": "train", "epoch": 42}
{"loss": 0.11047590523958206, "acc": 0.96734619140625, "length": 8.58203125, "mode": "test", "epoch": 42}
{"loss": 0.03599276393651962, "acc": 0.9935939311981201, "length": 9.041894912719727, "mode": "train", "epoch": 43}
{"loss": 0.08394897729158401, "acc": 0.9775329828262329, "length": 8.71875, "mode": "test", "epoch": 43}
{"loss": 0.03044150024652481, "acc": 0.9957892298698425, "length": 8.955878257751465, "mode": "train", "epoch": 44}
{"loss": 0.09070128947496414, "acc": 0.9747558832168579, "length": 8.86328125, "mode": "test", "epoch": 44}
{"loss": 0.029772544279694557, "acc": 0.9952438473701477, "length": 8.974455833435059, "mode": "train", "epoch": 45}
{"loss": 0.08904215693473816, "acc": 0.9735534191131592, "length": 8.71875, "mode": "test", "epoch": 45}
{"loss": 0.028539111837744713, "acc": 0.9961563944816589, "length": 8.861886978149414, "mode": "train", "epoch": 46}
{"loss": 0.07180687040090561, "acc": 0.9814087152481079, "length": 8.48828125, "mode": "test", "epoch": 46}
{"loss": 0.027383729815483093, "acc": 0.9963163733482361, "length": 8.485482215881348, "mode": "train", "epoch": 47}
{"loss": 0.07962848246097565, "acc": 0.9778625965118408, "length": 7.9609375, "mode": "test", "epoch": 47}
{"loss": 0.026646889746189117, "acc": 0.9958451986312866, "length": 8.368874549865723, "mode": "train", "epoch": 48}
{"loss": 0.08659631013870239, "acc": 0.9744200706481934, "length": 7.76953125, "mode": "test", "epoch": 48}
{"loss": 0.023277699947357178, "acc": 0.9973628520965576, "length": 8.238828659057617, "mode": "train", "epoch": 49}
{"loss": 0.06789064407348633, "acc": 0.9845947623252869, "length": 8.12109375, "mode": "test", "epoch": 49}
{"loss": 0.02459939941763878, "acc": 0.9967124462127686, "length": 8.375804901123047, "mode": "train", "epoch": 50}
{"loss": 0.08943744003772736, "acc": 0.9773377180099487, "length": 7.68359375, "mode": "test", "epoch": 50}
{"loss": 0.023842142894864082, "acc": 0.9964850544929504, "length": 8.10897445678711, "mode": "train", "epoch": 51}
{"loss": 0.10344631969928741, "acc": 0.9751404523849487, "length": 7.82421875, "mode": "test", "epoch": 51}
{"loss": 0.019884871318936348, "acc": 0.9986902475357056, "length": 8.122187614440918, "mode": "train", "epoch": 52}
{"loss": 0.07697013765573502, "acc": 0.9836853742599487, "length": 7.85546875, "mode": "test", "epoch": 52}
{"loss": 0.02591542713344097, "acc": 0.995209276676178, "length": 8.103063583374023, "mode": "train", "epoch": 53}
{"loss": 0.09121314436197281, "acc": 0.9773743152618408, "length": 7.3984375, "mode": "test", "epoch": 53}
{"loss": 0.023986298590898514, "acc": 0.9972097277641296, "length": 7.995997905731201, "mode": "train", "epoch": 54}
{"loss": 0.08652198314666748, "acc": 0.9776183366775513, "length": 7.796875, "mode": "test", "epoch": 54}
{"loss": 0.023993052542209625, "acc": 0.9965992569923401, "length": 7.651797294616699, "mode": "train", "epoch": 55}
{"loss": 0.08711829781532288, "acc": 0.9739867448806763, "length": 6.8359375, "mode": "test", "epoch": 55}
{"loss": 0.017822209745645523, "acc": 0.9983921647071838, "length": 7.616857051849365, "mode": "train", "epoch": 56}
{"loss": 0.07256490737199783, "acc": 0.9779418706893921, "length": 7.29296875, "mode": "test", "epoch": 56}
{"loss": 0.015306209214031696, "acc": 0.9992913007736206, "length": 7.388422966003418, "mode": "train", "epoch": 57}
{"loss": 0.06877923011779785, "acc": 0.980029284954071, "length": 6.6171875, "mode": "test", "epoch": 57}
{"loss": 0.014593521133065224, "acc": 0.9994152188301086, "length": 7.177278995513916, "mode": "train", "epoch": 58}
{"loss": 0.06709737330675125, "acc": 0.9834533333778381, "length": 6.78125, "mode": "test", "epoch": 58}
{"loss": 0.013352532871067524, "acc": 0.9994055032730103, "length": 7.16225004196167, "mode": "train", "epoch": 59}
{"loss": 0.058143988251686096, "acc": 0.9843322038650513, "length": 6.65625, "mode": "test", "epoch": 59}
{"loss": 0.015005834400653839, "acc": 0.998909592628479, "length": 7.025972843170166, "mode": "train", "epoch": 60}
{"loss": 0.07465241104364395, "acc": 0.982818603515625, "length": 6.55078125, "mode": "test", "epoch": 60}
test accuracy: 0.8857225775718689
