# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.721731424331665, "acc": 0.5173038840293884, "length": 4.803679466247559, "mode": "train", "epoch": 1}
{"loss": 0.698722243309021, "acc": 0.5072265267372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6990888714790344, "acc": 0.5221441388130188, "length": 1.059268832206726, "mode": "train", "epoch": 2}
{"loss": 0.6976763606071472, "acc": 0.517578125, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6977747082710266, "acc": 0.5157666802406311, "length": 1.0302561521530151, "mode": "train", "epoch": 3}
{"loss": 0.6968961954116821, "acc": 0.517578125, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6970826387405396, "acc": 0.514487624168396, "length": 1.0227673053741455, "mode": "train", "epoch": 4}
{"loss": 0.6979451775550842, "acc": 0.5091796517372131, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6970366835594177, "acc": 0.5208196640014648, "length": 1.0165998935699463, "mode": "train", "epoch": 5}
{"loss": 0.696679949760437, "acc": 0.5203125476837158, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6965591311454773, "acc": 0.5248247981071472, "length": 1.012803554534912, "mode": "train", "epoch": 6}
{"loss": 0.6974903345108032, "acc": 0.517578125, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6978829503059387, "acc": 0.5201771259307861, "length": 1.0097447633743286, "mode": "train", "epoch": 7}
{"loss": 0.6960728168487549, "acc": 0.5404296517372131, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6969656944274902, "acc": 0.5208681225776672, "length": 1.0080453157424927, "mode": "train", "epoch": 8}
{"loss": 0.6959125995635986, "acc": 0.5400390625, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6960532665252686, "acc": 0.5173567533493042, "length": 1.0068475008010864, "mode": "train", "epoch": 9}
{"loss": 0.696326494216919, "acc": 0.533007800579071, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.695579469203949, "acc": 0.5222305655479431, "length": 1.0056626796722412, "mode": "train", "epoch": 10}
{"loss": 0.6955100893974304, "acc": 0.531445324420929, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6947941780090332, "acc": 0.5177122950553894, "length": 1.0049083232879639, "mode": "train", "epoch": 11}
{"loss": 0.6962646842002869, "acc": 0.5048828721046448, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6956912279129028, "acc": 0.5261871218681335, "length": 1.0038750171661377, "mode": "train", "epoch": 12}
{"loss": 0.6949641108512878, "acc": 0.5322265625, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6950728893280029, "acc": 0.5344927906990051, "length": 1.0032178163528442, "mode": "train", "epoch": 13}
{"loss": 0.6958398818969727, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6947092413902283, "acc": 0.5262017846107483, "length": 1.0026894807815552, "mode": "train", "epoch": 14}
{"loss": 0.6944758892059326, "acc": 0.5191406607627869, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6936891674995422, "acc": 0.5276362895965576, "length": 1.0023804903030396, "mode": "train", "epoch": 15}
{"loss": 0.6946669816970825, "acc": 0.5171875357627869, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6941155791282654, "acc": 0.5347272753715515, "length": 1.002197027206421, "mode": "train", "epoch": 16}
{"loss": 0.6943010091781616, "acc": 0.519726574420929, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6940106749534607, "acc": 0.5327473282814026, "length": 1.0017167329788208, "mode": "train", "epoch": 17}
{"loss": 0.6929000616073608, "acc": 0.5279297232627869, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6919214725494385, "acc": 0.5386472344398499, "length": 1.001523733139038, "mode": "train", "epoch": 18}
{"loss": 0.6926470398902893, "acc": 0.5191406607627869, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6914792060852051, "acc": 0.5351002812385559, "length": 1.001328706741333, "mode": "train", "epoch": 19}
{"loss": 0.6922491788864136, "acc": 0.5328125357627869, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6914884448051453, "acc": 0.5289722084999084, "length": 1.001196265220642, "mode": "train", "epoch": 20}
{"loss": 0.6921762228012085, "acc": 0.534960925579071, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.691127359867096, "acc": 0.5331812500953674, "length": 1.0011975765228271, "mode": "train", "epoch": 21}
{"loss": 0.6922125816345215, "acc": 0.5333983898162842, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6903827786445618, "acc": 0.5520303249359131, "length": 1.0013645887374878, "mode": "train", "epoch": 22}
{"loss": 0.6912593245506287, "acc": 0.5277343392372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.691060483455658, "acc": 0.5381704568862915, "length": 1.0008925199508667, "mode": "train", "epoch": 23}
{"loss": 0.6917697787284851, "acc": 0.5238280892372131, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6896612644195557, "acc": 0.5402743220329285, "length": 1.0007878541946411, "mode": "train", "epoch": 24}
{"loss": 0.6897098422050476, "acc": 0.5550780892372131, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6895188689231873, "acc": 0.5393631458282471, "length": 1.0007799863815308, "mode": "train", "epoch": 25}
{"loss": 0.6920230984687805, "acc": 0.5255858898162842, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6880369186401367, "acc": 0.5400877594947815, "length": 1.0006390810012817, "mode": "train", "epoch": 26}
{"loss": 0.6897204518318176, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6890419125556946, "acc": 0.5465710163116455, "length": 1.0005627870559692, "mode": "train", "epoch": 27}
{"loss": 0.690291702747345, "acc": 0.5277343392372131, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6896442770957947, "acc": 0.5337757468223572, "length": 1.0004957914352417, "mode": "train", "epoch": 28}
{"loss": 0.6909220218658447, "acc": 0.5361328125, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6882091164588928, "acc": 0.5451328754425049, "length": 1.0004148483276367, "mode": "train", "epoch": 29}
{"loss": 0.6888948082923889, "acc": 0.5445312857627869, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6882491111755371, "acc": 0.5412265062332153, "length": 1.0003392696380615, "mode": "train", "epoch": 30}
{"loss": 0.6895434856414795, "acc": 0.5433593392372131, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6868335604667664, "acc": 0.5530644655227661, "length": 1.0003225803375244, "mode": "train", "epoch": 31}
{"loss": 0.688186764717102, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6874931454658508, "acc": 0.5432719588279724, "length": 1.0002939701080322, "mode": "train", "epoch": 32}
{"loss": 0.6885599493980408, "acc": 0.5439453125, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6873339414596558, "acc": 0.5493370890617371, "length": 1.0002739429473877, "mode": "train", "epoch": 33}
{"loss": 0.6905149221420288, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6871496438980103, "acc": 0.553183913230896, "length": 1.0002409219741821, "mode": "train", "epoch": 34}
{"loss": 0.6891933083534241, "acc": 0.55078125, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6875439882278442, "acc": 0.5515043139457703, "length": 1.0002514123916626, "mode": "train", "epoch": 35}
{"loss": 0.6897678971290588, "acc": 0.557812511920929, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6862204074859619, "acc": 0.5482568144798279, "length": 1.0001755952835083, "mode": "train", "epoch": 36}
{"loss": 0.6878136396408081, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.686323881149292, "acc": 0.5477766394615173, "length": 1.000187635421753, "mode": "train", "epoch": 37}
{"loss": 0.6884939074516296, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6866704821586609, "acc": 0.5495786070823669, "length": 1.0001425743103027, "mode": "train", "epoch": 38}
{"loss": 0.6875497102737427, "acc": 0.5439453125, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.68744295835495, "acc": 0.5537251234054565, "length": 1.0001298189163208, "mode": "train", "epoch": 39}
{"loss": 0.6913477182388306, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6860074996948242, "acc": 0.5536053776741028, "length": 1.0001254081726074, "mode": "train", "epoch": 40}
{"loss": 0.6877949237823486, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.687529981136322, "acc": 0.5497002005577087, "length": 1.000126600265503, "mode": "train", "epoch": 41}
{"loss": 0.689113974571228, "acc": 0.548828125, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6872312426567078, "acc": 0.5505406260490417, "length": 1.000093698501587, "mode": "train", "epoch": 42}
{"loss": 0.6879693865776062, "acc": 0.5310547351837158, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6852205395698547, "acc": 0.5573322772979736, "length": 1.0000922679901123, "mode": "train", "epoch": 43}
{"loss": 0.6889057755470276, "acc": 0.533398449420929, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6856192946434021, "acc": 0.5531854033470154, "length": 1.000080943107605, "mode": "train", "epoch": 44}
{"loss": 0.6886866092681885, "acc": 0.545703113079071, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.68613600730896, "acc": 0.5557093024253845, "length": 1.000083088874817, "mode": "train", "epoch": 45}
{"loss": 0.6879075765609741, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6859878897666931, "acc": 0.5580528974533081, "length": 1.0000596046447754, "mode": "train", "epoch": 46}
{"loss": 0.6881540417671204, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6860828399658203, "acc": 0.5560094118118286, "length": 1.0000499486923218, "mode": "train", "epoch": 47}
{"loss": 0.6884462237358093, "acc": 0.5455078482627869, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6856490969657898, "acc": 0.56478351354599, "length": 1.000051498413086, "mode": "train", "epoch": 48}
{"loss": 0.6894760131835938, "acc": 0.5425781607627869, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6865119934082031, "acc": 0.5583537817001343, "length": 1.0000656843185425, "mode": "train", "epoch": 49}
{"loss": 0.6870735883712769, "acc": 0.55078125, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6854437589645386, "acc": 0.5621391534805298, "length": 1.0000464916229248, "mode": "train", "epoch": 50}
{"loss": 0.68764328956604, "acc": 0.5455078482627869, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6852784752845764, "acc": 0.5546875, "length": 1.00003182888031, "mode": "train", "epoch": 51}
{"loss": 0.6874620914459229, "acc": 0.5517578125, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6853606700897217, "acc": 0.5553487539291382, "length": 1.0000321865081787, "mode": "train", "epoch": 52}
{"loss": 0.6877029538154602, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6857092380523682, "acc": 0.5567308664321899, "length": 1.000024437904358, "mode": "train", "epoch": 53}
{"loss": 0.6876118183135986, "acc": 0.5439453125, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6857137084007263, "acc": 0.5584133267402649, "length": 1.0000276565551758, "mode": "train", "epoch": 54}
{"loss": 0.6881619691848755, "acc": 0.5455078482627869, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6864116191864014, "acc": 0.5535457134246826, "length": 1.0000191926956177, "mode": "train", "epoch": 55}
{"loss": 0.6905155181884766, "acc": 0.5425781607627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6865646243095398, "acc": 0.5573918223381042, "length": 1.000015377998352, "mode": "train", "epoch": 56}
{"loss": 0.6872188448905945, "acc": 0.5523437857627869, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.685215950012207, "acc": 0.5544471740722656, "length": 1.000015139579773, "mode": "train", "epoch": 57}
{"loss": 0.687509298324585, "acc": 0.5423827767372131, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.684922456741333, "acc": 0.5588340163230896, "length": 1.000016212463379, "mode": "train", "epoch": 58}
{"loss": 0.6876357197761536, "acc": 0.55078125, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6856885552406311, "acc": 0.5560097098350525, "length": 1.0000269412994385, "mode": "train", "epoch": 59}
{"loss": 0.6873167753219604, "acc": 0.5425781607627869, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6854986548423767, "acc": 0.5567908883094788, "length": 1.0000165700912476, "mode": "train", "epoch": 60}
{"loss": 0.687369704246521, "acc": 0.5439453125, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.28863635659217834
