# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7173593640327454, "acc": 0.5176058411598206, "length": 4.565118789672852, "mode": "train", "epoch": 1}
{"loss": 0.6935945749282837, "acc": 0.5310764312744141, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6982806324958801, "acc": 0.5194737911224365, "length": 1.0656461715698242, "mode": "train", "epoch": 2}
{"loss": 0.6946598887443542, "acc": 0.5293402671813965, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6980929970741272, "acc": 0.5256806015968323, "length": 1.0359704494476318, "mode": "train", "epoch": 3}
{"loss": 0.6946182250976562, "acc": 0.5260416865348816, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6963284015655518, "acc": 0.5263572335243225, "length": 1.0251973867416382, "mode": "train", "epoch": 4}
{"loss": 0.6945581436157227, "acc": 0.5324652194976807, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6971967816352844, "acc": 0.525420069694519, "length": 1.0184812545776367, "mode": "train", "epoch": 5}
{"loss": 0.6937697529792786, "acc": 0.534375011920929, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6981109976768494, "acc": 0.5209101438522339, "length": 1.0140923261642456, "mode": "train", "epoch": 6}
{"loss": 0.6938492655754089, "acc": 0.5376735925674438, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6980588436126709, "acc": 0.5210973024368286, "length": 1.011576533317566, "mode": "train", "epoch": 7}
{"loss": 0.6942046284675598, "acc": 0.5361111164093018, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.697527289390564, "acc": 0.5287075638771057, "length": 1.0102026462554932, "mode": "train", "epoch": 8}
{"loss": 0.6961833834648132, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6959715485572815, "acc": 0.5165815949440002, "length": 1.0096497535705566, "mode": "train", "epoch": 9}
{"loss": 0.6941989064216614, "acc": 0.5361111164093018, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6968737244606018, "acc": 0.5298895835876465, "length": 1.0090214014053345, "mode": "train", "epoch": 10}
{"loss": 0.695057213306427, "acc": 0.5260416865348816, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.69527268409729, "acc": 0.5300345420837402, "length": 1.011425495147705, "mode": "train", "epoch": 11}
{"loss": 0.6934137940406799, "acc": 0.5310764312744141, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6969419717788696, "acc": 0.5288114547729492, "length": 1.0186604261398315, "mode": "train", "epoch": 12}
{"loss": 0.6938045024871826, "acc": 0.5456597805023193, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6774305105209351, "acc": 0.5935090184211731, "length": 1.741092562675476, "mode": "train", "epoch": 13}
{"loss": 0.6678293347358704, "acc": 0.7097222805023193, "length": 9.708333015441895, "mode": "test", "epoch": 13}
{"loss": 0.5879514813423157, "acc": 0.6989379525184631, "length": 2.3590142726898193, "mode": "train", "epoch": 14}
{"loss": 0.6184993386268616, "acc": 0.677842915058136, "length": 2.184027671813965, "mode": "test", "epoch": 14}
{"loss": 0.5543283820152283, "acc": 0.7246710658073425, "length": 2.3762590885162354, "mode": "train", "epoch": 15}
{"loss": 0.5873156189918518, "acc": 0.7208279371261597, "length": 2.4236111640930176, "mode": "test", "epoch": 15}
{"loss": 0.5246217250823975, "acc": 0.7544466257095337, "length": 2.3809423446655273, "mode": "train", "epoch": 16}
{"loss": 0.5578852891921997, "acc": 0.7452474236488342, "length": 1.8263888359069824, "mode": "test", "epoch": 16}
{"loss": 0.5084221363067627, "acc": 0.7583061456680298, "length": 2.114841938018799, "mode": "train", "epoch": 17}
{"loss": 0.5154111981391907, "acc": 0.7607422471046448, "length": 1.9618055820465088, "mode": "test", "epoch": 17}
{"loss": 0.47409752011299133, "acc": 0.7717825770378113, "length": 2.3023393154144287, "mode": "train", "epoch": 18}
{"loss": 0.5225661396980286, "acc": 0.7508680820465088, "length": 1.9305555820465088, "mode": "test", "epoch": 18}
{"loss": 0.4545440077781677, "acc": 0.7885979413986206, "length": 2.5430870056152344, "mode": "train", "epoch": 19}
{"loss": 0.480410635471344, "acc": 0.7538248896598816, "length": 2.4166667461395264, "mode": "test", "epoch": 19}
{"loss": 0.42822739481925964, "acc": 0.7975097894668579, "length": 2.9900782108306885, "mode": "train", "epoch": 20}
{"loss": 0.434458464384079, "acc": 0.7997286915779114, "length": 2.649305582046509, "mode": "test", "epoch": 20}
{"loss": 0.4085480868816376, "acc": 0.8087523579597473, "length": 3.064835786819458, "mode": "train", "epoch": 21}
{"loss": 0.43126192688941956, "acc": 0.7983506917953491, "length": 2.8125, "mode": "test", "epoch": 21}
{"loss": 0.40087130665779114, "acc": 0.8141593933105469, "length": 3.104365825653076, "mode": "train", "epoch": 22}
{"loss": 0.4317232072353363, "acc": 0.7948242425918579, "length": 2.850694417953491, "mode": "test", "epoch": 22}
{"loss": 0.38938185572624207, "acc": 0.8154072165489197, "length": 3.2278668880462646, "mode": "train", "epoch": 23}
{"loss": 0.4853808581829071, "acc": 0.7849771976470947, "length": 2.90625, "mode": "test", "epoch": 23}
{"loss": 0.3870309293270111, "acc": 0.8211654424667358, "length": 3.126159906387329, "mode": "train", "epoch": 24}
{"loss": 0.4227379858493805, "acc": 0.8073350787162781, "length": 2.8263888359069824, "mode": "test", "epoch": 24}
{"loss": 0.3781575858592987, "acc": 0.8269574046134949, "length": 3.162245273590088, "mode": "train", "epoch": 25}
{"loss": 0.41658255457878113, "acc": 0.8060438632965088, "length": 2.881944417953491, "mode": "test", "epoch": 25}
{"loss": 0.3619896471500397, "acc": 0.8258560299873352, "length": 3.184636354446411, "mode": "train", "epoch": 26}
{"loss": 0.40692421793937683, "acc": 0.8144802451133728, "length": 2.8541667461395264, "mode": "test", "epoch": 26}
{"loss": 0.349791020154953, "acc": 0.8351214528083801, "length": 3.1729931831359863, "mode": "train", "epoch": 27}
{"loss": 0.38572537899017334, "acc": 0.8171603679656982, "length": 2.9201388359069824, "mode": "test", "epoch": 27}
{"loss": 0.34893253445625305, "acc": 0.8384449481964111, "length": 3.224407434463501, "mode": "train", "epoch": 28}
{"loss": 0.3761439919471741, "acc": 0.8244086503982544, "length": 2.8263888359069824, "mode": "test", "epoch": 28}
{"loss": 0.33209264278411865, "acc": 0.8435078859329224, "length": 3.2135281562805176, "mode": "train", "epoch": 29}
{"loss": 0.36980026960372925, "acc": 0.8277832269668579, "length": 2.850694417953491, "mode": "test", "epoch": 29}
{"loss": 0.31900304555892944, "acc": 0.8519487977027893, "length": 3.148193597793579, "mode": "train", "epoch": 30}
{"loss": 0.34820201992988586, "acc": 0.8371202945709229, "length": 3.055555582046509, "mode": "test", "epoch": 30}
{"loss": 0.317321240901947, "acc": 0.8586588501930237, "length": 3.1824347972869873, "mode": "train", "epoch": 31}
{"loss": 0.3620038330554962, "acc": 0.8417426943778992, "length": 2.836805582046509, "mode": "test", "epoch": 31}
{"loss": 0.31758028268814087, "acc": 0.8592906594276428, "length": 3.1146304607391357, "mode": "train", "epoch": 32}
{"loss": 0.3428925573825836, "acc": 0.8527452349662781, "length": 2.8854167461395264, "mode": "test", "epoch": 32}
{"loss": 0.30137792229652405, "acc": 0.8635993003845215, "length": 3.100816249847412, "mode": "train", "epoch": 33}
{"loss": 0.3466748595237732, "acc": 0.8616807460784912, "length": 2.8958332538604736, "mode": "test", "epoch": 33}
{"loss": 0.2927702069282532, "acc": 0.8741733431816101, "length": 3.193035840988159, "mode": "train", "epoch": 34}
{"loss": 0.3576110303401947, "acc": 0.8505480289459229, "length": 3.059027671813965, "mode": "test", "epoch": 34}
{"loss": 0.27935612201690674, "acc": 0.8836890459060669, "length": 3.276387929916382, "mode": "train", "epoch": 35}
{"loss": 0.306875616312027, "acc": 0.8741861581802368, "length": 3.1111111640930176, "mode": "test", "epoch": 35}
{"loss": 0.27065879106521606, "acc": 0.8874284625053406, "length": 3.3690946102142334, "mode": "train", "epoch": 36}
{"loss": 0.30450111627578735, "acc": 0.8784939646720886, "length": 3.027777671813965, "mode": "test", "epoch": 36}
{"loss": 0.2662443220615387, "acc": 0.8945361375808716, "length": 3.328620672225952, "mode": "train", "epoch": 37}
{"loss": 0.2844952940940857, "acc": 0.8864963054656982, "length": 3.375, "mode": "test", "epoch": 37}
{"loss": 0.24705523252487183, "acc": 0.9038561582565308, "length": 3.3716917037963867, "mode": "train", "epoch": 38}
{"loss": 0.27937787771224976, "acc": 0.8873751759529114, "length": 3.2673611640930176, "mode": "test", "epoch": 38}
{"loss": 0.23965956270694733, "acc": 0.9113498330116272, "length": 3.3849422931671143, "mode": "train", "epoch": 39}
{"loss": 0.2575085461139679, "acc": 0.9002603888511658, "length": 3.3333332538604736, "mode": "test", "epoch": 39}
{"loss": 0.22386004030704498, "acc": 0.9166518449783325, "length": 3.4153287410736084, "mode": "train", "epoch": 40}
{"loss": 0.26360198855400085, "acc": 0.9005696773529053, "length": 3.46875, "mode": "test", "epoch": 40}
{"loss": 0.22002367675304413, "acc": 0.9207207560539246, "length": 3.402689218521118, "mode": "train", "epoch": 41}
{"loss": 0.2534846365451813, "acc": 0.9144260883331299, "length": 3.288194417953491, "mode": "test", "epoch": 41}
{"loss": 0.20961521565914154, "acc": 0.9267138242721558, "length": 3.493931293487549, "mode": "train", "epoch": 42}
{"loss": 0.23886196315288544, "acc": 0.9144097566604614, "length": 3.4479167461395264, "mode": "test", "epoch": 42}
{"loss": 0.1995331197977066, "acc": 0.9310197830200195, "length": 3.3563969135284424, "mode": "train", "epoch": 43}
{"loss": 0.227336123585701, "acc": 0.9248860478401184, "length": 3.3333332538604736, "mode": "test", "epoch": 43}
{"loss": 0.19103924930095673, "acc": 0.9376763105392456, "length": 3.51645565032959, "mode": "train", "epoch": 44}
{"loss": 0.21898368000984192, "acc": 0.9185817241668701, "length": 3.4166667461395264, "mode": "test", "epoch": 44}
{"loss": 0.18254679441452026, "acc": 0.9402433037757874, "length": 3.561779022216797, "mode": "train", "epoch": 45}
{"loss": 0.22961203753948212, "acc": 0.9169270992279053, "length": 3.690972328186035, "mode": "test", "epoch": 45}
{"loss": 0.16567540168762207, "acc": 0.9453575015068054, "length": 3.5543785095214844, "mode": "train", "epoch": 46}
{"loss": 0.21510863304138184, "acc": 0.9243598580360413, "length": 3.506944417953491, "mode": "test", "epoch": 46}
{"loss": 0.1594347506761551, "acc": 0.9511065483093262, "length": 3.587432861328125, "mode": "train", "epoch": 47}
{"loss": 0.22271493077278137, "acc": 0.9251681566238403, "length": 3.534722328186035, "mode": "test", "epoch": 47}
{"loss": 0.15100014209747314, "acc": 0.9529383778572083, "length": 3.6456892490386963, "mode": "train", "epoch": 48}
{"loss": 0.203988716006279, "acc": 0.9308485388755798, "length": 3.5729167461395264, "mode": "test", "epoch": 48}
{"loss": 0.1512409746646881, "acc": 0.9489891529083252, "length": 3.6389012336730957, "mode": "train", "epoch": 49}
{"loss": 0.22058531641960144, "acc": 0.9207682013511658, "length": 3.621527671813965, "mode": "test", "epoch": 49}
{"loss": 0.15040366351604462, "acc": 0.9520946145057678, "length": 3.6672089099884033, "mode": "train", "epoch": 50}
{"loss": 0.1887395977973938, "acc": 0.9349392652511597, "length": 3.649305582046509, "mode": "test", "epoch": 50}
{"loss": 0.1372048705816269, "acc": 0.9569627046585083, "length": 3.6618435382843018, "mode": "train", "epoch": 51}
{"loss": 0.20975349843502045, "acc": 0.9204318523406982, "length": 3.7916667461395264, "mode": "test", "epoch": 51}
{"loss": 0.1340135633945465, "acc": 0.9593250155448914, "length": 3.7657670974731445, "mode": "train", "epoch": 52}
{"loss": 0.18581315875053406, "acc": 0.9372504353523254, "length": 3.503472328186035, "mode": "test", "epoch": 52}
{"loss": 0.12790068984031677, "acc": 0.9611641764640808, "length": 3.6704323291778564, "mode": "train", "epoch": 53}
{"loss": 0.17268092930316925, "acc": 0.9397949576377869, "length": 3.618055582046509, "mode": "test", "epoch": 53}
{"loss": 0.12270341068506241, "acc": 0.962289571762085, "length": 3.7031266689300537, "mode": "train", "epoch": 54}
{"loss": 0.18020695447921753, "acc": 0.9376843571662903, "length": 3.4861111640930176, "mode": "test", "epoch": 54}
{"loss": 0.12330591678619385, "acc": 0.9622297883033752, "length": 3.707301616668701, "mode": "train", "epoch": 55}
{"loss": 0.16785894334316254, "acc": 0.9373642802238464, "length": 3.711805582046509, "mode": "test", "epoch": 55}
{"loss": 0.11589453369379044, "acc": 0.9632965326309204, "length": 3.7335124015808105, "mode": "train", "epoch": 56}
{"loss": 0.16585002839565277, "acc": 0.943516731262207, "length": 3.6666667461395264, "mode": "test", "epoch": 56}
{"loss": 0.11353248357772827, "acc": 0.9669440984725952, "length": 3.8309550285339355, "mode": "train", "epoch": 57}
{"loss": 0.19790604710578918, "acc": 0.9328070878982544, "length": 3.625, "mode": "test", "epoch": 57}
{"loss": 0.1354139894247055, "acc": 0.9574279189109802, "length": 3.676522731781006, "mode": "train", "epoch": 58}
{"loss": 0.19988001883029938, "acc": 0.9306477308273315, "length": 3.9201388359069824, "mode": "test", "epoch": 58}
{"loss": 0.12125835567712784, "acc": 0.9638545513153076, "length": 3.9078614711761475, "mode": "train", "epoch": 59}
{"loss": 0.16604915261268616, "acc": 0.9425184726715088, "length": 3.868055582046509, "mode": "test", "epoch": 59}
{"loss": 0.11284846812486649, "acc": 0.9640716910362244, "length": 3.9808526039123535, "mode": "train", "epoch": 60}
{"loss": 0.16587527096271515, "acc": 0.9417697191238403, "length": 3.753472328186035, "mode": "test", "epoch": 60}
test accuracy: 0.8263075947761536
