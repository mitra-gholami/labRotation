# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7225950360298157, "acc": 0.5190626978874207, "length": 2.8150131702423096, "mode": "train", "epoch": 1}
{"loss": 0.7033258676528931, "acc": 0.5000000596046448, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7042443156242371, "acc": 0.5120205879211426, "length": 1.048216462135315, "mode": "train", "epoch": 2}
{"loss": 0.7104844450950623, "acc": 0.49453121423721313, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7021376490592957, "acc": 0.5260583758354187, "length": 1.0180507898330688, "mode": "train", "epoch": 3}
{"loss": 0.7088297009468079, "acc": 0.498046875, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7000092267990112, "acc": 0.5365483164787292, "length": 1.0120139122009277, "mode": "train", "epoch": 4}
{"loss": 0.7054206132888794, "acc": 0.49667972326278687, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7009270191192627, "acc": 0.5171486139297485, "length": 1.0084463357925415, "mode": "train", "epoch": 5}
{"loss": 0.7051498889923096, "acc": 0.49667972326278687, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.7010529041290283, "acc": 0.5302953124046326, "length": 1.0070210695266724, "mode": "train", "epoch": 6}
{"loss": 0.7064681053161621, "acc": 0.49160152673721313, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.700178861618042, "acc": 0.5234174728393555, "length": 1.0049822330474854, "mode": "train", "epoch": 7}
{"loss": 0.7082040905952454, "acc": 0.5003905892372131, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6997954249382019, "acc": 0.5319133996963501, "length": 1.0042799711227417, "mode": "train", "epoch": 8}
{"loss": 0.7061984539031982, "acc": 0.49101564288139343, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.7004156708717346, "acc": 0.5171694159507751, "length": 1.003228783607483, "mode": "train", "epoch": 9}
{"loss": 0.7085021138191223, "acc": 0.49453121423721313, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.7010382413864136, "acc": 0.5184209942817688, "length": 1.002598524093628, "mode": "train", "epoch": 10}
{"loss": 0.7074354290962219, "acc": 0.49433591961860657, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.7006534337997437, "acc": 0.5248240232467651, "length": 1.0022187232971191, "mode": "train", "epoch": 11}
{"loss": 0.7059127688407898, "acc": 0.49472659826278687, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.7001714110374451, "acc": 0.5330122709274292, "length": 1.0019221305847168, "mode": "train", "epoch": 12}
{"loss": 0.7058587074279785, "acc": 0.49160152673721313, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6999126076698303, "acc": 0.5278692245483398, "length": 1.0015431642532349, "mode": "train", "epoch": 13}
{"loss": 0.7053194046020508, "acc": 0.49472662806510925, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6997810006141663, "acc": 0.5301436185836792, "length": 1.0013139247894287, "mode": "train", "epoch": 14}
{"loss": 0.706023097038269, "acc": 0.498046875, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6991164088249207, "acc": 0.5245320796966553, "length": 1.0011074542999268, "mode": "train", "epoch": 15}
{"loss": 0.7073985934257507, "acc": 0.49296876788139343, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.699276864528656, "acc": 0.5309732556343079, "length": 1.000898838043213, "mode": "train", "epoch": 16}
{"loss": 0.705053448677063, "acc": 0.49160152673721313, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6988239884376526, "acc": 0.5214391350746155, "length": 1.0009939670562744, "mode": "train", "epoch": 17}
{"loss": 0.7051492929458618, "acc": 0.49667972326278687, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6997910737991333, "acc": 0.5295604467391968, "length": 1.000779628753662, "mode": "train", "epoch": 18}
{"loss": 0.7049686908721924, "acc": 0.49453121423721313, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6991938352584839, "acc": 0.5186781883239746, "length": 1.0005983114242554, "mode": "train", "epoch": 19}
{"loss": 0.7057605981826782, "acc": 0.49472662806510925, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6989594101905823, "acc": 0.530385434627533, "length": 1.0005358457565308, "mode": "train", "epoch": 20}
{"loss": 0.70602947473526, "acc": 0.49296876788139343, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6984447836875916, "acc": 0.5282763838768005, "length": 1.0004478693008423, "mode": "train", "epoch": 21}
{"loss": 0.7051310539245605, "acc": 0.49433591961860657, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6982378363609314, "acc": 0.5261139273643494, "length": 1.0004162788391113, "mode": "train", "epoch": 22}
{"loss": 0.7042127847671509, "acc": 0.49531248211860657, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6980845332145691, "acc": 0.5282774567604065, "length": 1.0003660917282104, "mode": "train", "epoch": 23}
{"loss": 0.7056640982627869, "acc": 0.4931640625, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6980570554733276, "acc": 0.5364145636558533, "length": 1.0002976655960083, "mode": "train", "epoch": 24}
{"loss": 0.705359160900116, "acc": 0.48671871423721313, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6977322101593018, "acc": 0.5330196619033813, "length": 1.0002866983413696, "mode": "train", "epoch": 25}
{"loss": 0.7061236500740051, "acc": 0.49296876788139343, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6981479525566101, "acc": 0.5262305736541748, "length": 1.0002248287200928, "mode": "train", "epoch": 26}
{"loss": 0.7057711482048035, "acc": 0.49433591961860657, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6970958709716797, "acc": 0.5350102782249451, "length": 1.0002399682998657, "mode": "train", "epoch": 27}
{"loss": 0.7040890455245972, "acc": 0.48945313692092896, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6971526741981506, "acc": 0.5360046625137329, "length": 1.0001978874206543, "mode": "train", "epoch": 28}
{"loss": 0.7052380442619324, "acc": 0.505078136920929, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6968953013420105, "acc": 0.5394612550735474, "length": 1.0001875162124634, "mode": "train", "epoch": 29}
{"loss": 0.704822301864624, "acc": 0.49980470538139343, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6979377269744873, "acc": 0.5255854725837708, "length": 1.0001471042633057, "mode": "train", "epoch": 30}
{"loss": 0.7063760757446289, "acc": 0.49296876788139343, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6965115666389465, "acc": 0.5301527976989746, "length": 1.0001405477523804, "mode": "train", "epoch": 31}
{"loss": 0.7048094868659973, "acc": 0.48964840173721313, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6965338587760925, "acc": 0.5375292301177979, "length": 1.0001178979873657, "mode": "train", "epoch": 32}
{"loss": 0.7035448551177979, "acc": 0.511914074420929, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6968551278114319, "acc": 0.5307381749153137, "length": 1.0000964403152466, "mode": "train", "epoch": 33}
{"loss": 0.7053329944610596, "acc": 0.49296876788139343, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6961938142776489, "acc": 0.5402221083641052, "length": 1.000106930732727, "mode": "train", "epoch": 34}
{"loss": 0.7037282586097717, "acc": 0.5042968392372131, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6964872479438782, "acc": 0.5276938676834106, "length": 1.0000783205032349, "mode": "train", "epoch": 35}
{"loss": 0.704409658908844, "acc": 0.49375003576278687, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6961442232131958, "acc": 0.5316750407218933, "length": 1.0000698566436768, "mode": "train", "epoch": 36}
{"loss": 0.7041935920715332, "acc": 0.5144531726837158, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6959829926490784, "acc": 0.5421547889709473, "length": 1.0000635385513306, "mode": "train", "epoch": 37}
{"loss": 0.7047404050827026, "acc": 0.504687488079071, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6966898441314697, "acc": 0.5425057411193848, "length": 1.000065565109253, "mode": "train", "epoch": 38}
{"loss": 0.7057378888130188, "acc": 0.49980470538139343, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6956026554107666, "acc": 0.5360657572746277, "length": 1.0000584125518799, "mode": "train", "epoch": 39}
{"loss": 0.7041268348693848, "acc": 0.49492189288139343, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.696641743183136, "acc": 0.5418614149093628, "length": 1.000044822692871, "mode": "train", "epoch": 40}
{"loss": 0.7038235068321228, "acc": 0.5210937857627869, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6963809132575989, "acc": 0.5450232028961182, "length": 1.000038504600525, "mode": "train", "epoch": 41}
{"loss": 0.7051666975021362, "acc": 0.49746090173721313, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6957274079322815, "acc": 0.5378221273422241, "length": 1.000037431716919, "mode": "train", "epoch": 42}
{"loss": 0.7037086486816406, "acc": 0.5142578482627869, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6958267092704773, "acc": 0.5456089973449707, "length": 1.0000334978103638, "mode": "train", "epoch": 43}
{"loss": 0.702757716178894, "acc": 0.508007824420929, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6960853338241577, "acc": 0.5346019864082336, "length": 1.0000287294387817, "mode": "train", "epoch": 44}
{"loss": 0.7045274972915649, "acc": 0.5087890625, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.696313202381134, "acc": 0.5439110398292542, "length": 1.0000238418579102, "mode": "train", "epoch": 45}
{"loss": 0.7037526965141296, "acc": 0.5144531726837158, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.69539475440979, "acc": 0.5484774708747864, "length": 1.0000218152999878, "mode": "train", "epoch": 46}
{"loss": 0.7042174935340881, "acc": 0.5296874642372131, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6953213810920715, "acc": 0.5403398275375366, "length": 1.0000174045562744, "mode": "train", "epoch": 47}
{"loss": 0.7028064131736755, "acc": 0.5082030892372131, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6954482793807983, "acc": 0.5429156422615051, "length": 1.0000156164169312, "mode": "train", "epoch": 48}
{"loss": 0.7032512426376343, "acc": 0.5132812857627869, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6960231065750122, "acc": 0.5352460741996765, "length": 1.0000170469284058, "mode": "train", "epoch": 49}
{"loss": 0.7049666047096252, "acc": 0.5199218392372131, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6957821249961853, "acc": 0.531323254108429, "length": 1.0000125169754028, "mode": "train", "epoch": 50}
{"loss": 0.7027831077575684, "acc": 0.5208984017372131, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6957665085792542, "acc": 0.5398126840591431, "length": 1.000011920928955, "mode": "train", "epoch": 51}
{"loss": 0.7047465443611145, "acc": 0.508007824420929, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6953575611114502, "acc": 0.5425643920898438, "length": 1.0000113248825073, "mode": "train", "epoch": 52}
{"loss": 0.704806387424469, "acc": 0.5142578482627869, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6948069930076599, "acc": 0.5481264591217041, "length": 1.000008463859558, "mode": "train", "epoch": 53}
{"loss": 0.7038332223892212, "acc": 0.5082030892372131, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6954231858253479, "acc": 0.5456674695014954, "length": 1.0000065565109253, "mode": "train", "epoch": 54}
{"loss": 0.7035536766052246, "acc": 0.5132812857627869, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.695290744304657, "acc": 0.5403395891189575, "length": 1.0000097751617432, "mode": "train", "epoch": 55}
{"loss": 0.7034820318222046, "acc": 0.5132812857627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6946354508399963, "acc": 0.5510538220405579, "length": 1.0000061988830566, "mode": "train", "epoch": 56}
{"loss": 0.705880880355835, "acc": 0.5126953125, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.69489586353302, "acc": 0.5458431839942932, "length": 1.0000066757202148, "mode": "train", "epoch": 57}
{"loss": 0.7035950422286987, "acc": 0.5183594226837158, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6944711804389954, "acc": 0.5444379448890686, "length": 1.0000072717666626, "mode": "train", "epoch": 58}
{"loss": 0.7047236561775208, "acc": 0.508007824420929, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6950389742851257, "acc": 0.5446135997772217, "length": 1.0000041723251343, "mode": "train", "epoch": 59}
{"loss": 0.704840362071991, "acc": 0.5126953125, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6954388618469238, "acc": 0.5494730472564697, "length": 1.000003695487976, "mode": "train", "epoch": 60}
{"loss": 0.7038976550102234, "acc": 0.5082030892372131, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.343500018119812
