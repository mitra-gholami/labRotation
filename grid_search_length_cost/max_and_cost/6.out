# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7179909944534302, "acc": 0.49374786019325256, "length": 3.5659284591674805, "mode": "train", "epoch": 1}
{"loss": 0.6980710625648499, "acc": 0.5042968392372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7010498642921448, "acc": 0.5136575102806091, "length": 1.0542497634887695, "mode": "train", "epoch": 2}
{"loss": 0.7025216221809387, "acc": 0.49843746423721313, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.698668360710144, "acc": 0.5156106948852539, "length": 1.0283581018447876, "mode": "train", "epoch": 3}
{"loss": 0.697106659412384, "acc": 0.515625, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6976828575134277, "acc": 0.5150226354598999, "length": 1.0189285278320312, "mode": "train", "epoch": 4}
{"loss": 0.6969541907310486, "acc": 0.517773449420929, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6983239054679871, "acc": 0.5143442153930664, "length": 1.012900710105896, "mode": "train", "epoch": 5}
{"loss": 0.697674572467804, "acc": 0.5132812857627869, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6973346471786499, "acc": 0.5209758877754211, "length": 1.0105341672897339, "mode": "train", "epoch": 6}
{"loss": 0.697615921497345, "acc": 0.514843761920929, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6979995369911194, "acc": 0.5184423327445984, "length": 1.0077881813049316, "mode": "train", "epoch": 7}
{"loss": 0.6978962421417236, "acc": 0.5214844346046448, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6962238550186157, "acc": 0.5286896228790283, "length": 1.0061838626861572, "mode": "train", "epoch": 8}
{"loss": 0.6980817317962646, "acc": 0.5107422471046448, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6982028484344482, "acc": 0.5201299786567688, "length": 1.0052376985549927, "mode": "train", "epoch": 9}
{"loss": 0.7003735899925232, "acc": 0.517578125, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6967076659202576, "acc": 0.5264720916748047, "length": 1.0041412115097046, "mode": "train", "epoch": 10}
{"loss": 0.6968810558319092, "acc": 0.506054699420929, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6961876749992371, "acc": 0.5086691975593567, "length": 1.0036537647247314, "mode": "train", "epoch": 11}
{"loss": 0.6973822116851807, "acc": 0.5134766101837158, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6980255246162415, "acc": 0.5282137989997864, "length": 1.0030057430267334, "mode": "train", "epoch": 12}
{"loss": 0.6969394683837891, "acc": 0.510937511920929, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6958853006362915, "acc": 0.5153511762619019, "length": 1.0026389360427856, "mode": "train", "epoch": 13}
{"loss": 0.6972174644470215, "acc": 0.5037109851837158, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6962820887565613, "acc": 0.5219131112098694, "length": 1.002288818359375, "mode": "train", "epoch": 14}
{"loss": 0.6955946087837219, "acc": 0.5179687142372131, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6954159736633301, "acc": 0.5190314650535583, "length": 1.0022484064102173, "mode": "train", "epoch": 15}
{"loss": 0.6951667070388794, "acc": 0.50390625, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6957539319992065, "acc": 0.5306226015090942, "length": 1.0021772384643555, "mode": "train", "epoch": 16}
{"loss": 0.6953895092010498, "acc": 0.522656261920929, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6952427625656128, "acc": 0.5347052216529846, "length": 1.0038799047470093, "mode": "train", "epoch": 17}
{"loss": 0.6950030326843262, "acc": 0.514453113079071, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6477035284042358, "acc": 0.6511687636375427, "length": 1.9232072830200195, "mode": "train", "epoch": 18}
{"loss": 0.5852988958358765, "acc": 0.6990906596183777, "length": 1.42578125, "mode": "test", "epoch": 18}
{"loss": 0.5673430562019348, "acc": 0.6942604780197144, "length": 1.4101805686950684, "mode": "train", "epoch": 19}
{"loss": 0.5598185062408447, "acc": 0.6980469226837158, "length": 1.25, "mode": "test", "epoch": 19}
{"loss": 0.5570544600486755, "acc": 0.6907908916473389, "length": 1.3240562677383423, "mode": "train", "epoch": 20}
{"loss": 0.5636738538742065, "acc": 0.6996093392372131, "length": 1.25390625, "mode": "test", "epoch": 20}
{"loss": 0.540760338306427, "acc": 0.7048601508140564, "length": 1.5039429664611816, "mode": "train", "epoch": 21}
{"loss": 0.5590042471885681, "acc": 0.6964721083641052, "length": 1.44140625, "mode": "test", "epoch": 21}
{"loss": 0.5151175856590271, "acc": 0.745353102684021, "length": 1.8714932203292847, "mode": "train", "epoch": 22}
{"loss": 0.549083948135376, "acc": 0.709912121295929, "length": 1.5, "mode": "test", "epoch": 22}
{"loss": 0.5020843148231506, "acc": 0.7620648145675659, "length": 1.979968547821045, "mode": "train", "epoch": 23}
{"loss": 0.5100299119949341, "acc": 0.759368896484375, "length": 1.65234375, "mode": "test", "epoch": 23}
{"loss": 0.48373621702194214, "acc": 0.7793965935707092, "length": 2.0198333263397217, "mode": "train", "epoch": 24}
{"loss": 0.47350892424583435, "acc": 0.7915710806846619, "length": 1.8125, "mode": "test", "epoch": 24}
{"loss": 0.4689609706401825, "acc": 0.7854337096214294, "length": 2.1150362491607666, "mode": "train", "epoch": 25}
{"loss": 0.48291242122650146, "acc": 0.7811340689659119, "length": 1.7890625, "mode": "test", "epoch": 25}
{"loss": 0.4548112452030182, "acc": 0.7955378890037537, "length": 2.198240280151367, "mode": "train", "epoch": 26}
{"loss": 0.44003865122795105, "acc": 0.8164001107215881, "length": 1.94921875, "mode": "test", "epoch": 26}
{"loss": 0.43161657452583313, "acc": 0.8138741254806519, "length": 2.2784197330474854, "mode": "train", "epoch": 27}
{"loss": 0.4121299982070923, "acc": 0.8305176496505737, "length": 2.06640625, "mode": "test", "epoch": 27}
{"loss": 0.39804449677467346, "acc": 0.8316492438316345, "length": 2.242213010787964, "mode": "train", "epoch": 28}
{"loss": 0.39992326498031616, "acc": 0.839752197265625, "length": 2.015625, "mode": "test", "epoch": 28}
{"loss": 0.3659246861934662, "acc": 0.8453606367111206, "length": 2.3380820751190186, "mode": "train", "epoch": 29}
{"loss": 0.3710969090461731, "acc": 0.8489075899124146, "length": 2.21875, "mode": "test", "epoch": 29}
{"loss": 0.3450804352760315, "acc": 0.8538914918899536, "length": 2.473797082901001, "mode": "train", "epoch": 30}
{"loss": 0.36052095890045166, "acc": 0.8566589951515198, "length": 2.734375, "mode": "test", "epoch": 30}
{"loss": 0.3161303699016571, "acc": 0.8687138557434082, "length": 2.802011489868164, "mode": "train", "epoch": 31}
{"loss": 0.33955085277557373, "acc": 0.8715149164199829, "length": 2.765625, "mode": "test", "epoch": 31}
{"loss": 0.298916757106781, "acc": 0.8801852464675903, "length": 3.0360443592071533, "mode": "train", "epoch": 32}
{"loss": 0.31743481755256653, "acc": 0.880108654499054, "length": 2.86328125, "mode": "test", "epoch": 32}
{"loss": 0.26937782764434814, "acc": 0.8945372700691223, "length": 3.245305299758911, "mode": "train", "epoch": 33}
{"loss": 0.3041537404060364, "acc": 0.8895813226699829, "length": 3.17578125, "mode": "test", "epoch": 33}
{"loss": 0.24983981251716614, "acc": 0.9072478413581848, "length": 3.25988507270813, "mode": "train", "epoch": 34}
{"loss": 0.3037537932395935, "acc": 0.8911438584327698, "length": 3.375, "mode": "test", "epoch": 34}
{"loss": 0.23344869911670685, "acc": 0.9127569794654846, "length": 3.451134443283081, "mode": "train", "epoch": 35}
{"loss": 0.27148979902267456, "acc": 0.902905285358429, "length": 3.28125, "mode": "test", "epoch": 35}
{"loss": 0.21475650370121002, "acc": 0.9229469299316406, "length": 3.5374789237976074, "mode": "train", "epoch": 36}
{"loss": 0.25616493821144104, "acc": 0.9082520008087158, "length": 3.71875, "mode": "test", "epoch": 36}
{"loss": 0.20003224909305573, "acc": 0.9268320202827454, "length": 3.7323625087738037, "mode": "train", "epoch": 37}
{"loss": 0.24343378841876984, "acc": 0.9185423851013184, "length": 3.43359375, "mode": "test", "epoch": 37}
{"loss": 0.18645131587982178, "acc": 0.9337745904922485, "length": 3.667120933532715, "mode": "train", "epoch": 38}
{"loss": 0.24036180973052979, "acc": 0.9175415635108948, "length": 3.3828125, "mode": "test", "epoch": 38}
{"loss": 0.18307223916053772, "acc": 0.9352863430976868, "length": 3.618964195251465, "mode": "train", "epoch": 39}
{"loss": 0.24212080240249634, "acc": 0.918719470500946, "length": 3.4140625, "mode": "test", "epoch": 39}
{"loss": 0.1703086793422699, "acc": 0.9424522519111633, "length": 3.687777280807495, "mode": "train", "epoch": 40}
{"loss": 0.23288969695568085, "acc": 0.9246826767921448, "length": 3.52734375, "mode": "test", "epoch": 40}
{"loss": 0.1695113480091095, "acc": 0.943434476852417, "length": 3.7273709774017334, "mode": "train", "epoch": 41}
{"loss": 0.21727979183197021, "acc": 0.92578125, "length": 3.4609375, "mode": "test", "epoch": 41}
{"loss": 0.1658909171819687, "acc": 0.9425860047340393, "length": 3.5860095024108887, "mode": "train", "epoch": 42}
{"loss": 0.2298002541065216, "acc": 0.92950439453125, "length": 3.50390625, "mode": "test", "epoch": 42}
{"loss": 0.16002008318901062, "acc": 0.9479182958602905, "length": 3.737516164779663, "mode": "train", "epoch": 43}
{"loss": 0.23750334978103638, "acc": 0.9182250499725342, "length": 3.85546875, "mode": "test", "epoch": 43}
{"loss": 0.1555698662996292, "acc": 0.949263870716095, "length": 3.9243197441101074, "mode": "train", "epoch": 44}
{"loss": 0.2290736883878708, "acc": 0.924938976764679, "length": 3.9140625, "mode": "test", "epoch": 44}
{"loss": 0.14688248932361603, "acc": 0.9519248604774475, "length": 3.861287832260132, "mode": "train", "epoch": 45}
{"loss": 0.20961999893188477, "acc": 0.9354981184005737, "length": 3.734375, "mode": "test", "epoch": 45}
{"loss": 0.14033441245555878, "acc": 0.9556975364685059, "length": 3.910074472427368, "mode": "train", "epoch": 46}
{"loss": 0.20270751416683197, "acc": 0.9380127191543579, "length": 3.90625, "mode": "test", "epoch": 46}
{"loss": 0.14442554116249084, "acc": 0.9538866281509399, "length": 4.058778762817383, "mode": "train", "epoch": 47}
{"loss": 0.2139676809310913, "acc": 0.934527575969696, "length": 3.9140625, "mode": "test", "epoch": 47}
{"loss": 0.13656990230083466, "acc": 0.9571832418441772, "length": 4.019635200500488, "mode": "train", "epoch": 48}
{"loss": 0.20160236954689026, "acc": 0.9399414658546448, "length": 3.84765625, "mode": "test", "epoch": 48}
{"loss": 0.12816061079502106, "acc": 0.9608359336853027, "length": 4.027329444885254, "mode": "train", "epoch": 49}
{"loss": 0.2293771207332611, "acc": 0.9334107041358948, "length": 3.98828125, "mode": "test", "epoch": 49}
{"loss": 0.12537026405334473, "acc": 0.9620323181152344, "length": 4.037772178649902, "mode": "train", "epoch": 50}
{"loss": 0.20006224513053894, "acc": 0.9408020377159119, "length": 3.796875, "mode": "test", "epoch": 50}
{"loss": 0.12153815478086472, "acc": 0.9632805585861206, "length": 3.8112895488739014, "mode": "train", "epoch": 51}
{"loss": 0.1945844292640686, "acc": 0.9392821788787842, "length": 3.73046875, "mode": "test", "epoch": 51}
{"loss": 0.11992315202951431, "acc": 0.9643873572349548, "length": 3.9522831439971924, "mode": "train", "epoch": 52}
{"loss": 0.1869601458311081, "acc": 0.9405151605606079, "length": 3.9609375, "mode": "test", "epoch": 52}
{"loss": 0.11344288289546967, "acc": 0.9654731154441833, "length": 3.9481375217437744, "mode": "train", "epoch": 53}
{"loss": 0.18143978714942932, "acc": 0.947711169719696, "length": 3.78125, "mode": "test", "epoch": 53}
{"loss": 0.10925450921058655, "acc": 0.9672442674636841, "length": 3.9819655418395996, "mode": "train", "epoch": 54}
{"loss": 0.1788976490497589, "acc": 0.9479430913925171, "length": 3.9453125, "mode": "test", "epoch": 54}
{"loss": 0.11494135111570358, "acc": 0.9652801156044006, "length": 3.961066961288452, "mode": "train", "epoch": 55}
{"loss": 0.1686077117919922, "acc": 0.9507262706756592, "length": 4.09375, "mode": "test", "epoch": 55}
{"loss": 0.10527663677930832, "acc": 0.9701865315437317, "length": 4.1852803230285645, "mode": "train", "epoch": 56}
{"loss": 0.19768783450126648, "acc": 0.948345959186554, "length": 4.1484375, "mode": "test", "epoch": 56}
{"loss": 0.10195522755384445, "acc": 0.9686790108680725, "length": 4.039966583251953, "mode": "train", "epoch": 57}
{"loss": 0.17048296332359314, "acc": 0.955657958984375, "length": 3.9921875, "mode": "test", "epoch": 57}
{"loss": 0.10097141563892365, "acc": 0.9674838185310364, "length": 3.9666340351104736, "mode": "train", "epoch": 58}
{"loss": 0.16435031592845917, "acc": 0.9539734125137329, "length": 3.76171875, "mode": "test", "epoch": 58}
{"loss": 0.0917198583483696, "acc": 0.9735091924667358, "length": 3.8279852867126465, "mode": "train", "epoch": 59}
{"loss": 0.1894967406988144, "acc": 0.9511291980743408, "length": 3.890625, "mode": "test", "epoch": 59}
{"loss": 0.09805071353912354, "acc": 0.971564769744873, "length": 3.9641528129577637, "mode": "train", "epoch": 60}
{"loss": 0.1654682159423828, "acc": 0.9515137076377869, "length": 3.8671875, "mode": "test", "epoch": 60}
test accuracy: 0.8787482976913452
