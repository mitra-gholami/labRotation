# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.6984579563140869, "acc": 0.5264835953712463, "length": 4.023541450500488, "mode": "train", "epoch": 1}
{"loss": 0.6949362754821777, "acc": 0.5097222328186035, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6917111277580261, "acc": 0.5288066267967224, "length": 1.1847440004348755, "mode": "train", "epoch": 2}
{"loss": 0.6940115094184875, "acc": 0.5166666507720947, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6497325897216797, "acc": 0.6329511404037476, "length": 2.592458963394165, "mode": "train", "epoch": 3}
{"loss": 0.6046980619430542, "acc": 0.6626410484313965, "length": 2.0798611640930176, "mode": "test", "epoch": 3}
{"loss": 0.5700383186340332, "acc": 0.7282565236091614, "length": 2.4178335666656494, "mode": "train", "epoch": 4}
{"loss": 0.6025602221488953, "acc": 0.7386555075645447, "length": 2.8854167461395264, "mode": "test", "epoch": 4}
{"loss": 0.4866062104701996, "acc": 0.7894392609596252, "length": 2.7552101612091064, "mode": "train", "epoch": 5}
{"loss": 0.5231135487556458, "acc": 0.7620660066604614, "length": 3.597222328186035, "mode": "test", "epoch": 5}
{"loss": 0.4442627429962158, "acc": 0.7949066758155823, "length": 2.717846155166626, "mode": "train", "epoch": 6}
{"loss": 0.4827117323875427, "acc": 0.7813206315040588, "length": 2.8020832538604736, "mode": "test", "epoch": 6}
{"loss": 0.42914286255836487, "acc": 0.804125189781189, "length": 2.630746603012085, "mode": "train", "epoch": 7}
{"loss": 0.4821600914001465, "acc": 0.777918815612793, "length": 2.3888888359069824, "mode": "test", "epoch": 7}
{"loss": 0.41501909494400024, "acc": 0.803684651851654, "length": 2.667905807495117, "mode": "train", "epoch": 8}
{"loss": 0.4974760413169861, "acc": 0.78125, "length": 3.0138888359069824, "mode": "test", "epoch": 8}
{"loss": 0.4107166826725006, "acc": 0.8087267875671387, "length": 2.7578659057617188, "mode": "train", "epoch": 9}
{"loss": 0.4938734471797943, "acc": 0.7843912243843079, "length": 2.2708332538604736, "mode": "test", "epoch": 9}
{"loss": 0.3947845697402954, "acc": 0.8186857104301453, "length": 2.939265012741089, "mode": "train", "epoch": 10}
{"loss": 0.4760052263736725, "acc": 0.7938422560691833, "length": 2.7638888359069824, "mode": "test", "epoch": 10}
{"loss": 0.36699968576431274, "acc": 0.8380082249641418, "length": 3.6741650104522705, "mode": "train", "epoch": 11}
{"loss": 0.4607338309288025, "acc": 0.8025281429290771, "length": 3.9861111640930176, "mode": "test", "epoch": 11}
{"loss": 0.3487532436847687, "acc": 0.8528918027877808, "length": 4.046957015991211, "mode": "train", "epoch": 12}
{"loss": 0.4264647662639618, "acc": 0.8254123330116272, "length": 4.465277671813965, "mode": "test", "epoch": 12}
{"loss": 0.326306015253067, "acc": 0.8668038249015808, "length": 4.53330659866333, "mode": "train", "epoch": 13}
{"loss": 0.41642510890960693, "acc": 0.8266384601593018, "length": 4.645833492279053, "mode": "test", "epoch": 13}
{"loss": 0.3069572448730469, "acc": 0.8702134490013123, "length": 5.017332553863525, "mode": "train", "epoch": 14}
{"loss": 0.372749924659729, "acc": 0.8481010794639587, "length": 5.548611164093018, "mode": "test", "epoch": 14}
{"loss": 0.2784114480018616, "acc": 0.8861726522445679, "length": 5.939096927642822, "mode": "train", "epoch": 15}
{"loss": 0.3573649525642395, "acc": 0.8569986820220947, "length": 6.145833492279053, "mode": "test", "epoch": 15}
{"loss": 0.2587467432022095, "acc": 0.8975222706794739, "length": 6.306604862213135, "mode": "train", "epoch": 16}
{"loss": 0.3182864785194397, "acc": 0.8754394054412842, "length": 7.14930534362793, "mode": "test", "epoch": 16}
{"loss": 0.23918820917606354, "acc": 0.9046306610107422, "length": 7.000644683837891, "mode": "train", "epoch": 17}
{"loss": 0.3299974501132965, "acc": 0.8705729246139526, "length": 6.920138835906982, "mode": "test", "epoch": 17}
{"loss": 0.21410077810287476, "acc": 0.9184971451759338, "length": 7.648148536682129, "mode": "train", "epoch": 18}
{"loss": 0.3408362865447998, "acc": 0.8753146529197693, "length": 8.08680534362793, "mode": "test", "epoch": 18}
{"loss": 0.20950566232204437, "acc": 0.9203696250915527, "length": 8.329584121704102, "mode": "train", "epoch": 19}
{"loss": 0.29768458008766174, "acc": 0.8899685740470886, "length": 8.79861068725586, "mode": "test", "epoch": 19}
{"loss": 0.20287352800369263, "acc": 0.9211395382881165, "length": 8.54211139678955, "mode": "train", "epoch": 20}
{"loss": 0.2857156991958618, "acc": 0.8958823084831238, "length": 8.33680534362793, "mode": "test", "epoch": 20}
{"loss": 0.17977997660636902, "acc": 0.9330883026123047, "length": 8.585866928100586, "mode": "train", "epoch": 21}
{"loss": 0.26988548040390015, "acc": 0.9076986312866211, "length": 8.878472328186035, "mode": "test", "epoch": 21}
{"loss": 0.17724306881427765, "acc": 0.9363214373588562, "length": 8.873064994812012, "mode": "train", "epoch": 22}
{"loss": 0.2844255268573761, "acc": 0.9033799767494202, "length": 8.75, "mode": "test", "epoch": 22}
{"loss": 0.16205067932605743, "acc": 0.9433638453483582, "length": 9.185074806213379, "mode": "train", "epoch": 23}
{"loss": 0.24989254772663116, "acc": 0.9112900495529175, "length": 9.614583015441895, "mode": "test", "epoch": 23}
{"loss": 0.1583767682313919, "acc": 0.9426688551902771, "length": 9.609204292297363, "mode": "train", "epoch": 24}
{"loss": 0.27868568897247314, "acc": 0.9090765714645386, "length": 9.43055534362793, "mode": "test", "epoch": 24}
{"loss": 0.14969879388809204, "acc": 0.9470937252044678, "length": 9.58160400390625, "mode": "train", "epoch": 25}
{"loss": 0.2269067019224167, "acc": 0.9139865040779114, "length": 9.72569465637207, "mode": "test", "epoch": 25}
{"loss": 0.14082273840904236, "acc": 0.9512314796447754, "length": 9.567970275878906, "mode": "train", "epoch": 26}
{"loss": 0.21002966165542603, "acc": 0.9223577976226807, "length": 9.42013931274414, "mode": "test", "epoch": 26}
{"loss": 0.1301007866859436, "acc": 0.9564656019210815, "length": 9.4122896194458, "mode": "train", "epoch": 27}
{"loss": 0.19203230738639832, "acc": 0.9253419041633606, "length": 9.82986068725586, "mode": "test", "epoch": 27}
{"loss": 0.11201659590005875, "acc": 0.9645366072654724, "length": 9.983896255493164, "mode": "train", "epoch": 28}
{"loss": 0.22559423744678497, "acc": 0.9208115339279175, "length": 10.277777671813965, "mode": "test", "epoch": 28}
{"loss": 0.11733284592628479, "acc": 0.9577697515487671, "length": 9.875946044921875, "mode": "train", "epoch": 29}
{"loss": 0.1862633377313614, "acc": 0.9276313781738281, "length": 10.020833015441895, "mode": "test", "epoch": 29}
{"loss": 0.10349492728710175, "acc": 0.9666670560836792, "length": 10.02265453338623, "mode": "train", "epoch": 30}
{"loss": 0.1937306821346283, "acc": 0.9300292134284973, "length": 10.22569465637207, "mode": "test", "epoch": 30}
{"loss": 0.09371473640203476, "acc": 0.9718664884567261, "length": 10.28113842010498, "mode": "train", "epoch": 31}
{"loss": 0.1684379130601883, "acc": 0.9392306804656982, "length": 10.4375, "mode": "test", "epoch": 31}
{"loss": 0.08840388804674149, "acc": 0.9736831784248352, "length": 10.366716384887695, "mode": "train", "epoch": 32}
{"loss": 0.1390676200389862, "acc": 0.9549859166145325, "length": 10.49305534362793, "mode": "test", "epoch": 32}
{"loss": 0.07698182761669159, "acc": 0.9789655208587646, "length": 10.48586368560791, "mode": "train", "epoch": 33}
{"loss": 0.15375050902366638, "acc": 0.9406195878982544, "length": 10.70486068725586, "mode": "test", "epoch": 33}
{"loss": 0.07461605966091156, "acc": 0.9789029359817505, "length": 10.606829643249512, "mode": "train", "epoch": 34}
{"loss": 0.12201464176177979, "acc": 0.9547417759895325, "length": 10.777777671813965, "mode": "test", "epoch": 34}
{"loss": 0.06380297243595123, "acc": 0.9838330745697021, "length": 10.661916732788086, "mode": "train", "epoch": 35}
{"loss": 0.10625100135803223, "acc": 0.9622666835784912, "length": 10.77430534362793, "mode": "test", "epoch": 35}
{"loss": 0.06435256451368332, "acc": 0.9852203130722046, "length": 10.670948028564453, "mode": "train", "epoch": 36}
{"loss": 0.1401396244764328, "acc": 0.9498210549354553, "length": 10.76388931274414, "mode": "test", "epoch": 36}
{"loss": 0.07149838656187057, "acc": 0.9814223051071167, "length": 10.73888111114502, "mode": "train", "epoch": 37}
{"loss": 0.15557861328125, "acc": 0.9485622048377991, "length": 10.95486068725586, "mode": "test", "epoch": 37}
{"loss": 0.061641622334718704, "acc": 0.9854314923286438, "length": 10.758042335510254, "mode": "train", "epoch": 38}
{"loss": 0.10234550386667252, "acc": 0.9702636003494263, "length": 10.909722328186035, "mode": "test", "epoch": 38}
{"loss": 0.06504152715206146, "acc": 0.9830594062805176, "length": 10.761385917663574, "mode": "train", "epoch": 39}
{"loss": 0.11048541218042374, "acc": 0.9528104066848755, "length": 10.82986068725586, "mode": "test", "epoch": 39}
{"loss": 0.05420408770442009, "acc": 0.9889295697212219, "length": 10.724214553833008, "mode": "train", "epoch": 40}
{"loss": 0.08914092928171158, "acc": 0.971348762512207, "length": 10.89236068725586, "mode": "test", "epoch": 40}
{"loss": 0.04126810282468796, "acc": 0.9939551949501038, "length": 10.800782203674316, "mode": "train", "epoch": 41}
{"loss": 0.0820394903421402, "acc": 0.973562479019165, "length": 10.91319465637207, "mode": "test", "epoch": 41}
{"loss": 0.03873114287853241, "acc": 0.9953663945198059, "length": 10.879666328430176, "mode": "train", "epoch": 42}
{"loss": 0.0669066309928894, "acc": 0.9852212071418762, "length": 10.927083015441895, "mode": "test", "epoch": 42}
{"loss": 0.037361882627010345, "acc": 0.9955335259437561, "length": 10.898942947387695, "mode": "train", "epoch": 43}
{"loss": 0.08358169347047806, "acc": 0.9771104454994202, "length": 10.95486068725586, "mode": "test", "epoch": 43}
{"loss": 0.04086202383041382, "acc": 0.9931301474571228, "length": 10.896080017089844, "mode": "train", "epoch": 44}
{"loss": 0.07520449906587601, "acc": 0.9776855111122131, "length": 10.95486068725586, "mode": "test", "epoch": 44}
{"loss": 0.043192945420742035, "acc": 0.9913225173950195, "length": 10.895330429077148, "mode": "train", "epoch": 45}
{"loss": 0.10472872853279114, "acc": 0.9691949486732483, "length": 10.965277671813965, "mode": "test", "epoch": 45}
{"loss": 0.03859946131706238, "acc": 0.9932907223701477, "length": 10.900677680969238, "mode": "train", "epoch": 46}
{"loss": 0.08350031822919846, "acc": 0.9750434160232544, "length": 10.940972328186035, "mode": "test", "epoch": 46}
{"loss": 0.030244868248701096, "acc": 0.9966970086097717, "length": 10.944663047790527, "mode": "train", "epoch": 47}
{"loss": 0.07664668560028076, "acc": 0.9795464277267456, "length": 10.947916984558105, "mode": "test", "epoch": 47}
{"loss": 0.029299968853592873, "acc": 0.9969428777694702, "length": 10.940110206604004, "mode": "train", "epoch": 48}
{"loss": 0.076189786195755, "acc": 0.980555534362793, "length": 10.98611068725586, "mode": "test", "epoch": 48}
{"loss": 0.028509965166449547, "acc": 0.9973331093788147, "length": 10.948705673217773, "mode": "train", "epoch": 49}
{"loss": 0.07012021541595459, "acc": 0.9760036468505859, "length": 10.98263931274414, "mode": "test", "epoch": 49}
{"loss": 0.028279315680265427, "acc": 0.9976955652236938, "length": 10.94073486328125, "mode": "train", "epoch": 50}
{"loss": 0.06375060975551605, "acc": 0.9846407771110535, "length": 10.979166984558105, "mode": "test", "epoch": 50}
{"loss": 0.02481532283127308, "acc": 0.9984159469604492, "length": 10.96156120300293, "mode": "train", "epoch": 51}
{"loss": 0.05947950854897499, "acc": 0.985025942325592, "length": 10.99305534362793, "mode": "test", "epoch": 51}
{"loss": 0.026838114485144615, "acc": 0.9974183440208435, "length": 10.966647148132324, "mode": "train", "epoch": 52}
{"loss": 0.06852204352617264, "acc": 0.9808485507965088, "length": 10.965277671813965, "mode": "test", "epoch": 52}
{"loss": 0.027535412460565567, "acc": 0.9975891709327698, "length": 10.959429740905762, "mode": "train", "epoch": 53}
{"loss": 0.0763837918639183, "acc": 0.9834906458854675, "length": 10.99305534362793, "mode": "test", "epoch": 53}
{"loss": 0.028513528406620026, "acc": 0.9970057010650635, "length": 10.967032432556152, "mode": "train", "epoch": 54}
{"loss": 0.06400320678949356, "acc": 0.982264518737793, "length": 10.996527671813965, "mode": "test", "epoch": 54}
{"loss": 0.025518810376524925, "acc": 0.9976500272750854, "length": 10.9556303024292, "mode": "train", "epoch": 55}
{"loss": 0.05209752917289734, "acc": 0.9874728322029114, "length": 10.996527671813965, "mode": "test", "epoch": 55}
{"loss": 0.028032805770635605, "acc": 0.9964517951011658, "length": 10.96525764465332, "mode": "train", "epoch": 56}
{"loss": 0.06454236060380936, "acc": 0.9840277433395386, "length": 11.0, "mode": "test", "epoch": 56}
{"loss": 0.02809096872806549, "acc": 0.9962840676307678, "length": 10.974104881286621, "mode": "train", "epoch": 57}
{"loss": 0.07626675814390182, "acc": 0.9817708134651184, "length": 10.996527671813965, "mode": "test", "epoch": 57}
{"loss": 0.031558647751808167, "acc": 0.9952290058135986, "length": 10.966543197631836, "mode": "train", "epoch": 58}
{"loss": 0.08734790235757828, "acc": 0.9812608361244202, "length": 10.996527671813965, "mode": "test", "epoch": 58}
{"loss": 0.02537795715034008, "acc": 0.9978125691413879, "length": 10.960175514221191, "mode": "train", "epoch": 59}
{"loss": 0.08739794045686722, "acc": 0.9800347089767456, "length": 11.0, "mode": "test", "epoch": 59}
{"loss": 0.025801269337534904, "acc": 0.9960630536079407, "length": 10.958361625671387, "mode": "train", "epoch": 60}
{"loss": 0.09036754071712494, "acc": 0.9744465947151184, "length": 10.98611068725586, "mode": "test", "epoch": 60}
test accuracy: 0.7794749736785889
