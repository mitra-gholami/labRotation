# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7400494813919067, "acc": 0.529201865196228, "length": 4.788949966430664, "mode": "train", "epoch": 1}
{"loss": 0.7010414004325867, "acc": 0.5376953482627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7025268077850342, "acc": 0.5408355593681335, "length": 1.074257254600525, "mode": "train", "epoch": 2}
{"loss": 0.7001403570175171, "acc": 0.5316405892372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7004481554031372, "acc": 0.5321004986763, "length": 1.0321706533432007, "mode": "train", "epoch": 3}
{"loss": 0.7012133002281189, "acc": 0.536914050579071, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7006855607032776, "acc": 0.5440137386322021, "length": 1.0202370882034302, "mode": "train", "epoch": 4}
{"loss": 0.7008101940155029, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7000619173049927, "acc": 0.5372920632362366, "length": 1.0149052143096924, "mode": "train", "epoch": 5}
{"loss": 0.7017300724983215, "acc": 0.5310547351837158, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.7008787989616394, "acc": 0.5286707282066345, "length": 1.011012077331543, "mode": "train", "epoch": 6}
{"loss": 0.6999790072441101, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.7003822326660156, "acc": 0.5411325097084045, "length": 1.0085176229476929, "mode": "train", "epoch": 7}
{"loss": 0.699541449546814, "acc": 0.5279297232627869, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6992315649986267, "acc": 0.5361892580986023, "length": 1.0067241191864014, "mode": "train", "epoch": 8}
{"loss": 0.7008379697799683, "acc": 0.5365234017372131, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6996337175369263, "acc": 0.5456363558769226, "length": 1.0058587789535522, "mode": "train", "epoch": 9}
{"loss": 0.7008299827575684, "acc": 0.5191406607627869, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6994898915290833, "acc": 0.5404102802276611, "length": 1.004658579826355, "mode": "train", "epoch": 10}
{"loss": 0.699005126953125, "acc": 0.5367187857627869, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6992117762565613, "acc": 0.5434894561767578, "length": 1.0040128231048584, "mode": "train", "epoch": 11}
{"loss": 0.701410174369812, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6992645859718323, "acc": 0.544291615486145, "length": 1.0031449794769287, "mode": "train", "epoch": 12}
{"loss": 0.7003456354141235, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6986787915229797, "acc": 0.5468331575393677, "length": 1.0025207996368408, "mode": "train", "epoch": 13}
{"loss": 0.699009358882904, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6980299353599548, "acc": 0.5417265892028809, "length": 1.0023019313812256, "mode": "train", "epoch": 14}
{"loss": 0.7003169059753418, "acc": 0.5394530892372131, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6992648839950562, "acc": 0.5368335843086243, "length": 1.0019960403442383, "mode": "train", "epoch": 15}
{"loss": 0.6995012164115906, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6986293196678162, "acc": 0.5435112714767456, "length": 1.0016849040985107, "mode": "train", "epoch": 16}
{"loss": 0.7001413106918335, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6988661289215088, "acc": 0.5413594245910645, "length": 1.001522183418274, "mode": "train", "epoch": 17}
{"loss": 0.6993896961212158, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6995909214019775, "acc": 0.5455306768417358, "length": 1.0013922452926636, "mode": "train", "epoch": 18}
{"loss": 0.6998592615127563, "acc": 0.5312500596046448, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6983768939971924, "acc": 0.5404638648033142, "length": 1.0011019706726074, "mode": "train", "epoch": 19}
{"loss": 0.6995368599891663, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6986534595489502, "acc": 0.549580454826355, "length": 1.0009111166000366, "mode": "train", "epoch": 20}
{"loss": 0.6991967558860779, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6983546614646912, "acc": 0.5468501448631287, "length": 1.0010119676589966, "mode": "train", "epoch": 21}
{"loss": 0.7003563046455383, "acc": 0.5308594107627869, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6985564231872559, "acc": 0.540762186050415, "length": 1.000762701034546, "mode": "train", "epoch": 22}
{"loss": 0.6989941000938416, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6977489590644836, "acc": 0.5432072281837463, "length": 1.000711441040039, "mode": "train", "epoch": 23}
{"loss": 0.6996768116950989, "acc": 0.5326171517372131, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6969982981681824, "acc": 0.5506565570831299, "length": 1.0005662441253662, "mode": "train", "epoch": 24}
{"loss": 0.6989532113075256, "acc": 0.5447264313697815, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6979530453681946, "acc": 0.5402286648750305, "length": 1.0005381107330322, "mode": "train", "epoch": 25}
{"loss": 0.6985538005828857, "acc": 0.5447264313697815, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6983689665794373, "acc": 0.5387351512908936, "length": 1.0004334449768066, "mode": "train", "epoch": 26}
{"loss": 0.6999638676643372, "acc": 0.534375011920929, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6973815560340881, "acc": 0.5417770147323608, "length": 1.0003952980041504, "mode": "train", "epoch": 27}
{"loss": 0.6995399594306946, "acc": 0.5400390625, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6990606784820557, "acc": 0.5495234727859497, "length": 1.0003626346588135, "mode": "train", "epoch": 28}
{"loss": 0.6990541219711304, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6971428394317627, "acc": 0.5446364283561707, "length": 1.00032639503479, "mode": "train", "epoch": 29}
{"loss": 0.6989943981170654, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6970390677452087, "acc": 0.5448176264762878, "length": 1.0003169775009155, "mode": "train", "epoch": 30}
{"loss": 0.6984690427780151, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6977388858795166, "acc": 0.5424907207489014, "length": 1.0002716779708862, "mode": "train", "epoch": 31}
{"loss": 0.6990616321563721, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6968125104904175, "acc": 0.5443371534347534, "length": 1.0002511739730835, "mode": "train", "epoch": 32}
{"loss": 0.6999082565307617, "acc": 0.5310547351837158, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6956915259361267, "acc": 0.5483918190002441, "length": 1.0002115964889526, "mode": "train", "epoch": 33}
{"loss": 0.6989675760269165, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6958114504814148, "acc": 0.5433844923973083, "length": 1.000175952911377, "mode": "train", "epoch": 34}
{"loss": 0.6991715431213379, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.696326732635498, "acc": 0.5587601065635681, "length": 1.0001636743545532, "mode": "train", "epoch": 35}
{"loss": 0.6988020539283752, "acc": 0.543164074420929, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.695258617401123, "acc": 0.5408833622932434, "length": 1.0002466440200806, "mode": "train", "epoch": 36}
{"loss": 0.6978402137756348, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6966328024864197, "acc": 0.5439215302467346, "length": 1.0001311302185059, "mode": "train", "epoch": 37}
{"loss": 0.6982747912406921, "acc": 0.537109375, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6965304017066956, "acc": 0.5486279726028442, "length": 1.0001544952392578, "mode": "train", "epoch": 38}
{"loss": 0.6982499361038208, "acc": 0.537304699420929, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6957831382751465, "acc": 0.5468418598175049, "length": 1.000112771987915, "mode": "train", "epoch": 39}
{"loss": 0.698344349861145, "acc": 0.539257824420929, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6957938075065613, "acc": 0.5545287728309631, "length": 1.0001004934310913, "mode": "train", "epoch": 40}
{"loss": 0.6983810067176819, "acc": 0.513671875, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6966544985771179, "acc": 0.548689067363739, "length": 1.0000799894332886, "mode": "train", "epoch": 41}
{"loss": 0.6977311968803406, "acc": 0.524609386920929, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6954193711280823, "acc": 0.5403454303741455, "length": 1.0000832080841064, "mode": "train", "epoch": 42}
{"loss": 0.697361946105957, "acc": 0.535351574420929, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.693398118019104, "acc": 0.5499998331069946, "length": 1.0000756978988647, "mode": "train", "epoch": 43}
{"loss": 0.6972978115081787, "acc": 0.5228515267372131, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6945590376853943, "acc": 0.5480934381484985, "length": 1.0000585317611694, "mode": "train", "epoch": 44}
{"loss": 0.6980308890342712, "acc": 0.5320312976837158, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6941109299659729, "acc": 0.5489276647567749, "length": 1.000055193901062, "mode": "train", "epoch": 45}
{"loss": 0.6975470185279846, "acc": 0.513671875, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6957029700279236, "acc": 0.5505958795547485, "length": 1.000045895576477, "mode": "train", "epoch": 46}
{"loss": 0.6981322169303894, "acc": 0.54296875, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6959593892097473, "acc": 0.5474375486373901, "length": 1.0000461339950562, "mode": "train", "epoch": 47}
{"loss": 0.697209358215332, "acc": 0.529492199420929, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6934594511985779, "acc": 0.5596538782119751, "length": 1.0000455379486084, "mode": "train", "epoch": 48}
{"loss": 0.6962000727653503, "acc": 0.5412108898162842, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6933489441871643, "acc": 0.556734025478363, "length": 1.0000327825546265, "mode": "train", "epoch": 49}
{"loss": 0.6967595815658569, "acc": 0.5224609375, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6937288641929626, "acc": 0.5484504103660583, "length": 1.000035047531128, "mode": "train", "epoch": 50}
{"loss": 0.6965345740318298, "acc": 0.5423827767372131, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6921794414520264, "acc": 0.5588198304176331, "length": 1.000026822090149, "mode": "train", "epoch": 51}
{"loss": 0.6958389282226562, "acc": 0.5478515625, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6925028562545776, "acc": 0.5529799461364746, "length": 1.0000232458114624, "mode": "train", "epoch": 52}
{"loss": 0.6958531737327576, "acc": 0.5412108898162842, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6941893100738525, "acc": 0.5535756349563599, "length": 1.0000230073928833, "mode": "train", "epoch": 53}
{"loss": 0.6958467364311218, "acc": 0.539257824420929, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6912277936935425, "acc": 0.556495726108551, "length": 1.0000168085098267, "mode": "train", "epoch": 54}
{"loss": 0.6961419582366943, "acc": 0.5423827767372131, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6930163502693176, "acc": 0.5570917129516602, "length": 1.0000158548355103, "mode": "train", "epoch": 55}
{"loss": 0.6946419477462769, "acc": 0.5277343392372131, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6925499439239502, "acc": 0.5578663945198059, "length": 1.0000152587890625, "mode": "train", "epoch": 56}
{"loss": 0.6963608860969543, "acc": 0.54296875, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6926663517951965, "acc": 0.5470799207687378, "length": 1.0000206232070923, "mode": "train", "epoch": 57}
{"loss": 0.6941611766815186, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6909346580505371, "acc": 0.5554826259613037, "length": 1.0000141859054565, "mode": "train", "epoch": 58}
{"loss": 0.6938989162445068, "acc": 0.5500001311302185, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6905120611190796, "acc": 0.54946368932724, "length": 1.0000165700912476, "mode": "train", "epoch": 59}
{"loss": 0.6937130689620972, "acc": 0.5500001311302185, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6909878253936768, "acc": 0.5569725036621094, "length": 1.0000101327896118, "mode": "train", "epoch": 60}
{"loss": 0.6928577423095703, "acc": 0.544726550579071, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.3243749737739563
