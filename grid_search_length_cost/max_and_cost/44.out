# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6970961093902588, "acc": 0.527389645576477, "length": 3.051011800765991, "mode": "train", "epoch": 1}
{"loss": 0.6941738724708557, "acc": 0.5115830898284912, "length": 1.0729166269302368, "mode": "test", "epoch": 1}
{"loss": 0.6443622708320618, "acc": 0.6417961120605469, "length": 2.5110647678375244, "mode": "train", "epoch": 2}
{"loss": 0.6104825139045715, "acc": 0.7053765058517456, "length": 2.5833332538604736, "mode": "test", "epoch": 2}
{"loss": 0.5652055144309998, "acc": 0.7256823182106018, "length": 2.824615001678467, "mode": "train", "epoch": 3}
{"loss": 0.5284152626991272, "acc": 0.7678439617156982, "length": 2.9375, "mode": "test", "epoch": 3}
{"loss": 0.45626339316368103, "acc": 0.809910237789154, "length": 3.2646031379699707, "mode": "train", "epoch": 4}
{"loss": 0.44769588112831116, "acc": 0.8272135257720947, "length": 3.2395832538604736, "mode": "test", "epoch": 4}
{"loss": 0.38748520612716675, "acc": 0.8448008298873901, "length": 3.4357004165649414, "mode": "train", "epoch": 5}
{"loss": 0.41391149163246155, "acc": 0.8385416865348816, "length": 3.3541667461395264, "mode": "test", "epoch": 5}
{"loss": 0.34712883830070496, "acc": 0.8605339527130127, "length": 3.566956043243408, "mode": "train", "epoch": 6}
{"loss": 0.37046682834625244, "acc": 0.8391872644424438, "length": 3.6770832538604736, "mode": "test", "epoch": 6}
{"loss": 0.3135623335838318, "acc": 0.874727189540863, "length": 3.7921981811523438, "mode": "train", "epoch": 7}
{"loss": 0.3701052963733673, "acc": 0.8505207300186157, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.29077041149139404, "acc": 0.8837219476699829, "length": 3.9070115089416504, "mode": "train", "epoch": 8}
{"loss": 0.3330906629562378, "acc": 0.8743056654930115, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.2730657458305359, "acc": 0.8936039209365845, "length": 3.9305338859558105, "mode": "train", "epoch": 9}
{"loss": 0.3286570608615875, "acc": 0.8809027075767517, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.2641844153404236, "acc": 0.8959064483642578, "length": 3.948945999145508, "mode": "train", "epoch": 10}
{"loss": 0.340949684381485, "acc": 0.8644096851348877, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.24861960113048553, "acc": 0.9020664691925049, "length": 3.9560093879699707, "mode": "train", "epoch": 11}
{"loss": 0.31641000509262085, "acc": 0.8881945013999939, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.23758164048194885, "acc": 0.9058228731155396, "length": 3.9608824253082275, "mode": "train", "epoch": 12}
{"loss": 0.3053359389305115, "acc": 0.8737847805023193, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.22692210972309113, "acc": 0.9148877859115601, "length": 3.9699463844299316, "mode": "train", "epoch": 13}
{"loss": 0.2781113088130951, "acc": 0.8965277075767517, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.21746975183486938, "acc": 0.919246256351471, "length": 3.971989870071411, "mode": "train", "epoch": 14}
{"loss": 0.27664002776145935, "acc": 0.8932291865348816, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.21417616307735443, "acc": 0.9209907650947571, "length": 3.9814465045928955, "mode": "train", "epoch": 15}
{"loss": 0.2727549970149994, "acc": 0.9065972566604614, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.19583448767662048, "acc": 0.92545485496521, "length": 3.983920097351074, "mode": "train", "epoch": 16}
{"loss": 0.28409937024116516, "acc": 0.8996527194976807, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.19106294214725494, "acc": 0.9282343983650208, "length": 3.985769033432007, "mode": "train", "epoch": 17}
{"loss": 0.25273528695106506, "acc": 0.9118055701255798, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.1763397753238678, "acc": 0.9362757802009583, "length": 3.9890520572662354, "mode": "train", "epoch": 18}
{"loss": 0.23401933908462524, "acc": 0.9190971851348877, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.17486689984798431, "acc": 0.936164379119873, "length": 3.989793539047241, "mode": "train", "epoch": 19}
{"loss": 0.2468666285276413, "acc": 0.9116320013999939, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.16992506384849548, "acc": 0.9381937980651855, "length": 3.991846799850464, "mode": "train", "epoch": 20}
{"loss": 0.24109193682670593, "acc": 0.9126736521720886, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.16015034914016724, "acc": 0.9399594664573669, "length": 3.992924690246582, "mode": "train", "epoch": 21}
{"loss": 0.20940916240215302, "acc": 0.933506965637207, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.15491512417793274, "acc": 0.9440616369247437, "length": 3.994046211242676, "mode": "train", "epoch": 22}
{"loss": 0.21850477159023285, "acc": 0.9265625476837158, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.15359172224998474, "acc": 0.9449098110198975, "length": 3.995620012283325, "mode": "train", "epoch": 23}
{"loss": 0.2132958173751831, "acc": 0.9296875, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.15130218863487244, "acc": 0.9440670013427734, "length": 3.9956555366516113, "mode": "train", "epoch": 24}
{"loss": 0.23399631679058075, "acc": 0.9288194179534912, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.14654481410980225, "acc": 0.9481108784675598, "length": 3.995297431945801, "mode": "train", "epoch": 25}
{"loss": 0.18315836787223816, "acc": 0.9395833611488342, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.13959041237831116, "acc": 0.9473856687545776, "length": 3.995270013809204, "mode": "train", "epoch": 26}
{"loss": 0.19238682091236115, "acc": 0.9333333969116211, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.13251689076423645, "acc": 0.950996994972229, "length": 3.995027780532837, "mode": "train", "epoch": 27}
{"loss": 0.17396938800811768, "acc": 0.9322916865348816, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.12235208600759506, "acc": 0.9580305218696594, "length": 3.996340036392212, "mode": "train", "epoch": 28}
{"loss": 0.18229636549949646, "acc": 0.9322916865348816, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.11011261492967606, "acc": 0.9602991342544556, "length": 3.996734380722046, "mode": "train", "epoch": 29}
{"loss": 0.18346212804317474, "acc": 0.9399304986000061, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.11213932931423187, "acc": 0.9578034281730652, "length": 3.9960849285125732, "mode": "train", "epoch": 30}
{"loss": 0.1525861769914627, "acc": 0.9428820013999939, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.10157322138547897, "acc": 0.9646731615066528, "length": 3.9973087310791016, "mode": "train", "epoch": 31}
{"loss": 0.15739022195339203, "acc": 0.9498264789581299, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.11067117750644684, "acc": 0.9608712196350098, "length": 3.9971537590026855, "mode": "train", "epoch": 32}
{"loss": 0.1588195562362671, "acc": 0.9460068941116333, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.09689224511384964, "acc": 0.9659239649772644, "length": 3.997436046600342, "mode": "train", "epoch": 33}
{"loss": 0.14557571709156036, "acc": 0.9546874165534973, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.08820662647485733, "acc": 0.96983802318573, "length": 3.997934103012085, "mode": "train", "epoch": 34}
{"loss": 0.1554577797651291, "acc": 0.949652910232544, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.07933799922466278, "acc": 0.9727299809455872, "length": 3.9980010986328125, "mode": "train", "epoch": 35}
{"loss": 0.14175862073898315, "acc": 0.9560763835906982, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.08316262811422348, "acc": 0.9725140333175659, "length": 3.998504877090454, "mode": "train", "epoch": 36}
{"loss": 0.12434497475624084, "acc": 0.9572916030883789, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.07467398792505264, "acc": 0.9739806056022644, "length": 3.998497247695923, "mode": "train", "epoch": 37}
{"loss": 0.1663280725479126, "acc": 0.9430555701255798, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.07082109898328781, "acc": 0.9772616028785706, "length": 3.9984076023101807, "mode": "train", "epoch": 38}
{"loss": 0.13776834309101105, "acc": 0.9515625834465027, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.07390111684799194, "acc": 0.9760394096374512, "length": 3.9989237785339355, "mode": "train", "epoch": 39}
{"loss": 0.1230912059545517, "acc": 0.9619792103767395, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.06498800963163376, "acc": 0.9789232611656189, "length": 3.999077558517456, "mode": "train", "epoch": 40}
{"loss": 0.12671077251434326, "acc": 0.9609375, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.06293223798274994, "acc": 0.9800548553466797, "length": 3.99910044670105, "mode": "train", "epoch": 41}
{"loss": 0.14017833769321442, "acc": 0.9519097208976746, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.06795487552881241, "acc": 0.9783087968826294, "length": 3.9992692470550537, "mode": "train", "epoch": 42}
{"loss": 0.11591660976409912, "acc": 0.964756965637207, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.060865022242069244, "acc": 0.9795048832893372, "length": 3.9994101524353027, "mode": "train", "epoch": 43}
{"loss": 0.10597380250692368, "acc": 0.9696180820465088, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.05967151001095772, "acc": 0.9811450839042664, "length": 3.9993791580200195, "mode": "train", "epoch": 44}
{"loss": 0.1255681961774826, "acc": 0.9668402075767517, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.054595332592725754, "acc": 0.9842001795768738, "length": 3.9995200634002686, "mode": "train", "epoch": 45}
{"loss": 0.13465972244739532, "acc": 0.9675347208976746, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.04820379987359047, "acc": 0.9864084720611572, "length": 3.999572515487671, "mode": "train", "epoch": 46}
{"loss": 0.11482983082532883, "acc": 0.9682294130325317, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.049431659281253815, "acc": 0.9861817955970764, "length": 3.999558210372925, "mode": "train", "epoch": 47}
{"loss": 0.11139634251594543, "acc": 0.9644097089767456, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.045133356004953384, "acc": 0.9887288212776184, "length": 3.9995994567871094, "mode": "train", "epoch": 48}
{"loss": 0.10009900480508804, "acc": 0.9762152433395386, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.04757275432348251, "acc": 0.9858990907669067, "length": 3.999579668045044, "mode": "train", "epoch": 49}
{"loss": 0.1254182606935501, "acc": 0.9668402075767517, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.049233727157115936, "acc": 0.9853339791297913, "length": 3.9995551109313965, "mode": "train", "epoch": 50}
{"loss": 0.11460611969232559, "acc": 0.9692708253860474, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04039042070508003, "acc": 0.989412248134613, "length": 3.999715566635132, "mode": "train", "epoch": 51}
{"loss": 0.09114155173301697, "acc": 0.9769097566604614, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03724983334541321, "acc": 0.990035891532898, "length": 3.999758005142212, "mode": "train", "epoch": 52}
{"loss": 0.0924425795674324, "acc": 0.9755207896232605, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.030676336959004402, "acc": 0.9925196766853333, "length": 3.999704122543335, "mode": "train", "epoch": 53}
{"loss": 0.09849844127893448, "acc": 0.9755207896232605, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.03196018189191818, "acc": 0.9921861886978149, "length": 3.9997804164886475, "mode": "train", "epoch": 54}
{"loss": 0.08508987724781036, "acc": 0.9791666865348816, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03731291741132736, "acc": 0.9925802946090698, "length": 3.9997434616088867, "mode": "train", "epoch": 55}
{"loss": 0.08568516373634338, "acc": 0.9796874523162842, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.040346529334783554, "acc": 0.9890189170837402, "length": 3.9997336864471436, "mode": "train", "epoch": 56}
{"loss": 0.08113130182027817, "acc": 0.9812500476837158, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.02817460522055626, "acc": 0.9924152493476868, "length": 3.9998295307159424, "mode": "train", "epoch": 57}
{"loss": 0.08422636985778809, "acc": 0.9838540554046631, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.02762449160218239, "acc": 0.9933165311813354, "length": 3.9997785091400146, "mode": "train", "epoch": 58}
{"loss": 0.09329249709844589, "acc": 0.9784722924232483, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.02784416824579239, "acc": 0.9921899437904358, "length": 3.9998435974121094, "mode": "train", "epoch": 59}
{"loss": 0.08337198197841644, "acc": 0.9848958253860474, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.027942828834056854, "acc": 0.9940320253372192, "length": 3.999525785446167, "mode": "train", "epoch": 60}
{"loss": 0.10376837849617004, "acc": 0.9793403148651123, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7775000333786011
