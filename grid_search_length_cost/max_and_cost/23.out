# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7017673850059509, "acc": 0.5069258809089661, "length": 4.9968791007995605, "mode": "train", "epoch": 1}
{"loss": 0.6866122484207153, "acc": 0.5649306178092957, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6927298903465271, "acc": 0.5258657336235046, "length": 1.1109012365341187, "mode": "train", "epoch": 2}
{"loss": 0.681745707988739, "acc": 0.5694444179534912, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6875247359275818, "acc": 0.5325852632522583, "length": 1.5773133039474487, "mode": "train", "epoch": 3}
{"loss": 0.6502469182014465, "acc": 0.6612684726715088, "length": 6.152777671813965, "mode": "test", "epoch": 3}
{"loss": 0.6098850965499878, "acc": 0.6848121285438538, "length": 5.033286094665527, "mode": "train", "epoch": 4}
{"loss": 0.7148945927619934, "acc": 0.6870768070220947, "length": 14.23611068725586, "mode": "test", "epoch": 4}
{"loss": 0.5489879250526428, "acc": 0.718992292881012, "length": 3.9670169353485107, "mode": "train", "epoch": 5}
{"loss": 0.7102864384651184, "acc": 0.7244195342063904, "length": 10.03819465637207, "mode": "test", "epoch": 5}
{"loss": 0.4778047204017639, "acc": 0.7835376858711243, "length": 5.153654098510742, "mode": "train", "epoch": 6}
{"loss": 0.6517622470855713, "acc": 0.7881619334220886, "length": 14.809027671813965, "mode": "test", "epoch": 6}
{"loss": 0.43376049399375916, "acc": 0.8152928352355957, "length": 4.626418590545654, "mode": "train", "epoch": 7}
{"loss": 0.6691917181015015, "acc": 0.7894151210784912, "length": 10.92013931274414, "mode": "test", "epoch": 7}
{"loss": 0.40443155169487, "acc": 0.8221838474273682, "length": 4.829369068145752, "mode": "train", "epoch": 8}
{"loss": 0.5574947595596313, "acc": 0.797119140625, "length": 8.70138931274414, "mode": "test", "epoch": 8}
{"loss": 0.36060211062431335, "acc": 0.8516316413879395, "length": 5.58842658996582, "mode": "train", "epoch": 9}
{"loss": 0.4754876494407654, "acc": 0.8162543773651123, "length": 12.04861068725586, "mode": "test", "epoch": 9}
{"loss": 0.3209622800350189, "acc": 0.8730824589729309, "length": 6.632096767425537, "mode": "train", "epoch": 10}
{"loss": 0.39850664138793945, "acc": 0.8336099982261658, "length": 13.229166984558105, "mode": "test", "epoch": 10}
{"loss": 0.2941610515117645, "acc": 0.8868825435638428, "length": 6.836429119110107, "mode": "train", "epoch": 11}
{"loss": 0.3663937747478485, "acc": 0.8573567867279053, "length": 12.54513931274414, "mode": "test", "epoch": 11}
{"loss": 0.27325278520584106, "acc": 0.8964228630065918, "length": 6.883180141448975, "mode": "train", "epoch": 12}
{"loss": 0.3447868824005127, "acc": 0.8675076365470886, "length": 11.52430534362793, "mode": "test", "epoch": 12}
{"loss": 0.257327139377594, "acc": 0.9027961492538452, "length": 8.176868438720703, "mode": "train", "epoch": 13}
{"loss": 0.3415129482746124, "acc": 0.8798991441726685, "length": 12.3125, "mode": "test", "epoch": 13}
{"loss": 0.24631871283054352, "acc": 0.9066697955131531, "length": 8.261392593383789, "mode": "train", "epoch": 14}
{"loss": 0.32246851921081543, "acc": 0.8839247226715088, "length": 9.875, "mode": "test", "epoch": 14}
{"loss": 0.23065538704395294, "acc": 0.9164482355117798, "length": 7.908780097961426, "mode": "train", "epoch": 15}
{"loss": 0.3441151976585388, "acc": 0.8691080212593079, "length": 9.63888931274414, "mode": "test", "epoch": 15}
{"loss": 0.21860137581825256, "acc": 0.9183763861656189, "length": 8.474071502685547, "mode": "train", "epoch": 16}
{"loss": 0.346343994140625, "acc": 0.8667590022087097, "length": 9.354166984558105, "mode": "test", "epoch": 16}
{"loss": 0.21466851234436035, "acc": 0.9193914532661438, "length": 8.76538372039795, "mode": "train", "epoch": 17}
{"loss": 0.3108430504798889, "acc": 0.8890516757965088, "length": 9.23263931274414, "mode": "test", "epoch": 17}
{"loss": 0.2028227597475052, "acc": 0.9284015893936157, "length": 8.669065475463867, "mode": "train", "epoch": 18}
{"loss": 0.3134154677391052, "acc": 0.8827962279319763, "length": 8.0625, "mode": "test", "epoch": 18}
{"loss": 0.19603005051612854, "acc": 0.9305624961853027, "length": 8.593719482421875, "mode": "train", "epoch": 19}
{"loss": 0.3009379208087921, "acc": 0.8771864771842957, "length": 8.229166984558105, "mode": "test", "epoch": 19}
{"loss": 0.19035902619361877, "acc": 0.9312716126441956, "length": 8.949437141418457, "mode": "train", "epoch": 20}
{"loss": 0.26972898840904236, "acc": 0.8977485299110413, "length": 8.1875, "mode": "test", "epoch": 20}
{"loss": 0.16976700723171234, "acc": 0.9419106841087341, "length": 9.447754859924316, "mode": "train", "epoch": 21}
{"loss": 0.27515709400177, "acc": 0.9047254920005798, "length": 9.197916984558105, "mode": "test", "epoch": 21}
{"loss": 0.16670913994312286, "acc": 0.9422155618667603, "length": 9.703682899475098, "mode": "train", "epoch": 22}
{"loss": 0.23700812458992004, "acc": 0.9199272990226746, "length": 8.875, "mode": "test", "epoch": 22}
{"loss": 0.1748632788658142, "acc": 0.9368753433227539, "length": 9.57141399383545, "mode": "train", "epoch": 23}
{"loss": 0.2280321717262268, "acc": 0.917881965637207, "length": 7.298611164093018, "mode": "test", "epoch": 23}
{"loss": 0.15551865100860596, "acc": 0.9462442398071289, "length": 8.437105178833008, "mode": "train", "epoch": 24}
{"loss": 0.22722771763801575, "acc": 0.9248968958854675, "length": 8.53819465637207, "mode": "test", "epoch": 24}
{"loss": 0.14458370208740234, "acc": 0.9505611658096313, "length": 9.265182495117188, "mode": "train", "epoch": 25}
{"loss": 0.22503747045993805, "acc": 0.9238173365592957, "length": 8.128472328186035, "mode": "test", "epoch": 25}
{"loss": 0.1430089771747589, "acc": 0.9495225548744202, "length": 9.39836597442627, "mode": "train", "epoch": 26}
{"loss": 0.21114274859428406, "acc": 0.9239203333854675, "length": 8.53819465637207, "mode": "test", "epoch": 26}
{"loss": 0.1313510686159134, "acc": 0.9545478820800781, "length": 9.250126838684082, "mode": "train", "epoch": 27}
{"loss": 0.198689267039299, "acc": 0.9313855767250061, "length": 8.354166984558105, "mode": "test", "epoch": 27}
{"loss": 0.12182393670082092, "acc": 0.959591269493103, "length": 9.567704200744629, "mode": "train", "epoch": 28}
{"loss": 0.1965516209602356, "acc": 0.9332682490348816, "length": 8.6875, "mode": "test", "epoch": 28}
{"loss": 0.11727771162986755, "acc": 0.9642495512962341, "length": 9.678522109985352, "mode": "train", "epoch": 29}
{"loss": 0.18663948774337769, "acc": 0.9356065392494202, "length": 8.833333015441895, "mode": "test", "epoch": 29}
{"loss": 0.1099129319190979, "acc": 0.965236246585846, "length": 9.770898818969727, "mode": "train", "epoch": 30}
{"loss": 0.18110986053943634, "acc": 0.9346300959587097, "length": 8.652777671813965, "mode": "test", "epoch": 30}
{"loss": 0.10415797680616379, "acc": 0.9680345058441162, "length": 9.895349502563477, "mode": "train", "epoch": 31}
{"loss": 0.17922574281692505, "acc": 0.9392197728157043, "length": 8.92013931274414, "mode": "test", "epoch": 31}
{"loss": 0.11463482677936554, "acc": 0.9629402160644531, "length": 9.561664581298828, "mode": "train", "epoch": 32}
{"loss": 0.1753743439912796, "acc": 0.9409722089767456, "length": 8.15625, "mode": "test", "epoch": 32}
{"loss": 0.12049180269241333, "acc": 0.9572046399116516, "length": 9.349530220031738, "mode": "train", "epoch": 33}
{"loss": 0.1771990805864334, "acc": 0.9405599236488342, "length": 8.38888931274414, "mode": "test", "epoch": 33}
{"loss": 0.10703624784946442, "acc": 0.9653267860412598, "length": 9.670467376708984, "mode": "train", "epoch": 34}
{"loss": 0.16158431768417358, "acc": 0.945643424987793, "length": 8.572916984558105, "mode": "test", "epoch": 34}
{"loss": 0.09199526906013489, "acc": 0.9697880744934082, "length": 9.87447452545166, "mode": "train", "epoch": 35}
{"loss": 0.17432785034179688, "acc": 0.9423936009407043, "length": 9.97569465637207, "mode": "test", "epoch": 35}
{"loss": 0.07758776098489761, "acc": 0.9773065447807312, "length": 10.286937713623047, "mode": "train", "epoch": 36}
{"loss": 0.15302646160125732, "acc": 0.9484157562255859, "length": 9.125, "mode": "test", "epoch": 36}
{"loss": 0.07589510083198547, "acc": 0.9773377776145935, "length": 10.151832580566406, "mode": "train", "epoch": 37}
{"loss": 0.13205304741859436, "acc": 0.9590820670127869, "length": 8.94444465637207, "mode": "test", "epoch": 37}
{"loss": 0.06503050029277802, "acc": 0.9839208126068115, "length": 10.435199737548828, "mode": "train", "epoch": 38}
{"loss": 0.134781613945961, "acc": 0.9494031071662903, "length": 9.791666984558105, "mode": "test", "epoch": 38}
{"loss": 0.057771217077970505, "acc": 0.9864370822906494, "length": 10.103248596191406, "mode": "train", "epoch": 39}
{"loss": 0.12963397800922394, "acc": 0.9585287570953369, "length": 9.29513931274414, "mode": "test", "epoch": 39}
{"loss": 0.05455018952488899, "acc": 0.9881325364112854, "length": 9.698241233825684, "mode": "train", "epoch": 40}
{"loss": 0.1175130233168602, "acc": 0.9640462398529053, "length": 9.38888931274414, "mode": "test", "epoch": 40}
{"loss": 0.04895579069852829, "acc": 0.98944491147995, "length": 10.607258796691895, "mode": "train", "epoch": 41}
{"loss": 0.11449144035577774, "acc": 0.966221809387207, "length": 10.364583015441895, "mode": "test", "epoch": 41}
{"loss": 0.05019513517618179, "acc": 0.9898673295974731, "length": 10.460044860839844, "mode": "train", "epoch": 42}
{"loss": 0.11551564186811447, "acc": 0.9634007215499878, "length": 9.20138931274414, "mode": "test", "epoch": 42}
{"loss": 0.04663101211190224, "acc": 0.9902456402778625, "length": 9.969693183898926, "mode": "train", "epoch": 43}
{"loss": 0.13172203302383423, "acc": 0.9592230916023254, "length": 9.80555534362793, "mode": "test", "epoch": 43}
{"loss": 0.047740623354911804, "acc": 0.9897627830505371, "length": 9.803311347961426, "mode": "train", "epoch": 44}
{"loss": 0.11001129448413849, "acc": 0.9712240695953369, "length": 8.784722328186035, "mode": "test", "epoch": 44}
{"loss": 0.03935377672314644, "acc": 0.9933893084526062, "length": 10.071057319641113, "mode": "train", "epoch": 45}
{"loss": 0.10101546347141266, "acc": 0.9724717736244202, "length": 9.73611068725586, "mode": "test", "epoch": 45}
{"loss": 0.03179004043340683, "acc": 0.9968743920326233, "length": 9.928855895996094, "mode": "train", "epoch": 46}
{"loss": 0.08323601633310318, "acc": 0.9779188632965088, "length": 9.45486068725586, "mode": "test", "epoch": 46}
{"loss": 0.028994182124733925, "acc": 0.9978663325309753, "length": 9.888581275939941, "mode": "train", "epoch": 47}
{"loss": 0.0714457780122757, "acc": 0.9839518666267395, "length": 9.065972328186035, "mode": "test", "epoch": 47}
{"loss": 0.03125661239027977, "acc": 0.9961126446723938, "length": 9.619270324707031, "mode": "train", "epoch": 48}
{"loss": 0.1022031307220459, "acc": 0.9724554419517517, "length": 9.784722328186035, "mode": "test", "epoch": 48}
{"loss": 0.0342961810529232, "acc": 0.9941788911819458, "length": 9.700900077819824, "mode": "train", "epoch": 49}
{"loss": 0.07817873358726501, "acc": 0.9803494215011597, "length": 8.93055534362793, "mode": "test", "epoch": 49}
{"loss": 0.0312457587569952, "acc": 0.9949826598167419, "length": 9.449223518371582, "mode": "train", "epoch": 50}
{"loss": 0.076052226126194, "acc": 0.9797634482383728, "length": 8.67013931274414, "mode": "test", "epoch": 50}
{"loss": 0.025817910209298134, "acc": 0.9975703954696655, "length": 9.390166282653809, "mode": "train", "epoch": 51}
{"loss": 0.08684752136468887, "acc": 0.9788898825645447, "length": 9.121527671813965, "mode": "test", "epoch": 51}
{"loss": 0.02275153063237667, "acc": 0.9989973306655884, "length": 9.176443099975586, "mode": "train", "epoch": 52}
{"loss": 0.07984958589076996, "acc": 0.9853188991546631, "length": 8.75, "mode": "test", "epoch": 52}
{"loss": 0.022765878587961197, "acc": 0.9984681606292725, "length": 8.917261123657227, "mode": "train", "epoch": 53}
{"loss": 0.08070304989814758, "acc": 0.9825303554534912, "length": 8.63194465637207, "mode": "test", "epoch": 53}
{"loss": 0.020314794033765793, "acc": 0.9993469715118408, "length": 8.814777374267578, "mode": "train", "epoch": 54}
{"loss": 0.080204539000988, "acc": 0.9801811575889587, "length": 8.260416984558105, "mode": "test", "epoch": 54}
{"loss": 0.028271693736314774, "acc": 0.9959364533424377, "length": 9.107065200805664, "mode": "train", "epoch": 55}
{"loss": 0.11674923449754715, "acc": 0.9656900763511658, "length": 9.88888931274414, "mode": "test", "epoch": 55}
{"loss": 0.04139617830514908, "acc": 0.9910959005355835, "length": 10.014873504638672, "mode": "train", "epoch": 56}
{"loss": 0.10167187452316284, "acc": 0.9731390476226807, "length": 10.128472328186035, "mode": "test", "epoch": 56}
{"loss": 0.043294183909893036, "acc": 0.9899954199790955, "length": 9.687012672424316, "mode": "train", "epoch": 57}
{"loss": 0.1302994042634964, "acc": 0.9650228023529053, "length": 9.01388931274414, "mode": "test", "epoch": 57}
{"loss": 0.05599575489759445, "acc": 0.9865036606788635, "length": 10.271596908569336, "mode": "train", "epoch": 58}
{"loss": 0.10906584560871124, "acc": 0.9762261509895325, "length": 10.583333015441895, "mode": "test", "epoch": 58}
{"loss": 0.054452575743198395, "acc": 0.9861939549446106, "length": 9.647726058959961, "mode": "train", "epoch": 59}
{"loss": 0.10335417091846466, "acc": 0.9745008945465088, "length": 7.88194465637207, "mode": "test", "epoch": 59}
{"loss": 0.03170682489871979, "acc": 0.9941592216491699, "length": 8.569727897644043, "mode": "train", "epoch": 60}
{"loss": 0.08118630945682526, "acc": 0.9817112684249878, "length": 8.190972328186035, "mode": "test", "epoch": 60}
test accuracy: 0.755210280418396
