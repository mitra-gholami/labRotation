# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.700728178024292, "acc": 0.5126979351043701, "length": 5.130520820617676, "mode": "train", "epoch": 1}
{"loss": 0.6903613805770874, "acc": 0.548828125, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6941171884536743, "acc": 0.5129936933517456, "length": 1.1059962511062622, "mode": "train", "epoch": 2}
{"loss": 0.6930142045021057, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.646783173084259, "acc": 0.6489260792732239, "length": 3.449620008468628, "mode": "train", "epoch": 3}
{"loss": 0.6237756609916687, "acc": 0.684967041015625, "length": 3.6875, "mode": "test", "epoch": 3}
{"loss": 0.5722590088844299, "acc": 0.7213361263275146, "length": 3.3119540214538574, "mode": "train", "epoch": 4}
{"loss": 0.6458052396774292, "acc": 0.6390259265899658, "length": 1.37890625, "mode": "test", "epoch": 4}
{"loss": 0.548119068145752, "acc": 0.7348946928977966, "length": 2.780747413635254, "mode": "train", "epoch": 5}
{"loss": 0.633374810218811, "acc": 0.6729370951652527, "length": 1.91015625, "mode": "test", "epoch": 5}
{"loss": 0.5209293961524963, "acc": 0.7513840794563293, "length": 3.173755168914795, "mode": "train", "epoch": 6}
{"loss": 0.6789782047271729, "acc": 0.6810058951377869, "length": 2.9765625, "mode": "test", "epoch": 6}
{"loss": 0.4842510223388672, "acc": 0.7723994255065918, "length": 3.6829936504364014, "mode": "train", "epoch": 7}
{"loss": 0.6615869998931885, "acc": 0.7246399521827698, "length": 5.046875, "mode": "test", "epoch": 7}
{"loss": 0.44861719012260437, "acc": 0.8079464435577393, "length": 4.066797733306885, "mode": "train", "epoch": 8}
{"loss": 0.5871992707252502, "acc": 0.7530030012130737, "length": 4.08984375, "mode": "test", "epoch": 8}
{"loss": 0.4081226885318756, "acc": 0.8264469504356384, "length": 4.829922199249268, "mode": "train", "epoch": 9}
{"loss": 0.5448824167251587, "acc": 0.7972412109375, "length": 7.75, "mode": "test", "epoch": 9}
{"loss": 0.35986092686653137, "acc": 0.85090172290802, "length": 5.449152946472168, "mode": "train", "epoch": 10}
{"loss": 0.5325449705123901, "acc": 0.8054993152618408, "length": 9.203125, "mode": "test", "epoch": 10}
{"loss": 0.32775864005088806, "acc": 0.8651029467582703, "length": 5.280078411102295, "mode": "train", "epoch": 11}
{"loss": 0.49956247210502625, "acc": 0.808929443359375, "length": 10.57421875, "mode": "test", "epoch": 11}
{"loss": 0.2973632216453552, "acc": 0.8812820911407471, "length": 6.130702972412109, "mode": "train", "epoch": 12}
{"loss": 0.4337007999420166, "acc": 0.824615478515625, "length": 7.73046875, "mode": "test", "epoch": 12}
{"loss": 0.26996785402297974, "acc": 0.8896785378456116, "length": 5.906049728393555, "mode": "train", "epoch": 13}
{"loss": 0.3648141622543335, "acc": 0.8463683724403381, "length": 7.80859375, "mode": "test", "epoch": 13}
{"loss": 0.2508202791213989, "acc": 0.9021602869033813, "length": 6.977365970611572, "mode": "train", "epoch": 14}
{"loss": 0.36018383502960205, "acc": 0.8576538562774658, "length": 7.828125, "mode": "test", "epoch": 14}
{"loss": 0.23793715238571167, "acc": 0.9073454737663269, "length": 6.808938026428223, "mode": "train", "epoch": 15}
{"loss": 0.36271932721138, "acc": 0.8572999238967896, "length": 7.36328125, "mode": "test", "epoch": 15}
{"loss": 0.22184640169143677, "acc": 0.9162569046020508, "length": 7.217996120452881, "mode": "train", "epoch": 16}
{"loss": 0.3357921838760376, "acc": 0.868194580078125, "length": 8.3125, "mode": "test", "epoch": 16}
{"loss": 0.21552516520023346, "acc": 0.9175134897232056, "length": 8.109354019165039, "mode": "train", "epoch": 17}
{"loss": 0.3320049047470093, "acc": 0.875091552734375, "length": 10.16796875, "mode": "test", "epoch": 17}
{"loss": 0.2017059624195099, "acc": 0.9227199554443359, "length": 8.616799354553223, "mode": "train", "epoch": 18}
{"loss": 0.3344266414642334, "acc": 0.8707215189933777, "length": 9.85546875, "mode": "test", "epoch": 18}
{"loss": 0.18558594584465027, "acc": 0.9303699135780334, "length": 9.191091537475586, "mode": "train", "epoch": 19}
{"loss": 0.3366885483264923, "acc": 0.876617431640625, "length": 10.421875, "mode": "test", "epoch": 19}
{"loss": 0.1752530336380005, "acc": 0.9357509613037109, "length": 9.118619918823242, "mode": "train", "epoch": 20}
{"loss": 0.3267552852630615, "acc": 0.8863464593887329, "length": 10.20703125, "mode": "test", "epoch": 20}
{"loss": 0.17092058062553406, "acc": 0.9369224905967712, "length": 9.384254455566406, "mode": "train", "epoch": 21}
{"loss": 0.34543493390083313, "acc": 0.8764587640762329, "length": 8.83203125, "mode": "test", "epoch": 21}
{"loss": 0.15617230534553528, "acc": 0.944801390171051, "length": 9.592698097229004, "mode": "train", "epoch": 22}
{"loss": 0.2833157777786255, "acc": 0.9030762910842896, "length": 9.38671875, "mode": "test", "epoch": 22}
{"loss": 0.14916765689849854, "acc": 0.9491225481033325, "length": 10.314598083496094, "mode": "train", "epoch": 23}
{"loss": 0.32837846875190735, "acc": 0.8947144150733948, "length": 9.91015625, "mode": "test", "epoch": 23}
{"loss": 0.140962615609169, "acc": 0.9520615339279175, "length": 9.782318115234375, "mode": "train", "epoch": 24}
{"loss": 0.25124436616897583, "acc": 0.9145934581756592, "length": 8.9609375, "mode": "test", "epoch": 24}
{"loss": 0.13199250400066376, "acc": 0.9566592574119568, "length": 9.986443519592285, "mode": "train", "epoch": 25}
{"loss": 0.23021924495697021, "acc": 0.92169189453125, "length": 9.31640625, "mode": "test", "epoch": 25}
{"loss": 0.12725332379341125, "acc": 0.9581387639045715, "length": 9.979214668273926, "mode": "train", "epoch": 26}
{"loss": 0.2382279336452484, "acc": 0.9235413074493408, "length": 8.1953125, "mode": "test", "epoch": 26}
{"loss": 0.14689794182777405, "acc": 0.9490066170692444, "length": 9.975536346435547, "mode": "train", "epoch": 27}
{"loss": 0.20563681423664093, "acc": 0.930340588092804, "length": 9.16796875, "mode": "test", "epoch": 27}
{"loss": 0.1164020448923111, "acc": 0.962186872959137, "length": 9.564471244812012, "mode": "train", "epoch": 28}
{"loss": 0.22968880832195282, "acc": 0.9243896007537842, "length": 9.16015625, "mode": "test", "epoch": 28}
{"loss": 0.11687073856592178, "acc": 0.9610415697097778, "length": 10.115625381469727, "mode": "train", "epoch": 29}
{"loss": 0.21415849030017853, "acc": 0.9339600205421448, "length": 9.69921875, "mode": "test", "epoch": 29}
{"loss": 0.11024001985788345, "acc": 0.9658706188201904, "length": 10.163396835327148, "mode": "train", "epoch": 30}
{"loss": 0.2117222398519516, "acc": 0.931854248046875, "length": 8.99609375, "mode": "test", "epoch": 30}
{"loss": 0.10103293508291245, "acc": 0.9683571457862854, "length": 9.434932708740234, "mode": "train", "epoch": 31}
{"loss": 0.18839025497436523, "acc": 0.9435790777206421, "length": 8.44921875, "mode": "test", "epoch": 31}
{"loss": 0.09908197075128555, "acc": 0.9687133431434631, "length": 9.990243911743164, "mode": "train", "epoch": 32}
{"loss": 0.19252172112464905, "acc": 0.9380066394805908, "length": 9.05859375, "mode": "test", "epoch": 32}
{"loss": 0.09600065648555756, "acc": 0.969718337059021, "length": 9.948753356933594, "mode": "train", "epoch": 33}
{"loss": 0.19779044389724731, "acc": 0.9338014125823975, "length": 9.75, "mode": "test", "epoch": 33}
{"loss": 0.09224891662597656, "acc": 0.9700559377670288, "length": 9.759745597839355, "mode": "train", "epoch": 34}
{"loss": 0.15974143147468567, "acc": 0.948272705078125, "length": 9.0703125, "mode": "test", "epoch": 34}
{"loss": 0.07851851731538773, "acc": 0.9777687788009644, "length": 10.306760787963867, "mode": "train", "epoch": 35}
{"loss": 0.17266607284545898, "acc": 0.946441650390625, "length": 9.57421875, "mode": "test", "epoch": 35}
{"loss": 0.07580409944057465, "acc": 0.9762587547302246, "length": 10.468098640441895, "mode": "train", "epoch": 36}
{"loss": 0.17048341035842896, "acc": 0.9482788443565369, "length": 9.796875, "mode": "test", "epoch": 36}
{"loss": 0.07056694477796555, "acc": 0.981055736541748, "length": 10.447321891784668, "mode": "train", "epoch": 37}
{"loss": 0.16388770937919617, "acc": 0.9501343369483948, "length": 9.57421875, "mode": "test", "epoch": 37}
{"loss": 0.06313209980726242, "acc": 0.9831436276435852, "length": 10.402883529663086, "mode": "train", "epoch": 38}
{"loss": 0.14240968227386475, "acc": 0.9560669660568237, "length": 9.50390625, "mode": "test", "epoch": 38}
{"loss": 0.06401889771223068, "acc": 0.9833853840827942, "length": 10.006160736083984, "mode": "train", "epoch": 39}
{"loss": 0.14787574112415314, "acc": 0.9575255513191223, "length": 9.63671875, "mode": "test", "epoch": 39}
{"loss": 0.06104070320725441, "acc": 0.9835907816886902, "length": 10.295431137084961, "mode": "train", "epoch": 40}
{"loss": 0.14178720116615295, "acc": 0.958050549030304, "length": 10.328125, "mode": "test", "epoch": 40}
{"loss": 0.05341089516878128, "acc": 0.9881646633148193, "length": 10.4832763671875, "mode": "train", "epoch": 41}
{"loss": 0.1503428965806961, "acc": 0.955169677734375, "length": 9.625, "mode": "test", "epoch": 41}
{"loss": 0.05129589885473251, "acc": 0.9900834560394287, "length": 10.254531860351562, "mode": "train", "epoch": 42}
{"loss": 0.12329728901386261, "acc": 0.961438000202179, "length": 9.515625, "mode": "test", "epoch": 42}
{"loss": 0.04912370815873146, "acc": 0.9887621998786926, "length": 10.102665901184082, "mode": "train", "epoch": 43}
{"loss": 0.11883145570755005, "acc": 0.966552734375, "length": 9.06640625, "mode": "test", "epoch": 43}
{"loss": 0.0419752262532711, "acc": 0.9920526146888733, "length": 10.221236228942871, "mode": "train", "epoch": 44}
{"loss": 0.130112424492836, "acc": 0.9639099836349487, "length": 9.7734375, "mode": "test", "epoch": 44}
{"loss": 0.03865785524249077, "acc": 0.9933939576148987, "length": 10.209239959716797, "mode": "train", "epoch": 45}
{"loss": 0.1225443184375763, "acc": 0.9689269661903381, "length": 9.3828125, "mode": "test", "epoch": 45}
{"loss": 0.034703291952610016, "acc": 0.9955947399139404, "length": 9.920336723327637, "mode": "train", "epoch": 46}
{"loss": 0.1435501128435135, "acc": 0.9656555652618408, "length": 8.61328125, "mode": "test", "epoch": 46}
{"loss": 0.03530339151620865, "acc": 0.9951792359352112, "length": 9.40407943725586, "mode": "train", "epoch": 47}
{"loss": 0.12883959710597992, "acc": 0.9655334949493408, "length": 8.8046875, "mode": "test", "epoch": 47}
{"loss": 0.03245885670185089, "acc": 0.9954460859298706, "length": 9.505196571350098, "mode": "train", "epoch": 48}
{"loss": 0.10787675529718399, "acc": 0.9748656749725342, "length": 8.8671875, "mode": "test", "epoch": 48}
{"loss": 0.028469860553741455, "acc": 0.9967943429946899, "length": 9.348016738891602, "mode": "train", "epoch": 49}
{"loss": 0.10951408743858337, "acc": 0.9742370843887329, "length": 8.42578125, "mode": "test", "epoch": 49}
{"loss": 0.026479411870241165, "acc": 0.9972700476646423, "length": 9.1784086227417, "mode": "train", "epoch": 50}
{"loss": 0.11021145433187485, "acc": 0.9754700064659119, "length": 8.61328125, "mode": "test", "epoch": 50}
{"loss": 0.02449033409357071, "acc": 0.9980435371398926, "length": 9.322990417480469, "mode": "train", "epoch": 51}
{"loss": 0.1136794239282608, "acc": 0.9720214605331421, "length": 8.4765625, "mode": "test", "epoch": 51}
{"loss": 0.027015291154384613, "acc": 0.9966593384742737, "length": 9.348554611206055, "mode": "train", "epoch": 52}
{"loss": 0.1031903475522995, "acc": 0.973278820514679, "length": 8.88671875, "mode": "test", "epoch": 52}
{"loss": 0.029055988416075706, "acc": 0.995035707950592, "length": 9.136018753051758, "mode": "train", "epoch": 53}
{"loss": 0.11259448528289795, "acc": 0.9703918695449829, "length": 8.015625, "mode": "test", "epoch": 53}
{"loss": 0.041212644428014755, "acc": 0.9896333813667297, "length": 9.053544044494629, "mode": "train", "epoch": 54}
{"loss": 0.13619953393936157, "acc": 0.9623778462409973, "length": 9.65234375, "mode": "test", "epoch": 54}
{"loss": 0.04772450029850006, "acc": 0.9882124066352844, "length": 9.242106437683105, "mode": "train", "epoch": 55}
{"loss": 0.121488556265831, "acc": 0.9648863673210144, "length": 8.11328125, "mode": "test", "epoch": 55}
{"loss": 0.040291961282491684, "acc": 0.9891316890716553, "length": 8.373881340026855, "mode": "train", "epoch": 56}
{"loss": 0.12012429535388947, "acc": 0.9733580946922302, "length": 7.6875, "mode": "test", "epoch": 56}
{"loss": 0.047064781188964844, "acc": 0.9893802404403687, "length": 8.595015525817871, "mode": "train", "epoch": 57}
{"loss": 0.14535626769065857, "acc": 0.9693847894668579, "length": 8.3828125, "mode": "test", "epoch": 57}
{"loss": 0.0494336299598217, "acc": 0.9876937866210938, "length": 8.976367950439453, "mode": "train", "epoch": 58}
{"loss": 0.16055701673030853, "acc": 0.9662231802940369, "length": 7.890625, "mode": "test", "epoch": 58}
{"loss": 0.04564077407121658, "acc": 0.9880306124687195, "length": 8.216034889221191, "mode": "train", "epoch": 59}
{"loss": 0.10965344309806824, "acc": 0.971771240234375, "length": 8.16015625, "mode": "test", "epoch": 59}
{"loss": 0.03198578581213951, "acc": 0.9944108724594116, "length": 9.396946907043457, "mode": "train", "epoch": 60}
{"loss": 0.11430536210536957, "acc": 0.976409912109375, "length": 8.79296875, "mode": "test", "epoch": 60}
test accuracy: 0.8112624287605286
