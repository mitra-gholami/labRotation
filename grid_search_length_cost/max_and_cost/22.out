# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.703790009021759, "acc": 0.49636310338974, "length": 3.765132427215576, "mode": "train", "epoch": 1}
{"loss": 0.6950547695159912, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6959989666938782, "acc": 0.5114083290100098, "length": 1.073490023612976, "mode": "train", "epoch": 2}
{"loss": 0.6916292309761047, "acc": 0.5222222805023193, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6941465139389038, "acc": 0.5182344317436218, "length": 1.0456523895263672, "mode": "train", "epoch": 3}
{"loss": 0.6943317651748657, "acc": 0.5196180939674377, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6950379014015198, "acc": 0.5079941153526306, "length": 1.0403251647949219, "mode": "train", "epoch": 4}
{"loss": 0.6940674781799316, "acc": 0.5043402910232544, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6944280862808228, "acc": 0.5191226005554199, "length": 1.0505436658859253, "mode": "train", "epoch": 5}
{"loss": 0.6921929121017456, "acc": 0.5460069179534912, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6688910722732544, "acc": 0.5886133313179016, "length": 2.004525661468506, "mode": "train", "epoch": 6}
{"loss": 0.6270802021026611, "acc": 0.6663357019424438, "length": 4.34375, "mode": "test", "epoch": 6}
{"loss": 0.5903126001358032, "acc": 0.683138906955719, "length": 2.2739739418029785, "mode": "train", "epoch": 7}
{"loss": 0.600005030632019, "acc": 0.6689236164093018, "length": 2.4270832538604736, "mode": "test", "epoch": 7}
{"loss": 0.5726027488708496, "acc": 0.6857213377952576, "length": 1.7781271934509277, "mode": "train", "epoch": 8}
{"loss": 0.5914600491523743, "acc": 0.6797580718994141, "length": 1.7048611640930176, "mode": "test", "epoch": 8}
{"loss": 0.5464712977409363, "acc": 0.7193375825881958, "length": 2.1744472980499268, "mode": "train", "epoch": 9}
{"loss": 0.5671849846839905, "acc": 0.7410265207290649, "length": 6.673611164093018, "mode": "test", "epoch": 9}
{"loss": 0.49544793367385864, "acc": 0.7767283320426941, "length": 3.6147866249084473, "mode": "train", "epoch": 10}
{"loss": 0.6091359257698059, "acc": 0.7656195759773254, "length": 6.552083492279053, "mode": "test", "epoch": 10}
{"loss": 0.4711519777774811, "acc": 0.7901490330696106, "length": 3.562166452407837, "mode": "train", "epoch": 11}
{"loss": 0.5463867783546448, "acc": 0.7626572847366333, "length": 4.322916507720947, "mode": "test", "epoch": 11}
{"loss": 0.4567803144454956, "acc": 0.7914897203445435, "length": 3.735811948776245, "mode": "train", "epoch": 12}
{"loss": 0.5439102649688721, "acc": 0.7736111283302307, "length": 4.315972328186035, "mode": "test", "epoch": 12}
{"loss": 0.4196343719959259, "acc": 0.7964671850204468, "length": 4.6176605224609375, "mode": "train", "epoch": 13}
{"loss": 0.4739806354045868, "acc": 0.789013683795929, "length": 6.083333492279053, "mode": "test", "epoch": 13}
{"loss": 0.3991795480251312, "acc": 0.799850344657898, "length": 4.513594150543213, "mode": "train", "epoch": 14}
{"loss": 0.4791605770587921, "acc": 0.7785264849662781, "length": 4.527777671813965, "mode": "test", "epoch": 14}
{"loss": 0.3844391107559204, "acc": 0.7993355393409729, "length": 4.550691604614258, "mode": "train", "epoch": 15}
{"loss": 0.5198945999145508, "acc": 0.7831326723098755, "length": 4.239583492279053, "mode": "test", "epoch": 15}
{"loss": 0.38437619805336, "acc": 0.7986917495727539, "length": 4.601023197174072, "mode": "train", "epoch": 16}
{"loss": 0.4482397139072418, "acc": 0.7914224863052368, "length": 4.170138835906982, "mode": "test", "epoch": 16}
{"loss": 0.3768400549888611, "acc": 0.8012727499008179, "length": 4.906098365783691, "mode": "train", "epoch": 17}
{"loss": 0.4494011700153351, "acc": 0.7911512851715088, "length": 4.142361164093018, "mode": "test", "epoch": 17}
{"loss": 0.3740578293800354, "acc": 0.8021795749664307, "length": 4.689756393432617, "mode": "train", "epoch": 18}
{"loss": 0.4337649941444397, "acc": 0.7928059697151184, "length": 4.36805534362793, "mode": "test", "epoch": 18}
{"loss": 0.3660142123699188, "acc": 0.80778568983078, "length": 4.778003215789795, "mode": "train", "epoch": 19}
{"loss": 0.4204459488391876, "acc": 0.7972168326377869, "length": 4.322916507720947, "mode": "test", "epoch": 19}
{"loss": 0.3574589788913727, "acc": 0.8191551566123962, "length": 5.144471168518066, "mode": "train", "epoch": 20}
{"loss": 0.3925390839576721, "acc": 0.8022786378860474, "length": 4.798611164093018, "mode": "test", "epoch": 20}
{"loss": 0.3483949899673462, "acc": 0.82794189453125, "length": 5.474187850952148, "mode": "train", "epoch": 21}
{"loss": 0.3669772446155548, "acc": 0.8226834535598755, "length": 5.465277671813965, "mode": "test", "epoch": 21}
{"loss": 0.3157343566417694, "acc": 0.8545622825622559, "length": 5.63755464553833, "mode": "train", "epoch": 22}
{"loss": 0.3473847806453705, "acc": 0.8458006978034973, "length": 6.19444465637207, "mode": "test", "epoch": 22}
{"loss": 0.27843305468559265, "acc": 0.8799216747283936, "length": 6.282422065734863, "mode": "train", "epoch": 23}
{"loss": 0.3208446204662323, "acc": 0.8630588054656982, "length": 6.527777671813965, "mode": "test", "epoch": 23}
{"loss": 0.25108206272125244, "acc": 0.9053329229354858, "length": 7.249416351318359, "mode": "train", "epoch": 24}
{"loss": 0.31371235847473145, "acc": 0.8879448771476746, "length": 7.559027671813965, "mode": "test", "epoch": 24}
{"loss": 0.2357364147901535, "acc": 0.9137923717498779, "length": 6.941442012786865, "mode": "train", "epoch": 25}
{"loss": 0.29069769382476807, "acc": 0.8925944566726685, "length": 7.604166507720947, "mode": "test", "epoch": 25}
{"loss": 0.20863988995552063, "acc": 0.9240431189537048, "length": 7.300925254821777, "mode": "train", "epoch": 26}
{"loss": 0.27009013295173645, "acc": 0.9014485478401184, "length": 7.902777671813965, "mode": "test", "epoch": 26}
{"loss": 0.1949513703584671, "acc": 0.929487407207489, "length": 7.727844715118408, "mode": "train", "epoch": 27}
{"loss": 0.23757047951221466, "acc": 0.9134114384651184, "length": 9.05555534362793, "mode": "test", "epoch": 27}
{"loss": 0.19198331236839294, "acc": 0.9286003112792969, "length": 7.3854498863220215, "mode": "train", "epoch": 28}
{"loss": 0.24614527821540833, "acc": 0.9097222089767456, "length": 7.996527671813965, "mode": "test", "epoch": 28}
{"loss": 0.18389178812503815, "acc": 0.9342464804649353, "length": 8.05628776550293, "mode": "train", "epoch": 29}
{"loss": 0.24572055041790009, "acc": 0.9091742038726807, "length": 7.88194465637207, "mode": "test", "epoch": 29}
{"loss": 0.1838022768497467, "acc": 0.9339780807495117, "length": 6.89631462097168, "mode": "train", "epoch": 30}
{"loss": 0.21500997245311737, "acc": 0.9227051138877869, "length": 7.41319465637207, "mode": "test", "epoch": 30}
{"loss": 0.16347190737724304, "acc": 0.9390808939933777, "length": 7.747431755065918, "mode": "train", "epoch": 31}
{"loss": 0.2049321085214615, "acc": 0.9257161617279053, "length": 7.940972328186035, "mode": "test", "epoch": 31}
{"loss": 0.16031348705291748, "acc": 0.9442804455757141, "length": 8.212350845336914, "mode": "train", "epoch": 32}
{"loss": 0.20810139179229736, "acc": 0.9239529371261597, "length": 8.05555534362793, "mode": "test", "epoch": 32}
{"loss": 0.14566300809383392, "acc": 0.947038471698761, "length": 7.73072624206543, "mode": "train", "epoch": 33}
{"loss": 0.19182458519935608, "acc": 0.9277560710906982, "length": 8.197916984558105, "mode": "test", "epoch": 33}
{"loss": 0.14003922045230865, "acc": 0.9521013498306274, "length": 8.49339771270752, "mode": "train", "epoch": 34}
{"loss": 0.19064585864543915, "acc": 0.9295247197151184, "length": 8.527777671813965, "mode": "test", "epoch": 34}
{"loss": 0.128624826669693, "acc": 0.9569351673126221, "length": 8.688880920410156, "mode": "train", "epoch": 35}
{"loss": 0.18803711235523224, "acc": 0.9351834058761597, "length": 9.041666984558105, "mode": "test", "epoch": 35}
{"loss": 0.11958930641412735, "acc": 0.9607505202293396, "length": 8.792956352233887, "mode": "train", "epoch": 36}
{"loss": 0.1584397852420807, "acc": 0.9464952945709229, "length": 8.708333015441895, "mode": "test", "epoch": 36}
{"loss": 0.1149800568819046, "acc": 0.9608487486839294, "length": 8.854357719421387, "mode": "train", "epoch": 37}
{"loss": 0.17174136638641357, "acc": 0.9384711384773254, "length": 9.21875, "mode": "test", "epoch": 37}
{"loss": 0.1045338585972786, "acc": 0.966236412525177, "length": 9.064414978027344, "mode": "train", "epoch": 38}
{"loss": 0.1524176299571991, "acc": 0.9443522691726685, "length": 9.083333015441895, "mode": "test", "epoch": 38}
{"loss": 0.09697803854942322, "acc": 0.9680400490760803, "length": 8.916621208190918, "mode": "train", "epoch": 39}
{"loss": 0.14437027275562286, "acc": 0.9514268040657043, "length": 8.760416984558105, "mode": "test", "epoch": 39}
{"loss": 0.10297214239835739, "acc": 0.9674153923988342, "length": 9.142012596130371, "mode": "train", "epoch": 40}
{"loss": 0.13147683441638947, "acc": 0.9585503339767456, "length": 8.878472328186035, "mode": "test", "epoch": 40}
{"loss": 0.08590074628591537, "acc": 0.9749420285224915, "length": 9.358128547668457, "mode": "train", "epoch": 41}
{"loss": 0.12131021171808243, "acc": 0.9595919847488403, "length": 9.86805534362793, "mode": "test", "epoch": 41}
{"loss": 0.07894686609506607, "acc": 0.9779749512672424, "length": 9.553666114807129, "mode": "train", "epoch": 42}
{"loss": 0.12037412077188492, "acc": 0.962000846862793, "length": 9.38888931274414, "mode": "test", "epoch": 42}
{"loss": 0.06627872586250305, "acc": 0.9832628965377808, "length": 9.824959754943848, "mode": "train", "epoch": 43}
{"loss": 0.12122241407632828, "acc": 0.9610512852668762, "length": 10.020833015441895, "mode": "test", "epoch": 43}
{"loss": 0.06311900913715363, "acc": 0.9836012125015259, "length": 9.907626152038574, "mode": "train", "epoch": 44}
{"loss": 0.10405024141073227, "acc": 0.9680718183517456, "length": 10.0, "mode": "test", "epoch": 44}
{"loss": 0.05542323365807533, "acc": 0.9871466755867004, "length": 10.000243186950684, "mode": "train", "epoch": 45}
{"loss": 0.08924783766269684, "acc": 0.9749240875244141, "length": 9.73263931274414, "mode": "test", "epoch": 45}
{"loss": 0.05269436910748482, "acc": 0.9889070987701416, "length": 9.999874114990234, "mode": "train", "epoch": 46}
{"loss": 0.09268220514059067, "acc": 0.9696452021598816, "length": 10.083333015441895, "mode": "test", "epoch": 46}
{"loss": 0.051180072128772736, "acc": 0.9878941774368286, "length": 10.09803581237793, "mode": "train", "epoch": 47}
{"loss": 0.08301010727882385, "acc": 0.9743761420249939, "length": 9.885416984558105, "mode": "test", "epoch": 47}
{"loss": 0.06035527586936951, "acc": 0.9842646718025208, "length": 9.183320999145508, "mode": "train", "epoch": 48}
{"loss": 0.08295261859893799, "acc": 0.9783473610877991, "length": 9.340277671813965, "mode": "test", "epoch": 48}
{"loss": 0.046377938240766525, "acc": 0.9905346632003784, "length": 9.750680923461914, "mode": "train", "epoch": 49}
{"loss": 0.09416938573122025, "acc": 0.967041015625, "length": 9.840277671813965, "mode": "test", "epoch": 49}
{"loss": 0.04235489293932915, "acc": 0.9906071424484253, "length": 9.798376083374023, "mode": "train", "epoch": 50}
{"loss": 0.08636222779750824, "acc": 0.9753580093383789, "length": 9.621527671813965, "mode": "test", "epoch": 50}
{"loss": 0.03342107683420181, "acc": 0.9954962730407715, "length": 9.821959495544434, "mode": "train", "epoch": 51}
{"loss": 0.07494307309389114, "acc": 0.9775607585906982, "length": 9.56944465637207, "mode": "test", "epoch": 51}
{"loss": 0.03262203931808472, "acc": 0.9951313138008118, "length": 9.624856948852539, "mode": "train", "epoch": 52}
{"loss": 0.08740517497062683, "acc": 0.9722601771354675, "length": 9.770833015441895, "mode": "test", "epoch": 52}
{"loss": 0.03520781546831131, "acc": 0.9932699203491211, "length": 9.200620651245117, "mode": "train", "epoch": 53}
{"loss": 0.08763927221298218, "acc": 0.974940299987793, "length": 9.6875, "mode": "test", "epoch": 53}
{"loss": 0.03334109112620354, "acc": 0.9945388436317444, "length": 9.74036693572998, "mode": "train", "epoch": 54}
{"loss": 0.07611754536628723, "acc": 0.9791720509529114, "length": 9.03819465637207, "mode": "test", "epoch": 54}
{"loss": 0.028671832755208015, "acc": 0.9970868825912476, "length": 9.423080444335938, "mode": "train", "epoch": 55}
{"loss": 0.058687083423137665, "acc": 0.9860622882843018, "length": 9.822916984558105, "mode": "test", "epoch": 55}
{"loss": 0.025841500610113144, "acc": 0.997928261756897, "length": 9.827648162841797, "mode": "train", "epoch": 56}
{"loss": 0.06578648835420609, "acc": 0.9809353351593018, "length": 9.722222328186035, "mode": "test", "epoch": 56}
{"loss": 0.027485888451337814, "acc": 0.9957907795906067, "length": 9.317071914672852, "mode": "train", "epoch": 57}
{"loss": 0.06584280729293823, "acc": 0.9830349683761597, "length": 9.041666984558105, "mode": "test", "epoch": 57}
{"loss": 0.027394041419029236, "acc": 0.9963839054107666, "length": 8.719195365905762, "mode": "train", "epoch": 58}
{"loss": 0.07286594063043594, "acc": 0.9793240427970886, "length": 8.79513931274414, "mode": "test", "epoch": 58}
{"loss": 0.03637712448835373, "acc": 0.9916094541549683, "length": 9.756878852844238, "mode": "train", "epoch": 59}
{"loss": 0.09060265123844147, "acc": 0.9768555164337158, "length": 9.840277671813965, "mode": "test", "epoch": 59}
{"loss": 0.03165506571531296, "acc": 0.9949501752853394, "length": 9.215039253234863, "mode": "train", "epoch": 60}
{"loss": 0.07476168870925903, "acc": 0.9769747853279114, "length": 8.628472328186035, "mode": "test", "epoch": 60}
test accuracy: 0.8489397764205933
