# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7050330638885498, "acc": 0.5428749918937683, "length": 2.823618173599243, "mode": "train", "epoch": 1}
{"loss": 0.6917010545730591, "acc": 0.560742199420929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6955380439758301, "acc": 0.5429104566574097, "length": 1.0604907274246216, "mode": "train", "epoch": 2}
{"loss": 0.6957426071166992, "acc": 0.5242187976837158, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6936895847320557, "acc": 0.5400010347366333, "length": 1.021233081817627, "mode": "train", "epoch": 3}
{"loss": 0.6925610303878784, "acc": 0.545703113079071, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6951424479484558, "acc": 0.5358809232711792, "length": 1.0141119956970215, "mode": "train", "epoch": 4}
{"loss": 0.6929716467857361, "acc": 0.545703113079071, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.692980945110321, "acc": 0.5466815829277039, "length": 1.0098700523376465, "mode": "train", "epoch": 5}
{"loss": 0.6930990219116211, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6943321824073792, "acc": 0.5376883149147034, "length": 1.0072654485702515, "mode": "train", "epoch": 6}
{"loss": 0.6948232054710388, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6939827799797058, "acc": 0.5457929968833923, "length": 1.0057331323623657, "mode": "train", "epoch": 7}
{"loss": 0.6917487382888794, "acc": 0.5441405773162842, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6934894919395447, "acc": 0.5484652519226074, "length": 1.004560112953186, "mode": "train", "epoch": 8}
{"loss": 0.6921016573905945, "acc": 0.551953136920929, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6932277083396912, "acc": 0.548323929309845, "length": 1.0040779113769531, "mode": "train", "epoch": 9}
{"loss": 0.6911685466766357, "acc": 0.5433593392372131, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6919943690299988, "acc": 0.5494689345359802, "length": 1.003037452697754, "mode": "train", "epoch": 10}
{"loss": 0.693605363368988, "acc": 0.534960925579071, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6929634809494019, "acc": 0.5463942289352417, "length": 1.0025794506072998, "mode": "train", "epoch": 11}
{"loss": 0.6919101476669312, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6925668120384216, "acc": 0.5293472409248352, "length": 1.0021895170211792, "mode": "train", "epoch": 12}
{"loss": 0.6914135813713074, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6931289434432983, "acc": 0.5477566123008728, "length": 1.0019208192825317, "mode": "train", "epoch": 13}
{"loss": 0.6912120580673218, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6918681859970093, "acc": 0.5462790131568909, "length": 1.001664638519287, "mode": "train", "epoch": 14}
{"loss": 0.6905313730239868, "acc": 0.54296875, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6908615827560425, "acc": 0.548050045967102, "length": 1.0014020204544067, "mode": "train", "epoch": 15}
{"loss": 0.6902182698249817, "acc": 0.5425781607627869, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6910316348075867, "acc": 0.5476961135864258, "length": 1.0014622211456299, "mode": "train", "epoch": 16}
{"loss": 0.6912096738815308, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6905180811882019, "acc": 0.5466938018798828, "length": 1.0011216402053833, "mode": "train", "epoch": 17}
{"loss": 0.690493106842041, "acc": 0.53515625, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6906754374504089, "acc": 0.5401327610015869, "length": 1.001067042350769, "mode": "train", "epoch": 18}
{"loss": 0.6894627809524536, "acc": 0.553515613079071, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6889657378196716, "acc": 0.544977068901062, "length": 1.0009888410568237, "mode": "train", "epoch": 19}
{"loss": 0.6913228034973145, "acc": 0.53515625, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6897472739219666, "acc": 0.5460411310195923, "length": 1.0007824897766113, "mode": "train", "epoch": 20}
{"loss": 0.6897851228713989, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6884859800338745, "acc": 0.5485825538635254, "length": 1.000687599182129, "mode": "train", "epoch": 21}
{"loss": 0.6890181303024292, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6880047917366028, "acc": 0.539609968662262, "length": 1.0005946159362793, "mode": "train", "epoch": 22}
{"loss": 0.6902083158493042, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6872028708457947, "acc": 0.5504097938537598, "length": 1.0005627870559692, "mode": "train", "epoch": 23}
{"loss": 0.6876769661903381, "acc": 0.544140636920929, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6879975199699402, "acc": 0.5453357100486755, "length": 1.0005074739456177, "mode": "train", "epoch": 24}
{"loss": 0.6883916854858398, "acc": 0.5359375476837158, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6882017850875854, "acc": 0.5460445284843445, "length": 1.0004205703735352, "mode": "train", "epoch": 25}
{"loss": 0.6874927282333374, "acc": 0.53515625, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.686896026134491, "acc": 0.548112154006958, "length": 1.0003740787506104, "mode": "train", "epoch": 26}
{"loss": 0.6875779628753662, "acc": 0.53515625, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6857096552848816, "acc": 0.5466954708099365, "length": 1.0003478527069092, "mode": "train", "epoch": 27}
{"loss": 0.6870766878128052, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6861380338668823, "acc": 0.541795551776886, "length": 1.0003323554992676, "mode": "train", "epoch": 28}
{"loss": 0.6879830956459045, "acc": 0.5359375476837158, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6856616735458374, "acc": 0.5470497012138367, "length": 1.0002758502960205, "mode": "train", "epoch": 29}
{"loss": 0.6869622468948364, "acc": 0.5523437857627869, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6847618818283081, "acc": 0.5502951741218567, "length": 1.0002367496490479, "mode": "train", "epoch": 30}
{"loss": 0.687968909740448, "acc": 0.5263672471046448, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.685407280921936, "acc": 0.5466936230659485, "length": 1.0002354383468628, "mode": "train", "epoch": 31}
{"loss": 0.6867132186889648, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6844024658203125, "acc": 0.5531877875328064, "length": 1.0002050399780273, "mode": "train", "epoch": 32}
{"loss": 0.6865574717521667, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6845013499259949, "acc": 0.5534225106239319, "length": 1.0001705884933472, "mode": "train", "epoch": 33}
{"loss": 0.6869953274726868, "acc": 0.5406250357627869, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6850256323814392, "acc": 0.5503539443016052, "length": 1.0001693964004517, "mode": "train", "epoch": 34}
{"loss": 0.6866594552993774, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6835518479347229, "acc": 0.5411455631256104, "length": 1.000138759613037, "mode": "train", "epoch": 35}
{"loss": 0.6861409544944763, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6843116879463196, "acc": 0.5551350712776184, "length": 1.0001332759857178, "mode": "train", "epoch": 36}
{"loss": 0.6839749813079834, "acc": 0.5669922232627869, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6834217309951782, "acc": 0.5445695519447327, "length": 1.0001194477081299, "mode": "train", "epoch": 37}
{"loss": 0.685349702835083, "acc": 0.5263672471046448, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6837009191513062, "acc": 0.5461635589599609, "length": 1.0001115798950195, "mode": "train", "epoch": 38}
{"loss": 0.6867316961288452, "acc": 0.548828125, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6828640103340149, "acc": 0.5541321039199829, "length": 1.000099778175354, "mode": "train", "epoch": 39}
{"loss": 0.6855399012565613, "acc": 0.5580077767372131, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6819218397140503, "acc": 0.5479341745376587, "length": 1.0000909566879272, "mode": "train", "epoch": 40}
{"loss": 0.6832485795021057, "acc": 0.5541015267372131, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6833428740501404, "acc": 0.5485247373580933, "length": 1.0000855922698975, "mode": "train", "epoch": 41}
{"loss": 0.6850744485855103, "acc": 0.5275390148162842, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6826642155647278, "acc": 0.5484068393707275, "length": 1.000070571899414, "mode": "train", "epoch": 42}
{"loss": 0.6858052611351013, "acc": 0.5263672471046448, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6824069023132324, "acc": 0.5460451245307922, "length": 1.000078558921814, "mode": "train", "epoch": 43}
{"loss": 0.684386670589447, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6825461387634277, "acc": 0.5533645153045654, "length": 1.0000580549240112, "mode": "train", "epoch": 44}
{"loss": 0.6837331652641296, "acc": 0.5517578125, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6826426982879639, "acc": 0.5551358461380005, "length": 1.0000526905059814, "mode": "train", "epoch": 45}
{"loss": 0.6839439868927002, "acc": 0.552929699420929, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6821119785308838, "acc": 0.5507087707519531, "length": 1.000041127204895, "mode": "train", "epoch": 46}
{"loss": 0.6826661825180054, "acc": 0.5658202767372131, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.682563066482544, "acc": 0.5576742887496948, "length": 1.0000356435775757, "mode": "train", "epoch": 47}
{"loss": 0.6838603615760803, "acc": 0.5535156726837158, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6820603013038635, "acc": 0.5463400483131409, "length": 1.0000323057174683, "mode": "train", "epoch": 48}
{"loss": 0.6840031743049622, "acc": 0.5494140982627869, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6812110543251038, "acc": 0.55743807554245, "length": 1.0000293254852295, "mode": "train", "epoch": 49}
{"loss": 0.6833868622779846, "acc": 0.5541015267372131, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6816067099571228, "acc": 0.5524793267250061, "length": 1.00002920627594, "mode": "train", "epoch": 50}
{"loss": 0.6841627955436707, "acc": 0.5296874642372131, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6809525489807129, "acc": 0.5581462383270264, "length": 1.000027060508728, "mode": "train", "epoch": 51}
{"loss": 0.6829439997673035, "acc": 0.5494140982627869, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6820526123046875, "acc": 0.550236165523529, "length": 1.0000206232070923, "mode": "train", "epoch": 52}
{"loss": 0.6831884980201721, "acc": 0.5402343273162842, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6811116337776184, "acc": 0.5621014833450317, "length": 1.0000256299972534, "mode": "train", "epoch": 53}
{"loss": 0.681481659412384, "acc": 0.5458984375, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6800089478492737, "acc": 0.561806321144104, "length": 1.000017762184143, "mode": "train", "epoch": 54}
{"loss": 0.6850382089614868, "acc": 0.5591797232627869, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6802211999893188, "acc": 0.5565527677536011, "length": 1.0000303983688354, "mode": "train", "epoch": 55}
{"loss": 0.6828668713569641, "acc": 0.5386719107627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6798739433288574, "acc": 0.5556081533432007, "length": 1.0000152587890625, "mode": "train", "epoch": 56}
{"loss": 0.6820398569107056, "acc": 0.5365234017372131, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6802085041999817, "acc": 0.5611570477485657, "length": 1.0000131130218506, "mode": "train", "epoch": 57}
{"loss": 0.6825041174888611, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6810190677642822, "acc": 0.5586186647415161, "length": 1.0000109672546387, "mode": "train", "epoch": 58}
{"loss": 0.6826547384262085, "acc": 0.5365234017372131, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6788238286972046, "acc": 0.5599763989448547, "length": 1.0000128746032715, "mode": "train", "epoch": 59}
{"loss": 0.6819037795066833, "acc": 0.5578124523162842, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6801955103874207, "acc": 0.5550767183303833, "length": 1.0000088214874268, "mode": "train", "epoch": 60}
{"loss": 0.6804054975509644, "acc": 0.5492187142372131, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.2983871102333069
