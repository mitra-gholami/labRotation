# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.700229287147522, "acc": 0.5052909851074219, "length": 2.7352335453033447, "mode": "train", "epoch": 1}
{"loss": 0.6947807669639587, "acc": 0.5128471851348877, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6767923831939697, "acc": 0.5886877775192261, "length": 2.104506492614746, "mode": "train", "epoch": 2}
{"loss": 0.6192690134048462, "acc": 0.7227104902267456, "length": 2.6145832538604736, "mode": "test", "epoch": 2}
{"loss": 0.5463164448738098, "acc": 0.7513110637664795, "length": 3.0283987522125244, "mode": "train", "epoch": 3}
{"loss": 0.552008867263794, "acc": 0.7511067390441895, "length": 3.3333332538604736, "mode": "test", "epoch": 3}
{"loss": 0.46921733021736145, "acc": 0.8001439571380615, "length": 3.3132500648498535, "mode": "train", "epoch": 4}
{"loss": 0.49295416474342346, "acc": 0.7974609136581421, "length": 3.34375, "mode": "test", "epoch": 4}
{"loss": 0.40072476863861084, "acc": 0.8382506966590881, "length": 3.4149248600006104, "mode": "train", "epoch": 5}
{"loss": 0.494069904088974, "acc": 0.8081977367401123, "length": 3.6875, "mode": "test", "epoch": 5}
{"loss": 0.36551353335380554, "acc": 0.8498150706291199, "length": 3.5771045684814453, "mode": "train", "epoch": 6}
{"loss": 0.4696880877017975, "acc": 0.8054307699203491, "length": 3.805555582046509, "mode": "test", "epoch": 6}
{"loss": 0.3413149118423462, "acc": 0.8644512891769409, "length": 3.6617114543914795, "mode": "train", "epoch": 7}
{"loss": 0.4727957546710968, "acc": 0.8001194000244141, "length": 3.805555582046509, "mode": "test", "epoch": 7}
{"loss": 0.32247084379196167, "acc": 0.8719455003738403, "length": 3.72823429107666, "mode": "train", "epoch": 8}
{"loss": 0.4647233784198761, "acc": 0.8117296695709229, "length": 3.9166667461395264, "mode": "test", "epoch": 8}
{"loss": 0.2971121370792389, "acc": 0.8758564591407776, "length": 3.7898566722869873, "mode": "train", "epoch": 9}
{"loss": 0.44505754113197327, "acc": 0.831168532371521, "length": 3.9479167461395264, "mode": "test", "epoch": 9}
{"loss": 0.28432729840278625, "acc": 0.8875029683113098, "length": 3.84216046333313, "mode": "train", "epoch": 10}
{"loss": 0.42504361271858215, "acc": 0.8431532382965088, "length": 3.9895832538604736, "mode": "test", "epoch": 10}
{"loss": 0.26627418398857117, "acc": 0.8924086689949036, "length": 3.8969292640686035, "mode": "train", "epoch": 11}
{"loss": 0.3824174404144287, "acc": 0.8668403029441833, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.238373801112175, "acc": 0.9014644026756287, "length": 3.9369149208068848, "mode": "train", "epoch": 12}
{"loss": 0.35115304589271545, "acc": 0.8798611760139465, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2244134396314621, "acc": 0.913399875164032, "length": 3.957683801651001, "mode": "train", "epoch": 13}
{"loss": 0.3418239653110504, "acc": 0.8885416984558105, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.21124932169914246, "acc": 0.9180403351783752, "length": 3.9709584712982178, "mode": "train", "epoch": 14}
{"loss": 0.3319830000400543, "acc": 0.8928820490837097, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2040351778268814, "acc": 0.9231362342834473, "length": 3.9771409034729004, "mode": "train", "epoch": 15}
{"loss": 0.3256433308124542, "acc": 0.8914930820465088, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.19221578538417816, "acc": 0.9265548586845398, "length": 3.980736017227173, "mode": "train", "epoch": 16}
{"loss": 0.3373972773551941, "acc": 0.8894097805023193, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.19334009289741516, "acc": 0.9257043600082397, "length": 3.9833879470825195, "mode": "train", "epoch": 17}
{"loss": 0.33348074555397034, "acc": 0.8864584565162659, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.18725064396858215, "acc": 0.9283115267753601, "length": 3.985452651977539, "mode": "train", "epoch": 18}
{"loss": 0.3116565942764282, "acc": 0.8946181535720825, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.17121675610542297, "acc": 0.9383034110069275, "length": 3.9884955883026123, "mode": "train", "epoch": 19}
{"loss": 0.2923331558704376, "acc": 0.9038195013999939, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.14985260367393494, "acc": 0.9420871734619141, "length": 3.9899682998657227, "mode": "train", "epoch": 20}
{"loss": 0.2809228301048279, "acc": 0.9064236879348755, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.15443378686904907, "acc": 0.9425395131111145, "length": 3.9923155307769775, "mode": "train", "epoch": 21}
{"loss": 0.27643710374832153, "acc": 0.9137152433395386, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.14071643352508545, "acc": 0.9488325119018555, "length": 3.9919819831848145, "mode": "train", "epoch": 22}
{"loss": 0.2812906801700592, "acc": 0.9071179628372192, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.13646702468395233, "acc": 0.9491794109344482, "length": 3.993985176086426, "mode": "train", "epoch": 23}
{"loss": 0.28917235136032104, "acc": 0.9006944298744202, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1219014972448349, "acc": 0.9577691555023193, "length": 3.9937374591827393, "mode": "train", "epoch": 24}
{"loss": 0.2525647282600403, "acc": 0.9206597805023193, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.12043524533510208, "acc": 0.9580143094062805, "length": 3.9951119422912598, "mode": "train", "epoch": 25}
{"loss": 0.2612203061580658, "acc": 0.9229167103767395, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.11341536045074463, "acc": 0.9597562551498413, "length": 3.994189977645874, "mode": "train", "epoch": 26}
{"loss": 0.22841617465019226, "acc": 0.9298611879348755, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.12252320349216461, "acc": 0.9525531530380249, "length": 3.9950013160705566, "mode": "train", "epoch": 27}
{"loss": 0.2379891574382782, "acc": 0.9289931058883667, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.10315535962581635, "acc": 0.9627111554145813, "length": 3.995910406112671, "mode": "train", "epoch": 28}
{"loss": 0.22389112412929535, "acc": 0.9376736879348755, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.09120219200849533, "acc": 0.9703224301338196, "length": 3.9969944953918457, "mode": "train", "epoch": 29}
{"loss": 0.19772495329380035, "acc": 0.9387152791023254, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.08766255527734756, "acc": 0.9721779227256775, "length": 3.99670672416687, "mode": "train", "epoch": 30}
{"loss": 0.20953987538814545, "acc": 0.9366319179534912, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.0841553583741188, "acc": 0.9715348482131958, "length": 3.997688055038452, "mode": "train", "epoch": 31}
{"loss": 0.20835627615451813, "acc": 0.9402778148651123, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.09019976109266281, "acc": 0.9700509309768677, "length": 3.997605562210083, "mode": "train", "epoch": 32}
{"loss": 0.20139916241168976, "acc": 0.9465277791023254, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.07624725997447968, "acc": 0.975260853767395, "length": 3.9983608722686768, "mode": "train", "epoch": 33}
{"loss": 0.19437295198440552, "acc": 0.9437500834465027, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.07526860386133194, "acc": 0.9746602773666382, "length": 3.9975697994232178, "mode": "train", "epoch": 34}
{"loss": 0.23406264185905457, "acc": 0.9362847805023193, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.07932101935148239, "acc": 0.974693238735199, "length": 3.998410940170288, "mode": "train", "epoch": 35}
{"loss": 0.18874266743659973, "acc": 0.9472222924232483, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.0752110630273819, "acc": 0.9745088219642639, "length": 3.9981181621551514, "mode": "train", "epoch": 36}
{"loss": 0.19294629991054535, "acc": 0.9399304986000061, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.07053931057453156, "acc": 0.9778233170509338, "length": 3.9984934329986572, "mode": "train", "epoch": 37}
{"loss": 0.19226737320423126, "acc": 0.9387152791023254, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.06705370545387268, "acc": 0.978061854839325, "length": 3.9986610412597656, "mode": "train", "epoch": 38}
{"loss": 0.17900343239307404, "acc": 0.9475694298744202, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.069547638297081, "acc": 0.976975679397583, "length": 3.9985170364379883, "mode": "train", "epoch": 39}
{"loss": 0.19378294050693512, "acc": 0.9381943941116333, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.06472709774971008, "acc": 0.9800643920898438, "length": 3.9988982677459717, "mode": "train", "epoch": 40}
{"loss": 0.18347667157649994, "acc": 0.941319465637207, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.05886463820934296, "acc": 0.9818371534347534, "length": 3.999086856842041, "mode": "train", "epoch": 41}
{"loss": 0.18593496084213257, "acc": 0.9401041865348816, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.05374396964907646, "acc": 0.982789158821106, "length": 3.9985556602478027, "mode": "train", "epoch": 42}
{"loss": 0.16672317683696747, "acc": 0.9550347924232483, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.052463728934526443, "acc": 0.9849200248718262, "length": 3.9992189407348633, "mode": "train", "epoch": 43}
{"loss": 0.16640785336494446, "acc": 0.9557291865348816, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.057055436074733734, "acc": 0.9816229343414307, "length": 3.999420642852783, "mode": "train", "epoch": 44}
{"loss": 0.1623907834291458, "acc": 0.9472222924232483, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04606519639492035, "acc": 0.9860001802444458, "length": 3.9990897178649902, "mode": "train", "epoch": 45}
{"loss": 0.17597968876361847, "acc": 0.9482638835906982, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.04946998879313469, "acc": 0.9854914546012878, "length": 3.9992411136627197, "mode": "train", "epoch": 46}
{"loss": 0.17199045419692993, "acc": 0.9522569179534912, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.04087129980325699, "acc": 0.9888497591018677, "length": 3.9991931915283203, "mode": "train", "epoch": 47}
{"loss": 0.1706211119890213, "acc": 0.9552083611488342, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.038884326815605164, "acc": 0.9882866144180298, "length": 3.999234914779663, "mode": "train", "epoch": 48}
{"loss": 0.14684580266475677, "acc": 0.9567708969116211, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.03537740558385849, "acc": 0.9922642111778259, "length": 3.9984560012817383, "mode": "train", "epoch": 49}
{"loss": 0.144320547580719, "acc": 0.9635416865348816, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.042511556297540665, "acc": 0.9886303544044495, "length": 3.999284267425537, "mode": "train", "epoch": 50}
{"loss": 0.17569126188755035, "acc": 0.9545138478279114, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04539961367845535, "acc": 0.9851050972938538, "length": 3.9994704723358154, "mode": "train", "epoch": 51}
{"loss": 0.16733142733573914, "acc": 0.9583333134651184, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.04239736124873161, "acc": 0.9882372617721558, "length": 3.999511480331421, "mode": "train", "epoch": 52}
{"loss": 0.19152213633060455, "acc": 0.9480903148651123, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03872456029057503, "acc": 0.9885786771774292, "length": 3.999509572982788, "mode": "train", "epoch": 53}
{"loss": 0.16487358510494232, "acc": 0.9621527791023254, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.04561183601617813, "acc": 0.9842974543571472, "length": 3.9993252754211426, "mode": "train", "epoch": 54}
{"loss": 0.173969104886055, "acc": 0.9604166746139526, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.04314405471086502, "acc": 0.9871054887771606, "length": 3.999711036682129, "mode": "train", "epoch": 55}
{"loss": 0.1677318662405014, "acc": 0.9536458253860474, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.05246118828654289, "acc": 0.9839673042297363, "length": 3.999596357345581, "mode": "train", "epoch": 56}
{"loss": 0.1646522879600525, "acc": 0.9612847566604614, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.05926303192973137, "acc": 0.9832286834716797, "length": 3.9996774196624756, "mode": "train", "epoch": 57}
{"loss": 0.16439655423164368, "acc": 0.9597222208976746, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.07142545282840729, "acc": 0.9804370999336243, "length": 3.99969744682312, "mode": "train", "epoch": 58}
{"loss": 0.15670904517173767, "acc": 0.9510416388511658, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.0881517082452774, "acc": 0.9721536040306091, "length": 3.999443769454956, "mode": "train", "epoch": 59}
{"loss": 0.23033744096755981, "acc": 0.9444444179534912, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.07250630855560303, "acc": 0.9750802516937256, "length": 3.9998018741607666, "mode": "train", "epoch": 60}
{"loss": 0.1683199107646942, "acc": 0.9557291865348816, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7957407236099243
