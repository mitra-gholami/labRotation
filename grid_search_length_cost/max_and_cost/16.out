# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7089625597000122, "acc": 0.5180019736289978, "length": 2.3889060020446777, "mode": "train", "epoch": 1}
{"loss": 0.7009793519973755, "acc": 0.4982638955116272, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6983711123466492, "acc": 0.5364269018173218, "length": 1.0626884698867798, "mode": "train", "epoch": 2}
{"loss": 0.7001075148582458, "acc": 0.5067708492279053, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6973950266838074, "acc": 0.5284618735313416, "length": 1.0295231342315674, "mode": "train", "epoch": 3}
{"loss": 0.699443519115448, "acc": 0.5123264193534851, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6968415975570679, "acc": 0.5301545262336731, "length": 1.0176606178283691, "mode": "train", "epoch": 4}
{"loss": 0.6995042562484741, "acc": 0.5152778029441833, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6956700682640076, "acc": 0.5276001691818237, "length": 1.0126482248306274, "mode": "train", "epoch": 5}
{"loss": 0.6987007856369019, "acc": 0.5067708492279053, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6958434581756592, "acc": 0.5252661108970642, "length": 1.009750485420227, "mode": "train", "epoch": 6}
{"loss": 0.7019996047019958, "acc": 0.5123264193534851, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.697159469127655, "acc": 0.52628493309021, "length": 1.007513165473938, "mode": "train", "epoch": 7}
{"loss": 0.6987503170967102, "acc": 0.4998263716697693, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6951852440834045, "acc": 0.5297483205795288, "length": 1.0058454275131226, "mode": "train", "epoch": 8}
{"loss": 0.6990305781364441, "acc": 0.5123264193534851, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6956539750099182, "acc": 0.5187990665435791, "length": 1.0048630237579346, "mode": "train", "epoch": 9}
{"loss": 0.70060133934021, "acc": 0.515625, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6961859464645386, "acc": 0.5319324135780334, "length": 1.004011631011963, "mode": "train", "epoch": 10}
{"loss": 0.6977079510688782, "acc": 0.5038194060325623, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.696394681930542, "acc": 0.5131816267967224, "length": 1.0035223960876465, "mode": "train", "epoch": 11}
{"loss": 0.6993831396102905, "acc": 0.5126736164093018, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6947389841079712, "acc": 0.5280697345733643, "length": 1.0031406879425049, "mode": "train", "epoch": 12}
{"loss": 0.6982458233833313, "acc": 0.5019097328186035, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6952453851699829, "acc": 0.5292927026748657, "length": 1.0027738809585571, "mode": "train", "epoch": 13}
{"loss": 0.6999432444572449, "acc": 0.5152778029441833, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6944721937179565, "acc": 0.5398885607719421, "length": 1.0024487972259521, "mode": "train", "epoch": 14}
{"loss": 0.6983310580253601, "acc": 0.5015624761581421, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6942912340164185, "acc": 0.5334232449531555, "length": 1.0024220943450928, "mode": "train", "epoch": 15}
{"loss": 0.6982912421226501, "acc": 0.4980902671813965, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6943275928497314, "acc": 0.5328547954559326, "length": 1.0023958683013916, "mode": "train", "epoch": 16}
{"loss": 0.6974549889564514, "acc": 0.5039930939674377, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6944661736488342, "acc": 0.5367060303688049, "length": 1.0021165609359741, "mode": "train", "epoch": 17}
{"loss": 0.7005751132965088, "acc": 0.5024305582046509, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6930105090141296, "acc": 0.5411964058876038, "length": 1.0024183988571167, "mode": "train", "epoch": 18}
{"loss": 0.6981182098388672, "acc": 0.4980902671813965, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6934806108474731, "acc": 0.547234058380127, "length": 1.0024995803833008, "mode": "train", "epoch": 19}
{"loss": 0.6981892585754395, "acc": 0.49895837903022766, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6932185292243958, "acc": 0.5432981252670288, "length": 1.004621982574463, "mode": "train", "epoch": 20}
{"loss": 0.700587809085846, "acc": 0.4965277910232544, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6680396199226379, "acc": 0.5846849679946899, "length": 1.4678736925125122, "mode": "train", "epoch": 21}
{"loss": 0.6202029585838318, "acc": 0.6932889223098755, "length": 2.4201388359069824, "mode": "test", "epoch": 21}
{"loss": 0.5917068719863892, "acc": 0.7024835348129272, "length": 1.8703747987747192, "mode": "train", "epoch": 22}
{"loss": 0.6044848561286926, "acc": 0.6936957836151123, "length": 2.25, "mode": "test", "epoch": 22}
{"loss": 0.5748719573020935, "acc": 0.7079113721847534, "length": 1.9296942949295044, "mode": "train", "epoch": 23}
{"loss": 0.6039450168609619, "acc": 0.680018424987793, "length": 2.1701388359069824, "mode": "test", "epoch": 23}
{"loss": 0.5556308627128601, "acc": 0.7229121923446655, "length": 2.1072018146514893, "mode": "train", "epoch": 24}
{"loss": 0.6028784513473511, "acc": 0.6982042789459229, "length": 2.225694417953491, "mode": "test", "epoch": 24}
{"loss": 0.539719820022583, "acc": 0.7452789545059204, "length": 2.5353777408599854, "mode": "train", "epoch": 25}
{"loss": 0.5607399940490723, "acc": 0.7433106303215027, "length": 2.5625, "mode": "test", "epoch": 25}
{"loss": 0.5070958137512207, "acc": 0.773922324180603, "length": 2.7290120124816895, "mode": "train", "epoch": 26}
{"loss": 0.5118939280509949, "acc": 0.7729818820953369, "length": 3.163194417953491, "mode": "test", "epoch": 26}
{"loss": 0.4851325452327728, "acc": 0.7975113391876221, "length": 2.955665349960327, "mode": "train", "epoch": 27}
{"loss": 0.4389221668243408, "acc": 0.8259874582290649, "length": 3.152777671813965, "mode": "test", "epoch": 27}
{"loss": 0.4354875683784485, "acc": 0.8133904337882996, "length": 2.9580976963043213, "mode": "train", "epoch": 28}
{"loss": 0.3991824984550476, "acc": 0.8326226472854614, "length": 3.128472328186035, "mode": "test", "epoch": 28}
{"loss": 0.39827173948287964, "acc": 0.8310208320617676, "length": 3.248399496078491, "mode": "train", "epoch": 29}
{"loss": 0.3696204721927643, "acc": 0.8487088084220886, "length": 3.586805582046509, "mode": "test", "epoch": 29}
{"loss": 0.37122687697410583, "acc": 0.84263014793396, "length": 3.448810338973999, "mode": "train", "epoch": 30}
{"loss": 0.3518345057964325, "acc": 0.8587728142738342, "length": 3.5208332538604736, "mode": "test", "epoch": 30}
{"loss": 0.3539305329322815, "acc": 0.8497157096862793, "length": 3.4116666316986084, "mode": "train", "epoch": 31}
{"loss": 0.33447638154029846, "acc": 0.8647515773773193, "length": 3.493055582046509, "mode": "test", "epoch": 31}
{"loss": 0.34404799342155457, "acc": 0.8577978610992432, "length": 3.4513354301452637, "mode": "train", "epoch": 32}
{"loss": 0.3393842577934265, "acc": 0.8586317896842957, "length": 3.444444417953491, "mode": "test", "epoch": 32}
{"loss": 0.3339747488498688, "acc": 0.8644114136695862, "length": 3.460204839706421, "mode": "train", "epoch": 33}
{"loss": 0.3225170969963074, "acc": 0.8674532771110535, "length": 3.53125, "mode": "test", "epoch": 33}
{"loss": 0.3074619472026825, "acc": 0.8789156675338745, "length": 3.498669385910034, "mode": "train", "epoch": 34}
{"loss": 0.299456387758255, "acc": 0.8883138298988342, "length": 3.538194417953491, "mode": "test", "epoch": 34}
{"loss": 0.30458319187164307, "acc": 0.8789295554161072, "length": 3.518038511276245, "mode": "train", "epoch": 35}
{"loss": 0.2784835398197174, "acc": 0.8968695402145386, "length": 3.5416667461395264, "mode": "test", "epoch": 35}
{"loss": 0.28956833481788635, "acc": 0.885829746723175, "length": 3.643449306488037, "mode": "train", "epoch": 36}
{"loss": 0.26445555686950684, "acc": 0.9006510972976685, "length": 3.6388888359069824, "mode": "test", "epoch": 36}
{"loss": 0.27578598260879517, "acc": 0.8928666710853577, "length": 3.728557825088501, "mode": "train", "epoch": 37}
{"loss": 0.26244500279426575, "acc": 0.9110025763511658, "length": 3.815972328186035, "mode": "test", "epoch": 37}
{"loss": 0.2680131793022156, "acc": 0.8974802494049072, "length": 3.7862653732299805, "mode": "train", "epoch": 38}
{"loss": 0.2482031136751175, "acc": 0.9034234285354614, "length": 3.784722328186035, "mode": "test", "epoch": 38}
{"loss": 0.2562211751937866, "acc": 0.90501469373703, "length": 3.800065517425537, "mode": "train", "epoch": 39}
{"loss": 0.24339061975479126, "acc": 0.9155381321907043, "length": 3.8333332538604736, "mode": "test", "epoch": 39}
{"loss": 0.2584989070892334, "acc": 0.9046728610992432, "length": 3.8195152282714844, "mode": "train", "epoch": 40}
{"loss": 0.25332537293434143, "acc": 0.9126085638999939, "length": 3.8298611640930176, "mode": "test", "epoch": 40}
{"loss": 0.24058951437473297, "acc": 0.9113525748252869, "length": 3.825281858444214, "mode": "train", "epoch": 41}
{"loss": 0.21697834134101868, "acc": 0.9259113669395447, "length": 3.8576388359069824, "mode": "test", "epoch": 41}
{"loss": 0.2364341914653778, "acc": 0.9123483896255493, "length": 3.8933095932006836, "mode": "train", "epoch": 42}
{"loss": 0.206942617893219, "acc": 0.9364420771598816, "length": 3.878472328186035, "mode": "test", "epoch": 42}
{"loss": 0.2334287464618683, "acc": 0.915801465511322, "length": 3.8713202476501465, "mode": "train", "epoch": 43}
{"loss": 0.21654945611953735, "acc": 0.9223145246505737, "length": 3.868055582046509, "mode": "test", "epoch": 43}
{"loss": 0.23386764526367188, "acc": 0.9118275046348572, "length": 3.8756275177001953, "mode": "train", "epoch": 44}
{"loss": 0.21723291277885437, "acc": 0.9261719584465027, "length": 3.9201388359069824, "mode": "test", "epoch": 44}
{"loss": 0.21833080053329468, "acc": 0.9146212935447693, "length": 3.924856662750244, "mode": "train", "epoch": 45}
{"loss": 0.20793819427490234, "acc": 0.9380046129226685, "length": 3.9791667461395264, "mode": "test", "epoch": 45}
{"loss": 0.21143381297588348, "acc": 0.9257112145423889, "length": 3.930567741394043, "mode": "train", "epoch": 46}
{"loss": 0.20977848768234253, "acc": 0.9277669191360474, "length": 3.96875, "mode": "test", "epoch": 46}
{"loss": 0.2124948352575302, "acc": 0.9186620712280273, "length": 3.939429759979248, "mode": "train", "epoch": 47}
{"loss": 0.19546659290790558, "acc": 0.9361057281494141, "length": 3.961805582046509, "mode": "test", "epoch": 47}
{"loss": 0.19409121572971344, "acc": 0.9364647269248962, "length": 3.952531099319458, "mode": "train", "epoch": 48}
{"loss": 0.2117331624031067, "acc": 0.9290255308151245, "length": 3.9791667461395264, "mode": "test", "epoch": 48}
{"loss": 0.19196301698684692, "acc": 0.931361198425293, "length": 3.9535677433013916, "mode": "train", "epoch": 49}
{"loss": 0.21128332614898682, "acc": 0.9266546964645386, "length": 3.965277671813965, "mode": "test", "epoch": 49}
{"loss": 0.19176463782787323, "acc": 0.93160480260849, "length": 3.953191041946411, "mode": "train", "epoch": 50}
{"loss": 0.19673900306224823, "acc": 0.9356282353401184, "length": 3.9826388359069824, "mode": "test", "epoch": 50}
{"loss": 0.18492738902568817, "acc": 0.9381638169288635, "length": 3.96795392036438, "mode": "train", "epoch": 51}
{"loss": 0.2115260511636734, "acc": 0.9349392652511597, "length": 3.9826388359069824, "mode": "test", "epoch": 51}
{"loss": 0.18449300527572632, "acc": 0.9369997978210449, "length": 3.9625792503356934, "mode": "train", "epoch": 52}
{"loss": 0.21552713215351105, "acc": 0.9343425035476685, "length": 3.96875, "mode": "test", "epoch": 52}
{"loss": 0.17925208806991577, "acc": 0.9380372166633606, "length": 3.957015037536621, "mode": "train", "epoch": 53}
{"loss": 0.2103554606437683, "acc": 0.9310383200645447, "length": 3.96875, "mode": "test", "epoch": 53}
{"loss": 0.1845741719007492, "acc": 0.9347179532051086, "length": 3.9711334705352783, "mode": "train", "epoch": 54}
{"loss": 0.1827925443649292, "acc": 0.9428440928459167, "length": 3.996527671813965, "mode": "test", "epoch": 54}
{"loss": 0.17521971464157104, "acc": 0.938831090927124, "length": 3.975594997406006, "mode": "train", "epoch": 55}
{"loss": 0.17573295533657074, "acc": 0.9484484195709229, "length": 3.972222328186035, "mode": "test", "epoch": 55}
{"loss": 0.16619402170181274, "acc": 0.9451636672019958, "length": 3.9731905460357666, "mode": "train", "epoch": 56}
{"loss": 0.20557546615600586, "acc": 0.9348795413970947, "length": 3.9826388359069824, "mode": "test", "epoch": 56}
{"loss": 0.18763841688632965, "acc": 0.935119092464447, "length": 3.978620767593384, "mode": "train", "epoch": 57}
{"loss": 0.1697198897600174, "acc": 0.9526040554046631, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.16356919705867767, "acc": 0.9425694346427917, "length": 3.9749271869659424, "mode": "train", "epoch": 58}
{"loss": 0.1679551601409912, "acc": 0.9489583969116211, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15577825903892517, "acc": 0.9479781985282898, "length": 3.977634906768799, "mode": "train", "epoch": 59}
{"loss": 0.16729527711868286, "acc": 0.9522569179534912, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.14935621619224548, "acc": 0.9510083198547363, "length": 3.979905843734741, "mode": "train", "epoch": 60}
{"loss": 0.15236665308475494, "acc": 0.9564235210418701, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7458928227424622
