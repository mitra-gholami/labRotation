# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7298454642295837, "acc": 0.5298836827278137, "length": 3.6636202335357666, "mode": "train", "epoch": 1}
{"loss": 0.6981202960014343, "acc": 0.5423827767372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6997568607330322, "acc": 0.5445026755332947, "length": 1.0561602115631104, "mode": "train", "epoch": 2}
{"loss": 0.6971449255943298, "acc": 0.534960925579071, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6992611289024353, "acc": 0.545436680316925, "length": 1.0239018201828003, "mode": "train", "epoch": 3}
{"loss": 0.7003136873245239, "acc": 0.5218749642372131, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6990885138511658, "acc": 0.5413046479225159, "length": 1.016032338142395, "mode": "train", "epoch": 4}
{"loss": 0.6982758641242981, "acc": 0.5298828482627869, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6985381841659546, "acc": 0.5395458340644836, "length": 1.0124741792678833, "mode": "train", "epoch": 5}
{"loss": 0.7013161182403564, "acc": 0.515820324420929, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.697676956653595, "acc": 0.5484495759010315, "length": 1.0090149641036987, "mode": "train", "epoch": 6}
{"loss": 0.69923335313797, "acc": 0.521679699420929, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6981106400489807, "acc": 0.5493497848510742, "length": 1.0063132047653198, "mode": "train", "epoch": 7}
{"loss": 0.6998836994171143, "acc": 0.5330078601837158, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6975321173667908, "acc": 0.5565202236175537, "length": 1.0052165985107422, "mode": "train", "epoch": 8}
{"loss": 0.6995642185211182, "acc": 0.5277343392372131, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6964617371559143, "acc": 0.5459845066070557, "length": 1.0039395093917847, "mode": "train", "epoch": 9}
{"loss": 0.6977585554122925, "acc": 0.5550780892372131, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6973389387130737, "acc": 0.5450336337089539, "length": 1.0033360719680786, "mode": "train", "epoch": 10}
{"loss": 0.6994094252586365, "acc": 0.5333985686302185, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6967602372169495, "acc": 0.5454522967338562, "length": 1.002785086631775, "mode": "train", "epoch": 11}
{"loss": 0.6987929344177246, "acc": 0.5277343392372131, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6973717212677002, "acc": 0.5464580655097961, "length": 1.0023624897003174, "mode": "train", "epoch": 12}
{"loss": 0.6980414986610413, "acc": 0.5416015982627869, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6961178779602051, "acc": 0.5447466373443604, "length": 1.0021387338638306, "mode": "train", "epoch": 13}
{"loss": 0.6997373104095459, "acc": 0.5210937857627869, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6960278749465942, "acc": 0.5476419925689697, "length": 1.0016701221466064, "mode": "train", "epoch": 14}
{"loss": 0.6989148259162903, "acc": 0.5416015982627869, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6967647671699524, "acc": 0.5422052145004272, "length": 1.0015054941177368, "mode": "train", "epoch": 15}
{"loss": 0.698295533657074, "acc": 0.5416015982627869, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6969507932662964, "acc": 0.5440320372581482, "length": 1.0012229681015015, "mode": "train", "epoch": 16}
{"loss": 0.6994825601577759, "acc": 0.51953125, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6955533027648926, "acc": 0.5489920377731323, "length": 1.0010753870010376, "mode": "train", "epoch": 17}
{"loss": 0.6991089582443237, "acc": 0.5330078601837158, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.695736289024353, "acc": 0.545984148979187, "length": 1.000990390777588, "mode": "train", "epoch": 18}
{"loss": 0.6984202861785889, "acc": 0.5416015982627869, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6963245868682861, "acc": 0.5492895841598511, "length": 1.0008398294448853, "mode": "train", "epoch": 19}
{"loss": 0.6987550854682922, "acc": 0.51953125, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6950477957725525, "acc": 0.5484059453010559, "length": 1.0007015466690063, "mode": "train", "epoch": 20}
{"loss": 0.6975914239883423, "acc": 0.5390625, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6956784129142761, "acc": 0.551176905632019, "length": 1.0006693601608276, "mode": "train", "epoch": 21}
{"loss": 0.6978551149368286, "acc": 0.533398449420929, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6949606537818909, "acc": 0.5515342354774475, "length": 1.000579595565796, "mode": "train", "epoch": 22}
{"loss": 0.6979416012763977, "acc": 0.5374999642372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6964945197105408, "acc": 0.5425592064857483, "length": 1.0005031824111938, "mode": "train", "epoch": 23}
{"loss": 0.6993890404701233, "acc": 0.5310547351837158, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6941853165626526, "acc": 0.5477567911148071, "length": 1.0004162788391113, "mode": "train", "epoch": 24}
{"loss": 0.6992537379264832, "acc": 0.51953125, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.695202648639679, "acc": 0.5508857369422913, "length": 1.0003665685653687, "mode": "train", "epoch": 25}
{"loss": 0.6991260051727295, "acc": 0.523632824420929, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6943613886833191, "acc": 0.5574949979782104, "length": 1.0003787279129028, "mode": "train", "epoch": 26}
{"loss": 0.6968581080436707, "acc": 0.5374999642372131, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.694328784942627, "acc": 0.5453965663909912, "length": 1.0003036260604858, "mode": "train", "epoch": 27}
{"loss": 0.6993235349655151, "acc": 0.51953125, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6938832402229309, "acc": 0.5510637164115906, "length": 1.0002729892730713, "mode": "train", "epoch": 28}
{"loss": 0.698937714099884, "acc": 0.523632824420929, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6945055723190308, "acc": 0.5448046326637268, "length": 1.0002243518829346, "mode": "train", "epoch": 29}
{"loss": 0.6995328068733215, "acc": 0.5289062857627869, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.693368136882782, "acc": 0.5428580641746521, "length": 1.0001941919326782, "mode": "train", "epoch": 30}
{"loss": 0.6989970207214355, "acc": 0.5509765148162842, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6928305625915527, "acc": 0.5520079135894775, "length": 1.0001846551895142, "mode": "train", "epoch": 31}
{"loss": 0.7019094228744507, "acc": 0.5330078601837158, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6944110989570618, "acc": 0.5439204573631287, "length": 1.000190258026123, "mode": "train", "epoch": 32}
{"loss": 0.700560986995697, "acc": 0.520703136920929, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6931018233299255, "acc": 0.555489718914032, "length": 1.0001710653305054, "mode": "train", "epoch": 33}
{"loss": 0.6971418857574463, "acc": 0.530078113079071, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.693718671798706, "acc": 0.5501186847686768, "length": 1.0001311302185059, "mode": "train", "epoch": 34}
{"loss": 0.7008883953094482, "acc": 0.51953125, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6911238431930542, "acc": 0.555726170539856, "length": 1.0001057386398315, "mode": "train", "epoch": 35}
{"loss": 0.698143720626831, "acc": 0.523632824420929, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6924277544021606, "acc": 0.5509446263313293, "length": 1.000106930732727, "mode": "train", "epoch": 36}
{"loss": 0.6980571150779724, "acc": 0.5154297351837158, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6919201016426086, "acc": 0.5560213327407837, "length": 1.0001091957092285, "mode": "train", "epoch": 37}
{"loss": 0.6995768547058105, "acc": 0.5228515267372131, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6912742853164673, "acc": 0.555313229560852, "length": 1.0000829696655273, "mode": "train", "epoch": 38}
{"loss": 0.6977154612541199, "acc": 0.529296875, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.691292405128479, "acc": 0.5510035753250122, "length": 1.000069499015808, "mode": "train", "epoch": 39}
{"loss": 0.6995604634284973, "acc": 0.5289062857627869, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6915466785430908, "acc": 0.5472345352172852, "length": 1.0001986026763916, "mode": "train", "epoch": 40}
{"loss": 0.699836254119873, "acc": 0.523632824420929, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6931157112121582, "acc": 0.5564356446266174, "length": 1.0001802444458008, "mode": "train", "epoch": 41}
{"loss": 0.6978368759155273, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6918235421180725, "acc": 0.5495277047157288, "length": 1.000053882598877, "mode": "train", "epoch": 42}
{"loss": 0.6998753547668457, "acc": 0.5173828601837158, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6910463571548462, "acc": 0.5517712831497192, "length": 1.000048279762268, "mode": "train", "epoch": 43}
{"loss": 0.6992089748382568, "acc": 0.5146484375, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6916007399559021, "acc": 0.5527744293212891, "length": 1.0000452995300293, "mode": "train", "epoch": 44}
{"loss": 0.6981968283653259, "acc": 0.5248046517372131, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6908589005470276, "acc": 0.550118088722229, "length": 1.0000416040420532, "mode": "train", "epoch": 45}
{"loss": 0.6996277570724487, "acc": 0.5154297351837158, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6906421780586243, "acc": 0.5436248183250427, "length": 1.0000317096710205, "mode": "train", "epoch": 46}
{"loss": 0.6989767551422119, "acc": 0.5203125476837158, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6910994648933411, "acc": 0.5585005283355713, "length": 1.000029444694519, "mode": "train", "epoch": 47}
{"loss": 0.6981382369995117, "acc": 0.5146484375, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6907578706741333, "acc": 0.5514762997627258, "length": 1.0000396966934204, "mode": "train", "epoch": 48}
{"loss": 0.7014318704605103, "acc": 0.5166016221046448, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6908722519874573, "acc": 0.5592089295387268, "length": 1.0000249147415161, "mode": "train", "epoch": 49}
{"loss": 0.6992008090019226, "acc": 0.523632824420929, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6903781890869141, "acc": 0.5457497835159302, "length": 1.0000251531600952, "mode": "train", "epoch": 50}
{"loss": 0.6972726583480835, "acc": 0.5173828601837158, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6900579929351807, "acc": 0.5533648729324341, "length": 1.0000190734863281, "mode": "train", "epoch": 51}
{"loss": 0.7008164525032043, "acc": 0.5166015028953552, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6900861859321594, "acc": 0.558795690536499, "length": 1.0000144243240356, "mode": "train", "epoch": 52}
{"loss": 0.6993817687034607, "acc": 0.5146484375, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6891967058181763, "acc": 0.5504133701324463, "length": 1.000013828277588, "mode": "train", "epoch": 53}
{"loss": 0.698169469833374, "acc": 0.5248046517372131, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6893558502197266, "acc": 0.5655844211578369, "length": 1.0000139474868774, "mode": "train", "epoch": 54}
{"loss": 0.6988336443901062, "acc": 0.5146484375, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6903519034385681, "acc": 0.5589138269424438, "length": 1.0000255107879639, "mode": "train", "epoch": 55}
{"loss": 0.6987404823303223, "acc": 0.5146484375, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6894412040710449, "acc": 0.5533057451248169, "length": 1.0000097751617432, "mode": "train", "epoch": 56}
{"loss": 0.6991970539093018, "acc": 0.5146484375, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6902971863746643, "acc": 0.5581464767456055, "length": 1.0000088214874268, "mode": "train", "epoch": 57}
{"loss": 0.7007094621658325, "acc": 0.5289062857627869, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6895962357521057, "acc": 0.5577331781387329, "length": 1.0000112056732178, "mode": "train", "epoch": 58}
{"loss": 0.6975527405738831, "acc": 0.5308594107627869, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6903036832809448, "acc": 0.5464581251144409, "length": 1.0000104904174805, "mode": "train", "epoch": 59}
{"loss": 0.6992621421813965, "acc": 0.5218749642372131, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6891589760780334, "acc": 0.5551358461380005, "length": 1.0000067949295044, "mode": "train", "epoch": 60}
{"loss": 0.6977868676185608, "acc": 0.5166016221046448, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.3145161271095276
