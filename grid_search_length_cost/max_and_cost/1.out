# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7168605327606201, "acc": 0.5344868898391724, "length": 2.634256601333618, "mode": "train", "epoch": 1}
{"loss": 0.6935324668884277, "acc": 0.5582031607627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6966950297355652, "acc": 0.5427238345146179, "length": 1.0340367555618286, "mode": "train", "epoch": 2}
{"loss": 0.6958721876144409, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6956583261489868, "acc": 0.5477920770645142, "length": 1.0142182111740112, "mode": "train", "epoch": 3}
{"loss": 0.6944729685783386, "acc": 0.5486328601837158, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6961619853973389, "acc": 0.5453978776931763, "length": 1.0088647603988647, "mode": "train", "epoch": 4}
{"loss": 0.6948046088218689, "acc": 0.547070324420929, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6927852034568787, "acc": 0.5507816076278687, "length": 1.0063928365707397, "mode": "train", "epoch": 5}
{"loss": 0.6960985660552979, "acc": 0.5224609375, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6937278509140015, "acc": 0.5411993265151978, "length": 1.0048718452453613, "mode": "train", "epoch": 6}
{"loss": 0.6965033411979675, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6942024827003479, "acc": 0.54337477684021, "length": 1.0036988258361816, "mode": "train", "epoch": 7}
{"loss": 0.6951922178268433, "acc": 0.5533203482627869, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.693592369556427, "acc": 0.5467244982719421, "length": 1.003058910369873, "mode": "train", "epoch": 8}
{"loss": 0.6951812505722046, "acc": 0.5388672351837158, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6940311789512634, "acc": 0.5471426844596863, "length": 1.0024436712265015, "mode": "train", "epoch": 9}
{"loss": 0.6960920095443726, "acc": 0.5388672351837158, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6935179829597473, "acc": 0.5467144846916199, "length": 1.0019395351409912, "mode": "train", "epoch": 10}
{"loss": 0.6954292058944702, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6936737895011902, "acc": 0.54356449842453, "length": 1.0016580820083618, "mode": "train", "epoch": 11}
{"loss": 0.6948702931404114, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.693179726600647, "acc": 0.5497610569000244, "length": 1.0013097524642944, "mode": "train", "epoch": 12}
{"loss": 0.6961135864257812, "acc": 0.547070324420929, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6938760876655579, "acc": 0.5576828718185425, "length": 1.0011086463928223, "mode": "train", "epoch": 13}
{"loss": 0.6937391757965088, "acc": 0.5533203482627869, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6944210529327393, "acc": 0.5542900562286377, "length": 1.0010266304016113, "mode": "train", "epoch": 14}
{"loss": 0.6944772005081177, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6915054321289062, "acc": 0.5548838376998901, "length": 1.0008796453475952, "mode": "train", "epoch": 15}
{"loss": 0.6939986944198608, "acc": 0.5685546398162842, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6916999220848083, "acc": 0.5473193526268005, "length": 1.0008094310760498, "mode": "train", "epoch": 16}
{"loss": 0.6945247054100037, "acc": 0.547070324420929, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6920439004898071, "acc": 0.5538139343261719, "length": 1.0005874633789062, "mode": "train", "epoch": 17}
{"loss": 0.6953582763671875, "acc": 0.547070324420929, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6925948858261108, "acc": 0.547677218914032, "length": 1.0005770921707153, "mode": "train", "epoch": 18}
{"loss": 0.6927214860916138, "acc": 0.5615234375, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6949717402458191, "acc": 0.5495808720588684, "length": 1.0004897117614746, "mode": "train", "epoch": 19}
{"loss": 0.6939713954925537, "acc": 0.5369141101837158, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6928756833076477, "acc": 0.551072359085083, "length": 1.000416874885559, "mode": "train", "epoch": 20}
{"loss": 0.69468754529953, "acc": 0.5439453721046448, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6912710666656494, "acc": 0.5579862594604492, "length": 1.0003602504730225, "mode": "train", "epoch": 21}
{"loss": 0.6927729845046997, "acc": 0.5652344226837158, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6920008659362793, "acc": 0.5549466013908386, "length": 1.0003106594085693, "mode": "train", "epoch": 22}
{"loss": 0.6946396231651306, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6909008026123047, "acc": 0.5525628924369812, "length": 1.0002740621566772, "mode": "train", "epoch": 23}
{"loss": 0.6921252012252808, "acc": 0.547070324420929, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6921581029891968, "acc": 0.552026629447937, "length": 1.0002658367156982, "mode": "train", "epoch": 24}
{"loss": 0.6935925483703613, "acc": 0.545117199420929, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6900385618209839, "acc": 0.5463644862174988, "length": 1.000214695930481, "mode": "train", "epoch": 25}
{"loss": 0.6931630969047546, "acc": 0.5583984851837158, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6902421116828918, "acc": 0.5672228336334229, "length": 1.0001673698425293, "mode": "train", "epoch": 26}
{"loss": 0.6939671039581299, "acc": 0.5615234375, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6896066069602966, "acc": 0.5545293092727661, "length": 1.00016188621521, "mode": "train", "epoch": 27}
{"loss": 0.6908308267593384, "acc": 0.5615234375, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6894736289978027, "acc": 0.5582837462425232, "length": 1.000145673751831, "mode": "train", "epoch": 28}
{"loss": 0.693302571773529, "acc": 0.5583984851837158, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6877433061599731, "acc": 0.5613827705383301, "length": 1.0001251697540283, "mode": "train", "epoch": 29}
{"loss": 0.6933184266090393, "acc": 0.5419921875, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6884281635284424, "acc": 0.5635875463485718, "length": 1.0001122951507568, "mode": "train", "epoch": 30}
{"loss": 0.6941317319869995, "acc": 0.5583984851837158, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6878111362457275, "acc": 0.5617997050285339, "length": 1.000104546546936, "mode": "train", "epoch": 31}
{"loss": 0.6924744248390198, "acc": 0.5583984851837158, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6869572401046753, "acc": 0.5662099719047546, "length": 1.0000847578048706, "mode": "train", "epoch": 32}
{"loss": 0.6925117373466492, "acc": 0.5615234375, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6893726587295532, "acc": 0.5659117102622986, "length": 1.0000745058059692, "mode": "train", "epoch": 33}
{"loss": 0.692145586013794, "acc": 0.5583984851837158, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.688469409942627, "acc": 0.561441957950592, "length": 1.0000661611557007, "mode": "train", "epoch": 34}
{"loss": 0.6933882832527161, "acc": 0.5583984851837158, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6881251931190491, "acc": 0.5647796392440796, "length": 1.0000746250152588, "mode": "train", "epoch": 35}
{"loss": 0.6929975748062134, "acc": 0.5498046875, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6858466863632202, "acc": 0.5664479732513428, "length": 1.0000476837158203, "mode": "train", "epoch": 36}
{"loss": 0.6926565170288086, "acc": 0.5443359017372131, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6877806186676025, "acc": 0.5647790431976318, "length": 1.0000479221343994, "mode": "train", "epoch": 37}
{"loss": 0.6925859451293945, "acc": 0.5419921875, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6846734285354614, "acc": 0.5645411014556885, "length": 1.0000383853912354, "mode": "train", "epoch": 38}
{"loss": 0.6926592588424683, "acc": 0.5583984851837158, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6861547827720642, "acc": 0.5745524168014526, "length": 1.0000399351119995, "mode": "train", "epoch": 39}
{"loss": 0.6928345561027527, "acc": 0.5630859732627869, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6842151880264282, "acc": 0.5714541077613831, "length": 1.0000344514846802, "mode": "train", "epoch": 40}
{"loss": 0.6925257444381714, "acc": 0.560742199420929, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6857315897941589, "acc": 0.5695469975471497, "length": 1.0000277757644653, "mode": "train", "epoch": 41}
{"loss": 0.6924669146537781, "acc": 0.5630859732627869, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6851339936256409, "acc": 0.5745530724525452, "length": 1.000022530555725, "mode": "train", "epoch": 42}
{"loss": 0.6930963397026062, "acc": 0.5541015267372131, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6862587332725525, "acc": 0.5679975748062134, "length": 1.0000202655792236, "mode": "train", "epoch": 43}
{"loss": 0.693426787853241, "acc": 0.5576171875, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6858002543449402, "acc": 0.5714539289474487, "length": 1.0000172853469849, "mode": "train", "epoch": 44}
{"loss": 0.693069577217102, "acc": 0.558789074420929, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6872146129608154, "acc": 0.5762214660644531, "length": 1.000015377998352, "mode": "train", "epoch": 45}
{"loss": 0.6919132471084595, "acc": 0.558789074420929, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6845812797546387, "acc": 0.5792014002799988, "length": 1.000012993812561, "mode": "train", "epoch": 46}
{"loss": 0.6918741464614868, "acc": 0.558789074420929, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.684060275554657, "acc": 0.574314534664154, "length": 1.000013828277588, "mode": "train", "epoch": 47}
{"loss": 0.6903156042098999, "acc": 0.5685548186302185, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6842097043991089, "acc": 0.5706793665885925, "length": 1.0000120401382446, "mode": "train", "epoch": 48}
{"loss": 0.6920586824417114, "acc": 0.558789074420929, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6851763725280762, "acc": 0.5742549896240234, "length": 1.000009536743164, "mode": "train", "epoch": 49}
{"loss": 0.6914793252944946, "acc": 0.558789074420929, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6864059567451477, "acc": 0.5716329216957092, "length": 1.0000096559524536, "mode": "train", "epoch": 50}
{"loss": 0.6938389539718628, "acc": 0.5400390625, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.683398425579071, "acc": 0.5766985416412354, "length": 1.0000079870224, "mode": "train", "epoch": 51}
{"loss": 0.6918667554855347, "acc": 0.5572265982627869, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6824446320533752, "acc": 0.5728247761726379, "length": 1.0000067949295044, "mode": "train", "epoch": 52}
{"loss": 0.6921493411064148, "acc": 0.5654296875, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6864968538284302, "acc": 0.5705006122589111, "length": 1.0000067949295044, "mode": "train", "epoch": 53}
{"loss": 0.6919285655021667, "acc": 0.558789074420929, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6848130226135254, "acc": 0.5814064741134644, "length": 1.0000052452087402, "mode": "train", "epoch": 54}
{"loss": 0.6938767433166504, "acc": 0.550585925579071, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6827275156974792, "acc": 0.5782478451728821, "length": 1.0000042915344238, "mode": "train", "epoch": 55}
{"loss": 0.693393349647522, "acc": 0.5548829436302185, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.684963047504425, "acc": 0.5684743523597717, "length": 1.0000040531158447, "mode": "train", "epoch": 56}
{"loss": 0.6923163533210754, "acc": 0.550585925579071, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6839684844017029, "acc": 0.5771155953407288, "length": 1.0000038146972656, "mode": "train", "epoch": 57}
{"loss": 0.6916815042495728, "acc": 0.558789074420929, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6839098334312439, "acc": 0.5831943154335022, "length": 1.0000033378601074, "mode": "train", "epoch": 58}
{"loss": 0.6927633285522461, "acc": 0.550585925579071, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6816849708557129, "acc": 0.5778903961181641, "length": 1.0000032186508179, "mode": "train", "epoch": 59}
{"loss": 0.6921520233154297, "acc": 0.550585925579071, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6835353374481201, "acc": 0.5712754130363464, "length": 1.0000025033950806, "mode": "train", "epoch": 60}
{"loss": 0.6918935775756836, "acc": 0.550585925579071, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.24421875178813934
