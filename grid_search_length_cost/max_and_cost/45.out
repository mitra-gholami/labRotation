# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.701271653175354, "acc": 0.5120987296104431, "length": 3.1097052097320557, "mode": "train", "epoch": 1}
{"loss": 0.6923516988754272, "acc": 0.5328125357627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.680022656917572, "acc": 0.5808998942375183, "length": 1.9634653329849243, "mode": "train", "epoch": 2}
{"loss": 0.6565423011779785, "acc": 0.6449768543243408, "length": 1.6953125, "mode": "test", "epoch": 2}
{"loss": 0.6060103178024292, "acc": 0.685038149356842, "length": 2.9454236030578613, "mode": "train", "epoch": 3}
{"loss": 0.6405760049819946, "acc": 0.64923095703125, "length": 2.28125, "mode": "test", "epoch": 3}
{"loss": 0.5517539381980896, "acc": 0.7185666561126709, "length": 2.7673842906951904, "mode": "train", "epoch": 4}
{"loss": 0.5569236278533936, "acc": 0.75030517578125, "length": 3.421875, "mode": "test", "epoch": 4}
{"loss": 0.48629796504974365, "acc": 0.7739861607551575, "length": 3.369252920150757, "mode": "train", "epoch": 5}
{"loss": 0.516471803188324, "acc": 0.773730456829071, "length": 3.4921875, "mode": "test", "epoch": 5}
{"loss": 0.4489278197288513, "acc": 0.7894541621208191, "length": 3.260190725326538, "mode": "train", "epoch": 6}
{"loss": 0.5045381784439087, "acc": 0.7740662693977356, "length": 3.3671875, "mode": "test", "epoch": 6}
{"loss": 0.41867104172706604, "acc": 0.8069035410881042, "length": 3.5004570484161377, "mode": "train", "epoch": 7}
{"loss": 0.47359970211982727, "acc": 0.7865906357765198, "length": 3.8046875, "mode": "test", "epoch": 7}
{"loss": 0.39688166975975037, "acc": 0.8293562531471252, "length": 3.9109113216400146, "mode": "train", "epoch": 8}
{"loss": 0.43967902660369873, "acc": 0.8190125226974487, "length": 4.64453125, "mode": "test", "epoch": 8}
{"loss": 0.3704150915145874, "acc": 0.8431205749511719, "length": 4.236832618713379, "mode": "train", "epoch": 9}
{"loss": 0.3953970670700073, "acc": 0.834759533405304, "length": 5.0625, "mode": "test", "epoch": 9}
{"loss": 0.3370378613471985, "acc": 0.8577544093132019, "length": 4.612658500671387, "mode": "train", "epoch": 10}
{"loss": 0.3986307680606842, "acc": 0.840380847454071, "length": 5.07421875, "mode": "test", "epoch": 10}
{"loss": 0.31818902492523193, "acc": 0.8667908906936646, "length": 4.810431003570557, "mode": "train", "epoch": 11}
{"loss": 0.36509525775909424, "acc": 0.8540283441543579, "length": 5.17578125, "mode": "test", "epoch": 11}
{"loss": 0.30219629406929016, "acc": 0.8763371706008911, "length": 4.950544357299805, "mode": "train", "epoch": 12}
{"loss": 0.37179863452911377, "acc": 0.8521239757537842, "length": 5.18359375, "mode": "test", "epoch": 12}
{"loss": 0.2869715690612793, "acc": 0.8808624148368835, "length": 4.970396995544434, "mode": "train", "epoch": 13}
{"loss": 0.3657272756099701, "acc": 0.8606505990028381, "length": 5.03125, "mode": "test", "epoch": 13}
{"loss": 0.27209219336509705, "acc": 0.8879958391189575, "length": 4.968675136566162, "mode": "train", "epoch": 14}
{"loss": 0.35464197397232056, "acc": 0.8631591796875, "length": 5.30078125, "mode": "test", "epoch": 14}
{"loss": 0.25352898240089417, "acc": 0.8982058763504028, "length": 5.063931465148926, "mode": "train", "epoch": 15}
{"loss": 0.3578796982765198, "acc": 0.8636353015899658, "length": 5.3671875, "mode": "test", "epoch": 15}
{"loss": 0.2389085292816162, "acc": 0.9015629291534424, "length": 5.0855326652526855, "mode": "train", "epoch": 16}
{"loss": 0.34553763270378113, "acc": 0.869830310344696, "length": 5.53515625, "mode": "test", "epoch": 16}
{"loss": 0.22353270649909973, "acc": 0.9094224572181702, "length": 5.220422744750977, "mode": "train", "epoch": 17}
{"loss": 0.29586261510849, "acc": 0.8789733648300171, "length": 5.33984375, "mode": "test", "epoch": 17}
{"loss": 0.2075994461774826, "acc": 0.921015202999115, "length": 5.188932418823242, "mode": "train", "epoch": 18}
{"loss": 0.31415969133377075, "acc": 0.882171630859375, "length": 5.515625, "mode": "test", "epoch": 18}
{"loss": 0.17920255661010742, "acc": 0.9308564066886902, "length": 5.314891815185547, "mode": "train", "epoch": 19}
{"loss": 0.2608359456062317, "acc": 0.9041016101837158, "length": 5.4296875, "mode": "test", "epoch": 19}
{"loss": 0.17190828919410706, "acc": 0.9333146214485168, "length": 5.369002342224121, "mode": "train", "epoch": 20}
{"loss": 0.2496418058872223, "acc": 0.9079955816268921, "length": 5.59765625, "mode": "test", "epoch": 20}
{"loss": 0.16055136919021606, "acc": 0.9421910643577576, "length": 5.359833717346191, "mode": "train", "epoch": 21}
{"loss": 0.2289591282606125, "acc": 0.90655517578125, "length": 5.66796875, "mode": "test", "epoch": 21}
{"loss": 0.14770227670669556, "acc": 0.9481533765792847, "length": 5.471346378326416, "mode": "train", "epoch": 22}
{"loss": 0.23921753466129303, "acc": 0.9033263921737671, "length": 5.80078125, "mode": "test", "epoch": 22}
{"loss": 0.1376037299633026, "acc": 0.950005292892456, "length": 5.614429473876953, "mode": "train", "epoch": 23}
{"loss": 0.2089831680059433, "acc": 0.922595202922821, "length": 5.7734375, "mode": "test", "epoch": 23}
{"loss": 0.12610818445682526, "acc": 0.9565892815589905, "length": 5.6675262451171875, "mode": "train", "epoch": 24}
{"loss": 0.18948489427566528, "acc": 0.9304627180099487, "length": 5.92578125, "mode": "test", "epoch": 24}
{"loss": 0.11269636452198029, "acc": 0.962762176990509, "length": 5.784106731414795, "mode": "train", "epoch": 25}
{"loss": 0.18089546263217926, "acc": 0.9383605718612671, "length": 5.921875, "mode": "test", "epoch": 25}
{"loss": 0.10405479371547699, "acc": 0.9667727947235107, "length": 5.796016216278076, "mode": "train", "epoch": 26}
{"loss": 0.15308475494384766, "acc": 0.9516417980194092, "length": 5.9375, "mode": "test", "epoch": 26}
{"loss": 0.09305710345506668, "acc": 0.9710537791252136, "length": 5.846357345581055, "mode": "train", "epoch": 27}
{"loss": 0.14598843455314636, "acc": 0.948437511920929, "length": 5.953125, "mode": "test", "epoch": 27}
{"loss": 0.08648325502872467, "acc": 0.9734034538269043, "length": 5.870121955871582, "mode": "train", "epoch": 28}
{"loss": 0.12704454362392426, "acc": 0.9610595703125, "length": 5.9765625, "mode": "test", "epoch": 28}
{"loss": 0.08246340602636337, "acc": 0.9751463532447815, "length": 5.918270587921143, "mode": "train", "epoch": 29}
{"loss": 0.17463397979736328, "acc": 0.9453125, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.07857488840818405, "acc": 0.9771283268928528, "length": 5.944314956665039, "mode": "train", "epoch": 30}
{"loss": 0.11186005175113678, "acc": 0.9611328840255737, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.07072950899600983, "acc": 0.9816298484802246, "length": 5.956099033355713, "mode": "train", "epoch": 31}
{"loss": 0.14546069502830505, "acc": 0.9535155892372131, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.0718623548746109, "acc": 0.9788978695869446, "length": 5.967544078826904, "mode": "train", "epoch": 32}
{"loss": 0.13638725876808167, "acc": 0.9613280892372131, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.06759973615407944, "acc": 0.9797762036323547, "length": 5.9735870361328125, "mode": "train", "epoch": 33}
{"loss": 0.13106268644332886, "acc": 0.9548826813697815, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.06642364710569382, "acc": 0.9813363552093506, "length": 5.981384754180908, "mode": "train", "epoch": 34}
{"loss": 0.10558295249938965, "acc": 0.9660156965255737, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.056525785475969315, "acc": 0.983105480670929, "length": 5.975194454193115, "mode": "train", "epoch": 35}
{"loss": 0.1275518536567688, "acc": 0.9642577171325684, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.04634024202823639, "acc": 0.9886187314987183, "length": 5.98598575592041, "mode": "train", "epoch": 36}
{"loss": 0.09324972331523895, "acc": 0.9736328125, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.04300617426633835, "acc": 0.9881610870361328, "length": 5.988305568695068, "mode": "train", "epoch": 37}
{"loss": 0.10566823929548264, "acc": 0.9732422232627869, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.03994638845324516, "acc": 0.9899927973747253, "length": 5.9876179695129395, "mode": "train", "epoch": 38}
{"loss": 0.10449711233377457, "acc": 0.9726563096046448, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.038551487028598785, "acc": 0.9919772744178772, "length": 5.9926862716674805, "mode": "train", "epoch": 39}
{"loss": 0.10310464352369308, "acc": 0.9699219465255737, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.03372706100344658, "acc": 0.9931195378303528, "length": 5.994199752807617, "mode": "train", "epoch": 40}
{"loss": 0.09959188848733902, "acc": 0.9736328125, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.030770868062973022, "acc": 0.993239164352417, "length": 5.994699954986572, "mode": "train", "epoch": 41}
{"loss": 0.08275826275348663, "acc": 0.9753905534744263, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.029489826411008835, "acc": 0.9938055276870728, "length": 5.99575138092041, "mode": "train", "epoch": 42}
{"loss": 0.08734489977359772, "acc": 0.9734374284744263, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.032731834799051285, "acc": 0.9934408664703369, "length": 5.996311187744141, "mode": "train", "epoch": 43}
{"loss": 0.14523744583129883, "acc": 0.9621094465255737, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.032317984849214554, "acc": 0.9917040467262268, "length": 5.994777679443359, "mode": "train", "epoch": 44}
{"loss": 0.1286134272813797, "acc": 0.9669922590255737, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.035158220678567886, "acc": 0.99329674243927, "length": 5.99412202835083, "mode": "train", "epoch": 45}
{"loss": 0.1153377890586853, "acc": 0.9654297232627869, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.046836622059345245, "acc": 0.9878710508346558, "length": 5.994147777557373, "mode": "train", "epoch": 46}
{"loss": 0.12817694246768951, "acc": 0.9654297232627869, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.034930720925331116, "acc": 0.9923650026321411, "length": 5.9953460693359375, "mode": "train", "epoch": 47}
{"loss": 0.12955409288406372, "acc": 0.9652343392372131, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.05483028665184975, "acc": 0.985383152961731, "length": 5.994433403015137, "mode": "train", "epoch": 48}
{"loss": 0.14246518909931183, "acc": 0.9619140028953552, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.044461458921432495, "acc": 0.9890598058700562, "length": 5.997379779815674, "mode": "train", "epoch": 49}
{"loss": 0.08314871788024902, "acc": 0.9734374284744263, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.040201421827077866, "acc": 0.9888687133789062, "length": 5.996228218078613, "mode": "train", "epoch": 50}
{"loss": 0.11447717249393463, "acc": 0.9740234017372131, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.03407624363899231, "acc": 0.9913538694381714, "length": 5.9957451820373535, "mode": "train", "epoch": 51}
{"loss": 0.10225570201873779, "acc": 0.9642577767372131, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.04617016389966011, "acc": 0.9904054999351501, "length": 5.9963765144348145, "mode": "train", "epoch": 52}
{"loss": 0.10629576444625854, "acc": 0.9679688215255737, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.03674066439270973, "acc": 0.9900680780410767, "length": 5.9976067543029785, "mode": "train", "epoch": 53}
{"loss": 0.1253364086151123, "acc": 0.9617186784744263, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.026666739955544472, "acc": 0.9944326877593994, "length": 5.9985246658325195, "mode": "train", "epoch": 54}
{"loss": 0.10029125213623047, "acc": 0.9705077409744263, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.01927374303340912, "acc": 0.9975960850715637, "length": 5.99857234954834, "mode": "train", "epoch": 55}
{"loss": 0.07441074401140213, "acc": 0.9779296517372131, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.021737297996878624, "acc": 0.9965187311172485, "length": 5.998382091522217, "mode": "train", "epoch": 56}
{"loss": 0.06859876960515976, "acc": 0.9798827767372131, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.019000770524144173, "acc": 0.9968825578689575, "length": 5.9988112449646, "mode": "train", "epoch": 57}
{"loss": 0.07401584833860397, "acc": 0.9830078482627869, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.020837007090449333, "acc": 0.9956962466239929, "length": 5.9992194175720215, "mode": "train", "epoch": 58}
{"loss": 0.09390947222709656, "acc": 0.9789062142372131, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.02117960713803768, "acc": 0.9965898990631104, "length": 5.9992356300354, "mode": "train", "epoch": 59}
{"loss": 0.0760636255145073, "acc": 0.9808593392372131, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.017655858770012856, "acc": 0.9980213642120361, "length": 5.999296188354492, "mode": "train", "epoch": 60}
{"loss": 0.08211066573858261, "acc": 0.9773436188697815, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.8893750309944153
