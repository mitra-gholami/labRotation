# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6972744464874268, "acc": 0.5363984704017639, "length": 2.8950369358062744, "mode": "train", "epoch": 1}
{"loss": 0.6956466436386108, "acc": 0.5160155892372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.657578706741333, "acc": 0.623765230178833, "length": 2.1725914478302, "mode": "train", "epoch": 2}
{"loss": 0.600376307964325, "acc": 0.7144165635108948, "length": 2.4296875, "mode": "test", "epoch": 2}
{"loss": 0.5219221711158752, "acc": 0.7546523213386536, "length": 3.0324366092681885, "mode": "train", "epoch": 3}
{"loss": 0.5038350820541382, "acc": 0.7896423935890198, "length": 3.37890625, "mode": "test", "epoch": 3}
{"loss": 0.4431706666946411, "acc": 0.8050136566162109, "length": 3.291295051574707, "mode": "train", "epoch": 4}
{"loss": 0.4460139274597168, "acc": 0.8037781119346619, "length": 3.4140625, "mode": "test", "epoch": 4}
{"loss": 0.38563072681427, "acc": 0.8429454565048218, "length": 3.401402473449707, "mode": "train", "epoch": 5}
{"loss": 0.4245242178440094, "acc": 0.8219237923622131, "length": 3.4609375, "mode": "test", "epoch": 5}
{"loss": 0.3477596938610077, "acc": 0.8575408458709717, "length": 3.4586286544799805, "mode": "train", "epoch": 6}
{"loss": 0.41040655970573425, "acc": 0.829620361328125, "length": 3.51953125, "mode": "test", "epoch": 6}
{"loss": 0.3355407118797302, "acc": 0.8623886704444885, "length": 3.489729642868042, "mode": "train", "epoch": 7}
{"loss": 0.39638134837150574, "acc": 0.8342101573944092, "length": 3.5546875, "mode": "test", "epoch": 7}
{"loss": 0.32644104957580566, "acc": 0.8662229180335999, "length": 3.526153802871704, "mode": "train", "epoch": 8}
{"loss": 0.4075884521007538, "acc": 0.8378235101699829, "length": 3.6484375, "mode": "test", "epoch": 8}
{"loss": 0.3022480905056, "acc": 0.8799086809158325, "length": 3.63039231300354, "mode": "train", "epoch": 9}
{"loss": 0.3828660547733307, "acc": 0.8492859601974487, "length": 3.90625, "mode": "test", "epoch": 9}
{"loss": 0.2953147888183594, "acc": 0.8825496435165405, "length": 3.7495908737182617, "mode": "train", "epoch": 10}
{"loss": 0.3983175754547119, "acc": 0.850787341594696, "length": 3.87109375, "mode": "test", "epoch": 10}
{"loss": 0.27968159317970276, "acc": 0.8901525735855103, "length": 3.7598180770874023, "mode": "train", "epoch": 11}
{"loss": 0.36298996210098267, "acc": 0.8545471429824829, "length": 3.96484375, "mode": "test", "epoch": 11}
{"loss": 0.26410236954689026, "acc": 0.8965839147567749, "length": 3.852858543395996, "mode": "train", "epoch": 12}
{"loss": 0.351225882768631, "acc": 0.8662232160568237, "length": 3.9765625, "mode": "test", "epoch": 12}
{"loss": 0.2516728937625885, "acc": 0.9027278423309326, "length": 3.8811259269714355, "mode": "train", "epoch": 13}
{"loss": 0.34745222330093384, "acc": 0.8734374642372131, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2502132058143616, "acc": 0.9034518003463745, "length": 3.92018723487854, "mode": "train", "epoch": 14}
{"loss": 0.34179067611694336, "acc": 0.8726562857627869, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.23771002888679504, "acc": 0.9122483134269714, "length": 3.9251627922058105, "mode": "train", "epoch": 15}
{"loss": 0.30922001600265503, "acc": 0.8818359375, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.2213393747806549, "acc": 0.9167892932891846, "length": 3.9556174278259277, "mode": "train", "epoch": 16}
{"loss": 0.29851216077804565, "acc": 0.8912109732627869, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.21333852410316467, "acc": 0.9233256578445435, "length": 3.9696857929229736, "mode": "train", "epoch": 17}
{"loss": 0.30199795961380005, "acc": 0.8939452767372131, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2092583328485489, "acc": 0.9248796701431274, "length": 3.9773242473602295, "mode": "train", "epoch": 18}
{"loss": 0.291959285736084, "acc": 0.8980469107627869, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2009630650281906, "acc": 0.9273949265480042, "length": 3.981180429458618, "mode": "train", "epoch": 19}
{"loss": 0.2690056264400482, "acc": 0.908203125, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.20319774746894836, "acc": 0.922605574131012, "length": 3.9831655025482178, "mode": "train", "epoch": 20}
{"loss": 0.29609763622283936, "acc": 0.9023438096046448, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.18714752793312073, "acc": 0.9325292110443115, "length": 3.985637903213501, "mode": "train", "epoch": 21}
{"loss": 0.27598971128463745, "acc": 0.9060546159744263, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.17965920269489288, "acc": 0.933169960975647, "length": 3.99175763130188, "mode": "train", "epoch": 22}
{"loss": 0.24381069839000702, "acc": 0.9154297113418579, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.16395588219165802, "acc": 0.9423093199729919, "length": 3.9890947341918945, "mode": "train", "epoch": 23}
{"loss": 0.24430325627326965, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.15865857899188995, "acc": 0.9422457814216614, "length": 3.9926629066467285, "mode": "train", "epoch": 24}
{"loss": 0.21364933252334595, "acc": 0.9205078482627869, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.14415815472602844, "acc": 0.9479092955589294, "length": 3.9918367862701416, "mode": "train", "epoch": 25}
{"loss": 0.2128966599702835, "acc": 0.9275389909744263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.13563217222690582, "acc": 0.9525535106658936, "length": 3.9947826862335205, "mode": "train", "epoch": 26}
{"loss": 0.22786767780780792, "acc": 0.9279297590255737, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.14147037267684937, "acc": 0.9471585154533386, "length": 3.9935595989227295, "mode": "train", "epoch": 27}
{"loss": 0.22418569028377533, "acc": 0.9314452409744263, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.12281733006238937, "acc": 0.9590640664100647, "length": 3.9959664344787598, "mode": "train", "epoch": 28}
{"loss": 0.21854934096336365, "acc": 0.9300780892372131, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.1203552782535553, "acc": 0.9561566710472107, "length": 3.9959778785705566, "mode": "train", "epoch": 29}
{"loss": 0.23327381908893585, "acc": 0.9234375357627869, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.11594519019126892, "acc": 0.9596663117408752, "length": 3.9959053993225098, "mode": "train", "epoch": 30}
{"loss": 0.20169520378112793, "acc": 0.9349609017372131, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.10411550849676132, "acc": 0.9627196192741394, "length": 3.9971375465393066, "mode": "train", "epoch": 31}
{"loss": 0.18908898532390594, "acc": 0.9398437142372131, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.0977732464671135, "acc": 0.9677561521530151, "length": 3.9972386360168457, "mode": "train", "epoch": 32}
{"loss": 0.19606241583824158, "acc": 0.9468750357627869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.0942298099398613, "acc": 0.9641835689544678, "length": 3.9980380535125732, "mode": "train", "epoch": 33}
{"loss": 0.17893804609775543, "acc": 0.9455078840255737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.09203220903873444, "acc": 0.9700770974159241, "length": 3.9972989559173584, "mode": "train", "epoch": 34}
{"loss": 0.2056463360786438, "acc": 0.9484375715255737, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.09673570096492767, "acc": 0.9639543294906616, "length": 3.9985108375549316, "mode": "train", "epoch": 35}
{"loss": 0.20166663825511932, "acc": 0.9328125715255737, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.0913710743188858, "acc": 0.9681475162506104, "length": 3.998368263244629, "mode": "train", "epoch": 36}
{"loss": 0.20886504650115967, "acc": 0.9412108659744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.08117293566465378, "acc": 0.9723044037818909, "length": 3.998365640640259, "mode": "train", "epoch": 37}
{"loss": 0.182711660861969, "acc": 0.9507812857627869, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.07887230813503265, "acc": 0.9746465682983398, "length": 3.9985556602478027, "mode": "train", "epoch": 38}
{"loss": 0.198225200176239, "acc": 0.947265625, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.06640239804983139, "acc": 0.9785462021827698, "length": 3.9983808994293213, "mode": "train", "epoch": 39}
{"loss": 0.18875302374362946, "acc": 0.9447265267372131, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.07145024091005325, "acc": 0.976764976978302, "length": 3.9989676475524902, "mode": "train", "epoch": 40}
{"loss": 0.2204536348581314, "acc": 0.9400390982627869, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08519066870212555, "acc": 0.9734528064727783, "length": 3.9987947940826416, "mode": "train", "epoch": 41}
{"loss": 0.2110283225774765, "acc": 0.9417968392372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.06978384405374527, "acc": 0.9762232899665833, "length": 3.9988608360290527, "mode": "train", "epoch": 42}
{"loss": 0.14621694386005402, "acc": 0.95703125, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.06815207749605179, "acc": 0.979181706905365, "length": 3.9991021156311035, "mode": "train", "epoch": 43}
{"loss": 0.1939304918050766, "acc": 0.9453125, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06655391305685043, "acc": 0.9805015921592712, "length": 3.9992992877960205, "mode": "train", "epoch": 44}
{"loss": 0.14921531081199646, "acc": 0.9597655534744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.060428887605667114, "acc": 0.9817038774490356, "length": 3.9993433952331543, "mode": "train", "epoch": 45}
{"loss": 0.13685104250907898, "acc": 0.9593749642372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.05470708757638931, "acc": 0.984233558177948, "length": 3.9994585514068604, "mode": "train", "epoch": 46}
{"loss": 0.13846217095851898, "acc": 0.9597655534744263, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.04524853825569153, "acc": 0.9854949116706848, "length": 3.9994544982910156, "mode": "train", "epoch": 47}
{"loss": 0.136802539229393, "acc": 0.9558593034744263, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.04646705836057663, "acc": 0.9849004745483398, "length": 3.9996485710144043, "mode": "train", "epoch": 48}
{"loss": 0.14873358607292175, "acc": 0.9613280892372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.040108781307935715, "acc": 0.9907242655754089, "length": 3.999547243118286, "mode": "train", "epoch": 49}
{"loss": 0.13041803240776062, "acc": 0.9660156965255737, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04374977573752403, "acc": 0.9870655536651611, "length": 3.9996745586395264, "mode": "train", "epoch": 50}
{"loss": 0.12638980150222778, "acc": 0.9718750715255737, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.039075642824172974, "acc": 0.9888124465942383, "length": 3.99977707862854, "mode": "train", "epoch": 51}
{"loss": 0.13586916029453278, "acc": 0.966796875, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03507295250892639, "acc": 0.9907834529876709, "length": 3.9995577335357666, "mode": "train", "epoch": 52}
{"loss": 0.11666015535593033, "acc": 0.9740234017372131, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.031568173319101334, "acc": 0.9909785389900208, "length": 3.999755620956421, "mode": "train", "epoch": 53}
{"loss": 0.13941426575183868, "acc": 0.9714843034744263, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.033033959567546844, "acc": 0.9910998940467834, "length": 3.999866485595703, "mode": "train", "epoch": 54}
{"loss": 0.1490110158920288, "acc": 0.9687499403953552, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03561633452773094, "acc": 0.989956796169281, "length": 3.9998345375061035, "mode": "train", "epoch": 55}
{"loss": 0.1465146839618683, "acc": 0.9664062857627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.03611812740564346, "acc": 0.9903751611709595, "length": 3.9998092651367188, "mode": "train", "epoch": 56}
{"loss": 0.15170538425445557, "acc": 0.9681640267372131, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.041374992579221725, "acc": 0.9888728260993958, "length": 3.999791145324707, "mode": "train", "epoch": 57}
{"loss": 0.1378379762172699, "acc": 0.9697265028953552, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.04637130722403526, "acc": 0.9867686033248901, "length": 3.999769687652588, "mode": "train", "epoch": 58}
{"loss": 0.1509566456079483, "acc": 0.9660156965255737, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04408843815326691, "acc": 0.985265851020813, "length": 3.9997105598449707, "mode": "train", "epoch": 59}
{"loss": 0.12533876299858093, "acc": 0.9716797471046448, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.037183474749326706, "acc": 0.9888757467269897, "length": 3.9998583793640137, "mode": "train", "epoch": 60}
{"loss": 0.12173175811767578, "acc": 0.9712890982627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8006063103675842
