# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7117446660995483, "acc": 0.5152211785316467, "length": 2.76393461227417, "mode": "train", "epoch": 1}
{"loss": 0.698459804058075, "acc": 0.5097222328186035, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6991551518440247, "acc": 0.5189546942710876, "length": 1.056355357170105, "mode": "train", "epoch": 2}
{"loss": 0.6967730522155762, "acc": 0.5168402194976807, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6977185010910034, "acc": 0.519973635673523, "length": 1.0219258069992065, "mode": "train", "epoch": 3}
{"loss": 0.6986170411109924, "acc": 0.5249999761581421, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.699317216873169, "acc": 0.5122472643852234, "length": 1.0142130851745605, "mode": "train", "epoch": 4}
{"loss": 0.6974115371704102, "acc": 0.5147569179534912, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.697655975818634, "acc": 0.5319278836250305, "length": 1.0102057456970215, "mode": "train", "epoch": 5}
{"loss": 0.697858452796936, "acc": 0.5175347328186035, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6973967552185059, "acc": 0.5093345642089844, "length": 1.0080755949020386, "mode": "train", "epoch": 6}
{"loss": 0.6973702311515808, "acc": 0.5154513716697693, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6969258189201355, "acc": 0.5212382674217224, "length": 1.005996823310852, "mode": "train", "epoch": 7}
{"loss": 0.6962324976921082, "acc": 0.528124988079071, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6962780952453613, "acc": 0.5257612466812134, "length": 1.005172610282898, "mode": "train", "epoch": 8}
{"loss": 0.6970089673995972, "acc": 0.5090277194976807, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6965568661689758, "acc": 0.5219833850860596, "length": 1.0046107769012451, "mode": "train", "epoch": 9}
{"loss": 0.6967732310295105, "acc": 0.5201389193534851, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6969128251075745, "acc": 0.5128864049911499, "length": 1.0048643350601196, "mode": "train", "epoch": 10}
{"loss": 0.6968974471092224, "acc": 0.5168402194976807, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.697814404964447, "acc": 0.5240647792816162, "length": 1.00486159324646, "mode": "train", "epoch": 11}
{"loss": 0.6957306265830994, "acc": 0.528124988079071, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6949867010116577, "acc": 0.5386884808540344, "length": 1.004717230796814, "mode": "train", "epoch": 12}
{"loss": 0.6955109238624573, "acc": 0.5317708849906921, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6950725317001343, "acc": 0.5414801836013794, "length": 1.0100760459899902, "mode": "train", "epoch": 13}
{"loss": 0.6982563734054565, "acc": 0.5149306654930115, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6575530171394348, "acc": 0.6294119954109192, "length": 1.698684573173523, "mode": "train", "epoch": 14}
{"loss": 0.5963228940963745, "acc": 0.7085720896720886, "length": 2.465277671813965, "mode": "test", "epoch": 14}
{"loss": 0.5756311416625977, "acc": 0.6954120397567749, "length": 1.8931297063827515, "mode": "train", "epoch": 15}
{"loss": 0.5776724815368652, "acc": 0.7002170085906982, "length": 1.9409722089767456, "mode": "test", "epoch": 15}
{"loss": 0.5533342361450195, "acc": 0.7075532078742981, "length": 1.589256763458252, "mode": "train", "epoch": 16}
{"loss": 0.5683671832084656, "acc": 0.7103678584098816, "length": 1.6909722089767456, "mode": "test", "epoch": 16}
{"loss": 0.5453646183013916, "acc": 0.7240824103355408, "length": 1.661590814590454, "mode": "train", "epoch": 17}
{"loss": 0.5812280774116516, "acc": 0.7172362804412842, "length": 1.8125, "mode": "test", "epoch": 17}
{"loss": 0.5219398140907288, "acc": 0.752684473991394, "length": 2.200939893722534, "mode": "train", "epoch": 18}
{"loss": 0.506585419178009, "acc": 0.7808377146720886, "length": 2.274305582046509, "mode": "test", "epoch": 18}
{"loss": 0.49309641122817993, "acc": 0.7795931100845337, "length": 2.132681131362915, "mode": "train", "epoch": 19}
{"loss": 0.48330584168434143, "acc": 0.7838650345802307, "length": 1.7777777910232544, "mode": "test", "epoch": 19}
{"loss": 0.4750809073448181, "acc": 0.7904204726219177, "length": 2.0930209159851074, "mode": "train", "epoch": 20}
{"loss": 0.47214165329933167, "acc": 0.7841471433639526, "length": 1.7708333730697632, "mode": "test", "epoch": 20}
{"loss": 0.46305051445961, "acc": 0.7932777404785156, "length": 2.063267946243286, "mode": "train", "epoch": 21}
{"loss": 0.4479995369911194, "acc": 0.7953125238418579, "length": 2.027777671813965, "mode": "test", "epoch": 21}
{"loss": 0.43996864557266235, "acc": 0.8055242300033569, "length": 2.194746732711792, "mode": "train", "epoch": 22}
{"loss": 0.44930097460746765, "acc": 0.8055067658424377, "length": 2.0798611640930176, "mode": "test", "epoch": 22}
{"loss": 0.40607330203056335, "acc": 0.82999587059021, "length": 2.490776538848877, "mode": "train", "epoch": 23}
{"loss": 0.4009217619895935, "acc": 0.8384711742401123, "length": 2.756944417953491, "mode": "test", "epoch": 23}
{"loss": 0.37112367153167725, "acc": 0.8480994701385498, "length": 2.7795093059539795, "mode": "train", "epoch": 24}
{"loss": 0.358554482460022, "acc": 0.8554524779319763, "length": 2.538194417953491, "mode": "test", "epoch": 24}
{"loss": 0.33600500226020813, "acc": 0.8665971159934998, "length": 2.7739481925964355, "mode": "train", "epoch": 25}
{"loss": 0.32066819071769714, "acc": 0.8686144351959229, "length": 2.4861111640930176, "mode": "test", "epoch": 25}
{"loss": 0.31212711334228516, "acc": 0.8789923787117004, "length": 2.7260725498199463, "mode": "train", "epoch": 26}
{"loss": 0.3306889533996582, "acc": 0.8662434816360474, "length": 2.440972328186035, "mode": "test", "epoch": 26}
{"loss": 0.3029991090297699, "acc": 0.8813904523849487, "length": 2.669373035430908, "mode": "train", "epoch": 27}
{"loss": 0.30275222659111023, "acc": 0.8711967468261719, "length": 2.538194417953491, "mode": "test", "epoch": 27}
{"loss": 0.28802868723869324, "acc": 0.8873633146286011, "length": 2.754307746887207, "mode": "train", "epoch": 28}
{"loss": 0.30583128333091736, "acc": 0.8707899451255798, "length": 2.6076388359069824, "mode": "test", "epoch": 28}
{"loss": 0.27810797095298767, "acc": 0.8955518007278442, "length": 2.7171971797943115, "mode": "train", "epoch": 29}
{"loss": 0.2906635105609894, "acc": 0.8783094882965088, "length": 2.5833332538604736, "mode": "test", "epoch": 29}
{"loss": 0.2774747610092163, "acc": 0.8928987979888916, "length": 2.6837308406829834, "mode": "train", "epoch": 30}
{"loss": 0.2801647484302521, "acc": 0.8816732168197632, "length": 2.538194417953491, "mode": "test", "epoch": 30}
{"loss": 0.26940953731536865, "acc": 0.8974981904029846, "length": 2.721651315689087, "mode": "train", "epoch": 31}
{"loss": 0.29249879717826843, "acc": 0.8868760466575623, "length": 2.590277671813965, "mode": "test", "epoch": 31}
{"loss": 0.2552487850189209, "acc": 0.9034194946289062, "length": 2.7572519779205322, "mode": "train", "epoch": 32}
{"loss": 0.27166101336479187, "acc": 0.8913954496383667, "length": 2.534722328186035, "mode": "test", "epoch": 32}
{"loss": 0.24957120418548584, "acc": 0.9061218500137329, "length": 2.822019100189209, "mode": "train", "epoch": 33}
{"loss": 0.2659759819507599, "acc": 0.9019911289215088, "length": 2.6979167461395264, "mode": "test", "epoch": 33}
{"loss": 0.24376645684242249, "acc": 0.9068729281425476, "length": 2.816725730895996, "mode": "train", "epoch": 34}
{"loss": 0.2622021734714508, "acc": 0.8971571326255798, "length": 2.6354167461395264, "mode": "test", "epoch": 34}
{"loss": 0.23989978432655334, "acc": 0.9117253422737122, "length": 2.953077793121338, "mode": "train", "epoch": 35}
{"loss": 0.26087313890457153, "acc": 0.9040907621383667, "length": 2.694444417953491, "mode": "test", "epoch": 35}
{"loss": 0.23077809810638428, "acc": 0.9137124419212341, "length": 2.9751760959625244, "mode": "train", "epoch": 36}
{"loss": 0.25472185015678406, "acc": 0.9043023586273193, "length": 2.7951388359069824, "mode": "test", "epoch": 36}
{"loss": 0.22312718629837036, "acc": 0.9180576801300049, "length": 3.0208191871643066, "mode": "train", "epoch": 37}
{"loss": 0.24663928151130676, "acc": 0.9111491441726685, "length": 2.84375, "mode": "test", "epoch": 37}
{"loss": 0.2197820544242859, "acc": 0.9185904860496521, "length": 3.045884847640991, "mode": "train", "epoch": 38}
{"loss": 0.2367628961801529, "acc": 0.9153374433517456, "length": 2.878472328186035, "mode": "test", "epoch": 38}
{"loss": 0.2185254991054535, "acc": 0.9191734790802002, "length": 3.0083224773406982, "mode": "train", "epoch": 39}
{"loss": 0.23106013238430023, "acc": 0.9118217825889587, "length": 3.0138888359069824, "mode": "test", "epoch": 39}
{"loss": 0.20993927121162415, "acc": 0.92357337474823, "length": 3.100581645965576, "mode": "train", "epoch": 40}
{"loss": 0.23717856407165527, "acc": 0.9130805134773254, "length": 2.9236111640930176, "mode": "test", "epoch": 40}
{"loss": 0.20452825725078583, "acc": 0.9238259196281433, "length": 3.07153058052063, "mode": "train", "epoch": 41}
{"loss": 0.222874715924263, "acc": 0.9130696058273315, "length": 2.9513888359069824, "mode": "test", "epoch": 41}
{"loss": 0.20580869913101196, "acc": 0.9260078072547913, "length": 3.052380323410034, "mode": "train", "epoch": 42}
{"loss": 0.23259074985980988, "acc": 0.9107422232627869, "length": 2.993055582046509, "mode": "test", "epoch": 42}
{"loss": 0.20147466659545898, "acc": 0.9266579747200012, "length": 3.13260555267334, "mode": "train", "epoch": 43}
{"loss": 0.21685583889484406, "acc": 0.9187173843383789, "length": 2.944444417953491, "mode": "test", "epoch": 43}
{"loss": 0.19498908519744873, "acc": 0.9255122542381287, "length": 3.132791757583618, "mode": "train", "epoch": 44}
{"loss": 0.21634551882743835, "acc": 0.9235351085662842, "length": 3.059027671813965, "mode": "test", "epoch": 44}
{"loss": 0.19335076212882996, "acc": 0.9292994737625122, "length": 3.091433525085449, "mode": "train", "epoch": 45}
{"loss": 0.20780856907367706, "acc": 0.9229927062988281, "length": 2.9375, "mode": "test", "epoch": 45}
{"loss": 0.1899876445531845, "acc": 0.9292443990707397, "length": 3.1900861263275146, "mode": "train", "epoch": 46}
{"loss": 0.20550401508808136, "acc": 0.9282824397087097, "length": 3.055555582046509, "mode": "test", "epoch": 46}
{"loss": 0.18940827250480652, "acc": 0.9308791160583496, "length": 3.210684061050415, "mode": "train", "epoch": 47}
{"loss": 0.20840835571289062, "acc": 0.9261665344238281, "length": 2.9826388359069824, "mode": "test", "epoch": 47}
{"loss": 0.1770092248916626, "acc": 0.9350917935371399, "length": 3.212576150894165, "mode": "train", "epoch": 48}
{"loss": 0.21776072680950165, "acc": 0.9206977486610413, "length": 3.0833332538604736, "mode": "test", "epoch": 48}
{"loss": 0.17508485913276672, "acc": 0.936709463596344, "length": 3.3176462650299072, "mode": "train", "epoch": 49}
{"loss": 0.20553384721279144, "acc": 0.9273655414581299, "length": 2.993055582046509, "mode": "test", "epoch": 49}
{"loss": 0.16724805533885956, "acc": 0.9448038339614868, "length": 3.2210614681243896, "mode": "train", "epoch": 50}
{"loss": 0.19334836304187775, "acc": 0.9343696236610413, "length": 3.0833332538604736, "mode": "test", "epoch": 50}
{"loss": 0.15977461636066437, "acc": 0.9463256597518921, "length": 3.294070243835449, "mode": "train", "epoch": 51}
{"loss": 0.1784045696258545, "acc": 0.9420464634895325, "length": 3.0798611640930176, "mode": "test", "epoch": 51}
{"loss": 0.15620529651641846, "acc": 0.9492514729499817, "length": 3.2860472202301025, "mode": "train", "epoch": 52}
{"loss": 0.17133480310440063, "acc": 0.9411730170249939, "length": 3.0729167461395264, "mode": "test", "epoch": 52}
{"loss": 0.14359912276268005, "acc": 0.9520832300186157, "length": 3.332275629043579, "mode": "train", "epoch": 53}
{"loss": 0.17602947354316711, "acc": 0.9445202946662903, "length": 3.1423611640930176, "mode": "test", "epoch": 53}
{"loss": 0.13888071477413177, "acc": 0.956108808517456, "length": 3.298753261566162, "mode": "train", "epoch": 54}
{"loss": 0.1593625247478485, "acc": 0.9513563513755798, "length": 3.194444417953491, "mode": "test", "epoch": 54}
{"loss": 0.1361723244190216, "acc": 0.9567355513572693, "length": 3.3530874252319336, "mode": "train", "epoch": 55}
{"loss": 0.16426698863506317, "acc": 0.9480143785476685, "length": 3.1458332538604736, "mode": "test", "epoch": 55}
{"loss": 0.14451394975185394, "acc": 0.952309250831604, "length": 3.371767282485962, "mode": "train", "epoch": 56}
{"loss": 0.17862474918365479, "acc": 0.9376140236854553, "length": 3.305555582046509, "mode": "test", "epoch": 56}
{"loss": 0.1405346691608429, "acc": 0.9549278616905212, "length": 3.539777994155884, "mode": "train", "epoch": 57}
{"loss": 0.16654899716377258, "acc": 0.9442707896232605, "length": 3.315972328186035, "mode": "test", "epoch": 57}
{"loss": 0.14289243519306183, "acc": 0.9555196166038513, "length": 3.5012869834899902, "mode": "train", "epoch": 58}
{"loss": 0.1886770874261856, "acc": 0.939366340637207, "length": 3.4513888359069824, "mode": "test", "epoch": 58}
{"loss": 0.1304813027381897, "acc": 0.9597012996673584, "length": 3.6560444831848145, "mode": "train", "epoch": 59}
{"loss": 0.15743388235569, "acc": 0.9488769173622131, "length": 3.40625, "mode": "test", "epoch": 59}
{"loss": 0.1284695267677307, "acc": 0.9615812301635742, "length": 3.687647819519043, "mode": "train", "epoch": 60}
{"loss": 0.15166442096233368, "acc": 0.9527180790901184, "length": 3.4375, "mode": "test", "epoch": 60}
test accuracy: 0.8605658411979675
