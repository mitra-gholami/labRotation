# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7287421226501465, "acc": 0.5278784036636353, "length": 3.46795392036438, "mode": "train", "epoch": 1}
{"loss": 0.7016633152961731, "acc": 0.520312488079071, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6997490525245667, "acc": 0.5383211374282837, "length": 1.0569498538970947, "mode": "train", "epoch": 2}
{"loss": 0.701716423034668, "acc": 0.5112847089767456, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6976107358932495, "acc": 0.5363666415214539, "length": 1.0269293785095215, "mode": "train", "epoch": 3}
{"loss": 0.7022190690040588, "acc": 0.5230903029441833, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6980378031730652, "acc": 0.5356578230857849, "length": 1.0177435874938965, "mode": "train", "epoch": 4}
{"loss": 0.7018542885780334, "acc": 0.5201389193534851, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6982452273368835, "acc": 0.5395017266273499, "length": 1.0125097036361694, "mode": "train", "epoch": 5}
{"loss": 0.7021332383155823, "acc": 0.520312488079071, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6988223195075989, "acc": 0.5321320295333862, "length": 1.0092116594314575, "mode": "train", "epoch": 6}
{"loss": 0.7062535881996155, "acc": 0.5194444060325623, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6980724930763245, "acc": 0.5391015410423279, "length": 1.0068947076797485, "mode": "train", "epoch": 7}
{"loss": 0.7020439505577087, "acc": 0.5190972089767456, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6980531811714172, "acc": 0.5334028601646423, "length": 1.0058965682983398, "mode": "train", "epoch": 8}
{"loss": 0.7046996355056763, "acc": 0.5190972089767456, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6978515386581421, "acc": 0.5404932498931885, "length": 1.004744291305542, "mode": "train", "epoch": 9}
{"loss": 0.7007340788841248, "acc": 0.5175347328186035, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6981949806213379, "acc": 0.5354285836219788, "length": 1.0038155317306519, "mode": "train", "epoch": 10}
{"loss": 0.702836811542511, "acc": 0.5163195133209229, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6981240510940552, "acc": 0.5341693758964539, "length": 1.003077745437622, "mode": "train", "epoch": 11}
{"loss": 0.7008546590805054, "acc": 0.5112847089767456, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6970556974411011, "acc": 0.5412364602088928, "length": 1.0026763677597046, "mode": "train", "epoch": 12}
{"loss": 0.7017126083374023, "acc": 0.5230903029441833, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6964243054389954, "acc": 0.5424555540084839, "length": 1.0021305084228516, "mode": "train", "epoch": 13}
{"loss": 0.7013751864433289, "acc": 0.5112847089767456, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6972818970680237, "acc": 0.5390353798866272, "length": 1.001753568649292, "mode": "train", "epoch": 14}
{"loss": 0.7006293535232544, "acc": 0.5230903029441833, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.696225106716156, "acc": 0.5397322773933411, "length": 1.001503348350525, "mode": "train", "epoch": 15}
{"loss": 0.7017369270324707, "acc": 0.5128471851348877, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6958674788475037, "acc": 0.5390347838401794, "length": 1.001329779624939, "mode": "train", "epoch": 16}
{"loss": 0.7010836005210876, "acc": 0.5175347328186035, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6961166262626648, "acc": 0.5446035265922546, "length": 1.0011274814605713, "mode": "train", "epoch": 17}
{"loss": 0.7007058262825012, "acc": 0.528124988079071, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6956058740615845, "acc": 0.5406578183174133, "length": 1.000998616218567, "mode": "train", "epoch": 18}
{"loss": 0.7012667655944824, "acc": 0.5175347328186035, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.694567859172821, "acc": 0.5418782830238342, "length": 1.0008987188339233, "mode": "train", "epoch": 19}
{"loss": 0.7000722289085388, "acc": 0.5319444537162781, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.695349931716919, "acc": 0.5377032160758972, "length": 1.0007809400558472, "mode": "train", "epoch": 20}
{"loss": 0.7002573609352112, "acc": 0.5321180820465088, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6946243643760681, "acc": 0.5468125343322754, "length": 1.0006471872329712, "mode": "train", "epoch": 21}
{"loss": 0.7002031803131104, "acc": 0.5189236402511597, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6949387192726135, "acc": 0.5414145588874817, "length": 1.0005683898925781, "mode": "train", "epoch": 22}
{"loss": 0.700364887714386, "acc": 0.5246527194976807, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6947018504142761, "acc": 0.5435023307800293, "length": 1.0005090236663818, "mode": "train", "epoch": 23}
{"loss": 0.7004753351211548, "acc": 0.5258681178092957, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6938719749450684, "acc": 0.5458239912986755, "length": 1.000441074371338, "mode": "train", "epoch": 24}
{"loss": 0.6998838186264038, "acc": 0.534375011920929, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6945927143096924, "acc": 0.5457082390785217, "length": 1.0003901720046997, "mode": "train", "epoch": 25}
{"loss": 0.699573278427124, "acc": 0.5376735925674438, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.694535493850708, "acc": 0.5437344312667847, "length": 1.0004152059555054, "mode": "train", "epoch": 26}
{"loss": 0.6994943022727966, "acc": 0.5258681178092957, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6955299973487854, "acc": 0.5401395559310913, "length": 1.000321865081787, "mode": "train", "epoch": 27}
{"loss": 0.7009432911872864, "acc": 0.5258681178092957, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6944034099578857, "acc": 0.5425164699554443, "length": 1.000269889831543, "mode": "train", "epoch": 28}
{"loss": 0.6992990374565125, "acc": 0.5376735925674438, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6931710243225098, "acc": 0.550753116607666, "length": 1.000281572341919, "mode": "train", "epoch": 29}
{"loss": 0.7007924318313599, "acc": 0.5184028148651123, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6938655376434326, "acc": 0.5440827012062073, "length": 1.0001977682113647, "mode": "train", "epoch": 30}
{"loss": 0.699557900428772, "acc": 0.5312500596046448, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6928520798683167, "acc": 0.5448946356773376, "length": 1.0001869201660156, "mode": "train", "epoch": 31}
{"loss": 0.6996721625328064, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.693118155002594, "acc": 0.5502874851226807, "length": 1.000163197517395, "mode": "train", "epoch": 32}
{"loss": 0.6987639665603638, "acc": 0.5376735925674438, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6935625672340393, "acc": 0.5473306179046631, "length": 1.000179648399353, "mode": "train", "epoch": 33}
{"loss": 0.7001089453697205, "acc": 0.5427082777023315, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6929889917373657, "acc": 0.5493611693382263, "length": 1.0001220703125, "mode": "train", "epoch": 34}
{"loss": 0.7004036903381348, "acc": 0.5263888835906982, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6922339797019958, "acc": 0.5541175603866577, "length": 1.00011146068573, "mode": "train", "epoch": 35}
{"loss": 0.6998021602630615, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6924968361854553, "acc": 0.5508698225021362, "length": 1.0000970363616943, "mode": "train", "epoch": 36}
{"loss": 0.7002623677253723, "acc": 0.5369791984558105, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6933205127716064, "acc": 0.5469258427619934, "length": 1.000106692314148, "mode": "train", "epoch": 37}
{"loss": 0.7009628415107727, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6921214461326599, "acc": 0.5528407692909241, "length": 1.0000938177108765, "mode": "train", "epoch": 38}
{"loss": 0.7006771564483643, "acc": 0.5401041507720947, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6925402283668518, "acc": 0.5510435700416565, "length": 1.000069260597229, "mode": "train", "epoch": 39}
{"loss": 0.7002455592155457, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.692395031452179, "acc": 0.5526682734489441, "length": 1.0000584125518799, "mode": "train", "epoch": 40}
{"loss": 0.6988880038261414, "acc": 0.546006977558136, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6930698752403259, "acc": 0.5476219654083252, "length": 1.0000638961791992, "mode": "train", "epoch": 41}
{"loss": 0.698597252368927, "acc": 0.5409723520278931, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6926897168159485, "acc": 0.5531899929046631, "length": 1.0000462532043457, "mode": "train", "epoch": 42}
{"loss": 0.6998120546340942, "acc": 0.5338541865348816, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6920555830001831, "acc": 0.5487815737724304, "length": 1.000057578086853, "mode": "train", "epoch": 43}
{"loss": 0.7003839612007141, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6924676299095154, "acc": 0.5487239956855774, "length": 1.0000413656234741, "mode": "train", "epoch": 44}
{"loss": 0.6986668705940247, "acc": 0.5427082777023315, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6923909187316895, "acc": 0.5483757853507996, "length": 1.000032663345337, "mode": "train", "epoch": 45}
{"loss": 0.7010448575019836, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6928611397743225, "acc": 0.5508120059967041, "length": 1.0000354051589966, "mode": "train", "epoch": 46}
{"loss": 0.699542760848999, "acc": 0.545138955116272, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6917933821678162, "acc": 0.5548142790794373, "length": 1.0000288486480713, "mode": "train", "epoch": 47}
{"loss": 0.6998153924942017, "acc": 0.5288195610046387, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6923815011978149, "acc": 0.5524941682815552, "length": 1.000023603439331, "mode": "train", "epoch": 48}
{"loss": 0.6999883651733398, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.693230390548706, "acc": 0.5492456555366516, "length": 1.0000224113464355, "mode": "train", "epoch": 49}
{"loss": 0.7009091973304749, "acc": 0.5413194894790649, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6923778653144836, "acc": 0.5476218461990356, "length": 1.0000170469284058, "mode": "train", "epoch": 50}
{"loss": 0.6998274326324463, "acc": 0.5319445133209229, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6916508078575134, "acc": 0.5543501973152161, "length": 1.0000182390213013, "mode": "train", "epoch": 51}
{"loss": 0.7007344365119934, "acc": 0.5232639312744141, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6915194392204285, "acc": 0.5534803867340088, "length": 1.0000174045562744, "mode": "train", "epoch": 52}
{"loss": 0.6986414790153503, "acc": 0.545138955116272, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6918262243270874, "acc": 0.5515080094337463, "length": 1.0000128746032715, "mode": "train", "epoch": 53}
{"loss": 0.6991396546363831, "acc": 0.5394096970558167, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6921328902244568, "acc": 0.5525522232055664, "length": 1.0000102519989014, "mode": "train", "epoch": 54}
{"loss": 0.7006387114524841, "acc": 0.5369791984558105, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6917706727981567, "acc": 0.5543503761291504, "length": 1.0000100135803223, "mode": "train", "epoch": 55}
{"loss": 0.6988958120346069, "acc": 0.5413194894790649, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6920060515403748, "acc": 0.5508120059967041, "length": 1.0000096559524536, "mode": "train", "epoch": 56}
{"loss": 0.7000461220741272, "acc": 0.5394096970558167, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6917997598648071, "acc": 0.5523202419281006, "length": 1.0000072717666626, "mode": "train", "epoch": 57}
{"loss": 0.6994504332542419, "acc": 0.545138955116272, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6919150352478027, "acc": 0.555510401725769, "length": 1.0000097751617432, "mode": "train", "epoch": 58}
{"loss": 0.6996161341667175, "acc": 0.5413194894790649, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6916167140007019, "acc": 0.5526102185249329, "length": 1.0000077486038208, "mode": "train", "epoch": 59}
{"loss": 0.6999214291572571, "acc": 0.545138955116272, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.692081093788147, "acc": 0.5535961985588074, "length": 1.0000065565109253, "mode": "train", "epoch": 60}
{"loss": 0.699055016040802, "acc": 0.5362847447395325, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.28189656138420105
