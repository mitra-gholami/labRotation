# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.6988369226455688, "acc": 0.5334866642951965, "length": 3.1452407836914062, "mode": "train", "epoch": 1}
{"loss": 0.6943012475967407, "acc": 0.5103515982627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.683643639087677, "acc": 0.5656328201293945, "length": 1.6887638568878174, "mode": "train", "epoch": 2}
{"loss": 0.6530956625938416, "acc": 0.6350830793380737, "length": 1.9453125, "mode": "test", "epoch": 2}
{"loss": 0.6066346168518066, "acc": 0.6772825717926025, "length": 2.9641904830932617, "mode": "train", "epoch": 3}
{"loss": 0.5986542701721191, "acc": 0.699749767780304, "length": 3.24609375, "mode": "test", "epoch": 3}
{"loss": 0.5453758835792542, "acc": 0.7373208999633789, "length": 3.255690097808838, "mode": "train", "epoch": 4}
{"loss": 0.5038475394248962, "acc": 0.7810119986534119, "length": 3.5390625, "mode": "test", "epoch": 4}
{"loss": 0.4815065264701843, "acc": 0.7848718762397766, "length": 3.4383227825164795, "mode": "train", "epoch": 5}
{"loss": 0.47106269001960754, "acc": 0.787689208984375, "length": 3.421875, "mode": "test", "epoch": 5}
{"loss": 0.44866976141929626, "acc": 0.7938256859779358, "length": 3.158130168914795, "mode": "train", "epoch": 6}
{"loss": 0.4708156883716583, "acc": 0.7986145615577698, "length": 3.5390625, "mode": "test", "epoch": 6}
{"loss": 0.42924100160598755, "acc": 0.8040618300437927, "length": 3.1673598289489746, "mode": "train", "epoch": 7}
{"loss": 0.4437796175479889, "acc": 0.8017578721046448, "length": 3.46875, "mode": "test", "epoch": 7}
{"loss": 0.4111446738243103, "acc": 0.8117548823356628, "length": 3.216647148132324, "mode": "train", "epoch": 8}
{"loss": 0.451694518327713, "acc": 0.8083740472793579, "length": 3.30078125, "mode": "test", "epoch": 8}
{"loss": 0.3953510522842407, "acc": 0.824049174785614, "length": 3.3571197986602783, "mode": "train", "epoch": 9}
{"loss": 0.42081376910209656, "acc": 0.8252868056297302, "length": 4.0625, "mode": "test", "epoch": 9}
{"loss": 0.37001901865005493, "acc": 0.8452554941177368, "length": 4.201058864593506, "mode": "train", "epoch": 10}
{"loss": 0.3749314844608307, "acc": 0.8554748296737671, "length": 4.91015625, "mode": "test", "epoch": 10}
{"loss": 0.348788857460022, "acc": 0.8574333190917969, "length": 4.729267597198486, "mode": "train", "epoch": 11}
{"loss": 0.36090487241744995, "acc": 0.8559082746505737, "length": 4.859375, "mode": "test", "epoch": 11}
{"loss": 0.32843104004859924, "acc": 0.8639029860496521, "length": 4.906637191772461, "mode": "train", "epoch": 12}
{"loss": 0.36187607049942017, "acc": 0.856671154499054, "length": 4.90625, "mode": "test", "epoch": 12}
{"loss": 0.31136199831962585, "acc": 0.8706717491149902, "length": 4.976926326751709, "mode": "train", "epoch": 13}
{"loss": 0.39704790711402893, "acc": 0.8332092761993408, "length": 4.93359375, "mode": "test", "epoch": 13}
{"loss": 0.2908996343612671, "acc": 0.8790207505226135, "length": 5.004979610443115, "mode": "train", "epoch": 14}
{"loss": 0.3382348120212555, "acc": 0.8736205101013184, "length": 5.0625, "mode": "test", "epoch": 14}
{"loss": 0.2608153820037842, "acc": 0.8984383344650269, "length": 5.092751502990723, "mode": "train", "epoch": 15}
{"loss": 0.3051984906196594, "acc": 0.8855041265487671, "length": 5.0625, "mode": "test", "epoch": 15}
{"loss": 0.23792047798633575, "acc": 0.9095941185951233, "length": 5.200254440307617, "mode": "train", "epoch": 16}
{"loss": 0.287301242351532, "acc": 0.891802966594696, "length": 5.140625, "mode": "test", "epoch": 16}
{"loss": 0.21767182648181915, "acc": 0.9176274538040161, "length": 5.253321170806885, "mode": "train", "epoch": 17}
{"loss": 0.3059684634208679, "acc": 0.8996155858039856, "length": 5.140625, "mode": "test", "epoch": 17}
{"loss": 0.21759556233882904, "acc": 0.9170748591423035, "length": 5.271740913391113, "mode": "train", "epoch": 18}
{"loss": 0.28291961550712585, "acc": 0.8833800554275513, "length": 5.19921875, "mode": "test", "epoch": 18}
{"loss": 0.19284211099147797, "acc": 0.9291819930076599, "length": 5.3045573234558105, "mode": "train", "epoch": 19}
{"loss": 0.2751173675060272, "acc": 0.8928711414337158, "length": 5.39453125, "mode": "test", "epoch": 19}
{"loss": 0.1739686131477356, "acc": 0.9373590350151062, "length": 5.433720588684082, "mode": "train", "epoch": 20}
{"loss": 0.2802690863609314, "acc": 0.8951112031936646, "length": 5.56640625, "mode": "test", "epoch": 20}
{"loss": 0.16639144718647003, "acc": 0.942649245262146, "length": 5.509232521057129, "mode": "train", "epoch": 21}
{"loss": 0.2776196002960205, "acc": 0.9096863269805908, "length": 5.6953125, "mode": "test", "epoch": 21}
{"loss": 0.15137334167957306, "acc": 0.9480932354927063, "length": 5.597653388977051, "mode": "train", "epoch": 22}
{"loss": 0.212384894490242, "acc": 0.9259825944900513, "length": 5.8359375, "mode": "test", "epoch": 22}
{"loss": 0.13718198239803314, "acc": 0.9555760025978088, "length": 5.784369468688965, "mode": "train", "epoch": 23}
{"loss": 0.261706680059433, "acc": 0.9208984375, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.12999442219734192, "acc": 0.9563823342323303, "length": 5.865415096282959, "mode": "train", "epoch": 24}
{"loss": 0.21066831052303314, "acc": 0.9250001311302185, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.12652607262134552, "acc": 0.9584173560142517, "length": 5.928845405578613, "mode": "train", "epoch": 25}
{"loss": 0.22752422094345093, "acc": 0.9240235686302185, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.12284806370735168, "acc": 0.9571210145950317, "length": 5.9549241065979, "mode": "train", "epoch": 26}
{"loss": 0.18928372859954834, "acc": 0.9390625357627869, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.11396290361881256, "acc": 0.9615160226821899, "length": 5.970480918884277, "mode": "train", "epoch": 27}
{"loss": 0.1782499998807907, "acc": 0.9482421875, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.09956026822328568, "acc": 0.968893826007843, "length": 5.97231912612915, "mode": "train", "epoch": 28}
{"loss": 0.15672796964645386, "acc": 0.9486327767372131, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.08607766777276993, "acc": 0.9738762974739075, "length": 5.980868816375732, "mode": "train", "epoch": 29}
{"loss": 0.13921448588371277, "acc": 0.9556640982627869, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.08089784532785416, "acc": 0.9764180779457092, "length": 5.984347343444824, "mode": "train", "epoch": 30}
{"loss": 0.16300955414772034, "acc": 0.9548827409744263, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.07525380700826645, "acc": 0.979584813117981, "length": 5.981037139892578, "mode": "train", "epoch": 31}
{"loss": 0.14521637558937073, "acc": 0.9529296159744263, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.06979145109653473, "acc": 0.980750560760498, "length": 5.988218307495117, "mode": "train", "epoch": 32}
{"loss": 0.1295788735151291, "acc": 0.9607421159744263, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.06562720984220505, "acc": 0.9807876944541931, "length": 5.987095355987549, "mode": "train", "epoch": 33}
{"loss": 0.12300337851047516, "acc": 0.9693360328674316, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.05742819607257843, "acc": 0.9855049848556519, "length": 5.986983776092529, "mode": "train", "epoch": 34}
{"loss": 0.11194787919521332, "acc": 0.9671874642372131, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.05107993632555008, "acc": 0.987118124961853, "length": 5.990292072296143, "mode": "train", "epoch": 35}
{"loss": 0.13913358747959137, "acc": 0.9636718034744263, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.050830941647291183, "acc": 0.9885439276695251, "length": 5.9921770095825195, "mode": "train", "epoch": 36}
{"loss": 0.12326481938362122, "acc": 0.9652343392372131, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.045715346932411194, "acc": 0.9890373349189758, "length": 5.993638515472412, "mode": "train", "epoch": 37}
{"loss": 0.1311139017343521, "acc": 0.9671874642372131, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.043074678629636765, "acc": 0.9914469122886658, "length": 5.9943413734436035, "mode": "train", "epoch": 38}
{"loss": 0.09758277982473373, "acc": 0.9748047590255737, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.04113449901342392, "acc": 0.9912818074226379, "length": 5.99502420425415, "mode": "train", "epoch": 39}
{"loss": 0.1155908927321434, "acc": 0.9695311784744263, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.04900283366441727, "acc": 0.9879059791564941, "length": 5.995823860168457, "mode": "train", "epoch": 40}
{"loss": 0.113223135471344, "acc": 0.9625000357627869, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.0511513389647007, "acc": 0.9859855771064758, "length": 5.99602746963501, "mode": "train", "epoch": 41}
{"loss": 0.11889781802892685, "acc": 0.9621094465255737, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.045995380729436874, "acc": 0.9872106909751892, "length": 5.995234489440918, "mode": "train", "epoch": 42}
{"loss": 0.09519369900226593, "acc": 0.9749999642372131, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.04301963374018669, "acc": 0.9893428683280945, "length": 5.996814250946045, "mode": "train", "epoch": 43}
{"loss": 0.12196852266788483, "acc": 0.9705077409744263, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.03919950872659683, "acc": 0.9914517998695374, "length": 5.997295379638672, "mode": "train", "epoch": 44}
{"loss": 0.10206693410873413, "acc": 0.9781250357627869, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.04276501014828682, "acc": 0.9925739169120789, "length": 5.997701644897461, "mode": "train", "epoch": 45}
{"loss": 0.15815132856369019, "acc": 0.9656249284744263, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.04222097992897034, "acc": 0.9913234114646912, "length": 5.996570110321045, "mode": "train", "epoch": 46}
{"loss": 0.0990770235657692, "acc": 0.9794921875, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.034185171127319336, "acc": 0.9934542775154114, "length": 5.997885227203369, "mode": "train", "epoch": 47}
{"loss": 0.13649842143058777, "acc": 0.9736327528953552, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.0402001328766346, "acc": 0.9905830025672913, "length": 5.997631549835205, "mode": "train", "epoch": 48}
{"loss": 0.1122235655784607, "acc": 0.9703125357627869, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.04399506002664566, "acc": 0.988487720489502, "length": 5.9982991218566895, "mode": "train", "epoch": 49}
{"loss": 0.10443441569805145, "acc": 0.9740234017372131, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.03130423277616501, "acc": 0.9943288564682007, "length": 5.997976779937744, "mode": "train", "epoch": 50}
{"loss": 0.06801575422286987, "acc": 0.9896484017372131, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.023183932527899742, "acc": 0.9973532557487488, "length": 5.9969329833984375, "mode": "train", "epoch": 51}
{"loss": 0.067018061876297, "acc": 0.9865235090255737, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.023206496611237526, "acc": 0.9957541823387146, "length": 5.998475074768066, "mode": "train", "epoch": 52}
{"loss": 0.08039744943380356, "acc": 0.9810547232627869, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.02017129957675934, "acc": 0.9976869821548462, "length": 5.9986748695373535, "mode": "train", "epoch": 53}
{"loss": 0.06594009697437286, "acc": 0.9886718392372131, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.018615223467350006, "acc": 0.9988052845001221, "length": 5.998932361602783, "mode": "train", "epoch": 54}
{"loss": 0.061951618641614914, "acc": 0.9876952767372131, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.017243633046746254, "acc": 0.9988617300987244, "length": 5.998889446258545, "mode": "train", "epoch": 55}
{"loss": 0.05872201919555664, "acc": 0.9859375357627869, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.015939701348543167, "acc": 0.9990114569664001, "length": 5.997766494750977, "mode": "train", "epoch": 56}
{"loss": 0.054552190005779266, "acc": 0.9876952767372131, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.01733051799237728, "acc": 0.9988711476325989, "length": 5.999340534210205, "mode": "train", "epoch": 57}
{"loss": 0.05940691754221916, "acc": 0.9857421517372131, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.01724223606288433, "acc": 0.9989829659461975, "length": 5.9991350173950195, "mode": "train", "epoch": 58}
{"loss": 0.0697091817855835, "acc": 0.9847655892372131, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.016784587875008583, "acc": 0.9981700778007507, "length": 5.999349117279053, "mode": "train", "epoch": 59}
{"loss": 0.045264698565006256, "acc": 0.9898437857627869, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.019809667021036148, "acc": 0.9977645874023438, "length": 5.999449253082275, "mode": "train", "epoch": 60}
{"loss": 0.06379030644893646, "acc": 0.9832030534744263, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.7674999833106995
