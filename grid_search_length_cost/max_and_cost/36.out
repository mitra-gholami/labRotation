# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7150434255599976, "acc": 0.531024158000946, "length": 2.2614974975585938, "mode": "train", "epoch": 1}
{"loss": 0.7046516537666321, "acc": 0.5190972685813904, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7005788087844849, "acc": 0.5481226444244385, "length": 1.0352905988693237, "mode": "train", "epoch": 2}
{"loss": 0.7014325261116028, "acc": 0.5309028029441833, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6986498236656189, "acc": 0.5490564107894897, "length": 1.0134438276290894, "mode": "train", "epoch": 3}
{"loss": 0.7030808329582214, "acc": 0.5189236402511597, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6984577775001526, "acc": 0.5447606444358826, "length": 1.0089036226272583, "mode": "train", "epoch": 4}
{"loss": 0.7039187550544739, "acc": 0.512499988079071, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6987133622169495, "acc": 0.5422657132148743, "length": 1.0060189962387085, "mode": "train", "epoch": 5}
{"loss": 0.7034962177276611, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6985644698143005, "acc": 0.541388988494873, "length": 1.0045350790023804, "mode": "train", "epoch": 6}
{"loss": 0.703387975692749, "acc": 0.5039930939674377, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6985164880752563, "acc": 0.5439516305923462, "length": 1.0035241842269897, "mode": "train", "epoch": 7}
{"loss": 0.7038267254829407, "acc": 0.5201388597488403, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6986569166183472, "acc": 0.5485144257545471, "length": 1.002734899520874, "mode": "train", "epoch": 8}
{"loss": 0.702496349811554, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6978529691696167, "acc": 0.5463419556617737, "length": 1.0023443698883057, "mode": "train", "epoch": 9}
{"loss": 0.700271725654602, "acc": 0.5309028029441833, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6979179978370667, "acc": 0.5434461832046509, "length": 1.0017393827438354, "mode": "train", "epoch": 10}
{"loss": 0.7040929794311523, "acc": 0.5270833373069763, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6976537108421326, "acc": 0.5497730374336243, "length": 1.001443862915039, "mode": "train", "epoch": 11}
{"loss": 0.7013402581214905, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6987941861152649, "acc": 0.5503367185592651, "length": 1.0012223720550537, "mode": "train", "epoch": 12}
{"loss": 0.7018072605133057, "acc": 0.5309028029441833, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6972178816795349, "acc": 0.5451528429985046, "length": 1.0011054277420044, "mode": "train", "epoch": 13}
{"loss": 0.7011401057243347, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6968366503715515, "acc": 0.5478920340538025, "length": 1.000902533531189, "mode": "train", "epoch": 14}
{"loss": 0.7004525065422058, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6974412798881531, "acc": 0.5431598424911499, "length": 1.0008063316345215, "mode": "train", "epoch": 15}
{"loss": 0.7027537226676941, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6973500847816467, "acc": 0.5484042167663574, "length": 1.0006470680236816, "mode": "train", "epoch": 16}
{"loss": 0.7023323178291321, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6975973844528198, "acc": 0.5552433729171753, "length": 1.0005658864974976, "mode": "train", "epoch": 17}
{"loss": 0.7027756571769714, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6978095769882202, "acc": 0.5502274632453918, "length": 1.0005043745040894, "mode": "train", "epoch": 18}
{"loss": 0.7051957249641418, "acc": 0.5039930939674377, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6963858008384705, "acc": 0.5479477643966675, "length": 1.0004194974899292, "mode": "train", "epoch": 19}
{"loss": 0.6987830400466919, "acc": 0.5309028029441833, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.697460949420929, "acc": 0.5507405996322632, "length": 1.000375509262085, "mode": "train", "epoch": 20}
{"loss": 0.6996080875396729, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6968594193458557, "acc": 0.5432150959968567, "length": 1.0003478527069092, "mode": "train", "epoch": 21}
{"loss": 0.7014151215553284, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6956418752670288, "acc": 0.5539339184761047, "length": 1.0003091096878052, "mode": "train", "epoch": 22}
{"loss": 0.7005229592323303, "acc": 0.5201388597488403, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6959822177886963, "acc": 0.5484602451324463, "length": 1.0002766847610474, "mode": "train", "epoch": 23}
{"loss": 0.6983325481414795, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6958266496658325, "acc": 0.5498276352882385, "length": 1.0002614259719849, "mode": "train", "epoch": 24}
{"loss": 0.7007378935813904, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6955220699310303, "acc": 0.5480042695999146, "length": 1.0002235174179077, "mode": "train", "epoch": 25}
{"loss": 0.7033079862594604, "acc": 0.5201388597488403, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6956444382667542, "acc": 0.5482326745986938, "length": 1.0002268552780151, "mode": "train", "epoch": 26}
{"loss": 0.6998326182365417, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.695199191570282, "acc": 0.5490295886993408, "length": 1.0002228021621704, "mode": "train", "epoch": 27}
{"loss": 0.7007719874382019, "acc": 0.5201388597488403, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6950197815895081, "acc": 0.5503422021865845, "length": 1.0001726150512695, "mode": "train", "epoch": 28}
{"loss": 0.6985765099525452, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6947477459907532, "acc": 0.5502852201461792, "length": 1.000160574913025, "mode": "train", "epoch": 29}
{"loss": 0.6997419595718384, "acc": 0.5270833373069763, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6942703723907471, "acc": 0.5534778833389282, "length": 1.0001516342163086, "mode": "train", "epoch": 30}
{"loss": 0.698174774646759, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6941949129104614, "acc": 0.5467508435249329, "length": 1.0001318454742432, "mode": "train", "epoch": 31}
{"loss": 0.7003713846206665, "acc": 0.5270833373069763, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6933779120445251, "acc": 0.5581526756286621, "length": 1.0001575946807861, "mode": "train", "epoch": 32}
{"loss": 0.7000476121902466, "acc": 0.5270833373069763, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6945983171463013, "acc": 0.5513684153556824, "length": 1.000113606452942, "mode": "train", "epoch": 33}
{"loss": 0.6988285183906555, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6931554079055786, "acc": 0.5524514317512512, "length": 1.0000889301300049, "mode": "train", "epoch": 34}
{"loss": 0.6978190541267395, "acc": 0.5286458730697632, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6952517628669739, "acc": 0.544241726398468, "length": 1.0000766515731812, "mode": "train", "epoch": 35}
{"loss": 0.7004218697547913, "acc": 0.5270833373069763, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6951317191123962, "acc": 0.5517103672027588, "length": 1.000070333480835, "mode": "train", "epoch": 36}
{"loss": 0.699275016784668, "acc": 0.515625, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6941041350364685, "acc": 0.5389965772628784, "length": 1.0000574588775635, "mode": "train", "epoch": 37}
{"loss": 0.6986597180366516, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6938027143478394, "acc": 0.5441277027130127, "length": 1.0000545978546143, "mode": "train", "epoch": 38}
{"loss": 0.6968096494674683, "acc": 0.515625, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6933348774909973, "acc": 0.5510833859443665, "length": 1.0000519752502441, "mode": "train", "epoch": 39}
{"loss": 0.6987160444259644, "acc": 0.515625, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.693004846572876, "acc": 0.548061728477478, "length": 1.0000413656234741, "mode": "train", "epoch": 40}
{"loss": 0.6957485675811768, "acc": 0.5201388597488403, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6931669116020203, "acc": 0.5503993630409241, "length": 1.0000362396240234, "mode": "train", "epoch": 41}
{"loss": 0.6971171498298645, "acc": 0.5270833373069763, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6928310990333557, "acc": 0.5503417253494263, "length": 1.0000383853912354, "mode": "train", "epoch": 42}
{"loss": 0.6977800726890564, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6934036016464233, "acc": 0.5569555163383484, "length": 1.0000395774841309, "mode": "train", "epoch": 43}
{"loss": 0.6958836913108826, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6920201182365417, "acc": 0.5484607219696045, "length": 1.000024676322937, "mode": "train", "epoch": 44}
{"loss": 0.6970549821853638, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.693103015422821, "acc": 0.5448688268661499, "length": 1.0000263452529907, "mode": "train", "epoch": 45}
{"loss": 0.6981341242790222, "acc": 0.5276041626930237, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6918594837188721, "acc": 0.5484038591384888, "length": 1.0000280141830444, "mode": "train", "epoch": 46}
{"loss": 0.6968243718147278, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6923873424530029, "acc": 0.5489737391471863, "length": 1.000023603439331, "mode": "train", "epoch": 47}
{"loss": 0.6979945302009583, "acc": 0.5173611640930176, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6934593319892883, "acc": 0.5432155728340149, "length": 1.0000190734863281, "mode": "train", "epoch": 48}
{"loss": 0.6995766162872314, "acc": 0.5142360925674438, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6923962235450745, "acc": 0.5472633838653564, "length": 1.0000147819519043, "mode": "train", "epoch": 49}
{"loss": 0.6954400539398193, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6923295855522156, "acc": 0.5480045080184937, "length": 1.0000145435333252, "mode": "train", "epoch": 50}
{"loss": 0.6953346133232117, "acc": 0.5373263955116272, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6921159625053406, "acc": 0.5476055145263672, "length": 1.0000123977661133, "mode": "train", "epoch": 51}
{"loss": 0.6946191191673279, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6913934946060181, "acc": 0.5523374080657959, "length": 1.0000147819519043, "mode": "train", "epoch": 52}
{"loss": 0.6987007260322571, "acc": 0.5218750238418579, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6912766695022583, "acc": 0.5494298934936523, "length": 1.0000085830688477, "mode": "train", "epoch": 53}
{"loss": 0.6973716020584106, "acc": 0.5270833373069763, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6917679309844971, "acc": 0.5547890067100525, "length": 1.0000193119049072, "mode": "train", "epoch": 54}
{"loss": 0.6954368948936462, "acc": 0.5340278148651123, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6917270421981812, "acc": 0.549315869808197, "length": 1.0000118017196655, "mode": "train", "epoch": 55}
{"loss": 0.6958946585655212, "acc": 0.5310764312744141, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6919490098953247, "acc": 0.5426453948020935, "length": 1.0000079870224, "mode": "train", "epoch": 56}
{"loss": 0.6998030543327332, "acc": 0.5218750238418579, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6928297877311707, "acc": 0.5498288869857788, "length": 1.0000076293945312, "mode": "train", "epoch": 57}
{"loss": 0.6966280341148376, "acc": 0.5276041626930237, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6924830079078674, "acc": 0.548517644405365, "length": 1.0000077486038208, "mode": "train", "epoch": 58}
{"loss": 0.6966267824172974, "acc": 0.5296876430511475, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6910615563392639, "acc": 0.5452110171318054, "length": 1.000004768371582, "mode": "train", "epoch": 59}
{"loss": 0.6967864632606506, "acc": 0.5387153029441833, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6916363835334778, "acc": 0.5427594184875488, "length": 1.0000057220458984, "mode": "train", "epoch": 60}
{"loss": 0.6946477890014648, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.28111109137535095
