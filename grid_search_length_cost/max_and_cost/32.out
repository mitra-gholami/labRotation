# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.700458824634552, "acc": 0.512962281703949, "length": 2.8054182529449463, "mode": "train", "epoch": 1}
{"loss": 0.6980265378952026, "acc": 0.48454856872558594, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.690875232219696, "acc": 0.5356432199478149, "length": 1.489456295967102, "mode": "train", "epoch": 2}
{"loss": 0.6771228909492493, "acc": 0.5708170533180237, "length": 1.8784722089767456, "mode": "test", "epoch": 2}
{"loss": 0.6249145269393921, "acc": 0.6863558292388916, "length": 2.4904444217681885, "mode": "train", "epoch": 3}
{"loss": 0.5432947278022766, "acc": 0.7687065601348877, "length": 2.9583332538604736, "mode": "test", "epoch": 3}
{"loss": 0.4932304918766022, "acc": 0.7808516621589661, "length": 3.053715944290161, "mode": "train", "epoch": 4}
{"loss": 0.4771184027194977, "acc": 0.813075065612793, "length": 3.1354167461395264, "mode": "test", "epoch": 4}
{"loss": 0.43802767992019653, "acc": 0.8102684617042542, "length": 3.194807291030884, "mode": "train", "epoch": 5}
{"loss": 0.4521741271018982, "acc": 0.8124566674232483, "length": 3.2083332538604736, "mode": "test", "epoch": 5}
{"loss": 0.4076300859451294, "acc": 0.8310452103614807, "length": 3.355799674987793, "mode": "train", "epoch": 6}
{"loss": 0.4532027840614319, "acc": 0.8189181685447693, "length": 3.3645832538604736, "mode": "test", "epoch": 6}
{"loss": 0.37874147295951843, "acc": 0.8371948003768921, "length": 3.545128345489502, "mode": "train", "epoch": 7}
{"loss": 0.44776684045791626, "acc": 0.8273979425430298, "length": 3.6458332538604736, "mode": "test", "epoch": 7}
{"loss": 0.35304734110832214, "acc": 0.8486015796661377, "length": 3.66564679145813, "mode": "train", "epoch": 8}
{"loss": 0.3939594328403473, "acc": 0.8315973281860352, "length": 3.6145832538604736, "mode": "test", "epoch": 8}
{"loss": 0.3208470940589905, "acc": 0.8652642369270325, "length": 3.6998744010925293, "mode": "train", "epoch": 9}
{"loss": 0.3373583257198334, "acc": 0.8642523884773254, "length": 3.6458332538604736, "mode": "test", "epoch": 9}
{"loss": 0.2951281666755676, "acc": 0.8813359141349792, "length": 3.7270805835723877, "mode": "train", "epoch": 10}
{"loss": 0.3352148234844208, "acc": 0.867268979549408, "length": 3.71875, "mode": "test", "epoch": 10}
{"loss": 0.27685752511024475, "acc": 0.8896883726119995, "length": 3.804377555847168, "mode": "train", "epoch": 11}
{"loss": 0.3126649558544159, "acc": 0.88006192445755, "length": 3.8854167461395264, "mode": "test", "epoch": 11}
{"loss": 0.2511199414730072, "acc": 0.9056802988052368, "length": 3.873354434967041, "mode": "train", "epoch": 12}
{"loss": 0.3127902150154114, "acc": 0.883306086063385, "length": 3.9895832538604736, "mode": "test", "epoch": 12}
{"loss": 0.23305495083332062, "acc": 0.9118772745132446, "length": 3.9249837398529053, "mode": "train", "epoch": 13}
{"loss": 0.283393532037735, "acc": 0.9069443941116333, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.22023431956768036, "acc": 0.9164081811904907, "length": 3.952364206314087, "mode": "train", "epoch": 14}
{"loss": 0.27128514647483826, "acc": 0.9100693464279175, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.20953936874866486, "acc": 0.9181551337242126, "length": 3.9570584297180176, "mode": "train", "epoch": 15}
{"loss": 0.2505309283733368, "acc": 0.9109374284744263, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.19938457012176514, "acc": 0.927060604095459, "length": 3.9760079383850098, "mode": "train", "epoch": 16}
{"loss": 0.24222908914089203, "acc": 0.9182291030883789, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.1805829256772995, "acc": 0.9367874264717102, "length": 3.984328031539917, "mode": "train", "epoch": 17}
{"loss": 0.20860208570957184, "acc": 0.9236111044883728, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.16965432465076447, "acc": 0.9393889904022217, "length": 3.982668876647949, "mode": "train", "epoch": 18}
{"loss": 0.21732482314109802, "acc": 0.9274305701255798, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.16322319209575653, "acc": 0.9403671026229858, "length": 3.9891459941864014, "mode": "train", "epoch": 19}
{"loss": 0.2207898199558258, "acc": 0.925347089767456, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.15303340554237366, "acc": 0.9459714293479919, "length": 3.9883430004119873, "mode": "train", "epoch": 20}
{"loss": 0.21070432662963867, "acc": 0.9331597089767456, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.13770467042922974, "acc": 0.9552067518234253, "length": 3.989004135131836, "mode": "train", "epoch": 21}
{"loss": 0.1863737404346466, "acc": 0.941319465637207, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.13077053427696228, "acc": 0.9572523236274719, "length": 3.9886159896850586, "mode": "train", "epoch": 22}
{"loss": 0.18566487729549408, "acc": 0.9375, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.12591621279716492, "acc": 0.9600203633308411, "length": 3.9912564754486084, "mode": "train", "epoch": 23}
{"loss": 0.1750354915857315, "acc": 0.9432292580604553, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.11963362991809845, "acc": 0.9579229354858398, "length": 3.9948408603668213, "mode": "train", "epoch": 24}
{"loss": 0.1759842187166214, "acc": 0.9371528625488281, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.11278294771909714, "acc": 0.9615252017974854, "length": 3.994882106781006, "mode": "train", "epoch": 25}
{"loss": 0.15763267874717712, "acc": 0.9475694298744202, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.11342332512140274, "acc": 0.9616813063621521, "length": 3.99630069732666, "mode": "train", "epoch": 26}
{"loss": 0.16055215895175934, "acc": 0.9470486044883728, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.10550015419721603, "acc": 0.9634189605712891, "length": 3.9960365295410156, "mode": "train", "epoch": 27}
{"loss": 0.15709227323532104, "acc": 0.9468749165534973, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.1030506119132042, "acc": 0.9648900628089905, "length": 3.997110605239868, "mode": "train", "epoch": 28}
{"loss": 0.1440151035785675, "acc": 0.9512152075767517, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.10104827582836151, "acc": 0.9657422304153442, "length": 3.99660062789917, "mode": "train", "epoch": 29}
{"loss": 0.1404462605714798, "acc": 0.9526041746139526, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.09845056384801865, "acc": 0.9670804738998413, "length": 3.9968109130859375, "mode": "train", "epoch": 30}
{"loss": 0.15258045494556427, "acc": 0.949131965637207, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.10038097202777863, "acc": 0.9646368026733398, "length": 3.9964144229888916, "mode": "train", "epoch": 31}
{"loss": 0.14575684070587158, "acc": 0.9472222924232483, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.09740763157606125, "acc": 0.9668971300125122, "length": 3.9959986209869385, "mode": "train", "epoch": 32}
{"loss": 0.14062827825546265, "acc": 0.9522569179534912, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.09861166775226593, "acc": 0.9649073481559753, "length": 3.99762225151062, "mode": "train", "epoch": 33}
{"loss": 0.13532337546348572, "acc": 0.9427083134651184, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.09731655567884445, "acc": 0.9655400514602661, "length": 3.9978208541870117, "mode": "train", "epoch": 34}
{"loss": 0.1451808363199234, "acc": 0.9517361521720886, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.08734331279993057, "acc": 0.9705181121826172, "length": 3.9963152408599854, "mode": "train", "epoch": 35}
{"loss": 0.13880442082881927, "acc": 0.9519094824790955, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.09400053322315216, "acc": 0.9672884345054626, "length": 3.9978854656219482, "mode": "train", "epoch": 36}
{"loss": 0.13009525835514069, "acc": 0.9571181535720825, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.09224896132946014, "acc": 0.9704170823097229, "length": 3.9980878829956055, "mode": "train", "epoch": 37}
{"loss": 0.13200274109840393, "acc": 0.9572916030883789, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.08812176436185837, "acc": 0.9706553816795349, "length": 3.9976282119750977, "mode": "train", "epoch": 38}
{"loss": 0.1341390311717987, "acc": 0.9545138478279114, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.10089088976383209, "acc": 0.9633088111877441, "length": 3.9983530044555664, "mode": "train", "epoch": 39}
{"loss": 0.14278669655323029, "acc": 0.9491322040557861, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.08585987985134125, "acc": 0.9711228609085083, "length": 3.99851131439209, "mode": "train", "epoch": 40}
{"loss": 0.11511828005313873, "acc": 0.9651041030883789, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.07426470518112183, "acc": 0.97691410779953, "length": 3.998074531555176, "mode": "train", "epoch": 41}
{"loss": 0.1159147173166275, "acc": 0.9631944298744202, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.06803623586893082, "acc": 0.9808142781257629, "length": 3.9986884593963623, "mode": "train", "epoch": 42}
{"loss": 0.1120169460773468, "acc": 0.9633679986000061, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.06812633574008942, "acc": 0.9785106778144836, "length": 3.999098300933838, "mode": "train", "epoch": 43}
{"loss": 0.10965732485055923, "acc": 0.9699652791023254, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06472031772136688, "acc": 0.9811163544654846, "length": 3.999161958694458, "mode": "train", "epoch": 44}
{"loss": 0.11730865389108658, "acc": 0.9652777910232544, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.05863291025161743, "acc": 0.9823936223983765, "length": 3.99920916557312, "mode": "train", "epoch": 45}
{"loss": 0.12496726959943771, "acc": 0.9638888835906982, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.061933644115924835, "acc": 0.981336772441864, "length": 3.9987998008728027, "mode": "train", "epoch": 46}
{"loss": 0.1055430918931961, "acc": 0.9701388478279114, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.061484865844249725, "acc": 0.981014609336853, "length": 3.999523639678955, "mode": "train", "epoch": 47}
{"loss": 0.13276296854019165, "acc": 0.9616318941116333, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.05572735145688057, "acc": 0.9831507802009583, "length": 3.999260663986206, "mode": "train", "epoch": 48}
{"loss": 0.11694518476724625, "acc": 0.9675347805023193, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.0540054552257061, "acc": 0.9833841919898987, "length": 3.9993374347686768, "mode": "train", "epoch": 49}
{"loss": 0.10174170136451721, "acc": 0.9703124165534973, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.057406503707170486, "acc": 0.982807993888855, "length": 3.999450922012329, "mode": "train", "epoch": 50}
{"loss": 0.1054699569940567, "acc": 0.9711804986000061, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.0547342523932457, "acc": 0.9826975464820862, "length": 3.9994351863861084, "mode": "train", "epoch": 51}
{"loss": 0.12519250810146332, "acc": 0.9666666388511658, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.05853871628642082, "acc": 0.9826915264129639, "length": 3.999490261077881, "mode": "train", "epoch": 52}
{"loss": 0.11373315006494522, "acc": 0.9661458134651184, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06569965183734894, "acc": 0.9792190790176392, "length": 3.9995484352111816, "mode": "train", "epoch": 53}
{"loss": 0.10398734360933304, "acc": 0.9694443941116333, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.05569965019822121, "acc": 0.9822980761528015, "length": 3.999748468399048, "mode": "train", "epoch": 54}
{"loss": 0.12705720961093903, "acc": 0.9640624523162842, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.04964153841137886, "acc": 0.9856606125831604, "length": 3.999718427658081, "mode": "train", "epoch": 55}
{"loss": 0.10668584704399109, "acc": 0.9723958969116211, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.04349576309323311, "acc": 0.9879199266433716, "length": 3.999615430831909, "mode": "train", "epoch": 56}
{"loss": 0.13139928877353668, "acc": 0.9682290554046631, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.04306946322321892, "acc": 0.9880944490432739, "length": 3.999659538269043, "mode": "train", "epoch": 57}
{"loss": 0.09733451157808304, "acc": 0.9767361879348755, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.04374751076102257, "acc": 0.988956093788147, "length": 3.999568462371826, "mode": "train", "epoch": 58}
{"loss": 0.10388481616973877, "acc": 0.9765625, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.038293804973363876, "acc": 0.9884461164474487, "length": 3.9997406005859375, "mode": "train", "epoch": 59}
{"loss": 0.14415693283081055, "acc": 0.9637153148651123, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.042025018483400345, "acc": 0.9883826375007629, "length": 3.9996559619903564, "mode": "train", "epoch": 60}
{"loss": 0.08932887762784958, "acc": 0.9784722924232483, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8129310011863708
