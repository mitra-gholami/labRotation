# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7355658411979675, "acc": 0.5393001437187195, "length": 4.706734657287598, "mode": "train", "epoch": 1}
{"loss": 0.6944019198417664, "acc": 0.540234386920929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6949928998947144, "acc": 0.5452320575714111, "length": 1.08975088596344, "mode": "train", "epoch": 2}
{"loss": 0.6942792534828186, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6949419975280762, "acc": 0.5394076108932495, "length": 1.038382887840271, "mode": "train", "epoch": 3}
{"loss": 0.691310465335846, "acc": 0.553515613079071, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6943904757499695, "acc": 0.5448392033576965, "length": 1.0246175527572632, "mode": "train", "epoch": 4}
{"loss": 0.692842960357666, "acc": 0.5677734017372131, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6931145191192627, "acc": 0.543479323387146, "length": 1.0170778036117554, "mode": "train", "epoch": 5}
{"loss": 0.695026159286499, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6925620436668396, "acc": 0.5452892780303955, "length": 1.0124733448028564, "mode": "train", "epoch": 6}
{"loss": 0.693059504032135, "acc": 0.5537109375, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6922480463981628, "acc": 0.552858293056488, "length": 1.0092647075653076, "mode": "train", "epoch": 7}
{"loss": 0.6921541094779968, "acc": 0.538867175579071, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6911083459854126, "acc": 0.551537811756134, "length": 1.0070891380310059, "mode": "train", "epoch": 8}
{"loss": 0.6925374269485474, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6918297410011292, "acc": 0.5564769506454468, "length": 1.0057134628295898, "mode": "train", "epoch": 9}
{"loss": 0.6904235482215881, "acc": 0.5712890028953552, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6911080479621887, "acc": 0.5596011281013489, "length": 1.0045857429504395, "mode": "train", "epoch": 10}
{"loss": 0.6903421878814697, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6890347003936768, "acc": 0.5598301887512207, "length": 1.004032850265503, "mode": "train", "epoch": 11}
{"loss": 0.6906549334526062, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6891651749610901, "acc": 0.5597800612449646, "length": 1.003303050994873, "mode": "train", "epoch": 12}
{"loss": 0.6909192800521851, "acc": 0.5707030892372131, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6865189671516418, "acc": 0.553705632686615, "length": 1.002901554107666, "mode": "train", "epoch": 13}
{"loss": 0.6884609460830688, "acc": 0.5595703125, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6869774460792542, "acc": 0.565394401550293, "length": 1.0024864673614502, "mode": "train", "epoch": 14}
{"loss": 0.6891880631446838, "acc": 0.5617188811302185, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6856110095977783, "acc": 0.5681524276733398, "length": 1.0021650791168213, "mode": "train", "epoch": 15}
{"loss": 0.6852098703384399, "acc": 0.569531261920929, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6850376129150391, "acc": 0.5575129389762878, "length": 1.0017679929733276, "mode": "train", "epoch": 16}
{"loss": 0.6917304396629333, "acc": 0.5576171875, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.683679461479187, "acc": 0.5701949596405029, "length": 1.0016779899597168, "mode": "train", "epoch": 17}
{"loss": 0.6878700852394104, "acc": 0.577929675579071, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6826010942459106, "acc": 0.5646915435791016, "length": 1.0013482570648193, "mode": "train", "epoch": 18}
{"loss": 0.6917257308959961, "acc": 0.5576171875, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6811789870262146, "acc": 0.5630075931549072, "length": 1.0012272596359253, "mode": "train", "epoch": 19}
{"loss": 0.68935626745224, "acc": 0.5656251311302185, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6805018782615662, "acc": 0.5694440007209778, "length": 1.0010433197021484, "mode": "train", "epoch": 20}
{"loss": 0.6865625977516174, "acc": 0.5640625357627869, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6807670593261719, "acc": 0.5639383792877197, "length": 1.0008915662765503, "mode": "train", "epoch": 21}
{"loss": 0.6875191926956177, "acc": 0.554882824420929, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6813132762908936, "acc": 0.5684973001480103, "length": 1.0008715391159058, "mode": "train", "epoch": 22}
{"loss": 0.6939264535903931, "acc": 0.542773425579071, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6810812950134277, "acc": 0.572128415107727, "length": 1.0007089376449585, "mode": "train", "epoch": 23}
{"loss": 0.6926360726356506, "acc": 0.5314452648162842, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6801837682723999, "acc": 0.5730099678039551, "length": 1.0006740093231201, "mode": "train", "epoch": 24}
{"loss": 0.6883468627929688, "acc": 0.5552734732627869, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6779736876487732, "acc": 0.5762296319007874, "length": 1.0005806684494019, "mode": "train", "epoch": 25}
{"loss": 0.6872533559799194, "acc": 0.5492187142372131, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6786082983016968, "acc": 0.570961594581604, "length": 1.0005030632019043, "mode": "train", "epoch": 26}
{"loss": 0.6864770650863647, "acc": 0.5687499642372131, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.679782509803772, "acc": 0.5749382972717285, "length": 1.0004758834838867, "mode": "train", "epoch": 27}
{"loss": 0.6906949281692505, "acc": 0.557421863079071, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6781701445579529, "acc": 0.5823754668235779, "length": 1.0004150867462158, "mode": "train", "epoch": 28}
{"loss": 0.6869516372680664, "acc": 0.555859386920929, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6790065169334412, "acc": 0.5706079006195068, "length": 1.0003384351730347, "mode": "train", "epoch": 29}
{"loss": 0.6888041496276855, "acc": 0.5492187142372131, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6781692504882812, "acc": 0.5770482420921326, "length": 1.0002799034118652, "mode": "train", "epoch": 30}
{"loss": 0.6871103644371033, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6781817674636841, "acc": 0.5745898485183716, "length": 1.000292181968689, "mode": "train", "epoch": 31}
{"loss": 0.6868911385536194, "acc": 0.555859386920929, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6786053776741028, "acc": 0.572598934173584, "length": 1.0002456903457642, "mode": "train", "epoch": 32}
{"loss": 0.6907457113265991, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6774314045906067, "acc": 0.576170802116394, "length": 1.000208854675293, "mode": "train", "epoch": 33}
{"loss": 0.6896735429763794, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6769958138465881, "acc": 0.577635645866394, "length": 1.0002034902572632, "mode": "train", "epoch": 34}
{"loss": 0.6892568469047546, "acc": 0.5492187142372131, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6769526600837708, "acc": 0.5744734406471252, "length": 1.0001567602157593, "mode": "train", "epoch": 35}
{"loss": 0.6879801154136658, "acc": 0.555859386920929, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6772658228874207, "acc": 0.5771077275276184, "length": 1.0001493692398071, "mode": "train", "epoch": 36}
{"loss": 0.6853463649749756, "acc": 0.5615234375, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6777375340461731, "acc": 0.5783372521400452, "length": 1.0001399517059326, "mode": "train", "epoch": 37}
{"loss": 0.6929521560668945, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6782254576683044, "acc": 0.5776930451393127, "length": 1.0001521110534668, "mode": "train", "epoch": 38}
{"loss": 0.6863844990730286, "acc": 0.554882824420929, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6772518754005432, "acc": 0.5754100680351257, "length": 1.0001060962677002, "mode": "train", "epoch": 39}
{"loss": 0.6869242787361145, "acc": 0.5621094107627869, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6761837601661682, "acc": 0.5778103470802307, "length": 1.0001097917556763, "mode": "train", "epoch": 40}
{"loss": 0.6875550746917725, "acc": 0.5552734732627869, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6764815449714661, "acc": 0.5778687596321106, "length": 1.0000849962234497, "mode": "train", "epoch": 41}
{"loss": 0.690958559513092, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6764847040176392, "acc": 0.576815128326416, "length": 1.0000720024108887, "mode": "train", "epoch": 42}
{"loss": 0.6865752339363098, "acc": 0.5552734732627869, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6778069734573364, "acc": 0.5774585604667664, "length": 1.0000642538070679, "mode": "train", "epoch": 43}
{"loss": 0.6907129883766174, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6769683957099915, "acc": 0.5796253085136414, "length": 1.0000673532485962, "mode": "train", "epoch": 44}
{"loss": 0.6882266402244568, "acc": 0.5552734732627869, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6759629249572754, "acc": 0.5772247910499573, "length": 1.0000522136688232, "mode": "train", "epoch": 45}
{"loss": 0.6919525265693665, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6762657165527344, "acc": 0.5786299109458923, "length": 1.0000743865966797, "mode": "train", "epoch": 46}
{"loss": 0.6878421306610107, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.67598557472229, "acc": 0.5714871883392334, "length": 1.0000370740890503, "mode": "train", "epoch": 47}
{"loss": 0.6880834698677063, "acc": 0.5552734732627869, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6760252714157104, "acc": 0.5806789994239807, "length": 1.000037670135498, "mode": "train", "epoch": 48}
{"loss": 0.6918020844459534, "acc": 0.554882824420929, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6772407293319702, "acc": 0.5826112031936646, "length": 1.0000288486480713, "mode": "train", "epoch": 49}
{"loss": 0.6877511739730835, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6756160259246826, "acc": 0.5750585198402405, "length": 1.0000306367874146, "mode": "train", "epoch": 50}
{"loss": 0.6915546655654907, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6766672730445862, "acc": 0.5793912410736084, "length": 1.0000309944152832, "mode": "train", "epoch": 51}
{"loss": 0.689005970954895, "acc": 0.5492187142372131, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6751911044120789, "acc": 0.580679178237915, "length": 1.000024437904358, "mode": "train", "epoch": 52}
{"loss": 0.6892310380935669, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6767688393592834, "acc": 0.5776932239532471, "length": 1.0000197887420654, "mode": "train", "epoch": 53}
{"loss": 0.689937174320221, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6766531467437744, "acc": 0.5768734812736511, "length": 1.0000172853469849, "mode": "train", "epoch": 54}
{"loss": 0.6890171766281128, "acc": 0.554882824420929, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6767006516456604, "acc": 0.5727751851081848, "length": 1.0000178813934326, "mode": "train", "epoch": 55}
{"loss": 0.6883042454719543, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6755133867263794, "acc": 0.5814402103424072, "length": 1.000014066696167, "mode": "train", "epoch": 56}
{"loss": 0.6900366544723511, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.677302896976471, "acc": 0.5767564177513123, "length": 1.0000196695327759, "mode": "train", "epoch": 57}
{"loss": 0.6899089813232422, "acc": 0.554882824420929, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6761165857315063, "acc": 0.5764051079750061, "length": 1.0000113248825073, "mode": "train", "epoch": 58}
{"loss": 0.6879388093948364, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6759476065635681, "acc": 0.5808547735214233, "length": 1.0000165700912476, "mode": "train", "epoch": 59}
{"loss": 0.6885713338851929, "acc": 0.548632800579071, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6753928661346436, "acc": 0.5793326497077942, "length": 1.0000123977661133, "mode": "train", "epoch": 60}
{"loss": 0.6897005438804626, "acc": 0.5542969107627869, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.2305000275373459
