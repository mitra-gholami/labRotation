# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7316182255744934, "acc": 0.4970521032810211, "length": 3.454908847808838, "mode": "train", "epoch": 1}
{"loss": 0.6990758180618286, "acc": 0.5361111164093018, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7057615518569946, "acc": 0.5128764510154724, "length": 1.0505695343017578, "mode": "train", "epoch": 2}
{"loss": 0.7029841542243958, "acc": 0.5277777910232544, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7034568786621094, "acc": 0.5173994302749634, "length": 1.024418592453003, "mode": "train", "epoch": 3}
{"loss": 0.7022900581359863, "acc": 0.5083333849906921, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7047507762908936, "acc": 0.5113927721977234, "length": 1.017015814781189, "mode": "train", "epoch": 4}
{"loss": 0.7007739543914795, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7033007740974426, "acc": 0.5042307376861572, "length": 1.0125776529312134, "mode": "train", "epoch": 5}
{"loss": 0.7003318071365356, "acc": 0.5434028506278992, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.7030971646308899, "acc": 0.5229501128196716, "length": 1.0100067853927612, "mode": "train", "epoch": 6}
{"loss": 0.701435387134552, "acc": 0.5293403267860413, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.7029234766960144, "acc": 0.5116133689880371, "length": 1.006796956062317, "mode": "train", "epoch": 7}
{"loss": 0.7007544636726379, "acc": 0.5276042222976685, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.7036839127540588, "acc": 0.5187934041023254, "length": 1.005167841911316, "mode": "train", "epoch": 8}
{"loss": 0.7023741602897644, "acc": 0.5201389193534851, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.7038068175315857, "acc": 0.503905713558197, "length": 1.0041455030441284, "mode": "train", "epoch": 9}
{"loss": 0.6994596123695374, "acc": 0.5480902194976807, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.7029812335968018, "acc": 0.5118139386177063, "length": 1.0036096572875977, "mode": "train", "epoch": 10}
{"loss": 0.7011842131614685, "acc": 0.5300347805023193, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.7022728323936462, "acc": 0.5116544961929321, "length": 1.0028769969940186, "mode": "train", "epoch": 11}
{"loss": 0.6993228793144226, "acc": 0.5482639074325562, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.702455997467041, "acc": 0.5211235284805298, "length": 1.0024529695510864, "mode": "train", "epoch": 12}
{"loss": 0.7027696371078491, "acc": 0.5097222328186035, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.70276939868927, "acc": 0.49855995178222656, "length": 1.002003788948059, "mode": "train", "epoch": 13}
{"loss": 0.7003629803657532, "acc": 0.5470486283302307, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.7019267678260803, "acc": 0.5181706547737122, "length": 1.0018343925476074, "mode": "train", "epoch": 14}
{"loss": 0.6993401646614075, "acc": 0.5348958373069763, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.7013981342315674, "acc": 0.5248314738273621, "length": 1.0015381574630737, "mode": "train", "epoch": 15}
{"loss": 0.7017114758491516, "acc": 0.5395833849906921, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.7012977004051208, "acc": 0.5168218612670898, "length": 1.0013223886489868, "mode": "train", "epoch": 16}
{"loss": 0.7005366086959839, "acc": 0.5284722447395325, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.7010685205459595, "acc": 0.5249999165534973, "length": 1.0011543035507202, "mode": "train", "epoch": 17}
{"loss": 0.7008562684059143, "acc": 0.5293403267860413, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.7008669972419739, "acc": 0.52458655834198, "length": 1.001031756401062, "mode": "train", "epoch": 18}
{"loss": 0.7008411884307861, "acc": 0.5199652910232544, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.7023162841796875, "acc": 0.5172853469848633, "length": 1.0008950233459473, "mode": "train", "epoch": 19}
{"loss": 0.6998922824859619, "acc": 0.5293403267860413, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.7004247903823853, "acc": 0.5193180441856384, "length": 1.000807762145996, "mode": "train", "epoch": 20}
{"loss": 0.7011898756027222, "acc": 0.5395833849906921, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.7006557583808899, "acc": 0.5274967551231384, "length": 1.0006576776504517, "mode": "train", "epoch": 21}
{"loss": 0.6999996900558472, "acc": 0.5340278148651123, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.7005546689033508, "acc": 0.5267382264137268, "length": 1.0005650520324707, "mode": "train", "epoch": 22}
{"loss": 0.7018514275550842, "acc": 0.5315971970558167, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6997374296188354, "acc": 0.5327118635177612, "length": 1.0005366802215576, "mode": "train", "epoch": 23}
{"loss": 0.7022179365158081, "acc": 0.5137153267860413, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6991555094718933, "acc": 0.5374715924263, "length": 1.0004287958145142, "mode": "train", "epoch": 24}
{"loss": 0.6991665959358215, "acc": 0.5366318821907043, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6991651654243469, "acc": 0.537467896938324, "length": 1.0003836154937744, "mode": "train", "epoch": 25}
{"loss": 0.7004468441009521, "acc": 0.5293403267860413, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6997795701026917, "acc": 0.517171323299408, "length": 1.0004264116287231, "mode": "train", "epoch": 26}
{"loss": 0.7026874423027039, "acc": 0.5190972089767456, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6995959877967834, "acc": 0.5355554819107056, "length": 1.0002758502960205, "mode": "train", "epoch": 27}
{"loss": 0.6998932957649231, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.698489248752594, "acc": 0.5389199256896973, "length": 1.0002774000167847, "mode": "train", "epoch": 28}
{"loss": 0.6997708082199097, "acc": 0.5361111164093018, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6976397037506104, "acc": 0.5473886132240295, "length": 1.0002316236495972, "mode": "train", "epoch": 29}
{"loss": 0.7018863558769226, "acc": 0.5413194894790649, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6974607706069946, "acc": 0.5428058505058289, "length": 1.000209927558899, "mode": "train", "epoch": 30}
{"loss": 0.7005411982536316, "acc": 0.5385416150093079, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6976975798606873, "acc": 0.5423423647880554, "length": 1.0001877546310425, "mode": "train", "epoch": 31}
{"loss": 0.7002924084663391, "acc": 0.5317708849906921, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6979988217353821, "acc": 0.5287123918533325, "length": 1.0001697540283203, "mode": "train", "epoch": 32}
{"loss": 0.7012454867362976, "acc": 0.5357639193534851, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6980045437812805, "acc": 0.5359036326408386, "length": 1.000158429145813, "mode": "train", "epoch": 33}
{"loss": 0.7004278302192688, "acc": 0.5279514193534851, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6979442834854126, "acc": 0.5383411645889282, "length": 1.0001213550567627, "mode": "train", "epoch": 34}
{"loss": 0.7021635174751282, "acc": 0.5253472328186035, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6964918375015259, "acc": 0.5453016757965088, "length": 1.000118374824524, "mode": "train", "epoch": 35}
{"loss": 0.7015030384063721, "acc": 0.5279514193534851, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6970363259315491, "acc": 0.5385146737098694, "length": 1.0001052618026733, "mode": "train", "epoch": 36}
{"loss": 0.701949417591095, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6962013840675354, "acc": 0.5464610457420349, "length": 1.0000921487808228, "mode": "train", "epoch": 37}
{"loss": 0.700262188911438, "acc": 0.5416666269302368, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6978188753128052, "acc": 0.5414150357246399, "length": 1.0000848770141602, "mode": "train", "epoch": 38}
{"loss": 0.7033328413963318, "acc": 0.5206596851348877, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6973028779029846, "acc": 0.5408927202224731, "length": 1.0000693798065186, "mode": "train", "epoch": 39}
{"loss": 0.7015119791030884, "acc": 0.5279514193534851, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6960654258728027, "acc": 0.5441993474960327, "length": 1.0000642538070679, "mode": "train", "epoch": 40}
{"loss": 0.703742504119873, "acc": 0.5168402194976807, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6963364481925964, "acc": 0.5451269149780273, "length": 1.000059723854065, "mode": "train", "epoch": 41}
{"loss": 0.7036187052726746, "acc": 0.5152778029441833, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6961383819580078, "acc": 0.5480272173881531, "length": 1.000049352645874, "mode": "train", "epoch": 42}
{"loss": 0.7018049359321594, "acc": 0.5402777194976807, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6956753730773926, "acc": 0.5487234592437744, "length": 1.0000447034835815, "mode": "train", "epoch": 43}
{"loss": 0.7027134299278259, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6956085562705994, "acc": 0.5502898693084717, "length": 1.0000396966934204, "mode": "train", "epoch": 44}
{"loss": 0.7017085552215576, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6958432197570801, "acc": 0.5375867486000061, "length": 1.0000548362731934, "mode": "train", "epoch": 45}
{"loss": 0.7016065716743469, "acc": 0.5276041626930237, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6958011984825134, "acc": 0.5446056127548218, "length": 1.0000298023223877, "mode": "train", "epoch": 46}
{"loss": 0.7034280300140381, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6952873468399048, "acc": 0.551217794418335, "length": 1.0000262260437012, "mode": "train", "epoch": 47}
{"loss": 0.7021001577377319, "acc": 0.5279514193534851, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6960055828094482, "acc": 0.540719211101532, "length": 1.0000227689743042, "mode": "train", "epoch": 48}
{"loss": 0.7019627690315247, "acc": 0.5279514193534851, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6948063969612122, "acc": 0.5490716695785522, "length": 1.000031590461731, "mode": "train", "epoch": 49}
{"loss": 0.7020248770713806, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6946633458137512, "acc": 0.5492458343505859, "length": 1.0000215768814087, "mode": "train", "epoch": 50}
{"loss": 0.7019713521003723, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6950814127922058, "acc": 0.5483757257461548, "length": 1.000017523765564, "mode": "train", "epoch": 51}
{"loss": 0.7025139331817627, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6953237652778625, "acc": 0.5475057363510132, "length": 1.0000205039978027, "mode": "train", "epoch": 52}
{"loss": 0.7022782564163208, "acc": 0.5385416150093079, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6952589154243469, "acc": 0.5451275706291199, "length": 1.000012755393982, "mode": "train", "epoch": 53}
{"loss": 0.702968418598175, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6944767832756042, "acc": 0.5410093069076538, "length": 1.0000115633010864, "mode": "train", "epoch": 54}
{"loss": 0.7040576338768005, "acc": 0.5303819179534912, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6943550109863281, "acc": 0.5468096137046814, "length": 1.0000373125076294, "mode": "train", "epoch": 55}
{"loss": 0.7024877667427063, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6951776742935181, "acc": 0.5444896221160889, "length": 1.000009298324585, "mode": "train", "epoch": 56}
{"loss": 0.7030977606773376, "acc": 0.5177083015441895, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6943076848983765, "acc": 0.5500579476356506, "length": 1.0000112056732178, "mode": "train", "epoch": 57}
{"loss": 0.7033146619796753, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.694491446018219, "acc": 0.5472738146781921, "length": 1.0000100135803223, "mode": "train", "epoch": 58}
{"loss": 0.701515257358551, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6946383118629456, "acc": 0.5477378368377686, "length": 1.000008463859558, "mode": "train", "epoch": 59}
{"loss": 0.7037505507469177, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.694271445274353, "acc": 0.545997679233551, "length": 1.0000059604644775, "mode": "train", "epoch": 60}
{"loss": 0.7025913000106812, "acc": 0.5236111283302307, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.3401723802089691
