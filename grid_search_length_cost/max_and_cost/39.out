# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7353965640068054, "acc": 0.5398821234703064, "length": 4.599436283111572, "mode": "train", "epoch": 1}
{"loss": 0.703603982925415, "acc": 0.5265624523162842, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6960079073905945, "acc": 0.5520127415657043, "length": 1.0557806491851807, "mode": "train", "epoch": 2}
{"loss": 0.7064124345779419, "acc": 0.5279297232627869, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6976702213287354, "acc": 0.5575108528137207, "length": 1.0285428762435913, "mode": "train", "epoch": 3}
{"loss": 0.7051321268081665, "acc": 0.5316405892372131, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.696367621421814, "acc": 0.5518384575843811, "length": 1.019670009613037, "mode": "train", "epoch": 4}
{"loss": 0.7031576633453369, "acc": 0.5250000357627869, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6961371898651123, "acc": 0.550230860710144, "length": 1.0136661529541016, "mode": "train", "epoch": 5}
{"loss": 0.7035669088363647, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6968420743942261, "acc": 0.5421153903007507, "length": 1.0105937719345093, "mode": "train", "epoch": 6}
{"loss": 0.7041040062904358, "acc": 0.5287109017372131, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6958826780319214, "acc": 0.5520609617233276, "length": 1.0084431171417236, "mode": "train", "epoch": 7}
{"loss": 0.7042154669761658, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.694777250289917, "acc": 0.5567929744720459, "length": 1.0071643590927124, "mode": "train", "epoch": 8}
{"loss": 0.7025537490844727, "acc": 0.5250000357627869, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6958252787590027, "acc": 0.5505478382110596, "length": 1.0053813457489014, "mode": "train", "epoch": 9}
{"loss": 0.705998957157135, "acc": 0.5230469107627869, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6955267190933228, "acc": 0.5581923723220825, "length": 1.0046813488006592, "mode": "train", "epoch": 10}
{"loss": 0.7018527984619141, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6940111517906189, "acc": 0.5563514232635498, "length": 1.0040216445922852, "mode": "train", "epoch": 11}
{"loss": 0.7024032473564148, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.694343090057373, "acc": 0.5557151436805725, "length": 1.0029630661010742, "mode": "train", "epoch": 12}
{"loss": 0.7036559581756592, "acc": 0.521289050579071, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6938103437423706, "acc": 0.5598441958427429, "length": 1.0027108192443848, "mode": "train", "epoch": 13}
{"loss": 0.7035618424415588, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6940691471099854, "acc": 0.5625176429748535, "length": 1.0021388530731201, "mode": "train", "epoch": 14}
{"loss": 0.7030375599861145, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6944166421890259, "acc": 0.5508235692977905, "length": 1.00180184841156, "mode": "train", "epoch": 15}
{"loss": 0.7041112184524536, "acc": 0.5316405892372131, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6943719983100891, "acc": 0.5583770275115967, "length": 1.001673698425293, "mode": "train", "epoch": 16}
{"loss": 0.7032577991485596, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6948434114456177, "acc": 0.5524821877479553, "length": 1.0013655424118042, "mode": "train", "epoch": 17}
{"loss": 0.7018733024597168, "acc": 0.5279297232627869, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6946360468864441, "acc": 0.5564848184585571, "length": 1.0012136697769165, "mode": "train", "epoch": 18}
{"loss": 0.7016543745994568, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6952232122421265, "acc": 0.5579027533531189, "length": 1.0010952949523926, "mode": "train", "epoch": 19}
{"loss": 0.7034094333648682, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6942825317382812, "acc": 0.5633352994918823, "length": 1.0009394884109497, "mode": "train", "epoch": 20}
{"loss": 0.7016593217849731, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6940110325813293, "acc": 0.5658738017082214, "length": 1.0008150339126587, "mode": "train", "epoch": 21}
{"loss": 0.7024279236793518, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6948184967041016, "acc": 0.551236629486084, "length": 1.000696063041687, "mode": "train", "epoch": 22}
{"loss": 0.7018736004829407, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6943293213844299, "acc": 0.5547242760658264, "length": 1.0006452798843384, "mode": "train", "epoch": 23}
{"loss": 0.7017112374305725, "acc": 0.5316405892372131, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6936130523681641, "acc": 0.5474011301994324, "length": 1.0005881786346436, "mode": "train", "epoch": 24}
{"loss": 0.7009460926055908, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6929457783699036, "acc": 0.5612136721611023, "length": 1.0005905628204346, "mode": "train", "epoch": 25}
{"loss": 0.7014958262443542, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6928873658180237, "acc": 0.5616288781166077, "length": 1.0004478693008423, "mode": "train", "epoch": 26}
{"loss": 0.7014245390892029, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6929614543914795, "acc": 0.5523605346679688, "length": 1.0003818273544312, "mode": "train", "epoch": 27}
{"loss": 0.7011029720306396, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6941505670547485, "acc": 0.5646380186080933, "length": 1.0003390312194824, "mode": "train", "epoch": 28}
{"loss": 0.7011412978172302, "acc": 0.530468761920929, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6930670142173767, "acc": 0.5581445693969727, "length": 1.000314712524414, "mode": "train", "epoch": 29}
{"loss": 0.701568603515625, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.694077730178833, "acc": 0.5561394691467285, "length": 1.0002542734146118, "mode": "train", "epoch": 30}
{"loss": 0.702051043510437, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6941389441490173, "acc": 0.5611546039581299, "length": 1.0002447366714478, "mode": "train", "epoch": 31}
{"loss": 0.7015029191970825, "acc": 0.5316405892372131, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6929892897605896, "acc": 0.5582619309425354, "length": 1.000226378440857, "mode": "train", "epoch": 32}
{"loss": 0.7007309198379517, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6924043893814087, "acc": 0.5561391711235046, "length": 1.000201940536499, "mode": "train", "epoch": 33}
{"loss": 0.7020131349563599, "acc": 0.5218749642372131, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6939143538475037, "acc": 0.5557243227958679, "length": 1.0001771450042725, "mode": "train", "epoch": 34}
{"loss": 0.7020033597946167, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6927425861358643, "acc": 0.5601523518562317, "length": 1.0001447200775146, "mode": "train", "epoch": 35}
{"loss": 0.7003514766693115, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6924068927764893, "acc": 0.5638718008995056, "length": 1.0001438856124878, "mode": "train", "epoch": 36}
{"loss": 0.6998392939567566, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6926566958427429, "acc": 0.5633410811424255, "length": 1.0001139640808105, "mode": "train", "epoch": 37}
{"loss": 0.7019387483596802, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6923139691352844, "acc": 0.5569058656692505, "length": 1.0001051425933838, "mode": "train", "epoch": 38}
{"loss": 0.7006963491439819, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6916508078575134, "acc": 0.5664699077606201, "length": 1.0000959634780884, "mode": "train", "epoch": 39}
{"loss": 0.6999963521957397, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6922442317008972, "acc": 0.5597993731498718, "length": 1.0000706911087036, "mode": "train", "epoch": 40}
{"loss": 0.7015785574913025, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6916773319244385, "acc": 0.5648162364959717, "length": 1.0000711679458618, "mode": "train", "epoch": 41}
{"loss": 0.6992262005805969, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6904732584953308, "acc": 0.5668829083442688, "length": 1.0000815391540527, "mode": "train", "epoch": 42}
{"loss": 0.7003067135810852, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6908327341079712, "acc": 0.5628095865249634, "length": 1.0000554323196411, "mode": "train", "epoch": 43}
{"loss": 0.699180006980896, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6902774572372437, "acc": 0.5649349689483643, "length": 1.000046730041504, "mode": "train", "epoch": 44}
{"loss": 0.7015117406845093, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6908484697341919, "acc": 0.5664699077606201, "length": 1.0000518560409546, "mode": "train", "epoch": 45}
{"loss": 0.6997014880180359, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6905143857002258, "acc": 0.5634592175483704, "length": 1.0000429153442383, "mode": "train", "epoch": 46}
{"loss": 0.6987680792808533, "acc": 0.5357422232627869, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6902428269386292, "acc": 0.5624556541442871, "length": 1.0000325441360474, "mode": "train", "epoch": 47}
{"loss": 0.6999591588973999, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6911914944648743, "acc": 0.56369549036026, "length": 1.0000311136245728, "mode": "train", "epoch": 48}
{"loss": 0.7002544403076172, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6900267601013184, "acc": 0.566410481929779, "length": 1.0000288486480713, "mode": "train", "epoch": 49}
{"loss": 0.6995919942855835, "acc": 0.5396484732627869, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.691649317741394, "acc": 0.5584415793418884, "length": 1.0000300407409668, "mode": "train", "epoch": 50}
{"loss": 0.7004467844963074, "acc": 0.5341796875, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6911700963973999, "acc": 0.5593860745429993, "length": 1.0000240802764893, "mode": "train", "epoch": 51}
{"loss": 0.7015516757965088, "acc": 0.5357422232627869, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.690118134021759, "acc": 0.5652300119400024, "length": 1.0000218152999878, "mode": "train", "epoch": 52}
{"loss": 0.6984193325042725, "acc": 0.5357422232627869, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6903634071350098, "acc": 0.5657023191452026, "length": 1.0000205039978027, "mode": "train", "epoch": 53}
{"loss": 0.7008103728294373, "acc": 0.5357422232627869, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6913005113601685, "acc": 0.5634590983390808, "length": 1.0000278949737549, "mode": "train", "epoch": 54}
{"loss": 0.6994892358779907, "acc": 0.5357422232627869, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.690718412399292, "acc": 0.5613352656364441, "length": 1.0000922679901123, "mode": "train", "epoch": 55}
{"loss": 0.7004907727241516, "acc": 0.5357422232627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6902554035186768, "acc": 0.5628098249435425, "length": 1.0000131130218506, "mode": "train", "epoch": 56}
{"loss": 0.6982551217079163, "acc": 0.5396484732627869, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.689507007598877, "acc": 0.5668240785598755, "length": 1.0000101327896118, "mode": "train", "epoch": 57}
{"loss": 0.7002986073493958, "acc": 0.5396484732627869, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6900322437286377, "acc": 0.5661156177520752, "length": 1.0000090599060059, "mode": "train", "epoch": 58}
{"loss": 0.7003186345100403, "acc": 0.5357422232627869, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6904584169387817, "acc": 0.5654662847518921, "length": 1.0000090599060059, "mode": "train", "epoch": 59}
{"loss": 0.7019913792610168, "acc": 0.516796886920929, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6898126006126404, "acc": 0.5668830275535583, "length": 1.0000098943710327, "mode": "train", "epoch": 60}
{"loss": 0.6981519460678101, "acc": 0.5396484732627869, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.2612903118133545
