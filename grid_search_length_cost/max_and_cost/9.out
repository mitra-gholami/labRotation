# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7000557780265808, "acc": 0.5256607532501221, "length": 3.5035006999969482, "mode": "train", "epoch": 1}
{"loss": 0.6964889168739319, "acc": 0.49746087193489075, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.675847589969635, "acc": 0.5816977024078369, "length": 2.037214756011963, "mode": "train", "epoch": 2}
{"loss": 0.6175536513328552, "acc": 0.7075501084327698, "length": 2.953125, "mode": "test", "epoch": 2}
{"loss": 0.5845999717712402, "acc": 0.7034022212028503, "length": 2.589956045150757, "mode": "train", "epoch": 3}
{"loss": 0.5437561869621277, "acc": 0.7197693586349487, "length": 2.875, "mode": "test", "epoch": 3}
{"loss": 0.5557906627655029, "acc": 0.7029986381530762, "length": 2.472797155380249, "mode": "train", "epoch": 4}
{"loss": 0.5419365763664246, "acc": 0.7098082900047302, "length": 2.54296875, "mode": "test", "epoch": 4}
{"loss": 0.5413088202476501, "acc": 0.7037782073020935, "length": 2.0117907524108887, "mode": "train", "epoch": 5}
{"loss": 0.5505197048187256, "acc": 0.7022460699081421, "length": 1.9921875, "mode": "test", "epoch": 5}
{"loss": 0.5325280427932739, "acc": 0.7112811207771301, "length": 1.9832768440246582, "mode": "train", "epoch": 6}
{"loss": 0.5479252934455872, "acc": 0.7048279047012329, "length": 1.984375, "mode": "test", "epoch": 6}
{"loss": 0.5126819610595703, "acc": 0.7294152975082397, "length": 2.5751798152923584, "mode": "train", "epoch": 7}
{"loss": 0.5513761043548584, "acc": 0.719226062297821, "length": 2.66796875, "mode": "test", "epoch": 7}
{"loss": 0.4775221049785614, "acc": 0.7704340815544128, "length": 3.1387462615966797, "mode": "train", "epoch": 8}
{"loss": 0.469746857881546, "acc": 0.795733630657196, "length": 3.140625, "mode": "test", "epoch": 8}
{"loss": 0.44950994849205017, "acc": 0.798391580581665, "length": 3.088656425476074, "mode": "train", "epoch": 9}
{"loss": 0.4397916793823242, "acc": 0.80584716796875, "length": 3.2265625, "mode": "test", "epoch": 9}
{"loss": 0.4294644892215729, "acc": 0.7997156381607056, "length": 3.098454475402832, "mode": "train", "epoch": 10}
{"loss": 0.4178985357284546, "acc": 0.811236560344696, "length": 3.23046875, "mode": "test", "epoch": 10}
{"loss": 0.4173666536808014, "acc": 0.8039533495903015, "length": 2.9197044372558594, "mode": "train", "epoch": 11}
{"loss": 0.4163958430290222, "acc": 0.8147643804550171, "length": 3.17578125, "mode": "test", "epoch": 11}
{"loss": 0.4110945165157318, "acc": 0.8061178922653198, "length": 2.8397843837738037, "mode": "train", "epoch": 12}
{"loss": 0.4095226228237152, "acc": 0.8160950541496277, "length": 3.140625, "mode": "test", "epoch": 12}
{"loss": 0.40150806307792664, "acc": 0.8115450739860535, "length": 2.884512424468994, "mode": "train", "epoch": 13}
{"loss": 0.4186457395553589, "acc": 0.8060058355331421, "length": 3.0859375, "mode": "test", "epoch": 13}
{"loss": 0.4038829207420349, "acc": 0.8064867258071899, "length": 2.889864206314087, "mode": "train", "epoch": 14}
{"loss": 0.42826229333877563, "acc": 0.800549328327179, "length": 3.1796875, "mode": "test", "epoch": 14}
{"loss": 0.3923875689506531, "acc": 0.8102689981460571, "length": 2.959275484085083, "mode": "train", "epoch": 15}
{"loss": 0.4253767430782318, "acc": 0.7987549304962158, "length": 3.1015625, "mode": "test", "epoch": 15}
{"loss": 0.3887788653373718, "acc": 0.8144254088401794, "length": 3.0929877758026123, "mode": "train", "epoch": 16}
{"loss": 0.43400508165359497, "acc": 0.8046935796737671, "length": 3.41015625, "mode": "test", "epoch": 16}
{"loss": 0.3804395794868469, "acc": 0.8180474042892456, "length": 3.2460505962371826, "mode": "train", "epoch": 17}
{"loss": 0.390710711479187, "acc": 0.8111755847930908, "length": 3.546875, "mode": "test", "epoch": 17}
{"loss": 0.3673641085624695, "acc": 0.8307914137840271, "length": 3.4525346755981445, "mode": "train", "epoch": 18}
{"loss": 0.3615625500679016, "acc": 0.8308655023574829, "length": 3.8671875, "mode": "test", "epoch": 18}
{"loss": 0.3604297935962677, "acc": 0.8305173516273499, "length": 3.4996094703674316, "mode": "train", "epoch": 19}
{"loss": 0.37489283084869385, "acc": 0.837005615234375, "length": 4.2890625, "mode": "test", "epoch": 19}
{"loss": 0.35122472047805786, "acc": 0.8388566374778748, "length": 3.6641979217529297, "mode": "train", "epoch": 20}
{"loss": 0.3710014224052429, "acc": 0.8405822515487671, "length": 4.15625, "mode": "test", "epoch": 20}
{"loss": 0.34781956672668457, "acc": 0.8412420749664307, "length": 3.695775270462036, "mode": "train", "epoch": 21}
{"loss": 0.3522200882434845, "acc": 0.844989001750946, "length": 3.92578125, "mode": "test", "epoch": 21}
{"loss": 0.33964747190475464, "acc": 0.8453819155693054, "length": 3.7686707973480225, "mode": "train", "epoch": 22}
{"loss": 0.348606139421463, "acc": 0.8515869975090027, "length": 4.05078125, "mode": "test", "epoch": 22}
{"loss": 0.3243824541568756, "acc": 0.8552592992782593, "length": 3.8711938858032227, "mode": "train", "epoch": 23}
{"loss": 0.36399784684181213, "acc": 0.852630615234375, "length": 4.47265625, "mode": "test", "epoch": 23}
{"loss": 0.3037166893482208, "acc": 0.8661627173423767, "length": 4.325037002563477, "mode": "train", "epoch": 24}
{"loss": 0.32858264446258545, "acc": 0.8639832139015198, "length": 5.15234375, "mode": "test", "epoch": 24}
{"loss": 0.2769169211387634, "acc": 0.8844795823097229, "length": 4.9395246505737305, "mode": "train", "epoch": 25}
{"loss": 0.31955236196517944, "acc": 0.881103515625, "length": 5.2890625, "mode": "test", "epoch": 25}
{"loss": 0.2651577591896057, "acc": 0.8920482993125916, "length": 5.004884719848633, "mode": "train", "epoch": 26}
{"loss": 0.3145904541015625, "acc": 0.8702636957168579, "length": 5.171875, "mode": "test", "epoch": 26}
{"loss": 0.2591648995876312, "acc": 0.8941114544868469, "length": 5.047512531280518, "mode": "train", "epoch": 27}
{"loss": 0.2870326340198517, "acc": 0.888409435749054, "length": 5.26953125, "mode": "test", "epoch": 27}
{"loss": 0.2393379956483841, "acc": 0.9120791554450989, "length": 5.096475124359131, "mode": "train", "epoch": 28}
{"loss": 0.28170496225357056, "acc": 0.8908569812774658, "length": 5.37109375, "mode": "test", "epoch": 28}
{"loss": 0.22898128628730774, "acc": 0.9128261208534241, "length": 5.217095851898193, "mode": "train", "epoch": 29}
{"loss": 0.2542268633842468, "acc": 0.901684582233429, "length": 5.34765625, "mode": "test", "epoch": 29}
{"loss": 0.22126616537570953, "acc": 0.9187590479850769, "length": 5.277863025665283, "mode": "train", "epoch": 30}
{"loss": 0.26400405168533325, "acc": 0.9021241068840027, "length": 5.35546875, "mode": "test", "epoch": 30}
{"loss": 0.20889608561992645, "acc": 0.9246119856834412, "length": 5.287502765655518, "mode": "train", "epoch": 31}
{"loss": 0.27086102962493896, "acc": 0.9030822515487671, "length": 5.4609375, "mode": "test", "epoch": 31}
{"loss": 0.20827075839042664, "acc": 0.9235344529151917, "length": 5.266149997711182, "mode": "train", "epoch": 32}
{"loss": 0.29185569286346436, "acc": 0.9012267589569092, "length": 5.4921875, "mode": "test", "epoch": 32}
{"loss": 0.20395685732364655, "acc": 0.9247996807098389, "length": 5.3070855140686035, "mode": "train", "epoch": 33}
{"loss": 0.24164271354675293, "acc": 0.913928210735321, "length": 5.359375, "mode": "test", "epoch": 33}
{"loss": 0.1863565444946289, "acc": 0.9307986497879028, "length": 5.37039041519165, "mode": "train", "epoch": 34}
{"loss": 0.21230757236480713, "acc": 0.9189941883087158, "length": 5.4609375, "mode": "test", "epoch": 34}
{"loss": 0.17123962938785553, "acc": 0.9348112940788269, "length": 5.391197681427002, "mode": "train", "epoch": 35}
{"loss": 0.2139367014169693, "acc": 0.9197876453399658, "length": 5.515625, "mode": "test", "epoch": 35}
{"loss": 0.16331355273723602, "acc": 0.936920166015625, "length": 5.449509620666504, "mode": "train", "epoch": 36}
{"loss": 0.21253974735736847, "acc": 0.9168152213096619, "length": 5.34765625, "mode": "test", "epoch": 36}
{"loss": 0.15243518352508545, "acc": 0.9435316920280457, "length": 5.374876499176025, "mode": "train", "epoch": 37}
{"loss": 0.2003820836544037, "acc": 0.9294555187225342, "length": 5.484375, "mode": "test", "epoch": 37}
{"loss": 0.1410326063632965, "acc": 0.949030876159668, "length": 5.38402795791626, "mode": "train", "epoch": 38}
{"loss": 0.1983414888381958, "acc": 0.9303039312362671, "length": 5.484375, "mode": "test", "epoch": 38}
{"loss": 0.13848067820072174, "acc": 0.9486245512962341, "length": 5.427127838134766, "mode": "train", "epoch": 39}
{"loss": 0.17675548791885376, "acc": 0.937481701374054, "length": 5.4765625, "mode": "test", "epoch": 39}
{"loss": 0.13250632584095, "acc": 0.9525416493415833, "length": 5.48837947845459, "mode": "train", "epoch": 40}
{"loss": 0.1906767040491104, "acc": 0.937701404094696, "length": 5.43359375, "mode": "test", "epoch": 40}
{"loss": 0.12422256916761398, "acc": 0.9580612182617188, "length": 5.462503910064697, "mode": "train", "epoch": 41}
{"loss": 0.1944267600774765, "acc": 0.9328247308731079, "length": 5.421875, "mode": "test", "epoch": 41}
{"loss": 0.12362975627183914, "acc": 0.9540718197822571, "length": 5.500494003295898, "mode": "train", "epoch": 42}
{"loss": 0.17739088833332062, "acc": 0.9349303841590881, "length": 5.4765625, "mode": "test", "epoch": 42}
{"loss": 0.11767344921827316, "acc": 0.9583410620689392, "length": 5.525866985321045, "mode": "train", "epoch": 43}
{"loss": 0.18411676585674286, "acc": 0.939923107624054, "length": 5.50390625, "mode": "test", "epoch": 43}
{"loss": 0.11285708844661713, "acc": 0.9605182409286499, "length": 5.490077018737793, "mode": "train", "epoch": 44}
{"loss": 0.18450523912906647, "acc": 0.9343749284744263, "length": 5.515625, "mode": "test", "epoch": 44}
{"loss": 0.10355842858552933, "acc": 0.9650731086730957, "length": 5.591793537139893, "mode": "train", "epoch": 45}
{"loss": 0.17649894952774048, "acc": 0.9421325922012329, "length": 5.6796875, "mode": "test", "epoch": 45}
{"loss": 0.1037665456533432, "acc": 0.9633750915527344, "length": 5.606264114379883, "mode": "train", "epoch": 46}
{"loss": 0.1613611876964569, "acc": 0.9492369890213013, "length": 5.62890625, "mode": "test", "epoch": 46}
{"loss": 0.11515133827924728, "acc": 0.9583907723426819, "length": 5.522679328918457, "mode": "train", "epoch": 47}
{"loss": 0.1657877266407013, "acc": 0.940539538860321, "length": 5.6015625, "mode": "test", "epoch": 47}
{"loss": 0.10046706348657608, "acc": 0.9634105563163757, "length": 5.537661075592041, "mode": "train", "epoch": 48}
{"loss": 0.1647954136133194, "acc": 0.9414001703262329, "length": 5.5859375, "mode": "test", "epoch": 48}
{"loss": 0.1045021116733551, "acc": 0.9623538255691528, "length": 5.576469421386719, "mode": "train", "epoch": 49}
{"loss": 0.19731955230236053, "acc": 0.9372192621231079, "length": 5.59375, "mode": "test", "epoch": 49}
{"loss": 0.09626421332359314, "acc": 0.9668251872062683, "length": 5.57938289642334, "mode": "train", "epoch": 50}
{"loss": 0.16547736525535583, "acc": 0.95147705078125, "length": 5.6015625, "mode": "test", "epoch": 50}
{"loss": 0.08846467733383179, "acc": 0.9687635898590088, "length": 5.629144191741943, "mode": "train", "epoch": 51}
{"loss": 0.16875043511390686, "acc": 0.9535279273986816, "length": 5.65234375, "mode": "test", "epoch": 51}
{"loss": 0.08768290281295776, "acc": 0.9704270958900452, "length": 5.637117385864258, "mode": "train", "epoch": 52}
{"loss": 0.16643789410591125, "acc": 0.9505310654640198, "length": 5.6640625, "mode": "test", "epoch": 52}
{"loss": 0.07927266508340836, "acc": 0.9727539420127869, "length": 5.645895481109619, "mode": "train", "epoch": 53}
{"loss": 0.1651042103767395, "acc": 0.954071044921875, "length": 5.71484375, "mode": "test", "epoch": 53}
{"loss": 0.07449940592050552, "acc": 0.9763026237487793, "length": 5.675173282623291, "mode": "train", "epoch": 54}
{"loss": 0.157439723610878, "acc": 0.956280529499054, "length": 5.70703125, "mode": "test", "epoch": 54}
{"loss": 0.07084596902132034, "acc": 0.9755327701568604, "length": 5.694075107574463, "mode": "train", "epoch": 55}
{"loss": 0.15977022051811218, "acc": 0.9550658464431763, "length": 5.70703125, "mode": "test", "epoch": 55}
{"loss": 0.07254768162965775, "acc": 0.9765290021896362, "length": 5.713547229766846, "mode": "train", "epoch": 56}
{"loss": 0.14220048487186432, "acc": 0.9566956162452698, "length": 5.67578125, "mode": "test", "epoch": 56}
{"loss": 0.06104831025004387, "acc": 0.9806725978851318, "length": 5.756026268005371, "mode": "train", "epoch": 57}
{"loss": 0.14092598855495453, "acc": 0.960894763469696, "length": 5.82421875, "mode": "test", "epoch": 57}
{"loss": 0.05698828771710396, "acc": 0.9816915392875671, "length": 5.771707534790039, "mode": "train", "epoch": 58}
{"loss": 0.13690364360809326, "acc": 0.9629029035568237, "length": 5.8046875, "mode": "test", "epoch": 58}
{"loss": 0.06282396614551544, "acc": 0.9798480272293091, "length": 5.738841533660889, "mode": "train", "epoch": 59}
{"loss": 0.14226776361465454, "acc": 0.9592468738555908, "length": 5.7265625, "mode": "test", "epoch": 59}
{"loss": 0.06635385006666183, "acc": 0.9775972366333008, "length": 5.74065637588501, "mode": "train", "epoch": 60}
{"loss": 0.20005230605602264, "acc": 0.952771008014679, "length": 5.80859375, "mode": "test", "epoch": 60}
test accuracy: 0.8118593692779541
