# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6992253065109253, "acc": 0.5423203110694885, "length": 2.3200602531433105, "mode": "train", "epoch": 1}
{"loss": 0.701271653175354, "acc": 0.5036458373069763, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6905809044837952, "acc": 0.5420349836349487, "length": 1.0526291131973267, "mode": "train", "epoch": 2}
{"loss": 0.6958796977996826, "acc": 0.5178819894790649, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6883347630500793, "acc": 0.5517873764038086, "length": 1.0152487754821777, "mode": "train", "epoch": 3}
{"loss": 0.6986958980560303, "acc": 0.5083333849906921, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6877778768539429, "acc": 0.5520330667495728, "length": 1.0113229751586914, "mode": "train", "epoch": 4}
{"loss": 0.6970596313476562, "acc": 0.5038194060325623, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6900656223297119, "acc": 0.5479357838630676, "length": 1.0111358165740967, "mode": "train", "epoch": 5}
{"loss": 0.6953026652336121, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.673943817615509, "acc": 0.585872232913971, "length": 1.3029674291610718, "mode": "train", "epoch": 6}
{"loss": 0.6229907274246216, "acc": 0.6730306148529053, "length": 1.90625, "mode": "test", "epoch": 6}
{"loss": 0.5844261646270752, "acc": 0.707275390625, "length": 1.7571543455123901, "mode": "train", "epoch": 7}
{"loss": 0.5783373713493347, "acc": 0.6957247853279114, "length": 1.8229166269302368, "mode": "test", "epoch": 7}
{"loss": 0.5595753192901611, "acc": 0.7047393321990967, "length": 1.653397560119629, "mode": "train", "epoch": 8}
{"loss": 0.573724627494812, "acc": 0.6934950351715088, "length": 1.8229166269302368, "mode": "test", "epoch": 8}
{"loss": 0.5557948350906372, "acc": 0.6999158263206482, "length": 1.5890787839889526, "mode": "train", "epoch": 9}
{"loss": 0.5691583752632141, "acc": 0.696723222732544, "length": 1.6701388359069824, "mode": "test", "epoch": 9}
{"loss": 0.5500251054763794, "acc": 0.7093195915222168, "length": 1.5586202144622803, "mode": "train", "epoch": 10}
{"loss": 0.5746567845344543, "acc": 0.6987956166267395, "length": 1.7708333730697632, "mode": "test", "epoch": 10}
{"loss": 0.5507681369781494, "acc": 0.7102959156036377, "length": 1.5524225234985352, "mode": "train", "epoch": 11}
{"loss": 0.5650164484977722, "acc": 0.6988335847854614, "length": 1.5868055820465088, "mode": "test", "epoch": 11}
{"loss": 0.5314214825630188, "acc": 0.7083315253257751, "length": 1.7075748443603516, "mode": "train", "epoch": 12}
{"loss": 0.5465604662895203, "acc": 0.7088541984558105, "length": 2.1388888359069824, "mode": "test", "epoch": 12}
{"loss": 0.517463207244873, "acc": 0.7280839085578918, "length": 1.9219965934753418, "mode": "train", "epoch": 13}
{"loss": 0.5283978581428528, "acc": 0.7429741621017456, "length": 2.618055582046509, "mode": "test", "epoch": 13}
{"loss": 0.5017232298851013, "acc": 0.7647834420204163, "length": 2.371091604232788, "mode": "train", "epoch": 14}
{"loss": 0.521635890007019, "acc": 0.7570475339889526, "length": 2.305555582046509, "mode": "test", "epoch": 14}
{"loss": 0.4750429093837738, "acc": 0.7813524007797241, "length": 2.2439072132110596, "mode": "train", "epoch": 15}
{"loss": 0.4977077841758728, "acc": 0.7785861492156982, "length": 2.378472328186035, "mode": "test", "epoch": 15}
{"loss": 0.4556705057621002, "acc": 0.8046995401382446, "length": 2.3121862411499023, "mode": "train", "epoch": 16}
{"loss": 0.49431779980659485, "acc": 0.7829481959342957, "length": 2.1458332538604736, "mode": "test", "epoch": 16}
{"loss": 0.4278464913368225, "acc": 0.8161765933036804, "length": 2.3871965408325195, "mode": "train", "epoch": 17}
{"loss": 0.4895886778831482, "acc": 0.7882053852081299, "length": 2.1875, "mode": "test", "epoch": 17}
{"loss": 0.4152127504348755, "acc": 0.8217434287071228, "length": 2.4545960426330566, "mode": "train", "epoch": 18}
{"loss": 0.47102832794189453, "acc": 0.7937771081924438, "length": 2.1388888359069824, "mode": "test", "epoch": 18}
{"loss": 0.39475640654563904, "acc": 0.824881911277771, "length": 2.52689266204834, "mode": "train", "epoch": 19}
{"loss": 0.4453381896018982, "acc": 0.7936903834342957, "length": 2.090277671813965, "mode": "test", "epoch": 19}
{"loss": 0.3677268326282501, "acc": 0.8391250967979431, "length": 2.643521785736084, "mode": "train", "epoch": 20}
{"loss": 0.42175042629241943, "acc": 0.811170756816864, "length": 2.5, "mode": "test", "epoch": 20}
{"loss": 0.35479432344436646, "acc": 0.8470321893692017, "length": 2.69351863861084, "mode": "train", "epoch": 21}
{"loss": 0.40584421157836914, "acc": 0.8237250447273254, "length": 2.5486111640930176, "mode": "test", "epoch": 21}
{"loss": 0.3277241587638855, "acc": 0.853281557559967, "length": 2.7496328353881836, "mode": "train", "epoch": 22}
{"loss": 0.37495872378349304, "acc": 0.835693359375, "length": 2.6111111640930176, "mode": "test", "epoch": 22}
{"loss": 0.3149162530899048, "acc": 0.868262767791748, "length": 2.8786373138427734, "mode": "train", "epoch": 23}
{"loss": 0.3593387007713318, "acc": 0.8519964814186096, "length": 2.711805582046509, "mode": "test", "epoch": 23}
{"loss": 0.29826682806015015, "acc": 0.875752866268158, "length": 2.958728551864624, "mode": "train", "epoch": 24}
{"loss": 0.3472728133201599, "acc": 0.8392741680145264, "length": 2.9791667461395264, "mode": "test", "epoch": 24}
{"loss": 0.2836732268333435, "acc": 0.8846474885940552, "length": 3.1212198734283447, "mode": "train", "epoch": 25}
{"loss": 0.3446979522705078, "acc": 0.8601671457290649, "length": 2.9861111640930176, "mode": "test", "epoch": 25}
{"loss": 0.2714462876319885, "acc": 0.8983654975891113, "length": 3.1581056118011475, "mode": "train", "epoch": 26}
{"loss": 0.33421245217323303, "acc": 0.8641765117645264, "length": 3.0520832538604736, "mode": "test", "epoch": 26}
{"loss": 0.2544139325618744, "acc": 0.9025420546531677, "length": 3.1411705017089844, "mode": "train", "epoch": 27}
{"loss": 0.3273385167121887, "acc": 0.8701986074447632, "length": 3.125, "mode": "test", "epoch": 27}
{"loss": 0.23759138584136963, "acc": 0.9170998334884644, "length": 3.288647174835205, "mode": "train", "epoch": 28}
{"loss": 0.3266923427581787, "acc": 0.8726562261581421, "length": 3.3298611640930176, "mode": "test", "epoch": 28}
{"loss": 0.23901362717151642, "acc": 0.9116080403327942, "length": 3.3834640979766846, "mode": "train", "epoch": 29}
{"loss": 0.3003779351711273, "acc": 0.8906086683273315, "length": 3.184027671813965, "mode": "test", "epoch": 29}
{"loss": 0.22551733255386353, "acc": 0.9230784177780151, "length": 3.414482831954956, "mode": "train", "epoch": 30}
{"loss": 0.29001644253730774, "acc": 0.8973795771598816, "length": 3.4583332538604736, "mode": "test", "epoch": 30}
{"loss": 0.2088259756565094, "acc": 0.9299020171165466, "length": 3.4946858882904053, "mode": "train", "epoch": 31}
{"loss": 0.28628042340278625, "acc": 0.9061740040779114, "length": 3.475694417953491, "mode": "test", "epoch": 31}
{"loss": 0.20565742254257202, "acc": 0.9276069402694702, "length": 3.570519208908081, "mode": "train", "epoch": 32}
{"loss": 0.2923857569694519, "acc": 0.9059516191482544, "length": 3.5486111640930176, "mode": "test", "epoch": 32}
{"loss": 0.19764789938926697, "acc": 0.9318202137947083, "length": 3.5568954944610596, "mode": "train", "epoch": 33}
{"loss": 0.26435232162475586, "acc": 0.9101508259773254, "length": 3.4583332538604736, "mode": "test", "epoch": 33}
{"loss": 0.19388726353645325, "acc": 0.9360147714614868, "length": 3.5238661766052246, "mode": "train", "epoch": 34}
{"loss": 0.26104244589805603, "acc": 0.9162705540657043, "length": 3.559027671813965, "mode": "test", "epoch": 34}
{"loss": 0.20364728569984436, "acc": 0.9372033476829529, "length": 3.5869266986846924, "mode": "train", "epoch": 35}
{"loss": 0.2729858160018921, "acc": 0.9112305045127869, "length": 3.5138888359069824, "mode": "test", "epoch": 35}
{"loss": 0.1891811341047287, "acc": 0.9327608346939087, "length": 3.548018217086792, "mode": "train", "epoch": 36}
{"loss": 0.2692146599292755, "acc": 0.9127386808395386, "length": 3.565972328186035, "mode": "test", "epoch": 36}
{"loss": 0.16878513991832733, "acc": 0.9411795139312744, "length": 3.6222174167633057, "mode": "train", "epoch": 37}
{"loss": 0.2874324917793274, "acc": 0.9083116054534912, "length": 3.5208332538604736, "mode": "test", "epoch": 37}
{"loss": 0.17009100317955017, "acc": 0.944699764251709, "length": 3.6199560165405273, "mode": "train", "epoch": 38}
{"loss": 0.2588081359863281, "acc": 0.9185221195220947, "length": 3.590277671813965, "mode": "test", "epoch": 38}
{"loss": 0.15970593690872192, "acc": 0.9483429789543152, "length": 3.6623380184173584, "mode": "train", "epoch": 39}
{"loss": 0.2677706182003021, "acc": 0.9276854991912842, "length": 3.59375, "mode": "test", "epoch": 39}
{"loss": 0.16947665810585022, "acc": 0.9438962340354919, "length": 3.650822401046753, "mode": "train", "epoch": 40}
{"loss": 0.2630046010017395, "acc": 0.9093533754348755, "length": 3.628472328186035, "mode": "test", "epoch": 40}
{"loss": 0.1617809534072876, "acc": 0.9484508037567139, "length": 3.6085081100463867, "mode": "train", "epoch": 41}
{"loss": 0.2625727653503418, "acc": 0.9217883348464966, "length": 3.5798611640930176, "mode": "test", "epoch": 41}
{"loss": 0.15421202778816223, "acc": 0.9522908926010132, "length": 3.692291021347046, "mode": "train", "epoch": 42}
{"loss": 0.26118502020835876, "acc": 0.9252386093139648, "length": 3.625, "mode": "test", "epoch": 42}
{"loss": 0.15002600848674774, "acc": 0.9526757001876831, "length": 3.6824018955230713, "mode": "train", "epoch": 43}
{"loss": 0.2626938223838806, "acc": 0.9056316018104553, "length": 3.694444417953491, "mode": "test", "epoch": 43}
{"loss": 0.14884112775325775, "acc": 0.9569146037101746, "length": 3.8135838508605957, "mode": "train", "epoch": 44}
{"loss": 0.24367325007915497, "acc": 0.9109050035476685, "length": 3.78125, "mode": "test", "epoch": 44}
{"loss": 0.14782610535621643, "acc": 0.955333948135376, "length": 3.7805991172790527, "mode": "train", "epoch": 45}
{"loss": 0.2512236535549164, "acc": 0.9213216304779053, "length": 3.7604167461395264, "mode": "test", "epoch": 45}
{"loss": 0.14596804976463318, "acc": 0.9558218121528625, "length": 3.7360787391662598, "mode": "train", "epoch": 46}
{"loss": 0.24263858795166016, "acc": 0.9320204257965088, "length": 3.7083332538604736, "mode": "test", "epoch": 46}
{"loss": 0.14347729086875916, "acc": 0.9592107534408569, "length": 3.740412473678589, "mode": "train", "epoch": 47}
{"loss": 0.2235587239265442, "acc": 0.9286350607872009, "length": 3.7361111640930176, "mode": "test", "epoch": 47}
{"loss": 0.1261996030807495, "acc": 0.9632582664489746, "length": 3.774080514907837, "mode": "train", "epoch": 48}
{"loss": 0.2553413212299347, "acc": 0.9176649451255798, "length": 3.7291667461395264, "mode": "test", "epoch": 48}
{"loss": 0.12522874772548676, "acc": 0.9641463756561279, "length": 3.7410380840301514, "mode": "train", "epoch": 49}
{"loss": 0.23682253062725067, "acc": 0.9289117455482483, "length": 3.6979167461395264, "mode": "test", "epoch": 49}
{"loss": 0.11480347067117691, "acc": 0.9698670506477356, "length": 3.7588424682617188, "mode": "train", "epoch": 50}
{"loss": 0.2195752114057541, "acc": 0.930804967880249, "length": 3.743055582046509, "mode": "test", "epoch": 50}
{"loss": 0.11182284355163574, "acc": 0.9684971570968628, "length": 3.768204689025879, "mode": "train", "epoch": 51}
{"loss": 0.23632939159870148, "acc": 0.9228514432907104, "length": 3.7673611640930176, "mode": "test", "epoch": 51}
{"loss": 0.11221449077129364, "acc": 0.9704773426055908, "length": 3.797903299331665, "mode": "train", "epoch": 52}
{"loss": 0.23097582161426544, "acc": 0.9364420771598816, "length": 3.777777671813965, "mode": "test", "epoch": 52}
{"loss": 0.11171682178974152, "acc": 0.9690346121788025, "length": 3.797203779220581, "mode": "train", "epoch": 53}
{"loss": 0.2167806178331375, "acc": 0.9424965977668762, "length": 3.7916667461395264, "mode": "test", "epoch": 53}
{"loss": 0.11111874878406525, "acc": 0.9688544273376465, "length": 3.805769681930542, "mode": "train", "epoch": 54}
{"loss": 0.21340619027614594, "acc": 0.9456108808517456, "length": 3.7673611640930176, "mode": "test", "epoch": 54}
{"loss": 0.1277245581150055, "acc": 0.966080367565155, "length": 3.7750911712646484, "mode": "train", "epoch": 55}
{"loss": 0.25902363657951355, "acc": 0.9301486611366272, "length": 3.756944417953491, "mode": "test", "epoch": 55}
{"loss": 0.1301102638244629, "acc": 0.9598608613014221, "length": 3.8513123989105225, "mode": "train", "epoch": 56}
{"loss": 0.22552156448364258, "acc": 0.9346190690994263, "length": 3.8125, "mode": "test", "epoch": 56}
{"loss": 0.10529789328575134, "acc": 0.9735938310623169, "length": 3.825507402420044, "mode": "train", "epoch": 57}
{"loss": 0.18954059481620789, "acc": 0.9475530982017517, "length": 3.7986111640930176, "mode": "test", "epoch": 57}
{"loss": 0.0958898514509201, "acc": 0.9749267101287842, "length": 3.844691276550293, "mode": "train", "epoch": 58}
{"loss": 0.2091025859117508, "acc": 0.9505804777145386, "length": 3.8298611640930176, "mode": "test", "epoch": 58}
{"loss": 0.09228654205799103, "acc": 0.9760301113128662, "length": 3.841519594192505, "mode": "train", "epoch": 59}
{"loss": 0.1834341436624527, "acc": 0.9546821117401123, "length": 3.8229167461395264, "mode": "test", "epoch": 59}
{"loss": 0.0884602963924408, "acc": 0.9787051677703857, "length": 3.83838152885437, "mode": "train", "epoch": 60}
{"loss": 0.17975826561450958, "acc": 0.9487305879592896, "length": 3.784722328186035, "mode": "test", "epoch": 60}
test accuracy: 0.8129742741584778
