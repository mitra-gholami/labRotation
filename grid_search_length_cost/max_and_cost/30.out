# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7136436700820923, "acc": 0.5104601383209229, "length": 3.542365312576294, "mode": "train", "epoch": 1}
{"loss": 0.6953952312469482, "acc": 0.5432292222976685, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6987369060516357, "acc": 0.5138153433799744, "length": 1.0499378442764282, "mode": "train", "epoch": 2}
{"loss": 0.6944912672042847, "acc": 0.5394096970558167, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6991543769836426, "acc": 0.5087801218032837, "length": 1.024776816368103, "mode": "train", "epoch": 3}
{"loss": 0.6945917010307312, "acc": 0.5501735806465149, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7002929449081421, "acc": 0.5067142248153687, "length": 1.015924334526062, "mode": "train", "epoch": 4}
{"loss": 0.6944955587387085, "acc": 0.5135416984558105, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6983486413955688, "acc": 0.5160343050956726, "length": 1.0112054347991943, "mode": "train", "epoch": 5}
{"loss": 0.6961301565170288, "acc": 0.5119791626930237, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.698752224445343, "acc": 0.5102787613868713, "length": 1.0088313817977905, "mode": "train", "epoch": 6}
{"loss": 0.6958784461021423, "acc": 0.5369791984558105, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6976541876792908, "acc": 0.5192555785179138, "length": 1.0070286989212036, "mode": "train", "epoch": 7}
{"loss": 0.694903552532196, "acc": 0.5229166150093079, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6978196501731873, "acc": 0.5186835527420044, "length": 1.0055632591247559, "mode": "train", "epoch": 8}
{"loss": 0.6947981119155884, "acc": 0.5260416865348816, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6968384385108948, "acc": 0.5300451517105103, "length": 1.0045944452285767, "mode": "train", "epoch": 9}
{"loss": 0.6945739388465881, "acc": 0.5395833849906921, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.69887375831604, "acc": 0.5102121233940125, "length": 1.0039701461791992, "mode": "train", "epoch": 10}
{"loss": 0.6948279738426208, "acc": 0.5456597805023193, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6965447068214417, "acc": 0.5242424011230469, "length": 1.0032802820205688, "mode": "train", "epoch": 11}
{"loss": 0.6952202916145325, "acc": 0.5015624761581421, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6960921287536621, "acc": 0.5141438245773315, "length": 1.0030999183654785, "mode": "train", "epoch": 12}
{"loss": 0.69508296251297, "acc": 0.5425347089767456, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6962537169456482, "acc": 0.5285311937332153, "length": 1.0105313062667847, "mode": "train", "epoch": 13}
{"loss": 0.6933320164680481, "acc": 0.5508463382720947, "length": 1.0208333730697632, "mode": "test", "epoch": 13}
{"loss": 0.6514390110969543, "acc": 0.635047197341919, "length": 2.2349579334259033, "mode": "train", "epoch": 14}
{"loss": 0.6056948304176331, "acc": 0.6772297620773315, "length": 1.3819444179534912, "mode": "test", "epoch": 14}
{"loss": 0.5915922522544861, "acc": 0.6940487623214722, "length": 1.5189458131790161, "mode": "train", "epoch": 15}
{"loss": 0.596217155456543, "acc": 0.6800944805145264, "length": 1.3784722089767456, "mode": "test", "epoch": 15}
{"loss": 0.558083713054657, "acc": 0.738157331943512, "length": 1.628701090812683, "mode": "train", "epoch": 16}
{"loss": 0.536191463470459, "acc": 0.7612684369087219, "length": 1.6388888359069824, "mode": "test", "epoch": 16}
{"loss": 0.4999766945838928, "acc": 0.7793682217597961, "length": 1.84190833568573, "mode": "train", "epoch": 17}
{"loss": 0.5097835063934326, "acc": 0.7909233570098877, "length": 1.7430555820465088, "mode": "test", "epoch": 17}
{"loss": 0.4721393883228302, "acc": 0.7919963002204895, "length": 1.8701540231704712, "mode": "train", "epoch": 18}
{"loss": 0.5132932066917419, "acc": 0.7886013388633728, "length": 1.8159722089767456, "mode": "test", "epoch": 18}
{"loss": 0.46481242775917053, "acc": 0.7899182438850403, "length": 1.8652725219726562, "mode": "train", "epoch": 19}
{"loss": 0.48432594537734985, "acc": 0.7932888865470886, "length": 1.8055555820465088, "mode": "test", "epoch": 19}
{"loss": 0.45139583945274353, "acc": 0.7936764359474182, "length": 1.8678828477859497, "mode": "train", "epoch": 20}
{"loss": 0.4621974229812622, "acc": 0.7949978113174438, "length": 1.8784722089767456, "mode": "test", "epoch": 20}
{"loss": 0.42378589510917664, "acc": 0.8128944635391235, "length": 1.9219651222229004, "mode": "train", "epoch": 21}
{"loss": 0.42523184418678284, "acc": 0.8147732615470886, "length": 1.84375, "mode": "test", "epoch": 21}
{"loss": 0.37074416875839233, "acc": 0.8365648984909058, "length": 2.0891425609588623, "mode": "train", "epoch": 22}
{"loss": 0.386229932308197, "acc": 0.824902355670929, "length": 2.0520832538604736, "mode": "test", "epoch": 22}
{"loss": 0.33642736077308655, "acc": 0.8560060262680054, "length": 2.2643637657165527, "mode": "train", "epoch": 23}
{"loss": 0.3692109286785126, "acc": 0.8451279997825623, "length": 2.1458332538604736, "mode": "test", "epoch": 23}
{"loss": 0.322000116109848, "acc": 0.862959086894989, "length": 2.2819128036499023, "mode": "train", "epoch": 24}
{"loss": 0.38039371371269226, "acc": 0.8393446207046509, "length": 2.159722328186035, "mode": "test", "epoch": 24}
{"loss": 0.3097231984138489, "acc": 0.8698177337646484, "length": 2.2409508228302, "mode": "train", "epoch": 25}
{"loss": 0.35269954800605774, "acc": 0.8638293147087097, "length": 2.1736111640930176, "mode": "test", "epoch": 25}
{"loss": 0.29763054847717285, "acc": 0.8773230314254761, "length": 2.3015594482421875, "mode": "train", "epoch": 26}
{"loss": 0.3378073573112488, "acc": 0.8627387285232544, "length": 2.180555582046509, "mode": "test", "epoch": 26}
{"loss": 0.288819283246994, "acc": 0.8801959156990051, "length": 2.2667078971862793, "mode": "train", "epoch": 27}
{"loss": 0.3326103985309601, "acc": 0.8711480498313904, "length": 2.1666667461395264, "mode": "test", "epoch": 27}
{"loss": 0.28349757194519043, "acc": 0.8795855641365051, "length": 2.2699649333953857, "mode": "train", "epoch": 28}
{"loss": 0.3281909227371216, "acc": 0.8743381500244141, "length": 2.2361111640930176, "mode": "test", "epoch": 28}
{"loss": 0.28270700573921204, "acc": 0.8810144662857056, "length": 2.2876155376434326, "mode": "train", "epoch": 29}
{"loss": 0.3284589350223541, "acc": 0.8733127117156982, "length": 2.2638888359069824, "mode": "test", "epoch": 29}
{"loss": 0.2795269191265106, "acc": 0.8814945816993713, "length": 2.2814409732818604, "mode": "train", "epoch": 30}
{"loss": 0.35128259658813477, "acc": 0.8720107078552246, "length": 2.2638888359069824, "mode": "test", "epoch": 30}
{"loss": 0.27765801548957825, "acc": 0.8828246593475342, "length": 2.2838587760925293, "mode": "train", "epoch": 31}
{"loss": 0.33983224630355835, "acc": 0.8711208701133728, "length": 2.274305582046509, "mode": "test", "epoch": 31}
{"loss": 0.2727759778499603, "acc": 0.8844239115715027, "length": 2.325577735900879, "mode": "train", "epoch": 32}
{"loss": 0.3312900960445404, "acc": 0.8720486164093018, "length": 2.2951388359069824, "mode": "test", "epoch": 32}
{"loss": 0.27255505323410034, "acc": 0.8869184851646423, "length": 2.3096911907196045, "mode": "train", "epoch": 33}
{"loss": 0.3484177887439728, "acc": 0.8671115040779114, "length": 2.336805582046509, "mode": "test", "epoch": 33}
{"loss": 0.2732207775115967, "acc": 0.8860338926315308, "length": 2.350131034851074, "mode": "train", "epoch": 34}
{"loss": 0.3293974697589874, "acc": 0.8722546696662903, "length": 2.3125, "mode": "test", "epoch": 34}
{"loss": 0.2703302204608917, "acc": 0.8864704370498657, "length": 2.326056957244873, "mode": "train", "epoch": 35}
{"loss": 0.3449914753437042, "acc": 0.8711697459220886, "length": 2.3958332538604736, "mode": "test", "epoch": 35}
{"loss": 0.26709920167922974, "acc": 0.8865450620651245, "length": 2.37318754196167, "mode": "train", "epoch": 36}
{"loss": 0.32870057225227356, "acc": 0.8791883587837219, "length": 2.288194417953491, "mode": "test", "epoch": 36}
{"loss": 0.26098930835723877, "acc": 0.8893569707870483, "length": 2.366145610809326, "mode": "train", "epoch": 37}
{"loss": 0.3487768769264221, "acc": 0.8747233152389526, "length": 2.3541667461395264, "mode": "test", "epoch": 37}
{"loss": 0.2612403929233551, "acc": 0.8901305794715881, "length": 2.3732967376708984, "mode": "train", "epoch": 38}
{"loss": 0.32251083850860596, "acc": 0.879476010799408, "length": 2.3854167461395264, "mode": "test", "epoch": 38}
{"loss": 0.26151490211486816, "acc": 0.8924667239189148, "length": 2.4099879264831543, "mode": "train", "epoch": 39}
{"loss": 0.32626134157180786, "acc": 0.8769477009773254, "length": 2.2708332538604736, "mode": "test", "epoch": 39}
{"loss": 0.2556125819683075, "acc": 0.8970845937728882, "length": 2.3531694412231445, "mode": "train", "epoch": 40}
{"loss": 0.3276623785495758, "acc": 0.8816786408424377, "length": 2.347222328186035, "mode": "test", "epoch": 40}
{"loss": 0.24587607383728027, "acc": 0.9005687236785889, "length": 2.434326171875, "mode": "train", "epoch": 41}
{"loss": 0.32763710618019104, "acc": 0.8804144859313965, "length": 2.3576388359069824, "mode": "test", "epoch": 41}
{"loss": 0.2427515685558319, "acc": 0.9048431515693665, "length": 2.472503423690796, "mode": "train", "epoch": 42}
{"loss": 0.30972811579704285, "acc": 0.8895453214645386, "length": 2.4236111640930176, "mode": "test", "epoch": 42}
{"loss": 0.230376198887825, "acc": 0.9107186794281006, "length": 2.5291879177093506, "mode": "train", "epoch": 43}
{"loss": 0.2898540496826172, "acc": 0.8851779699325562, "length": 2.444444417953491, "mode": "test", "epoch": 43}
{"loss": 0.22067490220069885, "acc": 0.9166308641433716, "length": 2.5705435276031494, "mode": "train", "epoch": 44}
{"loss": 0.28144440054893494, "acc": 0.8955674767494202, "length": 2.5104167461395264, "mode": "test", "epoch": 44}
{"loss": 0.21345879137516022, "acc": 0.9187490940093994, "length": 2.6321423053741455, "mode": "train", "epoch": 45}
{"loss": 0.2994717061519623, "acc": 0.8923447728157043, "length": 2.652777671813965, "mode": "test", "epoch": 45}
{"loss": 0.21431566774845123, "acc": 0.918941080570221, "length": 2.664567232131958, "mode": "train", "epoch": 46}
{"loss": 0.3069094717502594, "acc": 0.8847222328186035, "length": 2.493055582046509, "mode": "test", "epoch": 46}
{"loss": 0.2091711014509201, "acc": 0.9211349487304688, "length": 2.626359462738037, "mode": "train", "epoch": 47}
{"loss": 0.2599833309650421, "acc": 0.912749707698822, "length": 2.6458332538604736, "mode": "test", "epoch": 47}
{"loss": 0.20197206735610962, "acc": 0.9250962734222412, "length": 2.7006113529205322, "mode": "train", "epoch": 48}
{"loss": 0.2708551585674286, "acc": 0.9128310084342957, "length": 2.6979167461395264, "mode": "test", "epoch": 48}
{"loss": 0.2005731612443924, "acc": 0.9265077114105225, "length": 2.7186522483825684, "mode": "train", "epoch": 49}
{"loss": 0.2895938754081726, "acc": 0.9090548753738403, "length": 2.7013888359069824, "mode": "test", "epoch": 49}
{"loss": 0.19837318360805511, "acc": 0.9265938401222229, "length": 2.6997036933898926, "mode": "train", "epoch": 50}
{"loss": 0.2439204603433609, "acc": 0.9175456166267395, "length": 2.6458332538604736, "mode": "test", "epoch": 50}
{"loss": 0.18924349546432495, "acc": 0.9294310212135315, "length": 2.7455265522003174, "mode": "train", "epoch": 51}
{"loss": 0.24147649109363556, "acc": 0.9190592169761658, "length": 2.725694417953491, "mode": "test", "epoch": 51}
{"loss": 0.18082065880298615, "acc": 0.9358884692192078, "length": 2.7652244567871094, "mode": "train", "epoch": 52}
{"loss": 0.23243819177150726, "acc": 0.9270182847976685, "length": 2.7048611640930176, "mode": "test", "epoch": 52}
{"loss": 0.17554984986782074, "acc": 0.9385942220687866, "length": 2.8045904636383057, "mode": "train", "epoch": 53}
{"loss": 0.21518895030021667, "acc": 0.928868293762207, "length": 2.694444417953491, "mode": "test", "epoch": 53}
{"loss": 0.17251521348953247, "acc": 0.9385313391685486, "length": 2.8174736499786377, "mode": "train", "epoch": 54}
{"loss": 0.2254253476858139, "acc": 0.9281522035598755, "length": 2.7673611640930176, "mode": "test", "epoch": 54}
{"loss": 0.1716168373823166, "acc": 0.9404884576797485, "length": 2.8844428062438965, "mode": "train", "epoch": 55}
{"loss": 0.24741727113723755, "acc": 0.9246690273284912, "length": 2.8229167461395264, "mode": "test", "epoch": 55}
{"loss": 0.16354648768901825, "acc": 0.943230390548706, "length": 2.8311448097229004, "mode": "train", "epoch": 56}
{"loss": 0.23859016597270966, "acc": 0.9265516996383667, "length": 2.8020832538604736, "mode": "test", "epoch": 56}
{"loss": 0.15852060914039612, "acc": 0.9470303058624268, "length": 2.8593177795410156, "mode": "train", "epoch": 57}
{"loss": 0.20661279559135437, "acc": 0.9358127117156982, "length": 2.711805582046509, "mode": "test", "epoch": 57}
{"loss": 0.15438969433307648, "acc": 0.9482546448707581, "length": 2.8329451084136963, "mode": "train", "epoch": 58}
{"loss": 0.22323253750801086, "acc": 0.9261826276779175, "length": 2.850694417953491, "mode": "test", "epoch": 58}
{"loss": 0.15290091931819916, "acc": 0.94771808385849, "length": 2.843900203704834, "mode": "train", "epoch": 59}
{"loss": 0.2247762233018875, "acc": 0.9346408843994141, "length": 2.868055582046509, "mode": "test", "epoch": 59}
{"loss": 0.14631694555282593, "acc": 0.9498942494392395, "length": 2.8919999599456787, "mode": "train", "epoch": 60}
{"loss": 0.22778776288032532, "acc": 0.934814453125, "length": 2.902777671813965, "mode": "test", "epoch": 60}
test accuracy: 0.8269882202148438
