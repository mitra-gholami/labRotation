# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7203924059867859, "acc": 0.5079734325408936, "length": 2.309711217880249, "mode": "train", "epoch": 1}
{"loss": 0.7028417587280273, "acc": 0.5171875357627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.7037086486816406, "acc": 0.5210340023040771, "length": 1.0508373975753784, "mode": "train", "epoch": 2}
{"loss": 0.703781247138977, "acc": 0.49433591961860657, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.7035369873046875, "acc": 0.5152546167373657, "length": 1.0179359912872314, "mode": "train", "epoch": 3}
{"loss": 0.7034630179405212, "acc": 0.48007816076278687, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.7018752098083496, "acc": 0.515450119972229, "length": 1.0114691257476807, "mode": "train", "epoch": 4}
{"loss": 0.7029265761375427, "acc": 0.5261719226837158, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.7026470303535461, "acc": 0.5207653641700745, "length": 1.0086982250213623, "mode": "train", "epoch": 5}
{"loss": 0.7042813301086426, "acc": 0.49882814288139343, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.7028276324272156, "acc": 0.5268130898475647, "length": 1.0060309171676636, "mode": "train", "epoch": 6}
{"loss": 0.7012077569961548, "acc": 0.53125, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.7015218734741211, "acc": 0.5366911292076111, "length": 1.0042955875396729, "mode": "train", "epoch": 7}
{"loss": 0.703116774559021, "acc": 0.5146484375, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.7014890909194946, "acc": 0.5277749300003052, "length": 1.0035216808319092, "mode": "train", "epoch": 8}
{"loss": 0.7024091482162476, "acc": 0.5185547471046448, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.701125979423523, "acc": 0.5272557139396667, "length": 1.0029032230377197, "mode": "train", "epoch": 9}
{"loss": 0.7013676762580872, "acc": 0.5224609971046448, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.7007940411567688, "acc": 0.5353166460990906, "length": 1.0022825002670288, "mode": "train", "epoch": 10}
{"loss": 0.7020766139030457, "acc": 0.5234375, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.7009131908416748, "acc": 0.5407555103302002, "length": 1.0019381046295166, "mode": "train", "epoch": 11}
{"loss": 0.7030729055404663, "acc": 0.5287109017372131, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.700099766254425, "acc": 0.541519045829773, "length": 1.0016313791275024, "mode": "train", "epoch": 12}
{"loss": 0.7011330723762512, "acc": 0.5417969226837158, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6989853978157043, "acc": 0.5509475469589233, "length": 1.0013350248336792, "mode": "train", "epoch": 13}
{"loss": 0.6990355253219604, "acc": 0.5363280773162842, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6983364820480347, "acc": 0.5543162822723389, "length": 1.0012686252593994, "mode": "train", "epoch": 14}
{"loss": 0.70164954662323, "acc": 0.529492199420929, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6977593898773193, "acc": 0.5551084280014038, "length": 1.0009706020355225, "mode": "train", "epoch": 15}
{"loss": 0.6977510452270508, "acc": 0.561718761920929, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6973353624343872, "acc": 0.5543845295906067, "length": 1.0008724927902222, "mode": "train", "epoch": 16}
{"loss": 0.6988955736160278, "acc": 0.5417969226837158, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6967270374298096, "acc": 0.5536660552024841, "length": 1.0007330179214478, "mode": "train", "epoch": 17}
{"loss": 0.6965429782867432, "acc": 0.5650390982627869, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6956411600112915, "acc": 0.5440468788146973, "length": 1.000665545463562, "mode": "train", "epoch": 18}
{"loss": 0.6973949074745178, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6945538520812988, "acc": 0.565561830997467, "length": 1.0005275011062622, "mode": "train", "epoch": 19}
{"loss": 0.699957013130188, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6957138180732727, "acc": 0.5586531758308411, "length": 1.0004987716674805, "mode": "train", "epoch": 20}
{"loss": 0.6955941915512085, "acc": 0.5533203482627869, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6954596638679504, "acc": 0.5548040270805359, "length": 1.000422716140747, "mode": "train", "epoch": 21}
{"loss": 0.6982722282409668, "acc": 0.548828125, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.69443279504776, "acc": 0.5522816181182861, "length": 1.000368595123291, "mode": "train", "epoch": 22}
{"loss": 0.6952012777328491, "acc": 0.5519530773162842, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6954386830329895, "acc": 0.5649012923240662, "length": 1.0003292560577393, "mode": "train", "epoch": 23}
{"loss": 0.696639895439148, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6952138543128967, "acc": 0.5560080409049988, "length": 1.0002899169921875, "mode": "train", "epoch": 24}
{"loss": 0.6963645219802856, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6930946707725525, "acc": 0.5622583627700806, "length": 1.0002490282058716, "mode": "train", "epoch": 25}
{"loss": 0.6963857412338257, "acc": 0.5478515625, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6932048797607422, "acc": 0.5656834244728088, "length": 1.0002005100250244, "mode": "train", "epoch": 26}
{"loss": 0.6947180032730103, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6919965147972107, "acc": 0.5667656064033508, "length": 1.0001870393753052, "mode": "train", "epoch": 27}
{"loss": 0.6940472722053528, "acc": 0.5478515625, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6912561058998108, "acc": 0.5690498352050781, "length": 1.0001542568206787, "mode": "train", "epoch": 28}
{"loss": 0.6954352855682373, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.692275881767273, "acc": 0.5576916337013245, "length": 1.000152349472046, "mode": "train", "epoch": 29}
{"loss": 0.6941013336181641, "acc": 0.5625, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6909749507904053, "acc": 0.5625594854354858, "length": 1.0001428127288818, "mode": "train", "epoch": 30}
{"loss": 0.6968201398849487, "acc": 0.553515613079071, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6906381845474243, "acc": 0.5661057233810425, "length": 1.000112533569336, "mode": "train", "epoch": 31}
{"loss": 0.695919930934906, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.69095778465271, "acc": 0.5647830367088318, "length": 1.0001152753829956, "mode": "train", "epoch": 32}
{"loss": 0.6946893930435181, "acc": 0.5541015267372131, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6909153461456299, "acc": 0.5695895552635193, "length": 1.000090479850769, "mode": "train", "epoch": 33}
{"loss": 0.6934863328933716, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6894831657409668, "acc": 0.5638824105262756, "length": 1.0000834465026855, "mode": "train", "epoch": 34}
{"loss": 0.6942816972732544, "acc": 0.550976574420929, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6904874444007874, "acc": 0.5652644038200378, "length": 1.0000866651535034, "mode": "train", "epoch": 35}
{"loss": 0.6952682137489319, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6901535391807556, "acc": 0.5633413195610046, "length": 1.0000826120376587, "mode": "train", "epoch": 36}
{"loss": 0.6940344572067261, "acc": 0.550976574420929, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6910192370414734, "acc": 0.5637616515159607, "length": 1.0000512599945068, "mode": "train", "epoch": 37}
{"loss": 0.6959231495857239, "acc": 0.548828125, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6901591420173645, "acc": 0.5652640461921692, "length": 1.0000474452972412, "mode": "train", "epoch": 38}
{"loss": 0.6926106810569763, "acc": 0.5515625476837158, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6911736726760864, "acc": 0.5709731578826904, "length": 1.0000405311584473, "mode": "train", "epoch": 39}
{"loss": 0.6959961652755737, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6899718046188354, "acc": 0.5688692331314087, "length": 1.0000685453414917, "mode": "train", "epoch": 40}
{"loss": 0.6947672963142395, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6884027719497681, "acc": 0.5630410313606262, "length": 1.0000382661819458, "mode": "train", "epoch": 41}
{"loss": 0.6932623386383057, "acc": 0.553515613079071, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6901471614837646, "acc": 0.5670674443244934, "length": 1.000076413154602, "mode": "train", "epoch": 42}
{"loss": 0.6929619312286377, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6886144280433655, "acc": 0.5712137818336487, "length": 1.0000247955322266, "mode": "train", "epoch": 43}
{"loss": 0.69492506980896, "acc": 0.5478515625, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6901513338088989, "acc": 0.5651442408561707, "length": 1.0000218152999878, "mode": "train", "epoch": 44}
{"loss": 0.6933987140655518, "acc": 0.5519530773162842, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6888178586959839, "acc": 0.5637016892433167, "length": 1.0000251531600952, "mode": "train", "epoch": 45}
{"loss": 0.692956268787384, "acc": 0.554492175579071, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6886374950408936, "acc": 0.5706731081008911, "length": 1.000016689300537, "mode": "train", "epoch": 46}
{"loss": 0.6953009366989136, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6880910396575928, "acc": 0.567908525466919, "length": 1.0000159740447998, "mode": "train", "epoch": 47}
{"loss": 0.693511962890625, "acc": 0.5453124642372131, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6884744763374329, "acc": 0.5683294534683228, "length": 1.0001475811004639, "mode": "train", "epoch": 48}
{"loss": 0.6938266754150391, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6884984374046326, "acc": 0.5707330703735352, "length": 1.0000097751617432, "mode": "train", "epoch": 49}
{"loss": 0.6914440393447876, "acc": 0.5712890625, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6879147291183472, "acc": 0.5673677921295166, "length": 1.0000098943710327, "mode": "train", "epoch": 50}
{"loss": 0.6941229104995728, "acc": 0.5519530773162842, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.690166711807251, "acc": 0.5635817050933838, "length": 1.0000091791152954, "mode": "train", "epoch": 51}
{"loss": 0.6947382092475891, "acc": 0.5417969226837158, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6885795593261719, "acc": 0.5601562261581421, "length": 1.0000091791152954, "mode": "train", "epoch": 52}
{"loss": 0.6945767402648926, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6883381009101868, "acc": 0.5665865540504456, "length": 1.00001060962677, "mode": "train", "epoch": 53}
{"loss": 0.6923112869262695, "acc": 0.550976574420929, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6890400648117065, "acc": 0.5706730484962463, "length": 1.0000061988830566, "mode": "train", "epoch": 54}
{"loss": 0.6946992874145508, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6883602142333984, "acc": 0.560817301273346, "length": 1.0000048875808716, "mode": "train", "epoch": 55}
{"loss": 0.6943535804748535, "acc": 0.5462890267372131, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6886502504348755, "acc": 0.5659255385398865, "length": 1.0000052452087402, "mode": "train", "epoch": 56}
{"loss": 0.69211745262146, "acc": 0.552539050579071, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6882546544075012, "acc": 0.5672475695610046, "length": 1.0000040531158447, "mode": "train", "epoch": 57}
{"loss": 0.6936644911766052, "acc": 0.5478515625, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6879373788833618, "acc": 0.5740985870361328, "length": 1.0000033378601074, "mode": "train", "epoch": 58}
{"loss": 0.6934849619865417, "acc": 0.550976574420929, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6886622905731201, "acc": 0.5700720548629761, "length": 1.0000035762786865, "mode": "train", "epoch": 59}
{"loss": 0.6925637722015381, "acc": 0.5515625476837158, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.688095211982727, "acc": 0.5685697197914124, "length": 1.0000030994415283, "mode": "train", "epoch": 60}
{"loss": 0.6923646330833435, "acc": 0.5625, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.2834848463535309
