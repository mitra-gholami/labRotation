# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 5
{"loss": 0.7055981755256653, "acc": 0.5436572432518005, "length": 2.9941041469573975, "mode": "train", "epoch": 1}
{"loss": 0.6916945576667786, "acc": 0.5374999642372131, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6938934326171875, "acc": 0.5390239953994751, "length": 1.071637511253357, "mode": "train", "epoch": 2}
{"loss": 0.6920658349990845, "acc": 0.5546875, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6924811005592346, "acc": 0.5485931038856506, "length": 1.0354777574539185, "mode": "train", "epoch": 3}
{"loss": 0.6903059482574463, "acc": 0.5511718392372131, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6694136261940002, "acc": 0.6104731559753418, "length": 1.6287587881088257, "mode": "train", "epoch": 4}
{"loss": 0.6244653463363647, "acc": 0.6848815679550171, "length": 2.46875, "mode": "test", "epoch": 4}
{"loss": 0.596849262714386, "acc": 0.6969278454780579, "length": 1.9853262901306152, "mode": "train", "epoch": 5}
{"loss": 0.6052687168121338, "acc": 0.6863282322883606, "length": 1.46484375, "mode": "test", "epoch": 5}
{"loss": 0.5697432160377502, "acc": 0.720670223236084, "length": 1.6597083806991577, "mode": "train", "epoch": 6}
{"loss": 0.6005488634109497, "acc": 0.6864074468612671, "length": 1.44140625, "mode": "test", "epoch": 6}
{"loss": 0.559253454208374, "acc": 0.7312383651733398, "length": 1.726029634475708, "mode": "train", "epoch": 7}
{"loss": 0.6018079519271851, "acc": 0.694805920124054, "length": 1.390625, "mode": "test", "epoch": 7}
{"loss": 0.5511090159416199, "acc": 0.7368195056915283, "length": 1.6837280988693237, "mode": "train", "epoch": 8}
{"loss": 0.5835412740707397, "acc": 0.704852283000946, "length": 1.5546875, "mode": "test", "epoch": 8}
{"loss": 0.5374158620834351, "acc": 0.7328614592552185, "length": 1.8378692865371704, "mode": "train", "epoch": 9}
{"loss": 0.5747023820877075, "acc": 0.740997314453125, "length": 1.66015625, "mode": "test", "epoch": 9}
{"loss": 0.5056354999542236, "acc": 0.7614541053771973, "length": 1.9689573049545288, "mode": "train", "epoch": 10}
{"loss": 0.5396820306777954, "acc": 0.7549682855606079, "length": 2.1328125, "mode": "test", "epoch": 10}
{"loss": 0.47125688195228577, "acc": 0.7829886674880981, "length": 2.271878242492676, "mode": "train", "epoch": 11}
{"loss": 0.5422993302345276, "acc": 0.7700256705284119, "length": 2.3203125, "mode": "test", "epoch": 11}
{"loss": 0.4367351830005646, "acc": 0.8073209524154663, "length": 2.717465877532959, "mode": "train", "epoch": 12}
{"loss": 0.48618829250335693, "acc": 0.7965943217277527, "length": 3.15625, "mode": "test", "epoch": 12}
{"loss": 0.403588205575943, "acc": 0.825716495513916, "length": 2.8677170276641846, "mode": "train", "epoch": 13}
{"loss": 0.47731083631515503, "acc": 0.8040772080421448, "length": 2.84375, "mode": "test", "epoch": 13}
{"loss": 0.38610416650772095, "acc": 0.8359774947166443, "length": 2.8716347217559814, "mode": "train", "epoch": 14}
{"loss": 0.45990708470344543, "acc": 0.8047851324081421, "length": 2.62890625, "mode": "test", "epoch": 14}
{"loss": 0.3668714463710785, "acc": 0.8440436124801636, "length": 2.9183454513549805, "mode": "train", "epoch": 15}
{"loss": 0.4477693438529968, "acc": 0.803131103515625, "length": 2.578125, "mode": "test", "epoch": 15}
{"loss": 0.3512120544910431, "acc": 0.8516067862510681, "length": 2.963235855102539, "mode": "train", "epoch": 16}
{"loss": 0.4510263204574585, "acc": 0.8054077625274658, "length": 2.8203125, "mode": "test", "epoch": 16}
{"loss": 0.33862340450286865, "acc": 0.8574103713035583, "length": 3.0923945903778076, "mode": "train", "epoch": 17}
{"loss": 0.41288119554519653, "acc": 0.8285461664199829, "length": 2.98046875, "mode": "test", "epoch": 17}
{"loss": 0.32642897963523865, "acc": 0.8603034615516663, "length": 3.0655198097229004, "mode": "train", "epoch": 18}
{"loss": 0.3875732719898224, "acc": 0.8399779796600342, "length": 2.80078125, "mode": "test", "epoch": 18}
{"loss": 0.3139343559741974, "acc": 0.8693794012069702, "length": 2.9139628410339355, "mode": "train", "epoch": 19}
{"loss": 0.38845759630203247, "acc": 0.847393810749054, "length": 2.6875, "mode": "test", "epoch": 19}
{"loss": 0.3010968565940857, "acc": 0.8791740536689758, "length": 2.9068684577941895, "mode": "train", "epoch": 20}
{"loss": 0.39714938402175903, "acc": 0.8558531999588013, "length": 2.69140625, "mode": "test", "epoch": 20}
{"loss": 0.29264673590660095, "acc": 0.8785216212272644, "length": 3.040726661682129, "mode": "train", "epoch": 21}
{"loss": 0.37050318717956543, "acc": 0.8539734482765198, "length": 2.8671875, "mode": "test", "epoch": 21}
{"loss": 0.27901285886764526, "acc": 0.892064094543457, "length": 3.06827449798584, "mode": "train", "epoch": 22}
{"loss": 0.3683774471282959, "acc": 0.8533813953399658, "length": 2.796875, "mode": "test", "epoch": 22}
{"loss": 0.26867109537124634, "acc": 0.894942045211792, "length": 3.0619781017303467, "mode": "train", "epoch": 23}
{"loss": 0.3552619218826294, "acc": 0.8658264875411987, "length": 2.77734375, "mode": "test", "epoch": 23}
{"loss": 0.2634233832359314, "acc": 0.8979871869087219, "length": 3.0974409580230713, "mode": "train", "epoch": 24}
{"loss": 0.35969939827919006, "acc": 0.8649231195449829, "length": 2.82421875, "mode": "test", "epoch": 24}
{"loss": 0.2538953423500061, "acc": 0.903660237789154, "length": 3.0324883460998535, "mode": "train", "epoch": 25}
{"loss": 0.3636828660964966, "acc": 0.8741393685340881, "length": 2.84375, "mode": "test", "epoch": 25}
{"loss": 0.2489134967327118, "acc": 0.9058124423027039, "length": 3.2184810638427734, "mode": "train", "epoch": 26}
{"loss": 0.3435567021369934, "acc": 0.8680420517921448, "length": 2.95703125, "mode": "test", "epoch": 26}
{"loss": 0.24454309046268463, "acc": 0.9092347621917725, "length": 3.192931652069092, "mode": "train", "epoch": 27}
{"loss": 0.3482202887535095, "acc": 0.8632446527481079, "length": 2.9140625, "mode": "test", "epoch": 27}
{"loss": 0.2338130623102188, "acc": 0.9136674404144287, "length": 3.2469894886016846, "mode": "train", "epoch": 28}
{"loss": 0.3504860997200012, "acc": 0.876141369342804, "length": 3.0703125, "mode": "test", "epoch": 28}
{"loss": 0.2260042130947113, "acc": 0.9151815176010132, "length": 3.338146209716797, "mode": "train", "epoch": 29}
{"loss": 0.3429272770881653, "acc": 0.8785156607627869, "length": 3.234375, "mode": "test", "epoch": 29}
{"loss": 0.21723279356956482, "acc": 0.9223940372467041, "length": 3.364255428314209, "mode": "train", "epoch": 30}
{"loss": 0.32509666681289673, "acc": 0.8846008777618408, "length": 3.19921875, "mode": "test", "epoch": 30}
{"loss": 0.21308545768260956, "acc": 0.9237860441207886, "length": 3.4083683490753174, "mode": "train", "epoch": 31}
{"loss": 0.3247487545013428, "acc": 0.8882812857627869, "length": 3.375, "mode": "test", "epoch": 31}
{"loss": 0.20409099757671356, "acc": 0.9277504086494446, "length": 3.506479501724243, "mode": "train", "epoch": 32}
{"loss": 0.3176371455192566, "acc": 0.8939514756202698, "length": 3.34765625, "mode": "test", "epoch": 32}
{"loss": 0.19987201690673828, "acc": 0.9300777316093445, "length": 3.657303810119629, "mode": "train", "epoch": 33}
{"loss": 0.31283271312713623, "acc": 0.8975463509559631, "length": 3.3984375, "mode": "test", "epoch": 33}
{"loss": 0.1869303584098816, "acc": 0.934904158115387, "length": 3.5752005577087402, "mode": "train", "epoch": 34}
{"loss": 0.27825093269348145, "acc": 0.901470959186554, "length": 3.7421875, "mode": "test", "epoch": 34}
{"loss": 0.1774187833070755, "acc": 0.9364321231842041, "length": 3.6829781532287598, "mode": "train", "epoch": 35}
{"loss": 0.2834938168525696, "acc": 0.9087585210800171, "length": 3.56640625, "mode": "test", "epoch": 35}
{"loss": 0.1678064912557602, "acc": 0.9453315734863281, "length": 3.831686496734619, "mode": "train", "epoch": 36}
{"loss": 0.26291874051094055, "acc": 0.9099915027618408, "length": 3.87109375, "mode": "test", "epoch": 36}
{"loss": 0.1671477109193802, "acc": 0.9471238255500793, "length": 3.8167614936828613, "mode": "train", "epoch": 37}
{"loss": 0.3497580885887146, "acc": 0.900256335735321, "length": 3.609375, "mode": "test", "epoch": 37}
{"loss": 0.17088496685028076, "acc": 0.9450810551643372, "length": 3.8255655765533447, "mode": "train", "epoch": 38}
{"loss": 0.27938178181648254, "acc": 0.8963196277618408, "length": 3.96875, "mode": "test", "epoch": 38}
{"loss": 0.17093664407730103, "acc": 0.9437090158462524, "length": 3.959325075149536, "mode": "train", "epoch": 39}
{"loss": 0.2827783226966858, "acc": 0.9101867079734802, "length": 3.85546875, "mode": "test", "epoch": 39}
{"loss": 0.15832087397575378, "acc": 0.9489784240722656, "length": 4.042242050170898, "mode": "train", "epoch": 40}
{"loss": 0.2537868320941925, "acc": 0.9239319562911987, "length": 4.07421875, "mode": "test", "epoch": 40}
{"loss": 0.1461803913116455, "acc": 0.953377366065979, "length": 4.107591152191162, "mode": "train", "epoch": 41}
{"loss": 0.26082947850227356, "acc": 0.9200989007949829, "length": 3.83984375, "mode": "test", "epoch": 41}
{"loss": 0.1389717310667038, "acc": 0.9566782712936401, "length": 3.9575343132019043, "mode": "train", "epoch": 42}
{"loss": 0.2327321320772171, "acc": 0.9291931390762329, "length": 3.96875, "mode": "test", "epoch": 42}
{"loss": 0.13155639171600342, "acc": 0.9604991674423218, "length": 4.126109600067139, "mode": "train", "epoch": 43}
{"loss": 0.22471961379051208, "acc": 0.9291564226150513, "length": 4.12109375, "mode": "test", "epoch": 43}
{"loss": 0.12736614048480988, "acc": 0.961463212966919, "length": 4.187103271484375, "mode": "train", "epoch": 44}
{"loss": 0.1956576406955719, "acc": 0.9322082996368408, "length": 4.1875, "mode": "test", "epoch": 44}
{"loss": 0.12520268559455872, "acc": 0.9627846479415894, "length": 4.198914051055908, "mode": "train", "epoch": 45}
{"loss": 0.2166946679353714, "acc": 0.937792956829071, "length": 4.16796875, "mode": "test", "epoch": 45}
{"loss": 0.1166016235947609, "acc": 0.9656988382339478, "length": 4.094095706939697, "mode": "train", "epoch": 46}
{"loss": 0.20318998396396637, "acc": 0.9382873177528381, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.11114408075809479, "acc": 0.9683524370193481, "length": 4.198988914489746, "mode": "train", "epoch": 47}
{"loss": 0.183700829744339, "acc": 0.9462769031524658, "length": 4.1875, "mode": "test", "epoch": 47}
{"loss": 0.10684335231781006, "acc": 0.9708848595619202, "length": 4.14157247543335, "mode": "train", "epoch": 48}
{"loss": 0.19654494524002075, "acc": 0.9368469715118408, "length": 4.1953125, "mode": "test", "epoch": 48}
{"loss": 0.11018595844507217, "acc": 0.9693828821182251, "length": 4.141155242919922, "mode": "train", "epoch": 49}
{"loss": 0.1890495866537094, "acc": 0.940338134765625, "length": 4.05859375, "mode": "test", "epoch": 49}
{"loss": 0.10546586662530899, "acc": 0.9691869616508484, "length": 4.163269519805908, "mode": "train", "epoch": 50}
{"loss": 0.2083570659160614, "acc": 0.938763439655304, "length": 4.19140625, "mode": "test", "epoch": 50}
{"loss": 0.09568314254283905, "acc": 0.9749460220336914, "length": 4.110682487487793, "mode": "train", "epoch": 51}
{"loss": 0.1771995723247528, "acc": 0.943280041217804, "length": 4.046875, "mode": "test", "epoch": 51}
{"loss": 0.08621668070554733, "acc": 0.9785833954811096, "length": 4.112496852874756, "mode": "train", "epoch": 52}
{"loss": 0.1623813807964325, "acc": 0.9453186392784119, "length": 4.07421875, "mode": "test", "epoch": 52}
{"loss": 0.07578728348016739, "acc": 0.9827397465705872, "length": 4.143067836761475, "mode": "train", "epoch": 53}
{"loss": 0.15765205025672913, "acc": 0.9597351551055908, "length": 4.21875, "mode": "test", "epoch": 53}
{"loss": 0.07635597884654999, "acc": 0.9832785725593567, "length": 4.335168838500977, "mode": "train", "epoch": 54}
{"loss": 0.152835875749588, "acc": 0.9592711925506592, "length": 4.19921875, "mode": "test", "epoch": 54}
{"loss": 0.07220109552145004, "acc": 0.9848041534423828, "length": 4.436511516571045, "mode": "train", "epoch": 55}
{"loss": 0.14472459256649017, "acc": 0.959820568561554, "length": 4.30859375, "mode": "test", "epoch": 55}
{"loss": 0.06910043954849243, "acc": 0.9863724112510681, "length": 4.341554641723633, "mode": "train", "epoch": 56}
{"loss": 0.14372552931308746, "acc": 0.962512195110321, "length": 4.30078125, "mode": "test", "epoch": 56}
{"loss": 0.05792420357465744, "acc": 0.9903144836425781, "length": 4.298007965087891, "mode": "train", "epoch": 57}
{"loss": 0.12490511685609818, "acc": 0.9738280773162842, "length": 4.22265625, "mode": "test", "epoch": 57}
{"loss": 0.06450115144252777, "acc": 0.9866768717765808, "length": 4.31488037109375, "mode": "train", "epoch": 58}
{"loss": 0.17531877756118774, "acc": 0.957995593547821, "length": 4.390625, "mode": "test", "epoch": 58}
{"loss": 0.08166258782148361, "acc": 0.9796755909919739, "length": 4.397328853607178, "mode": "train", "epoch": 59}
{"loss": 0.13760656118392944, "acc": 0.9680114388465881, "length": 4.44140625, "mode": "test", "epoch": 59}
{"loss": 0.06308752298355103, "acc": 0.988520622253418, "length": 4.463998794555664, "mode": "train", "epoch": 60}
{"loss": 0.1393004208803177, "acc": 0.965087890625, "length": 4.47265625, "mode": "test", "epoch": 60}
test accuracy: 0.9076771140098572
