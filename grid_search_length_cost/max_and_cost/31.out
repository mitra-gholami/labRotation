# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7176180481910706, "acc": 0.5251958966255188, "length": 4.702573776245117, "mode": "train", "epoch": 1}
{"loss": 0.6911418437957764, "acc": 0.5661458373069763, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6948211193084717, "acc": 0.5450747609138489, "length": 1.0864990949630737, "mode": "train", "epoch": 2}
{"loss": 0.6895369291305542, "acc": 0.5685763955116272, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.693993091583252, "acc": 0.5493752956390381, "length": 1.0410497188568115, "mode": "train", "epoch": 3}
{"loss": 0.6907806992530823, "acc": 0.5619791150093079, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6937278509140015, "acc": 0.5417784452438354, "length": 1.0287609100341797, "mode": "train", "epoch": 4}
{"loss": 0.68809574842453, "acc": 0.5730902552604675, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6931814551353455, "acc": 0.5454729795455933, "length": 1.0204354524612427, "mode": "train", "epoch": 5}
{"loss": 0.6881635785102844, "acc": 0.5711805820465088, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6933296322822571, "acc": 0.550470232963562, "length": 1.014333724975586, "mode": "train", "epoch": 6}
{"loss": 0.6884697079658508, "acc": 0.5616319179534912, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6946357488632202, "acc": 0.5432629585266113, "length": 1.0109789371490479, "mode": "train", "epoch": 7}
{"loss": 0.6893096566200256, "acc": 0.5666666626930237, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6926039457321167, "acc": 0.5430122017860413, "length": 1.0099647045135498, "mode": "train", "epoch": 8}
{"loss": 0.6879494190216064, "acc": 0.5730902552604675, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6939058899879456, "acc": 0.5486940145492554, "length": 1.0086069107055664, "mode": "train", "epoch": 9}
{"loss": 0.6891233325004578, "acc": 0.5685763955116272, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6920303702354431, "acc": 0.5486834049224854, "length": 1.008671760559082, "mode": "train", "epoch": 10}
{"loss": 0.6871892809867859, "acc": 0.5685763955116272, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6921584010124207, "acc": 0.5436848998069763, "length": 1.012116551399231, "mode": "train", "epoch": 11}
{"loss": 0.6893408894538879, "acc": 0.5730902552604675, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.672932505607605, "acc": 0.604750394821167, "length": 1.6733852624893188, "mode": "train", "epoch": 12}
{"loss": 0.6388084888458252, "acc": 0.7065538167953491, "length": 4.99305534362793, "mode": "test", "epoch": 12}
{"loss": 0.5852281451225281, "acc": 0.7188181281089783, "length": 2.0410919189453125, "mode": "train", "epoch": 13}
{"loss": 0.5965403914451599, "acc": 0.6973633170127869, "length": 1.3784722089767456, "mode": "test", "epoch": 13}
{"loss": 0.560005247592926, "acc": 0.7291083335876465, "length": 1.7691482305526733, "mode": "train", "epoch": 14}
{"loss": 0.588834285736084, "acc": 0.7122124433517456, "length": 1.5590277910232544, "mode": "test", "epoch": 14}
{"loss": 0.5421081781387329, "acc": 0.7515943050384521, "length": 1.8598406314849854, "mode": "train", "epoch": 15}
{"loss": 0.5467455983161926, "acc": 0.7270020246505737, "length": 1.7569444179534912, "mode": "test", "epoch": 15}
{"loss": 0.5176868438720703, "acc": 0.7726256847381592, "length": 2.1644816398620605, "mode": "train", "epoch": 16}
{"loss": 0.5161197185516357, "acc": 0.7754991054534912, "length": 2.03125, "mode": "test", "epoch": 16}
{"loss": 0.498012512922287, "acc": 0.7865482568740845, "length": 2.154151439666748, "mode": "train", "epoch": 17}
{"loss": 0.49917787313461304, "acc": 0.7842773199081421, "length": 1.9722222089767456, "mode": "test", "epoch": 17}
{"loss": 0.48392897844314575, "acc": 0.7919478416442871, "length": 2.083061456680298, "mode": "train", "epoch": 18}
{"loss": 0.5083998441696167, "acc": 0.7720540761947632, "length": 1.96875, "mode": "test", "epoch": 18}
{"loss": 0.4674686789512634, "acc": 0.8001823425292969, "length": 2.1778981685638428, "mode": "train", "epoch": 19}
{"loss": 0.4747123718261719, "acc": 0.7976237535476685, "length": 1.9131944179534912, "mode": "test", "epoch": 19}
{"loss": 0.4259653389453888, "acc": 0.8181124925613403, "length": 2.2581632137298584, "mode": "train", "epoch": 20}
{"loss": 0.4411557912826538, "acc": 0.8062012195587158, "length": 2.097222328186035, "mode": "test", "epoch": 20}
{"loss": 0.3936886787414551, "acc": 0.828626811504364, "length": 2.5025105476379395, "mode": "train", "epoch": 21}
{"loss": 0.4071926176548004, "acc": 0.8241102695465088, "length": 2.288194417953491, "mode": "test", "epoch": 21}
{"loss": 0.3618335425853729, "acc": 0.8437952995300293, "length": 2.665621280670166, "mode": "train", "epoch": 22}
{"loss": 0.3711699843406677, "acc": 0.8417642712593079, "length": 2.680555582046509, "mode": "test", "epoch": 22}
{"loss": 0.335031658411026, "acc": 0.8661989569664001, "length": 3.1113884449005127, "mode": "train", "epoch": 23}
{"loss": 0.36863455176353455, "acc": 0.8504124283790588, "length": 2.809027671813965, "mode": "test", "epoch": 23}
{"loss": 0.3043854832649231, "acc": 0.8781369924545288, "length": 3.046649932861328, "mode": "train", "epoch": 24}
{"loss": 0.3397882580757141, "acc": 0.8729817271232605, "length": 3.006944417953491, "mode": "test", "epoch": 24}
{"loss": 0.2778709828853607, "acc": 0.8923598527908325, "length": 3.2469334602355957, "mode": "train", "epoch": 25}
{"loss": 0.3172413408756256, "acc": 0.8768718242645264, "length": 3.1666667461395264, "mode": "test", "epoch": 25}
{"loss": 0.26848697662353516, "acc": 0.8970381021499634, "length": 3.368251085281372, "mode": "train", "epoch": 26}
{"loss": 0.326037734746933, "acc": 0.8734157681465149, "length": 2.9548611640930176, "mode": "test", "epoch": 26}
{"loss": 0.26051080226898193, "acc": 0.9009279608726501, "length": 3.308972120285034, "mode": "train", "epoch": 27}
{"loss": 0.3219778835773468, "acc": 0.883029580116272, "length": 3.180555582046509, "mode": "test", "epoch": 27}
{"loss": 0.25766465067863464, "acc": 0.9024094343185425, "length": 3.283365488052368, "mode": "train", "epoch": 28}
{"loss": 0.29343658685684204, "acc": 0.8917969465255737, "length": 3.069444417953491, "mode": "test", "epoch": 28}
{"loss": 0.24654023349285126, "acc": 0.9085468649864197, "length": 3.454986095428467, "mode": "train", "epoch": 29}
{"loss": 0.3067839741706848, "acc": 0.8873589634895325, "length": 3.506944417953491, "mode": "test", "epoch": 29}
{"loss": 0.23796308040618896, "acc": 0.9140738844871521, "length": 3.5209736824035645, "mode": "train", "epoch": 30}
{"loss": 0.28756654262542725, "acc": 0.8979600071907043, "length": 3.475694417953491, "mode": "test", "epoch": 30}
{"loss": 0.22409380972385406, "acc": 0.9210121631622314, "length": 3.540009021759033, "mode": "train", "epoch": 31}
{"loss": 0.2561398148536682, "acc": 0.9123427271842957, "length": 3.555555582046509, "mode": "test", "epoch": 31}
{"loss": 0.21665486693382263, "acc": 0.9244340658187866, "length": 3.7537119388580322, "mode": "train", "epoch": 32}
{"loss": 0.2924177944660187, "acc": 0.9074381589889526, "length": 3.7604167461395264, "mode": "test", "epoch": 32}
{"loss": 0.20352289080619812, "acc": 0.9302331209182739, "length": 3.8249335289001465, "mode": "train", "epoch": 33}
{"loss": 0.2470143884420395, "acc": 0.9141981601715088, "length": 3.621527671813965, "mode": "test", "epoch": 33}
{"loss": 0.19321857392787933, "acc": 0.936203122138977, "length": 4.018683910369873, "mode": "train", "epoch": 34}
{"loss": 0.23722825944423676, "acc": 0.9142739772796631, "length": 4.052083492279053, "mode": "test", "epoch": 34}
{"loss": 0.18335166573524475, "acc": 0.9422746896743774, "length": 4.071160316467285, "mode": "train", "epoch": 35}
{"loss": 0.23919609189033508, "acc": 0.9275553226470947, "length": 4.21180534362793, "mode": "test", "epoch": 35}
{"loss": 0.17488467693328857, "acc": 0.945854902267456, "length": 4.04927921295166, "mode": "train", "epoch": 36}
{"loss": 0.21217142045497894, "acc": 0.9309245347976685, "length": 3.96875, "mode": "test", "epoch": 36}
{"loss": 0.16920879483222961, "acc": 0.9470180869102478, "length": 4.035277366638184, "mode": "train", "epoch": 37}
{"loss": 0.2207670509815216, "acc": 0.9296115040779114, "length": 3.972222328186035, "mode": "test", "epoch": 37}
{"loss": 0.16108065843582153, "acc": 0.9485456347465515, "length": 4.18615198135376, "mode": "train", "epoch": 38}
{"loss": 0.2297852635383606, "acc": 0.9289985299110413, "length": 4.60069465637207, "mode": "test", "epoch": 38}
{"loss": 0.1600467413663864, "acc": 0.9490947723388672, "length": 4.15893030166626, "mode": "train", "epoch": 39}
{"loss": 0.22809620201587677, "acc": 0.9332466125488281, "length": 4.097222328186035, "mode": "test", "epoch": 39}
{"loss": 0.15313413739204407, "acc": 0.9529914855957031, "length": 4.220471382141113, "mode": "train", "epoch": 40}
{"loss": 0.20433075726032257, "acc": 0.939800500869751, "length": 4.25, "mode": "test", "epoch": 40}
{"loss": 0.14634917676448822, "acc": 0.9560827016830444, "length": 4.22102689743042, "mode": "train", "epoch": 41}
{"loss": 0.1985476315021515, "acc": 0.941558301448822, "length": 4.19444465637207, "mode": "test", "epoch": 41}
{"loss": 0.14531227946281433, "acc": 0.9526234865188599, "length": 4.234360218048096, "mode": "train", "epoch": 42}
{"loss": 0.17962583899497986, "acc": 0.9450738430023193, "length": 4.260416507720947, "mode": "test", "epoch": 42}
{"loss": 0.14397306740283966, "acc": 0.9563412666320801, "length": 4.098390579223633, "mode": "train", "epoch": 43}
{"loss": 0.19261051714420319, "acc": 0.9411242008209229, "length": 4.375, "mode": "test", "epoch": 43}
{"loss": 0.13653673231601715, "acc": 0.9585907459259033, "length": 4.2739338874816895, "mode": "train", "epoch": 44}
{"loss": 0.1667838841676712, "acc": 0.9514052271842957, "length": 4.15625, "mode": "test", "epoch": 44}
{"loss": 0.1348111778497696, "acc": 0.9587034583091736, "length": 4.223654270172119, "mode": "train", "epoch": 45}
{"loss": 0.16621579229831696, "acc": 0.9532009959220886, "length": 4.14930534362793, "mode": "test", "epoch": 45}
{"loss": 0.13058069348335266, "acc": 0.9609870910644531, "length": 4.306118488311768, "mode": "train", "epoch": 46}
{"loss": 0.17274299263954163, "acc": 0.9514377117156982, "length": 4.277777671813965, "mode": "test", "epoch": 46}
{"loss": 0.11968016624450684, "acc": 0.9644595980644226, "length": 4.280569553375244, "mode": "train", "epoch": 47}
{"loss": 0.20372380316257477, "acc": 0.9440538883209229, "length": 4.125, "mode": "test", "epoch": 47}
{"loss": 0.12526114284992218, "acc": 0.9626644253730774, "length": 4.1959686279296875, "mode": "train", "epoch": 48}
{"loss": 0.16767042875289917, "acc": 0.9516710638999939, "length": 4.260416507720947, "mode": "test", "epoch": 48}
{"loss": 0.12026629596948624, "acc": 0.9650663137435913, "length": 4.397277355194092, "mode": "train", "epoch": 49}
{"loss": 0.16945059597492218, "acc": 0.9528591632843018, "length": 4.545138835906982, "mode": "test", "epoch": 49}
{"loss": 0.11287351697683334, "acc": 0.9693292379379272, "length": 4.338250160217285, "mode": "train", "epoch": 50}
{"loss": 0.16549888253211975, "acc": 0.9556966423988342, "length": 4.388888835906982, "mode": "test", "epoch": 50}
{"loss": 0.10053911060094833, "acc": 0.9747563600540161, "length": 4.4325456619262695, "mode": "train", "epoch": 51}
{"loss": 0.17373067140579224, "acc": 0.9540526270866394, "length": 4.3125, "mode": "test", "epoch": 51}
{"loss": 0.12067189067602158, "acc": 0.9635322093963623, "length": 4.284872055053711, "mode": "train", "epoch": 52}
{"loss": 0.1499687284231186, "acc": 0.9561849236488342, "length": 4.309027671813965, "mode": "test", "epoch": 52}
{"loss": 0.11523991078138351, "acc": 0.9670515060424805, "length": 4.4256205558776855, "mode": "train", "epoch": 53}
{"loss": 0.15113742649555206, "acc": 0.9538790583610535, "length": 4.33680534362793, "mode": "test", "epoch": 53}
{"loss": 0.10603492707014084, "acc": 0.9718300104141235, "length": 4.444558620452881, "mode": "train", "epoch": 54}
{"loss": 0.13122691214084625, "acc": 0.9629991054534912, "length": 4.673611164093018, "mode": "test", "epoch": 54}
{"loss": 0.0935211032629013, "acc": 0.9766831994056702, "length": 4.479031562805176, "mode": "train", "epoch": 55}
{"loss": 0.12268517911434174, "acc": 0.9655055999755859, "length": 4.659722328186035, "mode": "test", "epoch": 55}
{"loss": 0.08567395806312561, "acc": 0.9803324937820435, "length": 4.56886625289917, "mode": "train", "epoch": 56}
{"loss": 0.11206783354282379, "acc": 0.9733344316482544, "length": 4.642361164093018, "mode": "test", "epoch": 56}
{"loss": 0.08203040808439255, "acc": 0.9805910587310791, "length": 4.6059088706970215, "mode": "train", "epoch": 57}
{"loss": 0.1295548975467682, "acc": 0.9680610299110413, "length": 4.55555534362793, "mode": "test", "epoch": 57}
{"loss": 0.07801036536693573, "acc": 0.9828667640686035, "length": 4.5492262840271, "mode": "train", "epoch": 58}
{"loss": 0.1271575391292572, "acc": 0.968994140625, "length": 4.40625, "mode": "test", "epoch": 58}
{"loss": 0.07398749887943268, "acc": 0.9836402535438538, "length": 4.417225360870361, "mode": "train", "epoch": 59}
{"loss": 0.10424371808767319, "acc": 0.9708387851715088, "length": 4.222222328186035, "mode": "test", "epoch": 59}
{"loss": 0.06898530572652817, "acc": 0.9850964546203613, "length": 4.393146991729736, "mode": "train", "epoch": 60}
{"loss": 0.11409006267786026, "acc": 0.9708116054534912, "length": 4.28125, "mode": "test", "epoch": 60}
test accuracy: 0.8095635175704956
