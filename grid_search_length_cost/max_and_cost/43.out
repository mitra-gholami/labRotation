# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 30
{"loss": 0.7177551984786987, "acc": 0.522408664226532, "length": 4.722846984863281, "mode": "train", "epoch": 1}
{"loss": 0.6962783932685852, "acc": 0.516406238079071, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6944878101348877, "acc": 0.5438095927238464, "length": 1.064926028251648, "mode": "train", "epoch": 2}
{"loss": 0.6957048773765564, "acc": 0.5441405773162842, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6949954628944397, "acc": 0.5424821972846985, "length": 1.0311962366104126, "mode": "train", "epoch": 3}
{"loss": 0.6950715780258179, "acc": 0.523242175579071, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6945720911026001, "acc": 0.5320079922676086, "length": 1.0207479000091553, "mode": "train", "epoch": 4}
{"loss": 0.6958484649658203, "acc": 0.5296874642372131, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6957191228866577, "acc": 0.5407898426055908, "length": 1.0163558721542358, "mode": "train", "epoch": 5}
{"loss": 0.7005006074905396, "acc": 0.507617175579071, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6948665976524353, "acc": 0.5432941317558289, "length": 1.0133237838745117, "mode": "train", "epoch": 6}
{"loss": 0.6956326961517334, "acc": 0.5441405773162842, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6944468021392822, "acc": 0.5370742678642273, "length": 1.0096312761306763, "mode": "train", "epoch": 7}
{"loss": 0.6953818202018738, "acc": 0.5328125357627869, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6943002939224243, "acc": 0.5452924966812134, "length": 1.0077852010726929, "mode": "train", "epoch": 8}
{"loss": 0.6972079277038574, "acc": 0.5322265625, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.694977879524231, "acc": 0.5386050343513489, "length": 1.006165862083435, "mode": "train", "epoch": 9}
{"loss": 0.6946190595626831, "acc": 0.5484375357627869, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.693891167640686, "acc": 0.5478525757789612, "length": 1.0049666166305542, "mode": "train", "epoch": 10}
{"loss": 0.6962815523147583, "acc": 0.523242175579071, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.69400554895401, "acc": 0.5437681674957275, "length": 1.0042363405227661, "mode": "train", "epoch": 11}
{"loss": 0.6939396858215332, "acc": 0.5503906607627869, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6934581398963928, "acc": 0.5429659485816956, "length": 1.0032663345336914, "mode": "train", "epoch": 12}
{"loss": 0.6949948072433472, "acc": 0.5441405773162842, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6942893862724304, "acc": 0.5378153324127197, "length": 1.0029985904693604, "mode": "train", "epoch": 13}
{"loss": 0.6967491507530212, "acc": 0.5279297232627869, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6938778162002563, "acc": 0.5445501804351807, "length": 1.0023937225341797, "mode": "train", "epoch": 14}
{"loss": 0.6960960626602173, "acc": 0.53125, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6934389472007751, "acc": 0.5388671159744263, "length": 1.0020190477371216, "mode": "train", "epoch": 15}
{"loss": 0.6943606734275818, "acc": 0.541796863079071, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6933329105377197, "acc": 0.538994550704956, "length": 1.001818060874939, "mode": "train", "epoch": 16}
{"loss": 0.6964200735092163, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6927989721298218, "acc": 0.5414581894874573, "length": 1.001637578010559, "mode": "train", "epoch": 17}
{"loss": 0.6953772902488708, "acc": 0.525585949420929, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6923129558563232, "acc": 0.5440253019332886, "length": 1.001339077949524, "mode": "train", "epoch": 18}
{"loss": 0.6952295303344727, "acc": 0.53125, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6930869817733765, "acc": 0.5398704409599304, "length": 1.00119948387146, "mode": "train", "epoch": 19}
{"loss": 0.6953309178352356, "acc": 0.5296874642372131, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6925979256629944, "acc": 0.5422132015228271, "length": 1.0011261701583862, "mode": "train", "epoch": 20}
{"loss": 0.6949506998062134, "acc": 0.5335937142372131, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6923951506614685, "acc": 0.5375849604606628, "length": 1.0009602308273315, "mode": "train", "epoch": 21}
{"loss": 0.6949384808540344, "acc": 0.53125, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6931796669960022, "acc": 0.5448462963104248, "length": 1.0008527040481567, "mode": "train", "epoch": 22}
{"loss": 0.6963524222373962, "acc": 0.5248046517372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6920692324638367, "acc": 0.538465678691864, "length": 1.0007219314575195, "mode": "train", "epoch": 23}
{"loss": 0.6947059035301208, "acc": 0.506640613079071, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6926504373550415, "acc": 0.5445510745048523, "length": 1.0006557703018188, "mode": "train", "epoch": 24}
{"loss": 0.6959348320960999, "acc": 0.5248046517372131, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6925889253616333, "acc": 0.5464866161346436, "length": 1.000588297843933, "mode": "train", "epoch": 25}
{"loss": 0.6950985193252563, "acc": 0.53125, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6915473937988281, "acc": 0.5406894087791443, "length": 1.0004745721817017, "mode": "train", "epoch": 26}
{"loss": 0.696368932723999, "acc": 0.5103515982627869, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6915632486343384, "acc": 0.5402217507362366, "length": 1.0004624128341675, "mode": "train", "epoch": 27}
{"loss": 0.6946265697479248, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6912822723388672, "acc": 0.5405150651931763, "length": 1.0003983974456787, "mode": "train", "epoch": 28}
{"loss": 0.6956976056098938, "acc": 0.525585949420929, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6915432810783386, "acc": 0.5385840535163879, "length": 1.0003588199615479, "mode": "train", "epoch": 29}
{"loss": 0.6976195573806763, "acc": 0.5052734017372131, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6909907460212708, "acc": 0.5386995673179626, "length": 1.0003283023834229, "mode": "train", "epoch": 30}
{"loss": 0.6958803534507751, "acc": 0.5328125357627869, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6913807988166809, "acc": 0.5477750301361084, "length": 1.0002750158309937, "mode": "train", "epoch": 31}
{"loss": 0.6962071061134338, "acc": 0.507617175579071, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6906759738922119, "acc": 0.5462526679039001, "length": 1.0002732276916504, "mode": "train", "epoch": 32}
{"loss": 0.6956362128257751, "acc": 0.5240234732627869, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6906353831291199, "acc": 0.549472451210022, "length": 1.0002367496490479, "mode": "train", "epoch": 33}
{"loss": 0.6954407095909119, "acc": 0.5142578482627869, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.690652072429657, "acc": 0.5454890131950378, "length": 1.0002237558364868, "mode": "train", "epoch": 34}
{"loss": 0.695258617401123, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.691886842250824, "acc": 0.5499417185783386, "length": 1.000186562538147, "mode": "train", "epoch": 35}
{"loss": 0.6947329640388489, "acc": 0.5267577767372131, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.690209686756134, "acc": 0.5431494116783142, "length": 1.000184178352356, "mode": "train", "epoch": 36}
{"loss": 0.695521354675293, "acc": 0.5095703601837158, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6904153227806091, "acc": 0.5420377254486084, "length": 1.0001672506332397, "mode": "train", "epoch": 37}
{"loss": 0.6950913667678833, "acc": 0.5314454436302185, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6893386840820312, "acc": 0.5449054837226868, "length": 1.0001825094223022, "mode": "train", "epoch": 38}
{"loss": 0.6950485706329346, "acc": 0.5134766101837158, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6895459294319153, "acc": 0.5473653674125671, "length": 1.000139594078064, "mode": "train", "epoch": 39}
{"loss": 0.6936750411987305, "acc": 0.5244140625, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6894664764404297, "acc": 0.5387002825737, "length": 1.0001541376113892, "mode": "train", "epoch": 40}
{"loss": 0.6958754062652588, "acc": 0.5119140148162842, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6892881989479065, "acc": 0.5383492112159729, "length": 1.0001188516616821, "mode": "train", "epoch": 41}
{"loss": 0.6957169771194458, "acc": 0.507617175579071, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6880531311035156, "acc": 0.5502338409423828, "length": 1.0001311302185059, "mode": "train", "epoch": 42}
{"loss": 0.6964474320411682, "acc": 0.5134766101837158, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.690428614616394, "acc": 0.5408081412315369, "length": 1.0001215934753418, "mode": "train", "epoch": 43}
{"loss": 0.6941125988960266, "acc": 0.5306640267372131, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6891087293624878, "acc": 0.5474823117256165, "length": 1.000265121459961, "mode": "train", "epoch": 44}
{"loss": 0.6970003247261047, "acc": 0.5095703601837158, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6882756352424622, "acc": 0.5425059199333191, "length": 1.000160574913025, "mode": "train", "epoch": 45}
{"loss": 0.6944871544837952, "acc": 0.5248046517372131, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6885279417037964, "acc": 0.5486551523208618, "length": 1.0004128217697144, "mode": "train", "epoch": 46}
{"loss": 0.6957656741142273, "acc": 0.5074219107627869, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6874279379844666, "acc": 0.5514833927154541, "length": 1.1281758546829224, "mode": "train", "epoch": 47}
{"loss": 0.6785081028938293, "acc": 0.5965515375137329, "length": 1.2890625, "mode": "test", "epoch": 47}
{"loss": 0.6040018796920776, "acc": 0.6857144236564636, "length": 1.7115962505340576, "mode": "train", "epoch": 48}
{"loss": 0.5761651992797852, "acc": 0.6996093392372131, "length": 1.31640625, "mode": "test", "epoch": 48}
{"loss": 0.5515981912612915, "acc": 0.7142021656036377, "length": 1.3008761405944824, "mode": "train", "epoch": 49}
{"loss": 0.5466247200965881, "acc": 0.701824963092804, "length": 1.296875, "mode": "test", "epoch": 49}
{"loss": 0.5454639792442322, "acc": 0.7218102812767029, "length": 1.3198118209838867, "mode": "train", "epoch": 50}
{"loss": 0.5405454635620117, "acc": 0.7015747427940369, "length": 1.296875, "mode": "test", "epoch": 50}
{"loss": 0.5342601537704468, "acc": 0.7211429476737976, "length": 1.3121247291564941, "mode": "train", "epoch": 51}
{"loss": 0.531121015548706, "acc": 0.7045044302940369, "length": 1.296875, "mode": "test", "epoch": 51}
{"loss": 0.5307362079620361, "acc": 0.7190477252006531, "length": 1.3018231391906738, "mode": "train", "epoch": 52}
{"loss": 0.5340946912765503, "acc": 0.7021484375, "length": 1.296875, "mode": "test", "epoch": 52}
{"loss": 0.5285133123397827, "acc": 0.7188705205917358, "length": 1.3101468086242676, "mode": "train", "epoch": 53}
{"loss": 0.5413243770599365, "acc": 0.7126953601837158, "length": 1.3046875, "mode": "test", "epoch": 53}
{"loss": 0.5281500220298767, "acc": 0.7231572270393372, "length": 1.3030996322631836, "mode": "train", "epoch": 54}
{"loss": 0.5379937887191772, "acc": 0.7015624642372131, "length": 1.30078125, "mode": "test", "epoch": 54}
{"loss": 0.5264422297477722, "acc": 0.7244057059288025, "length": 1.309966802597046, "mode": "train", "epoch": 55}
{"loss": 0.5336906909942627, "acc": 0.7036988139152527, "length": 1.30078125, "mode": "test", "epoch": 55}
{"loss": 0.5237342715263367, "acc": 0.7222232818603516, "length": 1.314184546470642, "mode": "train", "epoch": 56}
{"loss": 0.5374107360839844, "acc": 0.703033447265625, "length": 1.296875, "mode": "test", "epoch": 56}
{"loss": 0.5246036648750305, "acc": 0.7241982221603394, "length": 1.3328850269317627, "mode": "train", "epoch": 57}
{"loss": 0.5310688018798828, "acc": 0.702014148235321, "length": 1.296875, "mode": "test", "epoch": 57}
{"loss": 0.5147639513015747, "acc": 0.7232237458229065, "length": 1.3722058534622192, "mode": "train", "epoch": 58}
{"loss": 0.5314970016479492, "acc": 0.701586902141571, "length": 1.359375, "mode": "test", "epoch": 58}
{"loss": 0.4961671531200409, "acc": 0.7403457164764404, "length": 1.6775344610214233, "mode": "train", "epoch": 59}
{"loss": 0.5131420493125916, "acc": 0.738110363483429, "length": 1.75, "mode": "test", "epoch": 59}
{"loss": 0.46465450525283813, "acc": 0.7767758369445801, "length": 1.9595308303833008, "mode": "train", "epoch": 60}
{"loss": 0.478326678276062, "acc": 0.7801636457443237, "length": 1.8125, "mode": "test", "epoch": 60}
test accuracy: 0.617524266242981
