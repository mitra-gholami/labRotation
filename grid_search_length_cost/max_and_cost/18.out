# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7137863636016846, "acc": 0.5189555883407593, "length": 3.782360553741455, "mode": "train", "epoch": 1}
{"loss": 0.6943770051002502, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.699184775352478, "acc": 0.5201650857925415, "length": 1.0709238052368164, "mode": "train", "epoch": 2}
{"loss": 0.6957459449768066, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.698289155960083, "acc": 0.5322431921958923, "length": 1.0275211334228516, "mode": "train", "epoch": 3}
{"loss": 0.6937683820724487, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.697272002696991, "acc": 0.5122961401939392, "length": 1.0167044401168823, "mode": "train", "epoch": 4}
{"loss": 0.6943806409835815, "acc": 0.5279297232627869, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6967414021492004, "acc": 0.5181427001953125, "length": 1.012549877166748, "mode": "train", "epoch": 5}
{"loss": 0.6941367983818054, "acc": 0.5425781607627869, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6961604952812195, "acc": 0.5263482928276062, "length": 1.0092768669128418, "mode": "train", "epoch": 6}
{"loss": 0.6948437094688416, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6954940557479858, "acc": 0.5361799597740173, "length": 1.007262945175171, "mode": "train", "epoch": 7}
{"loss": 0.694552481174469, "acc": 0.531054675579071, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.695191502571106, "acc": 0.5298182964324951, "length": 1.0057491064071655, "mode": "train", "epoch": 8}
{"loss": 0.6953201293945312, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6959828734397888, "acc": 0.5301945805549622, "length": 1.004418134689331, "mode": "train", "epoch": 9}
{"loss": 0.6941713094711304, "acc": 0.5376953482627869, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6951417326927185, "acc": 0.5335797667503357, "length": 1.0036863088607788, "mode": "train", "epoch": 10}
{"loss": 0.6932518482208252, "acc": 0.548046886920929, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6953993439674377, "acc": 0.5357202291488647, "length": 1.0029047727584839, "mode": "train", "epoch": 11}
{"loss": 0.6935479044914246, "acc": 0.5205078125, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6946304440498352, "acc": 0.5259331464767456, "length": 1.00248122215271, "mode": "train", "epoch": 12}
{"loss": 0.6936920285224915, "acc": 0.539843738079071, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6945247650146484, "acc": 0.5452195405960083, "length": 1.0021426677703857, "mode": "train", "epoch": 13}
{"loss": 0.6935307383537292, "acc": 0.5318359732627869, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6941375136375427, "acc": 0.5341825485229492, "length": 1.0019445419311523, "mode": "train", "epoch": 14}
{"loss": 0.692244291305542, "acc": 0.5541015267372131, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6940466165542603, "acc": 0.5399647951126099, "length": 1.0017433166503906, "mode": "train", "epoch": 15}
{"loss": 0.6927535533905029, "acc": 0.5494140982627869, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6945582628250122, "acc": 0.541437566280365, "length": 1.0014691352844238, "mode": "train", "epoch": 16}
{"loss": 0.6929342746734619, "acc": 0.53125, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6954312324523926, "acc": 0.5447415113449097, "length": 1.0011677742004395, "mode": "train", "epoch": 17}
{"loss": 0.6905932426452637, "acc": 0.564648449420929, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6934947967529297, "acc": 0.5491087436676025, "length": 1.0010929107666016, "mode": "train", "epoch": 18}
{"loss": 0.6934245824813843, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6937663555145264, "acc": 0.5441545248031616, "length": 1.0009301900863647, "mode": "train", "epoch": 19}
{"loss": 0.691612720489502, "acc": 0.55078125, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6935718059539795, "acc": 0.5439775586128235, "length": 1.0007333755493164, "mode": "train", "epoch": 20}
{"loss": 0.6911572813987732, "acc": 0.5494140982627869, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6927741765975952, "acc": 0.5488213896751404, "length": 1.0006616115570068, "mode": "train", "epoch": 21}
{"loss": 0.6912846565246582, "acc": 0.560742199420929, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6925244331359863, "acc": 0.5446274280548096, "length": 1.0006095170974731, "mode": "train", "epoch": 22}
{"loss": 0.6922014355659485, "acc": 0.5345702767372131, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6928834319114685, "acc": 0.5462759733200073, "length": 1.0005855560302734, "mode": "train", "epoch": 23}
{"loss": 0.6922333836555481, "acc": 0.546093761920929, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6919153332710266, "acc": 0.5479323267936707, "length": 1.0005158185958862, "mode": "train", "epoch": 24}
{"loss": 0.6898296475410461, "acc": 0.5607421398162842, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6914320588111877, "acc": 0.5382524728775024, "length": 1.0004440546035767, "mode": "train", "epoch": 25}
{"loss": 0.6896010041236877, "acc": 0.560742199420929, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.691850483417511, "acc": 0.5505856275558472, "length": 1.0003505945205688, "mode": "train", "epoch": 26}
{"loss": 0.6877322196960449, "acc": 0.5607421398162842, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6908551454544067, "acc": 0.5563744306564331, "length": 1.0003825426101685, "mode": "train", "epoch": 27}
{"loss": 0.6891036033630371, "acc": 0.546093761920929, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6892139315605164, "acc": 0.5550139546394348, "length": 1.0003381967544556, "mode": "train", "epoch": 28}
{"loss": 0.6877642273902893, "acc": 0.55078125, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6905338764190674, "acc": 0.5518895387649536, "length": 1.0002387762069702, "mode": "train", "epoch": 29}
{"loss": 0.6916051506996155, "acc": 0.557421863079071, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6895225644111633, "acc": 0.556315004825592, "length": 1.0002028942108154, "mode": "train", "epoch": 30}
{"loss": 0.686866283416748, "acc": 0.5580077767372131, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.689979612827301, "acc": 0.5416162014007568, "length": 1.0001848936080933, "mode": "train", "epoch": 31}
{"loss": 0.6912770867347717, "acc": 0.5574219226837158, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6885767579078674, "acc": 0.5505900979042053, "length": 1.0001775026321411, "mode": "train", "epoch": 32}
{"loss": 0.6856138706207275, "acc": 0.5681641101837158, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6881595253944397, "acc": 0.5610969662666321, "length": 1.0001517534255981, "mode": "train", "epoch": 33}
{"loss": 0.6870350241661072, "acc": 0.546093761920929, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6876730918884277, "acc": 0.5496447682380676, "length": 1.0001444816589355, "mode": "train", "epoch": 34}
{"loss": 0.6864924430847168, "acc": 0.5541015267372131, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6875663995742798, "acc": 0.5571418404579163, "length": 1.0001202821731567, "mode": "train", "epoch": 35}
{"loss": 0.685636043548584, "acc": 0.5541015267372131, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6872187256813049, "acc": 0.5572595000267029, "length": 1.00011146068573, "mode": "train", "epoch": 36}
{"loss": 0.686991274356842, "acc": 0.5574219226837158, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6871735453605652, "acc": 0.5554300546646118, "length": 1.0001466274261475, "mode": "train", "epoch": 37}
{"loss": 0.6848718523979187, "acc": 0.568164050579071, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6872650980949402, "acc": 0.5537770986557007, "length": 1.0000823736190796, "mode": "train", "epoch": 38}
{"loss": 0.6865664124488831, "acc": 0.560546875, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6860899329185486, "acc": 0.5567296147346497, "length": 1.0000698566436768, "mode": "train", "epoch": 39}
{"loss": 0.6844035983085632, "acc": 0.5615234375, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.686149537563324, "acc": 0.5556666851043701, "length": 1.0000648498535156, "mode": "train", "epoch": 40}
{"loss": 0.6854281425476074, "acc": 0.571484386920929, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6863856315612793, "acc": 0.5663509368896484, "length": 1.0000625848770142, "mode": "train", "epoch": 41}
{"loss": 0.6845677495002747, "acc": 0.5789062976837158, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6861414313316345, "acc": 0.5610384941101074, "length": 1.0000545978546143, "mode": "train", "epoch": 42}
{"loss": 0.6850012540817261, "acc": 0.5531249642372131, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6853716373443604, "acc": 0.556906521320343, "length": 1.0000498294830322, "mode": "train", "epoch": 43}
{"loss": 0.6847876310348511, "acc": 0.560546875, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6858245730400085, "acc": 0.553600549697876, "length": 1.0000466108322144, "mode": "train", "epoch": 44}
{"loss": 0.684826672077179, "acc": 0.5531249642372131, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6855064034461975, "acc": 0.5586777329444885, "length": 1.0000349283218384, "mode": "train", "epoch": 45}
{"loss": 0.6831827163696289, "acc": 0.5679687857627869, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6857836246490479, "acc": 0.5559622645378113, "length": 1.0000356435775757, "mode": "train", "epoch": 46}
{"loss": 0.6845098733901978, "acc": 0.5464844107627869, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6843469738960266, "acc": 0.5645217895507812, "length": 1.0000360012054443, "mode": "train", "epoch": 47}
{"loss": 0.6856383085250854, "acc": 0.5464844107627869, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6838375329971313, "acc": 0.5619833469390869, "length": 1.000024676322937, "mode": "train", "epoch": 48}
{"loss": 0.6842907667160034, "acc": 0.549609363079071, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6840500831604004, "acc": 0.5590319633483887, "length": 1.0000277757644653, "mode": "train", "epoch": 49}
{"loss": 0.6850647926330566, "acc": 0.5464844107627869, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6845672130584717, "acc": 0.5637542009353638, "length": 1.0000230073928833, "mode": "train", "epoch": 50}
{"loss": 0.6865941286087036, "acc": 0.5574219226837158, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6854007840156555, "acc": 0.5554308891296387, "length": 1.000018835067749, "mode": "train", "epoch": 51}
{"loss": 0.6835334897041321, "acc": 0.5697265267372131, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6849314570426941, "acc": 0.5543683171272278, "length": 1.000014066696167, "mode": "train", "epoch": 52}
{"loss": 0.6857764720916748, "acc": 0.560546875, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6853273510932922, "acc": 0.556257426738739, "length": 1.0000168085098267, "mode": "train", "epoch": 53}
{"loss": 0.6848260164260864, "acc": 0.5648437142372131, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6852671504020691, "acc": 0.5681227445602417, "length": 1.0000115633010864, "mode": "train", "epoch": 54}
{"loss": 0.6839206218719482, "acc": 0.5679687857627869, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6849201917648315, "acc": 0.5606847405433655, "length": 1.0000115633010864, "mode": "train", "epoch": 55}
{"loss": 0.6842745542526245, "acc": 0.5562500357627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6833515167236328, "acc": 0.5642266869544983, "length": 1.0000114440917969, "mode": "train", "epoch": 56}
{"loss": 0.685386598110199, "acc": 0.5531249642372131, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6837376952171326, "acc": 0.5644628405570984, "length": 1.0000108480453491, "mode": "train", "epoch": 57}
{"loss": 0.6852306127548218, "acc": 0.567578136920929, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6838112473487854, "acc": 0.5602715611457825, "length": 1.0000070333480835, "mode": "train", "epoch": 58}
{"loss": 0.6847822070121765, "acc": 0.5648437142372131, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6830909252166748, "acc": 0.5650531649589539, "length": 1.0000063180923462, "mode": "train", "epoch": 59}
{"loss": 0.6854303479194641, "acc": 0.5640625357627869, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.683702826499939, "acc": 0.5608618259429932, "length": 1.0000075101852417, "mode": "train", "epoch": 60}
{"loss": 0.6845260858535767, "acc": 0.5562500357627869, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.2591935694217682
