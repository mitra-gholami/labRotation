# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 10
{"loss": 0.7014986872673035, "acc": 0.5063128471374512, "length": 3.990750551223755, "mode": "train", "epoch": 1}
{"loss": 0.6983564496040344, "acc": 0.484375, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.695296585559845, "acc": 0.5029500722885132, "length": 1.1393206119537354, "mode": "train", "epoch": 2}
{"loss": 0.6956961750984192, "acc": 0.5012152194976807, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6780474781990051, "acc": 0.578988790512085, "length": 2.2878034114837646, "mode": "train", "epoch": 3}
{"loss": 0.6474987268447876, "acc": 0.6559569835662842, "length": 4.736111164093018, "mode": "test", "epoch": 3}
{"loss": 0.5846322178840637, "acc": 0.6969375014305115, "length": 3.1682255268096924, "mode": "train", "epoch": 4}
{"loss": 0.6062604188919067, "acc": 0.7163627743721008, "length": 3.5833332538604736, "mode": "test", "epoch": 4}
{"loss": 0.4889747202396393, "acc": 0.7819494605064392, "length": 3.136449098587036, "mode": "train", "epoch": 5}
{"loss": 0.4880059063434601, "acc": 0.7834309339523315, "length": 3.0486111640930176, "mode": "test", "epoch": 5}
{"loss": 0.4454868733882904, "acc": 0.8082550764083862, "length": 2.9733822345733643, "mode": "train", "epoch": 6}
{"loss": 0.503648042678833, "acc": 0.7842013835906982, "length": 2.722222328186035, "mode": "test", "epoch": 6}
{"loss": 0.4127214252948761, "acc": 0.8145045638084412, "length": 3.0835845470428467, "mode": "train", "epoch": 7}
{"loss": 0.5086906552314758, "acc": 0.7921874523162842, "length": 2.7326388359069824, "mode": "test", "epoch": 7}
{"loss": 0.39058151841163635, "acc": 0.8182830810546875, "length": 3.4474029541015625, "mode": "train", "epoch": 8}
{"loss": 0.5422832369804382, "acc": 0.7841796875, "length": 2.756944417953491, "mode": "test", "epoch": 8}
{"loss": 0.3671843707561493, "acc": 0.8277202844619751, "length": 3.9840688705444336, "mode": "train", "epoch": 9}
{"loss": 0.41851606965065, "acc": 0.8195964097976685, "length": 3.847222328186035, "mode": "test", "epoch": 9}
{"loss": 0.3457131087779999, "acc": 0.8384443521499634, "length": 4.448953628540039, "mode": "train", "epoch": 10}
{"loss": 0.43116357922554016, "acc": 0.8099391460418701, "length": 5.00694465637207, "mode": "test", "epoch": 10}
{"loss": 0.31885939836502075, "acc": 0.8595583438873291, "length": 4.957568168640137, "mode": "train", "epoch": 11}
{"loss": 0.38621488213539124, "acc": 0.8456652164459229, "length": 5.090277671813965, "mode": "test", "epoch": 11}
{"loss": 0.3040543794631958, "acc": 0.8679631352424622, "length": 4.9061198234558105, "mode": "train", "epoch": 12}
{"loss": 0.36199936270713806, "acc": 0.8504123091697693, "length": 5.166666507720947, "mode": "test", "epoch": 12}
{"loss": 0.285483181476593, "acc": 0.8801648616790771, "length": 4.860988616943359, "mode": "train", "epoch": 13}
{"loss": 0.3676016330718994, "acc": 0.8528482913970947, "length": 5.170138835906982, "mode": "test", "epoch": 13}
{"loss": 0.2581254839897156, "acc": 0.9004607796669006, "length": 5.453577518463135, "mode": "train", "epoch": 14}
{"loss": 0.31767699122428894, "acc": 0.8760796785354614, "length": 5.74305534362793, "mode": "test", "epoch": 14}
{"loss": 0.25101107358932495, "acc": 0.8996302485466003, "length": 5.5574798583984375, "mode": "train", "epoch": 15}
{"loss": 0.3235633671283722, "acc": 0.8763618469238281, "length": 5.298611164093018, "mode": "test", "epoch": 15}
{"loss": 0.23495912551879883, "acc": 0.9084654450416565, "length": 5.753407001495361, "mode": "train", "epoch": 16}
{"loss": 0.29807248711586, "acc": 0.8980848789215088, "length": 6.121527671813965, "mode": "test", "epoch": 16}
{"loss": 0.2166839987039566, "acc": 0.9175933003425598, "length": 6.32391357421875, "mode": "train", "epoch": 17}
{"loss": 0.3371439278125763, "acc": 0.8677464127540588, "length": 6.715277671813965, "mode": "test", "epoch": 17}
{"loss": 0.20788100361824036, "acc": 0.9202496409416199, "length": 6.459338665008545, "mode": "train", "epoch": 18}
{"loss": 0.30717721581459045, "acc": 0.8794542551040649, "length": 6.701388835906982, "mode": "test", "epoch": 18}
{"loss": 0.19680112600326538, "acc": 0.9291591048240662, "length": 6.692173480987549, "mode": "train", "epoch": 19}
{"loss": 0.27008625864982605, "acc": 0.8944606781005859, "length": 6.496527671813965, "mode": "test", "epoch": 19}
{"loss": 0.18469582498073578, "acc": 0.9305233955383301, "length": 6.4513421058654785, "mode": "train", "epoch": 20}
{"loss": 0.24997152388095856, "acc": 0.9062065482139587, "length": 6.72569465637207, "mode": "test", "epoch": 20}
{"loss": 0.1742219179868698, "acc": 0.9372472763061523, "length": 6.835226058959961, "mode": "train", "epoch": 21}
{"loss": 0.2912112772464752, "acc": 0.8978894352912903, "length": 6.81944465637207, "mode": "test", "epoch": 21}
{"loss": 0.16109362244606018, "acc": 0.9427667856216431, "length": 7.377289295196533, "mode": "train", "epoch": 22}
{"loss": 0.2373417764902115, "acc": 0.9039170742034912, "length": 7.197916507720947, "mode": "test", "epoch": 22}
{"loss": 0.14985376596450806, "acc": 0.947608470916748, "length": 7.437502384185791, "mode": "train", "epoch": 23}
{"loss": 0.2539171278476715, "acc": 0.9032171964645386, "length": 8.010416984558105, "mode": "test", "epoch": 23}
{"loss": 0.14038343727588654, "acc": 0.9499083161354065, "length": 7.995121002197266, "mode": "train", "epoch": 24}
{"loss": 0.21519194543361664, "acc": 0.9212402701377869, "length": 8.22569465637207, "mode": "test", "epoch": 24}
{"loss": 0.1338704526424408, "acc": 0.950573205947876, "length": 8.173469543457031, "mode": "train", "epoch": 25}
{"loss": 0.25442326068878174, "acc": 0.9079155325889587, "length": 8.46180534362793, "mode": "test", "epoch": 25}
{"loss": 0.12644271552562714, "acc": 0.9576259851455688, "length": 8.582209587097168, "mode": "train", "epoch": 26}
{"loss": 0.18727156519889832, "acc": 0.9348415732383728, "length": 9.00694465637207, "mode": "test", "epoch": 26}
{"loss": 0.1254809945821762, "acc": 0.9552934765815735, "length": 8.833331108093262, "mode": "train", "epoch": 27}
{"loss": 0.24478231370449066, "acc": 0.9133246541023254, "length": 9.07986068725586, "mode": "test", "epoch": 27}
{"loss": 0.12231389433145523, "acc": 0.9569839239120483, "length": 8.643952369689941, "mode": "train", "epoch": 28}
{"loss": 0.21609099209308624, "acc": 0.9297091960906982, "length": 8.63888931274414, "mode": "test", "epoch": 28}
{"loss": 0.1012791246175766, "acc": 0.966166615486145, "length": 8.254034042358398, "mode": "train", "epoch": 29}
{"loss": 0.17881089448928833, "acc": 0.9387695789337158, "length": 8.77430534362793, "mode": "test", "epoch": 29}
{"loss": 0.09567093104124069, "acc": 0.9682111144065857, "length": 8.93183422088623, "mode": "train", "epoch": 30}
{"loss": 0.17158599197864532, "acc": 0.9428547620773315, "length": 9.472222328186035, "mode": "test", "epoch": 30}
{"loss": 0.08989859372377396, "acc": 0.9715874791145325, "length": 8.961532592773438, "mode": "train", "epoch": 31}
{"loss": 0.15251876413822174, "acc": 0.9496364593505859, "length": 8.90625, "mode": "test", "epoch": 31}
{"loss": 0.07932168245315552, "acc": 0.9763416051864624, "length": 9.065533638000488, "mode": "train", "epoch": 32}
{"loss": 0.15409691631793976, "acc": 0.9487956166267395, "length": 9.315972328186035, "mode": "test", "epoch": 32}
{"loss": 0.07202988117933273, "acc": 0.9784833788871765, "length": 9.466246604919434, "mode": "train", "epoch": 33}
{"loss": 0.1505090445280075, "acc": 0.9501139521598816, "length": 9.51388931274414, "mode": "test", "epoch": 33}
{"loss": 0.09797277301549911, "acc": 0.9696885347366333, "length": 9.277385711669922, "mode": "train", "epoch": 34}
{"loss": 0.14320969581604004, "acc": 0.9494955539703369, "length": 9.395833015441895, "mode": "test", "epoch": 34}
{"loss": 0.07007904350757599, "acc": 0.9807208180427551, "length": 9.10977554321289, "mode": "train", "epoch": 35}
{"loss": 0.14369501173496246, "acc": 0.9498373866081238, "length": 9.42361068725586, "mode": "test", "epoch": 35}
{"loss": 0.06325231492519379, "acc": 0.984021782875061, "length": 9.451743125915527, "mode": "train", "epoch": 36}
{"loss": 0.12887504696846008, "acc": 0.9609917402267456, "length": 9.57986068725586, "mode": "test", "epoch": 36}
{"loss": 0.06581208109855652, "acc": 0.9824293851852417, "length": 9.37311840057373, "mode": "train", "epoch": 37}
{"loss": 0.14057821035385132, "acc": 0.9548936486244202, "length": 9.208333015441895, "mode": "test", "epoch": 37}
{"loss": 0.05308973044157028, "acc": 0.987395167350769, "length": 9.672870635986328, "mode": "train", "epoch": 38}
{"loss": 0.1277923583984375, "acc": 0.9587673544883728, "length": 9.82638931274414, "mode": "test", "epoch": 38}
{"loss": 0.054453928023576736, "acc": 0.9855945706367493, "length": 9.275392532348633, "mode": "train", "epoch": 39}
{"loss": 0.1112154871225357, "acc": 0.9715549945831299, "length": 9.29861068725586, "mode": "test", "epoch": 39}
{"loss": 0.05095233768224716, "acc": 0.9883115887641907, "length": 9.114995956420898, "mode": "train", "epoch": 40}
{"loss": 0.11810638010501862, "acc": 0.9697754383087158, "length": 9.520833015441895, "mode": "test", "epoch": 40}
{"loss": 0.05324332416057587, "acc": 0.9874930381774902, "length": 9.489013671875, "mode": "train", "epoch": 41}
{"loss": 0.12104050070047379, "acc": 0.9632216691970825, "length": 9.246527671813965, "mode": "test", "epoch": 41}
{"loss": 0.05063498765230179, "acc": 0.988503098487854, "length": 8.626432418823242, "mode": "train", "epoch": 42}
{"loss": 0.12389127165079117, "acc": 0.9657552242279053, "length": 8.472222328186035, "mode": "test", "epoch": 42}
{"loss": 0.047688622027635574, "acc": 0.9887056350708008, "length": 8.706873893737793, "mode": "train", "epoch": 43}
{"loss": 0.10896706581115723, "acc": 0.9644639492034912, "length": 9.121527671813965, "mode": "test", "epoch": 43}
{"loss": 0.04632671922445297, "acc": 0.9917261004447937, "length": 9.359699249267578, "mode": "train", "epoch": 44}
{"loss": 0.11248697340488434, "acc": 0.9679524898529053, "length": 9.57986068725586, "mode": "test", "epoch": 44}
{"loss": 0.03831697627902031, "acc": 0.993033766746521, "length": 9.676386833190918, "mode": "train", "epoch": 45}
{"loss": 0.1483594924211502, "acc": 0.9658963680267334, "length": 9.940972328186035, "mode": "test", "epoch": 45}
{"loss": 0.0389692559838295, "acc": 0.9931104779243469, "length": 9.602468490600586, "mode": "train", "epoch": 46}
{"loss": 0.11756885051727295, "acc": 0.9697645902633667, "length": 9.46875, "mode": "test", "epoch": 46}
{"loss": 0.03450700640678406, "acc": 0.9945758581161499, "length": 9.68875789642334, "mode": "train", "epoch": 47}
{"loss": 0.10427041351795197, "acc": 0.9779296517372131, "length": 9.684027671813965, "mode": "test", "epoch": 47}
{"loss": 0.03178307041525841, "acc": 0.9960924386978149, "length": 9.713397026062012, "mode": "train", "epoch": 48}
{"loss": 0.10963824391365051, "acc": 0.9746745228767395, "length": 10.034722328186035, "mode": "test", "epoch": 48}
{"loss": 0.029331915080547333, "acc": 0.9968196153640747, "length": 9.970314979553223, "mode": "train", "epoch": 49}
{"loss": 0.10822951793670654, "acc": 0.9734048843383789, "length": 9.753472328186035, "mode": "test", "epoch": 49}
{"loss": 0.025628183037042618, "acc": 0.9977938532829285, "length": 9.52808952331543, "mode": "train", "epoch": 50}
{"loss": 0.09439386427402496, "acc": 0.9797308444976807, "length": 9.17361068725586, "mode": "test", "epoch": 50}
{"loss": 0.03684038668870926, "acc": 0.9947249889373779, "length": 9.377250671386719, "mode": "train", "epoch": 51}
{"loss": 0.18198725581169128, "acc": 0.954991340637207, "length": 9.496527671813965, "mode": "test", "epoch": 51}
{"loss": 0.06158577650785446, "acc": 0.9844966530799866, "length": 9.679939270019531, "mode": "train", "epoch": 52}
{"loss": 0.1816786527633667, "acc": 0.9482909440994263, "length": 10.052083015441895, "mode": "test", "epoch": 52}
{"loss": 0.05225609242916107, "acc": 0.9871397614479065, "length": 9.96058464050293, "mode": "train", "epoch": 53}
{"loss": 0.08524154126644135, "acc": 0.9777995347976685, "length": 10.128472328186035, "mode": "test", "epoch": 53}
{"loss": 0.03292836248874664, "acc": 0.9944780468940735, "length": 9.848872184753418, "mode": "train", "epoch": 54}
{"loss": 0.07640890032052994, "acc": 0.9815266728401184, "length": 9.73263931274414, "mode": "test", "epoch": 54}
{"loss": 0.02917361631989479, "acc": 0.9961438775062561, "length": 9.640782356262207, "mode": "train", "epoch": 55}
{"loss": 0.07525558769702911, "acc": 0.9849609732627869, "length": 9.70138931274414, "mode": "test", "epoch": 55}
{"loss": 0.02299012802541256, "acc": 0.9982452988624573, "length": 9.41018009185791, "mode": "train", "epoch": 56}
{"loss": 0.06273052841424942, "acc": 0.9896050691604614, "length": 9.36805534362793, "mode": "test", "epoch": 56}
{"loss": 0.020293882116675377, "acc": 0.9989207983016968, "length": 9.425271034240723, "mode": "train", "epoch": 57}
{"loss": 0.0590788871049881, "acc": 0.989447832107544, "length": 9.489583015441895, "mode": "test", "epoch": 57}
{"loss": 0.019341399893164635, "acc": 0.9991856217384338, "length": 9.460846900939941, "mode": "train", "epoch": 58}
{"loss": 0.08164839446544647, "acc": 0.9852267503738403, "length": 9.54513931274414, "mode": "test", "epoch": 58}
{"loss": 0.01854580081999302, "acc": 0.9990255236625671, "length": 9.405983924865723, "mode": "train", "epoch": 59}
{"loss": 0.08208916336297989, "acc": 0.9879557490348816, "length": 9.28819465637207, "mode": "test", "epoch": 59}
{"loss": 0.02452019788324833, "acc": 0.9988678693771362, "length": 9.207919120788574, "mode": "train", "epoch": 60}
{"loss": 0.1182354986667633, "acc": 0.9739908576011658, "length": 9.159722328186035, "mode": "test", "epoch": 60}
test accuracy: 0.8303009867668152
