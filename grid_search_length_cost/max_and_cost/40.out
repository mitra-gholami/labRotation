# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7093551754951477, "acc": 0.502021849155426, "length": 2.3305296897888184, "mode": "train", "epoch": 1}
{"loss": 0.6988173127174377, "acc": 0.505078136920929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6996688842773438, "acc": 0.4991507828235626, "length": 1.060261845588684, "mode": "train", "epoch": 2}
{"loss": 0.6988516449928284, "acc": 0.5189452767372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6988928318023682, "acc": 0.5066894292831421, "length": 1.0365033149719238, "mode": "train", "epoch": 3}
{"loss": 0.6985098123550415, "acc": 0.507617175579071, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6719985008239746, "acc": 0.6098678708076477, "length": 1.6112066507339478, "mode": "train", "epoch": 4}
{"loss": 0.6081032156944275, "acc": 0.6849181652069092, "length": 1.859375, "mode": "test", "epoch": 4}
{"loss": 0.5898745656013489, "acc": 0.6908393502235413, "length": 1.8770132064819336, "mode": "train", "epoch": 5}
{"loss": 0.5785954594612122, "acc": 0.6848694086074829, "length": 1.66796875, "mode": "test", "epoch": 5}
{"loss": 0.5719292163848877, "acc": 0.6883940100669861, "length": 1.6693716049194336, "mode": "train", "epoch": 6}
{"loss": 0.5778437256813049, "acc": 0.6785644292831421, "length": 1.55859375, "mode": "test", "epoch": 6}
{"loss": 0.5625377893447876, "acc": 0.6884583830833435, "length": 1.6040595769882202, "mode": "train", "epoch": 7}
{"loss": 0.5826913118362427, "acc": 0.6745850443840027, "length": 1.484375, "mode": "test", "epoch": 7}
{"loss": 0.5592612028121948, "acc": 0.6876834630966187, "length": 1.584734320640564, "mode": "train", "epoch": 8}
{"loss": 0.6042746305465698, "acc": 0.6558594703674316, "length": 1.375, "mode": "test", "epoch": 8}
{"loss": 0.5505552291870117, "acc": 0.6893883943557739, "length": 1.6287866830825806, "mode": "train", "epoch": 9}
{"loss": 0.5965093970298767, "acc": 0.667529284954071, "length": 1.390625, "mode": "test", "epoch": 9}
{"loss": 0.5457870960235596, "acc": 0.6918742656707764, "length": 1.6747972965240479, "mode": "train", "epoch": 10}
{"loss": 0.5528220534324646, "acc": 0.6882264018058777, "length": 1.6796875, "mode": "test", "epoch": 10}
{"loss": 0.5304791927337646, "acc": 0.6935616731643677, "length": 1.87906813621521, "mode": "train", "epoch": 11}
{"loss": 0.5376320481300354, "acc": 0.7004943490028381, "length": 1.703125, "mode": "test", "epoch": 11}
{"loss": 0.5219767689704895, "acc": 0.6954837441444397, "length": 1.7662618160247803, "mode": "train", "epoch": 12}
{"loss": 0.5391935706138611, "acc": 0.696368396282196, "length": 1.671875, "mode": "test", "epoch": 12}
{"loss": 0.5168328881263733, "acc": 0.708635687828064, "length": 1.880265712738037, "mode": "train", "epoch": 13}
{"loss": 0.5190990567207336, "acc": 0.7255614995956421, "length": 1.9453125, "mode": "test", "epoch": 13}
{"loss": 0.4957013428211212, "acc": 0.7552598118782043, "length": 2.0963046550750732, "mode": "train", "epoch": 14}
{"loss": 0.48893558979034424, "acc": 0.763226330280304, "length": 2.203125, "mode": "test", "epoch": 14}
{"loss": 0.4796897768974304, "acc": 0.7717351317405701, "length": 2.091670036315918, "mode": "train", "epoch": 15}
{"loss": 0.48695507645606995, "acc": 0.7728820443153381, "length": 2.0859375, "mode": "test", "epoch": 15}
{"loss": 0.4705398380756378, "acc": 0.7758896350860596, "length": 2.030820369720459, "mode": "train", "epoch": 16}
{"loss": 0.47309058904647827, "acc": 0.7850585579872131, "length": 2.01171875, "mode": "test", "epoch": 16}
{"loss": 0.4560622572898865, "acc": 0.7879874110221863, "length": 2.0047519207000732, "mode": "train", "epoch": 17}
{"loss": 0.4819111227989197, "acc": 0.7845764756202698, "length": 1.8671875, "mode": "test", "epoch": 17}
{"loss": 0.4428400993347168, "acc": 0.7930787801742554, "length": 2.0830931663513184, "mode": "train", "epoch": 18}
{"loss": 0.4601755738258362, "acc": 0.7921265363693237, "length": 1.99609375, "mode": "test", "epoch": 18}
{"loss": 0.42465558648109436, "acc": 0.8072982430458069, "length": 2.2159500122070312, "mode": "train", "epoch": 19}
{"loss": 0.4694143235683441, "acc": 0.7807983756065369, "length": 2.03125, "mode": "test", "epoch": 19}
{"loss": 0.40294286608695984, "acc": 0.817671000957489, "length": 2.333587646484375, "mode": "train", "epoch": 20}
{"loss": 0.4200468063354492, "acc": 0.811065673828125, "length": 2.3671875, "mode": "test", "epoch": 20}
{"loss": 0.37484222650527954, "acc": 0.8371549844741821, "length": 2.5620226860046387, "mode": "train", "epoch": 21}
{"loss": 0.4136278033256531, "acc": 0.818707287311554, "length": 2.3359375, "mode": "test", "epoch": 21}
{"loss": 0.3527509570121765, "acc": 0.8496288061141968, "length": 2.6098527908325195, "mode": "train", "epoch": 22}
{"loss": 0.3807648718357086, "acc": 0.8267760872840881, "length": 2.5, "mode": "test", "epoch": 22}
{"loss": 0.3284386098384857, "acc": 0.8640532493591309, "length": 2.696726083755493, "mode": "train", "epoch": 23}
{"loss": 0.38736316561698914, "acc": 0.8373169898986816, "length": 2.62890625, "mode": "test", "epoch": 23}
{"loss": 0.31587129831314087, "acc": 0.8694546818733215, "length": 2.6989810466766357, "mode": "train", "epoch": 24}
{"loss": 0.35122495889663696, "acc": 0.8562622666358948, "length": 2.5234375, "mode": "test", "epoch": 24}
{"loss": 0.2966896593570709, "acc": 0.8799598217010498, "length": 2.7178213596343994, "mode": "train", "epoch": 25}
{"loss": 0.33329617977142334, "acc": 0.8693481683731079, "length": 2.625, "mode": "test", "epoch": 25}
{"loss": 0.28026697039604187, "acc": 0.8903505802154541, "length": 2.7193973064422607, "mode": "train", "epoch": 26}
{"loss": 0.30081403255462646, "acc": 0.881695568561554, "length": 2.7109375, "mode": "test", "epoch": 26}
{"loss": 0.26234737038612366, "acc": 0.8984033465385437, "length": 2.78590989112854, "mode": "train", "epoch": 27}
{"loss": 0.2978092432022095, "acc": 0.877246081829071, "length": 2.765625, "mode": "test", "epoch": 27}
{"loss": 0.25363731384277344, "acc": 0.901874303817749, "length": 2.8104724884033203, "mode": "train", "epoch": 28}
{"loss": 0.292933851480484, "acc": 0.8845885992050171, "length": 2.70703125, "mode": "test", "epoch": 28}
{"loss": 0.23890569806098938, "acc": 0.9079782366752625, "length": 2.7749509811401367, "mode": "train", "epoch": 29}
{"loss": 0.28239351511001587, "acc": 0.8821593523025513, "length": 2.73828125, "mode": "test", "epoch": 29}
{"loss": 0.23099562525749207, "acc": 0.9123568534851074, "length": 2.759434461593628, "mode": "train", "epoch": 30}
{"loss": 0.26412343978881836, "acc": 0.8977051377296448, "length": 2.73046875, "mode": "test", "epoch": 30}
{"loss": 0.21601110696792603, "acc": 0.9184101223945618, "length": 2.7450098991394043, "mode": "train", "epoch": 31}
{"loss": 0.2576068043708801, "acc": 0.8967102766036987, "length": 2.80078125, "mode": "test", "epoch": 31}
{"loss": 0.2090022712945938, "acc": 0.9229177236557007, "length": 2.8127334117889404, "mode": "train", "epoch": 32}
{"loss": 0.25783857703208923, "acc": 0.9014220833778381, "length": 2.6796875, "mode": "test", "epoch": 32}
{"loss": 0.199171781539917, "acc": 0.9280153512954712, "length": 2.79162335395813, "mode": "train", "epoch": 33}
{"loss": 0.24282869696617126, "acc": 0.906628429889679, "length": 2.71484375, "mode": "test", "epoch": 33}
{"loss": 0.19620755314826965, "acc": 0.9295907020568848, "length": 2.7811336517333984, "mode": "train", "epoch": 34}
{"loss": 0.237518310546875, "acc": 0.9046447277069092, "length": 2.7734375, "mode": "test", "epoch": 34}
{"loss": 0.19224326312541962, "acc": 0.9270992279052734, "length": 2.7901313304901123, "mode": "train", "epoch": 35}
{"loss": 0.23465654253959656, "acc": 0.911114513874054, "length": 2.7421875, "mode": "test", "epoch": 35}
{"loss": 0.1783788502216339, "acc": 0.9365313053131104, "length": 2.7964961528778076, "mode": "train", "epoch": 36}
{"loss": 0.21310052275657654, "acc": 0.9235352277755737, "length": 2.76953125, "mode": "test", "epoch": 36}
{"loss": 0.1709912121295929, "acc": 0.9409580826759338, "length": 2.8318748474121094, "mode": "train", "epoch": 37}
{"loss": 0.2265062928199768, "acc": 0.923352062702179, "length": 2.796875, "mode": "test", "epoch": 37}
{"loss": 0.1677035242319107, "acc": 0.9411724209785461, "length": 2.8450021743774414, "mode": "train", "epoch": 38}
{"loss": 0.2087470442056656, "acc": 0.9238281846046448, "length": 2.828125, "mode": "test", "epoch": 38}
{"loss": 0.15639474987983704, "acc": 0.944107711315155, "length": 2.8395612239837646, "mode": "train", "epoch": 39}
{"loss": 0.21718916296958923, "acc": 0.9222412109375, "length": 2.8125, "mode": "test", "epoch": 39}
{"loss": 0.15005095303058624, "acc": 0.948034942150116, "length": 2.8503928184509277, "mode": "train", "epoch": 40}
{"loss": 0.21203559637069702, "acc": 0.9316161870956421, "length": 2.765625, "mode": "test", "epoch": 40}
{"loss": 0.1496223658323288, "acc": 0.9483066201210022, "length": 2.866891860961914, "mode": "train", "epoch": 41}
{"loss": 0.20805487036705017, "acc": 0.9329772591590881, "length": 2.828125, "mode": "test", "epoch": 41}
{"loss": 0.1447204053401947, "acc": 0.9492508769035339, "length": 2.842949867248535, "mode": "train", "epoch": 42}
{"loss": 0.1874450445175171, "acc": 0.934948742389679, "length": 2.79296875, "mode": "test", "epoch": 42}
{"loss": 0.13401420414447784, "acc": 0.9556853175163269, "length": 2.8516743183135986, "mode": "train", "epoch": 43}
{"loss": 0.19642221927642822, "acc": 0.9319702386856079, "length": 2.85546875, "mode": "test", "epoch": 43}
{"loss": 0.13336171209812164, "acc": 0.9533249735832214, "length": 2.860980987548828, "mode": "train", "epoch": 44}
{"loss": 0.19998347759246826, "acc": 0.9370788931846619, "length": 2.88671875, "mode": "test", "epoch": 44}
{"loss": 0.1276087462902069, "acc": 0.9571974277496338, "length": 2.8845183849334717, "mode": "train", "epoch": 45}
{"loss": 0.18158051371574402, "acc": 0.9386292099952698, "length": 2.85546875, "mode": "test", "epoch": 45}
{"loss": 0.12700453400611877, "acc": 0.9563608169555664, "length": 2.863071918487549, "mode": "train", "epoch": 46}
{"loss": 0.18650871515274048, "acc": 0.941174328327179, "length": 2.8515625, "mode": "test", "epoch": 46}
{"loss": 0.124443419277668, "acc": 0.9591240882873535, "length": 2.8991456031799316, "mode": "train", "epoch": 47}
{"loss": 0.1738865077495575, "acc": 0.944183349609375, "length": 2.9765625, "mode": "test", "epoch": 47}
{"loss": 0.11486342549324036, "acc": 0.9622846841812134, "length": 2.9323081970214844, "mode": "train", "epoch": 48}
{"loss": 0.18875965476036072, "acc": 0.9415892958641052, "length": 2.84375, "mode": "test", "epoch": 48}
{"loss": 0.11701629310846329, "acc": 0.9619060754776001, "length": 2.9009242057800293, "mode": "train", "epoch": 49}
{"loss": 0.19318008422851562, "acc": 0.9403015375137329, "length": 2.97265625, "mode": "test", "epoch": 49}
{"loss": 0.12017645686864853, "acc": 0.9622568488121033, "length": 2.910489559173584, "mode": "train", "epoch": 50}
{"loss": 0.20262232422828674, "acc": 0.939849853515625, "length": 2.96875, "mode": "test", "epoch": 50}
{"loss": 0.10954470187425613, "acc": 0.9653197526931763, "length": 2.9366443157196045, "mode": "train", "epoch": 51}
{"loss": 0.16858893632888794, "acc": 0.9491150379180908, "length": 2.9453125, "mode": "test", "epoch": 51}
{"loss": 0.10289265215396881, "acc": 0.9669125080108643, "length": 2.9048116207122803, "mode": "train", "epoch": 52}
{"loss": 0.17185288667678833, "acc": 0.9442260265350342, "length": 2.92578125, "mode": "test", "epoch": 52}
{"loss": 0.10496752709150314, "acc": 0.9681519269943237, "length": 2.916098117828369, "mode": "train", "epoch": 53}
{"loss": 0.1672772318124771, "acc": 0.9503600597381592, "length": 2.94140625, "mode": "test", "epoch": 53}
{"loss": 0.09893138706684113, "acc": 0.9689580202102661, "length": 2.9063668251037598, "mode": "train", "epoch": 54}
{"loss": 0.18270069360733032, "acc": 0.9501281976699829, "length": 2.8984375, "mode": "test", "epoch": 54}
{"loss": 0.09977500885725021, "acc": 0.9701363444328308, "length": 2.8917508125305176, "mode": "train", "epoch": 55}
{"loss": 0.18694941699504852, "acc": 0.946972668170929, "length": 2.91796875, "mode": "test", "epoch": 55}
{"loss": 0.10142222046852112, "acc": 0.966543436050415, "length": 2.9081387519836426, "mode": "train", "epoch": 56}
{"loss": 0.16129258275032043, "acc": 0.946643054485321, "length": 2.91015625, "mode": "test", "epoch": 56}
{"loss": 0.10015611350536346, "acc": 0.9686911702156067, "length": 2.917691230773926, "mode": "train", "epoch": 57}
{"loss": 0.17489099502563477, "acc": 0.9473510384559631, "length": 2.92578125, "mode": "test", "epoch": 57}
{"loss": 0.09640214592218399, "acc": 0.9694036841392517, "length": 2.9405720233917236, "mode": "train", "epoch": 58}
{"loss": 0.15175732970237732, "acc": 0.9535521864891052, "length": 2.9765625, "mode": "test", "epoch": 58}
{"loss": 0.083663210272789, "acc": 0.9768548607826233, "length": 2.98364520072937, "mode": "train", "epoch": 59}
{"loss": 0.1702122688293457, "acc": 0.9496216177940369, "length": 2.97265625, "mode": "test", "epoch": 59}
{"loss": 0.08859681338071823, "acc": 0.9749322533607483, "length": 3.03776478767395, "mode": "train", "epoch": 60}
{"loss": 0.15993821620941162, "acc": 0.9556456804275513, "length": 3.00390625, "mode": "test", "epoch": 60}
test accuracy: 0.7989360690116882
