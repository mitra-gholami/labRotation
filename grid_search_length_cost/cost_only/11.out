# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6967427134513855, "acc": 0.5227024555206299, "length": 2.8547515869140625, "mode": "train", "epoch": 1}
{"loss": 0.6922953128814697, "acc": 0.548958420753479, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6385989189147949, "acc": 0.6386281847953796, "length": 2.7607150077819824, "mode": "train", "epoch": 2}
{"loss": 0.5506389737129211, "acc": 0.7233126759529114, "length": 3.2395832538604736, "mode": "test", "epoch": 2}
{"loss": 0.52988600730896, "acc": 0.7498413920402527, "length": 3.073570966720581, "mode": "train", "epoch": 3}
{"loss": 0.5003267526626587, "acc": 0.7853028178215027, "length": 2.7708332538604736, "mode": "test", "epoch": 3}
{"loss": 0.48564499616622925, "acc": 0.7702140212059021, "length": 3.141331195831299, "mode": "train", "epoch": 4}
{"loss": 0.4951566755771637, "acc": 0.782606303691864, "length": 3.503472328186035, "mode": "test", "epoch": 4}
{"loss": 0.44108355045318604, "acc": 0.7908651828765869, "length": 3.4422526359558105, "mode": "train", "epoch": 5}
{"loss": 0.43527764081954956, "acc": 0.8188422322273254, "length": 3.371527671813965, "mode": "test", "epoch": 5}
{"loss": 0.3864023983478546, "acc": 0.8206535577774048, "length": 3.5487680435180664, "mode": "train", "epoch": 6}
{"loss": 0.38163700699806213, "acc": 0.8374186754226685, "length": 3.465277671813965, "mode": "test", "epoch": 6}
{"loss": 0.34043756127357483, "acc": 0.8530399799346924, "length": 3.5465283393859863, "mode": "train", "epoch": 7}
{"loss": 0.3751927316188812, "acc": 0.8501302599906921, "length": 3.4270832538604736, "mode": "test", "epoch": 7}
{"loss": 0.299221396446228, "acc": 0.873771071434021, "length": 3.5256547927856445, "mode": "train", "epoch": 8}
{"loss": 0.3229893445968628, "acc": 0.8716526031494141, "length": 3.40625, "mode": "test", "epoch": 8}
{"loss": 0.28000959753990173, "acc": 0.8878023624420166, "length": 3.5512678623199463, "mode": "train", "epoch": 9}
{"loss": 0.2865501046180725, "acc": 0.8852214217185974, "length": 3.3923611640930176, "mode": "test", "epoch": 9}
{"loss": 0.27287787199020386, "acc": 0.8952727913856506, "length": 3.5510408878326416, "mode": "train", "epoch": 10}
{"loss": 0.2661202847957611, "acc": 0.8992621302604675, "length": 3.402777671813965, "mode": "test", "epoch": 10}
{"loss": 0.26055166125297546, "acc": 0.8998578786849976, "length": 3.5764551162719727, "mode": "train", "epoch": 11}
{"loss": 0.26902341842651367, "acc": 0.8985839486122131, "length": 3.4166667461395264, "mode": "test", "epoch": 11}
{"loss": 0.2600095570087433, "acc": 0.9005139470100403, "length": 3.5952625274658203, "mode": "train", "epoch": 12}
{"loss": 0.25417813658714294, "acc": 0.9082518815994263, "length": 3.4479167461395264, "mode": "test", "epoch": 12}
{"loss": 0.24710814654827118, "acc": 0.9000023603439331, "length": 3.607484817504883, "mode": "train", "epoch": 13}
{"loss": 0.26258257031440735, "acc": 0.9069227576255798, "length": 3.3923611640930176, "mode": "test", "epoch": 13}
{"loss": 0.23809504508972168, "acc": 0.9064809083938599, "length": 3.5959584712982178, "mode": "train", "epoch": 14}
{"loss": 0.26609745621681213, "acc": 0.9086534976959229, "length": 3.475694417953491, "mode": "test", "epoch": 14}
{"loss": 0.2337683141231537, "acc": 0.9059977531433105, "length": 3.6154675483703613, "mode": "train", "epoch": 15}
{"loss": 0.2628059685230255, "acc": 0.9061741232872009, "length": 3.5, "mode": "test", "epoch": 15}
{"loss": 0.23986190557479858, "acc": 0.9078665375709534, "length": 3.6169517040252686, "mode": "train", "epoch": 16}
{"loss": 0.24851290881633759, "acc": 0.9040256142616272, "length": 3.444444417953491, "mode": "test", "epoch": 16}
{"loss": 0.23157969117164612, "acc": 0.9096997976303101, "length": 3.6222357749938965, "mode": "train", "epoch": 17}
{"loss": 0.2511321008205414, "acc": 0.9133029580116272, "length": 3.4375, "mode": "test", "epoch": 17}
{"loss": 0.2298830896615982, "acc": 0.9115052223205566, "length": 3.613496780395508, "mode": "train", "epoch": 18}
{"loss": 0.24219566583633423, "acc": 0.9134982228279114, "length": 3.4479167461395264, "mode": "test", "epoch": 18}
{"loss": 0.22195231914520264, "acc": 0.9098510146141052, "length": 3.6166791915893555, "mode": "train", "epoch": 19}
{"loss": 0.24820739030838013, "acc": 0.9104492664337158, "length": 3.475694417953491, "mode": "test", "epoch": 19}
{"loss": 0.2163916528224945, "acc": 0.9127973914146423, "length": 3.6548550128936768, "mode": "train", "epoch": 20}
{"loss": 0.23831479251384735, "acc": 0.9189181923866272, "length": 3.434027671813965, "mode": "test", "epoch": 20}
{"loss": 0.2178540974855423, "acc": 0.9129506349563599, "length": 3.6254208087921143, "mode": "train", "epoch": 21}
{"loss": 0.2644851803779602, "acc": 0.9006726741790771, "length": 3.5763888359069824, "mode": "test", "epoch": 21}
{"loss": 0.2161252200603485, "acc": 0.9149429202079773, "length": 3.6405951976776123, "mode": "train", "epoch": 22}
{"loss": 0.24971647560596466, "acc": 0.9105306267738342, "length": 3.493055582046509, "mode": "test", "epoch": 22}
{"loss": 0.21961873769760132, "acc": 0.9140539765357971, "length": 3.631791591644287, "mode": "train", "epoch": 23}
{"loss": 0.2628532946109772, "acc": 0.9017144441604614, "length": 3.4895832538604736, "mode": "test", "epoch": 23}
{"loss": 0.20547430217266083, "acc": 0.919680655002594, "length": 3.6328928470611572, "mode": "train", "epoch": 24}
{"loss": 0.24597151577472687, "acc": 0.8993923664093018, "length": 3.5520832538604736, "mode": "test", "epoch": 24}
{"loss": 0.20470529794692993, "acc": 0.9192827939987183, "length": 3.6449103355407715, "mode": "train", "epoch": 25}
{"loss": 0.24695216119289398, "acc": 0.9164170026779175, "length": 3.503472328186035, "mode": "test", "epoch": 25}
{"loss": 0.19125066697597504, "acc": 0.9258690476417542, "length": 3.6599338054656982, "mode": "train", "epoch": 26}
{"loss": 0.22474892437458038, "acc": 0.9040419459342957, "length": 3.59375, "mode": "test", "epoch": 26}
{"loss": 0.1894165426492691, "acc": 0.9241408109664917, "length": 3.6886074542999268, "mode": "train", "epoch": 27}
{"loss": 0.22020229697227478, "acc": 0.9187284111976624, "length": 3.559027671813965, "mode": "test", "epoch": 27}
{"loss": 0.18830186128616333, "acc": 0.9300562143325806, "length": 3.715250015258789, "mode": "train", "epoch": 28}
{"loss": 0.2350774109363556, "acc": 0.8983452916145325, "length": 3.6979167461395264, "mode": "test", "epoch": 28}
{"loss": 0.1819249838590622, "acc": 0.93194180727005, "length": 3.7170569896698, "mode": "train", "epoch": 29}
{"loss": 0.21245399117469788, "acc": 0.9263021945953369, "length": 3.5486111640930176, "mode": "test", "epoch": 29}
{"loss": 0.18965931236743927, "acc": 0.92848801612854, "length": 3.728590726852417, "mode": "train", "epoch": 30}
{"loss": 0.22330212593078613, "acc": 0.9165473580360413, "length": 3.5833332538604736, "mode": "test", "epoch": 30}
{"loss": 0.17615284025669098, "acc": 0.934338390827179, "length": 3.738797426223755, "mode": "train", "epoch": 31}
{"loss": 0.20739658176898956, "acc": 0.9302083253860474, "length": 3.6111111640930176, "mode": "test", "epoch": 31}
{"loss": 0.15598201751708984, "acc": 0.9426091313362122, "length": 3.7620761394500732, "mode": "train", "epoch": 32}
{"loss": 0.2135804444551468, "acc": 0.9122776389122009, "length": 3.809027671813965, "mode": "test", "epoch": 32}
{"loss": 0.15679465234279633, "acc": 0.9457260370254517, "length": 3.7772769927978516, "mode": "train", "epoch": 33}
{"loss": 0.1972917765378952, "acc": 0.928868293762207, "length": 3.555555582046509, "mode": "test", "epoch": 33}
{"loss": 0.1497158408164978, "acc": 0.9490821361541748, "length": 3.740553617477417, "mode": "train", "epoch": 34}
{"loss": 0.18627199530601501, "acc": 0.9350314736366272, "length": 3.6076388359069824, "mode": "test", "epoch": 34}
{"loss": 0.14243388175964355, "acc": 0.9470702409744263, "length": 3.7622430324554443, "mode": "train", "epoch": 35}
{"loss": 0.16848932206630707, "acc": 0.9360948204994202, "length": 3.715277671813965, "mode": "test", "epoch": 35}
{"loss": 0.13657383620738983, "acc": 0.9498388767242432, "length": 3.784186601638794, "mode": "train", "epoch": 36}
{"loss": 0.19640587270259857, "acc": 0.9315862655639648, "length": 3.628472328186035, "mode": "test", "epoch": 36}
{"loss": 0.13296394050121307, "acc": 0.9502257704734802, "length": 3.785374164581299, "mode": "train", "epoch": 37}
{"loss": 0.18989549577236176, "acc": 0.9338161945343018, "length": 3.7395832538604736, "mode": "test", "epoch": 37}
{"loss": 0.12570051848888397, "acc": 0.9539437890052795, "length": 3.7702159881591797, "mode": "train", "epoch": 38}
{"loss": 0.1616082489490509, "acc": 0.9373481273651123, "length": 3.7291667461395264, "mode": "test", "epoch": 38}
{"loss": 0.11222285032272339, "acc": 0.9600092768669128, "length": 3.807705879211426, "mode": "train", "epoch": 39}
{"loss": 0.17335374653339386, "acc": 0.943603515625, "length": 3.7361111640930176, "mode": "test", "epoch": 39}
{"loss": 0.10947051644325256, "acc": 0.9632471203804016, "length": 3.7721478939056396, "mode": "train", "epoch": 40}
{"loss": 0.1425696611404419, "acc": 0.9484320878982544, "length": 3.722222328186035, "mode": "test", "epoch": 40}
{"loss": 0.10771336406469345, "acc": 0.962855339050293, "length": 3.7928097248077393, "mode": "train", "epoch": 41}
{"loss": 0.15730364620685577, "acc": 0.9468477964401245, "length": 3.75, "mode": "test", "epoch": 41}
{"loss": 0.10729817301034927, "acc": 0.9620956778526306, "length": 3.8211708068847656, "mode": "train", "epoch": 42}
{"loss": 0.14931587874889374, "acc": 0.9411946535110474, "length": 3.6770832538604736, "mode": "test", "epoch": 42}
{"loss": 0.11501327157020569, "acc": 0.9598432183265686, "length": 3.7397093772888184, "mode": "train", "epoch": 43}
{"loss": 0.14498475193977356, "acc": 0.952549934387207, "length": 3.6979167461395264, "mode": "test", "epoch": 43}
{"loss": 0.10039184987545013, "acc": 0.9642520546913147, "length": 3.8141427040100098, "mode": "train", "epoch": 44}
{"loss": 0.1305149793624878, "acc": 0.9503147602081299, "length": 3.71875, "mode": "test", "epoch": 44}
{"loss": 0.09115292131900787, "acc": 0.965004026889801, "length": 3.806989908218384, "mode": "train", "epoch": 45}
{"loss": 0.149928480386734, "acc": 0.943934440612793, "length": 3.75, "mode": "test", "epoch": 45}
{"loss": 0.0895066112279892, "acc": 0.9679726362228394, "length": 3.8146777153015137, "mode": "train", "epoch": 46}
{"loss": 0.13675886392593384, "acc": 0.9527072906494141, "length": 3.7083332538604736, "mode": "test", "epoch": 46}
{"loss": 0.08600972592830658, "acc": 0.9669264554977417, "length": 3.80739164352417, "mode": "train", "epoch": 47}
{"loss": 0.14856866002082825, "acc": 0.9420573115348816, "length": 3.7395832538604736, "mode": "test", "epoch": 47}
{"loss": 0.0845334380865097, "acc": 0.9719395637512207, "length": 3.8297345638275146, "mode": "train", "epoch": 48}
{"loss": 0.13369785249233246, "acc": 0.9514648914337158, "length": 3.756944417953491, "mode": "test", "epoch": 48}
{"loss": 0.07541559636592865, "acc": 0.9736799597740173, "length": 3.8396449089050293, "mode": "train", "epoch": 49}
{"loss": 0.1399984061717987, "acc": 0.9472439289093018, "length": 3.7361111640930176, "mode": "test", "epoch": 49}
{"loss": 0.0835583508014679, "acc": 0.9697811603546143, "length": 3.797647714614868, "mode": "train", "epoch": 50}
{"loss": 0.17179900407791138, "acc": 0.9471517205238342, "length": 3.75, "mode": "test", "epoch": 50}
{"loss": 0.08158768713474274, "acc": 0.9703714847564697, "length": 3.843062162399292, "mode": "train", "epoch": 51}
{"loss": 0.14447882771492004, "acc": 0.9474772214889526, "length": 3.7291667461395264, "mode": "test", "epoch": 51}
{"loss": 0.08241674304008484, "acc": 0.9715626835823059, "length": 3.803011417388916, "mode": "train", "epoch": 52}
{"loss": 0.15708313882350922, "acc": 0.9490072727203369, "length": 3.7673611640930176, "mode": "test", "epoch": 52}
{"loss": 0.08029505610466003, "acc": 0.9717100262641907, "length": 3.8351831436157227, "mode": "train", "epoch": 53}
{"loss": 0.13847625255584717, "acc": 0.9509223103523254, "length": 3.784722328186035, "mode": "test", "epoch": 53}
{"loss": 0.0643669068813324, "acc": 0.9808268547058105, "length": 3.836824655532837, "mode": "train", "epoch": 54}
{"loss": 0.1432538777589798, "acc": 0.9478895664215088, "length": 3.777777671813965, "mode": "test", "epoch": 54}
{"loss": 0.05813315883278847, "acc": 0.9824343323707581, "length": 3.8201985359191895, "mode": "train", "epoch": 55}
{"loss": 0.15165911614894867, "acc": 0.9461534023284912, "length": 3.7291667461395264, "mode": "test", "epoch": 55}
{"loss": 0.05418286472558975, "acc": 0.9819438457489014, "length": 3.835271120071411, "mode": "train", "epoch": 56}
{"loss": 0.12856937944889069, "acc": 0.9561685919761658, "length": 3.7673611640930176, "mode": "test", "epoch": 56}
{"loss": 0.05210445821285248, "acc": 0.9830865859985352, "length": 3.8421998023986816, "mode": "train", "epoch": 57}
{"loss": 0.16294579207897186, "acc": 0.9508680701255798, "length": 3.774305582046509, "mode": "test", "epoch": 57}
{"loss": 0.06484051048755646, "acc": 0.9775645136833191, "length": 3.8381855487823486, "mode": "train", "epoch": 58}
{"loss": 0.1554679125547409, "acc": 0.9568305611610413, "length": 3.7638888359069824, "mode": "test", "epoch": 58}
{"loss": 0.05481947958469391, "acc": 0.9807443618774414, "length": 3.827392101287842, "mode": "train", "epoch": 59}
{"loss": 0.10108150541782379, "acc": 0.9684895277023315, "length": 3.71875, "mode": "test", "epoch": 59}
{"loss": 0.06411363929510117, "acc": 0.981078565120697, "length": 3.8294320106506348, "mode": "train", "epoch": 60}
{"loss": 0.13521428406238556, "acc": 0.9577690958976746, "length": 3.777777671813965, "mode": "test", "epoch": 60}
test accuracy: 0.8620201349258423
