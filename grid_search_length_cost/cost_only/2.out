# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6994636654853821, "acc": 0.5176990628242493, "length": 2.962991714477539, "mode": "train", "epoch": 1}
{"loss": 0.6947810649871826, "acc": 0.507617175579071, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6592880487442017, "acc": 0.6134817004203796, "length": 2.8706932067871094, "mode": "train", "epoch": 2}
{"loss": 0.6059350967407227, "acc": 0.6712464094161987, "length": 3.91796875, "mode": "test", "epoch": 2}
{"loss": 0.5503216981887817, "acc": 0.733354389667511, "length": 3.8293888568878174, "mode": "train", "epoch": 3}
{"loss": 0.5252121686935425, "acc": 0.7738280892372131, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4572650194168091, "acc": 0.7999399900436401, "length": 3.9312801361083984, "mode": "train", "epoch": 4}
{"loss": 0.470248818397522, "acc": 0.7835937142372131, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.38124775886535645, "acc": 0.8334259986877441, "length": 3.9664971828460693, "mode": "train", "epoch": 5}
{"loss": 0.4439883828163147, "acc": 0.8060546517372131, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3467941880226135, "acc": 0.8457135558128357, "length": 3.98006272315979, "mode": "train", "epoch": 6}
{"loss": 0.3939988613128662, "acc": 0.8160156607627869, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3226182758808136, "acc": 0.8626083135604858, "length": 3.9834578037261963, "mode": "train", "epoch": 7}
{"loss": 0.4069741666316986, "acc": 0.8173828125, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3111441135406494, "acc": 0.866391658782959, "length": 3.987900733947754, "mode": "train", "epoch": 8}
{"loss": 0.40930289030075073, "acc": 0.8164063096046448, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.294009268283844, "acc": 0.8765943646430969, "length": 3.990917444229126, "mode": "train", "epoch": 9}
{"loss": 0.36962178349494934, "acc": 0.8472657203674316, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.27893656492233276, "acc": 0.884624183177948, "length": 3.991910219192505, "mode": "train", "epoch": 10}
{"loss": 0.36673206090927124, "acc": 0.8515625, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2740020155906677, "acc": 0.8865758776664734, "length": 3.9930572509765625, "mode": "train", "epoch": 11}
{"loss": 0.36978763341903687, "acc": 0.8367186784744263, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.255601167678833, "acc": 0.8935465216636658, "length": 3.9929776191711426, "mode": "train", "epoch": 12}
{"loss": 0.3272589147090912, "acc": 0.8601561784744263, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.23654425144195557, "acc": 0.9011204838752747, "length": 3.994340658187866, "mode": "train", "epoch": 13}
{"loss": 0.31556764245033264, "acc": 0.8765625357627869, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2271655797958374, "acc": 0.9077004194259644, "length": 3.99517560005188, "mode": "train", "epoch": 14}
{"loss": 0.28478091955184937, "acc": 0.8937500715255737, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2230559140443802, "acc": 0.9127053618431091, "length": 3.99522066116333, "mode": "train", "epoch": 15}
{"loss": 0.2717705965042114, "acc": 0.8996095061302185, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.20908458530902863, "acc": 0.9219639301300049, "length": 3.9961354732513428, "mode": "train", "epoch": 16}
{"loss": 0.2813013195991516, "acc": 0.8841796517372131, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2066122144460678, "acc": 0.9179556965827942, "length": 3.996704578399658, "mode": "train", "epoch": 17}
{"loss": 0.2992718815803528, "acc": 0.8943358659744263, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.20543132722377777, "acc": 0.9187696576118469, "length": 3.9970037937164307, "mode": "train", "epoch": 18}
{"loss": 0.26831498742103577, "acc": 0.8917969465255737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.19055448472499847, "acc": 0.9256980419158936, "length": 3.997567653656006, "mode": "train", "epoch": 19}
{"loss": 0.25792330503463745, "acc": 0.9058594107627869, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.183280810713768, "acc": 0.9320205450057983, "length": 3.9977006912231445, "mode": "train", "epoch": 20}
{"loss": 0.27244555950164795, "acc": 0.8929687738418579, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.18001218140125275, "acc": 0.9346075057983398, "length": 3.9982006549835205, "mode": "train", "epoch": 21}
{"loss": 0.2629161477088928, "acc": 0.9132813215255737, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.17273947596549988, "acc": 0.9353173971176147, "length": 3.998298406600952, "mode": "train", "epoch": 22}
{"loss": 0.24911634624004364, "acc": 0.9175781607627869, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.17014645040035248, "acc": 0.9368420243263245, "length": 3.9985239505767822, "mode": "train", "epoch": 23}
{"loss": 0.2787376046180725, "acc": 0.9124999642372131, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.17091909050941467, "acc": 0.9363296031951904, "length": 3.9988980293273926, "mode": "train", "epoch": 24}
{"loss": 0.26461726427078247, "acc": 0.9097657203674316, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.16995839774608612, "acc": 0.9353927969932556, "length": 3.999051094055176, "mode": "train", "epoch": 25}
{"loss": 0.22726498544216156, "acc": 0.9291015267372131, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.15117976069450378, "acc": 0.9440500736236572, "length": 3.998771905899048, "mode": "train", "epoch": 26}
{"loss": 0.24462300539016724, "acc": 0.9173827767372131, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.15437792241573334, "acc": 0.945114254951477, "length": 3.999178647994995, "mode": "train", "epoch": 27}
{"loss": 0.2112513780593872, "acc": 0.9169922471046448, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.15149593353271484, "acc": 0.9441800117492676, "length": 3.9991157054901123, "mode": "train", "epoch": 28}
{"loss": 0.21842540800571442, "acc": 0.9263672828674316, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.15199212729930878, "acc": 0.9416106343269348, "length": 3.999319076538086, "mode": "train", "epoch": 29}
{"loss": 0.23376958072185516, "acc": 0.9183593392372131, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1441035270690918, "acc": 0.9482228755950928, "length": 3.9993250370025635, "mode": "train", "epoch": 30}
{"loss": 0.22449567914009094, "acc": 0.9263672232627869, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.13058526813983917, "acc": 0.9565932154655457, "length": 3.9993174076080322, "mode": "train", "epoch": 31}
{"loss": 0.23010583221912384, "acc": 0.9253906607627869, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.12616752088069916, "acc": 0.95729660987854, "length": 3.9993107318878174, "mode": "train", "epoch": 32}
{"loss": 0.20372721552848816, "acc": 0.9330078363418579, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.12330742180347443, "acc": 0.9547280669212341, "length": 3.999476671218872, "mode": "train", "epoch": 33}
{"loss": 0.19979143142700195, "acc": 0.9347656965255737, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.11227858066558838, "acc": 0.9616301655769348, "length": 3.9993598461151123, "mode": "train", "epoch": 34}
{"loss": 0.1942928582429886, "acc": 0.9431639313697815, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.11880966275930405, "acc": 0.9588844776153564, "length": 3.999563694000244, "mode": "train", "epoch": 35}
{"loss": 0.19124874472618103, "acc": 0.9345703125, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.11458483338356018, "acc": 0.9590032696723938, "length": 3.9995877742767334, "mode": "train", "epoch": 36}
{"loss": 0.21240800619125366, "acc": 0.9265624284744263, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1023464947938919, "acc": 0.9651517868041992, "length": 3.9996252059936523, "mode": "train", "epoch": 37}
{"loss": 0.1657286435365677, "acc": 0.9388671517372131, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.10060087591409683, "acc": 0.9658480286598206, "length": 3.999462604522705, "mode": "train", "epoch": 38}
{"loss": 0.17296139895915985, "acc": 0.9429687857627869, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.10423210263252258, "acc": 0.9622834920883179, "length": 3.999638319015503, "mode": "train", "epoch": 39}
{"loss": 0.17641162872314453, "acc": 0.9361328482627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.09629695862531662, "acc": 0.9681369066238403, "length": 3.9996798038482666, "mode": "train", "epoch": 40}
{"loss": 0.1902315467596054, "acc": 0.9490233659744263, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.09186960756778717, "acc": 0.9676008820533752, "length": 3.999467372894287, "mode": "train", "epoch": 41}
{"loss": 0.14585456252098083, "acc": 0.9513672590255737, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.09254427254199982, "acc": 0.9687278270721436, "length": 3.999772071838379, "mode": "train", "epoch": 42}
{"loss": 0.1569102555513382, "acc": 0.953125, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.09009295701980591, "acc": 0.9692525863647461, "length": 3.9997103214263916, "mode": "train", "epoch": 43}
{"loss": 0.136701762676239, "acc": 0.9509764909744263, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.08251555263996124, "acc": 0.9728810787200928, "length": 3.9997262954711914, "mode": "train", "epoch": 44}
{"loss": 0.15544313192367554, "acc": 0.9519530534744263, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.07900694757699966, "acc": 0.9748739004135132, "length": 3.999774694442749, "mode": "train", "epoch": 45}
{"loss": 0.13497468829154968, "acc": 0.9621094465255737, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.07360109686851501, "acc": 0.9789133667945862, "length": 3.9997873306274414, "mode": "train", "epoch": 46}
{"loss": 0.12205077707767487, "acc": 0.9623046517372131, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.08264558762311935, "acc": 0.9727681875228882, "length": 3.999812364578247, "mode": "train", "epoch": 47}
{"loss": 0.10781518369913101, "acc": 0.9587889313697815, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.06993891298770905, "acc": 0.9762261509895325, "length": 3.999907970428467, "mode": "train", "epoch": 48}
{"loss": 0.1344238817691803, "acc": 0.9609375, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.06685735285282135, "acc": 0.9782116413116455, "length": 3.9997785091400146, "mode": "train", "epoch": 49}
{"loss": 0.1385738104581833, "acc": 0.9576172232627869, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.0668136477470398, "acc": 0.979268491268158, "length": 3.9998605251312256, "mode": "train", "epoch": 50}
{"loss": 0.1094389334321022, "acc": 0.9642577767372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.061744142323732376, "acc": 0.9820758104324341, "length": 3.999763011932373, "mode": "train", "epoch": 51}
{"loss": 0.1243906170129776, "acc": 0.9644531607627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.07012762129306793, "acc": 0.9778061509132385, "length": 3.999903440475464, "mode": "train", "epoch": 52}
{"loss": 0.13658760488033295, "acc": 0.9580078125, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06975185126066208, "acc": 0.9772804975509644, "length": 3.9999308586120605, "mode": "train", "epoch": 53}
{"loss": 0.1202872097492218, "acc": 0.9619141221046448, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.06880293786525726, "acc": 0.9797967672348022, "length": 3.999901056289673, "mode": "train", "epoch": 54}
{"loss": 0.1209687888622284, "acc": 0.9591797590255737, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.062172312289476395, "acc": 0.9802659749984741, "length": 3.9999186992645264, "mode": "train", "epoch": 55}
{"loss": 0.10619327425956726, "acc": 0.9664062857627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.0570230558514595, "acc": 0.983485758304596, "length": 3.999903917312622, "mode": "train", "epoch": 56}
{"loss": 0.13662263751029968, "acc": 0.9533203840255737, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.05133339390158653, "acc": 0.9854183197021484, "length": 3.9999241828918457, "mode": "train", "epoch": 57}
{"loss": 0.09661459922790527, "acc": 0.9691405892372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.04418070614337921, "acc": 0.987643837928772, "length": 3.9999444484710693, "mode": "train", "epoch": 58}
{"loss": 0.10452178865671158, "acc": 0.9646483659744263, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.047867923974990845, "acc": 0.9865829944610596, "length": 3.999711513519287, "mode": "train", "epoch": 59}
{"loss": 0.12978783249855042, "acc": 0.9574218988418579, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.04808659479022026, "acc": 0.9863560199737549, "length": 3.9999477863311768, "mode": "train", "epoch": 60}
{"loss": 0.08697670698165894, "acc": 0.9681640267372131, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7031668424606323
