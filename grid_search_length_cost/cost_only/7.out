# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7085204720497131, "acc": 0.5119016766548157, "length": 2.40185546875, "mode": "train", "epoch": 1}
{"loss": 0.6956890225410461, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6980417370796204, "acc": 0.5275606513023376, "length": 1.0573575496673584, "mode": "train", "epoch": 2}
{"loss": 0.6950319409370422, "acc": 0.5366319417953491, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6711848974227905, "acc": 0.6044598817825317, "length": 1.591956615447998, "mode": "train", "epoch": 3}
{"loss": 0.6251240968704224, "acc": 0.6768120527267456, "length": 1.9340277910232544, "mode": "test", "epoch": 3}
{"loss": 0.5967372059822083, "acc": 0.6775415539741516, "length": 1.9201680421829224, "mode": "train", "epoch": 4}
{"loss": 0.5902535319328308, "acc": 0.6884982585906982, "length": 1.8159722089767456, "mode": "test", "epoch": 4}
{"loss": 0.5632767677307129, "acc": 0.694685697555542, "length": 1.7613911628723145, "mode": "train", "epoch": 5}
{"loss": 0.6428989171981812, "acc": 0.6536675691604614, "length": 1.4236111640930176, "mode": "test", "epoch": 5}
{"loss": 0.5255643129348755, "acc": 0.7475639581680298, "length": 1.9349440336227417, "mode": "train", "epoch": 6}
{"loss": 0.5078395009040833, "acc": 0.7920464277267456, "length": 2.5625, "mode": "test", "epoch": 6}
{"loss": 0.480594664812088, "acc": 0.7788996696472168, "length": 2.4012725353240967, "mode": "train", "epoch": 7}
{"loss": 0.475070595741272, "acc": 0.8029568791389465, "length": 2.8020832538604736, "mode": "test", "epoch": 7}
{"loss": 0.4366735816001892, "acc": 0.8048727512359619, "length": 2.7793843746185303, "mode": "train", "epoch": 8}
{"loss": 0.4209492802619934, "acc": 0.8271051049232483, "length": 3.1979167461395264, "mode": "test", "epoch": 8}
{"loss": 0.4001428484916687, "acc": 0.8290038704872131, "length": 2.9037511348724365, "mode": "train", "epoch": 9}
{"loss": 0.39689308404922485, "acc": 0.8482043743133545, "length": 3.225694417953491, "mode": "test", "epoch": 9}
{"loss": 0.3833560347557068, "acc": 0.8367393612861633, "length": 2.8740367889404297, "mode": "train", "epoch": 10}
{"loss": 0.396723210811615, "acc": 0.8406575322151184, "length": 3.090277671813965, "mode": "test", "epoch": 10}
{"loss": 0.36216461658477783, "acc": 0.8493387699127197, "length": 2.8974621295928955, "mode": "train", "epoch": 11}
{"loss": 0.3983182907104492, "acc": 0.8440918326377869, "length": 3.152777671813965, "mode": "test", "epoch": 11}
{"loss": 0.3360469937324524, "acc": 0.8650339245796204, "length": 3.073734998703003, "mode": "train", "epoch": 12}
{"loss": 0.3961043357849121, "acc": 0.8534071445465088, "length": 3.1666667461395264, "mode": "test", "epoch": 12}
{"loss": 0.3129248023033142, "acc": 0.8767738342285156, "length": 3.104630470275879, "mode": "train", "epoch": 13}
{"loss": 0.39241355657577515, "acc": 0.8461100459098816, "length": 3.159722328186035, "mode": "test", "epoch": 13}
{"loss": 0.29511377215385437, "acc": 0.8822519779205322, "length": 3.201627492904663, "mode": "train", "epoch": 14}
{"loss": 0.34738481044769287, "acc": 0.8634440302848816, "length": 3.3958332538604736, "mode": "test", "epoch": 14}
{"loss": 0.27471601963043213, "acc": 0.89261394739151, "length": 3.365360736846924, "mode": "train", "epoch": 15}
{"loss": 0.34781089425086975, "acc": 0.8670465350151062, "length": 3.6145832538604736, "mode": "test", "epoch": 15}
{"loss": 0.2488488256931305, "acc": 0.9047306180000305, "length": 3.5181901454925537, "mode": "train", "epoch": 16}
{"loss": 0.356654554605484, "acc": 0.8699761629104614, "length": 3.7326388359069824, "mode": "test", "epoch": 16}
{"loss": 0.2330470234155655, "acc": 0.9147698283195496, "length": 3.5775694847106934, "mode": "train", "epoch": 17}
{"loss": 0.3117164671421051, "acc": 0.8752821683883667, "length": 3.722222328186035, "mode": "test", "epoch": 17}
{"loss": 0.21659573912620544, "acc": 0.9231905937194824, "length": 3.6785542964935303, "mode": "train", "epoch": 18}
{"loss": 0.2988813519477844, "acc": 0.8899739384651184, "length": 3.850694417953491, "mode": "test", "epoch": 18}
{"loss": 0.2019357532262802, "acc": 0.9289901852607727, "length": 3.747251510620117, "mode": "train", "epoch": 19}
{"loss": 0.3072531521320343, "acc": 0.8923828601837158, "length": 3.944444417953491, "mode": "test", "epoch": 19}
{"loss": 0.18060408532619476, "acc": 0.9384190440177917, "length": 3.853058099746704, "mode": "train", "epoch": 20}
{"loss": 0.3023633062839508, "acc": 0.9003960490226746, "length": 3.975694417953491, "mode": "test", "epoch": 20}
{"loss": 0.1674351692199707, "acc": 0.9438435435295105, "length": 3.897749662399292, "mode": "train", "epoch": 21}
{"loss": 0.26692119240760803, "acc": 0.9068468809127808, "length": 3.9861111640930176, "mode": "test", "epoch": 21}
{"loss": 0.1552988886833191, "acc": 0.9451780319213867, "length": 3.9135093688964844, "mode": "train", "epoch": 22}
{"loss": 0.28768429160118103, "acc": 0.9006945490837097, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1475084125995636, "acc": 0.9499462246894836, "length": 3.9401588439941406, "mode": "train", "epoch": 23}
{"loss": 0.26802393794059753, "acc": 0.9074652791023254, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.14266560971736908, "acc": 0.9567766189575195, "length": 3.9463114738464355, "mode": "train", "epoch": 24}
{"loss": 0.2560977041721344, "acc": 0.9064236879348755, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.13104532659053802, "acc": 0.9559977054595947, "length": 3.948819875717163, "mode": "train", "epoch": 25}
{"loss": 0.21091830730438232, "acc": 0.925868034362793, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1291516125202179, "acc": 0.9587546586990356, "length": 3.949425458908081, "mode": "train", "epoch": 26}
{"loss": 0.21111345291137695, "acc": 0.9208332896232605, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.11144977807998657, "acc": 0.9645060300827026, "length": 3.963130235671997, "mode": "train", "epoch": 27}
{"loss": 0.20172874629497528, "acc": 0.9250000715255737, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.10761222243309021, "acc": 0.9661966562271118, "length": 3.9620046615600586, "mode": "train", "epoch": 28}
{"loss": 0.17483921349048615, "acc": 0.9380208253860474, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.10715321451425552, "acc": 0.9698933362960815, "length": 3.97678804397583, "mode": "train", "epoch": 29}
{"loss": 0.21971294283866882, "acc": 0.925868034362793, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1013120636343956, "acc": 0.9736641645431519, "length": 3.9777090549468994, "mode": "train", "epoch": 30}
{"loss": 0.16958613693714142, "acc": 0.9430558085441589, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.0921417772769928, "acc": 0.9744462370872498, "length": 3.9790687561035156, "mode": "train", "epoch": 31}
{"loss": 0.16541488468647003, "acc": 0.9418402910232544, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.08699556440114975, "acc": 0.97641521692276, "length": 3.9854254722595215, "mode": "train", "epoch": 32}
{"loss": 0.17503277957439423, "acc": 0.9401041865348816, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.08160524070262909, "acc": 0.9797762036323547, "length": 3.9884066581726074, "mode": "train", "epoch": 33}
{"loss": 0.1428556740283966, "acc": 0.9534722566604614, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.07497519254684448, "acc": 0.9839004278182983, "length": 3.988823175430298, "mode": "train", "epoch": 34}
{"loss": 0.15613648295402527, "acc": 0.9510416388511658, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.07175099104642868, "acc": 0.9839133620262146, "length": 3.9883713722229004, "mode": "train", "epoch": 35}
{"loss": 0.15245327353477478, "acc": 0.950520932674408, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.06874699145555496, "acc": 0.9855093359947205, "length": 3.990907907485962, "mode": "train", "epoch": 36}
{"loss": 0.13308997452259064, "acc": 0.9583333134651184, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.06627437472343445, "acc": 0.9866655468940735, "length": 3.988494873046875, "mode": "train", "epoch": 37}
{"loss": 0.16109949350357056, "acc": 0.9496527910232544, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.06675206869840622, "acc": 0.9853240847587585, "length": 3.993011713027954, "mode": "train", "epoch": 38}
{"loss": 0.12486197054386139, "acc": 0.9654514789581299, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.06603042781352997, "acc": 0.9852151274681091, "length": 3.994842529296875, "mode": "train", "epoch": 39}
{"loss": 0.14879201352596283, "acc": 0.9579861164093018, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.05984729528427124, "acc": 0.9899347424507141, "length": 3.9936113357543945, "mode": "train", "epoch": 40}
{"loss": 0.09908296912908554, "acc": 0.9751736521720886, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.05824148282408714, "acc": 0.9892538189888, "length": 3.995814800262451, "mode": "train", "epoch": 41}
{"loss": 0.10851886868476868, "acc": 0.9753472208976746, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.054123956710100174, "acc": 0.9916622638702393, "length": 3.994610548019409, "mode": "train", "epoch": 42}
{"loss": 0.10823611170053482, "acc": 0.9717013835906982, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.05286291986703873, "acc": 0.9909170269966125, "length": 3.994788408279419, "mode": "train", "epoch": 43}
{"loss": 0.10689137876033783, "acc": 0.9699652791023254, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.04839806631207466, "acc": 0.9931564331054688, "length": 3.996259927749634, "mode": "train", "epoch": 44}
{"loss": 0.09607622772455215, "acc": 0.9704861044883728, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.050092630088329315, "acc": 0.9925981760025024, "length": 3.9953911304473877, "mode": "train", "epoch": 45}
{"loss": 0.10221481323242188, "acc": 0.9668402075767517, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.04697515442967415, "acc": 0.9941072463989258, "length": 3.9971015453338623, "mode": "train", "epoch": 46}
{"loss": 0.10126246511936188, "acc": 0.9717013239860535, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.045018356293439865, "acc": 0.9943468570709229, "length": 3.9970648288726807, "mode": "train", "epoch": 47}
{"loss": 0.0805625170469284, "acc": 0.9779513478279114, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.04490694776177406, "acc": 0.993985116481781, "length": 3.997368812561035, "mode": "train", "epoch": 48}
{"loss": 0.09808868914842606, "acc": 0.9734375476837158, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.047300808131694794, "acc": 0.9923776388168335, "length": 3.9972095489501953, "mode": "train", "epoch": 49}
{"loss": 0.0966394916176796, "acc": 0.9750000834465027, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.03937903791666031, "acc": 0.9961575269699097, "length": 3.997558355331421, "mode": "train", "epoch": 50}
{"loss": 0.10189860314130783, "acc": 0.9758681058883667, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04783334583044052, "acc": 0.9939901828765869, "length": 3.9967095851898193, "mode": "train", "epoch": 51}
{"loss": 0.08540306240320206, "acc": 0.9774305820465088, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.044375959783792496, "acc": 0.9921046495437622, "length": 3.9978067874908447, "mode": "train", "epoch": 52}
{"loss": 0.0892549604177475, "acc": 0.9748263955116272, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.04444732517004013, "acc": 0.9933145046234131, "length": 3.997479200363159, "mode": "train", "epoch": 53}
{"loss": 0.08490413427352905, "acc": 0.9791666865348816, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.03960351273417473, "acc": 0.9967595934867859, "length": 3.99849009513855, "mode": "train", "epoch": 54}
{"loss": 0.07141236215829849, "acc": 0.982986330986023, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03879848122596741, "acc": 0.995556116104126, "length": 3.998857259750366, "mode": "train", "epoch": 55}
{"loss": 0.08002573251724243, "acc": 0.9803822040557861, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.036177411675453186, "acc": 0.9971798658370972, "length": 3.998896360397339, "mode": "train", "epoch": 56}
{"loss": 0.07089829444885254, "acc": 0.9824652075767517, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.036480534821748734, "acc": 0.9964163303375244, "length": 3.998660087585449, "mode": "train", "epoch": 57}
{"loss": 0.06184609606862068, "acc": 0.9895833134651184, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.036977726966142654, "acc": 0.996077835559845, "length": 3.998871326446533, "mode": "train", "epoch": 58}
{"loss": 0.077562615275383, "acc": 0.9805556535720825, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04135821387171745, "acc": 0.9942260384559631, "length": 3.9986605644226074, "mode": "train", "epoch": 59}
{"loss": 0.05647566542029381, "acc": 0.9914931058883667, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.04130340367555618, "acc": 0.9947552680969238, "length": 3.999220609664917, "mode": "train", "epoch": 60}
{"loss": 0.06703479588031769, "acc": 0.9854167103767395, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.763448178768158
