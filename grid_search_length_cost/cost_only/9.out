# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.713800847530365, "acc": 0.541500985622406, "length": 2.21694278717041, "mode": "train", "epoch": 1}
{"loss": 0.702089786529541, "acc": 0.537890613079071, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6983775496482849, "acc": 0.5287436246871948, "length": 1.0322438478469849, "mode": "train", "epoch": 2}
{"loss": 0.6986536979675293, "acc": 0.5384765267372131, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6982284784317017, "acc": 0.5598012804985046, "length": 1.0115382671356201, "mode": "train", "epoch": 3}
{"loss": 0.6995186805725098, "acc": 0.5478515625, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6969670653343201, "acc": 0.5511251091957092, "length": 1.00770103931427, "mode": "train", "epoch": 4}
{"loss": 0.6999150514602661, "acc": 0.5386719107627869, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6965838670730591, "acc": 0.5504335761070251, "length": 1.0054421424865723, "mode": "train", "epoch": 5}
{"loss": 0.6981998682022095, "acc": 0.5443359017372131, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6966299414634705, "acc": 0.5625576972961426, "length": 1.004372239112854, "mode": "train", "epoch": 6}
{"loss": 0.7013520002365112, "acc": 0.5304688811302185, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6974126696586609, "acc": 0.5444033145904541, "length": 1.0031629800796509, "mode": "train", "epoch": 7}
{"loss": 0.6986018419265747, "acc": 0.5634766221046448, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6963541507720947, "acc": 0.5527026653289795, "length": 1.002561092376709, "mode": "train", "epoch": 8}
{"loss": 0.6983771324157715, "acc": 0.5634766221046448, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6960759162902832, "acc": 0.5697076916694641, "length": 1.0021642446517944, "mode": "train", "epoch": 9}
{"loss": 0.6982458829879761, "acc": 0.5478515625, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6960397362709045, "acc": 0.5462281703948975, "length": 1.0018539428710938, "mode": "train", "epoch": 10}
{"loss": 0.6976701617240906, "acc": 0.5634766221046448, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6959008574485779, "acc": 0.5648930072784424, "length": 1.001478910446167, "mode": "train", "epoch": 11}
{"loss": 0.6976507902145386, "acc": 0.5634766221046448, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.696234941482544, "acc": 0.5594300031661987, "length": 1.0011643171310425, "mode": "train", "epoch": 12}
{"loss": 0.6974307894706726, "acc": 0.5634766221046448, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6956729292869568, "acc": 0.5433872938156128, "length": 1.0009973049163818, "mode": "train", "epoch": 13}
{"loss": 0.6961897015571594, "acc": 0.5443359017372131, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6951254606246948, "acc": 0.5635201334953308, "length": 1.0009363889694214, "mode": "train", "epoch": 14}
{"loss": 0.6980733871459961, "acc": 0.5634766221046448, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6936927437782288, "acc": 0.5683258771896362, "length": 1.0007277727127075, "mode": "train", "epoch": 15}
{"loss": 0.6961333155632019, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6938037872314453, "acc": 0.5597898960113525, "length": 1.0006344318389893, "mode": "train", "epoch": 16}
{"loss": 0.6963628530502319, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6938233375549316, "acc": 0.5614776015281677, "length": 1.000525951385498, "mode": "train", "epoch": 17}
{"loss": 0.6960670948028564, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6935708522796631, "acc": 0.557209312915802, "length": 1.0004651546478271, "mode": "train", "epoch": 18}
{"loss": 0.6946861147880554, "acc": 0.5599609017372131, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6946858763694763, "acc": 0.5745716691017151, "length": 1.0003902912139893, "mode": "train", "epoch": 19}
{"loss": 0.6974722146987915, "acc": 0.536328136920929, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6934987902641296, "acc": 0.5540863871574402, "length": 1.0003494024276733, "mode": "train", "epoch": 20}
{"loss": 0.695876955986023, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6929420828819275, "acc": 0.5614736080169678, "length": 1.0003069639205933, "mode": "train", "epoch": 21}
{"loss": 0.696906328201294, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6935102343559265, "acc": 0.5469961762428284, "length": 1.0002617835998535, "mode": "train", "epoch": 22}
{"loss": 0.6934045553207397, "acc": 0.5666015148162842, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6927210092544556, "acc": 0.5572704672813416, "length": 1.0002204179763794, "mode": "train", "epoch": 23}
{"loss": 0.6946729421615601, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6916012167930603, "acc": 0.5549863576889038, "length": 1.0002027750015259, "mode": "train", "epoch": 24}
{"loss": 0.6925053596496582, "acc": 0.568359375, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6917740106582642, "acc": 0.5653823018074036, "length": 1.0001819133758545, "mode": "train", "epoch": 25}
{"loss": 0.6942516565322876, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6907532811164856, "acc": 0.5626790523529053, "length": 1.000159502029419, "mode": "train", "epoch": 26}
{"loss": 0.6920745372772217, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6906695365905762, "acc": 0.5618361830711365, "length": 1.0001330375671387, "mode": "train", "epoch": 27}
{"loss": 0.6921653747558594, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6903414130210876, "acc": 0.5650832056999207, "length": 1.000132441520691, "mode": "train", "epoch": 28}
{"loss": 0.6908043622970581, "acc": 0.568359375, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.690906822681427, "acc": 0.5623778104782104, "length": 1.000108242034912, "mode": "train", "epoch": 29}
{"loss": 0.6947101354598999, "acc": 0.536328136920929, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6910678744316101, "acc": 0.56382155418396, "length": 1.0000935792922974, "mode": "train", "epoch": 30}
{"loss": 0.6915671825408936, "acc": 0.5433593392372131, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6912943124771118, "acc": 0.5617771744728088, "length": 1.0000864267349243, "mode": "train", "epoch": 31}
{"loss": 0.6964713931083679, "acc": 0.551953136920929, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6900060176849365, "acc": 0.5604559183120728, "length": 1.0000697374343872, "mode": "train", "epoch": 32}
{"loss": 0.6916006803512573, "acc": 0.572460949420929, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6889854073524475, "acc": 0.5680884122848511, "length": 1.000060796737671, "mode": "train", "epoch": 33}
{"loss": 0.6900769472122192, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6885800361633301, "acc": 0.5641219615936279, "length": 1.000057339668274, "mode": "train", "epoch": 34}
{"loss": 0.6898273229598999, "acc": 0.5814452767372131, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6886484026908875, "acc": 0.5680280923843384, "length": 1.000049114227295, "mode": "train", "epoch": 35}
{"loss": 0.6913769841194153, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6882388591766357, "acc": 0.5665854215621948, "length": 1.0000452995300293, "mode": "train", "epoch": 36}
{"loss": 0.6889297962188721, "acc": 0.568359375, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6893798112869263, "acc": 0.5612375736236572, "length": 1.0000395774841309, "mode": "train", "epoch": 37}
{"loss": 0.6885576248168945, "acc": 0.5621094107627869, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6883449554443359, "acc": 0.5618986487388611, "length": 1.0000354051589966, "mode": "train", "epoch": 38}
{"loss": 0.6897937059402466, "acc": 0.5726562142372131, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.688473641872406, "acc": 0.5629802346229553, "length": 1.0000338554382324, "mode": "train", "epoch": 39}
{"loss": 0.6889682412147522, "acc": 0.578320324420929, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6905614137649536, "acc": 0.5707927942276001, "length": 1.000027060508728, "mode": "train", "epoch": 40}
{"loss": 0.6918432116508484, "acc": 0.5726562142372131, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6892765164375305, "acc": 0.558353066444397, "length": 1.000023603439331, "mode": "train", "epoch": 41}
{"loss": 0.6902706623077393, "acc": 0.5595703125, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6875826120376587, "acc": 0.5678483247756958, "length": 1.0000286102294922, "mode": "train", "epoch": 42}
{"loss": 0.6915023922920227, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6879868507385254, "acc": 0.5623795390129089, "length": 1.0000267028808594, "mode": "train", "epoch": 43}
{"loss": 0.6878289580345154, "acc": 0.5757812857627869, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6880555152893066, "acc": 0.5666464567184448, "length": 1.0000134706497192, "mode": "train", "epoch": 44}
{"loss": 0.6884548664093018, "acc": 0.5814452767372131, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6873184442520142, "acc": 0.5660455226898193, "length": 1.0000145435333252, "mode": "train", "epoch": 45}
{"loss": 0.6892566680908203, "acc": 0.5726562142372131, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6871697902679443, "acc": 0.5601562261581421, "length": 1.0000123977661133, "mode": "train", "epoch": 46}
{"loss": 0.6887794733047485, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6871803998947144, "acc": 0.5717545747756958, "length": 1.0000108480453491, "mode": "train", "epoch": 47}
{"loss": 0.6888822317123413, "acc": 0.5726562142372131, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6875689625740051, "acc": 0.5648435354232788, "length": 1.000015377998352, "mode": "train", "epoch": 48}
{"loss": 0.689960777759552, "acc": 0.5595703125, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6861949563026428, "acc": 0.5668869614601135, "length": 1.000008463859558, "mode": "train", "epoch": 49}
{"loss": 0.6911097764968872, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6862204670906067, "acc": 0.570492684841156, "length": 1.0000064373016357, "mode": "train", "epoch": 50}
{"loss": 0.6874486207962036, "acc": 0.5757812857627869, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6868152618408203, "acc": 0.5677883625030518, "length": 1.0000064373016357, "mode": "train", "epoch": 51}
{"loss": 0.6877722144126892, "acc": 0.5814452767372131, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6860418319702148, "acc": 0.5695912837982178, "length": 1.0000059604644775, "mode": "train", "epoch": 52}
{"loss": 0.6902715563774109, "acc": 0.5595703125, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6861675977706909, "acc": 0.571394145488739, "length": 1.0000050067901611, "mode": "train", "epoch": 53}
{"loss": 0.6875805258750916, "acc": 0.5757812857627869, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6875171065330505, "acc": 0.565504789352417, "length": 1.0000056028366089, "mode": "train", "epoch": 54}
{"loss": 0.6884969472885132, "acc": 0.554492175579071, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6864621639251709, "acc": 0.5628606081008911, "length": 1.0000038146972656, "mode": "train", "epoch": 55}
{"loss": 0.6901440620422363, "acc": 0.5726562142372131, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.685851514339447, "acc": 0.5692306756973267, "length": 1.0000035762786865, "mode": "train", "epoch": 56}
{"loss": 0.6887351870536804, "acc": 0.565234363079071, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.686084508895874, "acc": 0.5664663314819336, "length": 1.0000028610229492, "mode": "train", "epoch": 57}
{"loss": 0.6876832842826843, "acc": 0.5814452767372131, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.685409426689148, "acc": 0.566286027431488, "length": 1.0000030994415283, "mode": "train", "epoch": 58}
{"loss": 0.6889364719390869, "acc": 0.554492175579071, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6857258081436157, "acc": 0.5713341236114502, "length": 1.0000026226043701, "mode": "train", "epoch": 59}
{"loss": 0.687752902507782, "acc": 0.5757812857627869, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6852485537528992, "acc": 0.5670071840286255, "length": 1.000002145767212, "mode": "train", "epoch": 60}
{"loss": 0.6867002248764038, "acc": 0.5757812857627869, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.26454538106918335
