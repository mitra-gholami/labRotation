# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7078133225440979, "acc": 0.5275669097900391, "length": 2.5147039890289307, "mode": "train", "epoch": 1}
{"loss": 0.6974979043006897, "acc": 0.5093750357627869, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6961047649383545, "acc": 0.529829204082489, "length": 1.0716737508773804, "mode": "train", "epoch": 2}
{"loss": 0.6972595453262329, "acc": 0.5183594226837158, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6664516925811768, "acc": 0.6199278235435486, "length": 1.5196574926376343, "mode": "train", "epoch": 3}
{"loss": 0.6069294810295105, "acc": 0.69677734375, "length": 1.7265625, "mode": "test", "epoch": 3}
{"loss": 0.6018043756484985, "acc": 0.6808781027793884, "length": 1.7228081226348877, "mode": "train", "epoch": 4}
{"loss": 0.5694540143013, "acc": 0.6944763660430908, "length": 1.6796875, "mode": "test", "epoch": 4}
{"loss": 0.5893142223358154, "acc": 0.6813450455665588, "length": 1.6209303140640259, "mode": "train", "epoch": 5}
{"loss": 0.5635958909988403, "acc": 0.7001708745956421, "length": 1.6796875, "mode": "test", "epoch": 5}
{"loss": 0.5813964009284973, "acc": 0.6787585020065308, "length": 1.556992530822754, "mode": "train", "epoch": 6}
{"loss": 0.5635324120521545, "acc": 0.6960572004318237, "length": 1.6640625, "mode": "test", "epoch": 6}
{"loss": 0.5775207281112671, "acc": 0.681001603603363, "length": 1.5331830978393555, "mode": "train", "epoch": 7}
{"loss": 0.5669146180152893, "acc": 0.6944093108177185, "length": 1.65625, "mode": "test", "epoch": 7}
{"loss": 0.5693998336791992, "acc": 0.6816283464431763, "length": 1.596472978591919, "mode": "train", "epoch": 8}
{"loss": 0.5676393508911133, "acc": 0.6936524510383606, "length": 1.6015625, "mode": "test", "epoch": 8}
{"loss": 0.561160147190094, "acc": 0.6989267468452454, "length": 1.687591791152954, "mode": "train", "epoch": 9}
{"loss": 0.563926637172699, "acc": 0.6930664777755737, "length": 1.796875, "mode": "test", "epoch": 9}
{"loss": 0.5360945463180542, "acc": 0.7363204956054688, "length": 2.22605562210083, "mode": "train", "epoch": 10}
{"loss": 0.527911365032196, "acc": 0.753277599811554, "length": 2.7109375, "mode": "test", "epoch": 10}
{"loss": 0.5086936354637146, "acc": 0.7699165344238281, "length": 2.665390968322754, "mode": "train", "epoch": 11}
{"loss": 0.5093168020248413, "acc": 0.7748596668243408, "length": 2.72265625, "mode": "test", "epoch": 11}
{"loss": 0.4926913380622864, "acc": 0.7805246114730835, "length": 2.6797597408294678, "mode": "train", "epoch": 12}
{"loss": 0.4958820939064026, "acc": 0.7758300304412842, "length": 3.02734375, "mode": "test", "epoch": 12}
{"loss": 0.47820618748664856, "acc": 0.7851706743240356, "length": 2.8169960975646973, "mode": "train", "epoch": 13}
{"loss": 0.49546492099761963, "acc": 0.7812744379043579, "length": 2.96484375, "mode": "test", "epoch": 13}
{"loss": 0.4664544463157654, "acc": 0.7916126847267151, "length": 2.8048694133758545, "mode": "train", "epoch": 14}
{"loss": 0.4794203042984009, "acc": 0.792279064655304, "length": 2.76171875, "mode": "test", "epoch": 14}
{"loss": 0.4453628361225128, "acc": 0.8012682199478149, "length": 2.9095685482025146, "mode": "train", "epoch": 15}
{"loss": 0.4513273239135742, "acc": 0.8023987412452698, "length": 3.125, "mode": "test", "epoch": 15}
{"loss": 0.4160130023956299, "acc": 0.8177797794342041, "length": 3.1962499618530273, "mode": "train", "epoch": 16}
{"loss": 0.4199512302875519, "acc": 0.8293640613555908, "length": 3.2265625, "mode": "test", "epoch": 16}
{"loss": 0.3843858242034912, "acc": 0.8417305946350098, "length": 3.3086771965026855, "mode": "train", "epoch": 17}
{"loss": 0.3909962773323059, "acc": 0.8471313714981079, "length": 3.2578125, "mode": "test", "epoch": 17}
{"loss": 0.3587065041065216, "acc": 0.8562573194503784, "length": 3.324587821960449, "mode": "train", "epoch": 18}
{"loss": 0.3707369863986969, "acc": 0.8539367318153381, "length": 3.3125, "mode": "test", "epoch": 18}
{"loss": 0.33060404658317566, "acc": 0.8668521046638489, "length": 3.336090564727783, "mode": "train", "epoch": 19}
{"loss": 0.3542101979255676, "acc": 0.8651611804962158, "length": 3.3359375, "mode": "test", "epoch": 19}
{"loss": 0.31051352620124817, "acc": 0.8756644129753113, "length": 3.4083681106567383, "mode": "train", "epoch": 20}
{"loss": 0.3353371024131775, "acc": 0.86260986328125, "length": 3.47265625, "mode": "test", "epoch": 20}
{"loss": 0.29679691791534424, "acc": 0.8827749490737915, "length": 3.477381944656372, "mode": "train", "epoch": 21}
{"loss": 0.3416101634502411, "acc": 0.8619322776794434, "length": 3.59765625, "mode": "test", "epoch": 21}
{"loss": 0.2886827290058136, "acc": 0.8865190148353577, "length": 3.48419451713562, "mode": "train", "epoch": 22}
{"loss": 0.3165458142757416, "acc": 0.8834656476974487, "length": 3.48046875, "mode": "test", "epoch": 22}
{"loss": 0.27364256978034973, "acc": 0.896295964717865, "length": 3.5448319911956787, "mode": "train", "epoch": 23}
{"loss": 0.301604300737381, "acc": 0.8774597644805908, "length": 3.6171875, "mode": "test", "epoch": 23}
{"loss": 0.2615296542644501, "acc": 0.8973269462585449, "length": 3.5981252193450928, "mode": "train", "epoch": 24}
{"loss": 0.2963358759880066, "acc": 0.8830749988555908, "length": 3.640625, "mode": "test", "epoch": 24}
{"loss": 0.25605636835098267, "acc": 0.9056360721588135, "length": 3.645512819290161, "mode": "train", "epoch": 25}
{"loss": 0.28170785307884216, "acc": 0.8887633681297302, "length": 3.6640625, "mode": "test", "epoch": 25}
{"loss": 0.24127091467380524, "acc": 0.9083400964736938, "length": 3.7160539627075195, "mode": "train", "epoch": 26}
{"loss": 0.2670086920261383, "acc": 0.8980957269668579, "length": 3.8125, "mode": "test", "epoch": 26}
{"loss": 0.21584466099739075, "acc": 0.919367253780365, "length": 3.786095380783081, "mode": "train", "epoch": 27}
{"loss": 0.25100719928741455, "acc": 0.9043029546737671, "length": 3.8203125, "mode": "test", "epoch": 27}
{"loss": 0.21543242037296295, "acc": 0.924229621887207, "length": 3.8384013175964355, "mode": "train", "epoch": 28}
{"loss": 0.2415032684803009, "acc": 0.9154967665672302, "length": 3.875, "mode": "test", "epoch": 28}
{"loss": 0.20231948792934418, "acc": 0.9289290308952332, "length": 3.854144811630249, "mode": "train", "epoch": 29}
{"loss": 0.24020004272460938, "acc": 0.917492687702179, "length": 3.9375, "mode": "test", "epoch": 29}
{"loss": 0.19121712446212769, "acc": 0.9305588603019714, "length": 3.8903963565826416, "mode": "train", "epoch": 30}
{"loss": 0.22157058119773865, "acc": 0.925463855266571, "length": 3.9765625, "mode": "test", "epoch": 30}
{"loss": 0.1787969321012497, "acc": 0.9393267631530762, "length": 3.9291741847991943, "mode": "train", "epoch": 31}
{"loss": 0.2247893065214157, "acc": 0.9171875715255737, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.17951631546020508, "acc": 0.9337082505226135, "length": 3.944861650466919, "mode": "train", "epoch": 32}
{"loss": 0.24150124192237854, "acc": 0.9154113531112671, "length": 3.9765625, "mode": "test", "epoch": 32}
{"loss": 0.17219416797161102, "acc": 0.9404012560844421, "length": 3.9398608207702637, "mode": "train", "epoch": 33}
{"loss": 0.24802060425281525, "acc": 0.9169127941131592, "length": 3.9765625, "mode": "test", "epoch": 33}
{"loss": 0.16779395937919617, "acc": 0.9422070980072021, "length": 3.951847553253174, "mode": "train", "epoch": 34}
{"loss": 0.18395644426345825, "acc": 0.9387512803077698, "length": 3.9765625, "mode": "test", "epoch": 34}
{"loss": 0.14935094118118286, "acc": 0.9501882791519165, "length": 3.957247257232666, "mode": "train", "epoch": 35}
{"loss": 0.18481391668319702, "acc": 0.9352782964706421, "length": 3.9921875, "mode": "test", "epoch": 35}
{"loss": 0.1563262939453125, "acc": 0.9475279450416565, "length": 3.972731828689575, "mode": "train", "epoch": 36}
{"loss": 0.21502181887626648, "acc": 0.93017578125, "length": 3.9921875, "mode": "test", "epoch": 36}
{"loss": 0.1600530594587326, "acc": 0.9462845325469971, "length": 3.9717679023742676, "mode": "train", "epoch": 37}
{"loss": 0.19976209104061127, "acc": 0.9392577409744263, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.13817395269870758, "acc": 0.9554720520973206, "length": 3.9775784015655518, "mode": "train", "epoch": 38}
{"loss": 0.16404764354228973, "acc": 0.9441405534744263, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.13231512904167175, "acc": 0.9563761353492737, "length": 3.9837982654571533, "mode": "train", "epoch": 39}
{"loss": 0.1723930388689041, "acc": 0.9419922232627869, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.12805643677711487, "acc": 0.9606147408485413, "length": 3.9823555946350098, "mode": "train", "epoch": 40}
{"loss": 0.1855887919664383, "acc": 0.9416016340255737, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.11294542253017426, "acc": 0.9643102288246155, "length": 3.989046812057495, "mode": "train", "epoch": 41}
{"loss": 0.16265718638896942, "acc": 0.9554687142372131, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.10346153378486633, "acc": 0.9721802473068237, "length": 3.9933552742004395, "mode": "train", "epoch": 42}
{"loss": 0.15927287936210632, "acc": 0.9484376311302185, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.10414713621139526, "acc": 0.9699967503547668, "length": 3.9949426651000977, "mode": "train", "epoch": 43}
{"loss": 0.16610240936279297, "acc": 0.9443359375, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.10677465051412582, "acc": 0.9672982692718506, "length": 3.995253324508667, "mode": "train", "epoch": 44}
{"loss": 0.16649046540260315, "acc": 0.9496093392372131, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.09928885102272034, "acc": 0.97276771068573, "length": 3.9948794841766357, "mode": "train", "epoch": 45}
{"loss": 0.14891362190246582, "acc": 0.9496093392372131, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.09591307491064072, "acc": 0.9734588265419006, "length": 3.993844747543335, "mode": "train", "epoch": 46}
{"loss": 0.1604401171207428, "acc": 0.9488281607627869, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.0972633883357048, "acc": 0.9741020202636719, "length": 3.997037410736084, "mode": "train", "epoch": 47}
{"loss": 0.17082469165325165, "acc": 0.9521484375, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.09180331230163574, "acc": 0.9749900102615356, "length": 3.997304916381836, "mode": "train", "epoch": 48}
{"loss": 0.17169788479804993, "acc": 0.9564452767372131, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.09588756412267685, "acc": 0.9742211103439331, "length": 3.997377395629883, "mode": "train", "epoch": 49}
{"loss": 0.13775020837783813, "acc": 0.9587889909744263, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.08594048768281937, "acc": 0.9784466624259949, "length": 3.9972734451293945, "mode": "train", "epoch": 50}
{"loss": 0.1660614311695099, "acc": 0.9496093392372131, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.08022527396678925, "acc": 0.9803780317306519, "length": 3.997955560684204, "mode": "train", "epoch": 51}
{"loss": 0.11432576179504395, "acc": 0.9703125357627869, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.07203613966703415, "acc": 0.9848214387893677, "length": 3.995452880859375, "mode": "train", "epoch": 52}
{"loss": 0.12359060347080231, "acc": 0.9621094465255737, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07713799923658371, "acc": 0.9829711318016052, "length": 3.9969117641448975, "mode": "train", "epoch": 53}
{"loss": 0.1292540729045868, "acc": 0.9625000357627869, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07136008888483047, "acc": 0.9851127862930298, "length": 3.998584032058716, "mode": "train", "epoch": 54}
{"loss": 0.13298740983009338, "acc": 0.9712890982627869, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.06763911992311478, "acc": 0.9853139519691467, "length": 3.9981374740600586, "mode": "train", "epoch": 55}
{"loss": 0.13122999668121338, "acc": 0.9664062857627869, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.05970103293657303, "acc": 0.9888222217559814, "length": 3.9991841316223145, "mode": "train", "epoch": 56}
{"loss": 0.1138547882437706, "acc": 0.9763671159744263, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.05908770486712456, "acc": 0.9890528917312622, "length": 3.998945713043213, "mode": "train", "epoch": 57}
{"loss": 0.14477385580539703, "acc": 0.9632812142372131, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06193316727876663, "acc": 0.9885604381561279, "length": 3.9986801147460938, "mode": "train", "epoch": 58}
{"loss": 0.11105241626501083, "acc": 0.970703125, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.05986011028289795, "acc": 0.987908661365509, "length": 3.998638153076172, "mode": "train", "epoch": 59}
{"loss": 0.1132039800286293, "acc": 0.9765624403953552, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.059286125004291534, "acc": 0.9892821311950684, "length": 3.9989452362060547, "mode": "train", "epoch": 60}
{"loss": 0.12827061116695404, "acc": 0.9703125357627869, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8064063191413879
