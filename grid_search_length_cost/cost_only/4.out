# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7063289880752563, "acc": 0.5198608040809631, "length": 2.33722186088562, "mode": "train", "epoch": 1}
{"loss": 0.7052227854728699, "acc": 0.513867199420929, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6955826282501221, "acc": 0.5220448970794678, "length": 1.055867314338684, "mode": "train", "epoch": 2}
{"loss": 0.7021328210830688, "acc": 0.5044922232627869, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6953635215759277, "acc": 0.5195153951644897, "length": 1.016890287399292, "mode": "train", "epoch": 3}
{"loss": 0.7035360932350159, "acc": 0.5013671517372131, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6943154335021973, "acc": 0.5376781225204468, "length": 1.0110901594161987, "mode": "train", "epoch": 4}
{"loss": 0.704737663269043, "acc": 0.49726560711860657, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6945355534553528, "acc": 0.5236337184906006, "length": 1.0075141191482544, "mode": "train", "epoch": 5}
{"loss": 0.7015760540962219, "acc": 0.49667972326278687, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6941792368888855, "acc": 0.5319234132766724, "length": 1.0049569606781006, "mode": "train", "epoch": 6}
{"loss": 0.7036947011947632, "acc": 0.4892578125, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6930417418479919, "acc": 0.5226841568946838, "length": 1.0042288303375244, "mode": "train", "epoch": 7}
{"loss": 0.7016283273696899, "acc": 0.49687501788139343, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6939849853515625, "acc": 0.5258550047874451, "length": 1.0032157897949219, "mode": "train", "epoch": 8}
{"loss": 0.7015894651412964, "acc": 0.5044922232627869, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6935139894485474, "acc": 0.5448023080825806, "length": 1.00271475315094, "mode": "train", "epoch": 9}
{"loss": 0.7011941075325012, "acc": 0.5070313811302185, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6941924095153809, "acc": 0.5350614786148071, "length": 1.002320408821106, "mode": "train", "epoch": 10}
{"loss": 0.7032618522644043, "acc": 0.5013671517372131, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.693557858467102, "acc": 0.5392589569091797, "length": 1.0019855499267578, "mode": "train", "epoch": 11}
{"loss": 0.7024107575416565, "acc": 0.502148449420929, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6933297514915466, "acc": 0.5279183387756348, "length": 1.0015870332717896, "mode": "train", "epoch": 12}
{"loss": 0.7004641890525818, "acc": 0.5013671517372131, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.693925678730011, "acc": 0.527923047542572, "length": 1.0012410879135132, "mode": "train", "epoch": 13}
{"loss": 0.7024245858192444, "acc": 0.5160155892372131, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6939797401428223, "acc": 0.5374872088432312, "length": 1.0010035037994385, "mode": "train", "epoch": 14}
{"loss": 0.701050877571106, "acc": 0.5017578601837158, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6939429640769958, "acc": 0.5315271615982056, "length": 1.0009781122207642, "mode": "train", "epoch": 15}
{"loss": 0.7035711407661438, "acc": 0.50390625, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.692768931388855, "acc": 0.5386648774147034, "length": 1.0007635354995728, "mode": "train", "epoch": 16}
{"loss": 0.7001946568489075, "acc": 0.5035156607627869, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6934845447540283, "acc": 0.5340024828910828, "length": 1.0006442070007324, "mode": "train", "epoch": 17}
{"loss": 0.7009890079498291, "acc": 0.524218738079071, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6931070685386658, "acc": 0.5306966304779053, "length": 1.0005459785461426, "mode": "train", "epoch": 18}
{"loss": 0.7008898854255676, "acc": 0.521484375, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6927918791770935, "acc": 0.541262149810791, "length": 1.0004976987838745, "mode": "train", "epoch": 19}
{"loss": 0.701172411441803, "acc": 0.5107421875, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6923991441726685, "acc": 0.5366569757461548, "length": 1.0004537105560303, "mode": "train", "epoch": 20}
{"loss": 0.700330376625061, "acc": 0.48906248807907104, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.693220853805542, "acc": 0.5417964458465576, "length": 1.0003899335861206, "mode": "train", "epoch": 21}
{"loss": 0.7014778256416321, "acc": 0.516406238079071, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6924998760223389, "acc": 0.5386654734611511, "length": 1.0003384351730347, "mode": "train", "epoch": 22}
{"loss": 0.7010133266448975, "acc": 0.4978516101837158, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.692552924156189, "acc": 0.5407931208610535, "length": 1.0003026723861694, "mode": "train", "epoch": 23}
{"loss": 0.7009854912757874, "acc": 0.51953125, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6919856071472168, "acc": 0.5256796479225159, "length": 1.0002732276916504, "mode": "train", "epoch": 24}
{"loss": 0.6997183561325073, "acc": 0.5203125476837158, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6916621923446655, "acc": 0.5357156991958618, "length": 1.000235676765442, "mode": "train", "epoch": 25}
{"loss": 0.7030127644538879, "acc": 0.48867183923721313, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6923025846481323, "acc": 0.5401424169540405, "length": 1.0002003908157349, "mode": "train", "epoch": 26}
{"loss": 0.6995182633399963, "acc": 0.5203125476837158, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6919176578521729, "acc": 0.5389614105224609, "length": 1.0001704692840576, "mode": "train", "epoch": 27}
{"loss": 0.7008693218231201, "acc": 0.5052734017372131, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6913058161735535, "acc": 0.5478750467300415, "length": 1.0001612901687622, "mode": "train", "epoch": 28}
{"loss": 0.6995853185653687, "acc": 0.5203125476837158, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6904045939445496, "acc": 0.5423842072486877, "length": 1.0001424551010132, "mode": "train", "epoch": 29}
{"loss": 0.7006581425666809, "acc": 0.5132812857627869, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6915587782859802, "acc": 0.5425621271133423, "length": 1.0001194477081299, "mode": "train", "epoch": 30}
{"loss": 0.7003923654556274, "acc": 0.506640613079071, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.6910365223884583, "acc": 0.5349465012550354, "length": 1.0001263618469238, "mode": "train", "epoch": 31}
{"loss": 0.6980324983596802, "acc": 0.517382800579071, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6906691789627075, "acc": 0.5429160594940186, "length": 1.0001015663146973, "mode": "train", "epoch": 32}
{"loss": 0.7015993595123291, "acc": 0.507617175579071, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6906658411026001, "acc": 0.5495864748954773, "length": 1.0000884532928467, "mode": "train", "epoch": 33}
{"loss": 0.699717104434967, "acc": 0.5042968392372131, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6898300051689148, "acc": 0.539138674736023, "length": 1.00007963180542, "mode": "train", "epoch": 34}
{"loss": 0.698387622833252, "acc": 0.5123047232627869, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6904144287109375, "acc": 0.5394920110702515, "length": 1.000073790550232, "mode": "train", "epoch": 35}
{"loss": 0.7011098265647888, "acc": 0.5009765625, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.689440131187439, "acc": 0.5501174926757812, "length": 1.0000572204589844, "mode": "train", "epoch": 36}
{"loss": 0.6987581253051758, "acc": 0.5119141936302185, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6902492046356201, "acc": 0.5448640584945679, "length": 1.0000535249710083, "mode": "train", "epoch": 37}
{"loss": 0.7015671133995056, "acc": 0.5064453482627869, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6902759075164795, "acc": 0.5463400483131409, "length": 1.0000462532043457, "mode": "train", "epoch": 38}
{"loss": 0.6991912126541138, "acc": 0.5126953125, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6901956796646118, "acc": 0.5433881282806396, "length": 1.0000429153442383, "mode": "train", "epoch": 39}
{"loss": 0.7005874514579773, "acc": 0.503125011920929, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6904579997062683, "acc": 0.5405548214912415, "length": 1.00003981590271, "mode": "train", "epoch": 40}
{"loss": 0.698456883430481, "acc": 0.5060546398162842, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.690792441368103, "acc": 0.5400238037109375, "length": 1.0000332593917847, "mode": "train", "epoch": 41}
{"loss": 0.6989185810089111, "acc": 0.525390625, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6902517676353455, "acc": 0.5467530488967896, "length": 1.0000308752059937, "mode": "train", "epoch": 42}
{"loss": 0.6991536617279053, "acc": 0.5060546398162842, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6895768046379089, "acc": 0.5534829497337341, "length": 1.0000249147415161, "mode": "train", "epoch": 43}
{"loss": 0.7002649903297424, "acc": 0.5060546398162842, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6899153590202332, "acc": 0.541027307510376, "length": 1.0000215768814087, "mode": "train", "epoch": 44}
{"loss": 0.6979241371154785, "acc": 0.5019531846046448, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6896979808807373, "acc": 0.5454543232917786, "length": 1.0000228881835938, "mode": "train", "epoch": 45}
{"loss": 0.6992278695106506, "acc": 0.5140624642372131, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6900032162666321, "acc": 0.5337071418762207, "length": 1.0000190734863281, "mode": "train", "epoch": 46}
{"loss": 0.7006701827049255, "acc": 0.5056641101837158, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6900090575218201, "acc": 0.5455725789070129, "length": 1.000015139579773, "mode": "train", "epoch": 47}
{"loss": 0.6988440752029419, "acc": 0.517382800579071, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6890664100646973, "acc": 0.5465761423110962, "length": 1.000042200088501, "mode": "train", "epoch": 48}
{"loss": 0.700090765953064, "acc": 0.5140624642372131, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6898440718650818, "acc": 0.549114465713501, "length": 1.0000132322311401, "mode": "train", "epoch": 49}
{"loss": 0.7001978158950806, "acc": 0.5140624642372131, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6890778541564941, "acc": 0.544864296913147, "length": 1.0000090599060059, "mode": "train", "epoch": 50}
{"loss": 0.7010995149612427, "acc": 0.49941402673721313, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6901237368583679, "acc": 0.5399646759033203, "length": 1.0000137090682983, "mode": "train", "epoch": 51}
{"loss": 0.6995019912719727, "acc": 0.514453113079071, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.6886265873908997, "acc": 0.5442148447036743, "length": 1.0000098943710327, "mode": "train", "epoch": 52}
{"loss": 0.6985149383544922, "acc": 0.5060546398162842, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6892723441123962, "acc": 0.5491735935211182, "length": 1.0000091791152954, "mode": "train", "epoch": 53}
{"loss": 0.6976044774055481, "acc": 0.5191406607627869, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6901912093162537, "acc": 0.546103835105896, "length": 1.0000066757202148, "mode": "train", "epoch": 54}
{"loss": 0.7004520297050476, "acc": 0.5060546398162842, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6882317066192627, "acc": 0.5512397885322571, "length": 1.0000102519989014, "mode": "train", "epoch": 55}
{"loss": 0.6971395015716553, "acc": 0.5191406607627869, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6890274882316589, "acc": 0.5492326021194458, "length": 1.0000050067901611, "mode": "train", "epoch": 56}
{"loss": 0.7003711462020874, "acc": 0.5140624642372131, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6897555589675903, "acc": 0.5448642373085022, "length": 1.0000052452087402, "mode": "train", "epoch": 57}
{"loss": 0.6983104348182678, "acc": 0.5140624642372131, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6882896423339844, "acc": 0.5471664667129517, "length": 1.0000035762786865, "mode": "train", "epoch": 58}
{"loss": 0.6980462670326233, "acc": 0.5048828125, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6885042786598206, "acc": 0.5533058047294617, "length": 1.0000033378601074, "mode": "train", "epoch": 59}
{"loss": 0.7028453946113586, "acc": 0.5140624642372131, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6890556216239929, "acc": 0.554014265537262, "length": 1.0000042915344238, "mode": "train", "epoch": 60}
{"loss": 0.6982032060623169, "acc": 0.512890636920929, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.3446774482727051
