# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7072401642799377, "acc": 0.5244787931442261, "length": 2.4205117225646973, "mode": "train", "epoch": 1}
{"loss": 0.6942368745803833, "acc": 0.5519096851348877, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6949993371963501, "acc": 0.5378445386886597, "length": 1.052012324333191, "mode": "train", "epoch": 2}
{"loss": 0.6946933269500732, "acc": 0.5270834565162659, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6946433782577515, "acc": 0.5318616032600403, "length": 1.018709659576416, "mode": "train", "epoch": 3}
{"loss": 0.69479900598526, "acc": 0.5289930105209351, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6950153708457947, "acc": 0.5400993227958679, "length": 1.0132968425750732, "mode": "train", "epoch": 4}
{"loss": 0.6940367817878723, "acc": 0.5289930105209351, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6946074366569519, "acc": 0.5251408815383911, "length": 1.0099608898162842, "mode": "train", "epoch": 5}
{"loss": 0.6933349370956421, "acc": 0.5401042699813843, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6963058114051819, "acc": 0.5335372090339661, "length": 1.0078489780426025, "mode": "train", "epoch": 6}
{"loss": 0.6963322758674622, "acc": 0.5131943821907043, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6956073045730591, "acc": 0.5310940146446228, "length": 1.0056772232055664, "mode": "train", "epoch": 7}
{"loss": 0.6932148337364197, "acc": 0.5253472328186035, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6939146518707275, "acc": 0.5323495864868164, "length": 1.0043878555297852, "mode": "train", "epoch": 8}
{"loss": 0.695344090461731, "acc": 0.5190972685813904, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6948429942131042, "acc": 0.5358920693397522, "length": 1.0040537118911743, "mode": "train", "epoch": 9}
{"loss": 0.6943055391311646, "acc": 0.5453125238418579, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6952681541442871, "acc": 0.5384529829025269, "length": 1.0034136772155762, "mode": "train", "epoch": 10}
{"loss": 0.6933461427688599, "acc": 0.5270834565162659, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6942476630210876, "acc": 0.5348544716835022, "length": 1.00309419631958, "mode": "train", "epoch": 11}
{"loss": 0.6933366060256958, "acc": 0.5289930105209351, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6937296390533447, "acc": 0.5384141802787781, "length": 1.0029503107070923, "mode": "train", "epoch": 12}
{"loss": 0.6929473876953125, "acc": 0.5289930105209351, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.6936168074607849, "acc": 0.5400332808494568, "length": 1.0025957822799683, "mode": "train", "epoch": 13}
{"loss": 0.6932628154754639, "acc": 0.5253472328186035, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6944560408592224, "acc": 0.5393208861351013, "length": 1.0026216506958008, "mode": "train", "epoch": 14}
{"loss": 0.6928734183311462, "acc": 0.5414930582046509, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6940920948982239, "acc": 0.5364221334457397, "length": 1.002713918685913, "mode": "train", "epoch": 15}
{"loss": 0.6931679844856262, "acc": 0.5289930105209351, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6931944489479065, "acc": 0.5404257774353027, "length": 1.0029792785644531, "mode": "train", "epoch": 16}
{"loss": 0.6931243538856506, "acc": 0.5381944179534912, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6937453746795654, "acc": 0.5421423316001892, "length": 1.0039793252944946, "mode": "train", "epoch": 17}
{"loss": 0.6932337880134583, "acc": 0.5289930105209351, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6916590929031372, "acc": 0.5531136989593506, "length": 1.0593693256378174, "mode": "train", "epoch": 18}
{"loss": 0.6714988946914673, "acc": 0.5973958373069763, "length": 2.34375, "mode": "test", "epoch": 18}
{"loss": 0.6201198101043701, "acc": 0.6777665019035339, "length": 2.1347906589508057, "mode": "train", "epoch": 19}
{"loss": 0.6291624903678894, "acc": 0.700526237487793, "length": 2.4201388359069824, "mode": "test", "epoch": 19}
{"loss": 0.5810965895652771, "acc": 0.7108056545257568, "length": 2.1734931468963623, "mode": "train", "epoch": 20}
{"loss": 0.6177156567573547, "acc": 0.705126941204071, "length": 2.559027671813965, "mode": "test", "epoch": 20}
{"loss": 0.5598729252815247, "acc": 0.7175697088241577, "length": 2.362250804901123, "mode": "train", "epoch": 21}
{"loss": 0.560864269733429, "acc": 0.7379394769668579, "length": 3.0416667461395264, "mode": "test", "epoch": 21}
{"loss": 0.5032493472099304, "acc": 0.7635918855667114, "length": 3.0554635524749756, "mode": "train", "epoch": 22}
{"loss": 0.506178081035614, "acc": 0.7736870646476746, "length": 3.125, "mode": "test", "epoch": 22}
{"loss": 0.45998990535736084, "acc": 0.7980843782424927, "length": 3.0957772731781006, "mode": "train", "epoch": 23}
{"loss": 0.48199597001075745, "acc": 0.7869683504104614, "length": 3.125, "mode": "test", "epoch": 23}
{"loss": 0.42582792043685913, "acc": 0.8146867752075195, "length": 3.2341513633728027, "mode": "train", "epoch": 24}
{"loss": 0.47020992636680603, "acc": 0.7894043326377869, "length": 3.1145832538604736, "mode": "test", "epoch": 24}
{"loss": 0.4051259160041809, "acc": 0.827923059463501, "length": 3.2290546894073486, "mode": "train", "epoch": 25}
{"loss": 0.43562576174736023, "acc": 0.8070746660232544, "length": 3.1875, "mode": "test", "epoch": 25}
{"loss": 0.37733709812164307, "acc": 0.8389549255371094, "length": 3.2764573097229004, "mode": "train", "epoch": 26}
{"loss": 0.4117240905761719, "acc": 0.8202745914459229, "length": 3.125, "mode": "test", "epoch": 26}
{"loss": 0.3574751317501068, "acc": 0.8501750230789185, "length": 3.3462860584259033, "mode": "train", "epoch": 27}
{"loss": 0.40741294622421265, "acc": 0.8266818523406982, "length": 3.15625, "mode": "test", "epoch": 27}
{"loss": 0.34417128562927246, "acc": 0.8579997420310974, "length": 3.3596527576446533, "mode": "train", "epoch": 28}
{"loss": 0.375772625207901, "acc": 0.8431098461151123, "length": 3.34375, "mode": "test", "epoch": 28}
{"loss": 0.32720044255256653, "acc": 0.8681458830833435, "length": 3.3920440673828125, "mode": "train", "epoch": 29}
{"loss": 0.37172698974609375, "acc": 0.8519694805145264, "length": 3.375, "mode": "test", "epoch": 29}
{"loss": 0.3122766315937042, "acc": 0.8780977725982666, "length": 3.431849479675293, "mode": "train", "epoch": 30}
{"loss": 0.3552721440792084, "acc": 0.8530979156494141, "length": 3.3958332538604736, "mode": "test", "epoch": 30}
{"loss": 0.3006865978240967, "acc": 0.8812365531921387, "length": 3.466691017150879, "mode": "train", "epoch": 31}
{"loss": 0.34746503829956055, "acc": 0.8630588054656982, "length": 3.4270832538604736, "mode": "test", "epoch": 31}
{"loss": 0.28426873683929443, "acc": 0.8880414366722107, "length": 3.5178842544555664, "mode": "train", "epoch": 32}
{"loss": 0.3249901533126831, "acc": 0.8711968064308167, "length": 3.5, "mode": "test", "epoch": 32}
{"loss": 0.2779366672039032, "acc": 0.8888838887214661, "length": 3.5610063076019287, "mode": "train", "epoch": 33}
{"loss": 0.3245348334312439, "acc": 0.8776041865348816, "length": 3.5208332538604736, "mode": "test", "epoch": 33}
{"loss": 0.2714718282222748, "acc": 0.8931325674057007, "length": 3.5794334411621094, "mode": "train", "epoch": 34}
{"loss": 0.3164035379886627, "acc": 0.8800727128982544, "length": 3.3541667461395264, "mode": "test", "epoch": 34}
{"loss": 0.2682610750198364, "acc": 0.8941916823387146, "length": 3.5566139221191406, "mode": "train", "epoch": 35}
{"loss": 0.3316068649291992, "acc": 0.875374436378479, "length": 3.6388888359069824, "mode": "test", "epoch": 35}
{"loss": 0.25954440236091614, "acc": 0.8989458084106445, "length": 3.630136013031006, "mode": "train", "epoch": 36}
{"loss": 0.33454790711402893, "acc": 0.8656847476959229, "length": 3.8020832538604736, "mode": "test", "epoch": 36}
{"loss": 0.25223594903945923, "acc": 0.9030687808990479, "length": 3.719940423965454, "mode": "train", "epoch": 37}
{"loss": 0.3289910852909088, "acc": 0.8757269382476807, "length": 3.90625, "mode": "test", "epoch": 37}
{"loss": 0.2433418333530426, "acc": 0.9079107642173767, "length": 3.8127059936523438, "mode": "train", "epoch": 38}
{"loss": 0.2801951467990875, "acc": 0.8969401121139526, "length": 3.993055582046509, "mode": "test", "epoch": 38}
{"loss": 0.238360196352005, "acc": 0.9117246866226196, "length": 3.948458194732666, "mode": "train", "epoch": 39}
{"loss": 0.2551126182079315, "acc": 0.9098958969116211, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.2348034381866455, "acc": 0.9130541682243347, "length": 3.9773035049438477, "mode": "train", "epoch": 40}
{"loss": 0.25842636823654175, "acc": 0.9093749523162842, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.22733080387115479, "acc": 0.9161567687988281, "length": 3.9900169372558594, "mode": "train", "epoch": 41}
{"loss": 0.2732890844345093, "acc": 0.8947916030883789, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.22949516773223877, "acc": 0.9135429859161377, "length": 3.9935104846954346, "mode": "train", "epoch": 42}
{"loss": 0.2564776837825775, "acc": 0.9156249165534973, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.21642443537712097, "acc": 0.9176725149154663, "length": 3.9949588775634766, "mode": "train", "epoch": 43}
{"loss": 0.23895563185214996, "acc": 0.9144097566604614, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.21069592237472534, "acc": 0.9210371971130371, "length": 3.995776653289795, "mode": "train", "epoch": 44}
{"loss": 0.24235878884792328, "acc": 0.9085069298744202, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.21232442557811737, "acc": 0.9190993309020996, "length": 3.9978771209716797, "mode": "train", "epoch": 45}
{"loss": 0.24385949969291687, "acc": 0.9079861044883728, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.21038657426834106, "acc": 0.9200936555862427, "length": 3.998016119003296, "mode": "train", "epoch": 46}
{"loss": 0.23967327177524567, "acc": 0.9166666865348816, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.20945420861244202, "acc": 0.9210780262947083, "length": 3.998155117034912, "mode": "train", "epoch": 47}
{"loss": 0.23499281704425812, "acc": 0.9114583134651184, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.20526465773582458, "acc": 0.9165083169937134, "length": 3.9986274242401123, "mode": "train", "epoch": 48}
{"loss": 0.23915311694145203, "acc": 0.9161460399627686, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.19724519550800323, "acc": 0.9233563542366028, "length": 3.998880624771118, "mode": "train", "epoch": 49}
{"loss": 0.24099679291248322, "acc": 0.9173610210418701, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.19089999794960022, "acc": 0.9266588091850281, "length": 3.9988677501678467, "mode": "train", "epoch": 50}
{"loss": 0.22903990745544434, "acc": 0.9088541865348816, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.18796919286251068, "acc": 0.931065022945404, "length": 3.999039649963379, "mode": "train", "epoch": 51}
{"loss": 0.22600878775119781, "acc": 0.9210069179534912, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.18180140852928162, "acc": 0.9313621520996094, "length": 3.999253034591675, "mode": "train", "epoch": 52}
{"loss": 0.240362748503685, "acc": 0.9098958969116211, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.18750102818012238, "acc": 0.932030439376831, "length": 3.9977047443389893, "mode": "train", "epoch": 53}
{"loss": 0.2406783103942871, "acc": 0.9111111164093018, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.194148987531662, "acc": 0.926084041595459, "length": 3.9991796016693115, "mode": "train", "epoch": 54}
{"loss": 0.2791270315647125, "acc": 0.8998263478279114, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.20340806245803833, "acc": 0.9210953712463379, "length": 3.9994089603424072, "mode": "train", "epoch": 55}
{"loss": 0.24342118203639984, "acc": 0.9185764789581299, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.18949711322784424, "acc": 0.9310190677642822, "length": 3.99953293800354, "mode": "train", "epoch": 56}
{"loss": 0.22109295427799225, "acc": 0.9263889789581299, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1688033938407898, "acc": 0.939637303352356, "length": 3.998952627182007, "mode": "train", "epoch": 57}
{"loss": 0.2211882621049881, "acc": 0.925694465637207, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.19136495888233185, "acc": 0.9323395490646362, "length": 3.9992828369140625, "mode": "train", "epoch": 58}
{"loss": 0.2580861449241638, "acc": 0.9010416865348816, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.17316333949565887, "acc": 0.940284013748169, "length": 3.9991331100463867, "mode": "train", "epoch": 59}
{"loss": 0.2190772444009781, "acc": 0.9300347566604614, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.15583978593349457, "acc": 0.9477732181549072, "length": 3.999478340148926, "mode": "train", "epoch": 60}
{"loss": 0.22146494686603546, "acc": 0.9293402433395386, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8872414231300354
