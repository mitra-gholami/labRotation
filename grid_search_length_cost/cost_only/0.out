# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.01"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.7151383757591248, "acc": 0.5435999035835266, "length": 2.2548279762268066, "mode": "train", "epoch": 1}
{"loss": 0.7050952911376953, "acc": 0.5104166865348816, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6971081495285034, "acc": 0.5546283721923828, "length": 1.0310388803482056, "mode": "train", "epoch": 2}
{"loss": 0.7030453085899353, "acc": 0.5355903506278992, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6966111063957214, "acc": 0.5406585931777954, "length": 1.0137392282485962, "mode": "train", "epoch": 3}
{"loss": 0.7015533447265625, "acc": 0.5300347805023193, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6954668760299683, "acc": 0.5491927862167358, "length": 1.008392333984375, "mode": "train", "epoch": 4}
{"loss": 0.704583466053009, "acc": 0.528124988079071, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6935056447982788, "acc": 0.5491688251495361, "length": 1.006260871887207, "mode": "train", "epoch": 5}
{"loss": 0.7032527327537537, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 5}
{"loss": 0.6971533298492432, "acc": 0.5561390519142151, "length": 1.0047101974487305, "mode": "train", "epoch": 6}
{"loss": 0.7026664614677429, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 6}
{"loss": 0.6961140036582947, "acc": 0.5511876940727234, "length": 1.0034127235412598, "mode": "train", "epoch": 7}
{"loss": 0.7033179402351379, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 7}
{"loss": 0.6946333646774292, "acc": 0.5474247336387634, "length": 1.0028197765350342, "mode": "train", "epoch": 8}
{"loss": 0.7030684947967529, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 8}
{"loss": 0.6935456395149231, "acc": 0.5542607307434082, "length": 1.0022345781326294, "mode": "train", "epoch": 9}
{"loss": 0.703831136226654, "acc": 0.5005208849906921, "length": 1.0, "mode": "test", "epoch": 9}
{"loss": 0.6955472230911255, "acc": 0.5470108985900879, "length": 1.0017813444137573, "mode": "train", "epoch": 10}
{"loss": 0.7037637233734131, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 10}
{"loss": 0.6946460008621216, "acc": 0.5499464273452759, "length": 1.0016075372695923, "mode": "train", "epoch": 11}
{"loss": 0.702869176864624, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 11}
{"loss": 0.6931763291358948, "acc": 0.5554577708244324, "length": 1.0012520551681519, "mode": "train", "epoch": 12}
{"loss": 0.7049407958984375, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 12}
{"loss": 0.69353187084198, "acc": 0.5597198009490967, "length": 1.001030445098877, "mode": "train", "epoch": 13}
{"loss": 0.7018359899520874, "acc": 0.5300347805023193, "length": 1.0, "mode": "test", "epoch": 13}
{"loss": 0.6950886845588684, "acc": 0.5546585917472839, "length": 1.0009140968322754, "mode": "train", "epoch": 14}
{"loss": 0.7021862864494324, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 14}
{"loss": 0.6929724812507629, "acc": 0.5537406802177429, "length": 1.0007456541061401, "mode": "train", "epoch": 15}
{"loss": 0.7030470371246338, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 15}
{"loss": 0.6933001279830933, "acc": 0.5623693466186523, "length": 1.0006675720214844, "mode": "train", "epoch": 16}
{"loss": 0.703125, "acc": 0.5229166150093079, "length": 1.0, "mode": "test", "epoch": 16}
{"loss": 0.6932404041290283, "acc": 0.5480442047119141, "length": 1.0005837678909302, "mode": "train", "epoch": 17}
{"loss": 0.7018688321113586, "acc": 0.528124988079071, "length": 1.0, "mode": "test", "epoch": 17}
{"loss": 0.6933525800704956, "acc": 0.5540294647216797, "length": 1.0005007982254028, "mode": "train", "epoch": 18}
{"loss": 0.7015244960784912, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 18}
{"loss": 0.6935786604881287, "acc": 0.5539717078208923, "length": 1.000447392463684, "mode": "train", "epoch": 19}
{"loss": 0.7011606693267822, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 19}
{"loss": 0.6918491721153259, "acc": 0.5582287311553955, "length": 1.000388264656067, "mode": "train", "epoch": 20}
{"loss": 0.7022793292999268, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 20}
{"loss": 0.6925857067108154, "acc": 0.5609897971153259, "length": 1.0003232955932617, "mode": "train", "epoch": 21}
{"loss": 0.7018905878067017, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 21}
{"loss": 0.6920102834701538, "acc": 0.5615063309669495, "length": 1.0002778768539429, "mode": "train", "epoch": 22}
{"loss": 0.7007832527160645, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 22}
{"loss": 0.6924341320991516, "acc": 0.5585726499557495, "length": 1.0002490282058716, "mode": "train", "epoch": 23}
{"loss": 0.7008180022239685, "acc": 0.528124988079071, "length": 1.0, "mode": "test", "epoch": 23}
{"loss": 0.6913918852806091, "acc": 0.5562139749526978, "length": 1.0002115964889526, "mode": "train", "epoch": 24}
{"loss": 0.7010114789009094, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 24}
{"loss": 0.6915857195854187, "acc": 0.5533369183540344, "length": 1.000187635421753, "mode": "train", "epoch": 25}
{"loss": 0.701077401638031, "acc": 0.5390625, "length": 1.0, "mode": "test", "epoch": 25}
{"loss": 0.6919360756874084, "acc": 0.5660527348518372, "length": 1.000160574913025, "mode": "train", "epoch": 26}
{"loss": 0.7030083537101746, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 26}
{"loss": 0.6913020610809326, "acc": 0.5637512803077698, "length": 1.000138759613037, "mode": "train", "epoch": 27}
{"loss": 0.7009847164154053, "acc": 0.5149305462837219, "length": 1.0, "mode": "test", "epoch": 27}
{"loss": 0.6906572580337524, "acc": 0.5546608567237854, "length": 1.0001327991485596, "mode": "train", "epoch": 28}
{"loss": 0.702080488204956, "acc": 0.518750011920929, "length": 1.0, "mode": "test", "epoch": 28}
{"loss": 0.6911832094192505, "acc": 0.5575950145721436, "length": 1.0001140832901, "mode": "train", "epoch": 29}
{"loss": 0.7006552219390869, "acc": 0.5333333015441895, "length": 1.0, "mode": "test", "epoch": 29}
{"loss": 0.6899176836013794, "acc": 0.5602988600730896, "length": 1.0001001358032227, "mode": "train", "epoch": 30}
{"loss": 0.7007136940956116, "acc": 0.5229166150093079, "length": 1.0, "mode": "test", "epoch": 30}
{"loss": 0.689853847026825, "acc": 0.5565590262413025, "length": 1.0001178979873657, "mode": "train", "epoch": 31}
{"loss": 0.7004117965698242, "acc": 0.5243055820465088, "length": 1.0, "mode": "test", "epoch": 31}
{"loss": 0.6913087964057922, "acc": 0.5552935004234314, "length": 1.0000829696655273, "mode": "train", "epoch": 32}
{"loss": 0.7007151246070862, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 32}
{"loss": 0.6895530819892883, "acc": 0.5605291128158569, "length": 1.0000684261322021, "mode": "train", "epoch": 33}
{"loss": 0.700430691242218, "acc": 0.5239583849906921, "length": 1.0, "mode": "test", "epoch": 33}
{"loss": 0.6905173659324646, "acc": 0.5591484308242798, "length": 1.0000642538070679, "mode": "train", "epoch": 34}
{"loss": 0.7001701593399048, "acc": 0.5428819060325623, "length": 1.0, "mode": "test", "epoch": 34}
{"loss": 0.6901950240135193, "acc": 0.5601266026496887, "length": 1.0000609159469604, "mode": "train", "epoch": 35}
{"loss": 0.7011911273002625, "acc": 0.5277777910232544, "length": 1.0, "mode": "test", "epoch": 35}
{"loss": 0.6901485919952393, "acc": 0.5554085373878479, "length": 1.0000497102737427, "mode": "train", "epoch": 36}
{"loss": 0.699438214302063, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 36}
{"loss": 0.6902866959571838, "acc": 0.5583429336547852, "length": 1.000040054321289, "mode": "train", "epoch": 37}
{"loss": 0.6999824643135071, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 37}
{"loss": 0.6883320212364197, "acc": 0.5584003925323486, "length": 1.0000396966934204, "mode": "train", "epoch": 38}
{"loss": 0.7007442116737366, "acc": 0.528124988079071, "length": 1.0, "mode": "test", "epoch": 38}
{"loss": 0.6899569034576416, "acc": 0.55345219373703, "length": 1.0000332593917847, "mode": "train", "epoch": 39}
{"loss": 0.7006180882453918, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 39}
{"loss": 0.6891728639602661, "acc": 0.5569620728492737, "length": 1.000028133392334, "mode": "train", "epoch": 40}
{"loss": 0.7001119256019592, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 40}
{"loss": 0.6905577778816223, "acc": 0.5569045543670654, "length": 1.0000253915786743, "mode": "train", "epoch": 41}
{"loss": 0.6992630958557129, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 41}
{"loss": 0.6900007724761963, "acc": 0.5543153285980225, "length": 1.0000336170196533, "mode": "train", "epoch": 42}
{"loss": 0.6987822651863098, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 42}
{"loss": 0.6899946928024292, "acc": 0.5579977035522461, "length": 1.0000226497650146, "mode": "train", "epoch": 43}
{"loss": 0.6995039582252502, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 43}
{"loss": 0.6881484389305115, "acc": 0.5634636878967285, "length": 1.000016450881958, "mode": "train", "epoch": 44}
{"loss": 0.6987969279289246, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 44}
{"loss": 0.6889477968215942, "acc": 0.5653049349784851, "length": 1.0000144243240356, "mode": "train", "epoch": 45}
{"loss": 0.6992442011833191, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 45}
{"loss": 0.6910815834999084, "acc": 0.5539700984954834, "length": 1.0000131130218506, "mode": "train", "epoch": 46}
{"loss": 0.7006175518035889, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 46}
{"loss": 0.6896051168441772, "acc": 0.5584580302238464, "length": 1.0000122785568237, "mode": "train", "epoch": 47}
{"loss": 0.6990590691566467, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 47}
{"loss": 0.6886512637138367, "acc": 0.5577675104141235, "length": 1.0000108480453491, "mode": "train", "epoch": 48}
{"loss": 0.6990424394607544, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 48}
{"loss": 0.6884052157402039, "acc": 0.5612773895263672, "length": 1.0000085830688477, "mode": "train", "epoch": 49}
{"loss": 0.7018100023269653, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 49}
{"loss": 0.6896474361419678, "acc": 0.5555811524391174, "length": 1.0000085830688477, "mode": "train", "epoch": 50}
{"loss": 0.6983718872070312, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 50}
{"loss": 0.6918209791183472, "acc": 0.5527617931365967, "length": 1.0000077486038208, "mode": "train", "epoch": 51}
{"loss": 0.6992787718772888, "acc": 0.5291666984558105, "length": 1.0, "mode": "test", "epoch": 51}
{"loss": 0.689796507358551, "acc": 0.5501725673675537, "length": 1.0000063180923462, "mode": "train", "epoch": 52}
{"loss": 0.6985504627227783, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 52}
{"loss": 0.6902485489845276, "acc": 0.5571345686912537, "length": 1.0000050067901611, "mode": "train", "epoch": 53}
{"loss": 0.6974487900733948, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 53}
{"loss": 0.6887180209159851, "acc": 0.5583428740501404, "length": 1.000004529953003, "mode": "train", "epoch": 54}
{"loss": 0.6999984383583069, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 54}
{"loss": 0.6879991888999939, "acc": 0.5578250885009766, "length": 1.0000040531158447, "mode": "train", "epoch": 55}
{"loss": 0.6998257040977478, "acc": 0.535937488079071, "length": 1.0, "mode": "test", "epoch": 55}
{"loss": 0.6877927184104919, "acc": 0.5615649819374084, "length": 1.0000044107437134, "mode": "train", "epoch": 56}
{"loss": 0.6987569332122803, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 56}
{"loss": 0.6911514401435852, "acc": 0.5581703186035156, "length": 1.0000044107437134, "mode": "train", "epoch": 57}
{"loss": 0.6987811326980591, "acc": 0.5296875238418579, "length": 1.0, "mode": "test", "epoch": 57}
{"loss": 0.6864815354347229, "acc": 0.5663406252861023, "length": 1.0000050067901611, "mode": "train", "epoch": 58}
{"loss": 0.6985222697257996, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 58}
{"loss": 0.6883643865585327, "acc": 0.5607019662857056, "length": 1.0000052452087402, "mode": "train", "epoch": 59}
{"loss": 0.6991204619407654, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 59}
{"loss": 0.6860736012458801, "acc": 0.5615650415420532, "length": 1.0000020265579224, "mode": "train", "epoch": 60}
{"loss": 0.6985598206520081, "acc": 0.5335069894790649, "length": 1.0, "mode": "test", "epoch": 60}
test accuracy: 0.2583928406238556
