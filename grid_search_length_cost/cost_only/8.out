# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.696162760257721, "acc": 0.5164581537246704, "length": 2.9638946056365967, "mode": "train", "epoch": 1}
{"loss": 0.6961673498153687, "acc": 0.48749998211860657, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6512377858161926, "acc": 0.6233329176902771, "length": 2.3864119052886963, "mode": "train", "epoch": 2}
{"loss": 0.5807051658630371, "acc": 0.7364867925643921, "length": 2.47265625, "mode": "test", "epoch": 2}
{"loss": 0.5239755511283875, "acc": 0.7659292817115784, "length": 2.9182488918304443, "mode": "train", "epoch": 3}
{"loss": 0.4951724410057068, "acc": 0.7739806771278381, "length": 3.44921875, "mode": "test", "epoch": 3}
{"loss": 0.4381345808506012, "acc": 0.815858006477356, "length": 3.2430543899536133, "mode": "train", "epoch": 4}
{"loss": 0.4758169651031494, "acc": 0.8091369867324829, "length": 3.2890625, "mode": "test", "epoch": 4}
{"loss": 0.3717346489429474, "acc": 0.8507072329521179, "length": 3.447566032409668, "mode": "train", "epoch": 5}
{"loss": 0.3940911591053009, "acc": 0.8266540765762329, "length": 3.58203125, "mode": "test", "epoch": 5}
{"loss": 0.3223988711833954, "acc": 0.8688069581985474, "length": 3.512138605117798, "mode": "train", "epoch": 6}
{"loss": 0.3761667013168335, "acc": 0.8427306413650513, "length": 3.48046875, "mode": "test", "epoch": 6}
{"loss": 0.29816189408302307, "acc": 0.8788557648658752, "length": 3.5234360694885254, "mode": "train", "epoch": 7}
{"loss": 0.4073399305343628, "acc": 0.8404236435890198, "length": 3.7578125, "mode": "test", "epoch": 7}
{"loss": 0.2976451516151428, "acc": 0.8811044692993164, "length": 3.5400609970092773, "mode": "train", "epoch": 8}
{"loss": 0.3730701804161072, "acc": 0.8472352027893066, "length": 3.47265625, "mode": "test", "epoch": 8}
{"loss": 0.2720087468624115, "acc": 0.8878881931304932, "length": 3.5134754180908203, "mode": "train", "epoch": 9}
{"loss": 0.3625459372997284, "acc": 0.8399291634559631, "length": 3.49609375, "mode": "test", "epoch": 9}
{"loss": 0.2641660273075104, "acc": 0.8896152377128601, "length": 3.529806613922119, "mode": "train", "epoch": 10}
{"loss": 0.32825642824172974, "acc": 0.859393298625946, "length": 3.55078125, "mode": "test", "epoch": 10}
{"loss": 0.26927223801612854, "acc": 0.8957852125167847, "length": 3.539600133895874, "mode": "train", "epoch": 11}
{"loss": 0.3522284924983978, "acc": 0.840289294719696, "length": 3.609375, "mode": "test", "epoch": 11}
{"loss": 0.2613048553466797, "acc": 0.8934498429298401, "length": 3.542193651199341, "mode": "train", "epoch": 12}
{"loss": 0.3368231952190399, "acc": 0.8623230457305908, "length": 3.5390625, "mode": "test", "epoch": 12}
{"loss": 0.2522744834423065, "acc": 0.8961072564125061, "length": 3.588042736053467, "mode": "train", "epoch": 13}
{"loss": 0.33525633811950684, "acc": 0.8804321885108948, "length": 3.625, "mode": "test", "epoch": 13}
{"loss": 0.24120406806468964, "acc": 0.8994638323783875, "length": 3.567631721496582, "mode": "train", "epoch": 14}
{"loss": 0.3191906213760376, "acc": 0.8807556629180908, "length": 3.59375, "mode": "test", "epoch": 14}
{"loss": 0.2347128987312317, "acc": 0.9030196666717529, "length": 3.5767405033111572, "mode": "train", "epoch": 15}
{"loss": 0.32884523272514343, "acc": 0.8712769150733948, "length": 3.62109375, "mode": "test", "epoch": 15}
{"loss": 0.22598500549793243, "acc": 0.9068223834037781, "length": 3.592177391052246, "mode": "train", "epoch": 16}
{"loss": 0.333405077457428, "acc": 0.8711913824081421, "length": 3.64453125, "mode": "test", "epoch": 16}
{"loss": 0.2293214052915573, "acc": 0.9048610925674438, "length": 3.6309516429901123, "mode": "train", "epoch": 17}
{"loss": 0.3282899558544159, "acc": 0.8749511241912842, "length": 3.62890625, "mode": "test", "epoch": 17}
{"loss": 0.22574178874492645, "acc": 0.9082142114639282, "length": 3.612717628479004, "mode": "train", "epoch": 18}
{"loss": 0.3118153214454651, "acc": 0.8765442371368408, "length": 3.62109375, "mode": "test", "epoch": 18}
{"loss": 0.21916820108890533, "acc": 0.9111714959144592, "length": 3.620783567428589, "mode": "train", "epoch": 19}
{"loss": 0.305458128452301, "acc": 0.8842469453811646, "length": 3.63671875, "mode": "test", "epoch": 19}
{"loss": 0.21303270757198334, "acc": 0.9134134650230408, "length": 3.614983320236206, "mode": "train", "epoch": 20}
{"loss": 0.3002365529537201, "acc": 0.8903015851974487, "length": 3.63671875, "mode": "test", "epoch": 20}
{"loss": 0.21101152896881104, "acc": 0.9153661131858826, "length": 3.6558728218078613, "mode": "train", "epoch": 21}
{"loss": 0.31390833854675293, "acc": 0.8780152201652527, "length": 3.61328125, "mode": "test", "epoch": 21}
{"loss": 0.20435544848442078, "acc": 0.9147846698760986, "length": 3.622950792312622, "mode": "train", "epoch": 22}
{"loss": 0.3100746273994446, "acc": 0.8868225812911987, "length": 3.6640625, "mode": "test", "epoch": 22}
{"loss": 0.20124271512031555, "acc": 0.9188472628593445, "length": 3.6426784992218018, "mode": "train", "epoch": 23}
{"loss": 0.28229933977127075, "acc": 0.8982237577438354, "length": 3.6875, "mode": "test", "epoch": 23}
{"loss": 0.19571685791015625, "acc": 0.9187669157981873, "length": 3.664340019226074, "mode": "train", "epoch": 24}
{"loss": 0.2990679144859314, "acc": 0.8937744498252869, "length": 3.6640625, "mode": "test", "epoch": 24}
{"loss": 0.21140021085739136, "acc": 0.9132071137428284, "length": 3.619528293609619, "mode": "train", "epoch": 25}
{"loss": 0.29721784591674805, "acc": 0.8962159156799316, "length": 3.64453125, "mode": "test", "epoch": 25}
{"loss": 0.19187715649604797, "acc": 0.9208671450614929, "length": 3.6063499450683594, "mode": "train", "epoch": 26}
{"loss": 0.2990787923336029, "acc": 0.8949340581893921, "length": 3.640625, "mode": "test", "epoch": 26}
{"loss": 0.1833994835615158, "acc": 0.9233996868133545, "length": 3.6547091007232666, "mode": "train", "epoch": 27}
{"loss": 0.29186877608299255, "acc": 0.896069347858429, "length": 3.68359375, "mode": "test", "epoch": 27}
{"loss": 0.18384988605976105, "acc": 0.9226793646812439, "length": 3.674090623855591, "mode": "train", "epoch": 28}
{"loss": 0.2873392701148987, "acc": 0.8955138921737671, "length": 3.66796875, "mode": "test", "epoch": 28}
{"loss": 0.17968758940696716, "acc": 0.9264287948608398, "length": 3.642893075942993, "mode": "train", "epoch": 29}
{"loss": 0.27693304419517517, "acc": 0.9055542349815369, "length": 3.66796875, "mode": "test", "epoch": 29}
{"loss": 0.17020085453987122, "acc": 0.926958441734314, "length": 3.6605801582336426, "mode": "train", "epoch": 30}
{"loss": 0.291492760181427, "acc": 0.9021850824356079, "length": 3.6875, "mode": "test", "epoch": 30}
{"loss": 0.17680750787258148, "acc": 0.926669180393219, "length": 3.6790380477905273, "mode": "train", "epoch": 31}
{"loss": 0.28209245204925537, "acc": 0.9018859267234802, "length": 3.67578125, "mode": "test", "epoch": 31}
{"loss": 0.17417468130588531, "acc": 0.9301326870918274, "length": 3.679513454437256, "mode": "train", "epoch": 32}
{"loss": 0.2795138955116272, "acc": 0.908093273639679, "length": 3.6640625, "mode": "test", "epoch": 32}
{"loss": 0.17167145013809204, "acc": 0.9326779842376709, "length": 3.6823370456695557, "mode": "train", "epoch": 33}
{"loss": 0.274274080991745, "acc": 0.9118529558181763, "length": 3.671875, "mode": "test", "epoch": 33}
{"loss": 0.17414385080337524, "acc": 0.9324483871459961, "length": 3.673694372177124, "mode": "train", "epoch": 34}
{"loss": 0.27006015181541443, "acc": 0.9094971418380737, "length": 3.6796875, "mode": "test", "epoch": 34}
{"loss": 0.16715116798877716, "acc": 0.9297270178794861, "length": 3.6738693714141846, "mode": "train", "epoch": 35}
{"loss": 0.2677348256111145, "acc": 0.9093201160430908, "length": 3.67578125, "mode": "test", "epoch": 35}
{"loss": 0.1617196649312973, "acc": 0.937610924243927, "length": 3.703676223754883, "mode": "train", "epoch": 36}
{"loss": 0.28703445196151733, "acc": 0.905865490436554, "length": 3.70703125, "mode": "test", "epoch": 36}
{"loss": 0.1556142419576645, "acc": 0.9328365325927734, "length": 3.7253823280334473, "mode": "train", "epoch": 37}
{"loss": 0.2969690263271332, "acc": 0.9053953886032104, "length": 3.69140625, "mode": "test", "epoch": 37}
{"loss": 0.14541178941726685, "acc": 0.9391227960586548, "length": 3.6937100887298584, "mode": "train", "epoch": 38}
{"loss": 0.26512208580970764, "acc": 0.917803943157196, "length": 3.69921875, "mode": "test", "epoch": 38}
{"loss": 0.14583800733089447, "acc": 0.9426349997520447, "length": 3.7235045433044434, "mode": "train", "epoch": 39}
{"loss": 0.2531352639198303, "acc": 0.920654296875, "length": 3.69921875, "mode": "test", "epoch": 39}
{"loss": 0.14290286600589752, "acc": 0.944656491279602, "length": 3.7340476512908936, "mode": "train", "epoch": 40}
{"loss": 0.2664561867713928, "acc": 0.9078918099403381, "length": 3.69921875, "mode": "test", "epoch": 40}
{"loss": 0.13824403285980225, "acc": 0.9432603120803833, "length": 3.7638840675354004, "mode": "train", "epoch": 41}
{"loss": 0.279191255569458, "acc": 0.9137024283409119, "length": 3.78125, "mode": "test", "epoch": 41}
{"loss": 0.1348215639591217, "acc": 0.949307382106781, "length": 3.7734034061431885, "mode": "train", "epoch": 42}
{"loss": 0.22485804557800293, "acc": 0.920422375202179, "length": 3.75390625, "mode": "test", "epoch": 42}
{"loss": 0.13160648941993713, "acc": 0.9460152387619019, "length": 3.782811164855957, "mode": "train", "epoch": 43}
{"loss": 0.2388448566198349, "acc": 0.918182373046875, "length": 3.77734375, "mode": "test", "epoch": 43}
{"loss": 0.13649733364582062, "acc": 0.9487241506576538, "length": 3.8068222999572754, "mode": "train", "epoch": 44}
{"loss": 0.21749186515808105, "acc": 0.9240722060203552, "length": 3.78125, "mode": "test", "epoch": 44}
{"loss": 0.1266668140888214, "acc": 0.950923502445221, "length": 3.815891742706299, "mode": "train", "epoch": 45}
{"loss": 0.24356958270072937, "acc": 0.9323607683181763, "length": 3.76171875, "mode": "test", "epoch": 45}
{"loss": 0.12840832769870758, "acc": 0.9521076083183289, "length": 3.8222572803497314, "mode": "train", "epoch": 46}
{"loss": 0.2328311800956726, "acc": 0.9283324480056763, "length": 3.83984375, "mode": "test", "epoch": 46}
{"loss": 0.12418597936630249, "acc": 0.9486743807792664, "length": 3.817462921142578, "mode": "train", "epoch": 47}
{"loss": 0.22591912746429443, "acc": 0.930438220500946, "length": 3.82421875, "mode": "test", "epoch": 47}
{"loss": 0.12493877112865448, "acc": 0.9516521692276001, "length": 3.8343210220336914, "mode": "train", "epoch": 48}
{"loss": 0.22501301765441895, "acc": 0.9324157238006592, "length": 3.8359375, "mode": "test", "epoch": 48}
{"loss": 0.11894655227661133, "acc": 0.9508145451545715, "length": 3.8191311359405518, "mode": "train", "epoch": 49}
{"loss": 0.2409745454788208, "acc": 0.935333251953125, "length": 3.81640625, "mode": "test", "epoch": 49}
{"loss": 0.11193615198135376, "acc": 0.9547184705734253, "length": 3.843613862991333, "mode": "train", "epoch": 50}
{"loss": 0.2354533076286316, "acc": 0.9288392066955566, "length": 3.8671875, "mode": "test", "epoch": 50}
{"loss": 0.11191011220216751, "acc": 0.9541950225830078, "length": 3.8777713775634766, "mode": "train", "epoch": 51}
{"loss": 0.23612728714942932, "acc": 0.9245117902755737, "length": 3.87890625, "mode": "test", "epoch": 51}
{"loss": 0.1131054013967514, "acc": 0.9537379741668701, "length": 3.8692736625671387, "mode": "train", "epoch": 52}
{"loss": 0.20395806431770325, "acc": 0.9344787001609802, "length": 3.828125, "mode": "test", "epoch": 52}
{"loss": 0.11906927824020386, "acc": 0.9541190266609192, "length": 3.8821141719818115, "mode": "train", "epoch": 53}
{"loss": 0.2306182086467743, "acc": 0.9294494390487671, "length": 3.90234375, "mode": "test", "epoch": 53}
{"loss": 0.10880298167467117, "acc": 0.956518292427063, "length": 3.889577627182007, "mode": "train", "epoch": 54}
{"loss": 0.23067845404148102, "acc": 0.9349121451377869, "length": 3.91796875, "mode": "test", "epoch": 54}
{"loss": 0.11331837624311447, "acc": 0.9580795168876648, "length": 3.875636100769043, "mode": "train", "epoch": 55}
{"loss": 0.21466012299060822, "acc": 0.940692126750946, "length": 3.84375, "mode": "test", "epoch": 55}
{"loss": 0.11042292416095734, "acc": 0.9574281573295593, "length": 3.864666700363159, "mode": "train", "epoch": 56}
{"loss": 0.23996277153491974, "acc": 0.9248778820037842, "length": 3.84375, "mode": "test", "epoch": 56}
{"loss": 0.105243980884552, "acc": 0.9594399929046631, "length": 3.872565507888794, "mode": "train", "epoch": 57}
{"loss": 0.2308460772037506, "acc": 0.9377319812774658, "length": 3.8515625, "mode": "test", "epoch": 57}
{"loss": 0.10177047550678253, "acc": 0.9623680114746094, "length": 3.8482325077056885, "mode": "train", "epoch": 58}
{"loss": 0.22464758157730103, "acc": 0.941088855266571, "length": 3.83984375, "mode": "test", "epoch": 58}
{"loss": 0.09134689718484879, "acc": 0.9643552303314209, "length": 3.8497002124786377, "mode": "train", "epoch": 59}
{"loss": 0.1913466602563858, "acc": 0.9334472417831421, "length": 3.890625, "mode": "test", "epoch": 59}
{"loss": 0.091991126537323, "acc": 0.9660331606864929, "length": 3.866215705871582, "mode": "train", "epoch": 60}
{"loss": 0.19526605308055878, "acc": 0.9453613758087158, "length": 3.8359375, "mode": "test", "epoch": 60}
test accuracy: 0.843994140625
