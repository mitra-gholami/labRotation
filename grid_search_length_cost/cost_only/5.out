# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 13
message length 3
{"loss": 0.6986459493637085, "acc": 0.5113748908042908, "length": 2.5229105949401855, "mode": "train", "epoch": 1}
{"loss": 0.6940386891365051, "acc": 0.5022569894790649, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6547204852104187, "acc": 0.608526885509491, "length": 2.217198133468628, "mode": "train", "epoch": 2}
{"loss": 0.5851197838783264, "acc": 0.6947591304779053, "length": 2.5833332538604736, "mode": "test", "epoch": 2}
{"loss": 0.5651909708976746, "acc": 0.7180416584014893, "length": 2.734907865524292, "mode": "train", "epoch": 3}
{"loss": 0.5460836887359619, "acc": 0.7471625804901123, "length": 2.9270832538604736, "mode": "test", "epoch": 3}
{"loss": 0.5017917156219482, "acc": 0.7749915719032288, "length": 3.115976095199585, "mode": "train", "epoch": 4}
{"loss": 0.4648282825946808, "acc": 0.8072807788848877, "length": 3.1354167461395264, "mode": "test", "epoch": 4}
{"loss": 0.46180540323257446, "acc": 0.7923522591590881, "length": 3.1980769634246826, "mode": "train", "epoch": 5}
{"loss": 0.4589500427246094, "acc": 0.8087294101715088, "length": 3.1041667461395264, "mode": "test", "epoch": 5}
{"loss": 0.4434753656387329, "acc": 0.7971287369728088, "length": 3.2398681640625, "mode": "train", "epoch": 6}
{"loss": 0.44965675473213196, "acc": 0.8088704347610474, "length": 3.1145832538604736, "mode": "test", "epoch": 6}
{"loss": 0.42473718523979187, "acc": 0.7976619005203247, "length": 3.2661490440368652, "mode": "train", "epoch": 7}
{"loss": 0.4126564562320709, "acc": 0.8100315928459167, "length": 3.1666667461395264, "mode": "test", "epoch": 7}
{"loss": 0.395465224981308, "acc": 0.8085268139839172, "length": 3.395810842514038, "mode": "train", "epoch": 8}
{"loss": 0.39704450964927673, "acc": 0.8236707448959351, "length": 3.1875, "mode": "test", "epoch": 8}
{"loss": 0.36568906903266907, "acc": 0.8257136940956116, "length": 3.4234588146209717, "mode": "train", "epoch": 9}
{"loss": 0.3626081049442291, "acc": 0.8403157591819763, "length": 3.3125, "mode": "test", "epoch": 9}
{"loss": 0.33079323172569275, "acc": 0.8500635623931885, "length": 3.487731695175171, "mode": "train", "epoch": 10}
{"loss": 0.3402283191680908, "acc": 0.8580403327941895, "length": 3.65625, "mode": "test", "epoch": 10}
{"loss": 0.3025836646556854, "acc": 0.8746362924575806, "length": 3.7180564403533936, "mode": "train", "epoch": 11}
{"loss": 0.3396128714084625, "acc": 0.8633626699447632, "length": 3.6875, "mode": "test", "epoch": 11}
{"loss": 0.2867371439933777, "acc": 0.8791430592536926, "length": 3.7146265506744385, "mode": "train", "epoch": 12}
{"loss": 0.30609217286109924, "acc": 0.8876518607139587, "length": 3.6979167461395264, "mode": "test", "epoch": 12}
{"loss": 0.26585468649864197, "acc": 0.896913468837738, "length": 3.833968162536621, "mode": "train", "epoch": 13}
{"loss": 0.304430216550827, "acc": 0.8934788107872009, "length": 3.9791667461395264, "mode": "test", "epoch": 13}
{"loss": 0.255244642496109, "acc": 0.9000946283340454, "length": 3.903801441192627, "mode": "train", "epoch": 14}
{"loss": 0.292814165353775, "acc": 0.8927083611488342, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.2474527508020401, "acc": 0.9045342803001404, "length": 3.928633451461792, "mode": "train", "epoch": 15}
{"loss": 0.2986285090446472, "acc": 0.902256965637207, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.23808850347995758, "acc": 0.9119279384613037, "length": 3.952159881591797, "mode": "train", "epoch": 16}
{"loss": 0.278420627117157, "acc": 0.9031249284744263, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.21814802289009094, "acc": 0.9200050830841064, "length": 3.957223415374756, "mode": "train", "epoch": 17}
{"loss": 0.27029576897621155, "acc": 0.9069443941116333, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.20556162297725677, "acc": 0.9279820919036865, "length": 3.9822800159454346, "mode": "train", "epoch": 18}
{"loss": 0.24564340710639954, "acc": 0.9236111044883728, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.19032041728496552, "acc": 0.9311580061912537, "length": 3.9835379123687744, "mode": "train", "epoch": 19}
{"loss": 0.22296935319900513, "acc": 0.9293403625488281, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.17812079191207886, "acc": 0.9393842816352844, "length": 3.9866738319396973, "mode": "train", "epoch": 20}
{"loss": 0.2275855541229248, "acc": 0.9324653148651123, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.16727419197559357, "acc": 0.9397973418235779, "length": 3.9904685020446777, "mode": "train", "epoch": 21}
{"loss": 0.20689257979393005, "acc": 0.9138888120651245, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.14574681222438812, "acc": 0.9472217559814453, "length": 3.992645025253296, "mode": "train", "epoch": 22}
{"loss": 0.20042473077774048, "acc": 0.9312499165534973, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.13432733714580536, "acc": 0.953873872756958, "length": 3.9938952922821045, "mode": "train", "epoch": 23}
{"loss": 0.19398429989814758, "acc": 0.9307292103767395, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.12652164697647095, "acc": 0.95240718126297, "length": 3.994036912918091, "mode": "train", "epoch": 24}
{"loss": 0.19328883290290833, "acc": 0.9303818941116333, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.12225361913442612, "acc": 0.955449104309082, "length": 3.9944205284118652, "mode": "train", "epoch": 25}
{"loss": 0.16028794646263123, "acc": 0.9453125, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.11131597310304642, "acc": 0.9587792158126831, "length": 3.994969129562378, "mode": "train", "epoch": 26}
{"loss": 0.16265156865119934, "acc": 0.9427083134651184, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.0944313183426857, "acc": 0.9663355350494385, "length": 3.996816396713257, "mode": "train", "epoch": 27}
{"loss": 0.13763275742530823, "acc": 0.9508680701255798, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.0918634831905365, "acc": 0.9683595895767212, "length": 3.996976375579834, "mode": "train", "epoch": 28}
{"loss": 0.12532708048820496, "acc": 0.964756965637207, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.080195352435112, "acc": 0.9732391834259033, "length": 3.997239828109741, "mode": "train", "epoch": 29}
{"loss": 0.13829688727855682, "acc": 0.9520832896232605, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.07497668266296387, "acc": 0.9754746556282043, "length": 3.997495651245117, "mode": "train", "epoch": 30}
{"loss": 0.12340646237134933, "acc": 0.9664930701255798, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.07893317192792892, "acc": 0.9728341102600098, "length": 3.997191905975342, "mode": "train", "epoch": 31}
{"loss": 0.1244431734085083, "acc": 0.9602431058883667, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.06757543981075287, "acc": 0.9773984551429749, "length": 3.9979138374328613, "mode": "train", "epoch": 32}
{"loss": 0.12270431965589523, "acc": 0.9628472924232483, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.07106105238199234, "acc": 0.9769437909126282, "length": 3.9980199337005615, "mode": "train", "epoch": 33}
{"loss": 0.0940612405538559, "acc": 0.9699652194976807, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.06745867431163788, "acc": 0.9784600138664246, "length": 3.9978559017181396, "mode": "train", "epoch": 34}
{"loss": 0.10647783428430557, "acc": 0.9619792103767395, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.06371573358774185, "acc": 0.9776304960250854, "length": 3.998126268386841, "mode": "train", "epoch": 35}
{"loss": 0.08838216960430145, "acc": 0.9770833253860474, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.055125121027231216, "acc": 0.9815711975097656, "length": 3.9988832473754883, "mode": "train", "epoch": 36}
{"loss": 0.104693204164505, "acc": 0.9685763120651245, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.04890840873122215, "acc": 0.9847679138183594, "length": 3.9989423751831055, "mode": "train", "epoch": 37}
{"loss": 0.07656451314687729, "acc": 0.9765625, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.04460127651691437, "acc": 0.9859893321990967, "length": 3.9987237453460693, "mode": "train", "epoch": 38}
{"loss": 0.09037133306264877, "acc": 0.9704861044883728, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.05034423619508743, "acc": 0.984131932258606, "length": 3.9983246326446533, "mode": "train", "epoch": 39}
{"loss": 0.09606800228357315, "acc": 0.9703124165534973, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.045842770487070084, "acc": 0.9868377447128296, "length": 3.999039649963379, "mode": "train", "epoch": 40}
{"loss": 0.11327021569013596, "acc": 0.9666666388511658, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.042149219661951065, "acc": 0.9877311587333679, "length": 3.999001979827881, "mode": "train", "epoch": 41}
{"loss": 0.06915897130966187, "acc": 0.980555534362793, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.039025645703077316, "acc": 0.9890381693840027, "length": 3.999288320541382, "mode": "train", "epoch": 42}
{"loss": 0.0951312854886055, "acc": 0.9730902910232544, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.05641641467809677, "acc": 0.9827555418014526, "length": 3.999180555343628, "mode": "train", "epoch": 43}
{"loss": 0.09226581454277039, "acc": 0.9711804986000061, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.041787125170230865, "acc": 0.9870310425758362, "length": 3.9995827674865723, "mode": "train", "epoch": 44}
{"loss": 0.10395098477602005, "acc": 0.9680556058883667, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04014328122138977, "acc": 0.9871940612792969, "length": 3.9994935989379883, "mode": "train", "epoch": 45}
{"loss": 0.0946168377995491, "acc": 0.9722222089767456, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.03682439774274826, "acc": 0.9890509247779846, "length": 3.9995923042297363, "mode": "train", "epoch": 46}
{"loss": 0.07832127809524536, "acc": 0.9737846851348877, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.03207889571785927, "acc": 0.9917408227920532, "length": 3.999541997909546, "mode": "train", "epoch": 47}
{"loss": 0.07624568045139313, "acc": 0.9727431535720825, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.03673694655299187, "acc": 0.9881503582000732, "length": 3.9994688034057617, "mode": "train", "epoch": 48}
{"loss": 0.09707235544919968, "acc": 0.972569465637207, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.044504933059215546, "acc": 0.9865337014198303, "length": 3.999586343765259, "mode": "train", "epoch": 49}
{"loss": 0.1341995745897293, "acc": 0.9581596851348877, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04250844568014145, "acc": 0.9876739978790283, "length": 3.9992361068725586, "mode": "train", "epoch": 50}
{"loss": 0.09343630075454712, "acc": 0.9739583134651184, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.031181741505861282, "acc": 0.9918005466461182, "length": 3.9996581077575684, "mode": "train", "epoch": 51}
{"loss": 0.10134503990411758, "acc": 0.9718749523162842, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.031006397679448128, "acc": 0.9912409782409668, "length": 3.9996585845947266, "mode": "train", "epoch": 52}
{"loss": 0.07275503128767014, "acc": 0.9765625, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03136230632662773, "acc": 0.9886677265167236, "length": 3.999755382537842, "mode": "train", "epoch": 53}
{"loss": 0.06045075133442879, "acc": 0.9857638478279114, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.02512837015092373, "acc": 0.9914687871932983, "length": 3.9997193813323975, "mode": "train", "epoch": 54}
{"loss": 0.080610491335392, "acc": 0.9809027910232544, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.030118100345134735, "acc": 0.9904617071151733, "length": 3.9998133182525635, "mode": "train", "epoch": 55}
{"loss": 0.09812131524085999, "acc": 0.9782986044883728, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.02859319932758808, "acc": 0.990068793296814, "length": 3.9998044967651367, "mode": "train", "epoch": 56}
{"loss": 0.08270600438117981, "acc": 0.9727431535720825, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.031062323600053787, "acc": 0.9934940934181213, "length": 3.9999146461486816, "mode": "train", "epoch": 57}
{"loss": 0.0693344920873642, "acc": 0.9765623807907104, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.034552328288555145, "acc": 0.990915060043335, "length": 3.9998879432678223, "mode": "train", "epoch": 58}
{"loss": 0.09726633131504059, "acc": 0.9793403148651123, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.026459239423274994, "acc": 0.9936029314994812, "length": 3.999842882156372, "mode": "train", "epoch": 59}
{"loss": 0.06363162398338318, "acc": 0.9828125834465027, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.020548278465867043, "acc": 0.995567262172699, "length": 3.999875783920288, "mode": "train", "epoch": 60}
{"loss": 0.06920547038316727, "acc": 0.9781249165534973, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7619999647140503
