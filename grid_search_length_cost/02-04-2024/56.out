ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 5
{"loss": 0.3577519357204437, "acc": 0.8430137038230896, "length": 5.7748799324035645, "mode": "train", "epoch": 1}
{"loss": 0.29103153944015503, "acc": 0.8908830881118774, "length": 6.0, "mode": "test", "epoch": 1}
{"loss": 0.19533759355545044, "acc": 0.9396073818206787, "length": 5.999974727630615, "mode": "train", "epoch": 2}
{"loss": 0.22487641870975494, "acc": 0.924835741519928, "length": 6.0, "mode": "test", "epoch": 2}
{"loss": 0.1622362583875656, "acc": 0.9539173245429993, "length": 5.999997615814209, "mode": "train", "epoch": 3}
{"loss": 0.17711684107780457, "acc": 0.9478710293769836, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.14642275869846344, "acc": 0.9598095417022705, "length": 6.0, "mode": "train", "epoch": 4}
{"loss": 0.17987197637557983, "acc": 0.944736897945404, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.13569262623786926, "acc": 0.9633575081825256, "length": 6.0, "mode": "train", "epoch": 5}
{"loss": 0.17133794724941254, "acc": 0.9468894600868225, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.12430150806903839, "acc": 0.9664804935455322, "length": 6.0, "mode": "train", "epoch": 6}
{"loss": 0.14974573254585266, "acc": 0.9565097689628601, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.10801283270120621, "acc": 0.9722571969032288, "length": 6.0, "mode": "train", "epoch": 7}
{"loss": 0.16937510669231415, "acc": 0.9481614828109741, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.09837771207094193, "acc": 0.975527286529541, "length": 6.0, "mode": "train", "epoch": 8}
{"loss": 0.13546942174434662, "acc": 0.9602140784263611, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.09086896479129791, "acc": 0.9777608513832092, "length": 6.0, "mode": "train", "epoch": 9}
{"loss": 0.12430230528116226, "acc": 0.9640803933143616, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.08406557142734528, "acc": 0.9794924855232239, "length": 6.0, "mode": "train", "epoch": 10}
{"loss": 0.12346803396940231, "acc": 0.9652659893035889, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.07746473699808121, "acc": 0.9815690517425537, "length": 6.0, "mode": "train", "epoch": 11}
{"loss": 0.12453113496303558, "acc": 0.963557243347168, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.07275933027267456, "acc": 0.9831604957580566, "length": 6.0, "mode": "train", "epoch": 12}
{"loss": 0.14484721422195435, "acc": 0.9545268416404724, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.06964629888534546, "acc": 0.9842960238456726, "length": 6.0, "mode": "train", "epoch": 13}
{"loss": 0.11616776883602142, "acc": 0.9638767242431641, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.06595031172037125, "acc": 0.9854758381843567, "length": 6.0, "mode": "train", "epoch": 14}
{"loss": 0.10400456190109253, "acc": 0.9697874784469604, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.06561066210269928, "acc": 0.9855011105537415, "length": 6.0, "mode": "train", "epoch": 15}
{"loss": 0.09407112002372742, "acc": 0.9738127589225769, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.06278242915868759, "acc": 0.9864104390144348, "length": 6.0, "mode": "train", "epoch": 16}
{"loss": 0.0939486175775528, "acc": 0.9734699130058289, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.06195136904716492, "acc": 0.9863648414611816, "length": 6.0, "mode": "train", "epoch": 17}
{"loss": 0.0884690135717392, "acc": 0.9766184091567993, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.056754015386104584, "acc": 0.9875975251197815, "length": 6.0, "mode": "train", "epoch": 18}
{"loss": 0.09522369503974915, "acc": 0.9723259806632996, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.052165597677230835, "acc": 0.988445520401001, "length": 6.0, "mode": "train", "epoch": 19}
{"loss": 0.07860679179430008, "acc": 0.9795340299606323, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.04576859623193741, "acc": 0.9905648827552795, "length": 6.0, "mode": "train", "epoch": 20}
{"loss": 0.06471063196659088, "acc": 0.9846852421760559, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.042243842035532, "acc": 0.991756796836853, "length": 6.0, "mode": "train", "epoch": 21}
{"loss": 0.06010152027010918, "acc": 0.986976683139801, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.04389951005578041, "acc": 0.9912115335464478, "length": 6.0, "mode": "train", "epoch": 22}
{"loss": 0.07733438163995743, "acc": 0.9815387725830078, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.041716355830430984, "acc": 0.9918709993362427, "length": 6.0, "mode": "train", "epoch": 23}
{"loss": 0.06011591851711273, "acc": 0.9850408434867859, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.04055378586053848, "acc": 0.9921829104423523, "length": 6.0, "mode": "train", "epoch": 24}
{"loss": 0.056498441845178604, "acc": 0.9855189323425293, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.03978341072797775, "acc": 0.9924599528312683, "length": 6.0, "mode": "train", "epoch": 25}
{"loss": 0.06004079431295395, "acc": 0.984835147857666, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.03872855380177498, "acc": 0.9925692677497864, "length": 6.0, "mode": "train", "epoch": 26}
{"loss": 0.05226273089647293, "acc": 0.9883697032928467, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.035972438752651215, "acc": 0.9930189251899719, "length": 6.0, "mode": "train", "epoch": 27}
{"loss": 0.05707933008670807, "acc": 0.9861396551132202, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.035715289413928986, "acc": 0.9931277632713318, "length": 6.0, "mode": "train", "epoch": 28}
{"loss": 0.04741644486784935, "acc": 0.9887648820877075, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.035867415368556976, "acc": 0.9930399656295776, "length": 6.0, "mode": "train", "epoch": 29}
{"loss": 0.046863995492458344, "acc": 0.9882631301879883, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.034731678664684296, "acc": 0.9934654831886292, "length": 6.0, "mode": "train", "epoch": 30}
{"loss": 0.04319160431623459, "acc": 0.9911194443702698, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.034505877643823624, "acc": 0.9935886859893799, "length": 6.0, "mode": "train", "epoch": 31}
{"loss": 0.05767782777547836, "acc": 0.9858940839767456, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.032733574509620667, "acc": 0.9938910603523254, "length": 6.0, "mode": "train", "epoch": 32}
{"loss": 0.04971468076109886, "acc": 0.9887738823890686, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.030830811709165573, "acc": 0.9943652153015137, "length": 6.0, "mode": "train", "epoch": 33}
{"loss": 0.041163504123687744, "acc": 0.9917274117469788, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.030983900651335716, "acc": 0.994171679019928, "length": 6.0, "mode": "train", "epoch": 34}
{"loss": 0.03903525695204735, "acc": 0.9924436211585999, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.029688941314816475, "acc": 0.9945805072784424, "length": 6.0, "mode": "train", "epoch": 35}
{"loss": 0.03705309331417084, "acc": 0.9929868578910828, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.03028939478099346, "acc": 0.9943070411682129, "length": 6.0, "mode": "train", "epoch": 36}
{"loss": 0.03886555880308151, "acc": 0.9911843538284302, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.02816249243915081, "acc": 0.9948604702949524, "length": 6.0, "mode": "train", "epoch": 37}
{"loss": 0.04286741465330124, "acc": 0.9901684522628784, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.028613442555069923, "acc": 0.994648277759552, "length": 6.0, "mode": "train", "epoch": 38}
{"loss": 0.04172908514738083, "acc": 0.989109456539154, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.028641782701015472, "acc": 0.9945870637893677, "length": 6.0, "mode": "train", "epoch": 39}
{"loss": 0.04004437103867531, "acc": 0.9915865659713745, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.027964765205979347, "acc": 0.9945635795593262, "length": 6.0, "mode": "train", "epoch": 40}
{"loss": 0.034186240285634995, "acc": 0.9937679767608643, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.02496281825006008, "acc": 0.9955167770385742, "length": 6.0, "mode": "train", "epoch": 41}
{"loss": 0.03425849601626396, "acc": 0.9933440089225769, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.02650504559278488, "acc": 0.9950960874557495, "length": 6.0, "mode": "train", "epoch": 42}
{"loss": 0.041775379329919815, "acc": 0.9916354417800903, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.02669300138950348, "acc": 0.9949632883071899, "length": 6.0, "mode": "train", "epoch": 43}
{"loss": 0.033448755741119385, "acc": 0.9929724335670471, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.025243600830435753, "acc": 0.9954477548599243, "length": 6.0, "mode": "train", "epoch": 44}
{"loss": 0.03496035560965538, "acc": 0.9920088052749634, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.0256588626652956, "acc": 0.9951772093772888, "length": 6.0, "mode": "train", "epoch": 45}
{"loss": 0.034551966935396194, "acc": 0.9920414090156555, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.029026826843619347, "acc": 0.9942233562469482, "length": 6.0, "mode": "train", "epoch": 46}
{"loss": 0.042278967797756195, "acc": 0.9904318451881409, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.023769548162817955, "acc": 0.9956352114677429, "length": 6.0, "mode": "train", "epoch": 47}
{"loss": 0.02913830243051052, "acc": 0.9943543672561646, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.023603729903697968, "acc": 0.9956785440444946, "length": 6.0, "mode": "train", "epoch": 48}
{"loss": 0.03804028034210205, "acc": 0.9921514391899109, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.027599196881055832, "acc": 0.9945395588874817, "length": 6.0, "mode": "train", "epoch": 49}
{"loss": 0.03898245468735695, "acc": 0.992142379283905, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.025616029277443886, "acc": 0.9950774908065796, "length": 6.0, "mode": "train", "epoch": 50}
{"loss": 0.03282998129725456, "acc": 0.9936128854751587, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.025582823902368546, "acc": 0.995139479637146, "length": 6.0, "mode": "train", "epoch": 51}
{"loss": 0.0310557521879673, "acc": 0.9936580657958984, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.02215191349387169, "acc": 0.9960535764694214, "length": 6.0, "mode": "train", "epoch": 52}
{"loss": 0.026218201965093613, "acc": 0.9952402710914612, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.023868238553404808, "acc": 0.9954555630683899, "length": 6.0, "mode": "train", "epoch": 53}
{"loss": 0.032743219286203384, "acc": 0.993006706237793, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.025389011949300766, "acc": 0.9951825737953186, "length": 6.0, "mode": "train", "epoch": 54}
{"loss": 0.03658671677112579, "acc": 0.9931798577308655, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.023452293127775192, "acc": 0.9956544637680054, "length": 6.0, "mode": "train", "epoch": 55}
{"loss": 0.04484634846448898, "acc": 0.9897191524505615, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.03781011700630188, "acc": 0.9912608861923218, "length": 6.0, "mode": "train", "epoch": 56}
{"loss": 0.04016896337270737, "acc": 0.9908919334411621, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.028553228825330734, "acc": 0.9941098093986511, "length": 6.0, "mode": "train", "epoch": 57}
{"loss": 0.0304876659065485, "acc": 0.9932194352149963, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.02831016294658184, "acc": 0.994245707988739, "length": 6.0, "mode": "train", "epoch": 58}
{"loss": 0.029418248683214188, "acc": 0.9942388534545898, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.02576960064470768, "acc": 0.994799792766571, "length": 6.0, "mode": "train", "epoch": 59}
{"loss": 0.03430220112204552, "acc": 0.9930354952812195, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.023017872124910355, "acc": 0.9956725239753723, "length": 6.0, "mode": "train", "epoch": 60}
{"loss": 0.03060268610715866, "acc": 0.9941433668136597, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.9854658842086792
