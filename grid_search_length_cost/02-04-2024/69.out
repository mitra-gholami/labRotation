ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.33770033717155457, "acc": 0.8569203019142151, "length": 7.4346232414245605, "mode": "train", "epoch": 1}
{"loss": 0.3134891390800476, "acc": 0.8741945624351501, "length": 6.834929943084717, "mode": "test", "epoch": 1}
{"loss": 0.2101883441209793, "acc": 0.9337732791900635, "length": 7.5535664558410645, "mode": "train", "epoch": 2}
{"loss": 0.2515735924243927, "acc": 0.9106360077857971, "length": 7.683588981628418, "mode": "test", "epoch": 2}
{"loss": 0.16591182351112366, "acc": 0.9533984661102295, "length": 6.572023868560791, "mode": "train", "epoch": 3}
{"loss": 0.17935244739055634, "acc": 0.9476994276046753, "length": 6.313617706298828, "mode": "test", "epoch": 3}
{"loss": 0.15193453431129456, "acc": 0.9590754508972168, "length": 6.1011834144592285, "mode": "train", "epoch": 4}
{"loss": 0.1643163114786148, "acc": 0.9533552527427673, "length": 5.646990776062012, "mode": "test", "epoch": 4}
{"loss": 0.13179829716682434, "acc": 0.962829053401947, "length": 6.051722526550293, "mode": "train", "epoch": 5}
{"loss": 0.14290229976177216, "acc": 0.9575521349906921, "length": 6.3613505363464355, "mode": "test", "epoch": 5}
{"loss": 0.09590432792901993, "acc": 0.9759058952331543, "length": 6.278212070465088, "mode": "train", "epoch": 6}
{"loss": 0.1757114827632904, "acc": 0.9473289847373962, "length": 9.463082313537598, "mode": "test", "epoch": 6}
{"loss": 0.07316044718027115, "acc": 0.9842619299888611, "length": 6.727865695953369, "mode": "train", "epoch": 7}
{"loss": 0.1381157785654068, "acc": 0.9616126418113708, "length": 7.960927486419678, "mode": "test", "epoch": 7}
{"loss": 0.06470471620559692, "acc": 0.9873234033584595, "length": 6.495666027069092, "mode": "train", "epoch": 8}
{"loss": 0.09673027694225311, "acc": 0.9753450155258179, "length": 6.767879962921143, "mode": "test", "epoch": 8}
{"loss": 0.06083057075738907, "acc": 0.9884915351867676, "length": 6.303415775299072, "mode": "train", "epoch": 9}
{"loss": 0.07926740497350693, "acc": 0.9822341203689575, "length": 6.432072162628174, "mode": "test", "epoch": 9}
{"loss": 0.0588710755109787, "acc": 0.9888546466827393, "length": 6.2032599449157715, "mode": "train", "epoch": 10}
{"loss": 0.09572184085845947, "acc": 0.9750394821166992, "length": 5.8577985763549805, "mode": "test", "epoch": 10}
{"loss": 0.05435287207365036, "acc": 0.9891553521156311, "length": 6.095863342285156, "mode": "train", "epoch": 11}
{"loss": 0.08466999977827072, "acc": 0.9783305525779724, "length": 5.779573917388916, "mode": "test", "epoch": 11}
{"loss": 0.04516355320811272, "acc": 0.9911872744560242, "length": 6.022508144378662, "mode": "train", "epoch": 12}
{"loss": 0.06271740049123764, "acc": 0.986594557762146, "length": 5.951348781585693, "mode": "test", "epoch": 12}
{"loss": 0.04010548070073128, "acc": 0.9927575588226318, "length": 5.9872941970825195, "mode": "train", "epoch": 13}
{"loss": 0.07020118832588196, "acc": 0.984403669834137, "length": 5.772469520568848, "mode": "test", "epoch": 13}
{"loss": 0.037649936974048615, "acc": 0.9933781027793884, "length": 5.953185558319092, "mode": "train", "epoch": 14}
{"loss": 0.06600167602300644, "acc": 0.9839509725570679, "length": 5.76213264465332, "mode": "test", "epoch": 14}
{"loss": 0.03647095710039139, "acc": 0.9935147166252136, "length": 5.902652263641357, "mode": "train", "epoch": 15}
{"loss": 0.05737806111574173, "acc": 0.9883853793144226, "length": 5.687459945678711, "mode": "test", "epoch": 15}
{"loss": 0.030523814260959625, "acc": 0.9940102696418762, "length": 5.840620040893555, "mode": "train", "epoch": 16}
{"loss": 0.06656664609909058, "acc": 0.9852960705757141, "length": 5.78420352935791, "mode": "test", "epoch": 16}
{"loss": 0.022110341116786003, "acc": 0.9961528182029724, "length": 5.883183479309082, "mode": "train", "epoch": 17}
{"loss": 0.06060340255498886, "acc": 0.9864417910575867, "length": 5.911039352416992, "mode": "test", "epoch": 17}
{"loss": 0.018554087728261948, "acc": 0.9972408413887024, "length": 5.892146587371826, "mode": "train", "epoch": 18}
{"loss": 0.060873012989759445, "acc": 0.9874821305274963, "length": 5.693845748901367, "mode": "test", "epoch": 18}
{"loss": 0.016928434371948242, "acc": 0.9975741505622864, "length": 5.836328506469727, "mode": "train", "epoch": 19}
{"loss": 0.05607663840055466, "acc": 0.989206075668335, "length": 5.7646074295043945, "mode": "test", "epoch": 19}
{"loss": 0.01615152880549431, "acc": 0.9978715777397156, "length": 5.85239315032959, "mode": "train", "epoch": 20}
{"loss": 0.059761226177215576, "acc": 0.9891929626464844, "length": 5.677083492279053, "mode": "test", "epoch": 20}
{"loss": 0.015097026713192463, "acc": 0.997982919216156, "length": 5.806342124938965, "mode": "train", "epoch": 21}
{"loss": 0.05947988107800484, "acc": 0.9898676872253418, "length": 5.69252872467041, "mode": "test", "epoch": 21}
{"loss": 0.01788194291293621, "acc": 0.9970075488090515, "length": 5.78135347366333, "mode": "train", "epoch": 22}
{"loss": 0.05912433937191963, "acc": 0.98732590675354, "length": 5.67536735534668, "mode": "test", "epoch": 22}
{"loss": 0.01411471888422966, "acc": 0.9982703328132629, "length": 5.75315523147583, "mode": "train", "epoch": 23}
{"loss": 0.047855254262685776, "acc": 0.9921795725822449, "length": 5.678081035614014, "mode": "test", "epoch": 23}
{"loss": 0.014116675592958927, "acc": 0.9981814026832581, "length": 5.731532096862793, "mode": "train", "epoch": 24}
{"loss": 0.05521209537982941, "acc": 0.9904242753982544, "length": 5.7041425704956055, "mode": "test", "epoch": 24}
{"loss": 0.013658558949828148, "acc": 0.998382031917572, "length": 5.759404182434082, "mode": "train", "epoch": 25}
{"loss": 0.055439822375774384, "acc": 0.9900469779968262, "length": 5.690493106842041, "mode": "test", "epoch": 25}
{"loss": 0.013590703718364239, "acc": 0.9983679056167603, "length": 5.748157024383545, "mode": "train", "epoch": 26}
{"loss": 0.058136530220508575, "acc": 0.9874574542045593, "length": 5.68853759765625, "mode": "test", "epoch": 26}
{"loss": 0.014998246915638447, "acc": 0.9980148673057556, "length": 5.749998569488525, "mode": "train", "epoch": 27}
{"loss": 0.05448324978351593, "acc": 0.9884299635887146, "length": 5.6712164878845215, "mode": "test", "epoch": 27}
{"loss": 0.01385851763188839, "acc": 0.9982472658157349, "length": 5.7275190353393555, "mode": "train", "epoch": 28}
{"loss": 0.05897337943315506, "acc": 0.9898902773857117, "length": 5.708453178405762, "mode": "test", "epoch": 28}
{"loss": 0.014405651018023491, "acc": 0.9981562495231628, "length": 5.717665672302246, "mode": "train", "epoch": 29}
{"loss": 0.054523516446352005, "acc": 0.9905702471733093, "length": 5.694564342498779, "mode": "test", "epoch": 29}
{"loss": 0.012644234113395214, "acc": 0.9985549449920654, "length": 5.6996307373046875, "mode": "train", "epoch": 30}
{"loss": 0.051724039018154144, "acc": 0.9904571771621704, "length": 5.697757244110107, "mode": "test", "epoch": 30}
{"loss": 0.013757170177996159, "acc": 0.9982324242591858, "length": 5.711012840270996, "mode": "train", "epoch": 31}
{"loss": 0.06315509229898453, "acc": 0.988227903842926, "length": 5.741219520568848, "mode": "test", "epoch": 31}
{"loss": 0.015456893481314182, "acc": 0.9979304671287537, "length": 5.691653728485107, "mode": "train", "epoch": 32}
{"loss": 0.05448221415281296, "acc": 0.9901394248008728, "length": 5.713282108306885, "mode": "test", "epoch": 32}
{"loss": 0.015499726869165897, "acc": 0.9977863430976868, "length": 5.689996719360352, "mode": "train", "epoch": 33}
{"loss": 0.053607720881700516, "acc": 0.9902480840682983, "length": 5.688098430633545, "mode": "test", "epoch": 33}
{"loss": 0.011680732481181622, "acc": 0.9987555742263794, "length": 5.681766986846924, "mode": "train", "epoch": 34}
{"loss": 0.05307210609316826, "acc": 0.990212082862854, "length": 5.688417911529541, "mode": "test", "epoch": 34}
{"loss": 0.01615060493350029, "acc": 0.9976245760917664, "length": 5.715202808380127, "mode": "train", "epoch": 35}
{"loss": 0.048728592693805695, "acc": 0.9907211065292358, "length": 5.679837226867676, "mode": "test", "epoch": 35}
{"loss": 0.012685658410191536, "acc": 0.9984625577926636, "length": 5.6984710693359375, "mode": "train", "epoch": 36}
{"loss": 0.05588153377175331, "acc": 0.9889717102050781, "length": 5.702027320861816, "mode": "test", "epoch": 36}
{"loss": 0.0127287358045578, "acc": 0.9985406994819641, "length": 5.673058986663818, "mode": "train", "epoch": 37}
{"loss": 0.0679144561290741, "acc": 0.9862288236618042, "length": 5.696838855743408, "mode": "test", "epoch": 37}
{"loss": 0.01279822550714016, "acc": 0.9984668493270874, "length": 5.675811767578125, "mode": "train", "epoch": 38}
{"loss": 0.04873380810022354, "acc": 0.9918098449707031, "length": 5.693087577819824, "mode": "test", "epoch": 38}
{"loss": 0.011611652560532093, "acc": 0.9987726211547852, "length": 5.683018684387207, "mode": "train", "epoch": 39}
{"loss": 0.052851833403110504, "acc": 0.9887843132019043, "length": 5.7048211097717285, "mode": "test", "epoch": 39}
{"loss": 0.013190731406211853, "acc": 0.9983915090560913, "length": 5.691195964813232, "mode": "train", "epoch": 40}
{"loss": 0.054726723581552505, "acc": 0.9916440844535828, "length": 5.681393623352051, "mode": "test", "epoch": 40}
{"loss": 0.01232096366584301, "acc": 0.9985862374305725, "length": 5.695411682128906, "mode": "train", "epoch": 41}
{"loss": 0.050621241331100464, "acc": 0.9887717366218567, "length": 5.954102993011475, "mode": "test", "epoch": 41}
{"loss": 0.011071773245930672, "acc": 0.9988950490951538, "length": 5.699456214904785, "mode": "train", "epoch": 42}
{"loss": 0.07812738418579102, "acc": 0.980568528175354, "length": 5.711286544799805, "mode": "test", "epoch": 42}
{"loss": 0.013051205314695835, "acc": 0.9983969330787659, "length": 5.70467472076416, "mode": "train", "epoch": 43}
{"loss": 0.05427953600883484, "acc": 0.9884777069091797, "length": 5.716195583343506, "mode": "test", "epoch": 43}
{"loss": 0.011852261610329151, "acc": 0.9987553954124451, "length": 5.695805072784424, "mode": "train", "epoch": 44}
{"loss": 0.05915650352835655, "acc": 0.9867414832115173, "length": 5.69157075881958, "mode": "test", "epoch": 44}
{"loss": 0.011920704506337643, "acc": 0.9987220168113708, "length": 5.693885803222656, "mode": "train", "epoch": 45}
{"loss": 0.055174097418785095, "acc": 0.9910494089126587, "length": 5.693007469177246, "mode": "test", "epoch": 45}
{"loss": 0.01191029790788889, "acc": 0.9986240267753601, "length": 5.671016693115234, "mode": "train", "epoch": 46}
{"loss": 0.061788998544216156, "acc": 0.9855908751487732, "length": 5.685863494873047, "mode": "test", "epoch": 46}
{"loss": 0.014527837745845318, "acc": 0.9980465173721313, "length": 5.71666955947876, "mode": "train", "epoch": 47}
{"loss": 0.05666603147983551, "acc": 0.9885460734367371, "length": 5.693845748901367, "mode": "test", "epoch": 47}
{"loss": 0.013903808780014515, "acc": 0.998226523399353, "length": 5.6923651695251465, "mode": "train", "epoch": 48}
{"loss": 0.04597560688853264, "acc": 0.9922143816947937, "length": 5.717512607574463, "mode": "test", "epoch": 48}
{"loss": 0.014664893969893456, "acc": 0.9979888796806335, "length": 5.709984302520752, "mode": "train", "epoch": 49}
{"loss": 0.055958930402994156, "acc": 0.9884911179542542, "length": 5.738585472106934, "mode": "test", "epoch": 49}
{"loss": 0.016435040161013603, "acc": 0.997521162033081, "length": 5.7053704261779785, "mode": "train", "epoch": 50}
{"loss": 0.058664657175540924, "acc": 0.9880543351173401, "length": 5.800047874450684, "mode": "test", "epoch": 50}
{"loss": 0.013693294487893581, "acc": 0.9981735944747925, "length": 5.7256999015808105, "mode": "train", "epoch": 51}
{"loss": 0.04559297487139702, "acc": 0.9918827414512634, "length": 5.724576950073242, "mode": "test", "epoch": 51}
{"loss": 0.012954414822161198, "acc": 0.9983928799629211, "length": 5.71016788482666, "mode": "train", "epoch": 52}
{"loss": 0.06721382588148117, "acc": 0.9853803515434265, "length": 5.744731903076172, "mode": "test", "epoch": 52}
{"loss": 0.013691933825612068, "acc": 0.9981827735900879, "length": 5.758427619934082, "mode": "train", "epoch": 53}
{"loss": 0.04778830707073212, "acc": 0.9896819591522217, "length": 5.7332377433776855, "mode": "test", "epoch": 53}
{"loss": 0.012046465650200844, "acc": 0.9986181259155273, "length": 5.709135055541992, "mode": "train", "epoch": 54}
{"loss": 0.05035148561000824, "acc": 0.9910582304000854, "length": 5.931074619293213, "mode": "test", "epoch": 54}
{"loss": 0.012754308059811592, "acc": 0.9984776377677917, "length": 5.778904914855957, "mode": "train", "epoch": 55}
{"loss": 0.04036673903465271, "acc": 0.9930229187011719, "length": 5.850135803222656, "mode": "test", "epoch": 55}
{"loss": 0.019044408574700356, "acc": 0.9969173669815063, "length": 5.777866363525391, "mode": "train", "epoch": 56}
{"loss": 0.043665412813425064, "acc": 0.9925513863563538, "length": 5.846982955932617, "mode": "test", "epoch": 56}
{"loss": 0.01440365705639124, "acc": 0.9980989098548889, "length": 5.8102030754089355, "mode": "train", "epoch": 57}
{"loss": 0.03808100149035454, "acc": 0.99360591173172, "length": 5.859155654907227, "mode": "test", "epoch": 57}
{"loss": 0.01300627551972866, "acc": 0.9983795881271362, "length": 5.790466785430908, "mode": "train", "epoch": 58}
{"loss": 0.04271285980939865, "acc": 0.9930579662322998, "length": 5.849936008453369, "mode": "test", "epoch": 58}
{"loss": 0.012892558239400387, "acc": 0.9984334111213684, "length": 5.7837934494018555, "mode": "train", "epoch": 59}
{"loss": 0.03271723911166191, "acc": 0.9951006770133972, "length": 5.883181571960449, "mode": "test", "epoch": 59}
{"loss": 0.014902278780937195, "acc": 0.9980077743530273, "length": 5.899998188018799, "mode": "train", "epoch": 60}
{"loss": 0.04484757408499718, "acc": 0.991671621799469, "length": 5.947198390960693, "mode": "test", "epoch": 60}
test accuracy: 0.9916554093360901
