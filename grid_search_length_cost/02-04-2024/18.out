ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.7101261019706726, "acc": 0.5228650569915771, "length": 3.526793956756592, "mode": "train", "epoch": 1}
{"loss": 0.6997610926628113, "acc": 0.5111111402511597, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6495501399040222, "acc": 0.6235464215278625, "length": 1.6358338594436646, "mode": "train", "epoch": 2}
{"loss": 0.6308148503303528, "acc": 0.6391602158546448, "length": 1.2256944179534912, "mode": "test", "epoch": 2}
{"loss": 0.5922931432723999, "acc": 0.6857393383979797, "length": 1.6400460004806519, "mode": "train", "epoch": 3}
{"loss": 0.6511423587799072, "acc": 0.6351860761642456, "length": 1.2395833730697632, "mode": "test", "epoch": 3}
{"loss": 0.5754947066307068, "acc": 0.7119337320327759, "length": 1.724969744682312, "mode": "train", "epoch": 4}
{"loss": 0.6762427091598511, "acc": 0.6581434011459351, "length": 1.4097222089767456, "mode": "test", "epoch": 4}
{"loss": 0.5520935654640198, "acc": 0.7349529266357422, "length": 1.795607089996338, "mode": "train", "epoch": 5}
{"loss": 0.6117489337921143, "acc": 0.6937011480331421, "length": 1.5555555820465088, "mode": "test", "epoch": 5}
{"loss": 0.516402542591095, "acc": 0.7638830542564392, "length": 1.757411003112793, "mode": "train", "epoch": 6}
{"loss": 0.5817551612854004, "acc": 0.7109483480453491, "length": 1.5659722089767456, "mode": "test", "epoch": 6}
{"loss": 0.498012512922287, "acc": 0.7730943560600281, "length": 1.8690682649612427, "mode": "train", "epoch": 7}
{"loss": 0.5806326270103455, "acc": 0.709865927696228, "length": 1.6527777910232544, "mode": "test", "epoch": 7}
{"loss": 0.4776971638202667, "acc": 0.7878302335739136, "length": 2.0491373538970947, "mode": "train", "epoch": 8}
{"loss": 0.4868447482585907, "acc": 0.7967502474784851, "length": 1.9652777910232544, "mode": "test", "epoch": 8}
{"loss": 0.4542269706726074, "acc": 0.8031644225120544, "length": 2.2785346508026123, "mode": "train", "epoch": 9}
{"loss": 0.47164180874824524, "acc": 0.795871376991272, "length": 2.414930582046509, "mode": "test", "epoch": 9}
{"loss": 0.43261009454727173, "acc": 0.8185240626335144, "length": 2.4819884300231934, "mode": "train", "epoch": 10}
{"loss": 0.43189382553100586, "acc": 0.8144938349723816, "length": 2.336805582046509, "mode": "test", "epoch": 10}
{"loss": 0.41332000494003296, "acc": 0.8237860202789307, "length": 2.5555009841918945, "mode": "train", "epoch": 11}
{"loss": 0.4225926995277405, "acc": 0.8234808444976807, "length": 2.381944417953491, "mode": "test", "epoch": 11}
{"loss": 0.4000208377838135, "acc": 0.8300991654396057, "length": 2.609032154083252, "mode": "train", "epoch": 12}
{"loss": 0.4112347364425659, "acc": 0.8324706554412842, "length": 2.4270832538604736, "mode": "test", "epoch": 12}
{"loss": 0.38096141815185547, "acc": 0.8381043076515198, "length": 2.605167865753174, "mode": "train", "epoch": 13}
{"loss": 0.4073169529438019, "acc": 0.8308864831924438, "length": 2.5798611640930176, "mode": "test", "epoch": 13}
{"loss": 0.3549647927284241, "acc": 0.8545179963111877, "length": 2.6663966178894043, "mode": "train", "epoch": 14}
{"loss": 0.390387624502182, "acc": 0.8385308384895325, "length": 2.519097328186035, "mode": "test", "epoch": 14}
{"loss": 0.3343358039855957, "acc": 0.8642014861106873, "length": 2.700050115585327, "mode": "train", "epoch": 15}
{"loss": 0.39639008045196533, "acc": 0.8411703109741211, "length": 2.690972328186035, "mode": "test", "epoch": 15}
{"loss": 0.3202509582042694, "acc": 0.8742086291313171, "length": 2.74507737159729, "mode": "train", "epoch": 16}
{"loss": 0.3824728727340698, "acc": 0.8520697951316833, "length": 2.6267361640930176, "mode": "test", "epoch": 16}
{"loss": 0.30933547019958496, "acc": 0.8807743787765503, "length": 2.822105646133423, "mode": "train", "epoch": 17}
{"loss": 0.3657744824886322, "acc": 0.8548963069915771, "length": 2.7204861640930176, "mode": "test", "epoch": 17}
{"loss": 0.2968505024909973, "acc": 0.8868650197982788, "length": 2.8948707580566406, "mode": "train", "epoch": 18}
{"loss": 0.36971861124038696, "acc": 0.8619657158851624, "length": 2.821180582046509, "mode": "test", "epoch": 18}
{"loss": 0.2891031801700592, "acc": 0.8944093585014343, "length": 2.963643789291382, "mode": "train", "epoch": 19}
{"loss": 0.3585311770439148, "acc": 0.8645480275154114, "length": 2.725694417953491, "mode": "test", "epoch": 19}
{"loss": 0.28022831678390503, "acc": 0.896165132522583, "length": 2.998525857925415, "mode": "train", "epoch": 20}
{"loss": 0.33067944645881653, "acc": 0.8804334998130798, "length": 3.0416667461395264, "mode": "test", "epoch": 20}
{"loss": 0.26595214009284973, "acc": 0.9055320024490356, "length": 3.1474785804748535, "mode": "train", "epoch": 21}
{"loss": 0.31896311044692993, "acc": 0.8829183578491211, "length": 3.0364582538604736, "mode": "test", "epoch": 21}
{"loss": 0.25190815329551697, "acc": 0.9141740202903748, "length": 3.2509541511535645, "mode": "train", "epoch": 22}
{"loss": 0.30720266699790955, "acc": 0.8853244781494141, "length": 3.2864582538604736, "mode": "test", "epoch": 22}
{"loss": 0.24327397346496582, "acc": 0.9169899225234985, "length": 3.382403612136841, "mode": "train", "epoch": 23}
{"loss": 0.2990981340408325, "acc": 0.8939046859741211, "length": 3.4427082538604736, "mode": "test", "epoch": 23}
{"loss": 0.22700098156929016, "acc": 0.9237095713615417, "length": 3.516233444213867, "mode": "train", "epoch": 24}
{"loss": 0.2854919135570526, "acc": 0.8968886137008667, "length": 3.5295138359069824, "mode": "test", "epoch": 24}
{"loss": 0.21188387274742126, "acc": 0.9315534830093384, "length": 3.5685102939605713, "mode": "train", "epoch": 25}
{"loss": 0.2678309977054596, "acc": 0.9002576470375061, "length": 3.571180582046509, "mode": "test", "epoch": 25}
{"loss": 0.20378172397613525, "acc": 0.9351158738136292, "length": 3.6336305141448975, "mode": "train", "epoch": 26}
{"loss": 0.25988855957984924, "acc": 0.9074490666389465, "length": 3.4427082538604736, "mode": "test", "epoch": 26}
{"loss": 0.19247545301914215, "acc": 0.9398345351219177, "length": 3.654984474182129, "mode": "train", "epoch": 27}
{"loss": 0.2664989233016968, "acc": 0.9083766937255859, "length": 3.522569417953491, "mode": "test", "epoch": 27}
{"loss": 0.18517224490642548, "acc": 0.9406803846359253, "length": 3.6963086128234863, "mode": "train", "epoch": 28}
{"loss": 0.24025999009609222, "acc": 0.9120252132415771, "length": 3.5486111640930176, "mode": "test", "epoch": 28}
{"loss": 0.18060043454170227, "acc": 0.9428812861442566, "length": 3.7413339614868164, "mode": "train", "epoch": 29}
{"loss": 0.23847781121730804, "acc": 0.9151394367218018, "length": 3.78125, "mode": "test", "epoch": 29}
{"loss": 0.16965143382549286, "acc": 0.947330892086029, "length": 3.7907745838165283, "mode": "train", "epoch": 30}
{"loss": 0.21920998394489288, "acc": 0.9261637926101685, "length": 3.746527671813965, "mode": "test", "epoch": 30}
{"loss": 0.15706118941307068, "acc": 0.9518517255783081, "length": 3.9205660820007324, "mode": "train", "epoch": 31}
{"loss": 0.2052670121192932, "acc": 0.9324842095375061, "length": 3.710069417953491, "mode": "test", "epoch": 31}
{"loss": 0.14579655230045319, "acc": 0.9553031921386719, "length": 3.962808609008789, "mode": "train", "epoch": 32}
{"loss": 0.19550739228725433, "acc": 0.9340549111366272, "length": 3.84375, "mode": "test", "epoch": 32}
{"loss": 0.1392962783575058, "acc": 0.960577130317688, "length": 4.014857769012451, "mode": "train", "epoch": 33}
{"loss": 0.1937231421470642, "acc": 0.9339843392372131, "length": 3.902777671813965, "mode": "test", "epoch": 33}
{"loss": 0.12706802785396576, "acc": 0.9640814661979675, "length": 4.067419052124023, "mode": "train", "epoch": 34}
{"loss": 0.1898316890001297, "acc": 0.9381320476531982, "length": 3.902777671813965, "mode": "test", "epoch": 34}
{"loss": 0.12128014117479324, "acc": 0.9662730693817139, "length": 4.08998441696167, "mode": "train", "epoch": 35}
{"loss": 0.17095080018043518, "acc": 0.9435520172119141, "length": 3.946180582046509, "mode": "test", "epoch": 35}
{"loss": 0.11911311000585556, "acc": 0.9661074876785278, "length": 4.169463157653809, "mode": "train", "epoch": 36}
{"loss": 0.15592652559280396, "acc": 0.9602186679840088, "length": 4.03125, "mode": "test", "epoch": 36}
{"loss": 0.11292503774166107, "acc": 0.9698246717453003, "length": 4.278471946716309, "mode": "train", "epoch": 37}
{"loss": 0.16544947028160095, "acc": 0.9507812857627869, "length": 4.121527671813965, "mode": "test", "epoch": 37}
{"loss": 0.10637283325195312, "acc": 0.9716606140136719, "length": 4.271402835845947, "mode": "train", "epoch": 38}
{"loss": 0.16292813420295715, "acc": 0.9467095136642456, "length": 4.036458492279053, "mode": "test", "epoch": 38}
{"loss": 0.09952591359615326, "acc": 0.9747172594070435, "length": 4.247097492218018, "mode": "train", "epoch": 39}
{"loss": 0.1300075501203537, "acc": 0.9613010883331299, "length": 4.057291507720947, "mode": "test", "epoch": 39}
{"loss": 0.09193636476993561, "acc": 0.9775807857513428, "length": 4.232326984405518, "mode": "train", "epoch": 40}
{"loss": 0.12661172449588776, "acc": 0.9681938886642456, "length": 4.171875, "mode": "test", "epoch": 40}
{"loss": 0.08558988571166992, "acc": 0.980920135974884, "length": 4.216606140136719, "mode": "train", "epoch": 41}
{"loss": 0.13013289868831635, "acc": 0.9618381857872009, "length": 4.026041507720947, "mode": "test", "epoch": 41}
{"loss": 0.08448965847492218, "acc": 0.9806116819381714, "length": 4.191550254821777, "mode": "train", "epoch": 42}
{"loss": 0.1588151454925537, "acc": 0.954961359500885, "length": 4.128472328186035, "mode": "test", "epoch": 42}
{"loss": 0.08176001161336899, "acc": 0.9823665618896484, "length": 4.250722408294678, "mode": "train", "epoch": 43}
{"loss": 0.13236749172210693, "acc": 0.9679986238479614, "length": 4.114583492279053, "mode": "test", "epoch": 43}
{"loss": 0.07580482959747314, "acc": 0.9845013618469238, "length": 4.174251079559326, "mode": "train", "epoch": 44}
{"loss": 0.10693639516830444, "acc": 0.9749701619148254, "length": 4.119791507720947, "mode": "test", "epoch": 44}
{"loss": 0.0752013698220253, "acc": 0.9852837920188904, "length": 4.165409088134766, "mode": "train", "epoch": 45}
{"loss": 0.10174832493066788, "acc": 0.9751303195953369, "length": 4.057291507720947, "mode": "test", "epoch": 45}
{"loss": 0.07276099175214767, "acc": 0.9851365685462952, "length": 4.1840386390686035, "mode": "train", "epoch": 46}
{"loss": 0.08872049301862717, "acc": 0.9818006157875061, "length": 4.079861164093018, "mode": "test", "epoch": 46}
{"loss": 0.066604383289814, "acc": 0.9871687889099121, "length": 4.248067378997803, "mode": "train", "epoch": 47}
{"loss": 0.0961458757519722, "acc": 0.9793184995651245, "length": 4.088541507720947, "mode": "test", "epoch": 47}
{"loss": 0.06265763938426971, "acc": 0.9890390038490295, "length": 4.166033744812012, "mode": "train", "epoch": 48}
{"loss": 0.10719278454780579, "acc": 0.9758843183517456, "length": 4.083333492279053, "mode": "test", "epoch": 48}
{"loss": 0.05855291336774826, "acc": 0.9902488589286804, "length": 4.128663539886475, "mode": "train", "epoch": 49}
{"loss": 0.09405116736888885, "acc": 0.9785997867584229, "length": 4.13194465637207, "mode": "test", "epoch": 49}
{"loss": 0.05811771750450134, "acc": 0.990265965461731, "length": 4.143350601196289, "mode": "train", "epoch": 50}
{"loss": 0.10206840932369232, "acc": 0.9764946699142456, "length": 4.048611164093018, "mode": "test", "epoch": 50}
{"loss": 0.05679590627551079, "acc": 0.9907886385917664, "length": 4.179464817047119, "mode": "train", "epoch": 51}
{"loss": 0.0867730975151062, "acc": 0.9820800423622131, "length": 4.050347328186035, "mode": "test", "epoch": 51}
{"loss": 0.05505368486046791, "acc": 0.9909759759902954, "length": 4.14449405670166, "mode": "train", "epoch": 52}
{"loss": 0.08210865408182144, "acc": 0.9831652045249939, "length": 4.059027671813965, "mode": "test", "epoch": 52}
{"loss": 0.051349200308322906, "acc": 0.9924623966217041, "length": 4.096067905426025, "mode": "train", "epoch": 53}
{"loss": 0.09739955514669418, "acc": 0.9780653715133667, "length": 4.06944465637207, "mode": "test", "epoch": 53}
{"loss": 0.05788164585828781, "acc": 0.9896422624588013, "length": 4.107368469238281, "mode": "train", "epoch": 54}
{"loss": 0.0841192826628685, "acc": 0.9823893308639526, "length": 4.032986164093018, "mode": "test", "epoch": 54}
{"loss": 0.0508091077208519, "acc": 0.9918769001960754, "length": 4.094186782836914, "mode": "train", "epoch": 55}
{"loss": 0.07447110116481781, "acc": 0.9869601130485535, "length": 4.010416507720947, "mode": "test", "epoch": 55}
{"loss": 0.049572739750146866, "acc": 0.9928523898124695, "length": 4.078633785247803, "mode": "train", "epoch": 56}
{"loss": 0.06618523597717285, "acc": 0.9885036945343018, "length": 4.032986164093018, "mode": "test", "epoch": 56}
{"loss": 0.046104613691568375, "acc": 0.9940202236175537, "length": 4.120316505432129, "mode": "train", "epoch": 57}
{"loss": 0.07745673507452011, "acc": 0.9866672158241272, "length": 4.098958492279053, "mode": "test", "epoch": 57}
{"loss": 0.04468498378992081, "acc": 0.9943756461143494, "length": 4.116603374481201, "mode": "train", "epoch": 58}
{"loss": 0.0801621675491333, "acc": 0.9838079810142517, "length": 4.032986164093018, "mode": "test", "epoch": 58}
{"loss": 0.04322724789381027, "acc": 0.994683563709259, "length": 4.121500492095947, "mode": "train", "epoch": 59}
{"loss": 0.06329023092985153, "acc": 0.9897732138633728, "length": 4.119791507720947, "mode": "test", "epoch": 59}
{"loss": 0.07469221204519272, "acc": 0.985343337059021, "length": 4.171990871429443, "mode": "train", "epoch": 60}
{"loss": 0.08967535197734833, "acc": 0.9787299036979675, "length": 4.05381965637207, "mode": "test", "epoch": 60}
test accuracy: 0.7967823147773743
