ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.6802574992179871, "acc": 0.5677763819694519, "length": 3.392848253250122, "mode": "train", "epoch": 1}
{"loss": 0.578195333480835, "acc": 0.7229356169700623, "length": 3.996527671813965, "mode": "test", "epoch": 1}
{"loss": 0.5090996026992798, "acc": 0.7582865357398987, "length": 3.935455560684204, "mode": "train", "epoch": 2}
{"loss": 0.49750450253486633, "acc": 0.7773436903953552, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.44050461053848267, "acc": 0.809165894985199, "length": 3.988626480102539, "mode": "train", "epoch": 3}
{"loss": 0.47200319170951843, "acc": 0.805468738079071, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.38309547305107117, "acc": 0.8361861705780029, "length": 3.995161533355713, "mode": "train", "epoch": 4}
{"loss": 0.43752267956733704, "acc": 0.8116319179534912, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.35207098722457886, "acc": 0.8477250337600708, "length": 3.997332811355591, "mode": "train", "epoch": 5}
{"loss": 0.3898570239543915, "acc": 0.8300347924232483, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.3223137855529785, "acc": 0.863203763961792, "length": 3.9983904361724854, "mode": "train", "epoch": 6}
{"loss": 0.35997673869132996, "acc": 0.856336772441864, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.29166099429130554, "acc": 0.8802475929260254, "length": 3.9989686012268066, "mode": "train", "epoch": 7}
{"loss": 0.3465949296951294, "acc": 0.8460069894790649, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.2743930518627167, "acc": 0.8898972272872925, "length": 3.999458074569702, "mode": "train", "epoch": 8}
{"loss": 0.30380645394325256, "acc": 0.8771701455116272, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.257956326007843, "acc": 0.898110568523407, "length": 3.999567985534668, "mode": "train", "epoch": 9}
{"loss": 0.3132277727127075, "acc": 0.8740451335906982, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.25198832154273987, "acc": 0.8992611765861511, "length": 3.9996349811553955, "mode": "train", "epoch": 10}
{"loss": 0.2871277928352356, "acc": 0.8812500834465027, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.23711071908473969, "acc": 0.9098029732704163, "length": 3.999809741973877, "mode": "train", "epoch": 11}
{"loss": 0.275611013174057, "acc": 0.8868055939674377, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.21921329200267792, "acc": 0.9189954400062561, "length": 3.999821662902832, "mode": "train", "epoch": 12}
{"loss": 0.29152411222457886, "acc": 0.8809894919395447, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.20205019414424896, "acc": 0.9236215949058533, "length": 3.9998552799224854, "mode": "train", "epoch": 13}
{"loss": 0.2432159036397934, "acc": 0.9059896469116211, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.18416236340999603, "acc": 0.9328432083129883, "length": 3.9999003410339355, "mode": "train", "epoch": 14}
{"loss": 0.2234516143798828, "acc": 0.9152777194976807, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.17730176448822021, "acc": 0.9345539808273315, "length": 3.9999189376831055, "mode": "train", "epoch": 15}
{"loss": 0.21487444639205933, "acc": 0.9171874523162842, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.16492268443107605, "acc": 0.9407758712768555, "length": 3.999926805496216, "mode": "train", "epoch": 16}
{"loss": 0.2145714908838272, "acc": 0.9185764789581299, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.15697525441646576, "acc": 0.9469150900840759, "length": 3.9999537467956543, "mode": "train", "epoch": 17}
{"loss": 0.208387553691864, "acc": 0.9236978888511658, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.15101934969425201, "acc": 0.9463265538215637, "length": 3.999955415725708, "mode": "train", "epoch": 18}
{"loss": 0.19727496802806854, "acc": 0.9275173544883728, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.14074096083641052, "acc": 0.9510636925697327, "length": 3.9999680519104004, "mode": "train", "epoch": 19}
{"loss": 0.1894431859254837, "acc": 0.9347221851348877, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.13161687552928925, "acc": 0.9565290808677673, "length": 3.9999735355377197, "mode": "train", "epoch": 20}
{"loss": 0.1799025982618332, "acc": 0.9365451335906982, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.12537910044193268, "acc": 0.9591637849807739, "length": 3.9999783039093018, "mode": "train", "epoch": 21}
{"loss": 0.16557136178016663, "acc": 0.9425346851348877, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.12229037284851074, "acc": 0.9607053995132446, "length": 3.9999802112579346, "mode": "train", "epoch": 22}
{"loss": 0.15897350013256073, "acc": 0.9478297829627991, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.11372403800487518, "acc": 0.965386152267456, "length": 3.9999852180480957, "mode": "train", "epoch": 23}
{"loss": 0.15210050344467163, "acc": 0.9506945013999939, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.10918054729700089, "acc": 0.9669836163520813, "length": 3.9999873638153076, "mode": "train", "epoch": 24}
{"loss": 0.15184658765792847, "acc": 0.9511285424232483, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.10367424786090851, "acc": 0.9691418409347534, "length": 3.9999887943267822, "mode": "train", "epoch": 25}
{"loss": 0.13083481788635254, "acc": 0.9576389789581299, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1012701466679573, "acc": 0.9708516597747803, "length": 3.9999923706054688, "mode": "train", "epoch": 26}
{"loss": 0.13905614614486694, "acc": 0.9592882990837097, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.0962962657213211, "acc": 0.9714683294296265, "length": 3.9999945163726807, "mode": "train", "epoch": 27}
{"loss": 0.12057118862867355, "acc": 0.9611978530883789, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.08956540375947952, "acc": 0.9746355414390564, "length": 3.999994993209839, "mode": "train", "epoch": 28}
{"loss": 0.13083875179290771, "acc": 0.9607638120651245, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.08142447471618652, "acc": 0.9783070087432861, "length": 3.9999964237213135, "mode": "train", "epoch": 29}
{"loss": 0.11371089518070221, "acc": 0.9715278148651123, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.07937763631343842, "acc": 0.9789797067642212, "length": 3.9999969005584717, "mode": "train", "epoch": 30}
{"loss": 0.12346373498439789, "acc": 0.9657986164093018, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.07874773442745209, "acc": 0.978783369064331, "length": 3.99999737739563, "mode": "train", "epoch": 31}
{"loss": 0.14229677617549896, "acc": 0.9618055820465088, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.07497980445623398, "acc": 0.9799045324325562, "length": 3.999997854232788, "mode": "train", "epoch": 32}
{"loss": 0.1114305779337883, "acc": 0.9693577289581299, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.06874524801969528, "acc": 0.981950581073761, "length": 3.9999983310699463, "mode": "train", "epoch": 33}
{"loss": 0.11290787160396576, "acc": 0.9696180820465088, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.06895460188388824, "acc": 0.9808575510978699, "length": 3.9999985694885254, "mode": "train", "epoch": 34}
{"loss": 0.10762962698936462, "acc": 0.9697048664093018, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.06421811133623123, "acc": 0.9827354550361633, "length": 3.999999523162842, "mode": "train", "epoch": 35}
{"loss": 0.10407260805368423, "acc": 0.9717881679534912, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.059546831995248795, "acc": 0.9841088056564331, "length": 3.999999761581421, "mode": "train", "epoch": 36}
{"loss": 0.1018502414226532, "acc": 0.9741320013999939, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.059419166296720505, "acc": 0.9836884140968323, "length": 3.999999523162842, "mode": "train", "epoch": 37}
{"loss": 0.0991799607872963, "acc": 0.9755207896232605, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.05809906870126724, "acc": 0.9836601614952087, "length": 3.999999761581421, "mode": "train", "epoch": 38}
{"loss": 0.11345973610877991, "acc": 0.9645833969116211, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.06363990157842636, "acc": 0.9820626974105835, "length": 3.999999761581421, "mode": "train", "epoch": 39}
{"loss": 0.09591230750083923, "acc": 0.9769965410232544, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.055591315031051636, "acc": 0.9855661392211914, "length": 3.999999761581421, "mode": "train", "epoch": 40}
{"loss": 0.10308461636304855, "acc": 0.9787326455116272, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.05158993974328041, "acc": 0.9869954586029053, "length": 3.999999761581421, "mode": "train", "epoch": 41}
{"loss": 0.08715905249118805, "acc": 0.9812500476837158, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.04559791833162308, "acc": 0.9889853596687317, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.10212548077106476, "acc": 0.9776042103767395, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.045773427933454514, "acc": 0.9888734221458435, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.09532295912504196, "acc": 0.9786458611488342, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.04226576164364815, "acc": 0.9894339442253113, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.08155319094657898, "acc": 0.9798610210418701, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04382319003343582, "acc": 0.9892095923423767, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.08448603749275208, "acc": 0.9784722924232483, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.040631216019392014, "acc": 0.9902185797691345, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.07023683190345764, "acc": 0.9840278625488281, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.03643398359417915, "acc": 0.9916200041770935, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.07857141643762589, "acc": 0.9789929986000061, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.03470555692911148, "acc": 0.9921244978904724, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.07826206833124161, "acc": 0.9792534708976746, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.037740886211395264, "acc": 0.9903866648674011, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.08147545903921127, "acc": 0.9806424379348755, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.03670185059309006, "acc": 0.9901905059814453, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.0791684091091156, "acc": 0.9833332896232605, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.038885150104761124, "acc": 0.9906668663024902, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.0684441328048706, "acc": 0.9835069179534912, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.036108169704675674, "acc": 0.9919281601905823, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.07625802606344223, "acc": 0.9816839694976807, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03505512699484825, "acc": 0.991283655166626, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.084633469581604, "acc": 0.9797743558883667, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.0314299501478672, "acc": 0.9925728440284729, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.06011909246444702, "acc": 0.9833332896232605, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.028037752956151962, "acc": 0.9938340783119202, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.05957230553030968, "acc": 0.9862847924232483, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.024863850325345993, "acc": 0.9947308301925659, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.0601496547460556, "acc": 0.9855034351348877, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.040519606322050095, "acc": 0.9894339442253113, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.10440653562545776, "acc": 0.9754340648651123, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.03804975003004074, "acc": 0.9900224804878235, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.06473575532436371, "acc": 0.9810764789581299, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03738216310739517, "acc": 0.9896580576896667, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.05844046175479889, "acc": 0.9841146469116211, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.030643191188573837, "acc": 0.9928251504898071, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.06555891036987305, "acc": 0.9831597208976746, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7928225994110107
