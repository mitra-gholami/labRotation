ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.684898853302002, "acc": 0.5534064769744873, "length": 3.023763418197632, "mode": "train", "epoch": 1}
{"loss": 0.6108963489532471, "acc": 0.7118934988975525, "length": 2.643092155456543, "mode": "test", "epoch": 1}
{"loss": 0.5603331923484802, "acc": 0.7140353322029114, "length": 3.2449989318847656, "mode": "train", "epoch": 2}
{"loss": 0.5072992444038391, "acc": 0.7648026347160339, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.45420047640800476, "acc": 0.8043208122253418, "length": 3.9543089866638184, "mode": "train", "epoch": 3}
{"loss": 0.4113209545612335, "acc": 0.8309209942817688, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.37764522433280945, "acc": 0.8423891067504883, "length": 3.990741014480591, "mode": "train", "epoch": 4}
{"loss": 0.3667309582233429, "acc": 0.8388980627059937, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.3270699083805084, "acc": 0.8649424314498901, "length": 3.9946703910827637, "mode": "train", "epoch": 5}
{"loss": 0.3429987132549286, "acc": 0.8621710538864136, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.2940267324447632, "acc": 0.8816680312156677, "length": 3.9970664978027344, "mode": "train", "epoch": 6}
{"loss": 0.315164715051651, "acc": 0.8720394968986511, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.26179590821266174, "acc": 0.8974448442459106, "length": 3.9981515407562256, "mode": "train", "epoch": 7}
{"loss": 0.29551246762275696, "acc": 0.886019766330719, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.24239665269851685, "acc": 0.9096496105194092, "length": 3.998718738555908, "mode": "train", "epoch": 8}
{"loss": 0.27693259716033936, "acc": 0.900246798992157, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.22575336694717407, "acc": 0.9179617166519165, "length": 3.9992153644561768, "mode": "train", "epoch": 9}
{"loss": 0.25121888518333435, "acc": 0.9083060026168823, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.20790132880210876, "acc": 0.9275431036949158, "length": 3.9993350505828857, "mode": "train", "epoch": 10}
{"loss": 0.24533668160438538, "acc": 0.9026315808296204, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.19513490796089172, "acc": 0.929946780204773, "length": 3.999485492706299, "mode": "train", "epoch": 11}
{"loss": 0.23585520684719086, "acc": 0.9187500476837158, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.18395254015922546, "acc": 0.937625527381897, "length": 3.9995949268341064, "mode": "train", "epoch": 12}
{"loss": 0.21101517975330353, "acc": 0.9288651347160339, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.17223484814167023, "acc": 0.9408674836158752, "length": 3.9996566772460938, "mode": "train", "epoch": 13}
{"loss": 0.20554180443286896, "acc": 0.9286184906959534, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.16797353327274323, "acc": 0.943974494934082, "length": 3.9997622966766357, "mode": "train", "epoch": 14}
{"loss": 0.18731142580509186, "acc": 0.9385690093040466, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.15872447192668915, "acc": 0.9461520910263062, "length": 3.9997751712799072, "mode": "train", "epoch": 15}
{"loss": 0.1945095956325531, "acc": 0.9373354911804199, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.15048855543136597, "acc": 0.9493375420570374, "length": 3.9998257160186768, "mode": "train", "epoch": 16}
{"loss": 0.17378975450992584, "acc": 0.9421053528785706, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.14475959539413452, "acc": 0.9524150490760803, "length": 3.9998538494110107, "mode": "train", "epoch": 17}
{"loss": 0.170942023396492, "acc": 0.9407894611358643, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.13656862080097198, "acc": 0.954919695854187, "length": 3.999863386154175, "mode": "train", "epoch": 18}
{"loss": 0.1820070594549179, "acc": 0.9363486766815186, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.13424396514892578, "acc": 0.9561994671821594, "length": 3.9998817443847656, "mode": "train", "epoch": 19}
{"loss": 0.16229292750358582, "acc": 0.9435855746269226, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.12518037855625153, "acc": 0.959466278553009, "length": 3.999894857406616, "mode": "train", "epoch": 20}
{"loss": 0.15397503972053528, "acc": 0.9514803886413574, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.1181349828839302, "acc": 0.9617531299591064, "length": 3.999903678894043, "mode": "train", "epoch": 21}
{"loss": 0.15832266211509705, "acc": 0.947121798992157, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.10896330326795578, "acc": 0.9667072892189026, "length": 3.999915838241577, "mode": "train", "epoch": 22}
{"loss": 0.1547781080007553, "acc": 0.9554275870323181, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.10664531588554382, "acc": 0.9664085507392883, "length": 3.9999277591705322, "mode": "train", "epoch": 23}
{"loss": 0.1412794142961502, "acc": 0.9577303528785706, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.10670246928930283, "acc": 0.9668448567390442, "length": 3.9999442100524902, "mode": "train", "epoch": 24}
{"loss": 0.14025890827178955, "acc": 0.956332266330719, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.10163240134716034, "acc": 0.9687231779098511, "length": 3.999950647354126, "mode": "train", "epoch": 25}
{"loss": 0.15415558218955994, "acc": 0.951644778251648, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.09534792602062225, "acc": 0.9717723727226257, "length": 3.9999637603759766, "mode": "train", "epoch": 26}
{"loss": 0.1329972743988037, "acc": 0.9620888233184814, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.08586923778057098, "acc": 0.9751739501953125, "length": 3.999953031539917, "mode": "train", "epoch": 27}
{"loss": 0.1310604363679886, "acc": 0.9642269611358643, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.088188536465168, "acc": 0.9756097793579102, "length": 3.9999585151672363, "mode": "train", "epoch": 28}
{"loss": 0.13474661111831665, "acc": 0.9614309072494507, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.08163948357105255, "acc": 0.9785227179527283, "length": 3.999967575073242, "mode": "train", "epoch": 29}
{"loss": 0.13836374878883362, "acc": 0.9614309072494507, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.08156075328588486, "acc": 0.9758824706077576, "length": 3.999965190887451, "mode": "train", "epoch": 30}
{"loss": 0.12450146675109863, "acc": 0.9650493264198303, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.07526478171348572, "acc": 0.9797478318214417, "length": 3.9999759197235107, "mode": "train", "epoch": 31}
{"loss": 0.11954003572463989, "acc": 0.967269778251648, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.07122720032930374, "acc": 0.982143223285675, "length": 3.999979257583618, "mode": "train", "epoch": 32}
{"loss": 0.13196758925914764, "acc": 0.9595394134521484, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.07200708985328674, "acc": 0.9814085364341736, "length": 3.999981641769409, "mode": "train", "epoch": 33}
{"loss": 0.11061118543148041, "acc": 0.9704769253730774, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.0664784386754036, "acc": 0.9830416440963745, "length": 3.9999754428863525, "mode": "train", "epoch": 34}
{"loss": 0.10559775680303574, "acc": 0.9720394611358643, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.06024130433797836, "acc": 0.9850288033485413, "length": 3.999983787536621, "mode": "train", "epoch": 35}
{"loss": 0.11223308742046356, "acc": 0.9712170958518982, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.060051329433918, "acc": 0.9850019216537476, "length": 3.9999876022338867, "mode": "train", "epoch": 36}
{"loss": 0.10402525216341019, "acc": 0.974753201007843, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.06091497093439102, "acc": 0.9849467277526855, "length": 3.9999754428863525, "mode": "train", "epoch": 37}
{"loss": 0.1106114611029625, "acc": 0.9708881378173828, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.05904413014650345, "acc": 0.9836136698722839, "length": 3.9999866485595703, "mode": "train", "epoch": 38}
{"loss": 0.10366964340209961, "acc": 0.9720394611358643, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.05244038254022598, "acc": 0.9882952570915222, "length": 3.999986410140991, "mode": "train", "epoch": 39}
{"loss": 0.10294582694768906, "acc": 0.9710525870323181, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.053142983466386795, "acc": 0.9872068166732788, "length": 3.999990940093994, "mode": "train", "epoch": 40}
{"loss": 0.09274318069219589, "acc": 0.9760692715644836, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.05186030641198158, "acc": 0.9874515533447266, "length": 3.9999892711639404, "mode": "train", "epoch": 41}
{"loss": 0.0896194726228714, "acc": 0.9740131497383118, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.05334290489554405, "acc": 0.9872066974639893, "length": 3.999990463256836, "mode": "train", "epoch": 42}
{"loss": 0.10485232621431351, "acc": 0.9734375476837158, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.05464699864387512, "acc": 0.985628068447113, "length": 3.999990940093994, "mode": "train", "epoch": 43}
{"loss": 0.10640452057123184, "acc": 0.9737664461135864, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.05335492640733719, "acc": 0.9866899251937866, "length": 3.999995708465576, "mode": "train", "epoch": 44}
{"loss": 0.09916169196367264, "acc": 0.9720394611358643, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04033023491501808, "acc": 0.9908269643783569, "length": 3.999992609024048, "mode": "train", "epoch": 45}
{"loss": 0.084499292075634, "acc": 0.9796874523162842, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.03368410840630531, "acc": 0.9936851263046265, "length": 3.9999959468841553, "mode": "train", "epoch": 46}
{"loss": 0.0840735211968422, "acc": 0.9778782725334167, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.038659337908029556, "acc": 0.9915621876716614, "length": 3.999997854232788, "mode": "train", "epoch": 47}
{"loss": 0.08962511271238327, "acc": 0.9730263948440552, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.036685727536678314, "acc": 0.9917798042297363, "length": 3.9999969005584717, "mode": "train", "epoch": 48}
{"loss": 0.061092376708984375, "acc": 0.9831414222717285, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.03523078188300133, "acc": 0.9925963878631592, "length": 3.999997854232788, "mode": "train", "epoch": 49}
{"loss": 0.1459055095911026, "acc": 0.9619243741035461, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04513615742325783, "acc": 0.9875611066818237, "length": 3.999997854232788, "mode": "train", "epoch": 50}
{"loss": 0.07266700267791748, "acc": 0.9824836254119873, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.032151442021131516, "acc": 0.9935763478279114, "length": 3.9999983310699463, "mode": "train", "epoch": 51}
{"loss": 0.0804767906665802, "acc": 0.981743335723877, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03320847824215889, "acc": 0.9936035871505737, "length": 3.9999990463256836, "mode": "train", "epoch": 52}
{"loss": 0.07738970965147018, "acc": 0.9835526347160339, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03894910216331482, "acc": 0.9917526841163635, "length": 3.999999523162842, "mode": "train", "epoch": 53}
{"loss": 0.08665113896131516, "acc": 0.973930835723877, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.03705484792590141, "acc": 0.9910995364189148, "length": 3.999999523162842, "mode": "train", "epoch": 54}
{"loss": 0.08844418823719025, "acc": 0.9776315093040466, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03943859785795212, "acc": 0.9899290800094604, "length": 3.9999992847442627, "mode": "train", "epoch": 55}
{"loss": 0.1494956910610199, "acc": 0.9643089771270752, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.03581542894244194, "acc": 0.9919160008430481, "length": 3.999998092651367, "mode": "train", "epoch": 56}
{"loss": 0.06581077724695206, "acc": 0.9848685264587402, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.02912583202123642, "acc": 0.9940119981765747, "length": 3.999999523162842, "mode": "train", "epoch": 57}
{"loss": 0.0689942017197609, "acc": 0.9845395088195801, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.030963821336627007, "acc": 0.9935764670372009, "length": 3.999999761581421, "mode": "train", "epoch": 58}
{"loss": 0.06602265685796738, "acc": 0.9846216440200806, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.02580648474395275, "acc": 0.9954544901847839, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.06683069467544556, "acc": 0.9822367429733276, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.021696727722883224, "acc": 0.9960260987281799, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.07059445977210999, "acc": 0.9832236766815186, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7823636531829834
