ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.7069172263145447, "acc": 0.5113303065299988, "length": 2.3947019577026367, "mode": "train", "epoch": 1}
{"loss": 0.6975960731506348, "acc": 0.5151041150093079, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6742296814918518, "acc": 0.5877965688705444, "length": 1.5771605968475342, "mode": "train", "epoch": 2}
{"loss": 0.6300613880157471, "acc": 0.6517388820648193, "length": 1.6041666269302368, "mode": "test", "epoch": 2}
{"loss": 0.5918198227882385, "acc": 0.697227954864502, "length": 1.667860746383667, "mode": "train", "epoch": 3}
{"loss": 0.5622693300247192, "acc": 0.7350965142250061, "length": 1.4947916269302368, "mode": "test", "epoch": 3}
{"loss": 0.5275874137878418, "acc": 0.736944854259491, "length": 1.5932068824768066, "mode": "train", "epoch": 4}
{"loss": 0.5202098488807678, "acc": 0.7388238906860352, "length": 1.3802083730697632, "mode": "test", "epoch": 4}
{"loss": 0.5106599926948547, "acc": 0.7437582612037659, "length": 1.495627760887146, "mode": "train", "epoch": 5}
{"loss": 0.5233201384544373, "acc": 0.7410725951194763, "length": 1.3836805820465088, "mode": "test", "epoch": 5}
{"loss": 0.5072494149208069, "acc": 0.7448461055755615, "length": 1.472316026687622, "mode": "train", "epoch": 6}
{"loss": 0.5173407793045044, "acc": 0.7417886257171631, "length": 1.3836805820465088, "mode": "test", "epoch": 6}
{"loss": 0.5048691630363464, "acc": 0.7459913492202759, "length": 1.4915227890014648, "mode": "train", "epoch": 7}
{"loss": 0.5102388858795166, "acc": 0.7441243529319763, "length": 1.4045138359069824, "mode": "test", "epoch": 7}
{"loss": 0.4984041452407837, "acc": 0.7472148537635803, "length": 1.5198986530303955, "mode": "train", "epoch": 8}
{"loss": 0.5091962814331055, "acc": 0.7458035349845886, "length": 1.4131944179534912, "mode": "test", "epoch": 8}
{"loss": 0.49430355429649353, "acc": 0.7515265941619873, "length": 1.5905312299728394, "mode": "train", "epoch": 9}
{"loss": 0.5172609090805054, "acc": 0.7386040687561035, "length": 1.4427083730697632, "mode": "test", "epoch": 9}
{"loss": 0.47856956720352173, "acc": 0.7653932571411133, "length": 1.6392697095870972, "mode": "train", "epoch": 10}
{"loss": 0.5029639005661011, "acc": 0.763427734375, "length": 1.5434027910232544, "mode": "test", "epoch": 10}
{"loss": 0.4554345905780792, "acc": 0.7927273511886597, "length": 1.8441827297210693, "mode": "train", "epoch": 11}
{"loss": 0.4791114628314972, "acc": 0.7856906056404114, "length": 1.7083333730697632, "mode": "test", "epoch": 11}
{"loss": 0.42011892795562744, "acc": 0.8203770518302917, "length": 2.066521644592285, "mode": "train", "epoch": 12}
{"loss": 0.45171865820884705, "acc": 0.8054361939430237, "length": 1.8420138359069824, "mode": "test", "epoch": 12}
{"loss": 0.382426917552948, "acc": 0.8409937620162964, "length": 2.45526123046875, "mode": "train", "epoch": 13}
{"loss": 0.4378204643726349, "acc": 0.8149413466453552, "length": 2.199652671813965, "mode": "test", "epoch": 13}
{"loss": 0.3422722816467285, "acc": 0.8619967699050903, "length": 2.8362793922424316, "mode": "train", "epoch": 14}
{"loss": 0.37533843517303467, "acc": 0.8510606288909912, "length": 2.5642361640930176, "mode": "test", "epoch": 14}
{"loss": 0.3007100820541382, "acc": 0.8803747296333313, "length": 3.2167556285858154, "mode": "train", "epoch": 15}
{"loss": 0.3316570520401001, "acc": 0.8718397617340088, "length": 2.949652671813965, "mode": "test", "epoch": 15}
{"loss": 0.2716943919658661, "acc": 0.8948332071304321, "length": 3.3831019401550293, "mode": "train", "epoch": 16}
{"loss": 0.3298757076263428, "acc": 0.8733127117156982, "length": 3.199652671813965, "mode": "test", "epoch": 16}
{"loss": 0.25122594833374023, "acc": 0.9066450595855713, "length": 3.5778331756591797, "mode": "train", "epoch": 17}
{"loss": 0.2967971861362457, "acc": 0.8914713263511658, "length": 3.324652671813965, "mode": "test", "epoch": 17}
{"loss": 0.2329414039850235, "acc": 0.9199410676956177, "length": 3.6836278438568115, "mode": "train", "epoch": 18}
{"loss": 0.2916129231452942, "acc": 0.8945176601409912, "length": 3.3854167461395264, "mode": "test", "epoch": 18}
{"loss": 0.2248857170343399, "acc": 0.9251341819763184, "length": 3.6268887519836426, "mode": "train", "epoch": 19}
{"loss": 0.27834346890449524, "acc": 0.911865234375, "length": 3.5486111640930176, "mode": "test", "epoch": 19}
{"loss": 0.2121429592370987, "acc": 0.9291253089904785, "length": 3.665739059448242, "mode": "train", "epoch": 20}
{"loss": 0.27815449237823486, "acc": 0.9073405861854553, "length": 3.428819417953491, "mode": "test", "epoch": 20}
{"loss": 0.20432844758033752, "acc": 0.934212327003479, "length": 3.704907178878784, "mode": "train", "epoch": 21}
{"loss": 0.29971227049827576, "acc": 0.8903239369392395, "length": 3.4357638359069824, "mode": "test", "epoch": 21}
{"loss": 0.1964596062898636, "acc": 0.9386892914772034, "length": 3.707402229309082, "mode": "train", "epoch": 22}
{"loss": 0.2603933811187744, "acc": 0.9124510884284973, "length": 3.633680582046509, "mode": "test", "epoch": 22}
{"loss": 0.18708866834640503, "acc": 0.9417201280593872, "length": 3.7966184616088867, "mode": "train", "epoch": 23}
{"loss": 0.2520311176776886, "acc": 0.9137750267982483, "length": 3.675347328186035, "mode": "test", "epoch": 23}
{"loss": 0.1821700930595398, "acc": 0.9429415464401245, "length": 3.8081746101379395, "mode": "train", "epoch": 24}
{"loss": 0.2432388961315155, "acc": 0.9166449308395386, "length": 3.737847328186035, "mode": "test", "epoch": 24}
{"loss": 0.1718844771385193, "acc": 0.9485529661178589, "length": 3.830031394958496, "mode": "train", "epoch": 25}
{"loss": 0.22042641043663025, "acc": 0.9312472939491272, "length": 3.8732638359069824, "mode": "test", "epoch": 25}
{"loss": 0.1639041304588318, "acc": 0.9512374997138977, "length": 3.8806312084198, "mode": "train", "epoch": 26}
{"loss": 0.2064404934644699, "acc": 0.9353136420249939, "length": 3.8888888359069824, "mode": "test", "epoch": 26}
{"loss": 0.16042132675647736, "acc": 0.9540079832077026, "length": 3.955615997314453, "mode": "train", "epoch": 27}
{"loss": 0.20926877856254578, "acc": 0.9336751103401184, "length": 3.918402671813965, "mode": "test", "epoch": 27}
{"loss": 0.15659697353839874, "acc": 0.9536362290382385, "length": 3.9522950649261475, "mode": "train", "epoch": 28}
{"loss": 0.19638364017009735, "acc": 0.9445664882659912, "length": 3.9670138359069824, "mode": "test", "epoch": 28}
{"loss": 0.1474125236272812, "acc": 0.9580047130584717, "length": 4.032077789306641, "mode": "train", "epoch": 29}
{"loss": 0.20461219549179077, "acc": 0.937413215637207, "length": 3.9982638359069824, "mode": "test", "epoch": 29}
{"loss": 0.14700959622859955, "acc": 0.958044707775116, "length": 3.969865083694458, "mode": "train", "epoch": 30}
{"loss": 0.20083051919937134, "acc": 0.9377632141113281, "length": 3.914930582046509, "mode": "test", "epoch": 30}
{"loss": 0.13628490269184113, "acc": 0.9642434120178223, "length": 4.0011820793151855, "mode": "train", "epoch": 31}
{"loss": 0.17808976769447327, "acc": 0.9464573264122009, "length": 3.9826388359069824, "mode": "test", "epoch": 31}
{"loss": 0.13141819834709167, "acc": 0.9671517014503479, "length": 3.9942078590393066, "mode": "train", "epoch": 32}
{"loss": 0.18849189579486847, "acc": 0.9485486149787903, "length": 3.875, "mode": "test", "epoch": 32}
{"loss": 0.13591328263282776, "acc": 0.9647560715675354, "length": 3.9752283096313477, "mode": "train", "epoch": 33}
{"loss": 0.18977691233158112, "acc": 0.9446070790290833, "length": 4.034722328186035, "mode": "test", "epoch": 33}
{"loss": 0.12314143031835556, "acc": 0.9694721102714539, "length": 4.044022083282471, "mode": "train", "epoch": 34}
{"loss": 0.18867626786231995, "acc": 0.9506673812866211, "length": 3.9635417461395264, "mode": "test", "epoch": 34}
{"loss": 0.1213020533323288, "acc": 0.9697941541671753, "length": 4.038041114807129, "mode": "train", "epoch": 35}
{"loss": 0.16701500117778778, "acc": 0.9562364220619202, "length": 3.9357638359069824, "mode": "test", "epoch": 35}
{"loss": 0.1176711767911911, "acc": 0.9706767797470093, "length": 4.0567755699157715, "mode": "train", "epoch": 36}
{"loss": 0.16586032509803772, "acc": 0.9543646574020386, "length": 4.034722328186035, "mode": "test", "epoch": 36}
{"loss": 0.10982365161180496, "acc": 0.9739259481430054, "length": 4.017703056335449, "mode": "train", "epoch": 37}
{"loss": 0.16972821950912476, "acc": 0.9551351070404053, "length": 3.9861111640930176, "mode": "test", "epoch": 37}
{"loss": 0.12393670529127121, "acc": 0.96699059009552, "length": 4.073637008666992, "mode": "train", "epoch": 38}
{"loss": 0.16249945759773254, "acc": 0.9563774466514587, "length": 4.005208492279053, "mode": "test", "epoch": 38}
{"loss": 0.11025069653987885, "acc": 0.9728181958198547, "length": 4.0983357429504395, "mode": "train", "epoch": 39}
{"loss": 0.15274176001548767, "acc": 0.9572970867156982, "length": 3.9635417461395264, "mode": "test", "epoch": 39}
{"loss": 0.10098614543676376, "acc": 0.9757217168807983, "length": 4.024930477142334, "mode": "train", "epoch": 40}
{"loss": 0.15093567967414856, "acc": 0.9608452916145325, "length": 4.027777671813965, "mode": "test", "epoch": 40}
{"loss": 0.0941576212644577, "acc": 0.9780188798904419, "length": 4.044128894805908, "mode": "train", "epoch": 41}
{"loss": 0.15731464326381683, "acc": 0.9532552361488342, "length": 4.017361164093018, "mode": "test", "epoch": 41}
{"loss": 0.09214668720960617, "acc": 0.9790461659431458, "length": 4.058483123779297, "mode": "train", "epoch": 42}
{"loss": 0.14088179171085358, "acc": 0.9625244140625, "length": 4.07118034362793, "mode": "test", "epoch": 42}
{"loss": 0.09625537693500519, "acc": 0.9779223799705505, "length": 4.055216312408447, "mode": "train", "epoch": 43}
{"loss": 0.1611824929714203, "acc": 0.9571723937988281, "length": 4.105902671813965, "mode": "test", "epoch": 43}
{"loss": 0.08937069773674011, "acc": 0.9791294932365417, "length": 4.091778755187988, "mode": "train", "epoch": 44}
{"loss": 0.14493677020072937, "acc": 0.9605361223220825, "length": 4.161458492279053, "mode": "test", "epoch": 44}
{"loss": 0.08238757401704788, "acc": 0.9820634722709656, "length": 4.103892803192139, "mode": "train", "epoch": 45}
{"loss": 0.12584704160690308, "acc": 0.9658881425857544, "length": 4.19618034362793, "mode": "test", "epoch": 45}
{"loss": 0.08223828673362732, "acc": 0.9821770787239075, "length": 4.157674789428711, "mode": "train", "epoch": 46}
{"loss": 0.13744516670703888, "acc": 0.9635903835296631, "length": 4.291666507720947, "mode": "test", "epoch": 46}
{"loss": 0.10148443281650543, "acc": 0.9756282567977905, "length": 4.213548183441162, "mode": "train", "epoch": 47}
{"loss": 0.14064452052116394, "acc": 0.9615043997764587, "length": 4.175347328186035, "mode": "test", "epoch": 47}
{"loss": 0.07803333550691605, "acc": 0.9841344952583313, "length": 4.131913661956787, "mode": "train", "epoch": 48}
{"loss": 0.13583844900131226, "acc": 0.9653671979904175, "length": 4.128472328186035, "mode": "test", "epoch": 48}
{"loss": 0.07725856453180313, "acc": 0.9841565489768982, "length": 4.120851993560791, "mode": "train", "epoch": 49}
{"loss": 0.11528453230857849, "acc": 0.972900390625, "length": 4.236111164093018, "mode": "test", "epoch": 49}
{"loss": 0.07188975065946579, "acc": 0.9854968786239624, "length": 4.1232171058654785, "mode": "train", "epoch": 50}
{"loss": 0.11609508097171783, "acc": 0.9721733927726746, "length": 4.175347328186035, "mode": "test", "epoch": 50}
{"loss": 0.06788380444049835, "acc": 0.9873238205909729, "length": 4.086721420288086, "mode": "train", "epoch": 51}
{"loss": 0.1064208447933197, "acc": 0.974677324295044, "length": 4.14756965637207, "mode": "test", "epoch": 51}
{"loss": 0.06458906829357147, "acc": 0.9873477816581726, "length": 4.104806423187256, "mode": "train", "epoch": 52}
{"loss": 0.13334377110004425, "acc": 0.9643881320953369, "length": 4.14756965637207, "mode": "test", "epoch": 52}
{"loss": 0.0677332952618599, "acc": 0.9867586493492126, "length": 4.091106414794922, "mode": "train", "epoch": 53}
{"loss": 0.10666168481111526, "acc": 0.9753010869026184, "length": 4.189236164093018, "mode": "test", "epoch": 53}
{"loss": 0.0676981583237648, "acc": 0.9855057001113892, "length": 4.0802412033081055, "mode": "train", "epoch": 54}
{"loss": 0.11383701860904694, "acc": 0.9691243767738342, "length": 4.137152671813965, "mode": "test", "epoch": 54}
{"loss": 0.06251825392246246, "acc": 0.9881784915924072, "length": 4.137120246887207, "mode": "train", "epoch": 55}
{"loss": 0.10226424783468246, "acc": 0.9749512076377869, "length": 4.135416507720947, "mode": "test", "epoch": 55}
{"loss": 0.05850566551089287, "acc": 0.9893390536308289, "length": 4.131954193115234, "mode": "train", "epoch": 56}
{"loss": 0.08801137655973434, "acc": 0.9822266101837158, "length": 4.14930534362793, "mode": "test", "epoch": 56}
{"loss": 0.05176258087158203, "acc": 0.9919366836547852, "length": 4.10855770111084, "mode": "train", "epoch": 57}
{"loss": 0.08980736881494522, "acc": 0.9809109568595886, "length": 4.119791507720947, "mode": "test", "epoch": 57}
{"loss": 0.05343181639909744, "acc": 0.990328848361969, "length": 4.132438659667969, "mode": "train", "epoch": 58}
{"loss": 0.0965242087841034, "acc": 0.9781792759895325, "length": 4.253472328186035, "mode": "test", "epoch": 58}
{"loss": 0.05405224859714508, "acc": 0.9911813139915466, "length": 4.135727882385254, "mode": "train", "epoch": 59}
{"loss": 0.09439262002706528, "acc": 0.9785319566726685, "length": 4.185763835906982, "mode": "test", "epoch": 59}
{"loss": 0.06044583395123482, "acc": 0.9884257912635803, "length": 4.0993828773498535, "mode": "train", "epoch": 60}
{"loss": 0.10999777168035507, "acc": 0.9722655415534973, "length": 4.121527671813965, "mode": "test", "epoch": 60}
test accuracy: 0.7397604584693909
