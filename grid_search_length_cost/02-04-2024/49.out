ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 30
{"loss": 0.525970458984375, "acc": 0.7234639525413513, "length": 2.040289878845215, "mode": "train", "epoch": 1}
{"loss": 0.40578171610832214, "acc": 0.827913761138916, "length": 2.614342451095581, "mode": "test", "epoch": 1}
{"loss": 0.29262974858283997, "acc": 0.8974286317825317, "length": 3.0129828453063965, "mode": "train", "epoch": 2}
{"loss": 0.3069932162761688, "acc": 0.8840829730033875, "length": 3.180924892425537, "mode": "test", "epoch": 2}
{"loss": 0.22844310104846954, "acc": 0.9287809729576111, "length": 3.404099702835083, "mode": "train", "epoch": 3}
{"loss": 0.3011022210121155, "acc": 0.8874139189720154, "length": 3.386958122253418, "mode": "test", "epoch": 3}
{"loss": 0.1956387162208557, "acc": 0.9438589811325073, "length": 3.5335347652435303, "mode": "train", "epoch": 4}
{"loss": 0.21914416551589966, "acc": 0.9313952922821045, "length": 3.5121748447418213, "mode": "test", "epoch": 4}
{"loss": 0.17346833646297455, "acc": 0.9533851146697998, "length": 3.553131580352783, "mode": "train", "epoch": 5}
{"loss": 0.1899256855249405, "acc": 0.9467609524726868, "length": 3.5226879119873047, "mode": "test", "epoch": 5}
{"loss": 0.16070565581321716, "acc": 0.9585930705070496, "length": 3.5450215339660645, "mode": "train", "epoch": 6}
{"loss": 0.1720701903104782, "acc": 0.9545757174491882, "length": 3.5417630672454834, "mode": "test", "epoch": 6}
{"loss": 0.14970816671848297, "acc": 0.9626729488372803, "length": 3.536431312561035, "mode": "train", "epoch": 7}
{"loss": 0.15927794575691223, "acc": 0.9596405029296875, "length": 3.5235910415649414, "mode": "test", "epoch": 7}
{"loss": 0.14160963892936707, "acc": 0.9656442999839783, "length": 3.548236846923828, "mode": "train", "epoch": 8}
{"loss": 0.16268086433410645, "acc": 0.9568853378295898, "length": 3.549313545227051, "mode": "test", "epoch": 8}
{"loss": 0.13665969669818878, "acc": 0.9673221707344055, "length": 3.5530951023101807, "mode": "train", "epoch": 9}
{"loss": 0.15534812211990356, "acc": 0.9591502547264099, "length": 3.56091046333313, "mode": "test", "epoch": 9}
{"loss": 0.1307884305715561, "acc": 0.9694422483444214, "length": 3.561185836791992, "mode": "train", "epoch": 10}
{"loss": 0.1568916141986847, "acc": 0.957821786403656, "length": 3.562608480453491, "mode": "test", "epoch": 10}
{"loss": 0.1255071610212326, "acc": 0.971538782119751, "length": 3.5614492893218994, "mode": "train", "epoch": 11}
{"loss": 0.14348113536834717, "acc": 0.9640726447105408, "length": 3.5494580268859863, "mode": "test", "epoch": 11}
{"loss": 0.12222211062908173, "acc": 0.9727447032928467, "length": 3.566474199295044, "mode": "train", "epoch": 12}
{"loss": 0.13821467757225037, "acc": 0.9677038788795471, "length": 3.5700504779815674, "mode": "test", "epoch": 12}
{"loss": 0.1185493990778923, "acc": 0.9739872217178345, "length": 3.569490671157837, "mode": "train", "epoch": 13}
{"loss": 0.13254986703395844, "acc": 0.9694225788116455, "length": 3.5667269229888916, "mode": "test", "epoch": 13}
{"loss": 0.11578277498483658, "acc": 0.9750207662582397, "length": 3.5659148693084717, "mode": "train", "epoch": 14}
{"loss": 0.13326142728328705, "acc": 0.9684355854988098, "length": 3.5597543716430664, "mode": "test", "epoch": 14}
{"loss": 0.11378146708011627, "acc": 0.9758278727531433, "length": 3.5683417320251465, "mode": "train", "epoch": 15}
{"loss": 0.12948283553123474, "acc": 0.9701844453811646, "length": 3.5661487579345703, "mode": "test", "epoch": 15}
{"loss": 0.11265196651220322, "acc": 0.9760159254074097, "length": 3.5666134357452393, "mode": "train", "epoch": 16}
{"loss": 0.125015527009964, "acc": 0.9721370339393616, "length": 3.565643072128296, "mode": "test", "epoch": 16}
{"loss": 0.11163044720888138, "acc": 0.9763177037239075, "length": 3.5700440406799316, "mode": "train", "epoch": 17}
{"loss": 0.1190437376499176, "acc": 0.9732948541641235, "length": 3.563981294631958, "mode": "test", "epoch": 17}
{"loss": 0.10854010283946991, "acc": 0.9773678183555603, "length": 3.559067726135254, "mode": "train", "epoch": 18}
{"loss": 0.12212405353784561, "acc": 0.9727444648742676, "length": 3.5430996417999268, "mode": "test", "epoch": 18}
{"loss": 0.1081654354929924, "acc": 0.9775764346122742, "length": 3.560516357421875, "mode": "train", "epoch": 19}
{"loss": 0.11986350268125534, "acc": 0.9735323786735535, "length": 3.5602240562438965, "mode": "test", "epoch": 19}
{"loss": 0.1066468358039856, "acc": 0.9779547452926636, "length": 3.56131649017334, "mode": "train", "epoch": 20}
{"loss": 0.11572650820016861, "acc": 0.9753429293632507, "length": 3.5540101528167725, "mode": "test", "epoch": 20}
{"loss": 0.10501210391521454, "acc": 0.978481650352478, "length": 3.5606541633605957, "mode": "train", "epoch": 21}
{"loss": 0.11913285404443741, "acc": 0.9749308228492737, "length": 3.5613439083099365, "mode": "test", "epoch": 21}
{"loss": 0.10481321066617966, "acc": 0.9784201383590698, "length": 3.563544988632202, "mode": "train", "epoch": 22}
{"loss": 0.11291353404521942, "acc": 0.974940299987793, "length": 3.5610549449920654, "mode": "test", "epoch": 22}
{"loss": 0.10234426707029343, "acc": 0.9792733788490295, "length": 3.5631511211395264, "mode": "train", "epoch": 23}
{"loss": 0.11149397492408752, "acc": 0.9775095582008362, "length": 3.564053535461426, "mode": "test", "epoch": 23}
{"loss": 0.10101892799139023, "acc": 0.9796918630599976, "length": 3.5646471977233887, "mode": "train", "epoch": 24}
{"loss": 0.10931602865457535, "acc": 0.9769939184188843, "length": 3.5618858337402344, "mode": "test", "epoch": 24}
{"loss": 0.10115496814250946, "acc": 0.9798014163970947, "length": 3.574643850326538, "mode": "train", "epoch": 25}
{"loss": 0.10681122541427612, "acc": 0.9778879284858704, "length": 3.5686776638031006, "mode": "test", "epoch": 25}
{"loss": 0.09883154928684235, "acc": 0.9803622961044312, "length": 3.5668716430664062, "mode": "train", "epoch": 26}
{"loss": 0.10866750031709671, "acc": 0.9781337976455688, "length": 3.571315050125122, "mode": "test", "epoch": 26}
{"loss": 0.09900394827127457, "acc": 0.9802405834197998, "length": 3.5649991035461426, "mode": "train", "epoch": 27}
{"loss": 0.10880060493946075, "acc": 0.9785438776016235, "length": 3.560260057449341, "mode": "test", "epoch": 27}
{"loss": 0.0989169031381607, "acc": 0.9801552891731262, "length": 3.5623369216918945, "mode": "train", "epoch": 28}
{"loss": 0.1071140319108963, "acc": 0.9785071015357971, "length": 3.560621500015259, "mode": "test", "epoch": 28}
{"loss": 0.09776585549116135, "acc": 0.9805788397789001, "length": 3.565047264099121, "mode": "train", "epoch": 29}
{"loss": 0.10643699765205383, "acc": 0.9784071445465088, "length": 3.5727601051330566, "mode": "test", "epoch": 29}
{"loss": 0.09643019735813141, "acc": 0.9808629751205444, "length": 3.566356897354126, "mode": "train", "epoch": 30}
{"loss": 0.10657893121242523, "acc": 0.9784873127937317, "length": 3.570664644241333, "mode": "test", "epoch": 30}
{"loss": 0.1002105325460434, "acc": 0.9794393181800842, "length": 3.5712382793426514, "mode": "train", "epoch": 31}
{"loss": 0.1071484163403511, "acc": 0.977792501449585, "length": 3.556755781173706, "mode": "test", "epoch": 31}
{"loss": 0.09571913629770279, "acc": 0.9810240268707275, "length": 3.5760490894317627, "mode": "train", "epoch": 32}
{"loss": 0.10573035478591919, "acc": 0.9781367182731628, "length": 3.567593812942505, "mode": "test", "epoch": 32}
{"loss": 0.09479915350675583, "acc": 0.9814295768737793, "length": 3.5661799907684326, "mode": "train", "epoch": 33}
{"loss": 0.10813022404909134, "acc": 0.9783087968826294, "length": 3.56203031539917, "mode": "test", "epoch": 33}
{"loss": 0.0945863351225853, "acc": 0.9814529418945312, "length": 3.569974184036255, "mode": "train", "epoch": 34}
{"loss": 0.10736357420682907, "acc": 0.9778757691383362, "length": 3.5817196369171143, "mode": "test", "epoch": 34}
{"loss": 0.09802864491939545, "acc": 0.9803186058998108, "length": 3.571932554244995, "mode": "train", "epoch": 35}
{"loss": 0.10625869035720825, "acc": 0.9772883057594299, "length": 3.5764811038970947, "mode": "test", "epoch": 35}
{"loss": 0.09514954686164856, "acc": 0.9812620878219604, "length": 3.570542573928833, "mode": "train", "epoch": 36}
{"loss": 0.10409128665924072, "acc": 0.9790441989898682, "length": 3.5677385330200195, "mode": "test", "epoch": 36}
{"loss": 0.09261195361614227, "acc": 0.981968343257904, "length": 3.5668697357177734, "mode": "train", "epoch": 37}
{"loss": 0.10536704212427139, "acc": 0.9785751104354858, "length": 3.562788963317871, "mode": "test", "epoch": 37}
{"loss": 0.09290119260549545, "acc": 0.9818581342697144, "length": 3.5715646743774414, "mode": "train", "epoch": 38}
{"loss": 0.10446588695049286, "acc": 0.9779419898986816, "length": 3.572868585586548, "mode": "test", "epoch": 38}
{"loss": 0.09160570800304413, "acc": 0.9823938012123108, "length": 3.5743257999420166, "mode": "train", "epoch": 39}
{"loss": 0.09888467192649841, "acc": 0.9810959100723267, "length": 3.5679190158843994, "mode": "test", "epoch": 39}
{"loss": 0.09253031015396118, "acc": 0.9820232391357422, "length": 3.570464611053467, "mode": "train", "epoch": 40}
{"loss": 0.1105962023139, "acc": 0.9758610725402832, "length": 3.59468936920166, "mode": "test", "epoch": 40}
{"loss": 0.09250309318304062, "acc": 0.9820581674575806, "length": 3.575145959854126, "mode": "train", "epoch": 41}
{"loss": 0.0982670933008194, "acc": 0.9805920720100403, "length": 3.5662572383880615, "mode": "test", "epoch": 41}
{"loss": 0.090116485953331, "acc": 0.9827902317047119, "length": 3.5683388710021973, "mode": "train", "epoch": 42}
{"loss": 0.09962311387062073, "acc": 0.9809644222259521, "length": 3.566654682159424, "mode": "test", "epoch": 42}
{"loss": 0.09002739936113358, "acc": 0.9828420877456665, "length": 3.5684401988983154, "mode": "train", "epoch": 43}
{"loss": 0.0961972251534462, "acc": 0.9814690947532654, "length": 3.5612356662750244, "mode": "test", "epoch": 43}
{"loss": 0.08875595778226852, "acc": 0.9831634163856506, "length": 3.569329261779785, "mode": "train", "epoch": 44}
{"loss": 0.09814127534627914, "acc": 0.9807616472244263, "length": 3.571676254272461, "mode": "test", "epoch": 44}
{"loss": 0.09040965884923935, "acc": 0.9827229380607605, "length": 3.575031042098999, "mode": "train", "epoch": 45}
{"loss": 0.10029212385416031, "acc": 0.9807576537132263, "length": 3.5685694217681885, "mode": "test", "epoch": 45}
{"loss": 0.08899284899234772, "acc": 0.9830257296562195, "length": 3.57007098197937, "mode": "train", "epoch": 46}
{"loss": 0.09754911810159683, "acc": 0.9813832640647888, "length": 3.5608019828796387, "mode": "test", "epoch": 46}
{"loss": 0.08914415538311005, "acc": 0.9829916954040527, "length": 3.5691452026367188, "mode": "train", "epoch": 47}
{"loss": 0.09572745859622955, "acc": 0.9824760556221008, "length": 3.5648481845855713, "mode": "test", "epoch": 47}
{"loss": 0.08892273902893066, "acc": 0.9831025004386902, "length": 3.5691030025482178, "mode": "train", "epoch": 48}
{"loss": 0.09451165050268173, "acc": 0.9818434119224548, "length": 3.564450979232788, "mode": "test", "epoch": 48}
{"loss": 0.08804603666067123, "acc": 0.9833035469055176, "length": 3.561424970626831, "mode": "train", "epoch": 49}
{"loss": 0.0967293530702591, "acc": 0.9809516072273254, "length": 3.5569725036621094, "mode": "test", "epoch": 49}
{"loss": 0.08990806341171265, "acc": 0.9827902913093567, "length": 3.5587852001190186, "mode": "train", "epoch": 50}
{"loss": 0.09730397164821625, "acc": 0.9815685749053955, "length": 3.5573337078094482, "mode": "test", "epoch": 50}
{"loss": 0.08839509636163712, "acc": 0.9830648303031921, "length": 3.5630247592926025, "mode": "train", "epoch": 51}
{"loss": 0.09585560113191605, "acc": 0.9820718765258789, "length": 3.5636560916900635, "mode": "test", "epoch": 51}
{"loss": 0.0870022401213646, "acc": 0.9835414886474609, "length": 3.566577672958374, "mode": "train", "epoch": 52}
{"loss": 0.09480040520429611, "acc": 0.9821090698242188, "length": 3.5629334449768066, "mode": "test", "epoch": 52}
{"loss": 0.08766349405050278, "acc": 0.9833027124404907, "length": 3.56752610206604, "mode": "train", "epoch": 53}
{"loss": 0.09540931135416031, "acc": 0.9819647073745728, "length": 3.5641980171203613, "mode": "test", "epoch": 53}
{"loss": 0.08722124248743057, "acc": 0.9834132194519043, "length": 3.569793939590454, "mode": "train", "epoch": 54}
{"loss": 0.09438247978687286, "acc": 0.9823189973831177, "length": 3.5579841136932373, "mode": "test", "epoch": 54}
{"loss": 0.08745421469211578, "acc": 0.9834660291671753, "length": 3.5635716915130615, "mode": "train", "epoch": 55}
{"loss": 0.09436171501874924, "acc": 0.9820702075958252, "length": 3.5646677017211914, "mode": "test", "epoch": 55}
{"loss": 0.08739221096038818, "acc": 0.9833632111549377, "length": 3.564160108566284, "mode": "train", "epoch": 56}
{"loss": 0.09700082987546921, "acc": 0.9820257425308228, "length": 3.5645592212677, "mode": "test", "epoch": 56}
{"loss": 0.0874280110001564, "acc": 0.9833045601844788, "length": 3.568106174468994, "mode": "train", "epoch": 57}
{"loss": 0.09932620823383331, "acc": 0.9817593693733215, "length": 3.5738439559936523, "mode": "test", "epoch": 57}
{"loss": 0.09009449928998947, "acc": 0.9825872778892517, "length": 3.5689048767089844, "mode": "train", "epoch": 58}
{"loss": 0.09524434059858322, "acc": 0.9819818735122681, "length": 3.563041925430298, "mode": "test", "epoch": 58}
{"loss": 0.08815758675336838, "acc": 0.9830673336982727, "length": 3.562713623046875, "mode": "train", "epoch": 59}
{"loss": 0.09412825107574463, "acc": 0.9819437265396118, "length": 3.558237075805664, "mode": "test", "epoch": 59}
{"loss": 0.08809491246938705, "acc": 0.9828886985778809, "length": 3.5722718238830566, "mode": "train", "epoch": 60}
{"loss": 0.09697313606739044, "acc": 0.9816763997077942, "length": 3.576517343521118, "mode": "test", "epoch": 60}
test accuracy: 0.9384239315986633
