ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 3
{"loss": 0.3320440351963043, "acc": 0.8599370121955872, "length": 3.9128923416137695, "mode": "train", "epoch": 1}
{"loss": 0.2591859996318817, "acc": 0.9066942930221558, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.1895913928747177, "acc": 0.9429214596748352, "length": 3.9999852180480957, "mode": "train", "epoch": 2}
{"loss": 0.21853461861610413, "acc": 0.9273916482925415, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.1655169427394867, "acc": 0.9513246417045593, "length": 3.9999985694885254, "mode": "train", "epoch": 3}
{"loss": 0.21276070177555084, "acc": 0.9268605709075928, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.14379450678825378, "acc": 0.9585123658180237, "length": 4.0, "mode": "train", "epoch": 4}
{"loss": 0.1986168771982193, "acc": 0.9334555268287659, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.12551389634609222, "acc": 0.9667733311653137, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.19528678059577942, "acc": 0.9354028701782227, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.11868159472942352, "acc": 0.96922367811203, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.18586018681526184, "acc": 0.9383687973022461, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.11152610182762146, "acc": 0.971601665019989, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.17715710401535034, "acc": 0.9394364953041077, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.10644027590751648, "acc": 0.9733805656433105, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.17395804822444916, "acc": 0.9437482357025146, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.10263925045728683, "acc": 0.9746558666229248, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.17100103199481964, "acc": 0.9440264701843262, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.09879664331674576, "acc": 0.9756803512573242, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.1599244326353073, "acc": 0.9482172727584839, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.09573375433683395, "acc": 0.9768282175064087, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.15612581372261047, "acc": 0.9501209259033203, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.09396955370903015, "acc": 0.9773696660995483, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.14679975807666779, "acc": 0.9566672444343567, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.09379158914089203, "acc": 0.9770652651786804, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.14381712675094604, "acc": 0.956782877445221, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.08668191730976105, "acc": 0.9793837666511536, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.13089199364185333, "acc": 0.9624837040901184, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.08456002920866013, "acc": 0.9801393151283264, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.1242356076836586, "acc": 0.9647002220153809, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.08245301991701126, "acc": 0.9806830883026123, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.12590810656547546, "acc": 0.9623374342918396, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.08231447637081146, "acc": 0.9803312420845032, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.1192241981625557, "acc": 0.9655618071556091, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.07791554927825928, "acc": 0.9813520312309265, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.10557200014591217, "acc": 0.9709989428520203, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.07428953796625137, "acc": 0.9828295707702637, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.11554565280675888, "acc": 0.964044451713562, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.07150539755821228, "acc": 0.983553946018219, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.10347375273704529, "acc": 0.9715860486030579, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.0701022744178772, "acc": 0.9840417504310608, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.09149396419525146, "acc": 0.9769689440727234, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.06949283927679062, "acc": 0.9841403961181641, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.09225117415189743, "acc": 0.9772741794586182, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.06762506067752838, "acc": 0.984712541103363, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.10764618963003159, "acc": 0.9705508351325989, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.0661131963133812, "acc": 0.9851877689361572, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.10145727545022964, "acc": 0.9716708064079285, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.06429396569728851, "acc": 0.9854862093925476, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.08991092443466187, "acc": 0.9770067930221558, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.06243656948208809, "acc": 0.9860395789146423, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.08846866339445114, "acc": 0.9768570065498352, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.060478780418634415, "acc": 0.986630916595459, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.08451328426599503, "acc": 0.9801446199417114, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.06231323629617691, "acc": 0.9861088991165161, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.09042742848396301, "acc": 0.9745772480964661, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.059995610266923904, "acc": 0.9867706298828125, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.08493942767381668, "acc": 0.9778721928596497, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.06078583374619484, "acc": 0.9864426851272583, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 0.08637035638093948, "acc": 0.9771801829338074, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.059837933629751205, "acc": 0.9867087006568909, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.08318287134170532, "acc": 0.9784573912620544, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.05887079983949661, "acc": 0.9870184659957886, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.08892802149057388, "acc": 0.9770484566688538, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.05925824120640755, "acc": 0.9867429137229919, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 0.08001387119293213, "acc": 0.9797993898391724, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.05896516516804695, "acc": 0.9869822859764099, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.08279529958963394, "acc": 0.9792467355728149, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.058348990976810455, "acc": 0.9870340824127197, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.07332244515419006, "acc": 0.9814956188201904, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.05520160496234894, "acc": 0.988160252571106, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.07588355988264084, "acc": 0.981732189655304, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.05732278153300285, "acc": 0.9875261783599854, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.07870157808065414, "acc": 0.9798917770385742, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.05513404682278633, "acc": 0.988194465637207, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.06919050961732864, "acc": 0.98471999168396, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.05490987002849579, "acc": 0.988090455532074, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.07116402685642242, "acc": 0.9827799201011658, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.05474735423922539, "acc": 0.9883298277854919, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.07098694890737534, "acc": 0.9835495948791504, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.05340919643640518, "acc": 0.9886529445648193, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.07338283956050873, "acc": 0.9823302626609802, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.05554954707622528, "acc": 0.9880976676940918, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.06379234790802002, "acc": 0.9851518273353577, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.05254578962922096, "acc": 0.9889056086540222, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.06656209379434586, "acc": 0.985482394695282, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.055449146777391434, "acc": 0.9879575371742249, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.06788386404514313, "acc": 0.9846855401992798, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.05325309932231903, "acc": 0.9885061979293823, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.07148801535367966, "acc": 0.9839848875999451, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.05551517382264137, "acc": 0.9877493381500244, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.06077074259519577, "acc": 0.9866364598274231, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.05282673239707947, "acc": 0.9885746836662292, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.06444855034351349, "acc": 0.9842739105224609, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.05270093306899071, "acc": 0.9886614680290222, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.07073371857404709, "acc": 0.9842467904090881, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.05271099507808685, "acc": 0.9886505007743835, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.06465723365545273, "acc": 0.9843082427978516, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.050800520926713943, "acc": 0.9892622828483582, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.06206592544913292, "acc": 0.986065685749054, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.052347294986248016, "acc": 0.9888838529586792, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.061838969588279724, "acc": 0.9859664440155029, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.05238627269864082, "acc": 0.9888515472412109, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.06887944042682648, "acc": 0.9851030707359314, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.051823776215314865, "acc": 0.989032506942749, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.05877915769815445, "acc": 0.9874061346054077, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.05112340301275253, "acc": 0.9890686869621277, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.06422297656536102, "acc": 0.9864595532417297, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.049628376960754395, "acc": 0.9894591569900513, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.06268572807312012, "acc": 0.9857731461524963, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.051450446248054504, "acc": 0.9889056086540222, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.059210628271102905, "acc": 0.9874729514122009, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.0502389520406723, "acc": 0.9893971085548401, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.057513561099767685, "acc": 0.987660825252533, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.051985207945108414, "acc": 0.9887979626655579, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.05755603685975075, "acc": 0.9876066446304321, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.051616888493299484, "acc": 0.9888424277305603, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.05966935306787491, "acc": 0.9867756962776184, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.05163982883095741, "acc": 0.9887852668762207, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.05853593721985817, "acc": 0.9871297478675842, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9627401232719421
