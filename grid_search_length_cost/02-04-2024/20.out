ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.6899722218513489, "acc": 0.5471709370613098, "length": 2.761031150817871, "mode": "train", "epoch": 1}
{"loss": 0.6446449756622314, "acc": 0.6446424126625061, "length": 2.4322917461395264, "mode": "test", "epoch": 1}
{"loss": 0.5491974353790283, "acc": 0.733376681804657, "length": 2.99285888671875, "mode": "train", "epoch": 2}
{"loss": 0.5136237740516663, "acc": 0.7456027865409851, "length": 3.3229167461395264, "mode": "test", "epoch": 2}
{"loss": 0.451127827167511, "acc": 0.8080322742462158, "length": 3.4111509323120117, "mode": "train", "epoch": 3}
{"loss": 0.4577445387840271, "acc": 0.817355751991272, "length": 3.5104167461395264, "mode": "test", "epoch": 3}
{"loss": 0.3775266110897064, "acc": 0.8449203372001648, "length": 3.618271827697754, "mode": "train", "epoch": 4}
{"loss": 0.3653637766838074, "acc": 0.851771354675293, "length": 3.855902671813965, "mode": "test", "epoch": 4}
{"loss": 0.32957544922828674, "acc": 0.8640848994255066, "length": 3.8619465827941895, "mode": "train", "epoch": 5}
{"loss": 0.34378769993782043, "acc": 0.8603869080543518, "length": 3.960069417953491, "mode": "test", "epoch": 5}
{"loss": 0.3043755888938904, "acc": 0.8772396445274353, "length": 3.923077344894409, "mode": "train", "epoch": 6}
{"loss": 0.3179559111595154, "acc": 0.8678141236305237, "length": 3.9548611640930176, "mode": "test", "epoch": 6}
{"loss": 0.28422781825065613, "acc": 0.8818614482879639, "length": 3.9440500736236572, "mode": "train", "epoch": 7}
{"loss": 0.30396386981010437, "acc": 0.8630993962287903, "length": 3.965277671813965, "mode": "test", "epoch": 7}
{"loss": 0.2710038423538208, "acc": 0.891042947769165, "length": 3.957724094390869, "mode": "train", "epoch": 8}
{"loss": 0.2930259108543396, "acc": 0.8779894113540649, "length": 3.9479167461395264, "mode": "test", "epoch": 8}
{"loss": 0.25570958852767944, "acc": 0.8987200856208801, "length": 3.96809720993042, "mode": "train", "epoch": 9}
{"loss": 0.28257372975349426, "acc": 0.8848469853401184, "length": 3.980902671813965, "mode": "test", "epoch": 9}
{"loss": 0.24686263501644135, "acc": 0.9035431742668152, "length": 3.9838411808013916, "mode": "train", "epoch": 10}
{"loss": 0.256886750459671, "acc": 0.8996500372886658, "length": 3.987847328186035, "mode": "test", "epoch": 10}
{"loss": 0.22786268591880798, "acc": 0.9114696979522705, "length": 3.9898488521575928, "mode": "train", "epoch": 11}
{"loss": 0.2683572769165039, "acc": 0.888435959815979, "length": 3.9982638359069824, "mode": "test", "epoch": 11}
{"loss": 0.21649396419525146, "acc": 0.9161078333854675, "length": 3.9921059608459473, "mode": "train", "epoch": 12}
{"loss": 0.23491130769252777, "acc": 0.9097357988357544, "length": 3.9982638359069824, "mode": "test", "epoch": 12}
{"loss": 0.20486080646514893, "acc": 0.924498975276947, "length": 3.9949188232421875, "mode": "train", "epoch": 13}
{"loss": 0.23893512785434723, "acc": 0.9084065556526184, "length": 3.9947917461395264, "mode": "test", "epoch": 13}
{"loss": 0.19347424805164337, "acc": 0.9296520948410034, "length": 3.9955859184265137, "mode": "train", "epoch": 14}
{"loss": 0.22632209956645966, "acc": 0.917881965637207, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.17775920033454895, "acc": 0.93797767162323, "length": 3.997786521911621, "mode": "train", "epoch": 15}
{"loss": 0.22596655786037445, "acc": 0.9185764789581299, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.17263196408748627, "acc": 0.9395066499710083, "length": 3.997788429260254, "mode": "train", "epoch": 16}
{"loss": 0.21021166443824768, "acc": 0.9190104603767395, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.15973497927188873, "acc": 0.944844663143158, "length": 3.9991331100463867, "mode": "train", "epoch": 17}
{"loss": 0.18745750188827515, "acc": 0.9333333969116211, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.15334439277648926, "acc": 0.9493399262428284, "length": 3.999213695526123, "mode": "train", "epoch": 18}
{"loss": 0.19558313488960266, "acc": 0.9339410066604614, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.1513480395078659, "acc": 0.9484144449234009, "length": 3.999332904815674, "mode": "train", "epoch": 19}
{"loss": 0.20966055989265442, "acc": 0.9227430820465088, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.14505544304847717, "acc": 0.9501778483390808, "length": 3.9995806217193604, "mode": "train", "epoch": 20}
{"loss": 0.17817039787769318, "acc": 0.9389757513999939, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.1362408995628357, "acc": 0.9558872580528259, "length": 3.9995310306549072, "mode": "train", "epoch": 21}
{"loss": 0.20693199336528778, "acc": 0.9276041388511658, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.12961430847644806, "acc": 0.959252655506134, "length": 3.999664545059204, "mode": "train", "epoch": 22}
{"loss": 0.17637890577316284, "acc": 0.9403645396232605, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.12488754838705063, "acc": 0.9603543281555176, "length": 3.999619483947754, "mode": "train", "epoch": 23}
{"loss": 0.17952513694763184, "acc": 0.9455728530883789, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.11825769394636154, "acc": 0.9634116888046265, "length": 3.999725818634033, "mode": "train", "epoch": 24}
{"loss": 0.15388567745685577, "acc": 0.953038215637207, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.11152423173189163, "acc": 0.9659579992294312, "length": 3.999781847000122, "mode": "train", "epoch": 25}
{"loss": 0.16612906754016876, "acc": 0.9482638239860535, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.11255492269992828, "acc": 0.9657062292098999, "length": 3.9998281002044678, "mode": "train", "epoch": 26}
{"loss": 0.15915508568286896, "acc": 0.9510416388511658, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.10672969371080399, "acc": 0.9682204127311707, "length": 3.999800205230713, "mode": "train", "epoch": 27}
{"loss": 0.14242121577262878, "acc": 0.9567708969116211, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.0979980006814003, "acc": 0.971752405166626, "length": 3.999798536300659, "mode": "train", "epoch": 28}
{"loss": 0.13566532731056213, "acc": 0.9559028148651123, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.09974796324968338, "acc": 0.9698625206947327, "length": 3.999858856201172, "mode": "train", "epoch": 29}
{"loss": 0.13689416646957397, "acc": 0.9605903625488281, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.08976580202579498, "acc": 0.9751198887825012, "length": 3.9998788833618164, "mode": "train", "epoch": 30}
{"loss": 0.1256938874721527, "acc": 0.9642360210418701, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.08474678546190262, "acc": 0.9780052900314331, "length": 3.9999160766601562, "mode": "train", "epoch": 31}
{"loss": 0.13204991817474365, "acc": 0.9626736044883728, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.08450006693601608, "acc": 0.9766214489936829, "length": 3.999937057495117, "mode": "train", "epoch": 32}
{"loss": 0.12977690994739532, "acc": 0.9623263478279114, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.0843903049826622, "acc": 0.9757710695266724, "length": 3.999884843826294, "mode": "train", "epoch": 33}
{"loss": 0.1301213949918747, "acc": 0.9589410424232483, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.08899366110563278, "acc": 0.9748119115829468, "length": 3.99991774559021, "mode": "train", "epoch": 34}
{"loss": 0.13952849805355072, "acc": 0.9550347924232483, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.0790957361459732, "acc": 0.9774125814437866, "length": 3.9999263286590576, "mode": "train", "epoch": 35}
{"loss": 0.12318726629018784, "acc": 0.9631944298744202, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.07285530120134354, "acc": 0.9810881018638611, "length": 3.9999489784240723, "mode": "train", "epoch": 36}
{"loss": 0.12608173489570618, "acc": 0.9638888835906982, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.0727197527885437, "acc": 0.9813149571418762, "length": 3.9999520778656006, "mode": "train", "epoch": 37}
{"loss": 0.1243099644780159, "acc": 0.9680556058883667, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.07127495110034943, "acc": 0.9822753667831421, "length": 3.9999473094940186, "mode": "train", "epoch": 38}
{"loss": 0.11539176851511002, "acc": 0.9722222089767456, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.07724388688802719, "acc": 0.9799869060516357, "length": 3.9999730587005615, "mode": "train", "epoch": 39}
{"loss": 0.115676149725914, "acc": 0.96875, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.07569003105163574, "acc": 0.9800977110862732, "length": 3.999912977218628, "mode": "train", "epoch": 40}
{"loss": 0.11761374026536942, "acc": 0.9703995585441589, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.07209591567516327, "acc": 0.9812590479850769, "length": 3.9999682903289795, "mode": "train", "epoch": 41}
{"loss": 0.12550076842308044, "acc": 0.96875, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.07364172488451004, "acc": 0.9810338616371155, "length": 3.9999895095825195, "mode": "train", "epoch": 42}
{"loss": 0.12093505263328552, "acc": 0.9676215648651123, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.0680488795042038, "acc": 0.9818814992904663, "length": 3.999986171722412, "mode": "train", "epoch": 43}
{"loss": 0.1076401025056839, "acc": 0.9733506441116333, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06535239517688751, "acc": 0.9843125343322754, "length": 3.9999895095825195, "mode": "train", "epoch": 44}
{"loss": 0.10534526407718658, "acc": 0.9736111760139465, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.06564406305551529, "acc": 0.9836336970329285, "length": 3.999986171722412, "mode": "train", "epoch": 45}
{"loss": 0.10775400698184967, "acc": 0.9703124165534973, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.054105062037706375, "acc": 0.9877326488494873, "length": 3.9999911785125732, "mode": "train", "epoch": 46}
{"loss": 0.09171770513057709, "acc": 0.9766494035720825, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.051451873034238815, "acc": 0.9889479279518127, "length": 3.999990224838257, "mode": "train", "epoch": 47}
{"loss": 0.09921254217624664, "acc": 0.9753472805023193, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.0507359616458416, "acc": 0.9882411360740662, "length": 3.999987840652466, "mode": "train", "epoch": 48}
{"loss": 0.10132020711898804, "acc": 0.9750867486000061, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.053032610565423965, "acc": 0.987957775592804, "length": 3.9999818801879883, "mode": "train", "epoch": 49}
{"loss": 0.08516085892915726, "acc": 0.9789063334465027, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.05257556214928627, "acc": 0.9880154132843018, "length": 3.9999945163726807, "mode": "train", "epoch": 50}
{"loss": 0.08545632660388947, "acc": 0.9790799021720886, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.05245940759778023, "acc": 0.9868283867835999, "length": 3.9999959468841553, "mode": "train", "epoch": 51}
{"loss": 0.09875663369894028, "acc": 0.9770834445953369, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.060987237840890884, "acc": 0.9830408692359924, "length": 3.9999964237213135, "mode": "train", "epoch": 52}
{"loss": 0.1313968151807785, "acc": 0.9659721851348877, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06676612049341202, "acc": 0.9827013611793518, "length": 3.9999873638153076, "mode": "train", "epoch": 53}
{"loss": 0.10984247922897339, "acc": 0.9729166030883789, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.05896811559796333, "acc": 0.9850196242332458, "length": 3.999997138977051, "mode": "train", "epoch": 54}
{"loss": 0.11442041397094727, "acc": 0.9710938334465027, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.06663171201944351, "acc": 0.981005847454071, "length": 3.9999916553497314, "mode": "train", "epoch": 55}
{"loss": 0.10076618194580078, "acc": 0.9752604365348816, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.04963997006416321, "acc": 0.9868282675743103, "length": 3.999995470046997, "mode": "train", "epoch": 56}
{"loss": 0.09225696325302124, "acc": 0.9780382513999939, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.04366925731301308, "acc": 0.9897962808609009, "length": 3.9999947547912598, "mode": "train", "epoch": 57}
{"loss": 0.09904671460390091, "acc": 0.9773437976837158, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.040233101695775986, "acc": 0.991040050983429, "length": 3.9999988079071045, "mode": "train", "epoch": 58}
{"loss": 0.08279743045568466, "acc": 0.9809896945953369, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04424932599067688, "acc": 0.9895983934402466, "length": 3.999997854232788, "mode": "train", "epoch": 59}
{"loss": 0.09070219099521637, "acc": 0.9813368320465088, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.04374951124191284, "acc": 0.9900225400924683, "length": 3.9999992847442627, "mode": "train", "epoch": 60}
{"loss": 0.08055900037288666, "acc": 0.9835938215255737, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7586718797683716
