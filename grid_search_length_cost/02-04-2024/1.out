ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.7068236470222473, "acc": 0.5203378200531006, "length": 2.422487258911133, "mode": "train", "epoch": 1}
{"loss": 0.698636531829834, "acc": 0.5215277671813965, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6827015280723572, "acc": 0.5713844895362854, "length": 1.373082160949707, "mode": "train", "epoch": 2}
{"loss": 0.6433327198028564, "acc": 0.6293781995773315, "length": 1.6631944179534912, "mode": "test", "epoch": 2}
{"loss": 0.6112786531448364, "acc": 0.6642189621925354, "length": 1.6741524934768677, "mode": "train", "epoch": 3}
{"loss": 0.6102481484413147, "acc": 0.6640326380729675, "length": 1.4340277910232544, "mode": "test", "epoch": 3}
{"loss": 0.5543296933174133, "acc": 0.7200291752815247, "length": 1.9522172212600708, "mode": "train", "epoch": 4}
{"loss": 0.5542914867401123, "acc": 0.7327067852020264, "length": 1.9826388359069824, "mode": "test", "epoch": 4}
{"loss": 0.5213457942008972, "acc": 0.7512176632881165, "length": 2.0438284873962402, "mode": "train", "epoch": 5}
{"loss": 0.5469661355018616, "acc": 0.7508218884468079, "length": 1.7951388359069824, "mode": "test", "epoch": 5}
{"loss": 0.5020185112953186, "acc": 0.7662185430526733, "length": 2.1786797046661377, "mode": "train", "epoch": 6}
{"loss": 0.5550581216812134, "acc": 0.7269747853279114, "length": 1.8611111640930176, "mode": "test", "epoch": 6}
{"loss": 0.4826916754245758, "acc": 0.7771720290184021, "length": 2.293015718460083, "mode": "train", "epoch": 7}
{"loss": 0.5140358209609985, "acc": 0.7627929449081421, "length": 2.163194417953491, "mode": "test", "epoch": 7}
{"loss": 0.44791093468666077, "acc": 0.8055403828620911, "length": 2.698533773422241, "mode": "train", "epoch": 8}
{"loss": 0.45565885305404663, "acc": 0.8016899824142456, "length": 2.574652671813965, "mode": "test", "epoch": 8}
{"loss": 0.4101625978946686, "acc": 0.8281266093254089, "length": 2.9445626735687256, "mode": "train", "epoch": 9}
{"loss": 0.41711270809173584, "acc": 0.8232476115226746, "length": 2.7864582538604736, "mode": "test", "epoch": 9}
{"loss": 0.3794418275356293, "acc": 0.8407915830612183, "length": 3.051935911178589, "mode": "train", "epoch": 10}
{"loss": 0.4139452278614044, "acc": 0.8183892369270325, "length": 3.133680582046509, "mode": "test", "epoch": 10}
{"loss": 0.34569185972213745, "acc": 0.8584063649177551, "length": 3.1673738956451416, "mode": "train", "epoch": 11}
{"loss": 0.3611197769641876, "acc": 0.8597683310508728, "length": 2.960069417953491, "mode": "test", "epoch": 11}
{"loss": 0.31575146317481995, "acc": 0.8766978979110718, "length": 3.247105360031128, "mode": "train", "epoch": 12}
{"loss": 0.34630823135375977, "acc": 0.8658908605575562, "length": 3.100694417953491, "mode": "test", "epoch": 12}
{"loss": 0.29861146211624146, "acc": 0.8853388428688049, "length": 3.3514633178710938, "mode": "train", "epoch": 13}
{"loss": 0.33003324270248413, "acc": 0.869607150554657, "length": 3.355902671813965, "mode": "test", "epoch": 13}
{"loss": 0.27516087889671326, "acc": 0.894919216632843, "length": 3.4892005920410156, "mode": "train", "epoch": 14}
{"loss": 0.3171813189983368, "acc": 0.8774577379226685, "length": 3.246527671813965, "mode": "test", "epoch": 14}
{"loss": 0.2589823305606842, "acc": 0.9044355154037476, "length": 3.606663227081299, "mode": "train", "epoch": 15}
{"loss": 0.3267304599285126, "acc": 0.8761475086212158, "length": 3.350694417953491, "mode": "test", "epoch": 15}
{"loss": 0.24414882063865662, "acc": 0.9121177792549133, "length": 3.6809980869293213, "mode": "train", "epoch": 16}
{"loss": 0.2926197946071625, "acc": 0.8863389492034912, "length": 3.6111111640930176, "mode": "test", "epoch": 16}
{"loss": 0.2278217077255249, "acc": 0.919918954372406, "length": 3.9017672538757324, "mode": "train", "epoch": 17}
{"loss": 0.32608896493911743, "acc": 0.8829590082168579, "length": 3.774305582046509, "mode": "test", "epoch": 17}
{"loss": 0.21223518252372742, "acc": 0.9282456040382385, "length": 3.977876663208008, "mode": "train", "epoch": 18}
{"loss": 0.29013192653656006, "acc": 0.8931342363357544, "length": 3.8020832538604736, "mode": "test", "epoch": 18}
{"loss": 0.2024613618850708, "acc": 0.9312386512756348, "length": 4.051741123199463, "mode": "train", "epoch": 19}
{"loss": 0.2916831076145172, "acc": 0.8861734867095947, "length": 3.9513888359069824, "mode": "test", "epoch": 19}
{"loss": 0.19177450239658356, "acc": 0.9373005032539368, "length": 4.127268314361572, "mode": "train", "epoch": 20}
{"loss": 0.25502240657806396, "acc": 0.9091064929962158, "length": 4.036458492279053, "mode": "test", "epoch": 20}
{"loss": 0.18229202926158905, "acc": 0.9414336085319519, "length": 4.175758361816406, "mode": "train", "epoch": 21}
{"loss": 0.269476056098938, "acc": 0.8997070789337158, "length": 4.239583492279053, "mode": "test", "epoch": 21}
{"loss": 0.17318706214427948, "acc": 0.9461066722869873, "length": 4.270867347717285, "mode": "train", "epoch": 22}
{"loss": 0.2750447988510132, "acc": 0.905292272567749, "length": 4.25, "mode": "test", "epoch": 22}
{"loss": 0.16033980250358582, "acc": 0.9526240229606628, "length": 4.251497745513916, "mode": "train", "epoch": 23}
{"loss": 0.24763379991054535, "acc": 0.9090088605880737, "length": 4.128472328186035, "mode": "test", "epoch": 23}
{"loss": 0.1570049226284027, "acc": 0.9525736570358276, "length": 4.2884955406188965, "mode": "train", "epoch": 24}
{"loss": 0.2286662757396698, "acc": 0.9201743006706238, "length": 4.192708492279053, "mode": "test", "epoch": 24}
{"loss": 0.14485310018062592, "acc": 0.9586847424507141, "length": 4.296781539916992, "mode": "train", "epoch": 25}
{"loss": 0.21970778703689575, "acc": 0.9309841990470886, "length": 4.373263835906982, "mode": "test", "epoch": 25}
{"loss": 0.1316135674715042, "acc": 0.9638451337814331, "length": 4.282751083374023, "mode": "train", "epoch": 26}
{"loss": 0.21182501316070557, "acc": 0.9306532740592957, "length": 4.50694465637207, "mode": "test", "epoch": 26}
{"loss": 0.1322145313024521, "acc": 0.9635292291641235, "length": 4.40273380279541, "mode": "train", "epoch": 27}
{"loss": 0.20728710293769836, "acc": 0.9373941421508789, "length": 4.223958492279053, "mode": "test", "epoch": 27}
{"loss": 0.12452647089958191, "acc": 0.9667359590530396, "length": 4.397696018218994, "mode": "train", "epoch": 28}
{"loss": 0.18100248277187347, "acc": 0.9428277611732483, "length": 4.203125, "mode": "test", "epoch": 28}
{"loss": 0.11530616134405136, "acc": 0.9708544611930847, "length": 4.309226036071777, "mode": "train", "epoch": 29}
{"loss": 0.16724494099617004, "acc": 0.9500027894973755, "length": 4.30381965637207, "mode": "test", "epoch": 29}
{"loss": 0.11070381850004196, "acc": 0.9718810319900513, "length": 4.430328845977783, "mode": "train", "epoch": 30}
{"loss": 0.1673242449760437, "acc": 0.9498074054718018, "length": 4.338541507720947, "mode": "test", "epoch": 30}
{"loss": 0.10330592840909958, "acc": 0.974615216255188, "length": 4.399628639221191, "mode": "train", "epoch": 31}
{"loss": 0.1552286297082901, "acc": 0.9546767473220825, "length": 4.385416507720947, "mode": "test", "epoch": 31}
{"loss": 0.0974082350730896, "acc": 0.977821409702301, "length": 4.441431999206543, "mode": "train", "epoch": 32}
{"loss": 0.15249739587306976, "acc": 0.9557345509529114, "length": 4.30381965637207, "mode": "test", "epoch": 32}
{"loss": 0.09070095419883728, "acc": 0.9812772870063782, "length": 4.445296287536621, "mode": "train", "epoch": 33}
{"loss": 0.1437838077545166, "acc": 0.9608263373374939, "length": 4.39756965637207, "mode": "test", "epoch": 33}
{"loss": 0.09271004796028137, "acc": 0.979016125202179, "length": 4.459228515625, "mode": "train", "epoch": 34}
{"loss": 0.1405106484889984, "acc": 0.9619140625, "length": 4.34375, "mode": "test", "epoch": 34}
{"loss": 0.08562973141670227, "acc": 0.9819211363792419, "length": 4.430401802062988, "mode": "train", "epoch": 35}
{"loss": 0.15412206947803497, "acc": 0.9607475996017456, "length": 4.46180534362793, "mode": "test", "epoch": 35}
{"loss": 0.08345530182123184, "acc": 0.9815361499786377, "length": 4.550327301025391, "mode": "train", "epoch": 36}
{"loss": 0.13760799169540405, "acc": 0.9592583775520325, "length": 4.4375, "mode": "test", "epoch": 36}
{"loss": 0.08124905824661255, "acc": 0.9832941293716431, "length": 4.544669151306152, "mode": "train", "epoch": 37}
{"loss": 0.14113064110279083, "acc": 0.9645805358886719, "length": 4.541666507720947, "mode": "test", "epoch": 37}
{"loss": 0.0848594531416893, "acc": 0.9813632369041443, "length": 4.547393321990967, "mode": "train", "epoch": 38}
{"loss": 0.140376016497612, "acc": 0.9655166268348694, "length": 4.548611164093018, "mode": "test", "epoch": 38}
{"loss": 0.07506001740694046, "acc": 0.986072301864624, "length": 4.53038215637207, "mode": "train", "epoch": 39}
{"loss": 0.13957533240318298, "acc": 0.9668674468994141, "length": 4.55555534362793, "mode": "test", "epoch": 39}
{"loss": 0.07277002930641174, "acc": 0.987021803855896, "length": 4.503809928894043, "mode": "train", "epoch": 40}
{"loss": 0.13066288828849792, "acc": 0.9688774943351746, "length": 4.52256965637207, "mode": "test", "epoch": 40}
{"loss": 0.0723707526922226, "acc": 0.9870119094848633, "length": 4.541051387786865, "mode": "train", "epoch": 41}
{"loss": 0.11416145414113998, "acc": 0.9735486507415771, "length": 4.494791507720947, "mode": "test", "epoch": 41}
{"loss": 0.069537453353405, "acc": 0.9859834909439087, "length": 4.537557125091553, "mode": "train", "epoch": 42}
{"loss": 0.13519063591957092, "acc": 0.9691487550735474, "length": 4.505208492279053, "mode": "test", "epoch": 42}
{"loss": 0.06086226925253868, "acc": 0.9894120693206787, "length": 4.519496440887451, "mode": "train", "epoch": 43}
{"loss": 0.11566277593374252, "acc": 0.9746744632720947, "length": 4.453125, "mode": "test", "epoch": 43}
{"loss": 0.0643685981631279, "acc": 0.9888965487480164, "length": 4.442264556884766, "mode": "train", "epoch": 44}
{"loss": 0.12698592245578766, "acc": 0.9650661945343018, "length": 4.401041507720947, "mode": "test", "epoch": 44}
{"loss": 0.06410576403141022, "acc": 0.9888288974761963, "length": 4.457324028015137, "mode": "train", "epoch": 45}
{"loss": 0.09833026677370071, "acc": 0.9760443568229675, "length": 4.480902671813965, "mode": "test", "epoch": 45}
{"loss": 0.0615466870367527, "acc": 0.988945722579956, "length": 4.457969665527344, "mode": "train", "epoch": 46}
{"loss": 0.09468543529510498, "acc": 0.9786269068717957, "length": 4.447916507720947, "mode": "test", "epoch": 46}
{"loss": 0.06167038530111313, "acc": 0.9888626337051392, "length": 4.453973293304443, "mode": "train", "epoch": 47}
{"loss": 0.1160232350230217, "acc": 0.9725124835968018, "length": 4.472222328186035, "mode": "test", "epoch": 47}
{"loss": 0.062202874571084976, "acc": 0.9893784523010254, "length": 4.425993919372559, "mode": "train", "epoch": 48}
{"loss": 0.12536150217056274, "acc": 0.9730061292648315, "length": 4.454861164093018, "mode": "test", "epoch": 48}
{"loss": 0.05090479552745819, "acc": 0.9931489825248718, "length": 4.44161319732666, "mode": "train", "epoch": 49}
{"loss": 0.09555813670158386, "acc": 0.9798069000244141, "length": 4.38368034362793, "mode": "test", "epoch": 49}
{"loss": 0.049816571176052094, "acc": 0.9937302470207214, "length": 4.422701358795166, "mode": "train", "epoch": 50}
{"loss": 0.09078580886125565, "acc": 0.9837917685508728, "length": 4.46006965637207, "mode": "test", "epoch": 50}
{"loss": 0.04860555753111839, "acc": 0.9940768480300903, "length": 4.38615083694458, "mode": "train", "epoch": 51}
{"loss": 0.10898429155349731, "acc": 0.9783340096473694, "length": 4.359375, "mode": "test", "epoch": 51}
{"loss": 0.04724600166082382, "acc": 0.9939640760421753, "length": 4.389376163482666, "mode": "train", "epoch": 52}
{"loss": 0.10083749890327454, "acc": 0.9817654490470886, "length": 4.387152671813965, "mode": "test", "epoch": 52}
{"loss": 0.04466954991221428, "acc": 0.9947556853294373, "length": 4.368593215942383, "mode": "train", "epoch": 53}
{"loss": 0.09136886894702911, "acc": 0.9864691495895386, "length": 4.440972328186035, "mode": "test", "epoch": 53}
{"loss": 0.04556793347001076, "acc": 0.9947965741157532, "length": 4.379148006439209, "mode": "train", "epoch": 54}
{"loss": 0.08646182715892792, "acc": 0.9863037467002869, "length": 4.378472328186035, "mode": "test", "epoch": 54}
{"loss": 0.048269376158714294, "acc": 0.9940362572669983, "length": 4.339762210845947, "mode": "train", "epoch": 55}
{"loss": 0.08879809081554413, "acc": 0.9829019904136658, "length": 4.329861164093018, "mode": "test", "epoch": 55}
{"loss": 0.055276092141866684, "acc": 0.990079939365387, "length": 4.349099159240723, "mode": "train", "epoch": 56}
{"loss": 0.13173288106918335, "acc": 0.9726291298866272, "length": 4.427083492279053, "mode": "test", "epoch": 56}
{"loss": 0.05653664469718933, "acc": 0.9910207986831665, "length": 4.450153827667236, "mode": "train", "epoch": 57}
{"loss": 0.0936768427491188, "acc": 0.9806315898895264, "length": 4.333333492279053, "mode": "test", "epoch": 57}
{"loss": 0.04991961643099785, "acc": 0.9925170540809631, "length": 4.366543292999268, "mode": "train", "epoch": 58}
{"loss": 0.08923283219337463, "acc": 0.9855116605758667, "length": 4.42881965637207, "mode": "test", "epoch": 58}
{"loss": 0.04535375162959099, "acc": 0.9939132928848267, "length": 4.346856594085693, "mode": "train", "epoch": 59}
{"loss": 0.09108857065439224, "acc": 0.9846083521842957, "length": 4.411458492279053, "mode": "test", "epoch": 59}
{"loss": 0.046249404549598694, "acc": 0.9937101602554321, "length": 4.43427848815918, "mode": "train", "epoch": 60}
{"loss": 0.08911534398794174, "acc": 0.9826931357383728, "length": 4.421875, "mode": "test", "epoch": 60}
test accuracy: 0.8013203144073486
