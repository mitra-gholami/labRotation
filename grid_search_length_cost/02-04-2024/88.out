ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.30175745487213135, "acc": 0.8738819360733032, "length": 9.92988395690918, "mode": "train", "epoch": 1}
{"loss": 0.2369522750377655, "acc": 0.9186163544654846, "length": 11.215832710266113, "mode": "test", "epoch": 1}
{"loss": 0.16470295190811157, "acc": 0.9516796469688416, "length": 11.310980796813965, "mode": "train", "epoch": 2}
{"loss": 0.18118461966514587, "acc": 0.9391621351242065, "length": 9.658527374267578, "mode": "test", "epoch": 2}
{"loss": 0.11951354891061783, "acc": 0.9697685837745667, "length": 11.740557670593262, "mode": "train", "epoch": 3}
{"loss": 0.1546458899974823, "acc": 0.9522188305854797, "length": 11.526134490966797, "mode": "test", "epoch": 3}
{"loss": 0.08282240480184555, "acc": 0.9805857539176941, "length": 11.622762680053711, "mode": "train", "epoch": 4}
{"loss": 0.1379653960466385, "acc": 0.9566187262535095, "length": 12.744245529174805, "mode": "test", "epoch": 4}
{"loss": 0.05389254912734032, "acc": 0.9879254698753357, "length": 11.822071075439453, "mode": "train", "epoch": 5}
{"loss": 0.11351227760314941, "acc": 0.9641488790512085, "length": 11.186421394348145, "mode": "test", "epoch": 5}
{"loss": 0.028553400188684464, "acc": 0.9951475262641907, "length": 11.711494445800781, "mode": "train", "epoch": 6}
{"loss": 0.06349749118089676, "acc": 0.98270583152771, "length": 11.175751686096191, "mode": "test", "epoch": 6}
{"loss": 0.02093486301600933, "acc": 0.9971750378608704, "length": 11.316104888916016, "mode": "train", "epoch": 7}
{"loss": 0.061584316194057465, "acc": 0.9850786924362183, "length": 10.777214050292969, "mode": "test", "epoch": 7}
{"loss": 0.01702817901968956, "acc": 0.9978775978088379, "length": 11.032705307006836, "mode": "train", "epoch": 8}
{"loss": 0.05471625179052353, "acc": 0.9852188229560852, "length": 10.584439277648926, "mode": "test", "epoch": 8}
{"loss": 0.014755691401660442, "acc": 0.9983453750610352, "length": 10.603852272033691, "mode": "train", "epoch": 9}
{"loss": 0.029444007202982903, "acc": 0.9936097860336304, "length": 10.294676780700684, "mode": "test", "epoch": 9}
{"loss": 0.013375832699239254, "acc": 0.9985628724098206, "length": 10.447637557983398, "mode": "train", "epoch": 10}
{"loss": 0.03847843036055565, "acc": 0.9902701377868652, "length": 9.446930885314941, "mode": "test", "epoch": 10}
{"loss": 0.01390452403575182, "acc": 0.9984488487243652, "length": 10.451143264770508, "mode": "train", "epoch": 11}
{"loss": 0.02845434844493866, "acc": 0.9936429858207703, "length": 10.084918022155762, "mode": "test", "epoch": 11}
{"loss": 0.011246285401284695, "acc": 0.9989181756973267, "length": 10.159192085266113, "mode": "train", "epoch": 12}
{"loss": 0.04473753646016121, "acc": 0.98809814453125, "length": 9.111652374267578, "mode": "test", "epoch": 12}
{"loss": 0.01149709802120924, "acc": 0.998786449432373, "length": 9.6305513381958, "mode": "train", "epoch": 13}
{"loss": 0.05469261854887009, "acc": 0.9865955114364624, "length": 10.592711448669434, "mode": "test", "epoch": 13}
{"loss": 0.012243546545505524, "acc": 0.9985137581825256, "length": 9.39161491394043, "mode": "train", "epoch": 14}
{"loss": 0.02274509333074093, "acc": 0.9956337213516235, "length": 9.07548713684082, "mode": "test", "epoch": 14}
{"loss": 0.010875885374844074, "acc": 0.9988020658493042, "length": 9.850931167602539, "mode": "train", "epoch": 15}
{"loss": 0.023802433162927628, "acc": 0.9953656196594238, "length": 9.835917472839355, "mode": "test", "epoch": 15}
{"loss": 0.011281386949121952, "acc": 0.9986670017242432, "length": 9.438218116760254, "mode": "train", "epoch": 16}
{"loss": 0.01871354691684246, "acc": 0.9967451691627502, "length": 8.812220573425293, "mode": "test", "epoch": 16}
{"loss": 0.010858749970793724, "acc": 0.9988090991973877, "length": 9.337013244628906, "mode": "train", "epoch": 17}
{"loss": 0.023448292165994644, "acc": 0.9952020049095154, "length": 10.952885627746582, "mode": "test", "epoch": 17}
{"loss": 0.010132165625691414, "acc": 0.9990270137786865, "length": 9.576713562011719, "mode": "train", "epoch": 18}
{"loss": 0.011205652728676796, "acc": 0.9985648393630981, "length": 9.0848388671875, "mode": "test", "epoch": 18}
{"loss": 0.009436083026230335, "acc": 0.9990594387054443, "length": 8.789759635925293, "mode": "train", "epoch": 19}
{"loss": 0.015242844820022583, "acc": 0.9980958104133606, "length": 8.359535217285156, "mode": "test", "epoch": 19}
{"loss": 0.009359322488307953, "acc": 0.9990989565849304, "length": 9.107409477233887, "mode": "train", "epoch": 20}
{"loss": 0.011166529729962349, "acc": 0.998818576335907, "length": 9.08296012878418, "mode": "test", "epoch": 20}
{"loss": 0.008606771938502789, "acc": 0.9992912411689758, "length": 9.321048736572266, "mode": "train", "epoch": 21}
{"loss": 0.014118099585175514, "acc": 0.998262345790863, "length": 9.607576370239258, "mode": "test", "epoch": 21}
{"loss": 0.01078369002789259, "acc": 0.9988778829574585, "length": 10.351768493652344, "mode": "train", "epoch": 22}
{"loss": 0.014596584253013134, "acc": 0.9974992871284485, "length": 10.47618293762207, "mode": "test", "epoch": 22}
{"loss": 0.009746837429702282, "acc": 0.9992126226425171, "length": 10.611515998840332, "mode": "train", "epoch": 23}
{"loss": 0.013659276999533176, "acc": 0.9983490705490112, "length": 10.071571350097656, "mode": "test", "epoch": 23}
{"loss": 0.010203935205936432, "acc": 0.9990770220756531, "length": 10.503852844238281, "mode": "train", "epoch": 24}
{"loss": 0.015883389860391617, "acc": 0.9980354309082031, "length": 10.275455474853516, "mode": "test", "epoch": 24}
{"loss": 0.008551948703825474, "acc": 0.9993829131126404, "length": 10.157907485961914, "mode": "train", "epoch": 25}
{"loss": 0.016393084079027176, "acc": 0.9975666403770447, "length": 11.014785766601562, "mode": "test", "epoch": 25}
{"loss": 0.010330338031053543, "acc": 0.9990109801292419, "length": 10.452051162719727, "mode": "train", "epoch": 26}
{"loss": 0.01268151868134737, "acc": 0.9986387491226196, "length": 9.822250366210938, "mode": "test", "epoch": 26}
{"loss": 0.010677237994968891, "acc": 0.9988900423049927, "length": 10.324884414672852, "mode": "train", "epoch": 27}
{"loss": 0.013919523917138577, "acc": 0.9982979893684387, "length": 9.931785583496094, "mode": "test", "epoch": 27}
{"loss": 0.008778483606874943, "acc": 0.9992581605911255, "length": 10.001737594604492, "mode": "train", "epoch": 28}
{"loss": 0.012757627293467522, "acc": 0.9985113739967346, "length": 9.913482666015625, "mode": "test", "epoch": 28}
{"loss": 0.008795672096312046, "acc": 0.9992642998695374, "length": 10.114169120788574, "mode": "train", "epoch": 29}
{"loss": 0.01295135822147131, "acc": 0.998589038848877, "length": 10.059303283691406, "mode": "test", "epoch": 29}
{"loss": 0.009213035926222801, "acc": 0.9991223812103271, "length": 9.325052261352539, "mode": "train", "epoch": 30}
{"loss": 0.026402389630675316, "acc": 0.9955583214759827, "length": 8.863651275634766, "mode": "test", "epoch": 30}
{"loss": 0.010949661023914814, "acc": 0.9986382722854614, "length": 9.302277565002441, "mode": "train", "epoch": 31}
{"loss": 0.00941998977214098, "acc": 0.9992520213127136, "length": 9.622002601623535, "mode": "test", "epoch": 31}
{"loss": 0.008796924725174904, "acc": 0.9991650581359863, "length": 9.211658477783203, "mode": "train", "epoch": 32}
{"loss": 0.00961373932659626, "acc": 0.999208390712738, "length": 9.30242919921875, "mode": "test", "epoch": 32}
{"loss": 0.010950621217489243, "acc": 0.9985654354095459, "length": 9.251871109008789, "mode": "train", "epoch": 33}
{"loss": 0.013141696341335773, "acc": 0.9985038042068481, "length": 9.199408531188965, "mode": "test", "epoch": 33}
{"loss": 0.008740645833313465, "acc": 0.9991488456726074, "length": 8.94062328338623, "mode": "train", "epoch": 34}
{"loss": 0.01898138038814068, "acc": 0.9969078302383423, "length": 8.31933307647705, "mode": "test", "epoch": 34}
{"loss": 0.007667836733162403, "acc": 0.9993626475334167, "length": 8.684651374816895, "mode": "train", "epoch": 35}
{"loss": 0.009167386218905449, "acc": 0.999144434928894, "length": 8.387948036193848, "mode": "test", "epoch": 35}
{"loss": 0.011481910943984985, "acc": 0.9985119700431824, "length": 9.524184226989746, "mode": "train", "epoch": 36}
{"loss": 0.017266178503632545, "acc": 0.9974402785301208, "length": 9.044636726379395, "mode": "test", "epoch": 36}
{"loss": 0.00895671732723713, "acc": 0.9991134405136108, "length": 8.649740219116211, "mode": "train", "epoch": 37}
{"loss": 0.015476679429411888, "acc": 0.9981054663658142, "length": 8.565457344055176, "mode": "test", "epoch": 37}
{"loss": 0.01039828360080719, "acc": 0.9987624883651733, "length": 8.958081245422363, "mode": "train", "epoch": 38}
{"loss": 0.010715263895690441, "acc": 0.9987823963165283, "length": 9.034846305847168, "mode": "test", "epoch": 38}
{"loss": 0.00936588179320097, "acc": 0.9990555047988892, "length": 9.036687850952148, "mode": "train", "epoch": 39}
{"loss": 0.010278704576194286, "acc": 0.9988259077072144, "length": 8.711596488952637, "mode": "test", "epoch": 39}
{"loss": 0.008497112430632114, "acc": 0.9992166757583618, "length": 9.064342498779297, "mode": "train", "epoch": 40}
{"loss": 0.011748048476874828, "acc": 0.9986465573310852, "length": 8.436540603637695, "mode": "test", "epoch": 40}
{"loss": 0.008450677618384361, "acc": 0.999244213104248, "length": 8.83815860748291, "mode": "train", "epoch": 41}
{"loss": 0.009162722155451775, "acc": 0.9992708563804626, "length": 8.708399772644043, "mode": "test", "epoch": 41}
{"loss": 0.007770643103867769, "acc": 0.9993530511856079, "length": 8.661232948303223, "mode": "train", "epoch": 42}
{"loss": 0.008667628280818462, "acc": 0.9992497563362122, "length": 8.631513595581055, "mode": "test", "epoch": 42}
{"loss": 0.01080949604511261, "acc": 0.9986774325370789, "length": 9.388813972473145, "mode": "train", "epoch": 43}
{"loss": 0.010424845851957798, "acc": 0.9990919828414917, "length": 9.75747299194336, "mode": "test", "epoch": 43}
{"loss": 0.008349335752427578, "acc": 0.9992854595184326, "length": 9.358922004699707, "mode": "train", "epoch": 44}
{"loss": 0.01018611155450344, "acc": 0.9990257024765015, "length": 10.032249450683594, "mode": "test", "epoch": 44}
{"loss": 0.008135084994137287, "acc": 0.9992976188659668, "length": 9.17747688293457, "mode": "train", "epoch": 45}
{"loss": 0.010385743342339993, "acc": 0.9988977909088135, "length": 8.869484901428223, "mode": "test", "epoch": 45}
{"loss": 0.008243133313953876, "acc": 0.9991999268531799, "length": 8.72085952758789, "mode": "train", "epoch": 46}
{"loss": 0.009411869570612907, "acc": 0.9990711212158203, "length": 8.491168022155762, "mode": "test", "epoch": 46}
{"loss": 0.006935145705938339, "acc": 0.9995232820510864, "length": 8.711124420166016, "mode": "train", "epoch": 47}
{"loss": 0.008555123582482338, "acc": 0.9993534088134766, "length": 8.697410583496094, "mode": "test", "epoch": 47}
{"loss": 0.009940249845385551, "acc": 0.9989144206047058, "length": 8.722867012023926, "mode": "train", "epoch": 48}
{"loss": 0.008060197345912457, "acc": 0.9995217323303223, "length": 8.658008575439453, "mode": "test", "epoch": 48}
{"loss": 0.008000080473721027, "acc": 0.9993166327476501, "length": 8.67794418334961, "mode": "train", "epoch": 49}
{"loss": 0.008730408735573292, "acc": 0.9992592930793762, "length": 8.472546577453613, "mode": "test", "epoch": 49}
{"loss": 0.23103852570056915, "acc": 0.8833103179931641, "length": 14.239612579345703, "mode": "train", "epoch": 50}
{"loss": 0.542834997177124, "acc": 0.6999640464782715, "length": 21.0, "mode": "test", "epoch": 50}
{"loss": 0.508150577545166, "acc": 0.7351435422897339, "length": 20.999418258666992, "mode": "train", "epoch": 51}
{"loss": 0.5207007527351379, "acc": 0.7299333214759827, "length": 21.0, "mode": "test", "epoch": 51}
{"loss": 0.4869164228439331, "acc": 0.7578686475753784, "length": 21.0, "mode": "train", "epoch": 52}
{"loss": 0.5075675845146179, "acc": 0.7558324337005615, "length": 21.0, "mode": "test", "epoch": 52}
{"loss": 0.4542849063873291, "acc": 0.7850748896598816, "length": 20.999929428100586, "mode": "train", "epoch": 53}
{"loss": 0.45715680718421936, "acc": 0.7861013412475586, "length": 21.0, "mode": "test", "epoch": 53}
{"loss": 0.4046443998813629, "acc": 0.8232104182243347, "length": 20.999969482421875, "mode": "train", "epoch": 54}
{"loss": 0.3792057931423187, "acc": 0.8399855494499207, "length": 21.0, "mode": "test", "epoch": 54}
{"loss": 0.3332487940788269, "acc": 0.8676683902740479, "length": 20.9999942779541, "mode": "train", "epoch": 55}
{"loss": 0.3176536560058594, "acc": 0.8769142627716064, "length": 21.0, "mode": "test", "epoch": 55}
{"loss": 0.29018765687942505, "acc": 0.8865390419960022, "length": 20.99996566772461, "mode": "train", "epoch": 56}
{"loss": 0.29719045758247375, "acc": 0.8853562474250793, "length": 21.0, "mode": "test", "epoch": 56}
{"loss": 0.2611754536628723, "acc": 0.9012137651443481, "length": 20.99932098388672, "mode": "train", "epoch": 57}
{"loss": 0.27740806341171265, "acc": 0.8945611715316772, "length": 21.0, "mode": "test", "epoch": 57}
{"loss": 0.2513503432273865, "acc": 0.9054957628250122, "length": 20.99972915649414, "mode": "train", "epoch": 58}
{"loss": 0.2789994478225708, "acc": 0.8912525773048401, "length": 20.99924087524414, "mode": "test", "epoch": 58}
{"loss": 0.24546301364898682, "acc": 0.90705406665802, "length": 20.999635696411133, "mode": "train", "epoch": 59}
{"loss": 0.26275670528411865, "acc": 0.9013546705245972, "length": 21.0, "mode": "test", "epoch": 59}
{"loss": 0.2557130455970764, "acc": 0.9021651744842529, "length": 20.999914169311523, "mode": "train", "epoch": 60}
{"loss": 0.2975444793701172, "acc": 0.8810182809829712, "length": 21.0, "mode": "test", "epoch": 60}
test accuracy: 0.8659365177154541
