ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.6894373893737793, "acc": 0.544994056224823, "length": 3.949345827102661, "mode": "train", "epoch": 1}
{"loss": 0.6633507013320923, "acc": 0.6216579675674438, "length": 2.527777671813965, "mode": "test", "epoch": 1}
{"loss": 0.6031252145767212, "acc": 0.6731871962547302, "length": 3.0211963653564453, "mode": "train", "epoch": 2}
{"loss": 0.6071410775184631, "acc": 0.6841010451316833, "length": 2.147569417953491, "mode": "test", "epoch": 2}
{"loss": 0.5139830112457275, "acc": 0.7611541748046875, "length": 3.3287513256073, "mode": "train", "epoch": 3}
{"loss": 0.5214188098907471, "acc": 0.7543403506278992, "length": 2.6770832538604736, "mode": "test", "epoch": 3}
{"loss": 0.4363681972026825, "acc": 0.8074256181716919, "length": 3.8256237506866455, "mode": "train", "epoch": 4}
{"loss": 0.4385169446468353, "acc": 0.8091552257537842, "length": 3.883680582046509, "mode": "test", "epoch": 4}
{"loss": 0.3593682050704956, "acc": 0.8476224541664124, "length": 5.298276901245117, "mode": "train", "epoch": 5}
{"loss": 0.3762803077697754, "acc": 0.8369547724723816, "length": 5.739583492279053, "mode": "test", "epoch": 5}
{"loss": 0.3012901246547699, "acc": 0.8749498128890991, "length": 6.604879856109619, "mode": "train", "epoch": 6}
{"loss": 0.3569878041744232, "acc": 0.8456407189369202, "length": 7.192708492279053, "mode": "test", "epoch": 6}
{"loss": 0.26973891258239746, "acc": 0.8939505219459534, "length": 7.070552825927734, "mode": "train", "epoch": 7}
{"loss": 0.32161247730255127, "acc": 0.8700492978096008, "length": 7.088541507720947, "mode": "test", "epoch": 7}
{"loss": 0.2416698932647705, "acc": 0.9069437980651855, "length": 8.21161937713623, "mode": "train", "epoch": 8}
{"loss": 0.32643914222717285, "acc": 0.8729031085968018, "length": 8.621527671813965, "mode": "test", "epoch": 8}
{"loss": 0.22311902046203613, "acc": 0.9191889762878418, "length": 9.09587287902832, "mode": "train", "epoch": 9}
{"loss": 0.30431804060935974, "acc": 0.8760850429534912, "length": 9.956597328186035, "mode": "test", "epoch": 9}
{"loss": 0.2125847339630127, "acc": 0.9257029294967651, "length": 9.499332427978516, "mode": "train", "epoch": 10}
{"loss": 0.28609487414360046, "acc": 0.8921820521354675, "length": 9.67881965637207, "mode": "test", "epoch": 10}
{"loss": 0.19804884493350983, "acc": 0.9323517084121704, "length": 9.783443450927734, "mode": "train", "epoch": 11}
{"loss": 0.30388209223747253, "acc": 0.8928168416023254, "length": 9.890625, "mode": "test", "epoch": 11}
{"loss": 0.18471254408359528, "acc": 0.9389951229095459, "length": 9.867480278015137, "mode": "train", "epoch": 12}
{"loss": 0.28721773624420166, "acc": 0.8895533680915833, "length": 10.27430534362793, "mode": "test", "epoch": 12}
{"loss": 0.18097561597824097, "acc": 0.9410731196403503, "length": 10.001208305358887, "mode": "train", "epoch": 13}
{"loss": 0.26139575242996216, "acc": 0.9058594107627869, "length": 10.229166984558105, "mode": "test", "epoch": 13}
{"loss": 0.16816642880439758, "acc": 0.945435643196106, "length": 10.083799362182617, "mode": "train", "epoch": 14}
{"loss": 0.24196597933769226, "acc": 0.9045844674110413, "length": 10.24305534362793, "mode": "test", "epoch": 14}
{"loss": 0.16093076765537262, "acc": 0.9475677609443665, "length": 10.174253463745117, "mode": "train", "epoch": 15}
{"loss": 0.22859470546245575, "acc": 0.9257487058639526, "length": 10.223958015441895, "mode": "test", "epoch": 15}
{"loss": 0.1431579887866974, "acc": 0.9562557339668274, "length": 10.290809631347656, "mode": "train", "epoch": 16}
{"loss": 0.2120845466852188, "acc": 0.9225722551345825, "length": 10.505208015441895, "mode": "test", "epoch": 16}
{"loss": 0.13339383900165558, "acc": 0.9578133821487427, "length": 10.284266471862793, "mode": "train", "epoch": 17}
{"loss": 0.20768269896507263, "acc": 0.9274956583976746, "length": 10.390625, "mode": "test", "epoch": 17}
{"loss": 0.12239496409893036, "acc": 0.9635075330734253, "length": 10.420177459716797, "mode": "train", "epoch": 18}
{"loss": 0.18494680523872375, "acc": 0.9368733167648315, "length": 10.559027671813965, "mode": "test", "epoch": 18}
{"loss": 0.11519429832696915, "acc": 0.9647117853164673, "length": 10.456748962402344, "mode": "train", "epoch": 19}
{"loss": 0.17422853410243988, "acc": 0.9379990696907043, "length": 10.65625, "mode": "test", "epoch": 19}
{"loss": 0.10875874012708664, "acc": 0.966162919998169, "length": 10.49299144744873, "mode": "train", "epoch": 20}
{"loss": 0.18637770414352417, "acc": 0.9324219822883606, "length": 10.48263931274414, "mode": "test", "epoch": 20}
{"loss": 0.10008758306503296, "acc": 0.970318615436554, "length": 10.565223693847656, "mode": "train", "epoch": 21}
{"loss": 0.15592853724956512, "acc": 0.9491454362869263, "length": 10.65625, "mode": "test", "epoch": 21}
{"loss": 0.08777967840433121, "acc": 0.9740543365478516, "length": 10.682855606079102, "mode": "train", "epoch": 22}
{"loss": 0.12546469271183014, "acc": 0.9559136629104614, "length": 10.793402671813965, "mode": "test", "epoch": 22}
{"loss": 0.07560107111930847, "acc": 0.9800152778625488, "length": 10.696598052978516, "mode": "train", "epoch": 23}
{"loss": 0.11669717729091644, "acc": 0.9575467705726624, "length": 10.911458015441895, "mode": "test", "epoch": 23}
{"loss": 0.06115050986409187, "acc": 0.9853735566139221, "length": 10.813884735107422, "mode": "train", "epoch": 24}
{"loss": 0.11082146316766739, "acc": 0.9563666582107544, "length": 10.871527671813965, "mode": "test", "epoch": 24}
{"loss": 0.055289410054683685, "acc": 0.9881293177604675, "length": 10.834502220153809, "mode": "train", "epoch": 25}
{"loss": 0.10374424606561661, "acc": 0.9665148258209229, "length": 10.89930534362793, "mode": "test", "epoch": 25}
{"loss": 0.04744039103388786, "acc": 0.9910767078399658, "length": 10.861743927001953, "mode": "train", "epoch": 26}
{"loss": 0.10124525427818298, "acc": 0.9682481288909912, "length": 10.956597328186035, "mode": "test", "epoch": 26}
{"loss": 0.05204799771308899, "acc": 0.9881165027618408, "length": 10.852235794067383, "mode": "train", "epoch": 27}
{"loss": 0.10627935081720352, "acc": 0.9655490517616272, "length": 10.956597328186035, "mode": "test", "epoch": 27}
{"loss": 0.0432138592004776, "acc": 0.992629885673523, "length": 10.906716346740723, "mode": "train", "epoch": 28}
{"loss": 0.08920261263847351, "acc": 0.9683621525764465, "length": 10.96875, "mode": "test", "epoch": 28}
{"loss": 0.03914663568139076, "acc": 0.9928804039955139, "length": 10.936805725097656, "mode": "train", "epoch": 29}
{"loss": 0.08754809200763702, "acc": 0.9740588068962097, "length": 10.94618034362793, "mode": "test", "epoch": 29}
{"loss": 0.0353851355612278, "acc": 0.9949216842651367, "length": 10.94068717956543, "mode": "train", "epoch": 30}
{"loss": 0.06633707880973816, "acc": 0.9785535335540771, "length": 10.979166984558105, "mode": "test", "epoch": 30}
{"loss": 0.04311605542898178, "acc": 0.9914005994796753, "length": 10.901063919067383, "mode": "train", "epoch": 31}
{"loss": 0.08282896131277084, "acc": 0.9718288779258728, "length": 10.94444465637207, "mode": "test", "epoch": 31}
{"loss": 0.04278738051652908, "acc": 0.991441011428833, "length": 10.935012817382812, "mode": "train", "epoch": 32}
{"loss": 0.08341658860445023, "acc": 0.9697592258453369, "length": 10.96875, "mode": "test", "epoch": 32}
{"loss": 0.035537198185920715, "acc": 0.9929379820823669, "length": 10.944429397583008, "mode": "train", "epoch": 33}
{"loss": 0.05466456711292267, "acc": 0.9863010048866272, "length": 10.97048568725586, "mode": "test", "epoch": 33}
{"loss": 0.029426103457808495, "acc": 0.9960775375366211, "length": 10.9530668258667, "mode": "train", "epoch": 34}
{"loss": 0.06746816635131836, "acc": 0.9835450649261475, "length": 10.987847328186035, "mode": "test", "epoch": 34}
{"loss": 0.027531374245882034, "acc": 0.9961369633674622, "length": 10.94273853302002, "mode": "train", "epoch": 35}
{"loss": 0.05407590791583061, "acc": 0.9865614771842957, "length": 10.949652671813965, "mode": "test", "epoch": 35}
{"loss": 0.021911201998591423, "acc": 0.9981460571289062, "length": 10.957432746887207, "mode": "train", "epoch": 36}
{"loss": 0.04572102054953575, "acc": 0.9896756410598755, "length": 10.984375, "mode": "test", "epoch": 36}
{"loss": 0.020600246265530586, "acc": 0.9985838532447815, "length": 10.980836868286133, "mode": "train", "epoch": 37}
{"loss": 0.04228688403964043, "acc": 0.989990234375, "length": 10.989583015441895, "mode": "test", "epoch": 37}
{"loss": 0.022355608642101288, "acc": 0.9979007244110107, "length": 10.98472785949707, "mode": "train", "epoch": 38}
{"loss": 0.04738274961709976, "acc": 0.9872748255729675, "length": 10.989583015441895, "mode": "test", "epoch": 38}
{"loss": 0.019074982032179832, "acc": 0.9984654188156128, "length": 10.984724044799805, "mode": "train", "epoch": 39}
{"loss": 0.05772536247968674, "acc": 0.9825412034988403, "length": 10.994791984558105, "mode": "test", "epoch": 39}
{"loss": 0.020683834329247475, "acc": 0.9976940155029297, "length": 10.985259056091309, "mode": "train", "epoch": 40}
{"loss": 0.04520565643906593, "acc": 0.9876711368560791, "length": 10.989583015441895, "mode": "test", "epoch": 40}
{"loss": 0.026994600892066956, "acc": 0.9953665733337402, "length": 10.976452827453613, "mode": "train", "epoch": 41}
{"loss": 0.06688477843999863, "acc": 0.9768635630607605, "length": 10.973958015441895, "mode": "test", "epoch": 41}
{"loss": 0.042548276484012604, "acc": 0.9897581934928894, "length": 10.96663761138916, "mode": "train", "epoch": 42}
{"loss": 0.06491007655858994, "acc": 0.983119010925293, "length": 10.987847328186035, "mode": "test", "epoch": 42}
{"loss": 0.03527355194091797, "acc": 0.9914503693580627, "length": 10.961775779724121, "mode": "train", "epoch": 43}
{"loss": 0.06354144215583801, "acc": 0.9771836400032043, "length": 10.97569465637207, "mode": "test", "epoch": 43}
{"loss": 0.02688603289425373, "acc": 0.9955606460571289, "length": 10.976370811462402, "mode": "train", "epoch": 44}
{"loss": 0.03800693899393082, "acc": 0.9906765818595886, "length": 10.996527671813965, "mode": "test", "epoch": 44}
{"loss": 0.016909537836909294, "acc": 0.998616635799408, "length": 10.986847877502441, "mode": "train", "epoch": 45}
{"loss": 0.04220222681760788, "acc": 0.9897570013999939, "length": 11.0, "mode": "test", "epoch": 45}
{"loss": 0.016523059457540512, "acc": 0.9987111687660217, "length": 10.992637634277344, "mode": "train", "epoch": 46}
{"loss": 0.028540750965476036, "acc": 0.9947916865348816, "length": 11.0, "mode": "test", "epoch": 46}
{"loss": 0.013274737633764744, "acc": 0.9996780753135681, "length": 10.993213653564453, "mode": "train", "epoch": 47}
{"loss": 0.030140111222863197, "acc": 0.9947047829627991, "length": 11.0, "mode": "test", "epoch": 47}
{"loss": 0.02226206846535206, "acc": 0.9965034127235413, "length": 10.992857933044434, "mode": "train", "epoch": 48}
{"loss": 0.047062478959560394, "acc": 0.9907117486000061, "length": 11.0, "mode": "test", "epoch": 48}
{"loss": 0.019663134589791298, "acc": 0.9971896409988403, "length": 10.991209983825684, "mode": "train", "epoch": 49}
{"loss": 0.034716200083494186, "acc": 0.9927084445953369, "length": 11.0, "mode": "test", "epoch": 49}
{"loss": 0.04310697689652443, "acc": 0.9907124042510986, "length": 10.991533279418945, "mode": "train", "epoch": 50}
{"loss": 0.1021156758069992, "acc": 0.9710938334465027, "length": 11.0, "mode": "test", "epoch": 50}
{"loss": 0.0719548836350441, "acc": 0.979906439781189, "length": 10.939099311828613, "mode": "train", "epoch": 51}
{"loss": 0.058955635875463486, "acc": 0.9813015460968018, "length": 10.927083015441895, "mode": "test", "epoch": 51}
{"loss": 0.026231057941913605, "acc": 0.9953180551528931, "length": 10.963521957397461, "mode": "train", "epoch": 52}
{"loss": 0.049551740288734436, "acc": 0.9876248240470886, "length": 10.996527671813965, "mode": "test", "epoch": 52}
{"loss": 0.01831655763089657, "acc": 0.9980966448783875, "length": 10.98620891571045, "mode": "train", "epoch": 53}
{"loss": 0.034097179770469666, "acc": 0.9913194179534912, "length": 11.0, "mode": "test", "epoch": 53}
{"loss": 0.015687186270952225, "acc": 0.9985737204551697, "length": 10.987736701965332, "mode": "train", "epoch": 54}
{"loss": 0.03393463045358658, "acc": 0.9916666746139526, "length": 11.0, "mode": "test", "epoch": 54}
{"loss": 0.016034334897994995, "acc": 0.9981585144996643, "length": 10.992379188537598, "mode": "train", "epoch": 55}
{"loss": 0.03355632349848747, "acc": 0.9934895634651184, "length": 11.0, "mode": "test", "epoch": 55}
{"loss": 0.018313929438591003, "acc": 0.9976674318313599, "length": 10.996302604675293, "mode": "train", "epoch": 56}
{"loss": 0.0367436446249485, "acc": 0.9899305701255798, "length": 11.0, "mode": "test", "epoch": 56}
{"loss": 0.015804272145032883, "acc": 0.9989424347877502, "length": 10.996479988098145, "mode": "train", "epoch": 57}
{"loss": 0.033868685364723206, "acc": 0.9934895634651184, "length": 11.0, "mode": "test", "epoch": 57}
{"loss": 0.013505576178431511, "acc": 0.9992718696594238, "length": 10.996800422668457, "mode": "train", "epoch": 58}
{"loss": 0.02534828707575798, "acc": 0.9949653148651123, "length": 11.0, "mode": "test", "epoch": 58}
{"loss": 0.011984027922153473, "acc": 0.9998263120651245, "length": 10.99726390838623, "mode": "train", "epoch": 59}
{"loss": 0.022858794778585434, "acc": 0.9967881441116333, "length": 11.0, "mode": "test", "epoch": 59}
{"loss": 0.011059379205107689, "acc": 0.999994158744812, "length": 10.998213768005371, "mode": "train", "epoch": 60}
{"loss": 0.023235704749822617, "acc": 0.9963541030883789, "length": 11.0, "mode": "test", "epoch": 60}
test accuracy: 0.769868016242981
