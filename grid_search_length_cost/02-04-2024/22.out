ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.6934604048728943, "acc": 0.5294843912124634, "length": 3.449540138244629, "mode": "train", "epoch": 1}
{"loss": 0.6706500053405762, "acc": 0.5989773273468018, "length": 1.5520833730697632, "mode": "test", "epoch": 1}
{"loss": 0.6074157953262329, "acc": 0.6730594038963318, "length": 2.9906249046325684, "mode": "train", "epoch": 2}
{"loss": 0.5935723781585693, "acc": 0.7039984464645386, "length": 2.128472328186035, "mode": "test", "epoch": 2}
{"loss": 0.4939572215080261, "acc": 0.7646452188491821, "length": 3.475736379623413, "mode": "train", "epoch": 3}
{"loss": 0.48899534344673157, "acc": 0.7866374254226685, "length": 3.9739582538604736, "mode": "test", "epoch": 3}
{"loss": 0.4029045104980469, "acc": 0.8244177103042603, "length": 4.065639972686768, "mode": "train", "epoch": 4}
{"loss": 0.4227959215641022, "acc": 0.8204752802848816, "length": 3.8576388359069824, "mode": "test", "epoch": 4}
{"loss": 0.34414076805114746, "acc": 0.8561215400695801, "length": 4.504964828491211, "mode": "train", "epoch": 5}
{"loss": 0.3581695556640625, "acc": 0.8492920398712158, "length": 4.35243034362793, "mode": "test", "epoch": 5}
{"loss": 0.2971383333206177, "acc": 0.8779840469360352, "length": 5.19959020614624, "mode": "train", "epoch": 6}
{"loss": 0.3310387432575226, "acc": 0.8676947355270386, "length": 5.112847328186035, "mode": "test", "epoch": 6}
{"loss": 0.25631943345069885, "acc": 0.900849461555481, "length": 6.150760650634766, "mode": "train", "epoch": 7}
{"loss": 0.28040751814842224, "acc": 0.887646496295929, "length": 6.30381965637207, "mode": "test", "epoch": 7}
{"loss": 0.22650864720344543, "acc": 0.9147229194641113, "length": 6.538218021392822, "mode": "train", "epoch": 8}
{"loss": 0.26100394129753113, "acc": 0.8953450322151184, "length": 5.92881965637207, "mode": "test", "epoch": 8}
{"loss": 0.20252402126789093, "acc": 0.9261672496795654, "length": 6.775658130645752, "mode": "train", "epoch": 9}
{"loss": 0.2436228096485138, "acc": 0.9111979603767395, "length": 7.362847328186035, "mode": "test", "epoch": 9}
{"loss": 0.1883818656206131, "acc": 0.934325635433197, "length": 7.044223308563232, "mode": "train", "epoch": 10}
{"loss": 0.24659758806228638, "acc": 0.9109510779380798, "length": 7.171875, "mode": "test", "epoch": 10}
{"loss": 0.16932393610477448, "acc": 0.9421523213386536, "length": 7.373630523681641, "mode": "train", "epoch": 11}
{"loss": 0.23552560806274414, "acc": 0.9096815586090088, "length": 7.824652671813965, "mode": "test", "epoch": 11}
{"loss": 0.16263802349567413, "acc": 0.9444443583488464, "length": 7.51892614364624, "mode": "train", "epoch": 12}
{"loss": 0.2112446427345276, "acc": 0.9244058132171631, "length": 6.848958492279053, "mode": "test", "epoch": 12}
{"loss": 0.15020525455474854, "acc": 0.9503950476646423, "length": 7.5236077308654785, "mode": "train", "epoch": 13}
{"loss": 0.22080446779727936, "acc": 0.9227592945098877, "length": 7.572916507720947, "mode": "test", "epoch": 13}
{"loss": 0.14409950375556946, "acc": 0.952666699886322, "length": 7.600737571716309, "mode": "train", "epoch": 14}
{"loss": 0.21633699536323547, "acc": 0.9266872406005859, "length": 7.487847328186035, "mode": "test", "epoch": 14}
{"loss": 0.12728317081928253, "acc": 0.9606609344482422, "length": 7.877859592437744, "mode": "train", "epoch": 15}
{"loss": 0.20521003007888794, "acc": 0.9277017116546631, "length": 8.07638931274414, "mode": "test", "epoch": 15}
{"loss": 0.12170825898647308, "acc": 0.9632072448730469, "length": 8.31631851196289, "mode": "train", "epoch": 16}
{"loss": 0.18505506217479706, "acc": 0.9397108554840088, "length": 8.68055534362793, "mode": "test", "epoch": 16}
{"loss": 0.12059886753559113, "acc": 0.9645249247550964, "length": 8.481196403503418, "mode": "train", "epoch": 17}
{"loss": 0.1750771403312683, "acc": 0.9446777701377869, "length": 8.675347328186035, "mode": "test", "epoch": 17}
{"loss": 0.11987554281949997, "acc": 0.9648788571357727, "length": 8.340636253356934, "mode": "train", "epoch": 18}
{"loss": 0.1917639672756195, "acc": 0.9351780414581299, "length": 8.109375, "mode": "test", "epoch": 18}
{"loss": 0.09934882819652557, "acc": 0.9736376404762268, "length": 8.293868064880371, "mode": "train", "epoch": 19}
{"loss": 0.17795895040035248, "acc": 0.938807487487793, "length": 8.421875, "mode": "test", "epoch": 19}
{"loss": 0.09635146707296371, "acc": 0.9757348895072937, "length": 8.531399726867676, "mode": "train", "epoch": 20}
{"loss": 0.16408120095729828, "acc": 0.9505045413970947, "length": 8.57986068725586, "mode": "test", "epoch": 20}
{"loss": 0.0945892259478569, "acc": 0.9750247597694397, "length": 8.529036521911621, "mode": "train", "epoch": 21}
{"loss": 0.16063763201236725, "acc": 0.9469237923622131, "length": 8.52256965637207, "mode": "test", "epoch": 21}
{"loss": 0.08525928109884262, "acc": 0.979426383972168, "length": 8.664165496826172, "mode": "train", "epoch": 22}
{"loss": 0.15913674235343933, "acc": 0.9544107913970947, "length": 8.65625, "mode": "test", "epoch": 22}
{"loss": 0.10789106786251068, "acc": 0.9693426489830017, "length": 8.778848648071289, "mode": "train", "epoch": 23}
{"loss": 0.1631270945072174, "acc": 0.9494140148162842, "length": 8.93923568725586, "mode": "test", "epoch": 23}
{"loss": 0.08584079891443253, "acc": 0.9781708121299744, "length": 8.711181640625, "mode": "train", "epoch": 24}
{"loss": 0.13870540261268616, "acc": 0.958704948425293, "length": 8.215277671813965, "mode": "test", "epoch": 24}
{"loss": 0.07544182986021042, "acc": 0.982574462890625, "length": 8.548773765563965, "mode": "train", "epoch": 25}
{"loss": 0.13675904273986816, "acc": 0.9619221091270447, "length": 8.619791984558105, "mode": "test", "epoch": 25}
{"loss": 0.07572771608829498, "acc": 0.9809154868125916, "length": 8.688222885131836, "mode": "train", "epoch": 26}
{"loss": 0.14123570919036865, "acc": 0.9548665285110474, "length": 8.68576431274414, "mode": "test", "epoch": 26}
{"loss": 0.07589250802993774, "acc": 0.9808975458145142, "length": 8.458821296691895, "mode": "train", "epoch": 27}
{"loss": 0.12977875769138336, "acc": 0.9603000283241272, "length": 8.53993034362793, "mode": "test", "epoch": 27}
{"loss": 0.06795448809862137, "acc": 0.9847134351730347, "length": 8.674447059631348, "mode": "train", "epoch": 28}
{"loss": 0.11698120087385178, "acc": 0.9652019143104553, "length": 8.130208015441895, "mode": "test", "epoch": 28}
{"loss": 0.06526914238929749, "acc": 0.9845454692840576, "length": 8.344857215881348, "mode": "train", "epoch": 29}
{"loss": 0.10625498741865158, "acc": 0.9649304151535034, "length": 8.08506965637207, "mode": "test", "epoch": 29}
{"loss": 0.06921611726284027, "acc": 0.9825802445411682, "length": 8.772516250610352, "mode": "train", "epoch": 30}
{"loss": 0.10892874747514725, "acc": 0.9688802361488342, "length": 8.63194465637207, "mode": "test", "epoch": 30}
{"loss": 0.06186801940202713, "acc": 0.9851840734481812, "length": 8.516426086425781, "mode": "train", "epoch": 31}
{"loss": 0.10484473407268524, "acc": 0.9665771126747131, "length": 9.06423568725586, "mode": "test", "epoch": 31}
{"loss": 0.06188252195715904, "acc": 0.984315037727356, "length": 8.752294540405273, "mode": "train", "epoch": 32}
{"loss": 0.10209353268146515, "acc": 0.9727783203125, "length": 8.984375, "mode": "test", "epoch": 32}
{"loss": 0.06922703236341476, "acc": 0.9819252490997314, "length": 8.831143379211426, "mode": "train", "epoch": 33}
{"loss": 0.11243078112602234, "acc": 0.9666042327880859, "length": 9.137152671813965, "mode": "test", "epoch": 33}
{"loss": 0.05682218819856644, "acc": 0.9855012893676758, "length": 8.769214630126953, "mode": "train", "epoch": 34}
{"loss": 0.12761157751083374, "acc": 0.9598308205604553, "length": 9.03125, "mode": "test", "epoch": 34}
{"loss": 0.06034621596336365, "acc": 0.9840572476387024, "length": 8.846199035644531, "mode": "train", "epoch": 35}
{"loss": 0.09802623093128204, "acc": 0.9702067971229553, "length": 9.277777671813965, "mode": "test", "epoch": 35}
{"loss": 0.04467199742794037, "acc": 0.9906150102615356, "length": 9.148646354675293, "mode": "train", "epoch": 36}
{"loss": 0.07925037294626236, "acc": 0.9784206748008728, "length": 8.84201431274414, "mode": "test", "epoch": 36}
{"loss": 0.043885767459869385, "acc": 0.9902439713478088, "length": 9.105486869812012, "mode": "train", "epoch": 37}
{"loss": 0.06349582970142365, "acc": 0.9833251237869263, "length": 8.8125, "mode": "test", "epoch": 37}
{"loss": 0.04442467540502548, "acc": 0.9899765253067017, "length": 8.789302825927734, "mode": "train", "epoch": 38}
{"loss": 0.07135125994682312, "acc": 0.9777966737747192, "length": 8.58506965637207, "mode": "test", "epoch": 38}
{"loss": 0.041635625064373016, "acc": 0.9911208152770996, "length": 8.947876930236816, "mode": "train", "epoch": 39}
{"loss": 0.057420823723077774, "acc": 0.9839898347854614, "length": 8.86111068725586, "mode": "test", "epoch": 39}
{"loss": 0.053667645901441574, "acc": 0.9864208102226257, "length": 9.311193466186523, "mode": "train", "epoch": 40}
{"loss": 0.08471164852380753, "acc": 0.9748236536979675, "length": 9.572916984558105, "mode": "test", "epoch": 40}
{"loss": 0.041579995304346085, "acc": 0.9916040897369385, "length": 9.033241271972656, "mode": "train", "epoch": 41}
{"loss": 0.05630643665790558, "acc": 0.9875515699386597, "length": 8.78298568725586, "mode": "test", "epoch": 41}
{"loss": 0.03490093722939491, "acc": 0.9933850169181824, "length": 8.642751693725586, "mode": "train", "epoch": 42}
{"loss": 0.04943917691707611, "acc": 0.9888564348220825, "length": 8.703125, "mode": "test", "epoch": 42}
{"loss": 0.03185441344976425, "acc": 0.9948088526725769, "length": 8.918193817138672, "mode": "train", "epoch": 43}
{"loss": 0.04355458915233612, "acc": 0.9926785230636597, "length": 9.197916984558105, "mode": "test", "epoch": 43}
{"loss": 0.031069282442331314, "acc": 0.9953543543815613, "length": 8.85196590423584, "mode": "train", "epoch": 44}
{"loss": 0.04725674167275429, "acc": 0.9912543892860413, "length": 8.82638931274414, "mode": "test", "epoch": 44}
{"loss": 0.028501160442829132, "acc": 0.9954316020011902, "length": 8.509403228759766, "mode": "train", "epoch": 45}
{"loss": 0.039862893521785736, "acc": 0.9915093183517456, "length": 8.453125, "mode": "test", "epoch": 45}
{"loss": 0.02846931293606758, "acc": 0.9951395988464355, "length": 8.265324592590332, "mode": "train", "epoch": 46}
{"loss": 0.061836447566747665, "acc": 0.9838703870773315, "length": 8.00694465637207, "mode": "test", "epoch": 46}
{"loss": 0.028328021988272667, "acc": 0.9955024123191833, "length": 8.40127944946289, "mode": "train", "epoch": 47}
{"loss": 0.05079514905810356, "acc": 0.9881617426872253, "length": 8.85069465637207, "mode": "test", "epoch": 47}
{"loss": 0.04609944671392441, "acc": 0.9890593886375427, "length": 9.210699081420898, "mode": "train", "epoch": 48}
{"loss": 0.07504185289144516, "acc": 0.9798203706741333, "length": 8.739583015441895, "mode": "test", "epoch": 48}
{"loss": 0.04089239612221718, "acc": 0.9913836717605591, "length": 9.141366958618164, "mode": "train", "epoch": 49}
{"loss": 0.08731874823570251, "acc": 0.9729763865470886, "length": 8.927083015441895, "mode": "test", "epoch": 49}
{"loss": 0.0433788001537323, "acc": 0.9906394481658936, "length": 8.57508373260498, "mode": "train", "epoch": 50}
{"loss": 0.053490083664655685, "acc": 0.9869059324264526, "length": 8.114583015441895, "mode": "test", "epoch": 50}
{"loss": 0.026681220158934593, "acc": 0.9959982633590698, "length": 8.417043685913086, "mode": "train", "epoch": 51}
{"loss": 0.04534382373094559, "acc": 0.9905083775520325, "length": 8.63194465637207, "mode": "test", "epoch": 51}
{"loss": 0.023584473878145218, "acc": 0.996803343296051, "length": 8.645502090454102, "mode": "train", "epoch": 52}
{"loss": 0.05148819833993912, "acc": 0.9893907904624939, "length": 8.85069465637207, "mode": "test", "epoch": 52}
{"loss": 0.02685232274234295, "acc": 0.9954299926757812, "length": 8.386351585388184, "mode": "train", "epoch": 53}
{"loss": 0.058269135653972626, "acc": 0.9884005784988403, "length": 7.776041507720947, "mode": "test", "epoch": 53}
{"loss": 0.03145641088485718, "acc": 0.9936853647232056, "length": 8.402676582336426, "mode": "train", "epoch": 54}
{"loss": 0.050205521285533905, "acc": 0.9881184697151184, "length": 8.496527671813965, "mode": "test", "epoch": 54}
{"loss": 0.041073694825172424, "acc": 0.9913555383682251, "length": 8.349467277526855, "mode": "train", "epoch": 55}
{"loss": 0.10205931216478348, "acc": 0.9732829332351685, "length": 8.28125, "mode": "test", "epoch": 55}
{"loss": 0.04792110621929169, "acc": 0.9890326857566833, "length": 8.557756423950195, "mode": "train", "epoch": 56}
{"loss": 0.05264712870121002, "acc": 0.9913601279258728, "length": 8.87673568725586, "mode": "test", "epoch": 56}
{"loss": 0.024872969835996628, "acc": 0.9966456890106201, "length": 8.829477310180664, "mode": "train", "epoch": 57}
{"loss": 0.04631070792675018, "acc": 0.9920870661735535, "length": 8.581597328186035, "mode": "test", "epoch": 57}
{"loss": 0.028908131644129753, "acc": 0.994429349899292, "length": 8.433882713317871, "mode": "train", "epoch": 58}
{"loss": 0.06573343276977539, "acc": 0.9801323413848877, "length": 8.682291984558105, "mode": "test", "epoch": 58}
{"loss": 0.03211047127842903, "acc": 0.9935176968574524, "length": 7.966292381286621, "mode": "train", "epoch": 59}
{"loss": 0.04799194633960724, "acc": 0.9914117455482483, "length": 7.829861164093018, "mode": "test", "epoch": 59}
{"loss": 0.026104506105184555, "acc": 0.9952088594436646, "length": 7.851536750793457, "mode": "train", "epoch": 60}
{"loss": 0.03968767076730728, "acc": 0.9929687976837158, "length": 7.904513835906982, "mode": "test", "epoch": 60}
test accuracy: 0.8779591917991638
