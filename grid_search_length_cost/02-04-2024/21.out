ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.6922597289085388, "acc": 0.5433717966079712, "length": 3.378933906555176, "mode": "train", "epoch": 1}
{"loss": 0.6537401676177979, "acc": 0.6429525017738342, "length": 3.043402671813965, "mode": "test", "epoch": 1}
{"loss": 0.59878009557724, "acc": 0.6887248754501343, "length": 3.402174711227417, "mode": "train", "epoch": 2}
{"loss": 0.5798664689064026, "acc": 0.709201455116272, "length": 3.534722328186035, "mode": "test", "epoch": 2}
{"loss": 0.49654680490493774, "acc": 0.7656824588775635, "length": 4.462673187255859, "mode": "train", "epoch": 3}
{"loss": 0.4444320797920227, "acc": 0.8020833730697632, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.3560878336429596, "acc": 0.853586733341217, "length": 5.8087077140808105, "mode": "train", "epoch": 4}
{"loss": 0.3540024757385254, "acc": 0.8539929986000061, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.2983601987361908, "acc": 0.8824039101600647, "length": 5.970365524291992, "mode": "train", "epoch": 5}
{"loss": 0.3644777536392212, "acc": 0.8625868558883667, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.27098050713539124, "acc": 0.894207239151001, "length": 5.983245849609375, "mode": "train", "epoch": 6}
{"loss": 0.3250032961368561, "acc": 0.8671875, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.24621419608592987, "acc": 0.9070678949356079, "length": 5.991189956665039, "mode": "train", "epoch": 7}
{"loss": 0.318217009305954, "acc": 0.882725715637207, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.22559921443462372, "acc": 0.9203920960426331, "length": 5.994247913360596, "mode": "train", "epoch": 8}
{"loss": 0.2784942388534546, "acc": 0.8963541388511658, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.20224790275096893, "acc": 0.9284419417381287, "length": 5.9959516525268555, "mode": "train", "epoch": 9}
{"loss": 0.2648833096027374, "acc": 0.8897570371627808, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.1792922466993332, "acc": 0.9416334629058838, "length": 5.997323036193848, "mode": "train", "epoch": 10}
{"loss": 0.2235025018453598, "acc": 0.9159722924232483, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.16590650379657745, "acc": 0.9459154605865479, "length": 5.9981608390808105, "mode": "train", "epoch": 11}
{"loss": 0.21552295982837677, "acc": 0.9289931058883667, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.15327422320842743, "acc": 0.9522854089736938, "length": 5.998573303222656, "mode": "train", "epoch": 12}
{"loss": 0.2113582193851471, "acc": 0.934982419013977, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.14814455807209015, "acc": 0.952497661113739, "length": 5.999083518981934, "mode": "train", "epoch": 13}
{"loss": 0.2108587920665741, "acc": 0.9263889789581299, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.14265213906764984, "acc": 0.9553318023681641, "length": 5.999246597290039, "mode": "train", "epoch": 14}
{"loss": 0.20377133786678314, "acc": 0.9309027194976807, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.13410142064094543, "acc": 0.9568226933479309, "length": 5.999426364898682, "mode": "train", "epoch": 15}
{"loss": 0.20245179533958435, "acc": 0.9308159351348877, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.129561647772789, "acc": 0.9585638642311096, "length": 5.999515056610107, "mode": "train", "epoch": 16}
{"loss": 0.2005348652601242, "acc": 0.9379340410232544, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.12936006486415863, "acc": 0.9593209028244019, "length": 5.999555587768555, "mode": "train", "epoch": 17}
{"loss": 0.1908242404460907, "acc": 0.9368056058883667, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.1148151233792305, "acc": 0.9638636112213135, "length": 5.999644756317139, "mode": "train", "epoch": 18}
{"loss": 0.18501819670200348, "acc": 0.9394097924232483, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.11051581054925919, "acc": 0.9648445844650269, "length": 5.999664306640625, "mode": "train", "epoch": 19}
{"loss": 0.17708604037761688, "acc": 0.9456597566604614, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.10542552173137665, "acc": 0.9675648212432861, "length": 5.999722480773926, "mode": "train", "epoch": 20}
{"loss": 0.16456100344657898, "acc": 0.9470486044883728, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.10603662580251694, "acc": 0.9678740501403809, "length": 5.999753475189209, "mode": "train", "epoch": 21}
{"loss": 0.16018983721733093, "acc": 0.9487847089767456, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.09633570164442062, "acc": 0.9710983633995056, "length": 5.999792575836182, "mode": "train", "epoch": 22}
{"loss": 0.15157420933246613, "acc": 0.9525172710418701, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.09869863092899323, "acc": 0.9698657393455505, "length": 5.999817371368408, "mode": "train", "epoch": 23}
{"loss": 0.13516928255558014, "acc": 0.9595486521720886, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.0929780825972557, "acc": 0.9718561768531799, "length": 5.999840259552002, "mode": "train", "epoch": 24}
{"loss": 0.1499026119709015, "acc": 0.9541667103767395, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.08232571929693222, "acc": 0.9754165410995483, "length": 5.999815464019775, "mode": "train", "epoch": 25}
{"loss": 0.12343384325504303, "acc": 0.9605902433395386, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.07880640029907227, "acc": 0.9760336875915527, "length": 5.999873161315918, "mode": "train", "epoch": 26}
{"loss": 0.12723082304000854, "acc": 0.9594617486000061, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.08011700212955475, "acc": 0.9749123454093933, "length": 5.999870777130127, "mode": "train", "epoch": 27}
{"loss": 0.12109531462192535, "acc": 0.9615452289581299, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.06884642690420151, "acc": 0.9811618328094482, "length": 5.999855041503906, "mode": "train", "epoch": 28}
{"loss": 0.09788987040519714, "acc": 0.9691840410232544, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.06378009915351868, "acc": 0.982900083065033, "length": 5.999865531921387, "mode": "train", "epoch": 29}
{"loss": 0.1010018065571785, "acc": 0.9680556058883667, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.06286218017339706, "acc": 0.9826480746269226, "length": 5.999878406524658, "mode": "train", "epoch": 30}
{"loss": 0.09969452768564224, "acc": 0.9676215648651123, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.04973867908120155, "acc": 0.9877489805221558, "length": 5.999886512756348, "mode": "train", "epoch": 31}
{"loss": 0.08942864835262299, "acc": 0.9739583134651184, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.04832599312067032, "acc": 0.989066481590271, "length": 5.999889850616455, "mode": "train", "epoch": 32}
{"loss": 0.08958148211240768, "acc": 0.9745660424232483, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.045347101986408234, "acc": 0.9898790717124939, "length": 5.999875545501709, "mode": "train", "epoch": 33}
{"loss": 0.06435777246952057, "acc": 0.9816840291023254, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.050812091678380966, "acc": 0.9874973297119141, "length": 5.9998884201049805, "mode": "train", "epoch": 34}
{"loss": 0.07937345653772354, "acc": 0.9778645634651184, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.03796255216002464, "acc": 0.9918415546417236, "length": 5.999898910522461, "mode": "train", "epoch": 35}
{"loss": 0.0610867477953434, "acc": 0.9816839694976807, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.044331055134534836, "acc": 0.9892638325691223, "length": 5.999929428100586, "mode": "train", "epoch": 36}
{"loss": 0.07414538413286209, "acc": 0.9761284589767456, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.041958559304475784, "acc": 0.9905813336372375, "length": 5.999940872192383, "mode": "train", "epoch": 37}
{"loss": 0.06704983115196228, "acc": 0.9785589575767517, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.0315936803817749, "acc": 0.9941691160202026, "length": 5.999947547912598, "mode": "train", "epoch": 38}
{"loss": 0.05672169476747513, "acc": 0.9855034351348877, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.03281686455011368, "acc": 0.9938042759895325, "length": 5.999920845031738, "mode": "train", "epoch": 39}
{"loss": 0.06905107945203781, "acc": 0.9801216125488281, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.02763068675994873, "acc": 0.9954022169113159, "length": 5.999955177307129, "mode": "train", "epoch": 40}
{"loss": 0.06754325330257416, "acc": 0.9840277433395386, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.036097507923841476, "acc": 0.9926277995109558, "length": 5.999948501586914, "mode": "train", "epoch": 41}
{"loss": 0.061904191970825195, "acc": 0.9829861521720886, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.032871123403310776, "acc": 0.9936647415161133, "length": 5.999939441680908, "mode": "train", "epoch": 42}
{"loss": 0.05341719835996628, "acc": 0.9873263835906982, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.027584651485085487, "acc": 0.9945901036262512, "length": 5.99997091293335, "mode": "train", "epoch": 43}
{"loss": 0.04634467139840126, "acc": 0.9891493320465088, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.020842550322413445, "acc": 0.9977851510047913, "length": 5.999970436096191, "mode": "train", "epoch": 44}
{"loss": 0.04383325204253197, "acc": 0.9901039600372314, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.019162027165293694, "acc": 0.9977009892463684, "length": 5.999969482421875, "mode": "train", "epoch": 45}
{"loss": 0.04229127615690231, "acc": 0.9906250834465027, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.0216554906219244, "acc": 0.9971128106117249, "length": 5.999977111816406, "mode": "train", "epoch": 46}
{"loss": 0.042877811938524246, "acc": 0.9910590648651123, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.024770358577370644, "acc": 0.9958234429359436, "length": 5.999979019165039, "mode": "train", "epoch": 47}
{"loss": 0.04571915417909622, "acc": 0.9897570013999939, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.0385708250105381, "acc": 0.9906080961227417, "length": 5.999910831451416, "mode": "train", "epoch": 48}
{"loss": 0.09763088822364807, "acc": 0.9710070490837097, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.032274749130010605, "acc": 0.991675615310669, "length": 5.999982833862305, "mode": "train", "epoch": 49}
{"loss": 0.0382891483604908, "acc": 0.9895832538604736, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.020495519042015076, "acc": 0.9969725608825684, "length": 5.999979019165039, "mode": "train", "epoch": 50}
{"loss": 0.03748735040426254, "acc": 0.9918403625488281, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.018082397058606148, "acc": 0.9981498718261719, "length": 5.999987602233887, "mode": "train", "epoch": 51}
{"loss": 0.03101423755288124, "acc": 0.9926215410232544, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.015010266564786434, "acc": 0.9988505840301514, "length": 5.999985694885254, "mode": "train", "epoch": 52}
{"loss": 0.03187727555632591, "acc": 0.9928818941116333, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.01543340552598238, "acc": 0.9986824989318848, "length": 5.999985218048096, "mode": "train", "epoch": 53}
{"loss": 0.03207966312766075, "acc": 0.9939236044883728, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.023039454594254494, "acc": 0.9971969723701477, "length": 5.9999847412109375, "mode": "train", "epoch": 54}
{"loss": 0.059233877807855606, "acc": 0.9871528148651123, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.026382997632026672, "acc": 0.9954313039779663, "length": 5.9999895095825195, "mode": "train", "epoch": 55}
{"loss": 0.04358552396297455, "acc": 0.9904513955116272, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.019879000261425972, "acc": 0.9963563084602356, "length": 5.999987602233887, "mode": "train", "epoch": 56}
{"loss": 0.041978903114795685, "acc": 0.9923611879348755, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.021470827981829643, "acc": 0.9972251653671265, "length": 5.999991416931152, "mode": "train", "epoch": 57}
{"loss": 0.030874358490109444, "acc": 0.9916666746139526, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.021535124629735947, "acc": 0.9957957863807678, "length": 5.999991416931152, "mode": "train", "epoch": 58}
{"loss": 0.04352940618991852, "acc": 0.9904513955116272, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.0185268372297287, "acc": 0.9978415966033936, "length": 5.999991416931152, "mode": "train", "epoch": 59}
{"loss": 0.04008038341999054, "acc": 0.9905381798744202, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.025992048904299736, "acc": 0.9949827194213867, "length": 5.9999847412109375, "mode": "train", "epoch": 60}
{"loss": 0.0415378101170063, "acc": 0.9921005964279175, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.8871774077415466
