ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 5
{"loss": 0.4048592746257782, "acc": 0.8152737617492676, "length": 2.966489553451538, "mode": "train", "epoch": 1}
{"loss": 0.31974509358406067, "acc": 0.876508355140686, "length": 3.0, "mode": "test", "epoch": 1}
{"loss": 0.21373969316482544, "acc": 0.9280657172203064, "length": 3.000002384185791, "mode": "train", "epoch": 2}
{"loss": 0.2767135500907898, "acc": 0.8942137360572815, "length": 3.0, "mode": "test", "epoch": 2}
{"loss": 0.17472723126411438, "acc": 0.946726381778717, "length": 2.9999969005584717, "mode": "train", "epoch": 3}
{"loss": 0.2668605446815491, "acc": 0.9081174731254578, "length": 3.0, "mode": "test", "epoch": 3}
{"loss": 0.1572123020887375, "acc": 0.954955518245697, "length": 2.9999983310699463, "mode": "train", "epoch": 4}
{"loss": 0.24236555397510529, "acc": 0.9169366359710693, "length": 3.0, "mode": "test", "epoch": 4}
{"loss": 0.14755621552467346, "acc": 0.9589759111404419, "length": 3.0, "mode": "train", "epoch": 5}
{"loss": 0.20122821629047394, "acc": 0.9322478175163269, "length": 3.0, "mode": "test", "epoch": 5}
{"loss": 0.1415184736251831, "acc": 0.9612711668014526, "length": 2.9999992847442627, "mode": "train", "epoch": 6}
{"loss": 0.18863603472709656, "acc": 0.9392987489700317, "length": 3.0, "mode": "test", "epoch": 6}
{"loss": 0.1374439299106598, "acc": 0.9623811841011047, "length": 2.9999985694885254, "mode": "train", "epoch": 7}
{"loss": 0.1807955801486969, "acc": 0.9410057663917542, "length": 3.0, "mode": "test", "epoch": 7}
{"loss": 0.1315380185842514, "acc": 0.9645853638648987, "length": 2.999999761581421, "mode": "train", "epoch": 8}
{"loss": 0.17331545054912567, "acc": 0.9448938369750977, "length": 3.0, "mode": "test", "epoch": 8}
{"loss": 0.12732982635498047, "acc": 0.9663074612617493, "length": 2.999999523162842, "mode": "train", "epoch": 9}
{"loss": 0.1781192570924759, "acc": 0.9442154169082642, "length": 3.0, "mode": "test", "epoch": 9}
{"loss": 0.12573464214801788, "acc": 0.9668270945549011, "length": 3.0, "mode": "train", "epoch": 10}
{"loss": 0.16930200159549713, "acc": 0.9472396373748779, "length": 3.0, "mode": "test", "epoch": 10}
{"loss": 0.12373730540275574, "acc": 0.9673455953598022, "length": 3.0000033378601074, "mode": "train", "epoch": 11}
{"loss": 0.15515029430389404, "acc": 0.954344630241394, "length": 3.0, "mode": "test", "epoch": 11}
{"loss": 0.12073352187871933, "acc": 0.9687045812606812, "length": 2.9999890327453613, "mode": "train", "epoch": 12}
{"loss": 0.14690862596035004, "acc": 0.9593135714530945, "length": 3.0, "mode": "test", "epoch": 12}
{"loss": 0.11880376189947128, "acc": 0.9692513346672058, "length": 2.999999761581421, "mode": "train", "epoch": 13}
{"loss": 0.14215829968452454, "acc": 0.9606578946113586, "length": 3.0, "mode": "test", "epoch": 13}
{"loss": 0.11789683252573013, "acc": 0.9695553779602051, "length": 2.999999523162842, "mode": "train", "epoch": 14}
{"loss": 0.14558899402618408, "acc": 0.9602122902870178, "length": 3.0, "mode": "test", "epoch": 14}
{"loss": 0.11504659056663513, "acc": 0.9705690741539001, "length": 2.999999523162842, "mode": "train", "epoch": 15}
{"loss": 0.13658154010772705, "acc": 0.9625540971755981, "length": 3.0, "mode": "test", "epoch": 15}
{"loss": 0.11471156030893326, "acc": 0.970553994178772, "length": 3.0000100135803223, "mode": "train", "epoch": 16}
{"loss": 0.13270677626132965, "acc": 0.965572714805603, "length": 3.0, "mode": "test", "epoch": 16}
{"loss": 0.11345171928405762, "acc": 0.9710503220558167, "length": 2.999999523162842, "mode": "train", "epoch": 17}
{"loss": 0.1312166303396225, "acc": 0.9654549956321716, "length": 3.0000360012054443, "mode": "test", "epoch": 17}
{"loss": 0.11172454804182053, "acc": 0.9715128540992737, "length": 3.0000007152557373, "mode": "train", "epoch": 18}
{"loss": 0.12957650423049927, "acc": 0.9646758437156677, "length": 3.0, "mode": "test", "epoch": 18}
{"loss": 0.11177372187376022, "acc": 0.9716392159461975, "length": 3.0000030994415283, "mode": "train", "epoch": 19}
{"loss": 0.12860555946826935, "acc": 0.9669800400733948, "length": 3.0, "mode": "test", "epoch": 19}
{"loss": 0.11051391065120697, "acc": 0.9719773530960083, "length": 2.999999523162842, "mode": "train", "epoch": 20}
{"loss": 0.12644609808921814, "acc": 0.9671730995178223, "length": 3.0, "mode": "test", "epoch": 20}
{"loss": 0.10897690057754517, "acc": 0.9724003076553345, "length": 2.9999990463256836, "mode": "train", "epoch": 21}
{"loss": 0.13109415769577026, "acc": 0.9633336663246155, "length": 3.0, "mode": "test", "epoch": 21}
{"loss": 0.10835810750722885, "acc": 0.972554624080658, "length": 2.9999985694885254, "mode": "train", "epoch": 22}
{"loss": 0.12543071806430817, "acc": 0.9661445617675781, "length": 3.0, "mode": "test", "epoch": 22}
{"loss": 0.10732731968164444, "acc": 0.9729002714157104, "length": 2.999999523162842, "mode": "train", "epoch": 23}
{"loss": 0.12542180716991425, "acc": 0.9670124053955078, "length": 3.0, "mode": "test", "epoch": 23}
{"loss": 0.10770716518163681, "acc": 0.9727500081062317, "length": 3.000000476837158, "mode": "train", "epoch": 24}
{"loss": 0.11979174613952637, "acc": 0.9698217511177063, "length": 3.0, "mode": "test", "epoch": 24}
{"loss": 0.10723334550857544, "acc": 0.9728245139122009, "length": 2.999986410140991, "mode": "train", "epoch": 25}
{"loss": 0.1292511224746704, "acc": 0.9668915271759033, "length": 3.0, "mode": "test", "epoch": 25}
{"loss": 0.10624530166387558, "acc": 0.9731841683387756, "length": 3.0000078678131104, "mode": "train", "epoch": 26}
{"loss": 0.11911782622337341, "acc": 0.970180869102478, "length": 3.0, "mode": "test", "epoch": 26}
{"loss": 0.10455375909805298, "acc": 0.9736806750297546, "length": 2.9999992847442627, "mode": "train", "epoch": 27}
{"loss": 0.11451606452465057, "acc": 0.9707455039024353, "length": 3.0, "mode": "test", "epoch": 27}
{"loss": 0.10599754750728607, "acc": 0.9730440378189087, "length": 3.000006675720215, "mode": "train", "epoch": 28}
{"loss": 0.11847897619009018, "acc": 0.9694429039955139, "length": 3.0, "mode": "test", "epoch": 28}
{"loss": 0.1045161783695221, "acc": 0.9733573794364929, "length": 3.0000061988830566, "mode": "train", "epoch": 29}
{"loss": 0.11655773967504501, "acc": 0.9705001711845398, "length": 3.0, "mode": "test", "epoch": 29}
{"loss": 0.10277485847473145, "acc": 0.9739702343940735, "length": 2.999999523162842, "mode": "train", "epoch": 30}
{"loss": 0.11774946004152298, "acc": 0.9695202708244324, "length": 3.0, "mode": "test", "epoch": 30}
{"loss": 0.10192585736513138, "acc": 0.9743150472640991, "length": 2.999999523162842, "mode": "train", "epoch": 31}
{"loss": 0.11381317675113678, "acc": 0.9705236554145813, "length": 3.0, "mode": "test", "epoch": 31}
{"loss": 0.10201460868120193, "acc": 0.9743834733963013, "length": 2.9999969005584717, "mode": "train", "epoch": 32}
{"loss": 0.11476379632949829, "acc": 0.9706968665122986, "length": 3.0, "mode": "test", "epoch": 32}
{"loss": 0.10181278735399246, "acc": 0.9743168354034424, "length": 3.0000016689300537, "mode": "train", "epoch": 33}
{"loss": 0.11772118508815765, "acc": 0.9704315066337585, "length": 3.0, "mode": "test", "epoch": 33}
{"loss": 0.10051184147596359, "acc": 0.9748286604881287, "length": 3.000000238418579, "mode": "train", "epoch": 34}
{"loss": 0.11366996169090271, "acc": 0.9712651968002319, "length": 3.0, "mode": "test", "epoch": 34}
{"loss": 0.10211201757192612, "acc": 0.9741929769515991, "length": 3.0000405311584473, "mode": "train", "epoch": 35}
{"loss": 0.11470813304185867, "acc": 0.9715844988822937, "length": 3.0, "mode": "test", "epoch": 35}
{"loss": 0.10128026455640793, "acc": 0.9743361473083496, "length": 2.9999921321868896, "mode": "train", "epoch": 36}
{"loss": 0.10901088267564774, "acc": 0.9734085202217102, "length": 3.0, "mode": "test", "epoch": 36}
{"loss": 0.10347118228673935, "acc": 0.9739870429039001, "length": 2.9999988079071045, "mode": "train", "epoch": 37}
{"loss": 0.11166001111268997, "acc": 0.9724268913269043, "length": 3.0000360012054443, "mode": "test", "epoch": 37}
{"loss": 0.1005990281701088, "acc": 0.9747204780578613, "length": 3.0000007152557373, "mode": "train", "epoch": 38}
{"loss": 0.11330930888652802, "acc": 0.9718477725982666, "length": 3.0, "mode": "test", "epoch": 38}
{"loss": 0.09960091859102249, "acc": 0.9750491976737976, "length": 3.0000391006469727, "mode": "train", "epoch": 39}
{"loss": 0.11608164012432098, "acc": 0.9712128043174744, "length": 3.0, "mode": "test", "epoch": 39}
{"loss": 0.10055019706487656, "acc": 0.9747157096862793, "length": 2.9999947547912598, "mode": "train", "epoch": 40}
{"loss": 0.11158580332994461, "acc": 0.9717215299606323, "length": 3.0, "mode": "test", "epoch": 40}
{"loss": 0.10122925788164139, "acc": 0.9745442271232605, "length": 3.0000011920928955, "mode": "train", "epoch": 41}
{"loss": 0.11379830539226532, "acc": 0.9725895524024963, "length": 3.0, "mode": "test", "epoch": 41}
{"loss": 0.10303241014480591, "acc": 0.9737555384635925, "length": 3.0000131130218506, "mode": "train", "epoch": 42}
{"loss": 0.11092370003461838, "acc": 0.9726833701133728, "length": 3.0, "mode": "test", "epoch": 42}
{"loss": 0.09919362515211105, "acc": 0.9750912189483643, "length": 3.0000040531158447, "mode": "train", "epoch": 43}
{"loss": 0.11103709787130356, "acc": 0.9728962779045105, "length": 3.0, "mode": "test", "epoch": 43}
{"loss": 0.09880917519330978, "acc": 0.9752638936042786, "length": 3.0000112056732178, "mode": "train", "epoch": 44}
{"loss": 0.1109696701169014, "acc": 0.973237156867981, "length": 3.0, "mode": "test", "epoch": 44}
{"loss": 0.1004137471318245, "acc": 0.9748634099960327, "length": 2.9999985694885254, "mode": "train", "epoch": 45}
{"loss": 0.11025817692279816, "acc": 0.9730784893035889, "length": 3.0, "mode": "test", "epoch": 45}
{"loss": 0.09746753424406052, "acc": 0.9757143259048462, "length": 3.000000238418579, "mode": "train", "epoch": 46}
{"loss": 0.10544021427631378, "acc": 0.9742134213447571, "length": 3.0, "mode": "test", "epoch": 46}
{"loss": 0.09520993381738663, "acc": 0.9764196872711182, "length": 3.000000238418579, "mode": "train", "epoch": 47}
{"loss": 0.10452990978956223, "acc": 0.9750000238418579, "length": 3.0, "mode": "test", "epoch": 47}
{"loss": 0.09921573102474213, "acc": 0.9753538966178894, "length": 3.000028371810913, "mode": "train", "epoch": 48}
{"loss": 0.11841848492622375, "acc": 0.9701771140098572, "length": 3.0, "mode": "test", "epoch": 48}
{"loss": 0.09803268313407898, "acc": 0.9752480983734131, "length": 2.9999947547912598, "mode": "train", "epoch": 49}
{"loss": 0.10972118377685547, "acc": 0.9731658101081848, "length": 2.9999639987945557, "mode": "test", "epoch": 49}
{"loss": 0.09633393585681915, "acc": 0.9760963916778564, "length": 2.9999969005584717, "mode": "train", "epoch": 50}
{"loss": 0.11351895332336426, "acc": 0.9724199175834656, "length": 3.0, "mode": "test", "epoch": 50}
{"loss": 0.09712745994329453, "acc": 0.975888729095459, "length": 3.000018835067749, "mode": "train", "epoch": 51}
{"loss": 0.11077290028333664, "acc": 0.9723657965660095, "length": 3.0, "mode": "test", "epoch": 51}
{"loss": 0.0953194722533226, "acc": 0.9763438701629639, "length": 3.000002861022949, "mode": "train", "epoch": 52}
{"loss": 0.10260167717933655, "acc": 0.975402295589447, "length": 3.0, "mode": "test", "epoch": 52}
{"loss": 0.09542275220155716, "acc": 0.9763976335525513, "length": 3.000013589859009, "mode": "train", "epoch": 53}
{"loss": 0.10683183372020721, "acc": 0.9738235473632812, "length": 3.0, "mode": "test", "epoch": 53}
{"loss": 0.0971924364566803, "acc": 0.9756724238395691, "length": 2.999985456466675, "mode": "train", "epoch": 54}
{"loss": 0.10395456105470657, "acc": 0.974622905254364, "length": 3.0, "mode": "test", "epoch": 54}
{"loss": 0.09388977289199829, "acc": 0.9767306447029114, "length": 2.9999685287475586, "mode": "train", "epoch": 55}
{"loss": 0.10380043089389801, "acc": 0.9753067493438721, "length": 3.0, "mode": "test", "epoch": 55}
{"loss": 0.09430745989084244, "acc": 0.9766635298728943, "length": 3.000020742416382, "mode": "train", "epoch": 56}
{"loss": 0.10611458867788315, "acc": 0.974496603012085, "length": 3.0, "mode": "test", "epoch": 56}
{"loss": 0.09650962054729462, "acc": 0.9760598540306091, "length": 2.9999992847442627, "mode": "train", "epoch": 57}
{"loss": 0.10622947663068771, "acc": 0.9734195470809937, "length": 3.0, "mode": "test", "epoch": 57}
{"loss": 0.09769278019666672, "acc": 0.9752637147903442, "length": 2.999998092651367, "mode": "train", "epoch": 58}
{"loss": 0.10700859129428864, "acc": 0.9741953611373901, "length": 3.0, "mode": "test", "epoch": 58}
{"loss": 0.09667617082595825, "acc": 0.9758995175361633, "length": 2.9999890327453613, "mode": "train", "epoch": 59}
{"loss": 0.1093771904706955, "acc": 0.9740419983863831, "length": 3.0, "mode": "test", "epoch": 59}
{"loss": 0.0962146446108818, "acc": 0.9761311411857605, "length": 2.9999916553497314, "mode": "train", "epoch": 60}
{"loss": 0.10526898503303528, "acc": 0.9744459986686707, "length": 3.0, "mode": "test", "epoch": 60}
test accuracy: 0.8996148705482483
