ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.6913265585899353, "acc": 0.5344539880752563, "length": 4.397189140319824, "mode": "train", "epoch": 1}
{"loss": 0.6666725873947144, "acc": 0.6103299260139465, "length": 2.305555582046509, "mode": "test", "epoch": 1}
{"loss": 0.6052312254905701, "acc": 0.6647862792015076, "length": 3.9979310035705566, "mode": "train", "epoch": 2}
{"loss": 0.6611157655715942, "acc": 0.6584988236427307, "length": 2.65625, "mode": "test", "epoch": 2}
{"loss": 0.5175502300262451, "acc": 0.7491438984870911, "length": 4.156486988067627, "mode": "train", "epoch": 3}
{"loss": 0.5992116928100586, "acc": 0.7320991158485413, "length": 4.675347328186035, "mode": "test", "epoch": 3}
{"loss": 0.42922475934028625, "acc": 0.8109870553016663, "length": 5.098687171936035, "mode": "train", "epoch": 4}
{"loss": 0.6041979193687439, "acc": 0.7570556402206421, "length": 6.201388835906982, "mode": "test", "epoch": 4}
{"loss": 0.36308997869491577, "acc": 0.8462352156639099, "length": 6.414748668670654, "mode": "train", "epoch": 5}
{"loss": 0.4535009562969208, "acc": 0.816563606262207, "length": 6.173611164093018, "mode": "test", "epoch": 5}
{"loss": 0.32951295375823975, "acc": 0.8637916445732117, "length": 6.963784217834473, "mode": "train", "epoch": 6}
{"loss": 0.4404800236225128, "acc": 0.8213379383087158, "length": 5.69444465637207, "mode": "test", "epoch": 6}
{"loss": 0.30441832542419434, "acc": 0.8786431550979614, "length": 7.024080276489258, "mode": "train", "epoch": 7}
{"loss": 0.3687555193901062, "acc": 0.8544080257415771, "length": 6.81944465637207, "mode": "test", "epoch": 7}
{"loss": 0.2759404182434082, "acc": 0.8952082991600037, "length": 8.143362045288086, "mode": "train", "epoch": 8}
{"loss": 0.33539295196533203, "acc": 0.8723443150520325, "length": 8.14236068725586, "mode": "test", "epoch": 8}
{"loss": 0.24693387746810913, "acc": 0.908940851688385, "length": 9.064203262329102, "mode": "train", "epoch": 9}
{"loss": 0.29416999220848083, "acc": 0.8946235179901123, "length": 8.65798568725586, "mode": "test", "epoch": 9}
{"loss": 0.2224176675081253, "acc": 0.9209474921226501, "length": 9.27956485748291, "mode": "train", "epoch": 10}
{"loss": 0.292312890291214, "acc": 0.8954020738601685, "length": 9.010416984558105, "mode": "test", "epoch": 10}
{"loss": 0.20205454528331757, "acc": 0.9284533858299255, "length": 8.94998550415039, "mode": "train", "epoch": 11}
{"loss": 0.2534491717815399, "acc": 0.9114285707473755, "length": 7.918402671813965, "mode": "test", "epoch": 11}
{"loss": 0.18474990129470825, "acc": 0.9359379410743713, "length": 9.359431266784668, "mode": "train", "epoch": 12}
{"loss": 0.22857911884784698, "acc": 0.9228379726409912, "length": 9.302083015441895, "mode": "test", "epoch": 12}
{"loss": 0.16901424527168274, "acc": 0.9421948790550232, "length": 9.546630859375, "mode": "train", "epoch": 13}
{"loss": 0.21529139578342438, "acc": 0.9259141087532043, "length": 9.640625, "mode": "test", "epoch": 13}
{"loss": 0.15581746399402618, "acc": 0.9467800855636597, "length": 9.917375564575195, "mode": "train", "epoch": 14}
{"loss": 0.196879044175148, "acc": 0.9352267384529114, "length": 10.14236068725586, "mode": "test", "epoch": 14}
{"loss": 0.14450916647911072, "acc": 0.9509746432304382, "length": 10.357664108276367, "mode": "train", "epoch": 15}
{"loss": 0.18160200119018555, "acc": 0.9373562335968018, "length": 9.60243034362793, "mode": "test", "epoch": 15}
{"loss": 0.13907919824123383, "acc": 0.9522539973258972, "length": 10.293455123901367, "mode": "train", "epoch": 16}
{"loss": 0.17307692766189575, "acc": 0.9401719570159912, "length": 9.53993034362793, "mode": "test", "epoch": 16}
{"loss": 0.12587255239486694, "acc": 0.9589905738830566, "length": 9.441682815551758, "mode": "train", "epoch": 17}
{"loss": 0.14665216207504272, "acc": 0.9491590857505798, "length": 10.02951431274414, "mode": "test", "epoch": 17}
{"loss": 0.11609527468681335, "acc": 0.9613903164863586, "length": 9.284605026245117, "mode": "train", "epoch": 18}
{"loss": 0.13890208303928375, "acc": 0.9525445103645325, "length": 10.371527671813965, "mode": "test", "epoch": 18}
{"loss": 0.10019557178020477, "acc": 0.9689029455184937, "length": 10.132301330566406, "mode": "train", "epoch": 19}
{"loss": 0.12864458560943604, "acc": 0.9588026404380798, "length": 11.434027671813965, "mode": "test", "epoch": 19}
{"loss": 0.08576361835002899, "acc": 0.9748044013977051, "length": 10.458561897277832, "mode": "train", "epoch": 20}
{"loss": 0.10761358588933945, "acc": 0.9633002877235413, "length": 10.94618034362793, "mode": "test", "epoch": 20}
{"loss": 0.07489049434661865, "acc": 0.9782887101173401, "length": 10.828280448913574, "mode": "train", "epoch": 21}
{"loss": 0.09257795661687851, "acc": 0.9722384214401245, "length": 11.411458015441895, "mode": "test", "epoch": 21}
{"loss": 0.06392721086740494, "acc": 0.9834362268447876, "length": 10.777265548706055, "mode": "train", "epoch": 22}
{"loss": 0.09191366285085678, "acc": 0.9723604917526245, "length": 10.942708015441895, "mode": "test", "epoch": 22}
{"loss": 0.056938886642456055, "acc": 0.9857224822044373, "length": 10.895074844360352, "mode": "train", "epoch": 23}
{"loss": 0.0724811777472496, "acc": 0.9798909425735474, "length": 11.276041984558105, "mode": "test", "epoch": 23}
{"loss": 0.04987119883298874, "acc": 0.9884527921676636, "length": 11.562458038330078, "mode": "train", "epoch": 24}
{"loss": 0.06721833348274231, "acc": 0.9815728068351746, "length": 11.36111068725586, "mode": "test", "epoch": 24}
{"loss": 0.04504189267754555, "acc": 0.9904152750968933, "length": 11.348471641540527, "mode": "train", "epoch": 25}
{"loss": 0.08730202913284302, "acc": 0.9724392294883728, "length": 10.18055534362793, "mode": "test", "epoch": 25}
{"loss": 0.04121118783950806, "acc": 0.9919918179512024, "length": 10.86613655090332, "mode": "train", "epoch": 26}
{"loss": 0.07260626554489136, "acc": 0.9797118306159973, "length": 10.559027671813965, "mode": "test", "epoch": 26}
{"loss": 0.04078762233257294, "acc": 0.9911021590232849, "length": 11.43202018737793, "mode": "train", "epoch": 27}
{"loss": 0.06291826069355011, "acc": 0.9805094599723816, "length": 11.175347328186035, "mode": "test", "epoch": 27}
{"loss": 0.035373345017433167, "acc": 0.993949830532074, "length": 11.375130653381348, "mode": "train", "epoch": 28}
{"loss": 0.04669325053691864, "acc": 0.9894585013389587, "length": 11.53819465637207, "mode": "test", "epoch": 28}
{"loss": 0.02776714786887169, "acc": 0.9969602227210999, "length": 10.932482719421387, "mode": "train", "epoch": 29}
{"loss": 0.048769816756248474, "acc": 0.9870144724845886, "length": 10.739583015441895, "mode": "test", "epoch": 29}
{"loss": 0.027353521436452866, "acc": 0.9967716932296753, "length": 11.388219833374023, "mode": "train", "epoch": 30}
{"loss": 0.039317794144153595, "acc": 0.9917371273040771, "length": 10.50694465637207, "mode": "test", "epoch": 30}
{"loss": 0.041451819241046906, "acc": 0.9916175007820129, "length": 10.492292404174805, "mode": "train", "epoch": 31}
{"loss": 0.051749832928180695, "acc": 0.9883517026901245, "length": 9.50868034362793, "mode": "test", "epoch": 31}
{"loss": 0.025634760037064552, "acc": 0.9968599081039429, "length": 10.126190185546875, "mode": "train", "epoch": 32}
{"loss": 0.04703085124492645, "acc": 0.9896729588508606, "length": 10.22743034362793, "mode": "test", "epoch": 32}
{"loss": 0.0197510477155447, "acc": 0.9985591769218445, "length": 10.487985610961914, "mode": "train", "epoch": 33}
{"loss": 0.03258125111460686, "acc": 0.993128776550293, "length": 10.078125, "mode": "test", "epoch": 33}
{"loss": 0.018154993653297424, "acc": 0.9991126656532288, "length": 10.359696388244629, "mode": "train", "epoch": 34}
{"loss": 0.03483351692557335, "acc": 0.9913167953491211, "length": 10.197916984558105, "mode": "test", "epoch": 34}
{"loss": 0.024419471621513367, "acc": 0.9967599511146545, "length": 9.509410858154297, "mode": "train", "epoch": 35}
{"loss": 0.03709535300731659, "acc": 0.9904378056526184, "length": 8.76388931274414, "mode": "test", "epoch": 35}
{"loss": 0.019459601491689682, "acc": 0.9978615641593933, "length": 9.017931938171387, "mode": "train", "epoch": 36}
{"loss": 0.03209921717643738, "acc": 0.9935709834098816, "length": 8.762152671813965, "mode": "test", "epoch": 36}
{"loss": 0.01918717287480831, "acc": 0.997553825378418, "length": 9.293285369873047, "mode": "train", "epoch": 37}
{"loss": 0.03588255122303963, "acc": 0.9909803867340088, "length": 8.68055534362793, "mode": "test", "epoch": 37}
{"loss": 0.0201692096889019, "acc": 0.9975101947784424, "length": 9.145292282104492, "mode": "train", "epoch": 38}
{"loss": 0.033086273819208145, "acc": 0.9911295771598816, "length": 9.161458015441895, "mode": "test", "epoch": 38}
{"loss": 0.01515366043895483, "acc": 0.9990590214729309, "length": 9.085066795349121, "mode": "train", "epoch": 39}
{"loss": 0.02338414452970028, "acc": 0.9967882633209229, "length": 8.817708015441895, "mode": "test", "epoch": 39}
{"loss": 0.01319921761751175, "acc": 0.9996474981307983, "length": 8.878640174865723, "mode": "train", "epoch": 40}
{"loss": 0.02036387100815773, "acc": 0.9969238638877869, "length": 8.487847328186035, "mode": "test", "epoch": 40}
{"loss": 0.01246737502515316, "acc": 0.9996998310089111, "length": 8.79415512084961, "mode": "train", "epoch": 41}
{"loss": 0.025604434311389923, "acc": 0.9956597089767456, "length": 8.57118034362793, "mode": "test", "epoch": 41}
{"loss": 0.02040395885705948, "acc": 0.9969324469566345, "length": 8.512224197387695, "mode": "train", "epoch": 42}
{"loss": 0.031195372343063354, "acc": 0.9916775226593018, "length": 7.572916507720947, "mode": "test", "epoch": 42}
{"loss": 0.014160451479256153, "acc": 0.9989232420921326, "length": 8.005548477172852, "mode": "train", "epoch": 43}
{"loss": 0.022191137075424194, "acc": 0.9964383244514465, "length": 7.82118034362793, "mode": "test", "epoch": 43}
{"loss": 0.014519539661705494, "acc": 0.9986640214920044, "length": 8.693404197692871, "mode": "train", "epoch": 44}
{"loss": 0.03374910727143288, "acc": 0.9896266460418701, "length": 9.37326431274414, "mode": "test", "epoch": 44}
{"loss": 0.012478906661272049, "acc": 0.9991813898086548, "length": 9.140608787536621, "mode": "train", "epoch": 45}
{"loss": 0.022640623152256012, "acc": 0.9953911900520325, "length": 8.597222328186035, "mode": "test", "epoch": 45}
{"loss": 0.017466140910983086, "acc": 0.9978267550468445, "length": 8.781593322753906, "mode": "train", "epoch": 46}
{"loss": 0.029186120256781578, "acc": 0.9937770366668701, "length": 8.80555534362793, "mode": "test", "epoch": 46}
{"loss": 0.03519657254219055, "acc": 0.9915697574615479, "length": 9.555712699890137, "mode": "train", "epoch": 47}
{"loss": 0.031933899968862534, "acc": 0.9919760227203369, "length": 9.04513931274414, "mode": "test", "epoch": 47}
{"loss": 0.022429000586271286, "acc": 0.9956578612327576, "length": 9.742127418518066, "mode": "train", "epoch": 48}
{"loss": 0.03716309368610382, "acc": 0.9930338263511658, "length": 9.621527671813965, "mode": "test", "epoch": 48}
{"loss": 0.018112150952219963, "acc": 0.9975638389587402, "length": 9.539896011352539, "mode": "train", "epoch": 49}
{"loss": 0.03538931906223297, "acc": 0.9924695491790771, "length": 9.088541984558105, "mode": "test", "epoch": 49}
{"loss": 0.015139959752559662, "acc": 0.9980120658874512, "length": 9.708795547485352, "mode": "train", "epoch": 50}
{"loss": 0.017269955947995186, "acc": 0.9978922605514526, "length": 9.26388931274414, "mode": "test", "epoch": 50}
{"loss": 0.014168702997267246, "acc": 0.9986851215362549, "length": 9.104228973388672, "mode": "train", "epoch": 51}
{"loss": 0.025051875039935112, "acc": 0.9951280951499939, "length": 8.64236068725586, "mode": "test", "epoch": 51}
{"loss": 0.01254661288112402, "acc": 0.998803436756134, "length": 9.088008880615234, "mode": "train", "epoch": 52}
{"loss": 0.024473344907164574, "acc": 0.9951930642127991, "length": 9.050347328186035, "mode": "test", "epoch": 52}
{"loss": 0.01664714142680168, "acc": 0.9981871843338013, "length": 9.335854530334473, "mode": "train", "epoch": 53}
{"loss": 0.019820647314190865, "acc": 0.9975314736366272, "length": 8.559027671813965, "mode": "test", "epoch": 53}
{"loss": 0.017425764352083206, "acc": 0.9968020915985107, "length": 9.201128005981445, "mode": "train", "epoch": 54}
{"loss": 0.020231256261467934, "acc": 0.9960504174232483, "length": 9.088541984558105, "mode": "test", "epoch": 54}
{"loss": 0.01056339405477047, "acc": 0.9993530511856079, "length": 9.002473831176758, "mode": "train", "epoch": 55}
{"loss": 0.019796064123511314, "acc": 0.9967068433761597, "length": 8.56076431274414, "mode": "test", "epoch": 55}
{"loss": 0.008969920687377453, "acc": 0.9998488426208496, "length": 8.7483549118042, "mode": "train", "epoch": 56}
{"loss": 0.020053595304489136, "acc": 0.9959201812744141, "length": 8.45486068725586, "mode": "test", "epoch": 56}
{"loss": 0.010368707589805126, "acc": 0.9992828369140625, "length": 8.639059066772461, "mode": "train", "epoch": 57}
{"loss": 0.0164360199123621, "acc": 0.9969020485877991, "length": 8.072916984558105, "mode": "test", "epoch": 57}
{"loss": 0.010373175144195557, "acc": 0.9992061853408813, "length": 8.554780960083008, "mode": "train", "epoch": 58}
{"loss": 0.016763709485530853, "acc": 0.9976726174354553, "length": 8.72743034362793, "mode": "test", "epoch": 58}
{"loss": 0.008242271840572357, "acc": 0.9999229907989502, "length": 8.540346145629883, "mode": "train", "epoch": 59}
{"loss": 0.011284572072327137, "acc": 0.9987603425979614, "length": 8.18055534362793, "mode": "test", "epoch": 59}
{"loss": 0.008113536983728409, "acc": 0.9998371601104736, "length": 8.328790664672852, "mode": "train", "epoch": 60}
{"loss": 0.019435489550232887, "acc": 0.9963868260383606, "length": 8.480902671813965, "mode": "test", "epoch": 60}
test accuracy: 0.8761484026908875
