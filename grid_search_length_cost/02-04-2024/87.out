ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.35030049085617065, "acc": 0.8460042476654053, "length": 8.068720817565918, "mode": "train", "epoch": 1}
{"loss": 0.2935962378978729, "acc": 0.8840606212615967, "length": 10.931632995605469, "mode": "test", "epoch": 1}
{"loss": 0.21275366842746735, "acc": 0.9313631057739258, "length": 10.84087085723877, "mode": "train", "epoch": 2}
{"loss": 0.22554799914360046, "acc": 0.9258400201797485, "length": 11.0, "mode": "test", "epoch": 2}
{"loss": 0.1558302491903305, "acc": 0.953106701374054, "length": 10.991036415100098, "mode": "train", "epoch": 3}
{"loss": 0.20110677182674408, "acc": 0.9305554628372192, "length": 11.0, "mode": "test", "epoch": 3}
{"loss": 0.11713584512472153, "acc": 0.9685377478599548, "length": 10.999594688415527, "mode": "train", "epoch": 4}
{"loss": 0.17462822794914246, "acc": 0.9436442852020264, "length": 11.0, "mode": "test", "epoch": 4}
{"loss": 0.08257865160703659, "acc": 0.9802737832069397, "length": 10.999958038330078, "mode": "train", "epoch": 5}
{"loss": 0.13228380680084229, "acc": 0.9608856439590454, "length": 11.0, "mode": "test", "epoch": 5}
{"loss": 0.06755068898200989, "acc": 0.9857459664344788, "length": 10.999985694885254, "mode": "train", "epoch": 6}
{"loss": 0.10115968436002731, "acc": 0.9731581807136536, "length": 11.0, "mode": "test", "epoch": 6}
{"loss": 0.061240099370479584, "acc": 0.9878566265106201, "length": 11.0, "mode": "train", "epoch": 7}
{"loss": 0.12391926348209381, "acc": 0.9664251804351807, "length": 11.0, "mode": "test", "epoch": 7}
{"loss": 0.05742206797003746, "acc": 0.9887670278549194, "length": 11.0, "mode": "train", "epoch": 8}
{"loss": 0.09213761240243912, "acc": 0.9773247241973877, "length": 11.0, "mode": "test", "epoch": 8}
{"loss": 0.05774272233247757, "acc": 0.9885205626487732, "length": 11.0, "mode": "train", "epoch": 9}
{"loss": 0.104582279920578, "acc": 0.9727808833122253, "length": 11.0, "mode": "test", "epoch": 9}
{"loss": 0.05604343116283417, "acc": 0.9889378547668457, "length": 11.0, "mode": "train", "epoch": 10}
{"loss": 0.07201958447694778, "acc": 0.9843190312385559, "length": 11.0, "mode": "test", "epoch": 10}
{"loss": 0.05465517193078995, "acc": 0.9891326427459717, "length": 11.0, "mode": "train", "epoch": 11}
{"loss": 0.07780834287405014, "acc": 0.980449914932251, "length": 11.0, "mode": "test", "epoch": 11}
{"loss": 0.047394249588251114, "acc": 0.9897559881210327, "length": 11.0, "mode": "train", "epoch": 12}
{"loss": 0.07783283293247223, "acc": 0.9795917868614197, "length": 11.0, "mode": "test", "epoch": 12}
{"loss": 0.0347084105014801, "acc": 0.9934854507446289, "length": 11.0, "mode": "train", "epoch": 13}
{"loss": 0.08854492008686066, "acc": 0.9770414233207703, "length": 11.0, "mode": "test", "epoch": 13}
{"loss": 0.0291182529181242, "acc": 0.994251012802124, "length": 11.0, "mode": "train", "epoch": 14}
{"loss": 0.05026993528008461, "acc": 0.9886434674263, "length": 11.0, "mode": "test", "epoch": 14}
{"loss": 0.024654177948832512, "acc": 0.9955694079399109, "length": 11.0, "mode": "train", "epoch": 15}
{"loss": 0.090977743268013, "acc": 0.9739043712615967, "length": 11.0, "mode": "test", "epoch": 15}
{"loss": 0.022028585895895958, "acc": 0.996113657951355, "length": 11.0, "mode": "train", "epoch": 16}
{"loss": 0.043131086975336075, "acc": 0.9881007075309753, "length": 11.0, "mode": "test", "epoch": 16}
{"loss": 0.023354925215244293, "acc": 0.9957396388053894, "length": 11.0, "mode": "train", "epoch": 17}
{"loss": 0.05192368105053902, "acc": 0.9838880300521851, "length": 11.0, "mode": "test", "epoch": 17}
{"loss": 0.01574903167784214, "acc": 0.997820258140564, "length": 11.0, "mode": "train", "epoch": 18}
{"loss": 0.04499712586402893, "acc": 0.987625777721405, "length": 11.0, "mode": "test", "epoch": 18}
{"loss": 0.016936389729380608, "acc": 0.9974967241287231, "length": 11.0, "mode": "train", "epoch": 19}
{"loss": 0.05809563770890236, "acc": 0.9838922619819641, "length": 11.0, "mode": "test", "epoch": 19}
{"loss": 0.014565253630280495, "acc": 0.9981093406677246, "length": 11.0, "mode": "train", "epoch": 20}
{"loss": 0.0359320230782032, "acc": 0.991838276386261, "length": 11.0, "mode": "test", "epoch": 20}
{"loss": 0.016244245693087578, "acc": 0.9976249933242798, "length": 11.0, "mode": "train", "epoch": 21}
{"loss": 0.03486217185854912, "acc": 0.9910580515861511, "length": 11.0, "mode": "test", "epoch": 21}
{"loss": 0.017300037667155266, "acc": 0.9973105788230896, "length": 11.0, "mode": "train", "epoch": 22}
{"loss": 0.02941729687154293, "acc": 0.9937397837638855, "length": 11.0, "mode": "test", "epoch": 22}
{"loss": 0.012744417414069176, "acc": 0.9985712170600891, "length": 11.0, "mode": "train", "epoch": 23}
{"loss": 0.04245615750551224, "acc": 0.9904912710189819, "length": 11.0, "mode": "test", "epoch": 23}
{"loss": 0.012829546816647053, "acc": 0.9985272884368896, "length": 11.0, "mode": "train", "epoch": 24}
{"loss": 0.022178564220666885, "acc": 0.9959410429000854, "length": 11.0, "mode": "test", "epoch": 24}
{"loss": 0.015032798983156681, "acc": 0.9979272484779358, "length": 11.0, "mode": "train", "epoch": 25}
{"loss": 0.046893373131752014, "acc": 0.9891822934150696, "length": 11.0, "mode": "test", "epoch": 25}
{"loss": 0.017991559579968452, "acc": 0.9971563816070557, "length": 11.0, "mode": "train", "epoch": 26}
{"loss": 0.03686246648430824, "acc": 0.9925448298454285, "length": 11.0, "mode": "test", "epoch": 26}
{"loss": 0.022740835323929787, "acc": 0.9955874085426331, "length": 11.0, "mode": "train", "epoch": 27}
{"loss": 0.03145062178373337, "acc": 0.9936561584472656, "length": 11.0, "mode": "test", "epoch": 27}
{"loss": 0.012921422719955444, "acc": 0.9984104037284851, "length": 11.0, "mode": "train", "epoch": 28}
{"loss": 0.029358455911278725, "acc": 0.9941869378089905, "length": 11.0, "mode": "test", "epoch": 28}
{"loss": 0.014053672552108765, "acc": 0.9981797337532043, "length": 11.0, "mode": "train", "epoch": 29}
{"loss": 0.040710221976041794, "acc": 0.990321695804596, "length": 11.0, "mode": "test", "epoch": 29}
{"loss": 0.019193803891539574, "acc": 0.9967723488807678, "length": 11.0, "mode": "train", "epoch": 30}
{"loss": 0.032150644809007645, "acc": 0.9931853413581848, "length": 11.0, "mode": "test", "epoch": 30}
{"loss": 0.013870351016521454, "acc": 0.9982050657272339, "length": 11.0, "mode": "train", "epoch": 31}
{"loss": 0.05089598894119263, "acc": 0.9895833134651184, "length": 11.0, "mode": "test", "epoch": 31}
{"loss": 0.012000775896012783, "acc": 0.9986290335655212, "length": 11.0, "mode": "train", "epoch": 32}
{"loss": 0.022917471826076508, "acc": 0.9961046576499939, "length": 11.0, "mode": "test", "epoch": 32}
{"loss": 0.023692218586802483, "acc": 0.9951886534690857, "length": 11.0, "mode": "train", "epoch": 33}
{"loss": 0.064300037920475, "acc": 0.983189582824707, "length": 11.0, "mode": "test", "epoch": 33}
{"loss": 0.04192629083991051, "acc": 0.9895525574684143, "length": 11.0, "mode": "train", "epoch": 34}
{"loss": 0.042205289006233215, "acc": 0.9893576502799988, "length": 11.0, "mode": "test", "epoch": 34}
{"loss": 0.03298493102192879, "acc": 0.991886556148529, "length": 11.0, "mode": "train", "epoch": 35}
{"loss": 0.04610433056950569, "acc": 0.9881865382194519, "length": 11.0, "mode": "test", "epoch": 35}
{"loss": 0.02868741936981678, "acc": 0.9932953119277954, "length": 11.0, "mode": "train", "epoch": 36}
{"loss": 0.037391297519207, "acc": 0.9910300970077515, "length": 11.0, "mode": "test", "epoch": 36}
{"loss": 0.030261941254138947, "acc": 0.9930442571640015, "length": 11.0, "mode": "train", "epoch": 37}
{"loss": 0.03489978238940239, "acc": 0.9925087094306946, "length": 11.0, "mode": "test", "epoch": 37}
{"loss": 0.02517148107290268, "acc": 0.9946237802505493, "length": 11.0, "mode": "train", "epoch": 38}
{"loss": 0.03637107089161873, "acc": 0.9911319017410278, "length": 11.0, "mode": "test", "epoch": 38}
{"loss": 0.023202236741781235, "acc": 0.9954704642295837, "length": 11.0, "mode": "train", "epoch": 39}
{"loss": 0.03716697171330452, "acc": 0.9926345348358154, "length": 11.0, "mode": "test", "epoch": 39}
{"loss": 0.025368954986333847, "acc": 0.9946703314781189, "length": 11.0, "mode": "train", "epoch": 40}
{"loss": 0.043086640536785126, "acc": 0.9898408055305481, "length": 11.0, "mode": "test", "epoch": 40}
{"loss": 0.06170937046408653, "acc": 0.9833610653877258, "length": 11.0, "mode": "train", "epoch": 41}
{"loss": 0.07685081660747528, "acc": 0.979170560836792, "length": 11.0, "mode": "test", "epoch": 41}
{"loss": 0.09739477932453156, "acc": 0.9688199758529663, "length": 11.0, "mode": "train", "epoch": 42}
{"loss": 0.16268561780452728, "acc": 0.9434946179389954, "length": 11.0, "mode": "test", "epoch": 42}
{"loss": 0.12941424548625946, "acc": 0.9528422355651855, "length": 11.0, "mode": "train", "epoch": 43}
{"loss": 0.1270616352558136, "acc": 0.9582235813140869, "length": 11.0, "mode": "test", "epoch": 43}
{"loss": 0.07595115154981613, "acc": 0.9761912822723389, "length": 11.0, "mode": "train", "epoch": 44}
{"loss": 0.08201368153095245, "acc": 0.977644145488739, "length": 11.0, "mode": "test", "epoch": 44}
{"loss": 0.0500083863735199, "acc": 0.9863833785057068, "length": 11.0, "mode": "train", "epoch": 45}
{"loss": 0.07396883517503738, "acc": 0.9806632995605469, "length": 11.0, "mode": "test", "epoch": 45}
{"loss": 0.03781072050333023, "acc": 0.9904830455780029, "length": 11.0, "mode": "train", "epoch": 46}
{"loss": 0.0780957043170929, "acc": 0.9778956174850464, "length": 11.0, "mode": "test", "epoch": 46}
{"loss": 0.15615946054458618, "acc": 0.9407142400741577, "length": 11.0, "mode": "train", "epoch": 47}
{"loss": 0.18883101642131805, "acc": 0.9293901324272156, "length": 11.0, "mode": "test", "epoch": 47}
{"loss": 0.1662835031747818, "acc": 0.9344595074653625, "length": 11.0, "mode": "train", "epoch": 48}
{"loss": 0.2102401703596115, "acc": 0.9159103035926819, "length": 11.0, "mode": "test", "epoch": 48}
{"loss": 0.1689782589673996, "acc": 0.9328930974006653, "length": 11.0, "mode": "train", "epoch": 49}
{"loss": 0.18646305799484253, "acc": 0.9301464557647705, "length": 11.0, "mode": "test", "epoch": 49}
{"loss": 0.20939762890338898, "acc": 0.9150632619857788, "length": 11.0, "mode": "train", "epoch": 50}
{"loss": 0.21531657874584198, "acc": 0.9164311289787292, "length": 11.0, "mode": "test", "epoch": 50}
{"loss": 0.18554286658763885, "acc": 0.92853844165802, "length": 11.0, "mode": "train", "epoch": 51}
{"loss": 0.16251057386398315, "acc": 0.9437419772148132, "length": 11.0, "mode": "test", "epoch": 51}
{"loss": 0.14712397754192352, "acc": 0.9481020569801331, "length": 11.0, "mode": "train", "epoch": 52}
{"loss": 0.18410781025886536, "acc": 0.933337390422821, "length": 11.0, "mode": "test", "epoch": 52}
{"loss": 0.14432813227176666, "acc": 0.9485518932342529, "length": 11.0, "mode": "train", "epoch": 53}
{"loss": 0.16132228076457977, "acc": 0.9429996609687805, "length": 11.0, "mode": "test", "epoch": 53}
{"loss": 0.1556149125099182, "acc": 0.9444988369941711, "length": 11.0, "mode": "train", "epoch": 54}
{"loss": 0.19961321353912354, "acc": 0.9265345335006714, "length": 11.0, "mode": "test", "epoch": 54}
{"loss": 0.16442739963531494, "acc": 0.9403148889541626, "length": 11.0, "mode": "train", "epoch": 55}
{"loss": 0.18442150950431824, "acc": 0.9321539402008057, "length": 11.0, "mode": "test", "epoch": 55}
{"loss": 0.170280322432518, "acc": 0.937371551990509, "length": 11.0, "mode": "train", "epoch": 56}
{"loss": 0.21638120710849762, "acc": 0.9189035892486572, "length": 11.0, "mode": "test", "epoch": 56}
{"loss": 0.1969594955444336, "acc": 0.9246765971183777, "length": 11.0, "mode": "train", "epoch": 57}
{"loss": 0.2348928600549698, "acc": 0.9085786938667297, "length": 11.0, "mode": "test", "epoch": 57}
{"loss": 0.2236359566450119, "acc": 0.9104806780815125, "length": 11.0, "mode": "train", "epoch": 58}
{"loss": 0.2539781928062439, "acc": 0.8991838693618774, "length": 11.0, "mode": "test", "epoch": 58}
{"loss": 0.23258143663406372, "acc": 0.904516875743866, "length": 11.0, "mode": "train", "epoch": 59}
{"loss": 0.2287093698978424, "acc": 0.9099576473236084, "length": 11.0, "mode": "test", "epoch": 59}
{"loss": 0.2300240397453308, "acc": 0.9049050211906433, "length": 11.0, "mode": "train", "epoch": 60}
{"loss": 0.3121531903743744, "acc": 0.8661438822746277, "length": 11.0, "mode": "test", "epoch": 60}
test accuracy: 0.8587135076522827
