ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 20
{"loss": 0.698931097984314, "acc": 0.5012117624282837, "length": 1.1129686832427979, "mode": "train", "epoch": 1}
{"loss": 0.6982053518295288, "acc": 0.502012312412262, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6502159833908081, "acc": 0.5739820599555969, "length": 1.1904720067977905, "mode": "train", "epoch": 2}
{"loss": 0.5119978785514832, "acc": 0.7672978639602661, "length": 1.6682442426681519, "mode": "test", "epoch": 2}
{"loss": 0.32352107763290405, "acc": 0.88414067029953, "length": 2.7910900115966797, "mode": "train", "epoch": 3}
{"loss": 0.3185991644859314, "acc": 0.8806264400482178, "length": 2.87406063079834, "mode": "test", "epoch": 3}
{"loss": 0.22949129343032837, "acc": 0.9276546239852905, "length": 3.0512685775756836, "mode": "train", "epoch": 4}
{"loss": 0.2676539123058319, "acc": 0.9070967435836792, "length": 3.0618858337402344, "mode": "test", "epoch": 4}
{"loss": 0.19040609896183014, "acc": 0.944911003112793, "length": 3.156519889831543, "mode": "train", "epoch": 5}
{"loss": 0.24835263192653656, "acc": 0.9135034680366516, "length": 3.09468936920166, "mode": "test", "epoch": 5}
{"loss": 0.16752734780311584, "acc": 0.9553378820419312, "length": 3.2082014083862305, "mode": "train", "epoch": 6}
{"loss": 0.21637731790542603, "acc": 0.9335647225379944, "length": 3.134176254272461, "mode": "test", "epoch": 6}
{"loss": 0.1551293283700943, "acc": 0.9607866406440735, "length": 3.241607189178467, "mode": "train", "epoch": 7}
{"loss": 0.19520685076713562, "acc": 0.9415120482444763, "length": 3.216076612472534, "mode": "test", "epoch": 7}
{"loss": 0.1480112075805664, "acc": 0.9635960459709167, "length": 3.2772021293640137, "mode": "train", "epoch": 8}
{"loss": 0.1838933825492859, "acc": 0.9489575624465942, "length": 3.2587788105010986, "mode": "test", "epoch": 8}
{"loss": 0.14406563341617584, "acc": 0.9650439620018005, "length": 3.286102771759033, "mode": "train", "epoch": 9}
{"loss": 0.17368026077747345, "acc": 0.951535701751709, "length": 3.2913293838500977, "mode": "test", "epoch": 9}
{"loss": 0.13939252495765686, "acc": 0.9662565588951111, "length": 3.320037603378296, "mode": "train", "epoch": 10}
{"loss": 0.1649176925420761, "acc": 0.9538904428482056, "length": 3.30220365524292, "mode": "test", "epoch": 10}
{"loss": 0.13206054270267487, "acc": 0.9687439203262329, "length": 3.3517673015594482, "mode": "train", "epoch": 11}
{"loss": 0.1581992208957672, "acc": 0.9581079483032227, "length": 3.3383309841156006, "mode": "test", "epoch": 11}
{"loss": 0.12368293106555939, "acc": 0.9718441963195801, "length": 3.366738796234131, "mode": "train", "epoch": 12}
{"loss": 0.16360275447368622, "acc": 0.9572629928588867, "length": 3.350036144256592, "mode": "test", "epoch": 12}
{"loss": 0.11964826285839081, "acc": 0.973434567451477, "length": 3.3764591217041016, "mode": "train", "epoch": 13}
{"loss": 0.1446835696697235, "acc": 0.9624976515769958, "length": 3.3612356185913086, "mode": "test", "epoch": 13}
{"loss": 0.11674554646015167, "acc": 0.9743025302886963, "length": 3.38437557220459, "mode": "train", "epoch": 14}
{"loss": 0.1431955099105835, "acc": 0.9647737741470337, "length": 3.364884376525879, "mode": "test", "epoch": 14}
{"loss": 0.1126859113574028, "acc": 0.9759233593940735, "length": 3.3792331218719482, "mode": "train", "epoch": 15}
{"loss": 0.13814601302146912, "acc": 0.9669110178947449, "length": 3.35422682762146, "mode": "test", "epoch": 15}
{"loss": 0.110419362783432, "acc": 0.9768358469009399, "length": 3.370964527130127, "mode": "train", "epoch": 16}
{"loss": 0.12643836438655853, "acc": 0.9704266786575317, "length": 3.3572254180908203, "mode": "test", "epoch": 16}
{"loss": 0.10825210064649582, "acc": 0.977458119392395, "length": 3.3663599491119385, "mode": "train", "epoch": 17}
{"loss": 0.12796488404273987, "acc": 0.9688390493392944, "length": 3.35375714302063, "mode": "test", "epoch": 17}
{"loss": 0.10697447508573532, "acc": 0.978047788143158, "length": 3.372112989425659, "mode": "train", "epoch": 18}
{"loss": 0.12135006487369537, "acc": 0.9726095199584961, "length": 3.355888843536377, "mode": "test", "epoch": 18}
{"loss": 0.10579749941825867, "acc": 0.9783875942230225, "length": 3.3755109310150146, "mode": "train", "epoch": 19}
{"loss": 0.11975274235010147, "acc": 0.9738961458206177, "length": 3.368605375289917, "mode": "test", "epoch": 19}
{"loss": 0.10392869263887405, "acc": 0.9790567755699158, "length": 3.37450909614563, "mode": "train", "epoch": 20}
{"loss": 0.11968658864498138, "acc": 0.9725284576416016, "length": 3.375180721282959, "mode": "test", "epoch": 20}
{"loss": 0.1037263497710228, "acc": 0.9790782928466797, "length": 3.372467517852783, "mode": "train", "epoch": 21}
{"loss": 0.1210159882903099, "acc": 0.9725804924964905, "length": 3.3756141662597656, "mode": "test", "epoch": 21}
{"loss": 0.10297541320323944, "acc": 0.9792094230651855, "length": 3.371225357055664, "mode": "train", "epoch": 22}
{"loss": 0.11370906233787537, "acc": 0.9750640988349915, "length": 3.370267391204834, "mode": "test", "epoch": 22}
{"loss": 0.10334005206823349, "acc": 0.9789683222770691, "length": 3.3710343837738037, "mode": "train", "epoch": 23}
{"loss": 0.11665792018175125, "acc": 0.9750584363937378, "length": 3.3561055660247803, "mode": "test", "epoch": 23}
{"loss": 0.10202612727880478, "acc": 0.9795206189155579, "length": 3.377718925476074, "mode": "train", "epoch": 24}
{"loss": 0.11300226300954819, "acc": 0.9752430319786072, "length": 3.3770954608917236, "mode": "test", "epoch": 24}
{"loss": 0.10115975886583328, "acc": 0.9797734022140503, "length": 3.3671534061431885, "mode": "train", "epoch": 25}
{"loss": 0.11257846653461456, "acc": 0.976410984992981, "length": 3.3617053031921387, "mode": "test", "epoch": 25}
{"loss": 0.10128786414861679, "acc": 0.9796428680419922, "length": 3.3728675842285156, "mode": "train", "epoch": 26}
{"loss": 0.1181102842092514, "acc": 0.9743428826332092, "length": 3.3647758960723877, "mode": "test", "epoch": 26}
{"loss": 0.10026929527521133, "acc": 0.9798949360847473, "length": 3.369852066040039, "mode": "train", "epoch": 27}
{"loss": 0.11818055063486099, "acc": 0.9735649228096008, "length": 3.3731937408447266, "mode": "test", "epoch": 27}
{"loss": 0.10094627737998962, "acc": 0.9797109365463257, "length": 3.373523235321045, "mode": "train", "epoch": 28}
{"loss": 0.11115437000989914, "acc": 0.9770535230636597, "length": 3.3696532249450684, "mode": "test", "epoch": 28}
{"loss": 0.099955253303051, "acc": 0.9799737930297852, "length": 3.3736019134521484, "mode": "train", "epoch": 29}
{"loss": 0.11295922100543976, "acc": 0.9756565690040588, "length": 3.3938944339752197, "mode": "test", "epoch": 29}
{"loss": 0.10036171972751617, "acc": 0.9797469973564148, "length": 3.3816277980804443, "mode": "train", "epoch": 30}
{"loss": 0.11262061446905136, "acc": 0.9764741063117981, "length": 3.374349594116211, "mode": "test", "epoch": 30}
{"loss": 0.099118672311306, "acc": 0.9800697565078735, "length": 3.3837761878967285, "mode": "train", "epoch": 31}
{"loss": 0.11093795299530029, "acc": 0.9760286211967468, "length": 3.3917269706726074, "mode": "test", "epoch": 31}
{"loss": 0.09914013743400574, "acc": 0.9801575541496277, "length": 3.383854389190674, "mode": "train", "epoch": 32}
{"loss": 0.10881839692592621, "acc": 0.978006899356842, "length": 3.382225513458252, "mode": "test", "epoch": 32}
{"loss": 0.09803630411624908, "acc": 0.9804376363754272, "length": 3.3911495208740234, "mode": "train", "epoch": 33}
{"loss": 0.10953734815120697, "acc": 0.9770195484161377, "length": 3.4014089107513428, "mode": "test", "epoch": 33}
{"loss": 0.09714576601982117, "acc": 0.9806827902793884, "length": 3.393583059310913, "mode": "train", "epoch": 34}
{"loss": 0.10717131942510605, "acc": 0.9781836271286011, "length": 3.3946893215179443, "mode": "test", "epoch": 34}
{"loss": 0.09780970960855484, "acc": 0.9805399775505066, "length": 3.3968429565429688, "mode": "train", "epoch": 35}
{"loss": 0.10573001205921173, "acc": 0.9788833260536194, "length": 3.3919074535369873, "mode": "test", "epoch": 35}
{"loss": 0.09717917442321777, "acc": 0.9806239008903503, "length": 3.395357608795166, "mode": "train", "epoch": 36}
{"loss": 0.10877019912004471, "acc": 0.977708101272583, "length": 3.4062137603759766, "mode": "test", "epoch": 36}
{"loss": 0.09665444493293762, "acc": 0.9808117151260376, "length": 3.3963775634765625, "mode": "train", "epoch": 37}
{"loss": 0.10476507991552353, "acc": 0.9787036776542664, "length": 3.3939666748046875, "mode": "test", "epoch": 37}
{"loss": 0.09512735903263092, "acc": 0.9811724424362183, "length": 3.396070957183838, "mode": "train", "epoch": 38}
{"loss": 0.10421010851860046, "acc": 0.9793586730957031, "length": 3.3963510990142822, "mode": "test", "epoch": 38}
{"loss": 0.0963933914899826, "acc": 0.9808350205421448, "length": 3.406437873840332, "mode": "train", "epoch": 39}
{"loss": 0.10441206395626068, "acc": 0.9795615077018738, "length": 3.413475513458252, "mode": "test", "epoch": 39}
{"loss": 0.09634392708539963, "acc": 0.9809176325798035, "length": 3.409374237060547, "mode": "train", "epoch": 40}
{"loss": 0.10392339527606964, "acc": 0.979384183883667, "length": 3.403576612472534, "mode": "test", "epoch": 40}
{"loss": 0.09568961709737778, "acc": 0.9809716939926147, "length": 3.4108633995056152, "mode": "train", "epoch": 41}
{"loss": 0.10407501459121704, "acc": 0.9794211983680725, "length": 3.425072193145752, "mode": "test", "epoch": 41}
{"loss": 0.09630157798528671, "acc": 0.9808151125907898, "length": 3.4063894748687744, "mode": "train", "epoch": 42}
{"loss": 0.10499195009469986, "acc": 0.9790239930152893, "length": 3.4204840660095215, "mode": "test", "epoch": 42}
{"loss": 0.0947476327419281, "acc": 0.9812809824943542, "length": 3.4042415618896484, "mode": "train", "epoch": 43}
{"loss": 0.10446614027023315, "acc": 0.9786838293075562, "length": 3.4091763496398926, "mode": "test", "epoch": 43}
{"loss": 0.09393783658742905, "acc": 0.9814914464950562, "length": 3.399268865585327, "mode": "train", "epoch": 44}
{"loss": 0.10486555844545364, "acc": 0.9788106679916382, "length": 3.398627281188965, "mode": "test", "epoch": 44}
{"loss": 0.09417416155338287, "acc": 0.9813946485519409, "length": 3.398306131362915, "mode": "train", "epoch": 45}
{"loss": 0.10360841453075409, "acc": 0.9798495173454285, "length": 3.389270305633545, "mode": "test", "epoch": 45}
{"loss": 0.09425386041402817, "acc": 0.9813120365142822, "length": 3.401657819747925, "mode": "train", "epoch": 46}
{"loss": 0.10329627245664597, "acc": 0.9800613522529602, "length": 3.405527353286743, "mode": "test", "epoch": 46}
{"loss": 0.09553146362304688, "acc": 0.9810426235198975, "length": 3.418132781982422, "mode": "train", "epoch": 47}
{"loss": 0.10132021456956863, "acc": 0.979803204536438, "length": 3.4090678691864014, "mode": "test", "epoch": 47}
{"loss": 0.09409897029399872, "acc": 0.9811863303184509, "length": 3.4065334796905518, "mode": "train", "epoch": 48}
{"loss": 0.10365363210439682, "acc": 0.9790797829627991, "length": 3.4123194217681885, "mode": "test", "epoch": 48}
{"loss": 0.09488234668970108, "acc": 0.9812350273132324, "length": 3.408113718032837, "mode": "train", "epoch": 49}
{"loss": 0.10395310819149017, "acc": 0.9798893332481384, "length": 3.404588222503662, "mode": "test", "epoch": 49}
{"loss": 0.094951331615448, "acc": 0.9810326099395752, "length": 3.408412456512451, "mode": "train", "epoch": 50}
{"loss": 0.10134461522102356, "acc": 0.9802659153938293, "length": 3.4167630672454834, "mode": "test", "epoch": 50}
{"loss": 0.09336898475885391, "acc": 0.9816203713417053, "length": 3.41815447807312, "mode": "train", "epoch": 51}
{"loss": 0.10311923176050186, "acc": 0.9795734882354736, "length": 3.422579526901245, "mode": "test", "epoch": 51}
{"loss": 0.09341296553611755, "acc": 0.9814823269844055, "length": 3.421627998352051, "mode": "train", "epoch": 52}
{"loss": 0.09876203536987305, "acc": 0.98049396276474, "length": 3.409031867980957, "mode": "test", "epoch": 52}
{"loss": 0.0949811190366745, "acc": 0.980964720249176, "length": 3.41635799407959, "mode": "train", "epoch": 53}
{"loss": 0.09852483123540878, "acc": 0.9811338782310486, "length": 3.416184902191162, "mode": "test", "epoch": 53}
{"loss": 0.09189163148403168, "acc": 0.9819295406341553, "length": 3.415691375732422, "mode": "train", "epoch": 54}
{"loss": 0.09904897958040237, "acc": 0.9809144735336304, "length": 3.4111993312835693, "mode": "test", "epoch": 54}
{"loss": 0.09837200492620468, "acc": 0.9799591302871704, "length": 3.4202046394348145, "mode": "train", "epoch": 55}
{"loss": 0.10595536977052689, "acc": 0.9786871075630188, "length": 3.4199421405792236, "mode": "test", "epoch": 55}
{"loss": 0.09400234371423721, "acc": 0.9810060858726501, "length": 3.4123501777648926, "mode": "train", "epoch": 56}
{"loss": 0.10143713653087616, "acc": 0.9799091219902039, "length": 3.415968179702759, "mode": "test", "epoch": 56}
{"loss": 0.09421458095312119, "acc": 0.9809673428535461, "length": 3.4100193977355957, "mode": "train", "epoch": 57}
{"loss": 0.10192526876926422, "acc": 0.9796645641326904, "length": 3.4162933826446533, "mode": "test", "epoch": 57}
{"loss": 0.09358909726142883, "acc": 0.9811551570892334, "length": 3.422795295715332, "mode": "train", "epoch": 58}
{"loss": 0.1006273552775383, "acc": 0.9799106121063232, "length": 3.4248554706573486, "mode": "test", "epoch": 58}
{"loss": 0.0927998349070549, "acc": 0.9814935326576233, "length": 3.425307035446167, "mode": "train", "epoch": 59}
{"loss": 0.09848013520240784, "acc": 0.9807578325271606, "length": 3.424313545227051, "mode": "test", "epoch": 59}
{"loss": 0.09266356378793716, "acc": 0.9815995097160339, "length": 3.427119493484497, "mode": "train", "epoch": 60}
{"loss": 0.10402721166610718, "acc": 0.9795851707458496, "length": 3.441401720046997, "mode": "test", "epoch": 60}
test accuracy: 0.9250669479370117
