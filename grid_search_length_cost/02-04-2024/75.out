ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.5091692805290222, "acc": 0.7086156606674194, "length": 2.1487433910369873, "mode": "train", "epoch": 1}
{"loss": 0.371808797121048, "acc": 0.8453860282897949, "length": 2.9031729698181152, "mode": "test", "epoch": 1}
{"loss": 0.2740713059902191, "acc": 0.9009281992912292, "length": 3.2912514209747314, "mode": "train", "epoch": 2}
{"loss": 0.29676374793052673, "acc": 0.891348659992218, "length": 3.383272171020508, "mode": "test", "epoch": 2}
{"loss": 0.21293456852436066, "acc": 0.9344974160194397, "length": 3.4090006351470947, "mode": "train", "epoch": 3}
{"loss": 0.2672796845436096, "acc": 0.9107211232185364, "length": 3.413283348083496, "mode": "test", "epoch": 3}
{"loss": 0.18251436948776245, "acc": 0.9492847919464111, "length": 3.3935060501098633, "mode": "train", "epoch": 4}
{"loss": 0.26466989517211914, "acc": 0.912102997303009, "length": 3.363091468811035, "mode": "test", "epoch": 4}
{"loss": 0.17359712719917297, "acc": 0.9537440538406372, "length": 3.379703998565674, "mode": "train", "epoch": 5}
{"loss": 0.25764790177345276, "acc": 0.9152219891548157, "length": 3.361492872238159, "mode": "test", "epoch": 5}
{"loss": 0.16927359998226166, "acc": 0.9555742144584656, "length": 3.3747987747192383, "mode": "train", "epoch": 6}
{"loss": 0.26418188214302063, "acc": 0.9139389395713806, "length": 3.3807945251464844, "mode": "test", "epoch": 6}
{"loss": 0.16572289168834686, "acc": 0.9571629166603088, "length": 3.3967888355255127, "mode": "train", "epoch": 7}
{"loss": 0.25163233280181885, "acc": 0.9184492826461792, "length": 3.3580162525177, "mode": "test", "epoch": 7}
{"loss": 0.16226203739643097, "acc": 0.9580381512641907, "length": 3.3987550735473633, "mode": "train", "epoch": 8}
{"loss": 0.2525634467601776, "acc": 0.9202432632446289, "length": 3.420036792755127, "mode": "test", "epoch": 8}
{"loss": 0.15858227014541626, "acc": 0.9581285119056702, "length": 3.4086251258850098, "mode": "train", "epoch": 9}
{"loss": 0.24583947658538818, "acc": 0.9195675253868103, "length": 3.4558424949645996, "mode": "test", "epoch": 9}
{"loss": 0.1471749246120453, "acc": 0.9601224660873413, "length": 3.467982769012451, "mode": "train", "epoch": 10}
{"loss": 0.2825168967247009, "acc": 0.8964560627937317, "length": 3.506673574447632, "mode": "test", "epoch": 10}
{"loss": 0.12901778519153595, "acc": 0.9659122824668884, "length": 3.537463903427124, "mode": "train", "epoch": 11}
{"loss": 0.29486170411109924, "acc": 0.8880748152732849, "length": 3.6206042766571045, "mode": "test", "epoch": 11}
{"loss": 0.11603885889053345, "acc": 0.9721295237541199, "length": 3.6035454273223877, "mode": "train", "epoch": 12}
{"loss": 0.28779545426368713, "acc": 0.9051772952079773, "length": 3.632352828979492, "mode": "test", "epoch": 12}
{"loss": 0.11392666399478912, "acc": 0.9731543660163879, "length": 3.6016056537628174, "mode": "train", "epoch": 13}
{"loss": 0.32414141297340393, "acc": 0.8801844120025635, "length": 3.5045156478881836, "mode": "test", "epoch": 13}
{"loss": 0.11077501624822617, "acc": 0.9743138551712036, "length": 3.603767156600952, "mode": "train", "epoch": 14}
{"loss": 0.35738834738731384, "acc": 0.8761125802993774, "length": 3.694852828979492, "mode": "test", "epoch": 14}
{"loss": 0.10309185832738876, "acc": 0.9779378771781921, "length": 3.6323225498199463, "mode": "train", "epoch": 15}
{"loss": 0.34026503562927246, "acc": 0.8883898854255676, "length": 3.6654412746429443, "mode": "test", "epoch": 15}
{"loss": 0.0994042456150055, "acc": 0.9794270992279053, "length": 3.630074977874756, "mode": "train", "epoch": 16}
{"loss": 0.30470922589302063, "acc": 0.9012300372123718, "length": 3.6871402263641357, "mode": "test", "epoch": 16}
{"loss": 0.09750685840845108, "acc": 0.9800548553466797, "length": 3.6378073692321777, "mode": "train", "epoch": 17}
{"loss": 0.3213794529438019, "acc": 0.8915777802467346, "length": 3.6636829376220703, "mode": "test", "epoch": 17}
{"loss": 0.09764788299798965, "acc": 0.9799901843070984, "length": 3.6366846561431885, "mode": "train", "epoch": 18}
{"loss": 0.3071635663509369, "acc": 0.8905392289161682, "length": 3.6917757987976074, "mode": "test", "epoch": 18}
{"loss": 0.09607277065515518, "acc": 0.9805442690849304, "length": 3.6376073360443115, "mode": "train", "epoch": 19}
{"loss": 0.3283683657646179, "acc": 0.8919388651847839, "length": 3.6827445030212402, "mode": "test", "epoch": 19}
{"loss": 0.09354935586452484, "acc": 0.981152355670929, "length": 3.6374781131744385, "mode": "train", "epoch": 20}
{"loss": 0.3661348521709442, "acc": 0.8689162135124207, "length": 3.6694772243499756, "mode": "test", "epoch": 20}
{"loss": 0.08930498361587524, "acc": 0.9813634753227234, "length": 3.634631633758545, "mode": "train", "epoch": 21}
{"loss": 0.30459004640579224, "acc": 0.9037448763847351, "length": 3.673433542251587, "mode": "test", "epoch": 21}
{"loss": 0.0793238952755928, "acc": 0.9837524890899658, "length": 3.642169237136841, "mode": "train", "epoch": 22}
{"loss": 0.28729048371315, "acc": 0.9102036952972412, "length": 3.665361166000366, "mode": "test", "epoch": 22}
{"loss": 0.07421906292438507, "acc": 0.9849469661712646, "length": 3.6302478313446045, "mode": "train", "epoch": 23}
{"loss": 0.281812459230423, "acc": 0.9092326760292053, "length": 3.6878597736358643, "mode": "test", "epoch": 23}
{"loss": 0.0719229131937027, "acc": 0.9855623245239258, "length": 3.6426336765289307, "mode": "train", "epoch": 24}
{"loss": 0.32185229659080505, "acc": 0.8946835994720459, "length": 3.6970508098602295, "mode": "test", "epoch": 24}
{"loss": 0.06901894509792328, "acc": 0.985991895198822, "length": 3.6339213848114014, "mode": "train", "epoch": 25}
{"loss": 0.3309125602245331, "acc": 0.8943970799446106, "length": 3.6504156589508057, "mode": "test", "epoch": 25}
{"loss": 0.06665386259555817, "acc": 0.9861425161361694, "length": 3.6423251628875732, "mode": "train", "epoch": 26}
{"loss": 0.330443799495697, "acc": 0.8870992660522461, "length": 3.6584877967834473, "mode": "test", "epoch": 26}
{"loss": 0.06190859526395798, "acc": 0.9872320294380188, "length": 3.6410176753997803, "mode": "train", "epoch": 27}
{"loss": 0.3672862648963928, "acc": 0.8782058954238892, "length": 3.665361166000366, "mode": "test", "epoch": 27}
{"loss": 0.060155075043439865, "acc": 0.9878544211387634, "length": 3.6395535469055176, "mode": "train", "epoch": 28}
{"loss": 0.37602388858795166, "acc": 0.8697863817214966, "length": 3.6398656368255615, "mode": "test", "epoch": 28}
{"loss": 0.057373229414224625, "acc": 0.9885261058807373, "length": 3.645477533340454, "mode": "train", "epoch": 29}
{"loss": 0.3385046422481537, "acc": 0.8929242491722107, "length": 3.682344913482666, "mode": "test", "epoch": 29}
{"loss": 0.054669663310050964, "acc": 0.9895024299621582, "length": 3.654919385910034, "mode": "train", "epoch": 30}
{"loss": 0.44596096873283386, "acc": 0.8554551601409912, "length": 3.6652414798736572, "mode": "test", "epoch": 30}
{"loss": 0.055017516016960144, "acc": 0.9892510175704956, "length": 3.661902904510498, "mode": "train", "epoch": 31}
{"loss": 0.38978755474090576, "acc": 0.879318118095398, "length": 3.670356512069702, "mode": "test", "epoch": 31}
{"loss": 0.053384099155664444, "acc": 0.9897902607917786, "length": 3.67539119720459, "mode": "train", "epoch": 32}
{"loss": 0.468567430973053, "acc": 0.8459764719009399, "length": 3.6916160583496094, "mode": "test", "epoch": 32}
{"loss": 0.051409997045993805, "acc": 0.9904946088790894, "length": 3.6735386848449707, "mode": "train", "epoch": 33}
{"loss": 0.37328827381134033, "acc": 0.8873775005340576, "length": 3.6863811016082764, "mode": "test", "epoch": 33}
{"loss": 0.059215039014816284, "acc": 0.9876941442489624, "length": 3.6754746437072754, "mode": "train", "epoch": 34}
{"loss": 0.3955250084400177, "acc": 0.8686245679855347, "length": 3.673753261566162, "mode": "test", "epoch": 34}
{"loss": 0.05457010492682457, "acc": 0.9890440702438354, "length": 3.671783685684204, "mode": "train", "epoch": 35}
{"loss": 0.30822283029556274, "acc": 0.902079164981842, "length": 3.682145118713379, "mode": "test", "epoch": 35}
{"loss": 0.053674861788749695, "acc": 0.9893806576728821, "length": 3.675740957260132, "mode": "train", "epoch": 36}
{"loss": 0.36516979336738586, "acc": 0.8862425684928894, "length": 3.6956121921539307, "mode": "test", "epoch": 36}
{"loss": 0.05420287325978279, "acc": 0.9891709685325623, "length": 3.6709470748901367, "mode": "train", "epoch": 37}
{"loss": 0.39464235305786133, "acc": 0.8728448748588562, "length": 3.6793477535247803, "mode": "test", "epoch": 37}
{"loss": 0.051998965442180634, "acc": 0.9898642897605896, "length": 3.6717753410339355, "mode": "train", "epoch": 38}
{"loss": 0.3625698983669281, "acc": 0.8810321092605591, "length": 3.68546199798584, "mode": "test", "epoch": 38}
{"loss": 0.05370961129665375, "acc": 0.9893985390663147, "length": 3.6720528602600098, "mode": "train", "epoch": 39}
{"loss": 0.3861864507198334, "acc": 0.8718175888061523, "length": 3.6898577213287354, "mode": "test", "epoch": 39}
{"loss": 0.051084160804748535, "acc": 0.9900922775268555, "length": 3.6709237098693848, "mode": "train", "epoch": 40}
{"loss": 0.4425046145915985, "acc": 0.8617613315582275, "length": 3.694213628768921, "mode": "test", "epoch": 40}
{"loss": 0.051986780017614365, "acc": 0.9900462627410889, "length": 3.6738998889923096, "mode": "train", "epoch": 41}
{"loss": 0.31981199979782104, "acc": 0.901276707649231, "length": 3.6922154426574707, "mode": "test", "epoch": 41}
{"loss": 0.050810616463422775, "acc": 0.9903749823570251, "length": 3.6686503887176514, "mode": "train", "epoch": 42}
{"loss": 0.38407546281814575, "acc": 0.8819465637207031, "length": 3.692495107650757, "mode": "test", "epoch": 42}
{"loss": 0.05120294913649559, "acc": 0.9901495575904846, "length": 3.6657657623291016, "mode": "train", "epoch": 43}
{"loss": 0.3261953294277191, "acc": 0.8880718946456909, "length": 3.692734956741333, "mode": "test", "epoch": 43}
{"loss": 0.05286044627428055, "acc": 0.9896288514137268, "length": 3.6689231395721436, "mode": "train", "epoch": 44}
{"loss": 0.3772590458393097, "acc": 0.8880177140235901, "length": 3.6817855834960938, "mode": "test", "epoch": 44}
{"loss": 0.05050717666745186, "acc": 0.9903501868247986, "length": 3.667491912841797, "mode": "train", "epoch": 45}
{"loss": 0.35287046432495117, "acc": 0.8777982592582703, "length": 3.6833839416503906, "mode": "test", "epoch": 45}
{"loss": 0.050276726484298706, "acc": 0.990480899810791, "length": 3.667405366897583, "mode": "train", "epoch": 46}
{"loss": 0.3386286795139313, "acc": 0.8885470628738403, "length": 3.6904571056365967, "mode": "test", "epoch": 46}
{"loss": 0.05110211297869682, "acc": 0.9903294444084167, "length": 3.6687777042388916, "mode": "train", "epoch": 47}
{"loss": 0.3076581358909607, "acc": 0.9058847427368164, "length": 3.680906295776367, "mode": "test", "epoch": 47}
{"loss": 0.05120299011468887, "acc": 0.990017831325531, "length": 3.6671996116638184, "mode": "train", "epoch": 48}
{"loss": 0.35033804178237915, "acc": 0.883971095085144, "length": 3.678828239440918, "mode": "test", "epoch": 48}
{"loss": 0.05103866755962372, "acc": 0.990200400352478, "length": 3.6666080951690674, "mode": "train", "epoch": 49}
{"loss": 0.3662184178829193, "acc": 0.8860252499580383, "length": 3.693014621734619, "mode": "test", "epoch": 49}
{"loss": 0.05087943747639656, "acc": 0.9903177618980408, "length": 3.6556460857391357, "mode": "train", "epoch": 50}
{"loss": 0.4164549708366394, "acc": 0.8637461066246033, "length": 3.674992084503174, "mode": "test", "epoch": 50}
{"loss": 0.05057353526353836, "acc": 0.9903399348258972, "length": 3.666801929473877, "mode": "train", "epoch": 51}
{"loss": 0.3254539966583252, "acc": 0.9060552716255188, "length": 3.7037243843078613, "mode": "test", "epoch": 51}
{"loss": 0.05083275958895683, "acc": 0.9903043508529663, "length": 3.665553092956543, "mode": "train", "epoch": 52}
{"loss": 0.43940719962120056, "acc": 0.8531838059425354, "length": 3.694772958755493, "mode": "test", "epoch": 52}
{"loss": 0.05066106095910072, "acc": 0.9903038740158081, "length": 3.6633896827697754, "mode": "train", "epoch": 53}
{"loss": 0.3634105920791626, "acc": 0.876459002494812, "length": 3.6745524406433105, "mode": "test", "epoch": 53}
{"loss": 0.050643350929021835, "acc": 0.9903811812400818, "length": 3.666449785232544, "mode": "train", "epoch": 54}
{"loss": 0.3111095726490021, "acc": 0.8989114165306091, "length": 3.694493293762207, "mode": "test", "epoch": 54}
{"loss": 0.050254326313734055, "acc": 0.9905259013175964, "length": 3.6709086894989014, "mode": "train", "epoch": 55}
{"loss": 0.3703487515449524, "acc": 0.8788295388221741, "length": 3.666919708251953, "mode": "test", "epoch": 55}
{"loss": 0.05059533938765526, "acc": 0.9905030131340027, "length": 3.675234317779541, "mode": "train", "epoch": 56}
{"loss": 0.3749954402446747, "acc": 0.8753743171691895, "length": 3.689298391342163, "mode": "test", "epoch": 56}
{"loss": 0.05057329684495926, "acc": 0.990576446056366, "length": 3.6726365089416504, "mode": "train", "epoch": 57}
{"loss": 0.37327441573143005, "acc": 0.8796048760414124, "length": 3.685941457748413, "mode": "test", "epoch": 57}
{"loss": 0.05158919841051102, "acc": 0.9900349974632263, "length": 3.6761562824249268, "mode": "train", "epoch": 58}
{"loss": 0.31105801463127136, "acc": 0.9019068479537964, "length": 3.6984095573425293, "mode": "test", "epoch": 58}
{"loss": 0.049153245985507965, "acc": 0.9907233119010925, "length": 3.682386875152588, "mode": "train", "epoch": 59}
{"loss": 0.3496667742729187, "acc": 0.8874613046646118, "length": 3.7281808853149414, "mode": "test", "epoch": 59}
{"loss": 0.04999822378158569, "acc": 0.9906882047653198, "length": 3.682847499847412, "mode": "train", "epoch": 60}
{"loss": 0.32554593682289124, "acc": 0.896726667881012, "length": 3.711756706237793, "mode": "test", "epoch": 60}
test accuracy: 0.881807267665863
