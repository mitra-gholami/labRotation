ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 5
{"loss": 0.42013439536094666, "acc": 0.8120304346084595, "length": 5.532630920410156, "mode": "train", "epoch": 1}
{"loss": 0.4502876400947571, "acc": 0.8285512328147888, "length": 6.0, "mode": "test", "epoch": 1}
{"loss": 0.24175842106342316, "acc": 0.9201709032058716, "length": 5.9999284744262695, "mode": "train", "epoch": 2}
{"loss": 0.27318960428237915, "acc": 0.9024295806884766, "length": 6.0, "mode": "test", "epoch": 2}
{"loss": 0.18763971328735352, "acc": 0.9441440105438232, "length": 5.999991416931152, "mode": "train", "epoch": 3}
{"loss": 0.22409510612487793, "acc": 0.9257912635803223, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.16207179427146912, "acc": 0.9551693201065063, "length": 5.999999046325684, "mode": "train", "epoch": 4}
{"loss": 0.21258075535297394, "acc": 0.9317575693130493, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.1424863189458847, "acc": 0.9627799391746521, "length": 6.0, "mode": "train", "epoch": 5}
{"loss": 0.18079522252082825, "acc": 0.9422796368598938, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.13345867395401, "acc": 0.9664415717124939, "length": 6.0, "mode": "train", "epoch": 6}
{"loss": 0.1615961641073227, "acc": 0.953050971031189, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.1282658576965332, "acc": 0.9677233695983887, "length": 6.0, "mode": "train", "epoch": 7}
{"loss": 0.19699347019195557, "acc": 0.9381016492843628, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.12213611602783203, "acc": 0.9690900444984436, "length": 6.0, "mode": "train", "epoch": 8}
{"loss": 0.16169732809066772, "acc": 0.9498951435089111, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.1146155521273613, "acc": 0.9715098738670349, "length": 6.0, "mode": "train", "epoch": 9}
{"loss": 0.1445523500442505, "acc": 0.9600197672843933, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.10732720047235489, "acc": 0.9740892648696899, "length": 6.0, "mode": "train", "epoch": 10}
{"loss": 0.14328308403491974, "acc": 0.9581682682037354, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.10266419500112534, "acc": 0.9757062792778015, "length": 6.0, "mode": "train", "epoch": 11}
{"loss": 0.1334584653377533, "acc": 0.9629279971122742, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.0975535586476326, "acc": 0.9776725172996521, "length": 6.0, "mode": "train", "epoch": 12}
{"loss": 0.1198355108499527, "acc": 0.9699567556381226, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.09366033971309662, "acc": 0.9791889786720276, "length": 6.0, "mode": "train", "epoch": 13}
{"loss": 0.11408022791147232, "acc": 0.9711903929710388, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.09189624339342117, "acc": 0.979560136795044, "length": 6.0, "mode": "train", "epoch": 14}
{"loss": 0.10689211636781693, "acc": 0.973479151725769, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.09040026366710663, "acc": 0.9800215363502502, "length": 6.0, "mode": "train", "epoch": 15}
{"loss": 0.11024752259254456, "acc": 0.9722669124603271, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.08929511904716492, "acc": 0.9802934527397156, "length": 6.0, "mode": "train", "epoch": 16}
{"loss": 0.10735715925693512, "acc": 0.9732099175453186, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.0867457464337349, "acc": 0.9809135794639587, "length": 6.0, "mode": "train", "epoch": 17}
{"loss": 0.09984765201807022, "acc": 0.9767052531242371, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.0851619690656662, "acc": 0.9811115264892578, "length": 6.0, "mode": "train", "epoch": 18}
{"loss": 0.10014467686414719, "acc": 0.9750667214393616, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.08145615458488464, "acc": 0.9816685318946838, "length": 6.0, "mode": "train", "epoch": 19}
{"loss": 0.10124977678060532, "acc": 0.9757604598999023, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.07608006149530411, "acc": 0.9831518530845642, "length": 6.0, "mode": "train", "epoch": 20}
{"loss": 0.08985016494989395, "acc": 0.9779659509658813, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.07154698669910431, "acc": 0.9848229289054871, "length": 6.0, "mode": "train", "epoch": 21}
{"loss": 0.08269251883029938, "acc": 0.9814053177833557, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.07002589106559753, "acc": 0.985186755657196, "length": 6.0, "mode": "train", "epoch": 22}
{"loss": 0.08522382378578186, "acc": 0.980018138885498, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.06649027019739151, "acc": 0.9864175319671631, "length": 6.0, "mode": "train", "epoch": 23}
{"loss": 0.08649217337369919, "acc": 0.9799314141273499, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.0657748281955719, "acc": 0.9864717125892639, "length": 6.0, "mode": "train", "epoch": 24}
{"loss": 0.08080093562602997, "acc": 0.981517493724823, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.06426603347063065, "acc": 0.9869444370269775, "length": 6.0, "mode": "train", "epoch": 25}
{"loss": 0.083409383893013, "acc": 0.9816311001777649, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.06291801482439041, "acc": 0.9873673319816589, "length": 6.0, "mode": "train", "epoch": 26}
{"loss": 0.07147266715765, "acc": 0.9851697683334351, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.06087298318743706, "acc": 0.9879003167152405, "length": 6.0, "mode": "train", "epoch": 27}
{"loss": 0.06668112426996231, "acc": 0.986300528049469, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.05968962982296944, "acc": 0.9882475137710571, "length": 6.0, "mode": "train", "epoch": 28}
{"loss": 0.07769274711608887, "acc": 0.9828576445579529, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.05992057919502258, "acc": 0.987824022769928, "length": 6.0, "mode": "train", "epoch": 29}
{"loss": 0.06521356105804443, "acc": 0.9862282872200012, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.056399568915367126, "acc": 0.9888561964035034, "length": 6.0, "mode": "train", "epoch": 30}
{"loss": 0.06350454688072205, "acc": 0.986992359161377, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.05540533363819122, "acc": 0.9891568422317505, "length": 6.0, "mode": "train", "epoch": 31}
{"loss": 0.06329178810119629, "acc": 0.9870629906654358, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.053836461156606674, "acc": 0.9894931316375732, "length": 6.0, "mode": "train", "epoch": 32}
{"loss": 0.06128641590476036, "acc": 0.9872020483016968, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.05115024000406265, "acc": 0.9902108311653137, "length": 6.0, "mode": "train", "epoch": 33}
{"loss": 0.06471623480319977, "acc": 0.9865697026252747, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.05115736275911331, "acc": 0.9901084899902344, "length": 6.0, "mode": "train", "epoch": 34}
{"loss": 0.05736420303583145, "acc": 0.9884284138679504, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.05127115175127983, "acc": 0.9901103377342224, "length": 6.0, "mode": "train", "epoch": 35}
{"loss": 0.0554208867251873, "acc": 0.9894490838050842, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.048921264708042145, "acc": 0.9907581210136414, "length": 6.0, "mode": "train", "epoch": 36}
{"loss": 0.05516216158866882, "acc": 0.9896676540374756, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.04884319752454758, "acc": 0.990792989730835, "length": 6.0, "mode": "train", "epoch": 37}
{"loss": 0.05490279570221901, "acc": 0.9897307753562927, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.048699427396059036, "acc": 0.990596354007721, "length": 6.0, "mode": "train", "epoch": 38}
{"loss": 0.057761192321777344, "acc": 0.9878233671188354, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.04715987294912338, "acc": 0.9911660552024841, "length": 6.0, "mode": "train", "epoch": 39}
{"loss": 0.06059050187468529, "acc": 0.9875434041023254, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.04875554144382477, "acc": 0.9907774925231934, "length": 6.0, "mode": "train", "epoch": 40}
{"loss": 0.052944399416446686, "acc": 0.9899511337280273, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.045404102653265, "acc": 0.9915696382522583, "length": 6.0, "mode": "train", "epoch": 41}
{"loss": 0.055499859154224396, "acc": 0.9889107346534729, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.047597773373126984, "acc": 0.991063117980957, "length": 6.0, "mode": "train", "epoch": 42}
{"loss": 0.05114518478512764, "acc": 0.9906937479972839, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.045534491539001465, "acc": 0.9915299415588379, "length": 6.0, "mode": "train", "epoch": 43}
{"loss": 0.053777337074279785, "acc": 0.9898392558097839, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.04458058625459671, "acc": 0.9917247891426086, "length": 6.0, "mode": "train", "epoch": 44}
{"loss": 0.05162660777568817, "acc": 0.9905635118484497, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.043519750237464905, "acc": 0.9920382499694824, "length": 6.0, "mode": "train", "epoch": 45}
{"loss": 0.04890478402376175, "acc": 0.9902564883232117, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.044297538697719574, "acc": 0.991739809513092, "length": 6.0, "mode": "train", "epoch": 46}
{"loss": 0.06311756372451782, "acc": 0.986640214920044, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.043982136994600296, "acc": 0.9918137788772583, "length": 6.0, "mode": "train", "epoch": 47}
{"loss": 0.05474096164107323, "acc": 0.9895049929618835, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.045628949999809265, "acc": 0.99135422706604, "length": 6.0, "mode": "train", "epoch": 48}
{"loss": 0.05114716663956642, "acc": 0.9906141757965088, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.04732343181967735, "acc": 0.9909283518791199, "length": 6.0, "mode": "train", "epoch": 49}
{"loss": 0.05290277674794197, "acc": 0.9898447394371033, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.04410742223262787, "acc": 0.991784393787384, "length": 6.0, "mode": "train", "epoch": 50}
{"loss": 0.05348435416817665, "acc": 0.9889847636222839, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.04402382671833038, "acc": 0.9917008280754089, "length": 6.0, "mode": "train", "epoch": 51}
{"loss": 0.052203577011823654, "acc": 0.9901300072669983, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.04215647652745247, "acc": 0.9923515915870667, "length": 6.0, "mode": "train", "epoch": 52}
{"loss": 0.04732091352343559, "acc": 0.9914090037345886, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.043083157390356064, "acc": 0.9920201897621155, "length": 6.0, "mode": "train", "epoch": 53}
{"loss": 0.04760190472006798, "acc": 0.9909338355064392, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.043017201125621796, "acc": 0.9918733835220337, "length": 6.0, "mode": "train", "epoch": 54}
{"loss": 0.04969945549964905, "acc": 0.9912735223770142, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.04268881678581238, "acc": 0.9920814633369446, "length": 6.0, "mode": "train", "epoch": 55}
{"loss": 0.047531671822071075, "acc": 0.9915210008621216, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.04202155023813248, "acc": 0.9921987652778625, "length": 6.0, "mode": "train", "epoch": 56}
{"loss": 0.04801061004400253, "acc": 0.9908309578895569, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.0429517887532711, "acc": 0.99192875623703, "length": 6.0, "mode": "train", "epoch": 57}
{"loss": 0.046304088085889816, "acc": 0.991672694683075, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.042498234659433365, "acc": 0.991997241973877, "length": 6.0, "mode": "train", "epoch": 58}
{"loss": 0.05022149533033371, "acc": 0.9902311563491821, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.0397648885846138, "acc": 0.9927467107772827, "length": 6.0, "mode": "train", "epoch": 59}
{"loss": 0.046708013862371445, "acc": 0.9913601279258728, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.040351223200559616, "acc": 0.9925470948219299, "length": 6.0, "mode": "train", "epoch": 60}
{"loss": 0.04750610888004303, "acc": 0.9917252063751221, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.9627087712287903
