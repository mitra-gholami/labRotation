ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 30
{"loss": 0.45180848240852356, "acc": 0.7870763540267944, "length": 3.6256422996520996, "mode": "train", "epoch": 1}
{"loss": 0.40319564938545227, "acc": 0.8362758159637451, "length": 3.8343424797058105, "mode": "test", "epoch": 1}
{"loss": 0.30094727873802185, "acc": 0.8867232799530029, "length": 4.264105319976807, "mode": "train", "epoch": 2}
{"loss": 0.3038787543773651, "acc": 0.8833571076393127, "length": 4.377450942993164, "mode": "test", "epoch": 2}
{"loss": 0.2396666705608368, "acc": 0.9177831411361694, "length": 4.339677810668945, "mode": "train", "epoch": 3}
{"loss": 0.29003286361694336, "acc": 0.8932142853736877, "length": 4.230788707733154, "mode": "test", "epoch": 3}
{"loss": 0.2008899599313736, "acc": 0.936375081539154, "length": 4.368955135345459, "mode": "train", "epoch": 4}
{"loss": 0.23532913625240326, "acc": 0.9222325682640076, "length": 4.2104597091674805, "mode": "test", "epoch": 4}
{"loss": 0.17597565054893494, "acc": 0.9470390677452087, "length": 4.3783698081970215, "mode": "train", "epoch": 5}
{"loss": 0.20616690814495087, "acc": 0.9356987476348877, "length": 4.320826053619385, "mode": "test", "epoch": 5}
{"loss": 0.16217759251594543, "acc": 0.953079879283905, "length": 4.415691375732422, "mode": "train", "epoch": 6}
{"loss": 0.18929819762706757, "acc": 0.9415136575698853, "length": 4.315996170043945, "mode": "test", "epoch": 6}
{"loss": 0.15326698124408722, "acc": 0.956896185874939, "length": 4.360084056854248, "mode": "train", "epoch": 7}
{"loss": 0.1869969516992569, "acc": 0.9447728395462036, "length": 4.259515762329102, "mode": "test", "epoch": 7}
{"loss": 0.14632532000541687, "acc": 0.9599555134773254, "length": 4.352436542510986, "mode": "train", "epoch": 8}
{"loss": 0.17665831744670868, "acc": 0.9482113718986511, "length": 4.300497531890869, "mode": "test", "epoch": 8}
{"loss": 0.14098100364208221, "acc": 0.9617920517921448, "length": 4.322123050689697, "mode": "train", "epoch": 9}
{"loss": 0.16042564809322357, "acc": 0.9532454013824463, "length": 4.224733352661133, "mode": "test", "epoch": 9}
{"loss": 0.13653527200222015, "acc": 0.9633346796035767, "length": 4.308771133422852, "mode": "train", "epoch": 10}
{"loss": 0.15256638824939728, "acc": 0.9564427733421326, "length": 4.226067066192627, "mode": "test", "epoch": 10}
{"loss": 0.13124337792396545, "acc": 0.9652624726295471, "length": 4.317331790924072, "mode": "train", "epoch": 11}
{"loss": 0.14380936324596405, "acc": 0.9605188369750977, "length": 4.267985820770264, "mode": "test", "epoch": 11}
{"loss": 0.12601278722286224, "acc": 0.9673206806182861, "length": 4.2943620681762695, "mode": "train", "epoch": 12}
{"loss": 0.15348342061042786, "acc": 0.9583547115325928, "length": 4.240124225616455, "mode": "test", "epoch": 12}
{"loss": 0.11936341971158981, "acc": 0.9698198437690735, "length": 4.296776294708252, "mode": "train", "epoch": 13}
{"loss": 0.1362312138080597, "acc": 0.9641104936599731, "length": 4.245494365692139, "mode": "test", "epoch": 13}
{"loss": 0.11560264974832535, "acc": 0.9714893698692322, "length": 4.2850260734558105, "mode": "train", "epoch": 14}
{"loss": 0.1327119767665863, "acc": 0.96527498960495, "length": 4.24845027923584, "mode": "test", "epoch": 14}
{"loss": 0.11325330287218094, "acc": 0.9725141525268555, "length": 4.288636207580566, "mode": "train", "epoch": 15}
{"loss": 0.13712984323501587, "acc": 0.9617721438407898, "length": 4.235979080200195, "mode": "test", "epoch": 15}
{"loss": 0.11308972537517548, "acc": 0.9725150465965271, "length": 4.270317077636719, "mode": "train", "epoch": 16}
{"loss": 0.12444794923067093, "acc": 0.9696199893951416, "length": 4.229563236236572, "mode": "test", "epoch": 16}
{"loss": 0.11040607839822769, "acc": 0.9733926057815552, "length": 4.257375717163086, "mode": "train", "epoch": 17}
{"loss": 0.12160661816596985, "acc": 0.9710021018981934, "length": 4.244953632354736, "mode": "test", "epoch": 17}
{"loss": 0.10971386730670929, "acc": 0.9736356735229492, "length": 4.280220031738281, "mode": "train", "epoch": 18}
{"loss": 0.12284605205059052, "acc": 0.9690519571304321, "length": 4.289576053619385, "mode": "test", "epoch": 18}
{"loss": 0.10862600058317184, "acc": 0.9740183353424072, "length": 4.2709059715271, "mode": "train", "epoch": 19}
{"loss": 0.124293752014637, "acc": 0.969145655632019, "length": 4.224300861358643, "mode": "test", "epoch": 19}
{"loss": 0.10969086736440659, "acc": 0.9735506772994995, "length": 4.270872592926025, "mode": "train", "epoch": 20}
{"loss": 0.11872673779726028, "acc": 0.9714771509170532, "length": 4.2527031898498535, "mode": "test", "epoch": 20}
{"loss": 0.10835093259811401, "acc": 0.9740427136421204, "length": 4.27251672744751, "mode": "train", "epoch": 21}
{"loss": 0.11439690738916397, "acc": 0.9729756712913513, "length": 4.260488986968994, "mode": "test", "epoch": 21}
{"loss": 0.10827942937612534, "acc": 0.9739480018615723, "length": 4.27890157699585, "mode": "train", "epoch": 22}
{"loss": 0.12045291811227798, "acc": 0.9706089496612549, "length": 4.237997531890869, "mode": "test", "epoch": 22}
{"loss": 0.10641401261091232, "acc": 0.9745153784751892, "length": 4.256346702575684, "mode": "train", "epoch": 23}
{"loss": 0.11394592374563217, "acc": 0.9730766415596008, "length": 4.241133213043213, "mode": "test", "epoch": 23}
{"loss": 0.1069159135222435, "acc": 0.9742894768714905, "length": 4.276491165161133, "mode": "train", "epoch": 24}
{"loss": 0.11434207111597061, "acc": 0.9727103114128113, "length": 4.221092700958252, "mode": "test", "epoch": 24}
{"loss": 0.10681915283203125, "acc": 0.9742205739021301, "length": 4.299481391906738, "mode": "train", "epoch": 25}
{"loss": 0.1124253123998642, "acc": 0.972978949546814, "length": 4.243115425109863, "mode": "test", "epoch": 25}
{"loss": 0.10567832738161087, "acc": 0.9746846556663513, "length": 4.295737266540527, "mode": "train", "epoch": 26}
{"loss": 0.1124589592218399, "acc": 0.9733118414878845, "length": 4.297397613525391, "mode": "test", "epoch": 26}
{"loss": 0.10342495143413544, "acc": 0.9753115177154541, "length": 4.346916198730469, "mode": "train", "epoch": 27}
{"loss": 0.11222153156995773, "acc": 0.9739969372749329, "length": 4.3214030265808105, "mode": "test", "epoch": 27}
{"loss": 0.10272207111120224, "acc": 0.9754737019538879, "length": 4.3662261962890625, "mode": "train", "epoch": 28}
{"loss": 0.10817120969295502, "acc": 0.9750835299491882, "length": 4.3777031898498535, "mode": "test", "epoch": 28}
{"loss": 0.1023022010922432, "acc": 0.9756467938423157, "length": 4.360739231109619, "mode": "train", "epoch": 29}
{"loss": 0.10976096987724304, "acc": 0.9746550917625427, "length": 4.3450117111206055, "mode": "test", "epoch": 29}
{"loss": 0.10061349719762802, "acc": 0.9762037396430969, "length": 4.3485331535339355, "mode": "train", "epoch": 30}
{"loss": 0.11009318381547928, "acc": 0.9744442105293274, "length": 4.308463096618652, "mode": "test", "epoch": 30}
{"loss": 0.10159195959568024, "acc": 0.9759849905967712, "length": 4.353008270263672, "mode": "train", "epoch": 31}
{"loss": 0.10772481560707092, "acc": 0.9751741290092468, "length": 4.319456577301025, "mode": "test", "epoch": 31}
{"loss": 0.10012476146221161, "acc": 0.9762675762176514, "length": 4.35202169418335, "mode": "train", "epoch": 32}
{"loss": 0.10758081823587418, "acc": 0.9748092293739319, "length": 4.323781490325928, "mode": "test", "epoch": 32}
{"loss": 0.10102219879627228, "acc": 0.9760501980781555, "length": 4.341460227966309, "mode": "train", "epoch": 33}
{"loss": 0.10600969940423965, "acc": 0.9755282402038574, "length": 4.357374668121338, "mode": "test", "epoch": 33}
{"loss": 0.10037504881620407, "acc": 0.9760661721229553, "length": 4.347511291503906, "mode": "train", "epoch": 34}
{"loss": 0.11114189028739929, "acc": 0.9741038680076599, "length": 4.318303108215332, "mode": "test", "epoch": 34}
{"loss": 0.09908750653266907, "acc": 0.9764271974563599, "length": 4.339245319366455, "mode": "train", "epoch": 35}
{"loss": 0.10688958317041397, "acc": 0.9752404093742371, "length": 4.332143783569336, "mode": "test", "epoch": 35}
{"loss": 0.09991348534822464, "acc": 0.9761863350868225, "length": 4.3696136474609375, "mode": "train", "epoch": 36}
{"loss": 0.10783325880765915, "acc": 0.9754366874694824, "length": 4.332576274871826, "mode": "test", "epoch": 36}
{"loss": 0.0992022454738617, "acc": 0.976359486579895, "length": 4.348275661468506, "mode": "train", "epoch": 37}
{"loss": 0.11072628200054169, "acc": 0.9741447567939758, "length": 4.39183235168457, "mode": "test", "epoch": 37}
{"loss": 0.09838307648897171, "acc": 0.9766984581947327, "length": 4.362021446228027, "mode": "train", "epoch": 38}
{"loss": 0.10571266710758209, "acc": 0.9757370948791504, "length": 4.329260349273682, "mode": "test", "epoch": 38}
{"loss": 0.10035797953605652, "acc": 0.9761806130409241, "length": 4.363157272338867, "mode": "train", "epoch": 39}
{"loss": 0.11118504405021667, "acc": 0.9746737480163574, "length": 4.355680465698242, "mode": "test", "epoch": 39}
{"loss": 0.09859970211982727, "acc": 0.9766196012496948, "length": 4.364517688751221, "mode": "train", "epoch": 40}
{"loss": 0.1063217893242836, "acc": 0.9752736687660217, "length": 4.358780384063721, "mode": "test", "epoch": 40}
{"loss": 0.09731391817331314, "acc": 0.9769476056098938, "length": 4.368592739105225, "mode": "train", "epoch": 41}
{"loss": 0.10756000131368637, "acc": 0.9749376177787781, "length": 4.397419452667236, "mode": "test", "epoch": 41}
{"loss": 0.09992715716362, "acc": 0.9760804176330566, "length": 4.378073215484619, "mode": "train", "epoch": 42}
{"loss": 0.10490728169679642, "acc": 0.9754341840744019, "length": 4.348147392272949, "mode": "test", "epoch": 42}
{"loss": 0.09877622127532959, "acc": 0.9764459133148193, "length": 4.3990983963012695, "mode": "train", "epoch": 43}
{"loss": 0.10442078858613968, "acc": 0.9763723015785217, "length": 4.381776332855225, "mode": "test", "epoch": 43}
{"loss": 0.09770603477954865, "acc": 0.9768580794334412, "length": 4.37121057510376, "mode": "train", "epoch": 44}
{"loss": 0.10974451899528503, "acc": 0.9743761420249939, "length": 4.3907151222229, "mode": "test", "epoch": 44}
{"loss": 0.0978522077202797, "acc": 0.9766777753829956, "length": 4.372592449188232, "mode": "train", "epoch": 45}
{"loss": 0.10509764403104782, "acc": 0.9762744903564453, "length": 4.353806018829346, "mode": "test", "epoch": 45}
{"loss": 0.09779158234596252, "acc": 0.9768085479736328, "length": 4.365331649780273, "mode": "train", "epoch": 46}
{"loss": 0.11302632093429565, "acc": 0.9731415510177612, "length": 4.3705668449401855, "mode": "test", "epoch": 46}
{"loss": 0.09839220345020294, "acc": 0.9762713313102722, "length": 4.352524280548096, "mode": "train", "epoch": 47}
{"loss": 0.10356761515140533, "acc": 0.9758783578872681, "length": 4.328359127044678, "mode": "test", "epoch": 47}
{"loss": 0.09648722410202026, "acc": 0.9768356084823608, "length": 4.364872932434082, "mode": "train", "epoch": 48}
{"loss": 0.10713163018226624, "acc": 0.974876880645752, "length": 4.34987735748291, "mode": "test", "epoch": 48}
{"loss": 0.09848600625991821, "acc": 0.9765175580978394, "length": 4.3574066162109375, "mode": "train", "epoch": 49}
{"loss": 0.10467430204153061, "acc": 0.9757384657859802, "length": 4.324394226074219, "mode": "test", "epoch": 49}
{"loss": 0.0983378142118454, "acc": 0.9765433669090271, "length": 4.365668296813965, "mode": "train", "epoch": 50}
{"loss": 0.10559466481208801, "acc": 0.9755720496177673, "length": 4.370061874389648, "mode": "test", "epoch": 50}
{"loss": 0.0975029245018959, "acc": 0.9765338897705078, "length": 4.370877742767334, "mode": "train", "epoch": 51}
{"loss": 0.11009036749601364, "acc": 0.9748386740684509, "length": 4.389129161834717, "mode": "test", "epoch": 51}
{"loss": 0.09541094303131104, "acc": 0.9772785902023315, "length": 4.362050533294678, "mode": "train", "epoch": 52}
{"loss": 0.10451444983482361, "acc": 0.9763326048851013, "length": 4.3629255294799805, "mode": "test", "epoch": 52}
{"loss": 0.09821102023124695, "acc": 0.9764819145202637, "length": 4.364006996154785, "mode": "train", "epoch": 53}
{"loss": 0.10653738677501678, "acc": 0.9749321937561035, "length": 4.354418754577637, "mode": "test", "epoch": 53}
{"loss": 0.09630611538887024, "acc": 0.9769087433815002, "length": 4.367539405822754, "mode": "train", "epoch": 54}
{"loss": 0.10199332982301712, "acc": 0.9766033291816711, "length": 4.371612071990967, "mode": "test", "epoch": 54}
{"loss": 0.09631332755088806, "acc": 0.9770593047142029, "length": 4.3646392822265625, "mode": "train", "epoch": 55}
{"loss": 0.10692133754491806, "acc": 0.9755452275276184, "length": 4.336901664733887, "mode": "test", "epoch": 55}
{"loss": 0.09949873387813568, "acc": 0.9756760001182556, "length": 4.401577949523926, "mode": "train", "epoch": 56}
{"loss": 0.10487040132284164, "acc": 0.9752188324928284, "length": 4.381524085998535, "mode": "test", "epoch": 56}
{"loss": 0.09720892459154129, "acc": 0.9764212965965271, "length": 4.390729904174805, "mode": "train", "epoch": 57}
{"loss": 0.10779742151498795, "acc": 0.9750357866287231, "length": 4.370061874389648, "mode": "test", "epoch": 57}
{"loss": 0.0973314568400383, "acc": 0.9766995310783386, "length": 4.397697925567627, "mode": "train", "epoch": 58}
{"loss": 0.1044558733701706, "acc": 0.9759976267814636, "length": 4.361591815948486, "mode": "test", "epoch": 58}
{"loss": 0.09795963764190674, "acc": 0.9763019680976868, "length": 4.388552188873291, "mode": "train", "epoch": 59}
{"loss": 0.10779730975627899, "acc": 0.9754253029823303, "length": 4.364511013031006, "mode": "test", "epoch": 59}
{"loss": 0.09930530935525894, "acc": 0.9756813049316406, "length": 4.373318672180176, "mode": "train", "epoch": 60}
{"loss": 0.11105607450008392, "acc": 0.9723598957061768, "length": 4.360618591308594, "mode": "test", "epoch": 60}
test accuracy: 0.9350039958953857
