ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.3933987021446228, "acc": 0.8194594383239746, "length": 5.9157490730285645, "mode": "train", "epoch": 1}
{"loss": 0.34707993268966675, "acc": 0.8533099293708801, "length": 7.955505847930908, "mode": "test", "epoch": 1}
{"loss": 0.22842177748680115, "acc": 0.9159998893737793, "length": 7.952986717224121, "mode": "train", "epoch": 2}
{"loss": 0.2631448209285736, "acc": 0.8976668119430542, "length": 8.274727821350098, "mode": "test", "epoch": 2}
{"loss": 0.15689130127429962, "acc": 0.9518500566482544, "length": 9.306519508361816, "mode": "train", "epoch": 3}
{"loss": 0.22588063776493073, "acc": 0.9155185222625732, "length": 8.795374870300293, "mode": "test", "epoch": 3}
{"loss": 0.11423496901988983, "acc": 0.9712393283843994, "length": 10.531943321228027, "mode": "train", "epoch": 4}
{"loss": 0.21844643354415894, "acc": 0.9192793369293213, "length": 10.106193542480469, "mode": "test", "epoch": 4}
{"loss": 0.08019974082708359, "acc": 0.9834105372428894, "length": 10.858851432800293, "mode": "train", "epoch": 5}
{"loss": 0.14724776148796082, "acc": 0.9553471803665161, "length": 10.986075401306152, "mode": "test", "epoch": 5}
{"loss": 0.06857410073280334, "acc": 0.9870901107788086, "length": 10.153934478759766, "mode": "train", "epoch": 6}
{"loss": 0.09829282015562057, "acc": 0.9744741916656494, "length": 8.383882522583008, "mode": "test", "epoch": 6}
{"loss": 0.060633063316345215, "acc": 0.9882948994636536, "length": 9.381328582763672, "mode": "train", "epoch": 7}
{"loss": 0.10155142843723297, "acc": 0.9726721048355103, "length": 9.08858871459961, "mode": "test", "epoch": 7}
{"loss": 0.04330757260322571, "acc": 0.9914666414260864, "length": 9.276613235473633, "mode": "train", "epoch": 8}
{"loss": 0.06377001106739044, "acc": 0.9828013777732849, "length": 9.293013572692871, "mode": "test", "epoch": 8}
{"loss": 0.02709076553583145, "acc": 0.9961227178573608, "length": 9.355473518371582, "mode": "train", "epoch": 9}
{"loss": 0.03931315615773201, "acc": 0.9926503896713257, "length": 8.839668273925781, "mode": "test", "epoch": 9}
{"loss": 0.01989750564098358, "acc": 0.9980233311653137, "length": 8.873812675476074, "mode": "train", "epoch": 10}
{"loss": 0.042114488780498505, "acc": 0.9911503791809082, "length": 8.805057525634766, "mode": "test", "epoch": 10}
{"loss": 0.01938445307314396, "acc": 0.9980875849723816, "length": 8.893085479736328, "mode": "train", "epoch": 11}
{"loss": 0.03172529861330986, "acc": 0.9943771958351135, "length": 8.628801345825195, "mode": "test", "epoch": 11}
{"loss": 0.017554430291056633, "acc": 0.9983295202255249, "length": 8.912911415100098, "mode": "train", "epoch": 12}
{"loss": 0.02372252568602562, "acc": 0.9967453479766846, "length": 8.803457260131836, "mode": "test", "epoch": 12}
{"loss": 0.014849552884697914, "acc": 0.9989896416664124, "length": 8.70021915435791, "mode": "train", "epoch": 13}
{"loss": 0.020858820527791977, "acc": 0.9974003434181213, "length": 8.454585075378418, "mode": "test", "epoch": 13}
{"loss": 0.015825776383280754, "acc": 0.9984907507896423, "length": 8.393800735473633, "mode": "train", "epoch": 14}
{"loss": 0.02078571729362011, "acc": 0.9971503615379333, "length": 8.222471237182617, "mode": "test", "epoch": 14}
{"loss": 0.01437763124704361, "acc": 0.9988794326782227, "length": 8.198063850402832, "mode": "train", "epoch": 15}
{"loss": 0.025474397465586662, "acc": 0.9961901307106018, "length": 8.925215721130371, "mode": "test", "epoch": 15}
{"loss": 0.014347128570079803, "acc": 0.9988808631896973, "length": 8.367096900939941, "mode": "train", "epoch": 16}
{"loss": 0.018040580675005913, "acc": 0.9981297850608826, "length": 8.07590389251709, "mode": "test", "epoch": 16}
{"loss": 0.014217319898307323, "acc": 0.9988691210746765, "length": 8.190068244934082, "mode": "train", "epoch": 17}
{"loss": 0.02544282376766205, "acc": 0.9962855577468872, "length": 7.818741798400879, "mode": "test", "epoch": 17}
{"loss": 0.015633147209882736, "acc": 0.9984620809555054, "length": 8.00259017944336, "mode": "train", "epoch": 18}
{"loss": 0.022609395906329155, "acc": 0.9971688389778137, "length": 8.196462631225586, "mode": "test", "epoch": 18}
{"loss": 0.013399512507021427, "acc": 0.9990401268005371, "length": 8.172126770019531, "mode": "train", "epoch": 19}
{"loss": 0.016085706651210785, "acc": 0.9985417127609253, "length": 8.017205238342285, "mode": "test", "epoch": 19}
{"loss": 0.015988944098353386, "acc": 0.9984892010688782, "length": 8.485115051269531, "mode": "train", "epoch": 20}
{"loss": 0.02326793223619461, "acc": 0.9970952272415161, "length": 8.586587905883789, "mode": "test", "epoch": 20}
{"loss": 0.013207082636654377, "acc": 0.999150276184082, "length": 8.375077247619629, "mode": "train", "epoch": 21}
{"loss": 0.014490189030766487, "acc": 0.9990153312683105, "length": 8.288932800292969, "mode": "test", "epoch": 21}
{"loss": 0.01378395315259695, "acc": 0.9988441467285156, "length": 8.126298904418945, "mode": "train", "epoch": 22}
{"loss": 0.014039956964552402, "acc": 0.9987556338310242, "length": 7.923775672912598, "mode": "test", "epoch": 22}
{"loss": 0.012302280403673649, "acc": 0.9991876482963562, "length": 7.913339138031006, "mode": "train", "epoch": 23}
{"loss": 0.018615074455738068, "acc": 0.9978240132331848, "length": 7.966989517211914, "mode": "test", "epoch": 23}
{"loss": 0.01305320393294096, "acc": 0.998923659324646, "length": 7.876239776611328, "mode": "train", "epoch": 24}
{"loss": 0.018725911155343056, "acc": 0.9983826279640198, "length": 7.91957426071167, "mode": "test", "epoch": 24}
{"loss": 0.013185020536184311, "acc": 0.9989979863166809, "length": 8.064001083374023, "mode": "train", "epoch": 25}
{"loss": 0.016062937676906586, "acc": 0.998627781867981, "length": 7.900288105010986, "mode": "test", "epoch": 25}
{"loss": 0.012840080074965954, "acc": 0.9990054965019226, "length": 7.781507968902588, "mode": "train", "epoch": 26}
{"loss": 0.014747419394552708, "acc": 0.9986640214920044, "length": 7.915893077850342, "mode": "test", "epoch": 26}
{"loss": 0.011965500190854073, "acc": 0.999294638633728, "length": 7.986475944519043, "mode": "train", "epoch": 27}
{"loss": 0.015054292045533657, "acc": 0.9988033175468445, "length": 8.21414852142334, "mode": "test", "epoch": 27}
{"loss": 0.012794830836355686, "acc": 0.9990984201431274, "length": 8.209742546081543, "mode": "train", "epoch": 28}
{"loss": 0.014134244993329048, "acc": 0.9990980625152588, "length": 8.247599601745605, "mode": "test", "epoch": 28}
{"loss": 0.013144515454769135, "acc": 0.9990668892860413, "length": 8.139982223510742, "mode": "train", "epoch": 29}
{"loss": 0.01329756435006857, "acc": 0.999117910861969, "length": 7.910571575164795, "mode": "test", "epoch": 29}
{"loss": 0.012935091741383076, "acc": 0.9990556836128235, "length": 7.999840259552002, "mode": "train", "epoch": 30}
{"loss": 0.017815565690398216, "acc": 0.9976658225059509, "length": 7.822623252868652, "mode": "test", "epoch": 30}
{"loss": 0.012733659707009792, "acc": 0.9991176724433899, "length": 8.290029525756836, "mode": "train", "epoch": 31}
{"loss": 0.015639282763004303, "acc": 0.9988318085670471, "length": 9.089468955993652, "mode": "test", "epoch": 31}
{"loss": 0.011983008123934269, "acc": 0.9993350505828857, "length": 8.33809757232666, "mode": "train", "epoch": 32}
{"loss": 0.01739504374563694, "acc": 0.9983958005905151, "length": 8.148407936096191, "mode": "test", "epoch": 32}
{"loss": 0.012470226734876633, "acc": 0.9991008043289185, "length": 7.888278961181641, "mode": "train", "epoch": 33}
{"loss": 0.013502831570804119, "acc": 0.999025285243988, "length": 8.062540054321289, "mode": "test", "epoch": 33}
{"loss": 0.0117800859734416, "acc": 0.9992350339889526, "length": 7.95647668838501, "mode": "train", "epoch": 34}
{"loss": 0.01682782545685768, "acc": 0.9980853796005249, "length": 7.87291955947876, "mode": "test", "epoch": 34}
{"loss": 0.014443882741034031, "acc": 0.9985629916191101, "length": 7.761951923370361, "mode": "train", "epoch": 35}
{"loss": 0.014513136819005013, "acc": 0.9987117648124695, "length": 7.479233264923096, "mode": "test", "epoch": 35}
{"loss": 0.021037913858890533, "acc": 0.9968132376670837, "length": 8.561829566955566, "mode": "train", "epoch": 36}
{"loss": 0.03715856000781059, "acc": 0.9928447604179382, "length": 10.159530639648438, "mode": "test", "epoch": 36}
{"loss": 0.02265196666121483, "acc": 0.9967111349105835, "length": 10.105019569396973, "mode": "train", "epoch": 37}
{"loss": 0.032403748482465744, "acc": 0.9954359531402588, "length": 9.248519897460938, "mode": "test", "epoch": 37}
{"loss": 0.021404733881354332, "acc": 0.9969820976257324, "length": 9.259061813354492, "mode": "train", "epoch": 38}
{"loss": 0.02759770303964615, "acc": 0.9955267906188965, "length": 9.641324996948242, "mode": "test", "epoch": 38}
{"loss": 0.0226159505546093, "acc": 0.99672532081604, "length": 9.866634368896484, "mode": "train", "epoch": 39}
{"loss": 0.02190644107758999, "acc": 0.9970069527626038, "length": 9.517285346984863, "mode": "test", "epoch": 39}
{"loss": 0.017409158870577812, "acc": 0.9979615211486816, "length": 8.644027709960938, "mode": "train", "epoch": 40}
{"loss": 0.017770443111658096, "acc": 0.9981521964073181, "length": 8.145406723022461, "mode": "test", "epoch": 40}
{"loss": 0.012165100313723087, "acc": 0.9992846846580505, "length": 8.300971031188965, "mode": "train", "epoch": 41}
{"loss": 0.012225068174302578, "acc": 0.9993492364883423, "length": 8.141605377197266, "mode": "test", "epoch": 41}
{"loss": 0.014080224558711052, "acc": 0.9987161159515381, "length": 8.067852973937988, "mode": "train", "epoch": 42}
{"loss": 0.021819865331053734, "acc": 0.9966214299201965, "length": 8.1720552444458, "mode": "test", "epoch": 42}
{"loss": 0.013173445127904415, "acc": 0.9989861249923706, "length": 8.160387992858887, "mode": "train", "epoch": 43}
{"loss": 0.0139482282102108, "acc": 0.9988316297531128, "length": 8.137643814086914, "mode": "test", "epoch": 43}
{"loss": 0.019934499636292458, "acc": 0.9972845911979675, "length": 8.970650672912598, "mode": "train", "epoch": 44}
{"loss": 0.02109554409980774, "acc": 0.9974411129951477, "length": 9.043853759765625, "mode": "test", "epoch": 44}
{"loss": 0.01333148404955864, "acc": 0.9990511536598206, "length": 8.478425025939941, "mode": "train", "epoch": 45}
{"loss": 0.013098732568323612, "acc": 0.9992510080337524, "length": 8.11319637298584, "mode": "test", "epoch": 45}
{"loss": 0.015420597046613693, "acc": 0.9985017776489258, "length": 8.423295974731445, "mode": "train", "epoch": 46}
{"loss": 0.014021032489836216, "acc": 0.9990228414535522, "length": 8.40160846710205, "mode": "test", "epoch": 46}
{"loss": 0.015075873583555222, "acc": 0.998614490032196, "length": 8.636640548706055, "mode": "train", "epoch": 47}
{"loss": 0.015463292598724365, "acc": 0.9987314939498901, "length": 8.539532661437988, "mode": "test", "epoch": 47}
{"loss": 0.013476068153977394, "acc": 0.9990219473838806, "length": 8.469305038452148, "mode": "train", "epoch": 48}
{"loss": 0.014315146952867508, "acc": 0.998967170715332, "length": 8.288331985473633, "mode": "test", "epoch": 48}
{"loss": 0.012827770784497261, "acc": 0.9990226626396179, "length": 8.05345344543457, "mode": "train", "epoch": 49}
{"loss": 0.018666736781597137, "acc": 0.9979777336120605, "length": 8.08870792388916, "mode": "test", "epoch": 49}
{"loss": 0.013270638883113861, "acc": 0.998871922492981, "length": 8.085798263549805, "mode": "train", "epoch": 50}
{"loss": 0.01447048969566822, "acc": 0.9989228844642639, "length": 8.232794761657715, "mode": "test", "epoch": 50}
{"loss": 0.012500082142651081, "acc": 0.9991116523742676, "length": 8.243584632873535, "mode": "train", "epoch": 51}
{"loss": 0.014666345901787281, "acc": 0.998917281627655, "length": 8.180578231811523, "mode": "test", "epoch": 51}
{"loss": 0.013485950417816639, "acc": 0.9989564418792725, "length": 8.33178997039795, "mode": "train", "epoch": 52}
{"loss": 0.014161652885377407, "acc": 0.9989868402481079, "length": 8.168773651123047, "mode": "test", "epoch": 52}
{"loss": 0.011781830340623856, "acc": 0.9992529153823853, "length": 8.06342887878418, "mode": "train", "epoch": 53}
{"loss": 0.014851007610559464, "acc": 0.9988998174667358, "length": 8.113716125488281, "mode": "test", "epoch": 53}
{"loss": 0.011272302828729153, "acc": 0.9993880391120911, "length": 8.034740447998047, "mode": "train", "epoch": 54}
{"loss": 0.015691978856921196, "acc": 0.998498260974884, "length": 8.306697845458984, "mode": "test", "epoch": 54}
{"loss": 0.013847892172634602, "acc": 0.9989033937454224, "length": 8.3458890914917, "mode": "train", "epoch": 55}
{"loss": 0.015031837858259678, "acc": 0.9989666938781738, "length": 8.840949058532715, "mode": "test", "epoch": 55}
{"loss": 0.015679556876420975, "acc": 0.9984312057495117, "length": 8.653173446655273, "mode": "train", "epoch": 56}
{"loss": 0.014500261284410954, "acc": 0.9987039566040039, "length": 8.716429710388184, "mode": "test", "epoch": 56}
{"loss": 0.015748172998428345, "acc": 0.9985256195068359, "length": 9.520458221435547, "mode": "train", "epoch": 57}
{"loss": 0.015136266127228737, "acc": 0.9988250732421875, "length": 9.05329704284668, "mode": "test", "epoch": 57}
{"loss": 0.013843078166246414, "acc": 0.9990720748901367, "length": 9.287347793579102, "mode": "train", "epoch": 58}
{"loss": 0.01619907282292843, "acc": 0.9988148808479309, "length": 9.740036964416504, "mode": "test", "epoch": 58}
{"loss": 0.013132117688655853, "acc": 0.9992321729660034, "length": 9.212241172790527, "mode": "train", "epoch": 59}
{"loss": 0.01477508433163166, "acc": 0.9991009831428528, "length": 8.982434272766113, "mode": "test", "epoch": 59}
{"loss": 0.013801912777125835, "acc": 0.9989501237869263, "length": 8.906387329101562, "mode": "train", "epoch": 60}
{"loss": 0.015009521506726742, "acc": 0.9989049434661865, "length": 8.75820255279541, "mode": "test", "epoch": 60}
test accuracy: 0.9981226921081543
