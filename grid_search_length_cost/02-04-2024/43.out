ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 20
{"loss": 0.4060412347316742, "acc": 0.8132676482200623, "length": 6.368507385253906, "mode": "train", "epoch": 1}
{"loss": 0.35991817712783813, "acc": 0.8599376678466797, "length": 8.968894958496094, "mode": "test", "epoch": 1}
{"loss": 0.24076104164123535, "acc": 0.9187028408050537, "length": 8.22395133972168, "mode": "train", "epoch": 2}
{"loss": 0.2771272361278534, "acc": 0.8999418616294861, "length": 8.453937530517578, "mode": "test", "epoch": 2}
{"loss": 0.18173158168792725, "acc": 0.943979024887085, "length": 9.359780311584473, "mode": "train", "epoch": 3}
{"loss": 0.24765798449516296, "acc": 0.9070518612861633, "length": 8.397146224975586, "mode": "test", "epoch": 3}
{"loss": 0.14730821549892426, "acc": 0.9612170457839966, "length": 9.459460258483887, "mode": "train", "epoch": 4}
{"loss": 0.18286696076393127, "acc": 0.9441986680030823, "length": 9.104696273803711, "mode": "test", "epoch": 4}
{"loss": 0.13380444049835205, "acc": 0.9656891822814941, "length": 9.698600769042969, "mode": "train", "epoch": 5}
{"loss": 0.1676623523235321, "acc": 0.9523259401321411, "length": 9.286957740783691, "mode": "test", "epoch": 5}
{"loss": 0.12179204821586609, "acc": 0.9690985679626465, "length": 9.241890907287598, "mode": "train", "epoch": 6}
{"loss": 0.17191791534423828, "acc": 0.9475117921829224, "length": 9.4421968460083, "mode": "test", "epoch": 6}
{"loss": 0.10651910305023193, "acc": 0.9733308553695679, "length": 9.547967910766602, "mode": "train", "epoch": 7}
{"loss": 0.15879201889038086, "acc": 0.9508588910102844, "length": 9.773049354553223, "mode": "test", "epoch": 7}
{"loss": 0.08850095421075821, "acc": 0.9796274900436401, "length": 9.81578254699707, "mode": "train", "epoch": 8}
{"loss": 0.12380997836589813, "acc": 0.966204822063446, "length": 8.9685697555542, "mode": "test", "epoch": 8}
{"loss": 0.07727553695440292, "acc": 0.9836130738258362, "length": 9.11617374420166, "mode": "train", "epoch": 9}
{"loss": 0.11376519501209259, "acc": 0.9705482721328735, "length": 8.295701026916504, "mode": "test", "epoch": 9}
{"loss": 0.0714183896780014, "acc": 0.9852887392044067, "length": 9.2775297164917, "mode": "train", "epoch": 10}
{"loss": 0.08638755232095718, "acc": 0.9807235598564148, "length": 8.693894386291504, "mode": "test", "epoch": 10}
{"loss": 0.0649745762348175, "acc": 0.9869783520698547, "length": 9.246630668640137, "mode": "train", "epoch": 11}
{"loss": 0.08213070780038834, "acc": 0.9804863929748535, "length": 9.697724342346191, "mode": "test", "epoch": 11}
{"loss": 0.05950804799795151, "acc": 0.988457202911377, "length": 9.381081581115723, "mode": "train", "epoch": 12}
{"loss": 0.07319121062755585, "acc": 0.9833628535270691, "length": 8.65700912475586, "mode": "test", "epoch": 12}
{"loss": 0.05635830760002136, "acc": 0.9892234802246094, "length": 9.773290634155273, "mode": "train", "epoch": 13}
{"loss": 0.08077256381511688, "acc": 0.9806748032569885, "length": 9.841148376464844, "mode": "test", "epoch": 13}
{"loss": 0.052019573748111725, "acc": 0.9904722571372986, "length": 9.486479759216309, "mode": "train", "epoch": 14}
{"loss": 0.058514632284641266, "acc": 0.9893845319747925, "length": 8.846675872802734, "mode": "test", "epoch": 14}
{"loss": 0.05058744177222252, "acc": 0.9907807111740112, "length": 9.4713134765625, "mode": "train", "epoch": 15}
{"loss": 0.05583445355296135, "acc": 0.9897196292877197, "length": 9.467557907104492, "mode": "test", "epoch": 15}
{"loss": 0.04772796109318733, "acc": 0.99139004945755, "length": 9.194815635681152, "mode": "train", "epoch": 16}
{"loss": 0.05009052902460098, "acc": 0.9908339977264404, "length": 8.664414405822754, "mode": "test", "epoch": 16}
{"loss": 0.046357348561286926, "acc": 0.9914758205413818, "length": 9.0956449508667, "mode": "train", "epoch": 17}
{"loss": 0.05310632288455963, "acc": 0.9902413487434387, "length": 9.162391662597656, "mode": "test", "epoch": 17}
{"loss": 0.04408371075987816, "acc": 0.9921814799308777, "length": 9.272568702697754, "mode": "train", "epoch": 18}
{"loss": 0.05124702304601669, "acc": 0.9908413887023926, "length": 8.94284725189209, "mode": "test", "epoch": 18}
{"loss": 0.042776502668857574, "acc": 0.9922822713851929, "length": 9.234272003173828, "mode": "train", "epoch": 19}
{"loss": 0.048495497554540634, "acc": 0.9908010959625244, "length": 10.006647109985352, "mode": "test", "epoch": 19}
{"loss": 0.03965555131435394, "acc": 0.9927626848220825, "length": 9.54948616027832, "mode": "train", "epoch": 20}
{"loss": 0.04055977985262871, "acc": 0.9930381774902344, "length": 9.324313163757324, "mode": "test", "epoch": 20}
{"loss": 0.03743070736527443, "acc": 0.9931560754776001, "length": 9.4091215133667, "mode": "train", "epoch": 21}
{"loss": 0.045140329748392105, "acc": 0.9913559556007385, "length": 9.653468132019043, "mode": "test", "epoch": 21}
{"loss": 0.03306351229548454, "acc": 0.9941937923431396, "length": 8.771463394165039, "mode": "train", "epoch": 22}
{"loss": 0.037043750286102295, "acc": 0.9936208724975586, "length": 8.54367733001709, "mode": "test", "epoch": 22}
{"loss": 0.031499117612838745, "acc": 0.9943822622299194, "length": 9.043529510498047, "mode": "train", "epoch": 23}
{"loss": 0.03789767995476723, "acc": 0.9928569793701172, "length": 9.104696273803711, "mode": "test", "epoch": 23}
{"loss": 0.027074184268712997, "acc": 0.9953359365463257, "length": 9.006383895874023, "mode": "train", "epoch": 24}
{"loss": 0.0373215526342392, "acc": 0.9913588166236877, "length": 8.869725227355957, "mode": "test", "epoch": 24}
{"loss": 0.024844419211149216, "acc": 0.9957721829414368, "length": 9.773971557617188, "mode": "train", "epoch": 25}
{"loss": 0.026052359491586685, "acc": 0.9959516525268555, "length": 9.217883110046387, "mode": "test", "epoch": 25}
{"loss": 0.019126584753394127, "acc": 0.9970806241035461, "length": 9.407801628112793, "mode": "train", "epoch": 26}
{"loss": 0.025106538087129593, "acc": 0.9962449073791504, "length": 9.283201217651367, "mode": "test", "epoch": 26}
{"loss": 0.01793218031525612, "acc": 0.9974285960197449, "length": 9.513296127319336, "mode": "train", "epoch": 27}
{"loss": 0.02197262831032276, "acc": 0.9966698288917542, "length": 9.458670616149902, "mode": "test", "epoch": 27}
{"loss": 0.015658248215913773, "acc": 0.9980127811431885, "length": 9.40623664855957, "mode": "train", "epoch": 28}
{"loss": 0.01693861372768879, "acc": 0.9981305599212646, "length": 9.33486270904541, "mode": "test", "epoch": 28}
{"loss": 0.016665281727910042, "acc": 0.9976010918617249, "length": 10.223522186279297, "mode": "train", "epoch": 29}
{"loss": 0.021186113357543945, "acc": 0.99677574634552, "length": 9.585874557495117, "mode": "test", "epoch": 29}
{"loss": 0.012816096656024456, "acc": 0.998558759689331, "length": 9.48022747039795, "mode": "train", "epoch": 30}
{"loss": 0.01584518887102604, "acc": 0.9981406331062317, "length": 9.351408958435059, "mode": "test", "epoch": 30}
{"loss": 0.012781886383891106, "acc": 0.9983147978782654, "length": 9.411491394042969, "mode": "train", "epoch": 31}
{"loss": 0.02026752568781376, "acc": 0.99652498960495, "length": 9.986344337463379, "mode": "test", "epoch": 31}
{"loss": 0.011625910177826881, "acc": 0.9987464547157288, "length": 10.372220993041992, "mode": "train", "epoch": 32}
{"loss": 0.0125947967171669, "acc": 0.998942494392395, "length": 10.40184211730957, "mode": "test", "epoch": 32}
{"loss": 0.009529023431241512, "acc": 0.9992830157279968, "length": 9.9025239944458, "mode": "train", "epoch": 33}
{"loss": 0.021535931155085564, "acc": 0.9957409501075745, "length": 9.61423397064209, "mode": "test", "epoch": 33}
{"loss": 0.00996183231472969, "acc": 0.9991252422332764, "length": 9.773646354675293, "mode": "train", "epoch": 34}
{"loss": 0.011041969992220402, "acc": 0.9992617964744568, "length": 9.837753295898438, "mode": "test", "epoch": 34}
{"loss": 0.010293927974998951, "acc": 0.9989787340164185, "length": 9.604938507080078, "mode": "train", "epoch": 35}
{"loss": 0.015408863313496113, "acc": 0.9979308247566223, "length": 9.800107955932617, "mode": "test", "epoch": 35}
{"loss": 0.008736860938370228, "acc": 0.999419093132019, "length": 9.529460906982422, "mode": "train", "epoch": 36}
{"loss": 0.010928413830697536, "acc": 0.9989897012710571, "length": 9.198013305664062, "mode": "test", "epoch": 36}
{"loss": 0.009643466211855412, "acc": 0.9991054534912109, "length": 9.653241157531738, "mode": "train", "epoch": 37}
{"loss": 0.012017985805869102, "acc": 0.9988221526145935, "length": 9.922904968261719, "mode": "test", "epoch": 37}
{"loss": 0.009631074965000153, "acc": 0.9991576075553894, "length": 9.835189819335938, "mode": "train", "epoch": 38}
{"loss": 0.012970475479960442, "acc": 0.9986826777458191, "length": 10.591943740844727, "mode": "test", "epoch": 38}
{"loss": 0.009809533134102821, "acc": 0.9990652799606323, "length": 9.408122062683105, "mode": "train", "epoch": 39}
{"loss": 0.010865739546716213, "acc": 0.9990279674530029, "length": 8.96791934967041, "mode": "test", "epoch": 39}
{"loss": 0.010491130873560905, "acc": 0.9988346099853516, "length": 9.54726505279541, "mode": "train", "epoch": 40}
{"loss": 0.010581563226878643, "acc": 0.9991266131401062, "length": 9.55903148651123, "mode": "test", "epoch": 40}
{"loss": 0.011121279560029507, "acc": 0.9986392855644226, "length": 9.807683944702148, "mode": "train", "epoch": 41}
{"loss": 0.014265044592320919, "acc": 0.9982355833053589, "length": 9.162644386291504, "mode": "test", "epoch": 41}
{"loss": 0.009428316727280617, "acc": 0.9992161393165588, "length": 9.710286140441895, "mode": "train", "epoch": 42}
{"loss": 0.009602509438991547, "acc": 0.9994493722915649, "length": 9.206539154052734, "mode": "test", "epoch": 42}
{"loss": 0.008578215725719929, "acc": 0.9992992281913757, "length": 9.115865707397461, "mode": "train", "epoch": 43}
{"loss": 0.010056176222860813, "acc": 0.9990142583847046, "length": 9.065281867980957, "mode": "test", "epoch": 43}
{"loss": 0.009428947232663631, "acc": 0.9990823864936829, "length": 9.349529266357422, "mode": "train", "epoch": 44}
{"loss": 0.011500072665512562, "acc": 0.9991347789764404, "length": 9.958236694335938, "mode": "test", "epoch": 44}
{"loss": 0.008111190050840378, "acc": 0.99942547082901, "length": 9.425355911254883, "mode": "train", "epoch": 45}
{"loss": 0.010495874099433422, "acc": 0.9990991353988647, "length": 9.119725227355957, "mode": "test", "epoch": 45}
{"loss": 0.010165167972445488, "acc": 0.9989265203475952, "length": 9.534204483032227, "mode": "train", "epoch": 46}
{"loss": 0.013250784948468208, "acc": 0.9982650279998779, "length": 9.35339641571045, "mode": "test", "epoch": 46}
{"loss": 0.008052855730056763, "acc": 0.9994158148765564, "length": 9.414633750915527, "mode": "train", "epoch": 47}
{"loss": 0.011605675332248211, "acc": 0.9989573955535889, "length": 9.352962493896484, "mode": "test", "epoch": 47}
{"loss": 0.008303849026560783, "acc": 0.9993816614151001, "length": 9.349868774414062, "mode": "train", "epoch": 48}
{"loss": 0.012805202044546604, "acc": 0.9981815814971924, "length": 9.202383995056152, "mode": "test", "epoch": 48}
{"loss": 0.008062832988798618, "acc": 0.9994115829467773, "length": 9.197257995605469, "mode": "train", "epoch": 49}
{"loss": 0.01067836582660675, "acc": 0.9992455840110779, "length": 9.027203559875488, "mode": "test", "epoch": 49}
{"loss": 0.010083110071718693, "acc": 0.9988712668418884, "length": 9.265735626220703, "mode": "train", "epoch": 50}
{"loss": 0.0139709347859025, "acc": 0.9984237551689148, "length": 9.604877471923828, "mode": "test", "epoch": 50}
{"loss": 0.008633432909846306, "acc": 0.9992803335189819, "length": 9.333781242370605, "mode": "train", "epoch": 51}
{"loss": 0.0114895673468709, "acc": 0.9991596341133118, "length": 9.227492332458496, "mode": "test", "epoch": 51}
{"loss": 0.0075067016296088696, "acc": 0.999530553817749, "length": 9.251198768615723, "mode": "train", "epoch": 52}
{"loss": 0.00966691691428423, "acc": 0.9993484616279602, "length": 9.04537582397461, "mode": "test", "epoch": 52}
{"loss": 0.008438275195658207, "acc": 0.9993314743041992, "length": 9.449527740478516, "mode": "train", "epoch": 53}
{"loss": 0.011008470319211483, "acc": 0.9990694522857666, "length": 9.318821907043457, "mode": "test", "epoch": 53}
{"loss": 0.011050079017877579, "acc": 0.9985712170600891, "length": 8.992766380310059, "mode": "train", "epoch": 54}
{"loss": 0.01211090013384819, "acc": 0.9986763596534729, "length": 9.198013305664062, "mode": "test", "epoch": 54}
{"loss": 0.00886742863804102, "acc": 0.9991344809532166, "length": 9.212625503540039, "mode": "train", "epoch": 55}
{"loss": 0.011833257041871548, "acc": 0.9986202716827393, "length": 9.525506019592285, "mode": "test", "epoch": 55}
{"loss": 0.009808767586946487, "acc": 0.9990346431732178, "length": 10.073137283325195, "mode": "train", "epoch": 56}
{"loss": 0.013998933136463165, "acc": 0.9981362819671631, "length": 9.968894958496094, "mode": "test", "epoch": 56}
{"loss": 0.026309458538889885, "acc": 0.9939064383506775, "length": 11.489249229431152, "mode": "train", "epoch": 57}
{"loss": 0.06313320249319077, "acc": 0.9816991686820984, "length": 15.370086669921875, "mode": "test", "epoch": 57}
{"loss": 0.20198997855186462, "acc": 0.9325558543205261, "length": 18.44487762451172, "mode": "train", "epoch": 58}
{"loss": 0.2898942530155182, "acc": 0.9065780639648438, "length": 20.491220474243164, "mode": "test", "epoch": 58}
{"loss": 0.24567025899887085, "acc": 0.9154699444770813, "length": 20.296688079833984, "mode": "train", "epoch": 59}
{"loss": 0.2547333538532257, "acc": 0.9085953831672668, "length": 20.51094627380371, "mode": "test", "epoch": 59}
{"loss": 0.209706112742424, "acc": 0.928229033946991, "length": 20.101055145263672, "mode": "train", "epoch": 60}
{"loss": 0.28072068095207214, "acc": 0.9049128890037537, "length": 20.403215408325195, "mode": "test", "epoch": 60}
test accuracy: 0.8912668824195862
