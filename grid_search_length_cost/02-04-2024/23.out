ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.6935082077980042, "acc": 0.5384846925735474, "length": 3.9710869789123535, "mode": "train", "epoch": 1}
{"loss": 0.6687195301055908, "acc": 0.5945936441421509, "length": 1.4340277910232544, "mode": "test", "epoch": 1}
{"loss": 0.6055089235305786, "acc": 0.6735345721244812, "length": 3.1651158332824707, "mode": "train", "epoch": 2}
{"loss": 0.6264371871948242, "acc": 0.6678466796875, "length": 1.6805555820465088, "mode": "test", "epoch": 2}
{"loss": 0.564296305179596, "acc": 0.6932501196861267, "length": 2.457289457321167, "mode": "train", "epoch": 3}
{"loss": 0.6342411637306213, "acc": 0.6754665374755859, "length": 1.7690972089767456, "mode": "test", "epoch": 3}
{"loss": 0.5449644327163696, "acc": 0.7112483382225037, "length": 3.008329153060913, "mode": "train", "epoch": 4}
{"loss": 0.7109154462814331, "acc": 0.6731119751930237, "length": 2.496527671813965, "mode": "test", "epoch": 4}
{"loss": 0.48930278420448303, "acc": 0.7634604573249817, "length": 3.818741798400879, "mode": "train", "epoch": 5}
{"loss": 0.5588815808296204, "acc": 0.7553818821907043, "length": 6.16319465637207, "mode": "test", "epoch": 5}
{"loss": 0.41637423634529114, "acc": 0.8168118596076965, "length": 4.729974269866943, "mode": "train", "epoch": 6}
{"loss": 0.46596023440361023, "acc": 0.7979817986488342, "length": 5.175347328186035, "mode": "test", "epoch": 6}
{"loss": 0.3793623745441437, "acc": 0.8361188769340515, "length": 5.412206172943115, "mode": "train", "epoch": 7}
{"loss": 0.4189818501472473, "acc": 0.8182265162467957, "length": 4.407986164093018, "mode": "test", "epoch": 7}
{"loss": 0.34849002957344055, "acc": 0.849778950214386, "length": 5.743392467498779, "mode": "train", "epoch": 8}
{"loss": 0.4165802299976349, "acc": 0.8231337070465088, "length": 5.484375, "mode": "test", "epoch": 8}
{"loss": 0.31291869282722473, "acc": 0.8712280988693237, "length": 6.263299465179443, "mode": "train", "epoch": 9}
{"loss": 0.3484231233596802, "acc": 0.8624946475028992, "length": 5.675347328186035, "mode": "test", "epoch": 9}
{"loss": 0.28969502449035645, "acc": 0.8833931088447571, "length": 6.678393840789795, "mode": "train", "epoch": 10}
{"loss": 0.3428358733654022, "acc": 0.8708441257476807, "length": 6.059027671813965, "mode": "test", "epoch": 10}
{"loss": 0.2600488066673279, "acc": 0.9015791416168213, "length": 7.1139020919799805, "mode": "train", "epoch": 11}
{"loss": 0.2924692630767822, "acc": 0.8842203617095947, "length": 5.748263835906982, "mode": "test", "epoch": 11}
{"loss": 0.23265361785888672, "acc": 0.9168244004249573, "length": 7.446483135223389, "mode": "train", "epoch": 12}
{"loss": 0.26483455300331116, "acc": 0.9031412601470947, "length": 7.081597328186035, "mode": "test", "epoch": 12}
{"loss": 0.2189648151397705, "acc": 0.9230992794036865, "length": 7.856505870819092, "mode": "train", "epoch": 13}
{"loss": 0.24947217106819153, "acc": 0.9076442718505859, "length": 7.5, "mode": "test", "epoch": 13}
{"loss": 0.205385223031044, "acc": 0.9299592971801758, "length": 8.132903099060059, "mode": "train", "epoch": 14}
{"loss": 0.24808351695537567, "acc": 0.9154106974601746, "length": 7.190972328186035, "mode": "test", "epoch": 14}
{"loss": 0.1948183923959732, "acc": 0.9328945875167847, "length": 8.527303695678711, "mode": "train", "epoch": 15}
{"loss": 0.23121005296707153, "acc": 0.9202609658241272, "length": 7.279513835906982, "mode": "test", "epoch": 15}
{"loss": 0.18029749393463135, "acc": 0.940107524394989, "length": 8.369059562683105, "mode": "train", "epoch": 16}
{"loss": 0.2054394632577896, "acc": 0.9312201738357544, "length": 8.35763931274414, "mode": "test", "epoch": 16}
{"loss": 0.1826498955488205, "acc": 0.9381836652755737, "length": 8.98322582244873, "mode": "train", "epoch": 17}
{"loss": 0.19387952983379364, "acc": 0.9311469197273254, "length": 7.527777671813965, "mode": "test", "epoch": 17}
{"loss": 0.16336579620838165, "acc": 0.9429264068603516, "length": 8.850693702697754, "mode": "train", "epoch": 18}
{"loss": 0.19189201295375824, "acc": 0.9354627132415771, "length": 8.54861068725586, "mode": "test", "epoch": 18}
{"loss": 0.15072154998779297, "acc": 0.9510382413864136, "length": 8.943452835083008, "mode": "train", "epoch": 19}
{"loss": 0.1789802461862564, "acc": 0.9402615427970886, "length": 7.734375, "mode": "test", "epoch": 19}
{"loss": 0.1428649127483368, "acc": 0.9518498182296753, "length": 8.589315414428711, "mode": "train", "epoch": 20}
{"loss": 0.18224947154521942, "acc": 0.9382188320159912, "length": 8.315972328186035, "mode": "test", "epoch": 20}
{"loss": 0.13467980921268463, "acc": 0.9571305513381958, "length": 9.349740028381348, "mode": "train", "epoch": 21}
{"loss": 0.17333142459392548, "acc": 0.9444607496261597, "length": 8.744791984558105, "mode": "test", "epoch": 21}
{"loss": 0.13850544393062592, "acc": 0.953953742980957, "length": 8.521645545959473, "mode": "train", "epoch": 22}
{"loss": 0.16484826803207397, "acc": 0.9466227293014526, "length": 7.93055534362793, "mode": "test", "epoch": 22}
{"loss": 0.10900057107210159, "acc": 0.9662860035896301, "length": 8.974380493164062, "mode": "train", "epoch": 23}
{"loss": 0.15229128301143646, "acc": 0.9491021633148193, "length": 8.58506965637207, "mode": "test", "epoch": 23}
{"loss": 0.09969867020845413, "acc": 0.9698082208633423, "length": 9.58961009979248, "mode": "train", "epoch": 24}
{"loss": 0.15770679712295532, "acc": 0.9539415836334229, "length": 9.25, "mode": "test", "epoch": 24}
{"loss": 0.09611351042985916, "acc": 0.9712752103805542, "length": 9.522026062011719, "mode": "train", "epoch": 25}
{"loss": 0.1501161903142929, "acc": 0.9496229887008667, "length": 9.85243034362793, "mode": "test", "epoch": 25}
{"loss": 0.08910815417766571, "acc": 0.9765040278434753, "length": 9.547074317932129, "mode": "train", "epoch": 26}
{"loss": 0.14717978239059448, "acc": 0.9451361894607544, "length": 8.86631965637207, "mode": "test", "epoch": 26}
{"loss": 0.08755656331777573, "acc": 0.9746205806732178, "length": 9.186396598815918, "mode": "train", "epoch": 27}
{"loss": 0.13471873104572296, "acc": 0.9545844197273254, "length": 9.48263931274414, "mode": "test", "epoch": 27}
{"loss": 0.06629563868045807, "acc": 0.9838957190513611, "length": 9.388696670532227, "mode": "train", "epoch": 28}
{"loss": 0.12795385718345642, "acc": 0.9582329988479614, "length": 9.159722328186035, "mode": "test", "epoch": 28}
{"loss": 0.06318515539169312, "acc": 0.9867354035377502, "length": 9.520334243774414, "mode": "train", "epoch": 29}
{"loss": 0.10840754956007004, "acc": 0.9696235656738281, "length": 9.979166984558105, "mode": "test", "epoch": 29}
{"loss": 0.05835815891623497, "acc": 0.988387405872345, "length": 10.231215476989746, "mode": "train", "epoch": 30}
{"loss": 0.10821457207202911, "acc": 0.9695420861244202, "length": 10.354166984558105, "mode": "test", "epoch": 30}
{"loss": 0.04622921720147133, "acc": 0.9929322600364685, "length": 10.60985279083252, "mode": "train", "epoch": 31}
{"loss": 0.09945365786552429, "acc": 0.973442792892456, "length": 9.82118034362793, "mode": "test", "epoch": 31}
{"loss": 0.043108802288770676, "acc": 0.993392825126648, "length": 9.67203426361084, "mode": "train", "epoch": 32}
{"loss": 0.09262172877788544, "acc": 0.9747938513755798, "length": 9.027777671813965, "mode": "test", "epoch": 32}
{"loss": 0.03877858445048332, "acc": 0.9950969815254211, "length": 9.313769340515137, "mode": "train", "epoch": 33}
{"loss": 0.08101548999547958, "acc": 0.9769341349601746, "length": 8.99305534362793, "mode": "test", "epoch": 33}
{"loss": 0.04264112189412117, "acc": 0.9921557903289795, "length": 9.066878318786621, "mode": "train", "epoch": 34}
{"loss": 0.08427964895963669, "acc": 0.9746989011764526, "length": 9.11631965637207, "mode": "test", "epoch": 34}
{"loss": 0.03568636626005173, "acc": 0.9952471852302551, "length": 9.382881164550781, "mode": "train", "epoch": 35}
{"loss": 0.07735828310251236, "acc": 0.9784992933273315, "length": 9.36631965637207, "mode": "test", "epoch": 35}
{"loss": 0.03133394569158554, "acc": 0.9965892434120178, "length": 8.963773727416992, "mode": "train", "epoch": 36}
{"loss": 0.061559513211250305, "acc": 0.9844401478767395, "length": 9.159722328186035, "mode": "test", "epoch": 36}
{"loss": 0.035381026566028595, "acc": 0.9956774711608887, "length": 9.0704984664917, "mode": "train", "epoch": 37}
{"loss": 0.08767794817686081, "acc": 0.9754719138145447, "length": 8.68923568725586, "mode": "test", "epoch": 37}
{"loss": 0.041510991752147675, "acc": 0.9917752146720886, "length": 9.269171714782715, "mode": "train", "epoch": 38}
{"loss": 0.07552745938301086, "acc": 0.9789089560508728, "length": 8.925347328186035, "mode": "test", "epoch": 38}
{"loss": 0.02966027520596981, "acc": 0.9968065619468689, "length": 9.328737258911133, "mode": "train", "epoch": 39}
{"loss": 0.06205419823527336, "acc": 0.9841797351837158, "length": 8.729166984558105, "mode": "test", "epoch": 39}
{"loss": 0.02341998554766178, "acc": 0.99879390001297, "length": 8.944038391113281, "mode": "train", "epoch": 40}
{"loss": 0.05398140847682953, "acc": 0.9863443374633789, "length": 8.78819465637207, "mode": "test", "epoch": 40}
{"loss": 0.023952821269631386, "acc": 0.9980083107948303, "length": 8.785758018493652, "mode": "train", "epoch": 41}
{"loss": 0.058709461241960526, "acc": 0.9860541224479675, "length": 8.543402671813965, "mode": "test", "epoch": 41}
{"loss": 0.026326501742005348, "acc": 0.9969053864479065, "length": 8.693105697631836, "mode": "train", "epoch": 42}
{"loss": 0.06882152706384659, "acc": 0.9817844033241272, "length": 8.526041984558105, "mode": "test", "epoch": 42}
{"loss": 0.025199245661497116, "acc": 0.9969737529754639, "length": 8.589183807373047, "mode": "train", "epoch": 43}
{"loss": 0.04055873677134514, "acc": 0.9896702170372009, "length": 8.135416984558105, "mode": "test", "epoch": 43}
{"loss": 0.02314946986734867, "acc": 0.997551441192627, "length": 8.378557205200195, "mode": "train", "epoch": 44}
{"loss": 0.0488009974360466, "acc": 0.9886013865470886, "length": 7.956597328186035, "mode": "test", "epoch": 44}
{"loss": 0.02671935223042965, "acc": 0.9966942667961121, "length": 7.855133056640625, "mode": "train", "epoch": 45}
{"loss": 0.04591744393110275, "acc": 0.990077018737793, "length": 8.31944465637207, "mode": "test", "epoch": 45}
{"loss": 0.03869616985321045, "acc": 0.9919193983078003, "length": 8.954910278320312, "mode": "train", "epoch": 46}
{"loss": 0.07364941388368607, "acc": 0.9783691763877869, "length": 7.487847328186035, "mode": "test", "epoch": 46}
{"loss": 0.028460724279284477, "acc": 0.9955236911773682, "length": 8.26494026184082, "mode": "train", "epoch": 47}
{"loss": 0.044881418347358704, "acc": 0.9895752668380737, "length": 8.286458015441895, "mode": "test", "epoch": 47}
{"loss": 0.021768588572740555, "acc": 0.9980999827384949, "length": 8.195209503173828, "mode": "train", "epoch": 48}
{"loss": 0.0451975017786026, "acc": 0.9851562976837158, "length": 7.989583492279053, "mode": "test", "epoch": 48}
{"loss": 0.019604889675974846, "acc": 0.9981734752655029, "length": 8.438027381896973, "mode": "train", "epoch": 49}
{"loss": 0.03928869962692261, "acc": 0.9884006977081299, "length": 8.43055534362793, "mode": "test", "epoch": 49}
{"loss": 0.01669660396873951, "acc": 0.9995908141136169, "length": 8.16879940032959, "mode": "train", "epoch": 50}
{"loss": 0.04309571161866188, "acc": 0.9888917207717896, "length": 7.583333492279053, "mode": "test", "epoch": 50}
{"loss": 0.018556151539087296, "acc": 0.9986163973808289, "length": 7.890112400054932, "mode": "train", "epoch": 51}
{"loss": 0.040590692311525345, "acc": 0.9901421666145325, "length": 7.58680534362793, "mode": "test", "epoch": 51}
{"loss": 0.016651643440127373, "acc": 0.9989538192749023, "length": 7.645559787750244, "mode": "train", "epoch": 52}
{"loss": 0.04289998114109039, "acc": 0.9890544414520264, "length": 7.451388835906982, "mode": "test", "epoch": 52}
{"loss": 0.016246972605586052, "acc": 0.9998011589050293, "length": 7.609358787536621, "mode": "train", "epoch": 53}
{"loss": 0.034176040440797806, "acc": 0.9926268458366394, "length": 7.404513835906982, "mode": "test", "epoch": 53}
{"loss": 0.06338110566139221, "acc": 0.9847065806388855, "length": 7.185357093811035, "mode": "train", "epoch": 54}
{"loss": 0.06582769751548767, "acc": 0.9826686382293701, "length": 6.704861164093018, "mode": "test", "epoch": 54}
{"loss": 0.05035863444209099, "acc": 0.988351583480835, "length": 8.052241325378418, "mode": "train", "epoch": 55}
{"loss": 0.047528430819511414, "acc": 0.9891437888145447, "length": 7.708333492279053, "mode": "test", "epoch": 55}
{"loss": 0.025073951110243797, "acc": 0.9963729381561279, "length": 8.331321716308594, "mode": "train", "epoch": 56}
{"loss": 0.03433334454894066, "acc": 0.9945962429046631, "length": 7.829861164093018, "mode": "test", "epoch": 56}
{"loss": 0.018530448898673058, "acc": 0.9987704157829285, "length": 8.245932579040527, "mode": "train", "epoch": 57}
{"loss": 0.024889467284083366, "acc": 0.9966009855270386, "length": 7.9375, "mode": "test", "epoch": 57}
{"loss": 0.016596583649516106, "acc": 0.9988284707069397, "length": 8.085636138916016, "mode": "train", "epoch": 58}
{"loss": 0.02668229304254055, "acc": 0.9954997301101685, "length": 7.798611164093018, "mode": "test", "epoch": 58}
{"loss": 0.01500458549708128, "acc": 0.9992584586143494, "length": 7.859645843505859, "mode": "train", "epoch": 59}
{"loss": 0.02459757961332798, "acc": 0.9963053464889526, "length": 7.6875, "mode": "test", "epoch": 59}
{"loss": 0.013624841347336769, "acc": 0.9998268485069275, "length": 7.728261947631836, "mode": "train", "epoch": 60}
{"loss": 0.0262293741106987, "acc": 0.9953911900520325, "length": 7.572916507720947, "mode": "test", "epoch": 60}
test accuracy: 0.9130023717880249
