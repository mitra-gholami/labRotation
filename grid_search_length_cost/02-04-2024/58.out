ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 20
{"loss": 0.4138015806674957, "acc": 0.8083803057670593, "length": 6.046620845794678, "mode": "train", "epoch": 1}
{"loss": 0.3418242335319519, "acc": 0.864046037197113, "length": 8.044946670532227, "mode": "test", "epoch": 1}
{"loss": 0.23851598799228668, "acc": 0.9156048893928528, "length": 7.611174583435059, "mode": "train", "epoch": 2}
{"loss": 0.2630920112133026, "acc": 0.9045690298080444, "length": 6.936130523681641, "mode": "test", "epoch": 2}
{"loss": 0.1892687976360321, "acc": 0.9436332583427429, "length": 7.996484279632568, "mode": "train", "epoch": 3}
{"loss": 0.2045222669839859, "acc": 0.9364223480224609, "length": 7.1754255294799805, "mode": "test", "epoch": 3}
{"loss": 0.16914597153663635, "acc": 0.9522557854652405, "length": 7.886168479919434, "mode": "train", "epoch": 4}
{"loss": 0.19290734827518463, "acc": 0.9427501559257507, "length": 8.112421035766602, "mode": "test", "epoch": 4}
{"loss": 0.1540258675813675, "acc": 0.9579660296440125, "length": 7.960983753204346, "mode": "train", "epoch": 5}
{"loss": 0.16554312407970428, "acc": 0.952992856502533, "length": 7.665585517883301, "mode": "test", "epoch": 5}
{"loss": 0.14454106986522675, "acc": 0.9608862996101379, "length": 7.945606231689453, "mode": "train", "epoch": 6}
{"loss": 0.17012779414653778, "acc": 0.9489185810089111, "length": 7.3789286613464355, "mode": "test", "epoch": 6}
{"loss": 0.13299153745174408, "acc": 0.964978039264679, "length": 7.9399309158325195, "mode": "train", "epoch": 7}
{"loss": 0.1496869921684265, "acc": 0.9579430222511292, "length": 7.835171699523926, "mode": "test", "epoch": 7}
{"loss": 0.12303116917610168, "acc": 0.9687079191207886, "length": 7.9802045822143555, "mode": "train", "epoch": 8}
{"loss": 0.13801507651805878, "acc": 0.9634052515029907, "length": 7.599336624145508, "mode": "test", "epoch": 8}
{"loss": 0.11494667083024979, "acc": 0.9712283611297607, "length": 7.856814861297607, "mode": "train", "epoch": 9}
{"loss": 0.1318289041519165, "acc": 0.9643979668617249, "length": 7.157979965209961, "mode": "test", "epoch": 9}
{"loss": 0.1081344336271286, "acc": 0.9731659889221191, "length": 7.79112434387207, "mode": "train", "epoch": 10}
{"loss": 0.12602338194847107, "acc": 0.9666306376457214, "length": 7.95191764831543, "mode": "test", "epoch": 10}
{"loss": 0.09994421154260635, "acc": 0.9757359623908997, "length": 7.856521129608154, "mode": "train", "epoch": 11}
{"loss": 0.11090504378080368, "acc": 0.972511887550354, "length": 7.491817951202393, "mode": "test", "epoch": 11}
{"loss": 0.09211590141057968, "acc": 0.9784470200538635, "length": 7.905294895172119, "mode": "train", "epoch": 12}
{"loss": 0.10427741706371307, "acc": 0.9748257994651794, "length": 8.1286039352417, "mode": "test", "epoch": 12}
{"loss": 0.08547073602676392, "acc": 0.9803676605224609, "length": 8.021671295166016, "mode": "train", "epoch": 13}
{"loss": 0.10442796349525452, "acc": 0.9721231460571289, "length": 8.117250442504883, "mode": "test", "epoch": 13}
{"loss": 0.07570547610521317, "acc": 0.9827408790588379, "length": 8.359573364257812, "mode": "train", "epoch": 14}
{"loss": 0.0813307911157608, "acc": 0.9816872477531433, "length": 8.047253608703613, "mode": "test", "epoch": 14}
{"loss": 0.06833688169717789, "acc": 0.9850190877914429, "length": 8.50576114654541, "mode": "train", "epoch": 15}
{"loss": 0.07410653680562973, "acc": 0.9839423894882202, "length": 8.453503608703613, "mode": "test", "epoch": 15}
{"loss": 0.06128169223666191, "acc": 0.9871501326560974, "length": 8.358214378356934, "mode": "train", "epoch": 16}
{"loss": 0.0963207557797432, "acc": 0.9747937321662903, "length": 8.228914260864258, "mode": "test", "epoch": 16}
{"loss": 0.058768581598997116, "acc": 0.9880532622337341, "length": 8.751891136169434, "mode": "train", "epoch": 17}
{"loss": 0.06411099433898926, "acc": 0.9866741895675659, "length": 9.13707447052002, "mode": "test", "epoch": 17}
{"loss": 0.058257464319467545, "acc": 0.988051176071167, "length": 9.184057235717773, "mode": "train", "epoch": 18}
{"loss": 0.07068178802728653, "acc": 0.9830605387687683, "length": 9.432994842529297, "mode": "test", "epoch": 18}
{"loss": 0.05450297147035599, "acc": 0.989385187625885, "length": 9.234493255615234, "mode": "train", "epoch": 19}
{"loss": 0.06013503298163414, "acc": 0.9871460199356079, "length": 8.845263481140137, "mode": "test", "epoch": 19}
{"loss": 0.051289062947034836, "acc": 0.9903149604797363, "length": 9.25031566619873, "mode": "train", "epoch": 20}
{"loss": 0.06572342664003372, "acc": 0.9853625297546387, "length": 9.317906379699707, "mode": "test", "epoch": 20}
{"loss": 0.05127881467342377, "acc": 0.9899733066558838, "length": 9.139030456542969, "mode": "train", "epoch": 21}
{"loss": 0.06589458137750626, "acc": 0.9841874837875366, "length": 8.71114444732666, "mode": "test", "epoch": 21}
{"loss": 0.048307329416275024, "acc": 0.9907122850418091, "length": 9.396149635314941, "mode": "train", "epoch": 22}
{"loss": 0.05935046076774597, "acc": 0.9869804382324219, "length": 9.319708824157715, "mode": "test", "epoch": 22}
{"loss": 0.04568188637495041, "acc": 0.99129718542099, "length": 9.300355911254883, "mode": "train", "epoch": 23}
{"loss": 0.06161196157336235, "acc": 0.9872987866401672, "length": 9.700692176818848, "mode": "test", "epoch": 23}
{"loss": 0.04859970137476921, "acc": 0.9905338883399963, "length": 10.04694652557373, "mode": "train", "epoch": 24}
{"loss": 0.05196817219257355, "acc": 0.989661455154419, "length": 9.317365646362305, "mode": "test", "epoch": 24}
{"loss": 0.04448140785098076, "acc": 0.9915242791175842, "length": 9.75725269317627, "mode": "train", "epoch": 25}
{"loss": 0.05487245321273804, "acc": 0.9882205724716187, "length": 9.7463960647583, "mode": "test", "epoch": 25}
{"loss": 0.04236694052815437, "acc": 0.9919977784156799, "length": 10.373038291931152, "mode": "train", "epoch": 26}
{"loss": 0.051817260682582855, "acc": 0.9898644089698792, "length": 9.984464645385742, "mode": "test", "epoch": 26}
{"loss": 0.04225626960396767, "acc": 0.9918769001960754, "length": 10.317602157592773, "mode": "train", "epoch": 27}
{"loss": 0.04920060187578201, "acc": 0.990204930305481, "length": 9.955053329467773, "mode": "test", "epoch": 27}
{"loss": 0.040730901062488556, "acc": 0.9923603534698486, "length": 10.248321533203125, "mode": "train", "epoch": 28}
{"loss": 0.04679253324866295, "acc": 0.9908135533332825, "length": 10.235005378723145, "mode": "test", "epoch": 28}
{"loss": 0.04042098671197891, "acc": 0.9924965500831604, "length": 10.575927734375, "mode": "train", "epoch": 29}
{"loss": 0.045733142644166946, "acc": 0.9914920926094055, "length": 10.33675765991211, "mode": "test", "epoch": 29}
{"loss": 0.03837078437209129, "acc": 0.9929137825965881, "length": 9.548810005187988, "mode": "train", "epoch": 30}
{"loss": 0.044037263840436935, "acc": 0.9918956756591797, "length": 9.34238052368164, "mode": "test", "epoch": 30}
{"loss": 0.03674721345305443, "acc": 0.9933303594589233, "length": 9.641322135925293, "mode": "train", "epoch": 31}
{"loss": 0.04416867345571518, "acc": 0.9914761781692505, "length": 9.6652250289917, "mode": "test", "epoch": 31}
{"loss": 0.03855041041970253, "acc": 0.9926729202270508, "length": 9.954801559448242, "mode": "train", "epoch": 32}
{"loss": 0.041277311742305756, "acc": 0.9925967454910278, "length": 9.627306938171387, "mode": "test", "epoch": 32}
{"loss": 0.034058284014463425, "acc": 0.9937816858291626, "length": 9.48277473449707, "mode": "train", "epoch": 33}
{"loss": 0.03659864515066147, "acc": 0.99370276927948, "length": 9.615087509155273, "mode": "test", "epoch": 33}
{"loss": 0.031207595020532608, "acc": 0.9946640133857727, "length": 9.689066886901855, "mode": "train", "epoch": 34}
{"loss": 0.04462999850511551, "acc": 0.9900742769241333, "length": 10.892229080200195, "mode": "test", "epoch": 34}
{"loss": 0.03570584952831268, "acc": 0.9933303594589233, "length": 10.550190925598145, "mode": "train", "epoch": 35}
{"loss": 0.03634257614612579, "acc": 0.993480920791626, "length": 10.106689453125, "mode": "test", "epoch": 35}
{"loss": 0.031413618475198746, "acc": 0.9944279193878174, "length": 9.603123664855957, "mode": "train", "epoch": 36}
{"loss": 0.03994442895054817, "acc": 0.9926236271858215, "length": 9.719218254089355, "mode": "test", "epoch": 36}
{"loss": 0.03246619552373886, "acc": 0.9941001534461975, "length": 10.3268461227417, "mode": "train", "epoch": 37}
{"loss": 0.038342855870723724, "acc": 0.9925182461738586, "length": 10.793216705322266, "mode": "test", "epoch": 37}
{"loss": 0.02983536198735237, "acc": 0.994715690612793, "length": 10.146366119384766, "mode": "train", "epoch": 38}
{"loss": 0.03361979499459267, "acc": 0.9937170147895813, "length": 9.397238731384277, "mode": "test", "epoch": 38}
{"loss": 0.0306601133197546, "acc": 0.994444727897644, "length": 10.21043872833252, "mode": "train", "epoch": 39}
{"loss": 0.049995534121990204, "acc": 0.9877863526344299, "length": 10.69424057006836, "mode": "test", "epoch": 39}
{"loss": 0.02954396978020668, "acc": 0.9948285222053528, "length": 10.338780403137207, "mode": "train", "epoch": 40}
{"loss": 0.03593364357948303, "acc": 0.9933258295059204, "length": 9.971705436706543, "mode": "test", "epoch": 40}
{"loss": 0.02966253273189068, "acc": 0.9948872923851013, "length": 10.749980926513672, "mode": "train", "epoch": 41}
{"loss": 0.0373719185590744, "acc": 0.9928861856460571, "length": 11.277176856994629, "mode": "test", "epoch": 41}
{"loss": 0.031069763004779816, "acc": 0.994411051273346, "length": 11.184760093688965, "mode": "train", "epoch": 42}
{"loss": 0.034909941256046295, "acc": 0.9930864572525024, "length": 10.61108684539795, "mode": "test", "epoch": 42}
{"loss": 0.04597980156540871, "acc": 0.9896641373634338, "length": 12.976771354675293, "mode": "train", "epoch": 43}
{"loss": 0.08197975903749466, "acc": 0.9785829782485962, "length": 20.136930465698242, "mode": "test", "epoch": 43}
{"loss": 0.041093047708272934, "acc": 0.9916837811470032, "length": 15.480021476745605, "mode": "train", "epoch": 44}
{"loss": 0.04898250475525856, "acc": 0.9884535074234009, "length": 11.724409103393555, "mode": "test", "epoch": 44}
{"loss": 0.03214561566710472, "acc": 0.993797242641449, "length": 11.480081558227539, "mode": "train", "epoch": 45}
{"loss": 0.040053464472293854, "acc": 0.9917255640029907, "length": 10.972930908203125, "mode": "test", "epoch": 45}
{"loss": 0.02759622037410736, "acc": 0.9951803088188171, "length": 10.37812328338623, "mode": "train", "epoch": 46}
{"loss": 0.03375111520290375, "acc": 0.9932414293289185, "length": 9.962514877319336, "mode": "test", "epoch": 46}
{"loss": 0.027381282299757004, "acc": 0.9951058030128479, "length": 10.752903938293457, "mode": "train", "epoch": 47}
{"loss": 0.03139210492372513, "acc": 0.9946488738059998, "length": 10.66443157196045, "mode": "test", "epoch": 47}
{"loss": 0.03701154887676239, "acc": 0.9929255843162537, "length": 17.06853675842285, "mode": "train", "epoch": 48}
{"loss": 0.03822577744722366, "acc": 0.9932131767272949, "length": 15.934220314025879, "mode": "test", "epoch": 48}
{"loss": 0.025829646736383438, "acc": 0.995802104473114, "length": 12.6424560546875, "mode": "train", "epoch": 49}
{"loss": 0.030816996470093727, "acc": 0.9935830235481262, "length": 11.466226577758789, "mode": "test", "epoch": 49}
{"loss": 0.03229758143424988, "acc": 0.9935708045959473, "length": 13.803443908691406, "mode": "train", "epoch": 50}
{"loss": 0.0316682867705822, "acc": 0.9943908452987671, "length": 13.749963760375977, "mode": "test", "epoch": 50}
{"loss": 0.027209265157580376, "acc": 0.9952330589294434, "length": 13.304815292358398, "mode": "train", "epoch": 51}
{"loss": 0.03262397646903992, "acc": 0.993438184261322, "length": 12.522527694702148, "mode": "test", "epoch": 51}
{"loss": 0.024319887161254883, "acc": 0.9959300756454468, "length": 11.326862335205078, "mode": "train", "epoch": 52}
{"loss": 0.03360775485634804, "acc": 0.9929807186126709, "length": 11.067401885986328, "mode": "test", "epoch": 52}
{"loss": 0.042963381856679916, "acc": 0.9908899664878845, "length": 17.90102195739746, "mode": "train", "epoch": 53}
{"loss": 0.05482332780957222, "acc": 0.9875560998916626, "length": 20.62031364440918, "mode": "test", "epoch": 53}
{"loss": 0.1262160688638687, "acc": 0.9635676145553589, "length": 20.1076717376709, "mode": "train", "epoch": 54}
{"loss": 0.18609659373760223, "acc": 0.9416942596435547, "length": 20.069780349731445, "mode": "test", "epoch": 54}
{"loss": 0.15206050872802734, "acc": 0.953403890132904, "length": 19.915145874023438, "mode": "train", "epoch": 55}
{"loss": 0.15911489725112915, "acc": 0.9486077427864075, "length": 20.33228874206543, "mode": "test", "epoch": 55}
{"loss": 0.12540067732334137, "acc": 0.9622610807418823, "length": 20.464859008789062, "mode": "train", "epoch": 56}
{"loss": 0.14154745638370514, "acc": 0.9560227394104004, "length": 20.733455657958984, "mode": "test", "epoch": 56}
{"loss": 0.12468316406011581, "acc": 0.9616647958755493, "length": 20.808866500854492, "mode": "train", "epoch": 57}
{"loss": 0.17350272834300995, "acc": 0.9432410597801208, "length": 20.989330291748047, "mode": "test", "epoch": 57}
{"loss": 0.13705512881278992, "acc": 0.9573920369148254, "length": 20.98954200744629, "mode": "train", "epoch": 58}
{"loss": 0.16547687351703644, "acc": 0.9449981451034546, "length": 20.983022689819336, "mode": "test", "epoch": 58}
{"loss": 0.12970492243766785, "acc": 0.9602295160293579, "length": 20.959272384643555, "mode": "train", "epoch": 59}
{"loss": 0.1550406664609909, "acc": 0.9514063596725464, "length": 20.953792572021484, "mode": "test", "epoch": 59}
{"loss": 0.10492567718029022, "acc": 0.9695799350738525, "length": 20.919925689697266, "mode": "train", "epoch": 60}
{"loss": 0.14884290099143982, "acc": 0.9524686932563782, "length": 20.971525192260742, "mode": "test", "epoch": 60}
test accuracy: 0.931384801864624
