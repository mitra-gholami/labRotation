ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.7065646648406982, "acc": 0.5037677884101868, "length": 2.044555187225342, "mode": "train", "epoch": 1}
{"loss": 0.695669949054718, "acc": 0.5263980627059937, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6494140028953552, "acc": 0.6279851198196411, "length": 1.7850573062896729, "mode": "train", "epoch": 2}
{"loss": 0.6030189394950867, "acc": 0.6782844066619873, "length": 1.9736841917037964, "mode": "test", "epoch": 2}
{"loss": 0.5704852342605591, "acc": 0.7137235999107361, "length": 2.223461866378784, "mode": "train", "epoch": 3}
{"loss": 0.5464699864387512, "acc": 0.755615234375, "length": 2.6677632331848145, "mode": "test", "epoch": 3}
{"loss": 0.503864049911499, "acc": 0.7731360793113708, "length": 2.6599833965301514, "mode": "train", "epoch": 4}
{"loss": 0.504021406173706, "acc": 0.7663445472717285, "length": 2.9851973056793213, "mode": "test", "epoch": 4}
{"loss": 0.45441022515296936, "acc": 0.8072749376296997, "length": 2.9153084754943848, "mode": "train", "epoch": 5}
{"loss": 0.45314863324165344, "acc": 0.8105031251907349, "length": 3.1282894611358643, "mode": "test", "epoch": 5}
{"loss": 0.415772408246994, "acc": 0.8258845806121826, "length": 3.1311652660369873, "mode": "train", "epoch": 6}
{"loss": 0.42667609453201294, "acc": 0.8279014825820923, "length": 3.3782894611358643, "mode": "test", "epoch": 6}
{"loss": 0.38286739587783813, "acc": 0.8466516733169556, "length": 3.438443660736084, "mode": "train", "epoch": 7}
{"loss": 0.42554599046707153, "acc": 0.8078869581222534, "length": 3.6003289222717285, "mode": "test", "epoch": 7}
{"loss": 0.3552647531032562, "acc": 0.858637273311615, "length": 3.667843818664551, "mode": "train", "epoch": 8}
{"loss": 0.36934539675712585, "acc": 0.854281485080719, "length": 3.817434310913086, "mode": "test", "epoch": 8}
{"loss": 0.31786593794822693, "acc": 0.8772504925727844, "length": 3.8179714679718018, "mode": "train", "epoch": 9}
{"loss": 0.345114141702652, "acc": 0.8678634166717529, "length": 3.8963816165924072, "mode": "test", "epoch": 9}
{"loss": 0.2860342264175415, "acc": 0.8923467993736267, "length": 3.9240317344665527, "mode": "train", "epoch": 10}
{"loss": 0.31792566180229187, "acc": 0.8836348652839661, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2650119662284851, "acc": 0.9011242389678955, "length": 3.976245164871216, "mode": "train", "epoch": 11}
{"loss": 0.28809458017349243, "acc": 0.8980262875556946, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.24793097376823425, "acc": 0.9113844633102417, "length": 3.983724594116211, "mode": "train", "epoch": 12}
{"loss": 0.27548617124557495, "acc": 0.8919405937194824, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.23335455358028412, "acc": 0.9180269837379456, "length": 3.9921088218688965, "mode": "train", "epoch": 13}
{"loss": 0.2581847608089447, "acc": 0.9135689735412598, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2169881910085678, "acc": 0.9227398633956909, "length": 3.994947671890259, "mode": "train", "epoch": 14}
{"loss": 0.260051965713501, "acc": 0.9131579399108887, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.21134096384048462, "acc": 0.9274365305900574, "length": 3.9964616298675537, "mode": "train", "epoch": 15}
{"loss": 0.25800246000289917, "acc": 0.9152960777282715, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.19932207465171814, "acc": 0.9333812594413757, "length": 3.997499465942383, "mode": "train", "epoch": 16}
{"loss": 0.28046226501464844, "acc": 0.8769736289978027, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.18970663845539093, "acc": 0.9371787309646606, "length": 3.998199939727783, "mode": "train", "epoch": 17}
{"loss": 0.27623501420021057, "acc": 0.9026316404342651, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.18563197553157806, "acc": 0.9385046362876892, "length": 3.9988279342651367, "mode": "train", "epoch": 18}
{"loss": 0.22381722927093506, "acc": 0.9183388948440552, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.1774514764547348, "acc": 0.94387286901474, "length": 3.9987545013427734, "mode": "train", "epoch": 19}
{"loss": 0.22320689260959625, "acc": 0.9123355746269226, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.16574741899967194, "acc": 0.9462408423423767, "length": 3.9991137981414795, "mode": "train", "epoch": 20}
{"loss": 0.21277427673339844, "acc": 0.932236909866333, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.16550606489181519, "acc": 0.9481731653213501, "length": 3.9993209838867188, "mode": "train", "epoch": 21}
{"loss": 0.20337653160095215, "acc": 0.9393913745880127, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.15147611498832703, "acc": 0.9545180797576904, "length": 3.9993231296539307, "mode": "train", "epoch": 22}
{"loss": 0.19135098159313202, "acc": 0.9424343109130859, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.1497134566307068, "acc": 0.9560757279396057, "length": 3.9995498657226562, "mode": "train", "epoch": 23}
{"loss": 0.20646314322948456, "acc": 0.9344571828842163, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.14528487622737885, "acc": 0.9563210606575012, "length": 3.9995837211608887, "mode": "train", "epoch": 24}
{"loss": 0.20082524418830872, "acc": 0.9341285228729248, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1384805589914322, "acc": 0.9598205089569092, "length": 3.9996511936187744, "mode": "train", "epoch": 25}
{"loss": 0.23092368245124817, "acc": 0.9282894134521484, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.13092511892318726, "acc": 0.9634587168693542, "length": 3.999732494354248, "mode": "train", "epoch": 26}
{"loss": 0.1925402730703354, "acc": 0.9360198974609375, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.12706305086612701, "acc": 0.9650862216949463, "length": 3.9997336864471436, "mode": "train", "epoch": 27}
{"loss": 0.17450906336307526, "acc": 0.9501643776893616, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.12835653126239777, "acc": 0.9640012979507446, "length": 3.9997141361236572, "mode": "train", "epoch": 28}
{"loss": 0.18196706473827362, "acc": 0.944654643535614, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.12183140963315964, "acc": 0.9668555855751038, "length": 3.999828577041626, "mode": "train", "epoch": 29}
{"loss": 0.18854111433029175, "acc": 0.9399670958518982, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.11982449889183044, "acc": 0.9671744108200073, "length": 3.9997878074645996, "mode": "train", "epoch": 30}
{"loss": 0.16141070425510406, "acc": 0.9518092274665833, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.11037042737007141, "acc": 0.9715768098831177, "length": 3.999889850616455, "mode": "train", "epoch": 31}
{"loss": 0.16418015956878662, "acc": 0.9488486051559448, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.10340069234371185, "acc": 0.9751808047294617, "length": 3.9998581409454346, "mode": "train", "epoch": 32}
{"loss": 0.15667665004730225, "acc": 0.959128201007843, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.09943903237581253, "acc": 0.9758065342903137, "length": 3.999901533126831, "mode": "train", "epoch": 33}
{"loss": 0.1480303853750229, "acc": 0.9638156890869141, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.09630319476127625, "acc": 0.9762963056564331, "length": 3.9999210834503174, "mode": "train", "epoch": 34}
{"loss": 0.13139785826206207, "acc": 0.969407856464386, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.09103526920080185, "acc": 0.9784664511680603, "length": 3.999943494796753, "mode": "train", "epoch": 35}
{"loss": 0.14564651250839233, "acc": 0.9568256735801697, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.09800530225038528, "acc": 0.9745896458625793, "length": 3.9999496936798096, "mode": "train", "epoch": 36}
{"loss": 0.1405649036169052, "acc": 0.9580591917037964, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.08929292112588882, "acc": 0.978142499923706, "length": 3.999959945678711, "mode": "train", "epoch": 37}
{"loss": 0.15238535404205322, "acc": 0.963569164276123, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.0885249450802803, "acc": 0.9763526916503906, "length": 3.9999582767486572, "mode": "train", "epoch": 38}
{"loss": 0.1289224922657013, "acc": 0.9648026823997498, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.08703004568815231, "acc": 0.9789566397666931, "length": 3.9999704360961914, "mode": "train", "epoch": 39}
{"loss": 0.1375148892402649, "acc": 0.9595394134521484, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.09422829747200012, "acc": 0.975567638874054, "length": 3.9999775886535645, "mode": "train", "epoch": 40}
{"loss": 0.12594808638095856, "acc": 0.9688321948051453, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.07883140444755554, "acc": 0.9816136956214905, "length": 3.9999680519104004, "mode": "train", "epoch": 41}
{"loss": 0.13594616949558258, "acc": 0.9670230746269226, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.07350955903530121, "acc": 0.9837023615837097, "length": 3.999981641769409, "mode": "train", "epoch": 42}
{"loss": 0.12077047675848007, "acc": 0.9662829041481018, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.06794964522123337, "acc": 0.9860072731971741, "length": 3.999981641769409, "mode": "train", "epoch": 43}
{"loss": 0.1235140860080719, "acc": 0.9657071828842163, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.07315017282962799, "acc": 0.9843534827232361, "length": 3.999985933303833, "mode": "train", "epoch": 44}
{"loss": 0.14133235812187195, "acc": 0.9634866118431091, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.07200367003679276, "acc": 0.9843810200691223, "length": 3.9999895095825195, "mode": "train", "epoch": 45}
{"loss": 0.11094728112220764, "acc": 0.975904643535614, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.06904619187116623, "acc": 0.9858994483947754, "length": 3.9999895095825195, "mode": "train", "epoch": 46}
{"loss": 0.12528999149799347, "acc": 0.9634868502616882, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.06751939654350281, "acc": 0.9859538674354553, "length": 3.999993085861206, "mode": "train", "epoch": 47}
{"loss": 0.10279174894094467, "acc": 0.9697368741035461, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.06046844273805618, "acc": 0.9892075657844543, "length": 3.999993085861206, "mode": "train", "epoch": 48}
{"loss": 0.12391259521245956, "acc": 0.9699836373329163, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.060824427753686905, "acc": 0.9882857799530029, "length": 3.999993085861206, "mode": "train", "epoch": 49}
{"loss": 0.09091316163539886, "acc": 0.9819079041481018, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.06299272179603577, "acc": 0.9882317185401917, "length": 3.9999947547912598, "mode": "train", "epoch": 50}
{"loss": 0.09432043880224228, "acc": 0.9814144968986511, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.06396374106407166, "acc": 0.9869573712348938, "length": 3.999995470046997, "mode": "train", "epoch": 51}
{"loss": 0.12337611615657806, "acc": 0.9725328683853149, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.06288774311542511, "acc": 0.9879869818687439, "length": 3.9999873638153076, "mode": "train", "epoch": 52}
{"loss": 0.1027853935956955, "acc": 0.9736841917037964, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.0550878532230854, "acc": 0.9906449913978577, "length": 3.999995470046997, "mode": "train", "epoch": 53}
{"loss": 0.09317637979984283, "acc": 0.9837992787361145, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.05155041068792343, "acc": 0.9921901226043701, "length": 3.9999923706054688, "mode": "train", "epoch": 54}
{"loss": 0.0910172164440155, "acc": 0.9833881258964539, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.05104528367519379, "acc": 0.9919737577438354, "length": 3.999997138977051, "mode": "train", "epoch": 55}
{"loss": 0.08532541990280151, "acc": 0.9854440093040466, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.04746030271053314, "acc": 0.9931668639183044, "length": 3.999997615814209, "mode": "train", "epoch": 56}
{"loss": 0.10941336303949356, "acc": 0.9752467274665833, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.05045149475336075, "acc": 0.9920008778572083, "length": 3.9999983310699463, "mode": "train", "epoch": 57}
{"loss": 0.09271764755249023, "acc": 0.9829769134521484, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06030949205160141, "acc": 0.9900485277175903, "length": 3.999997854232788, "mode": "train", "epoch": 58}
{"loss": 0.10190236568450928, "acc": 0.979111909866333, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.06525914371013641, "acc": 0.9859267473220825, "length": 3.9999945163726807, "mode": "train", "epoch": 59}
{"loss": 0.07932212948799133, "acc": 0.9842104911804199, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.050278354436159134, "acc": 0.9920281171798706, "length": 3.9999985694885254, "mode": "train", "epoch": 60}
{"loss": 0.10285516828298569, "acc": 0.9693257212638855, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.6345371007919312
