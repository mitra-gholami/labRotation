ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.3051126003265381, "acc": 0.8696593642234802, "length": 3.946226119995117, "mode": "train", "epoch": 1}
{"loss": 0.3374694585800171, "acc": 0.8587436676025391, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.18411697447299957, "acc": 0.9361478090286255, "length": 3.9999876022338867, "mode": "train", "epoch": 2}
{"loss": 0.3208428919315338, "acc": 0.8645060658454895, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.1472245454788208, "acc": 0.9536933898925781, "length": 3.999997138977051, "mode": "train", "epoch": 3}
{"loss": 0.2764286994934082, "acc": 0.8960438370704651, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.12803883850574493, "acc": 0.9631236791610718, "length": 3.999999523162842, "mode": "train", "epoch": 4}
{"loss": 0.30784687399864197, "acc": 0.887058436870575, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.11402921378612518, "acc": 0.9695362448692322, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.3662426769733429, "acc": 0.8625699877738953, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.12047810852527618, "acc": 0.9661985635757446, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.35883039236068726, "acc": 0.8717190623283386, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.10806963592767715, "acc": 0.9712173938751221, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.37149718403816223, "acc": 0.8708200454711914, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.0935601145029068, "acc": 0.9763001203536987, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.41330423951148987, "acc": 0.8639606237411499, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.08227164298295975, "acc": 0.9804317951202393, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.4374631345272064, "acc": 0.8623621463775635, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.0859687551856041, "acc": 0.9789336919784546, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.4543072581291199, "acc": 0.8541000485420227, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.07584068179130554, "acc": 0.981519341468811, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.4739702641963959, "acc": 0.8384490609169006, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.06479093432426453, "acc": 0.9851064682006836, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.3555726706981659, "acc": 0.8715870976448059, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.058211442083120346, "acc": 0.9876176118850708, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.42139777541160583, "acc": 0.8584678173065186, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.05666158348321915, "acc": 0.9879950284957886, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.3798973262310028, "acc": 0.8688198924064636, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.05092456936836243, "acc": 0.9887284636497498, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.6443354487419128, "acc": 0.7959678173065186, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.04040640965104103, "acc": 0.9911655783653259, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.5847973227500916, "acc": 0.8129595518112183, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.038079049438238144, "acc": 0.9917253851890564, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.569000780582428, "acc": 0.8219530582427979, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.030679920688271523, "acc": 0.9928094744682312, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.7132379412651062, "acc": 0.7944393157958984, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.02179057151079178, "acc": 0.9951361417770386, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.6694848537445068, "acc": 0.8121224641799927, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.020223697647452354, "acc": 0.9956546425819397, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.8380688428878784, "acc": 0.7860414385795593, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.01807326450943947, "acc": 0.9962151646614075, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.6458706855773926, "acc": 0.8202545046806335, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.01731477864086628, "acc": 0.996504545211792, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.6539093255996704, "acc": 0.8179067373275757, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.016002178192138672, "acc": 0.9967182874679565, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.8076218962669373, "acc": 0.7835958003997803, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.01596008986234665, "acc": 0.9966776967048645, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.5873265862464905, "acc": 0.8217491507530212, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.014353479258716106, "acc": 0.9971767663955688, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.6280838847160339, "acc": 0.833359956741333, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.014011594466865063, "acc": 0.9972532987594604, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.7054772973060608, "acc": 0.8258771300315857, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.014849062077701092, "acc": 0.9968919157981873, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.8449819684028625, "acc": 0.8081583380699158, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.014086668379604816, "acc": 0.9971721768379211, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.6033340096473694, "acc": 0.8281430006027222, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.013746082782745361, "acc": 0.9972460269927979, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.5472902655601501, "acc": 0.8473324775695801, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.01243643555790186, "acc": 0.997532844543457, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 1.0699512958526611, "acc": 0.7782489061355591, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.014399214647710323, "acc": 0.9970816373825073, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.6232247352600098, "acc": 0.8351801633834839, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.012490258552134037, "acc": 0.9975894093513489, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.6742371916770935, "acc": 0.824716329574585, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.013037803582847118, "acc": 0.9974443316459656, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 1.1311540603637695, "acc": 0.7655290961265564, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.014044842682778835, "acc": 0.9970157742500305, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.6617434620857239, "acc": 0.8372781872749329, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.012270891107618809, "acc": 0.9975188970565796, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.7098603248596191, "acc": 0.8255136609077454, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.01199535746127367, "acc": 0.9977211356163025, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.6789461970329285, "acc": 0.8412044048309326, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.012589193880558014, "acc": 0.9973977208137512, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.6588109135627747, "acc": 0.8387386202812195, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.01269752997905016, "acc": 0.9974183440208435, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.5483390688896179, "acc": 0.8634451627731323, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.012568342499434948, "acc": 0.9974237084388733, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.8153300285339355, "acc": 0.8290360569953918, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.0132884681224823, "acc": 0.9973105788230896, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.8147111535072327, "acc": 0.7945591807365417, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.013874215073883533, "acc": 0.9971022009849548, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.6466043591499329, "acc": 0.8356097936630249, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.014175216667354107, "acc": 0.9970489740371704, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.5822404026985168, "acc": 0.847528338432312, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.011593306437134743, "acc": 0.9978243112564087, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.5583236813545227, "acc": 0.8547693490982056, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.01325119100511074, "acc": 0.9972420930862427, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.6847765445709229, "acc": 0.8243566751480103, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.01218679454177618, "acc": 0.9975634813308716, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.6559213399887085, "acc": 0.8296634554862976, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.01364288292825222, "acc": 0.99708491563797, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.6592429280281067, "acc": 0.8299533128738403, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.012523801065981388, "acc": 0.99749755859375, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.6465122699737549, "acc": 0.8302629590034485, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.014025290496647358, "acc": 0.9970855712890625, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.8129135370254517, "acc": 0.8197830319404602, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.014135269448161125, "acc": 0.9969525337219238, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.6048735976219177, "acc": 0.8416220545768738, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.012954320758581161, "acc": 0.9972966313362122, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.6662633419036865, "acc": 0.8335397839546204, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.013277514837682247, "acc": 0.9971308708190918, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.6164248585700989, "acc": 0.8435381054878235, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.013521946035325527, "acc": 0.9971461892127991, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.7347283959388733, "acc": 0.8241907358169556, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.01351423840969801, "acc": 0.9972213506698608, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.7538073062896729, "acc": 0.829162061214447, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.01323606725782156, "acc": 0.9971741437911987, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.719679057598114, "acc": 0.8284366726875305, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.014578240923583508, "acc": 0.9968247413635254, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.5032697916030884, "acc": 0.8672593832015991, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.014097421430051327, "acc": 0.9970717430114746, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.4949169158935547, "acc": 0.8467811346054077, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.013740370981395245, "acc": 0.9970263838768005, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.5843184590339661, "acc": 0.8473066687583923, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.015650790184736252, "acc": 0.9964666962623596, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.44688427448272705, "acc": 0.8698768615722656, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.013467498123645782, "acc": 0.9972113966941833, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.5650275945663452, "acc": 0.8421176075935364, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.015836190432310104, "acc": 0.9965013265609741, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.7529628872871399, "acc": 0.8349244594573975, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8200302124023438
