ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.7143688201904297, "acc": 0.5092427134513855, "length": 3.7272183895111084, "mode": "train", "epoch": 1}
{"loss": 0.6982902884483337, "acc": 0.49895837903022766, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6980635523796082, "acc": 0.5155377984046936, "length": 1.022111415863037, "mode": "train", "epoch": 2}
{"loss": 0.6966375112533569, "acc": 0.5298610925674438, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6739335060119629, "acc": 0.5834245085716248, "length": 1.6063700914382935, "mode": "train", "epoch": 3}
{"loss": 0.6109398603439331, "acc": 0.6817924976348877, "length": 1.5381944179534912, "mode": "test", "epoch": 3}
{"loss": 0.6005565524101257, "acc": 0.6890720129013062, "length": 1.8276077508926392, "mode": "train", "epoch": 4}
{"loss": 0.593949556350708, "acc": 0.6985487341880798, "length": 1.3524305820465088, "mode": "test", "epoch": 4}
{"loss": 0.5899519920349121, "acc": 0.6932855844497681, "length": 1.56881844997406, "mode": "train", "epoch": 5}
{"loss": 0.6113487482070923, "acc": 0.6820719242095947, "length": 1.3194444179534912, "mode": "test", "epoch": 5}
{"loss": 0.5858891606330872, "acc": 0.6955655813217163, "length": 1.5455716848373413, "mode": "train", "epoch": 6}
{"loss": 0.5737712383270264, "acc": 0.7171902060508728, "length": 1.3767361640930176, "mode": "test", "epoch": 6}
{"loss": 0.5572795271873474, "acc": 0.7198174595832825, "length": 1.6644283533096313, "mode": "train", "epoch": 7}
{"loss": 0.5286824703216553, "acc": 0.7398789525032043, "length": 1.6458333730697632, "mode": "test", "epoch": 7}
{"loss": 0.5124921202659607, "acc": 0.7409552931785583, "length": 1.6412522792816162, "mode": "train", "epoch": 8}
{"loss": 0.530890703201294, "acc": 0.7286567091941833, "length": 1.453125, "mode": "test", "epoch": 8}
{"loss": 0.48438742756843567, "acc": 0.7705504894256592, "length": 1.788814663887024, "mode": "train", "epoch": 9}
{"loss": 0.503211498260498, "acc": 0.7743191719055176, "length": 1.71875, "mode": "test", "epoch": 9}
{"loss": 0.43632322549819946, "acc": 0.8103024363517761, "length": 2.2735161781311035, "mode": "train", "epoch": 10}
{"loss": 0.4200316071510315, "acc": 0.8184706568717957, "length": 2.347222328186035, "mode": "test", "epoch": 10}
{"loss": 0.38606640696525574, "acc": 0.8395900130271912, "length": 2.7075676918029785, "mode": "train", "epoch": 11}
{"loss": 0.3880859613418579, "acc": 0.8374132513999939, "length": 2.5104167461395264, "mode": "test", "epoch": 11}
{"loss": 0.34956008195877075, "acc": 0.8553490042686462, "length": 2.82373046875, "mode": "train", "epoch": 12}
{"loss": 0.37106019258499146, "acc": 0.8506186008453369, "length": 2.359375, "mode": "test", "epoch": 12}
{"loss": 0.3213808238506317, "acc": 0.8712130188941956, "length": 2.914586305618286, "mode": "train", "epoch": 13}
{"loss": 0.33689388632774353, "acc": 0.8607286214828491, "length": 2.5833332538604736, "mode": "test", "epoch": 13}
{"loss": 0.29713448882102966, "acc": 0.8832185864448547, "length": 2.9165427684783936, "mode": "train", "epoch": 14}
{"loss": 0.3185012638568878, "acc": 0.8729328513145447, "length": 2.71875, "mode": "test", "epoch": 14}
{"loss": 0.2765830159187317, "acc": 0.8930625319480896, "length": 3.0161547660827637, "mode": "train", "epoch": 15}
{"loss": 0.3262685239315033, "acc": 0.8689128160476685, "length": 2.737847328186035, "mode": "test", "epoch": 15}
{"loss": 0.2603484094142914, "acc": 0.9014713764190674, "length": 3.1013638973236084, "mode": "train", "epoch": 16}
{"loss": 0.3264616131782532, "acc": 0.8651340007781982, "length": 2.9392361640930176, "mode": "test", "epoch": 16}
{"loss": 0.2484755665063858, "acc": 0.9067832827568054, "length": 3.1114182472229004, "mode": "train", "epoch": 17}
{"loss": 0.2809372544288635, "acc": 0.8980388641357422, "length": 2.902777671813965, "mode": "test", "epoch": 17}
{"loss": 0.23671188950538635, "acc": 0.9150375723838806, "length": 3.283853530883789, "mode": "train", "epoch": 18}
{"loss": 0.2677518129348755, "acc": 0.8990694880485535, "length": 2.9392361640930176, "mode": "test", "epoch": 18}
{"loss": 0.22339005768299103, "acc": 0.9208762049674988, "length": 3.3589932918548584, "mode": "train", "epoch": 19}
{"loss": 0.27366194128990173, "acc": 0.903510332107544, "length": 3.086805582046509, "mode": "test", "epoch": 19}
{"loss": 0.2104921042919159, "acc": 0.9284266233444214, "length": 3.5063607692718506, "mode": "train", "epoch": 20}
{"loss": 0.26658761501312256, "acc": 0.8996283411979675, "length": 3.289930582046509, "mode": "test", "epoch": 20}
{"loss": 0.20278547704219818, "acc": 0.9324591159820557, "length": 3.5774965286254883, "mode": "train", "epoch": 21}
{"loss": 0.23175419867038727, "acc": 0.9174045920372009, "length": 3.309027671813965, "mode": "test", "epoch": 21}
{"loss": 0.1938554346561432, "acc": 0.9360588192939758, "length": 3.59335994720459, "mode": "train", "epoch": 22}
{"loss": 0.24615247547626495, "acc": 0.9117351174354553, "length": 3.383680582046509, "mode": "test", "epoch": 22}
{"loss": 0.18149544298648834, "acc": 0.9423134326934814, "length": 3.666947364807129, "mode": "train", "epoch": 23}
{"loss": 0.23071593046188354, "acc": 0.917515754699707, "length": 3.4548611640930176, "mode": "test", "epoch": 23}
{"loss": 0.17346258461475372, "acc": 0.9455152153968811, "length": 3.764479875564575, "mode": "train", "epoch": 24}
{"loss": 0.22297266125679016, "acc": 0.9217041730880737, "length": 3.690972328186035, "mode": "test", "epoch": 24}
{"loss": 0.1671086549758911, "acc": 0.9479417204856873, "length": 3.8342931270599365, "mode": "train", "epoch": 25}
{"loss": 0.2372354120016098, "acc": 0.9116021394729614, "length": 3.574652671813965, "mode": "test", "epoch": 25}
{"loss": 0.16308943927288055, "acc": 0.9512935280799866, "length": 3.8745925426483154, "mode": "train", "epoch": 26}
{"loss": 0.20589032769203186, "acc": 0.9301893711090088, "length": 3.715277671813965, "mode": "test", "epoch": 26}
{"loss": 0.15229497849941254, "acc": 0.9552028775215149, "length": 3.838865280151367, "mode": "train", "epoch": 27}
{"loss": 0.20922820270061493, "acc": 0.9243435263633728, "length": 3.633680582046509, "mode": "test", "epoch": 27}
{"loss": 0.14647100865840912, "acc": 0.9581885933876038, "length": 4.073651313781738, "mode": "train", "epoch": 28}
{"loss": 0.1900595873594284, "acc": 0.9372748136520386, "length": 3.836805582046509, "mode": "test", "epoch": 28}
{"loss": 0.13823631405830383, "acc": 0.9617693424224854, "length": 4.045866012573242, "mode": "train", "epoch": 29}
{"loss": 0.19007925689220428, "acc": 0.9403402805328369, "length": 4.190972328186035, "mode": "test", "epoch": 29}
{"loss": 0.13659599423408508, "acc": 0.9618489146232605, "length": 4.085695743560791, "mode": "train", "epoch": 30}
{"loss": 0.1718243956565857, "acc": 0.947789192199707, "length": 3.8645832538604736, "mode": "test", "epoch": 30}
{"loss": 0.12704496085643768, "acc": 0.9660906195640564, "length": 4.120786190032959, "mode": "train", "epoch": 31}
{"loss": 0.19069677591323853, "acc": 0.9378445744514465, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.12425310164690018, "acc": 0.9672868847846985, "length": 4.099544048309326, "mode": "train", "epoch": 32}
{"loss": 0.17435838282108307, "acc": 0.9449979066848755, "length": 4.02256965637207, "mode": "test", "epoch": 32}
{"loss": 0.11474808305501938, "acc": 0.9708260893821716, "length": 4.150824546813965, "mode": "train", "epoch": 33}
{"loss": 0.16847144067287445, "acc": 0.9493679404258728, "length": 4.185763835906982, "mode": "test", "epoch": 33}
{"loss": 0.11459346860647202, "acc": 0.9709107875823975, "length": 4.115924835205078, "mode": "train", "epoch": 34}
{"loss": 0.15190769731998444, "acc": 0.9540717601776123, "length": 4.125, "mode": "test", "epoch": 34}
{"loss": 0.10958623141050339, "acc": 0.9723202586174011, "length": 4.1669111251831055, "mode": "train", "epoch": 35}
{"loss": 0.1530393362045288, "acc": 0.9513264894485474, "length": 3.984375, "mode": "test", "epoch": 35}
{"loss": 0.10666579753160477, "acc": 0.9735708832740784, "length": 4.134965419769287, "mode": "train", "epoch": 36}
{"loss": 0.14866140484809875, "acc": 0.956263542175293, "length": 4.260416507720947, "mode": "test", "epoch": 36}
{"loss": 0.10186173021793365, "acc": 0.9763200283050537, "length": 4.1700897216796875, "mode": "train", "epoch": 37}
{"loss": 0.14277702569961548, "acc": 0.9653239846229553, "length": 3.8802082538604736, "mode": "test", "epoch": 37}
{"loss": 0.10132879763841629, "acc": 0.9742382764816284, "length": 4.078682899475098, "mode": "train", "epoch": 38}
{"loss": 0.14592400193214417, "acc": 0.9588704705238342, "length": 4.072916507720947, "mode": "test", "epoch": 38}
{"loss": 0.09430944919586182, "acc": 0.9782683253288269, "length": 4.206636905670166, "mode": "train", "epoch": 39}
{"loss": 0.14292550086975098, "acc": 0.961322546005249, "length": 4.032986164093018, "mode": "test", "epoch": 39}
{"loss": 0.08569557964801788, "acc": 0.9820160865783691, "length": 4.172544956207275, "mode": "train", "epoch": 40}
{"loss": 0.1283753365278244, "acc": 0.9662272334098816, "length": 4.026041507720947, "mode": "test", "epoch": 40}
{"loss": 0.08565934002399445, "acc": 0.9809011816978455, "length": 4.189117908477783, "mode": "train", "epoch": 41}
{"loss": 0.1150989681482315, "acc": 0.9703369140625, "length": 4.09375, "mode": "test", "epoch": 41}
{"loss": 0.0847611203789711, "acc": 0.9807804822921753, "length": 4.149538993835449, "mode": "train", "epoch": 42}
{"loss": 0.10870715230703354, "acc": 0.9740668535232544, "length": 4.177083492279053, "mode": "test", "epoch": 42}
{"loss": 0.0786418691277504, "acc": 0.9826737642288208, "length": 4.217081546783447, "mode": "train", "epoch": 43}
{"loss": 0.11160070449113846, "acc": 0.9718559980392456, "length": 4.10069465637207, "mode": "test", "epoch": 43}
{"loss": 0.07910513132810593, "acc": 0.9822540879249573, "length": 4.11121940612793, "mode": "train", "epoch": 44}
{"loss": 0.10741541534662247, "acc": 0.9766329526901245, "length": 4.097222328186035, "mode": "test", "epoch": 44}
{"loss": 0.07306228578090668, "acc": 0.985019862651825, "length": 4.184935569763184, "mode": "train", "epoch": 45}
{"loss": 0.12262434512376785, "acc": 0.9614800214767456, "length": 4.064236164093018, "mode": "test", "epoch": 45}
{"loss": 0.07352232933044434, "acc": 0.9848660826683044, "length": 4.19298791885376, "mode": "train", "epoch": 46}
{"loss": 0.11245445162057877, "acc": 0.9635688066482544, "length": 4.08506965637207, "mode": "test", "epoch": 46}
{"loss": 0.0770389512181282, "acc": 0.9837630987167358, "length": 4.270899772644043, "mode": "train", "epoch": 47}
{"loss": 0.09695969521999359, "acc": 0.9732040762901306, "length": 4.13194465637207, "mode": "test", "epoch": 47}
{"loss": 0.07011104375123978, "acc": 0.9851548671722412, "length": 4.243244171142578, "mode": "train", "epoch": 48}
{"loss": 0.0830971747636795, "acc": 0.9807562232017517, "length": 4.128472328186035, "mode": "test", "epoch": 48}
{"loss": 0.07410915940999985, "acc": 0.982923686504364, "length": 4.1877899169921875, "mode": "train", "epoch": 49}
{"loss": 0.09594473242759705, "acc": 0.9756782054901123, "length": 4.10069465637207, "mode": "test", "epoch": 49}
{"loss": 0.06445826590061188, "acc": 0.9879789352416992, "length": 4.225432395935059, "mode": "train", "epoch": 50}
{"loss": 0.09736620634794235, "acc": 0.9724446535110474, "length": 4.08680534362793, "mode": "test", "epoch": 50}
{"loss": 0.060088880360126495, "acc": 0.9890135526657104, "length": 4.283294200897217, "mode": "train", "epoch": 51}
{"loss": 0.08022159337997437, "acc": 0.98046875, "length": 4.151041507720947, "mode": "test", "epoch": 51}
{"loss": 0.05872500687837601, "acc": 0.9895559549331665, "length": 4.370898246765137, "mode": "train", "epoch": 52}
{"loss": 0.08849010616540909, "acc": 0.9776204228401184, "length": 4.22743034362793, "mode": "test", "epoch": 52}
{"loss": 0.05212170630693436, "acc": 0.9921444058418274, "length": 4.236408710479736, "mode": "train", "epoch": 53}
{"loss": 0.08432305604219437, "acc": 0.9769179224967957, "length": 4.081597328186035, "mode": "test", "epoch": 53}
{"loss": 0.054634325206279755, "acc": 0.9907437562942505, "length": 4.242833614349365, "mode": "train", "epoch": 54}
{"loss": 0.09003755450248718, "acc": 0.9790961742401123, "length": 4.107638835906982, "mode": "test", "epoch": 54}
{"loss": 0.058213770389556885, "acc": 0.9893621802330017, "length": 4.270799160003662, "mode": "train", "epoch": 55}
{"loss": 0.07928451150655746, "acc": 0.9815104007720947, "length": 4.09375, "mode": "test", "epoch": 55}
{"loss": 0.05421194061636925, "acc": 0.9906736016273499, "length": 4.193681716918945, "mode": "train", "epoch": 56}
{"loss": 0.08704853057861328, "acc": 0.9708523154258728, "length": 4.201388835906982, "mode": "test", "epoch": 56}
{"loss": 0.05004214122891426, "acc": 0.9924092888832092, "length": 4.198081970214844, "mode": "train", "epoch": 57}
{"loss": 0.07051527500152588, "acc": 0.9841634035110474, "length": 4.204861164093018, "mode": "test", "epoch": 57}
{"loss": 0.04517059773206711, "acc": 0.9943041205406189, "length": 4.192603588104248, "mode": "train", "epoch": 58}
{"loss": 0.07705119252204895, "acc": 0.9818115234375, "length": 4.182291507720947, "mode": "test", "epoch": 58}
{"loss": 0.04737687483429909, "acc": 0.9936210513114929, "length": 4.229618549346924, "mode": "train", "epoch": 59}
{"loss": 0.07308582961559296, "acc": 0.9816703796386719, "length": 4.152777671813965, "mode": "test", "epoch": 59}
{"loss": 0.04550028219819069, "acc": 0.9937415719032288, "length": 4.116154193878174, "mode": "train", "epoch": 60}
{"loss": 0.07229141891002655, "acc": 0.9829047322273254, "length": 4.184027671813965, "mode": "test", "epoch": 60}
test accuracy: 0.778626561164856
