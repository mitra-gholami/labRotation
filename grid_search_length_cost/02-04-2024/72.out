ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.3318208158016205, "acc": 0.8593759536743164, "length": 10.200035095214844, "mode": "train", "epoch": 1}
{"loss": 0.38066303730010986, "acc": 0.8394426107406616, "length": 11.0, "mode": "test", "epoch": 1}
{"loss": 0.22073444724082947, "acc": 0.9300000667572021, "length": 10.999165534973145, "mode": "train", "epoch": 2}
{"loss": 0.3492930233478546, "acc": 0.8684459328651428, "length": 11.0, "mode": "test", "epoch": 2}
{"loss": 0.1753583401441574, "acc": 0.9482179284095764, "length": 10.999639511108398, "mode": "train", "epoch": 3}
{"loss": 0.24857045710086823, "acc": 0.9156329035758972, "length": 11.0, "mode": "test", "epoch": 3}
{"loss": 0.1534520983695984, "acc": 0.9588108062744141, "length": 10.999934196472168, "mode": "train", "epoch": 4}
{"loss": 0.22833701968193054, "acc": 0.9244939088821411, "length": 11.0, "mode": "test", "epoch": 4}
{"loss": 0.14398802816867828, "acc": 0.9595112800598145, "length": 10.999978065490723, "mode": "train", "epoch": 5}
{"loss": 0.1912725418806076, "acc": 0.9379181861877441, "length": 11.0, "mode": "test", "epoch": 5}
{"loss": 0.11386732012033463, "acc": 0.9695380926132202, "length": 10.999995231628418, "mode": "train", "epoch": 6}
{"loss": 0.14792339503765106, "acc": 0.9557596445083618, "length": 11.0, "mode": "test", "epoch": 6}
{"loss": 0.08899185806512833, "acc": 0.9792676568031311, "length": 11.0, "mode": "train", "epoch": 7}
{"loss": 0.15169282257556915, "acc": 0.9544413685798645, "length": 11.0, "mode": "test", "epoch": 7}
{"loss": 0.07773691415786743, "acc": 0.981650173664093, "length": 11.0, "mode": "train", "epoch": 8}
{"loss": 0.11891885846853256, "acc": 0.9644486904144287, "length": 11.0, "mode": "test", "epoch": 8}
{"loss": 0.046418447047472, "acc": 0.9888756275177002, "length": 11.0, "mode": "train", "epoch": 9}
{"loss": 0.08653464168310165, "acc": 0.9760742783546448, "length": 11.0, "mode": "test", "epoch": 9}
{"loss": 0.027143940329551697, "acc": 0.9953523278236389, "length": 11.0, "mode": "train", "epoch": 10}
{"loss": 0.059807103127241135, "acc": 0.984360933303833, "length": 11.0, "mode": "test", "epoch": 10}
{"loss": 0.021790068596601486, "acc": 0.9966105222702026, "length": 11.0, "mode": "train", "epoch": 11}
{"loss": 0.04474271088838577, "acc": 0.9900567531585693, "length": 11.0, "mode": "test", "epoch": 11}
{"loss": 0.01932227984070778, "acc": 0.9971567988395691, "length": 11.0, "mode": "train", "epoch": 12}
{"loss": 0.04568770155310631, "acc": 0.9892724752426147, "length": 11.0, "mode": "test", "epoch": 12}
{"loss": 0.015984805300831795, "acc": 0.9980115294456482, "length": 11.0, "mode": "train", "epoch": 13}
{"loss": 0.05390871688723564, "acc": 0.9857054352760315, "length": 11.0, "mode": "test", "epoch": 13}
{"loss": 0.01535453088581562, "acc": 0.99802166223526, "length": 11.0, "mode": "train", "epoch": 14}
{"loss": 0.06047331541776657, "acc": 0.9832746386528015, "length": 11.0, "mode": "test", "epoch": 14}
{"loss": 0.01504356786608696, "acc": 0.998075008392334, "length": 11.0, "mode": "train", "epoch": 15}
{"loss": 0.06270775198936462, "acc": 0.9839609861373901, "length": 11.0, "mode": "test", "epoch": 15}
{"loss": 0.013810358010232449, "acc": 0.9982477426528931, "length": 11.0, "mode": "train", "epoch": 16}
{"loss": 0.037106193602085114, "acc": 0.99101322889328, "length": 11.0, "mode": "test", "epoch": 16}
{"loss": 0.01364170853048563, "acc": 0.9983657002449036, "length": 11.0, "mode": "train", "epoch": 17}
{"loss": 0.05726141482591629, "acc": 0.9832385182380676, "length": 11.0, "mode": "test", "epoch": 17}
{"loss": 0.01164673175662756, "acc": 0.9988337159156799, "length": 11.0, "mode": "train", "epoch": 18}
{"loss": 0.033719293773174286, "acc": 0.9926576614379883, "length": 11.0, "mode": "test", "epoch": 18}
{"loss": 0.021162310615181923, "acc": 0.996004581451416, "length": 11.0, "mode": "train", "epoch": 19}
{"loss": 0.1472669094800949, "acc": 0.941111147403717, "length": 11.0, "mode": "test", "epoch": 19}
{"loss": 0.06471982598304749, "acc": 0.9775946140289307, "length": 11.0, "mode": "train", "epoch": 20}
{"loss": 0.03580833226442337, "acc": 0.9918173551559448, "length": 11.0, "mode": "test", "epoch": 20}
{"loss": 0.01683097705245018, "acc": 0.9970013499259949, "length": 11.0, "mode": "train", "epoch": 21}
{"loss": 0.04045632854104042, "acc": 0.9899387359619141, "length": 11.0, "mode": "test", "epoch": 21}
{"loss": 0.015974463894963264, "acc": 0.9972700476646423, "length": 11.0, "mode": "train", "epoch": 22}
{"loss": 0.021780170500278473, "acc": 0.9957547187805176, "length": 11.0, "mode": "test", "epoch": 22}
{"loss": 0.010809386149048805, "acc": 0.9990638494491577, "length": 11.0, "mode": "train", "epoch": 23}
{"loss": 0.019351927563548088, "acc": 0.9967508912086487, "length": 11.0, "mode": "test", "epoch": 23}
{"loss": 0.011445265263319016, "acc": 0.9989150762557983, "length": 11.0, "mode": "train", "epoch": 24}
{"loss": 0.029134277254343033, "acc": 0.9939200282096863, "length": 11.0, "mode": "test", "epoch": 24}
{"loss": 0.012129969894886017, "acc": 0.9986864924430847, "length": 11.0, "mode": "train", "epoch": 25}
{"loss": 0.019179005175828934, "acc": 0.9966769814491272, "length": 11.0, "mode": "test", "epoch": 25}
{"loss": 0.012232408858835697, "acc": 0.9985863566398621, "length": 11.0, "mode": "train", "epoch": 26}
{"loss": 0.040301933884620667, "acc": 0.9935398697853088, "length": 11.0, "mode": "test", "epoch": 26}
{"loss": 0.017040975391864777, "acc": 0.9973300695419312, "length": 11.0, "mode": "train", "epoch": 27}
{"loss": 0.022052567452192307, "acc": 0.9958286881446838, "length": 11.0, "mode": "test", "epoch": 27}
{"loss": 0.01230516005307436, "acc": 0.9984875917434692, "length": 11.0, "mode": "train", "epoch": 28}
{"loss": 0.016478270292282104, "acc": 0.9976773262023926, "length": 11.0, "mode": "test", "epoch": 28}
{"loss": 0.010808960534632206, "acc": 0.998976469039917, "length": 11.0, "mode": "train", "epoch": 29}
{"loss": 0.033419396728277206, "acc": 0.9929038286209106, "length": 11.0, "mode": "test", "epoch": 29}
{"loss": 0.011110327206552029, "acc": 0.9988897442817688, "length": 11.0, "mode": "train", "epoch": 30}
{"loss": 0.027229389175772667, "acc": 0.9955404996871948, "length": 11.0, "mode": "test", "epoch": 30}
{"loss": 0.01046268455684185, "acc": 0.9990224838256836, "length": 11.0, "mode": "train", "epoch": 31}
{"loss": 0.016266824677586555, "acc": 0.9977092742919922, "length": 11.0, "mode": "test", "epoch": 31}
{"loss": 0.012107807211577892, "acc": 0.9985775947570801, "length": 11.0, "mode": "train", "epoch": 32}
{"loss": 0.021901920437812805, "acc": 0.9967129826545715, "length": 11.0, "mode": "test", "epoch": 32}
{"loss": 0.010270725935697556, "acc": 0.9990304112434387, "length": 11.0, "mode": "train", "epoch": 33}
{"loss": 0.0238803680986166, "acc": 0.9949724674224854, "length": 11.0, "mode": "test", "epoch": 33}
{"loss": 0.010494222864508629, "acc": 0.999011218547821, "length": 11.0, "mode": "train", "epoch": 34}
{"loss": 0.012933118268847466, "acc": 0.9986536502838135, "length": 11.0, "mode": "test", "epoch": 34}
{"loss": 0.011932644061744213, "acc": 0.9985796809196472, "length": 11.0, "mode": "train", "epoch": 35}
{"loss": 0.020221251994371414, "acc": 0.9970110058784485, "length": 11.0, "mode": "test", "epoch": 35}
{"loss": 0.01048066932708025, "acc": 0.9990285634994507, "length": 11.0, "mode": "train", "epoch": 36}
{"loss": 0.01943032443523407, "acc": 0.9969710111618042, "length": 11.0, "mode": "test", "epoch": 36}
{"loss": 0.014795963652431965, "acc": 0.997762143611908, "length": 11.0, "mode": "train", "epoch": 37}
{"loss": 0.021963447332382202, "acc": 0.9955605268478394, "length": 11.0, "mode": "test", "epoch": 37}
{"loss": 0.021191971376538277, "acc": 0.9958203434944153, "length": 11.0, "mode": "train", "epoch": 38}
{"loss": 0.0241455789655447, "acc": 0.9945502281188965, "length": 11.0, "mode": "test", "epoch": 38}
{"loss": 0.010942339897155762, "acc": 0.9988424777984619, "length": 11.0, "mode": "train", "epoch": 39}
{"loss": 0.015373132191598415, "acc": 0.9982274770736694, "length": 11.0, "mode": "test", "epoch": 39}
{"loss": 0.01064631249755621, "acc": 0.9988817572593689, "length": 11.0, "mode": "train", "epoch": 40}
{"loss": 0.01783188246190548, "acc": 0.9973791837692261, "length": 11.0, "mode": "test", "epoch": 40}
{"loss": 0.012282224372029305, "acc": 0.9985183477401733, "length": 11.0, "mode": "train", "epoch": 41}
{"loss": 0.04169454798102379, "acc": 0.9899587631225586, "length": 11.0, "mode": "test", "epoch": 41}
{"loss": 0.013149634934961796, "acc": 0.9983290433883667, "length": 11.0, "mode": "train", "epoch": 42}
{"loss": 0.01853938400745392, "acc": 0.9975292086601257, "length": 11.0, "mode": "test", "epoch": 42}
{"loss": 0.011050044558942318, "acc": 0.9988377690315247, "length": 11.0, "mode": "train", "epoch": 43}
{"loss": 0.01592225953936577, "acc": 0.9979473948478699, "length": 11.0, "mode": "test", "epoch": 43}
{"loss": 0.011158180423080921, "acc": 0.9988176822662354, "length": 11.0, "mode": "train", "epoch": 44}
{"loss": 0.03415821120142937, "acc": 0.9923394918441772, "length": 11.0, "mode": "test", "epoch": 44}
{"loss": 0.012221286073327065, "acc": 0.9986204504966736, "length": 11.0, "mode": "train", "epoch": 45}
{"loss": 0.017875738441944122, "acc": 0.9972131848335266, "length": 11.0, "mode": "test", "epoch": 45}
{"loss": 0.012695045210421085, "acc": 0.9983828663825989, "length": 11.0, "mode": "train", "epoch": 46}
{"loss": 0.016865458339452744, "acc": 0.9973210692405701, "length": 11.0, "mode": "test", "epoch": 46}
{"loss": 0.00947978999465704, "acc": 0.9992638826370239, "length": 11.0, "mode": "train", "epoch": 47}
{"loss": 0.015443302690982819, "acc": 0.9981813430786133, "length": 11.0, "mode": "test", "epoch": 47}
{"loss": 0.009989753365516663, "acc": 0.9991158246994019, "length": 11.0, "mode": "train", "epoch": 48}
{"loss": 0.030709363520145416, "acc": 0.9941200613975525, "length": 11.0, "mode": "test", "epoch": 48}
{"loss": 0.10732696205377579, "acc": 0.9634242653846741, "length": 11.0, "mode": "train", "epoch": 49}
{"loss": 0.10564202815294266, "acc": 0.9647746682167053, "length": 11.0, "mode": "test", "epoch": 49}
{"loss": 0.09185392409563065, "acc": 0.9689532518386841, "length": 11.0, "mode": "train", "epoch": 50}
{"loss": 0.10128822177648544, "acc": 0.9669833183288574, "length": 11.0, "mode": "test", "epoch": 50}
{"loss": 0.05765526369214058, "acc": 0.9830909967422485, "length": 11.0, "mode": "train", "epoch": 51}
{"loss": 0.03776158392429352, "acc": 0.9907789826393127, "length": 11.0, "mode": "test", "epoch": 51}
{"loss": 0.041680965572595596, "acc": 0.9882314205169678, "length": 11.0, "mode": "train", "epoch": 52}
{"loss": 0.039396822452545166, "acc": 0.9897607564926147, "length": 11.0, "mode": "test", "epoch": 52}
{"loss": 0.04388568177819252, "acc": 0.9876320362091064, "length": 11.0, "mode": "train", "epoch": 53}
{"loss": 0.03798729553818703, "acc": 0.9908431768417358, "length": 11.0, "mode": "test", "epoch": 53}
{"loss": 0.02240508422255516, "acc": 0.9953137040138245, "length": 11.0, "mode": "train", "epoch": 54}
{"loss": 0.030810663476586342, "acc": 0.9928096532821655, "length": 11.0, "mode": "test", "epoch": 54}
{"loss": 0.017336567863821983, "acc": 0.9970300197601318, "length": 11.0, "mode": "train", "epoch": 55}
{"loss": 0.02135741524398327, "acc": 0.9963569045066833, "length": 11.0, "mode": "test", "epoch": 55}
{"loss": 0.015202515758574009, "acc": 0.9975968599319458, "length": 11.0, "mode": "train", "epoch": 56}
{"loss": 0.027661774307489395, "acc": 0.9943481683731079, "length": 11.0, "mode": "test", "epoch": 56}
{"loss": 0.01794293150305748, "acc": 0.99686598777771, "length": 11.0, "mode": "train", "epoch": 57}
{"loss": 0.021230554208159447, "acc": 0.9962968826293945, "length": 11.0, "mode": "test", "epoch": 57}
{"loss": 0.012949572876095772, "acc": 0.998324453830719, "length": 11.0, "mode": "train", "epoch": 58}
{"loss": 0.016844164580106735, "acc": 0.9975372552871704, "length": 11.0, "mode": "test", "epoch": 58}
{"loss": 0.047483235597610474, "acc": 0.9875847697257996, "length": 11.0, "mode": "train", "epoch": 59}
{"loss": 0.03828105702996254, "acc": 0.9915953278541565, "length": 11.0, "mode": "test", "epoch": 59}
{"loss": 0.029690194875001907, "acc": 0.9932565689086914, "length": 11.0, "mode": "train", "epoch": 60}
{"loss": 0.03222058340907097, "acc": 0.9927176833152771, "length": 11.0, "mode": "test", "epoch": 60}
test accuracy: 0.9906635880470276
