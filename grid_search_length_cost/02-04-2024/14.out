ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.6904868483543396, "acc": 0.5363216400146484, "length": 4.295304298400879, "mode": "train", "epoch": 1}
{"loss": 0.6610152125358582, "acc": 0.5965847373008728, "length": 2.0173611640930176, "mode": "test", "epoch": 1}
{"loss": 0.6061477065086365, "acc": 0.672705352306366, "length": 3.5146567821502686, "mode": "train", "epoch": 2}
{"loss": 0.6428229808807373, "acc": 0.6332953572273254, "length": 1.6840277910232544, "mode": "test", "epoch": 2}
{"loss": 0.5563152432441711, "acc": 0.7199126482009888, "length": 3.594712018966675, "mode": "train", "epoch": 3}
{"loss": 0.6711663603782654, "acc": 0.6859619617462158, "length": 6.387152671813965, "mode": "test", "epoch": 3}
{"loss": 0.4591168761253357, "acc": 0.800263524055481, "length": 6.2732319831848145, "mode": "train", "epoch": 4}
{"loss": 0.5322688817977905, "acc": 0.7698079943656921, "length": 16.15625, "mode": "test", "epoch": 4}
{"loss": 0.3842369616031647, "acc": 0.8409630060195923, "length": 7.303847789764404, "mode": "train", "epoch": 5}
{"loss": 0.4960404634475708, "acc": 0.7966145277023315, "length": 15.51388931274414, "mode": "test", "epoch": 5}
{"loss": 0.3393559455871582, "acc": 0.8629921078681946, "length": 8.349400520324707, "mode": "train", "epoch": 6}
{"loss": 0.42846089601516724, "acc": 0.8282742500305176, "length": 14.53993034362793, "mode": "test", "epoch": 6}
{"loss": 0.28736087679862976, "acc": 0.8889344334602356, "length": 10.559488296508789, "mode": "train", "epoch": 7}
{"loss": 0.39205920696258545, "acc": 0.8416233062744141, "length": 13.786458015441895, "mode": "test", "epoch": 7}
{"loss": 0.26312708854675293, "acc": 0.9008435606956482, "length": 10.783205032348633, "mode": "train", "epoch": 8}
{"loss": 0.42916592955589294, "acc": 0.8266412019729614, "length": 15.472222328186035, "mode": "test", "epoch": 8}
{"loss": 0.23694069683551788, "acc": 0.9143394827842712, "length": 11.721986770629883, "mode": "train", "epoch": 9}
{"loss": 0.5153326392173767, "acc": 0.7940022945404053, "length": 13.394097328186035, "mode": "test", "epoch": 9}
{"loss": 0.2211254984140396, "acc": 0.9219834208488464, "length": 10.937664985656738, "mode": "train", "epoch": 10}
{"loss": 0.4253402650356293, "acc": 0.8385335803031921, "length": 12.515625, "mode": "test", "epoch": 10}
{"loss": 0.2023516744375229, "acc": 0.9295045733451843, "length": 12.621392250061035, "mode": "train", "epoch": 11}
{"loss": 0.37534427642822266, "acc": 0.8475803136825562, "length": 13.74826431274414, "mode": "test", "epoch": 11}
{"loss": 0.18988385796546936, "acc": 0.9348973035812378, "length": 12.199363708496094, "mode": "train", "epoch": 12}
{"loss": 0.3913057744503021, "acc": 0.8394531011581421, "length": 13.590277671813965, "mode": "test", "epoch": 12}
{"loss": 0.17496179044246674, "acc": 0.9413987398147583, "length": 12.965819358825684, "mode": "train", "epoch": 13}
{"loss": 0.37166112661361694, "acc": 0.847764790058136, "length": 13.09201431274414, "mode": "test", "epoch": 13}
{"loss": 0.1662290096282959, "acc": 0.9447863101959229, "length": 12.96605110168457, "mode": "train", "epoch": 14}
{"loss": 0.4026624262332916, "acc": 0.8431315422058105, "length": 13.81076431274414, "mode": "test", "epoch": 14}
{"loss": 0.16177555918693542, "acc": 0.9458981156349182, "length": 13.077088356018066, "mode": "train", "epoch": 15}
{"loss": 0.35181719064712524, "acc": 0.8595893383026123, "length": 11.621527671813965, "mode": "test", "epoch": 15}
{"loss": 0.1615787297487259, "acc": 0.9468681812286377, "length": 13.26878833770752, "mode": "train", "epoch": 16}
{"loss": 0.36238110065460205, "acc": 0.8609673380851746, "length": 13.546875, "mode": "test", "epoch": 16}
{"loss": 0.14347322285175323, "acc": 0.9540790915489197, "length": 13.348053932189941, "mode": "train", "epoch": 17}
{"loss": 0.30546507239341736, "acc": 0.8804904818534851, "length": 12.46006965637207, "mode": "test", "epoch": 17}
{"loss": 0.1308092623949051, "acc": 0.9600845575332642, "length": 13.808199882507324, "mode": "train", "epoch": 18}
{"loss": 0.26973867416381836, "acc": 0.8956624269485474, "length": 12.965277671813965, "mode": "test", "epoch": 18}
{"loss": 0.11989443749189377, "acc": 0.9643513560295105, "length": 14.747505187988281, "mode": "train", "epoch": 19}
{"loss": 0.2953568994998932, "acc": 0.8880017995834351, "length": 11.48611068725586, "mode": "test", "epoch": 19}
{"loss": 0.11846455931663513, "acc": 0.9643893837928772, "length": 14.30678939819336, "mode": "train", "epoch": 20}
{"loss": 0.3082053065299988, "acc": 0.8878933787345886, "length": 11.58506965637207, "mode": "test", "epoch": 20}
{"loss": 0.11581359058618546, "acc": 0.9638583660125732, "length": 14.05997085571289, "mode": "train", "epoch": 21}
{"loss": 0.3344498574733734, "acc": 0.8847682476043701, "length": 12.79513931274414, "mode": "test", "epoch": 21}
{"loss": 0.1029592752456665, "acc": 0.9700402021408081, "length": 14.147903442382812, "mode": "train", "epoch": 22}
{"loss": 0.25979965925216675, "acc": 0.9053520560264587, "length": 15.17881965637207, "mode": "test", "epoch": 22}
{"loss": 0.08887922018766403, "acc": 0.9762417674064636, "length": 14.623932838439941, "mode": "train", "epoch": 23}
{"loss": 0.2640620470046997, "acc": 0.905604362487793, "length": 14.690972328186035, "mode": "test", "epoch": 23}
{"loss": 0.10406048595905304, "acc": 0.9692845344543457, "length": 14.900202751159668, "mode": "train", "epoch": 24}
{"loss": 0.2371850311756134, "acc": 0.9061387181282043, "length": 13.144097328186035, "mode": "test", "epoch": 24}
{"loss": 0.08585965633392334, "acc": 0.9759766459465027, "length": 14.243720054626465, "mode": "train", "epoch": 25}
{"loss": 0.22506536543369293, "acc": 0.9212672710418701, "length": 13.57118034362793, "mode": "test", "epoch": 25}
{"loss": 0.08266109973192215, "acc": 0.9776252508163452, "length": 15.023653984069824, "mode": "train", "epoch": 26}
{"loss": 0.24329236149787903, "acc": 0.9089275002479553, "length": 12.78298568725586, "mode": "test", "epoch": 26}
{"loss": 0.07141131162643433, "acc": 0.9822204113006592, "length": 13.592509269714355, "mode": "train", "epoch": 27}
{"loss": 0.1951659619808197, "acc": 0.9296902418136597, "length": 13.76736068725586, "mode": "test", "epoch": 27}
{"loss": 0.06272627413272858, "acc": 0.9854894876480103, "length": 14.444390296936035, "mode": "train", "epoch": 28}
{"loss": 0.21988888084888458, "acc": 0.9212375283241272, "length": 12.940972328186035, "mode": "test", "epoch": 28}
{"loss": 0.061126627027988434, "acc": 0.9855455756187439, "length": 14.03542423248291, "mode": "train", "epoch": 29}
{"loss": 0.2567427456378937, "acc": 0.9084390997886658, "length": 11.90798568725586, "mode": "test", "epoch": 29}
{"loss": 0.06274077296257019, "acc": 0.984220564365387, "length": 13.207892417907715, "mode": "train", "epoch": 30}
{"loss": 0.18743258714675903, "acc": 0.9306857585906982, "length": 12.416666984558105, "mode": "test", "epoch": 30}
{"loss": 0.05231231823563576, "acc": 0.987800121307373, "length": 14.075078964233398, "mode": "train", "epoch": 31}
{"loss": 0.1827496886253357, "acc": 0.9408664703369141, "length": 14.32118034362793, "mode": "test", "epoch": 31}
{"loss": 0.047045473009347916, "acc": 0.9897766709327698, "length": 14.509781837463379, "mode": "train", "epoch": 32}
{"loss": 0.12541502714157104, "acc": 0.9556586742401123, "length": 13.581597328186035, "mode": "test", "epoch": 32}
{"loss": 0.039985254406929016, "acc": 0.9928317666053772, "length": 14.094316482543945, "mode": "train", "epoch": 33}
{"loss": 0.15931576490402222, "acc": 0.9418672919273376, "length": 13.33506965637207, "mode": "test", "epoch": 33}
{"loss": 0.042999058961868286, "acc": 0.9914609789848328, "length": 13.909927368164062, "mode": "train", "epoch": 34}
{"loss": 0.20551420748233795, "acc": 0.9371934533119202, "length": 11.965277671813965, "mode": "test", "epoch": 34}
{"loss": 0.05279333516955376, "acc": 0.9866213202476501, "length": 14.16724967956543, "mode": "train", "epoch": 35}
{"loss": 0.14414075016975403, "acc": 0.9550590515136719, "length": 14.05555534362793, "mode": "test", "epoch": 35}
{"loss": 0.039397262036800385, "acc": 0.9925312399864197, "length": 14.733423233032227, "mode": "train", "epoch": 36}
{"loss": 0.12153065204620361, "acc": 0.95849609375, "length": 13.80381965637207, "mode": "test", "epoch": 36}
{"loss": 0.038806308060884476, "acc": 0.9927800297737122, "length": 15.001161575317383, "mode": "train", "epoch": 37}
{"loss": 0.18704938888549805, "acc": 0.9349989295005798, "length": 13.77951431274414, "mode": "test", "epoch": 37}
{"loss": 0.03346581757068634, "acc": 0.9947435855865479, "length": 14.420561790466309, "mode": "train", "epoch": 38}
{"loss": 0.12981803715229034, "acc": 0.9606634974479675, "length": 13.637152671813965, "mode": "test", "epoch": 38}
{"loss": 0.029160790145397186, "acc": 0.9960500597953796, "length": 14.175902366638184, "mode": "train", "epoch": 39}
{"loss": 0.12569008767604828, "acc": 0.9603976011276245, "length": 13.26736068725586, "mode": "test", "epoch": 39}
{"loss": 0.027548616752028465, "acc": 0.9967153072357178, "length": 14.546767234802246, "mode": "train", "epoch": 40}
{"loss": 0.1464669108390808, "acc": 0.9543918967247009, "length": 13.67013931274414, "mode": "test", "epoch": 40}
{"loss": 0.024051856249570847, "acc": 0.9975083470344543, "length": 13.608635902404785, "mode": "train", "epoch": 41}
{"loss": 0.1446661353111267, "acc": 0.9533827304840088, "length": 12.871527671813965, "mode": "test", "epoch": 41}
{"loss": 0.031555406749248505, "acc": 0.9952245950698853, "length": 12.800592422485352, "mode": "train", "epoch": 42}
{"loss": 0.13076572120189667, "acc": 0.9552137851715088, "length": 11.953125, "mode": "test", "epoch": 42}
{"loss": 0.06726187467575073, "acc": 0.9797984957695007, "length": 12.534004211425781, "mode": "train", "epoch": 43}
{"loss": 0.13506481051445007, "acc": 0.9520399570465088, "length": 11.70138931274414, "mode": "test", "epoch": 43}
{"loss": 0.05768335610628128, "acc": 0.9855256080627441, "length": 12.244182586669922, "mode": "train", "epoch": 44}
{"loss": 0.1005757674574852, "acc": 0.9635524749755859, "length": 13.003472328186035, "mode": "test", "epoch": 44}
{"loss": 0.039294809103012085, "acc": 0.9913192391395569, "length": 13.578962326049805, "mode": "train", "epoch": 45}
{"loss": 0.0728362500667572, "acc": 0.9798991084098816, "length": 12.67013931274414, "mode": "test", "epoch": 45}
{"loss": 0.027288466691970825, "acc": 0.996555507183075, "length": 14.311949729919434, "mode": "train", "epoch": 46}
{"loss": 0.0623408742249012, "acc": 0.9828315377235413, "length": 13.390625, "mode": "test", "epoch": 46}
{"loss": 0.021618463099002838, "acc": 0.9980025887489319, "length": 13.542570114135742, "mode": "train", "epoch": 47}
{"loss": 0.05774109065532684, "acc": 0.9852621555328369, "length": 12.93576431274414, "mode": "test", "epoch": 47}
{"loss": 0.01939122937619686, "acc": 0.9986621737480164, "length": 13.246630668640137, "mode": "train", "epoch": 48}
{"loss": 0.059868693351745605, "acc": 0.9869954586029053, "length": 11.91319465637207, "mode": "test", "epoch": 48}
{"loss": 0.01766924187541008, "acc": 0.9991658329963684, "length": 12.563447952270508, "mode": "train", "epoch": 49}
{"loss": 0.046093523502349854, "acc": 0.9909125566482544, "length": 11.708333015441895, "mode": "test", "epoch": 49}
{"loss": 0.016933344304561615, "acc": 0.9990831613540649, "length": 12.420137405395508, "mode": "train", "epoch": 50}
{"loss": 0.049316518008708954, "acc": 0.9876382350921631, "length": 11.755208015441895, "mode": "test", "epoch": 50}
{"loss": 0.019774025306105614, "acc": 0.9982417225837708, "length": 12.498604774475098, "mode": "train", "epoch": 51}
{"loss": 0.10076594352722168, "acc": 0.9725151062011719, "length": 11.92361068725586, "mode": "test", "epoch": 51}
{"loss": 0.021149512380361557, "acc": 0.9974884986877441, "length": 12.587302207946777, "mode": "train", "epoch": 52}
{"loss": 0.05445462837815285, "acc": 0.9874376654624939, "length": 11.401041984558105, "mode": "test", "epoch": 52}
{"loss": 0.017623592168092728, "acc": 0.9983426332473755, "length": 11.874383926391602, "mode": "train", "epoch": 53}
{"loss": 0.05758467689156532, "acc": 0.9828993678092957, "length": 11.36111068725586, "mode": "test", "epoch": 53}
{"loss": 0.016974059864878654, "acc": 0.9988060593605042, "length": 11.89842414855957, "mode": "train", "epoch": 54}
{"loss": 0.061791691929101944, "acc": 0.977783203125, "length": 11.333333015441895, "mode": "test", "epoch": 54}
{"loss": 0.014506128616631031, "acc": 0.9993689060211182, "length": 11.699925422668457, "mode": "train", "epoch": 55}
{"loss": 0.036603428423404694, "acc": 0.9909505844116211, "length": 11.21180534362793, "mode": "test", "epoch": 55}
{"loss": 0.01325305737555027, "acc": 0.9996504783630371, "length": 11.560428619384766, "mode": "train", "epoch": 56}
{"loss": 0.046672575175762177, "acc": 0.9878717064857483, "length": 11.020833015441895, "mode": "test", "epoch": 56}
{"loss": 0.017783591523766518, "acc": 0.9973708391189575, "length": 10.739361763000488, "mode": "train", "epoch": 57}
{"loss": 0.05353204905986786, "acc": 0.9838922023773193, "length": 10.09375, "mode": "test", "epoch": 57}
{"loss": 0.03326406702399254, "acc": 0.991985023021698, "length": 11.28780460357666, "mode": "train", "epoch": 58}
{"loss": 0.07872059941291809, "acc": 0.9768092632293701, "length": 11.072916984558105, "mode": "test", "epoch": 58}
{"loss": 0.04021279141306877, "acc": 0.989869236946106, "length": 12.321399688720703, "mode": "train", "epoch": 59}
{"loss": 0.07368341833353043, "acc": 0.9790771007537842, "length": 10.237847328186035, "mode": "test", "epoch": 59}
{"loss": 0.022670870646834373, "acc": 0.9964701533317566, "length": 12.168739318847656, "mode": "train", "epoch": 60}
{"loss": 0.04980786144733429, "acc": 0.9861924052238464, "length": 11.590277671813965, "mode": "test", "epoch": 60}
test accuracy: 0.8443934917449951
