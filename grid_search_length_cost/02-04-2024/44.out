ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 30
{"loss": 0.4108239412307739, "acc": 0.8110213875770569, "length": 6.447437286376953, "mode": "train", "epoch": 1}
{"loss": 0.3822510838508606, "acc": 0.8432561159133911, "length": 10.458297729492188, "mode": "test", "epoch": 1}
{"loss": 0.24118667840957642, "acc": 0.9167096018791199, "length": 9.018332481384277, "mode": "train", "epoch": 2}
{"loss": 0.4290887713432312, "acc": 0.8359110951423645, "length": 17.793577194213867, "mode": "test", "epoch": 2}
{"loss": 0.19178681075572968, "acc": 0.9395284056663513, "length": 9.968926429748535, "mode": "train", "epoch": 3}
{"loss": 0.27501872181892395, "acc": 0.8967731595039368, "length": 10.862060546875, "mode": "test", "epoch": 3}
{"loss": 0.16341012716293335, "acc": 0.9529489874839783, "length": 10.154363632202148, "mode": "train", "epoch": 4}
{"loss": 0.2338734120130539, "acc": 0.9208689332008362, "length": 11.034638404846191, "mode": "test", "epoch": 4}
{"loss": 0.1453019678592682, "acc": 0.9606123566627502, "length": 9.944801330566406, "mode": "train", "epoch": 5}
{"loss": 0.2382623553276062, "acc": 0.9213221073150635, "length": 9.70588207244873, "mode": "test", "epoch": 5}
{"loss": 0.13609926402568817, "acc": 0.9636910557746887, "length": 9.989930152893066, "mode": "train", "epoch": 6}
{"loss": 0.21660266816616058, "acc": 0.9300064444541931, "length": 9.587118148803711, "mode": "test", "epoch": 6}
{"loss": 0.12910622358322144, "acc": 0.9657468199729919, "length": 10.267977714538574, "mode": "train", "epoch": 7}
{"loss": 0.1787935197353363, "acc": 0.9466809034347534, "length": 13.82926082611084, "mode": "test", "epoch": 7}
{"loss": 0.1116405576467514, "acc": 0.9722800850868225, "length": 10.260971069335938, "mode": "train", "epoch": 8}
{"loss": 0.13694119453430176, "acc": 0.962059497833252, "length": 9.040909767150879, "mode": "test", "epoch": 8}
{"loss": 0.09965701401233673, "acc": 0.9762983918190002, "length": 9.363914489746094, "mode": "train", "epoch": 9}
{"loss": 0.1460016965866089, "acc": 0.9556235671043396, "length": 9.451593399047852, "mode": "test", "epoch": 9}
{"loss": 0.09370545297861099, "acc": 0.9773550033569336, "length": 9.493518829345703, "mode": "train", "epoch": 10}
{"loss": 0.13591326773166656, "acc": 0.9590833783149719, "length": 9.572052001953125, "mode": "test", "epoch": 10}
{"loss": 0.08375423401594162, "acc": 0.9802981615066528, "length": 9.700651168823242, "mode": "train", "epoch": 11}
{"loss": 0.13675667345523834, "acc": 0.9592816233634949, "length": 9.010993003845215, "mode": "test", "epoch": 11}
{"loss": 0.07393869012594223, "acc": 0.98356693983078, "length": 9.461061477661133, "mode": "train", "epoch": 12}
{"loss": 0.12122564017772675, "acc": 0.9649019241333008, "length": 8.908304214477539, "mode": "test", "epoch": 12}
{"loss": 0.065306656062603, "acc": 0.9866569638252258, "length": 9.158172607421875, "mode": "train", "epoch": 13}
{"loss": 0.09657444059848785, "acc": 0.974132239818573, "length": 8.438617706298828, "mode": "test", "epoch": 13}
{"loss": 0.06684168428182602, "acc": 0.9859201908111572, "length": 9.163604736328125, "mode": "train", "epoch": 14}
{"loss": 0.09586891531944275, "acc": 0.9735885858535767, "length": 8.737672805786133, "mode": "test", "epoch": 14}
{"loss": 0.06044679135084152, "acc": 0.9878295660018921, "length": 9.08727741241455, "mode": "train", "epoch": 15}
{"loss": 0.08087001740932465, "acc": 0.9799228310585022, "length": 9.289179801940918, "mode": "test", "epoch": 15}
{"loss": 0.05719922482967377, "acc": 0.9886027574539185, "length": 9.23268985748291, "mode": "train", "epoch": 16}
{"loss": 0.07810969650745392, "acc": 0.9811964631080627, "length": 9.250036239624023, "mode": "test", "epoch": 16}
{"loss": 0.05323952063918114, "acc": 0.9894054532051086, "length": 9.21020221710205, "mode": "train", "epoch": 17}
{"loss": 0.0727643147110939, "acc": 0.982665479183197, "length": 9.181769371032715, "mode": "test", "epoch": 17}
{"loss": 0.05222844332456589, "acc": 0.9893878102302551, "length": 9.536151885986328, "mode": "train", "epoch": 18}
{"loss": 0.06751665472984314, "acc": 0.9844954013824463, "length": 10.290837287902832, "mode": "test", "epoch": 18}
{"loss": 0.045688364654779434, "acc": 0.9915370941162109, "length": 9.603271484375, "mode": "train", "epoch": 19}
{"loss": 0.061135996133089066, "acc": 0.9876851439476013, "length": 9.678056716918945, "mode": "test", "epoch": 19}
{"loss": 0.04400675743818283, "acc": 0.9921505451202393, "length": 9.63664436340332, "mode": "train", "epoch": 20}
{"loss": 0.05288107320666313, "acc": 0.9892885088920593, "length": 9.73861026763916, "mode": "test", "epoch": 20}
{"loss": 0.04135765880346298, "acc": 0.99293452501297, "length": 9.221729278564453, "mode": "train", "epoch": 21}
{"loss": 0.05364066734910011, "acc": 0.9894618391990662, "length": 8.584342956542969, "mode": "test", "epoch": 21}
{"loss": 0.0468834824860096, "acc": 0.9915002584457397, "length": 10.549582481384277, "mode": "train", "epoch": 22}
{"loss": 0.05062876641750336, "acc": 0.9902864694595337, "length": 9.186382293701172, "mode": "test", "epoch": 22}
{"loss": 0.040619902312755585, "acc": 0.9930300712585449, "length": 9.442421913146973, "mode": "train", "epoch": 23}
{"loss": 0.051686786115169525, "acc": 0.990036129951477, "length": 9.079548835754395, "mode": "test", "epoch": 23}
{"loss": 0.03966832533478737, "acc": 0.9929274916648865, "length": 8.850354194641113, "mode": "train", "epoch": 24}
{"loss": 0.05359853431582451, "acc": 0.9898650646209717, "length": 9.627090454101562, "mode": "test", "epoch": 24}
{"loss": 0.040115226060152054, "acc": 0.9926318526268005, "length": 9.499966621398926, "mode": "train", "epoch": 25}
{"loss": 0.05409571900963783, "acc": 0.98799729347229, "length": 9.774689674377441, "mode": "test", "epoch": 25}
{"loss": 0.03668713569641113, "acc": 0.993195116519928, "length": 9.25970458984375, "mode": "train", "epoch": 26}
{"loss": 0.05149277672171593, "acc": 0.9893786907196045, "length": 9.068195343017578, "mode": "test", "epoch": 26}
{"loss": 0.033867184072732925, "acc": 0.993938684463501, "length": 9.146571159362793, "mode": "train", "epoch": 27}
{"loss": 0.04075257480144501, "acc": 0.9926801919937134, "length": 8.711504936218262, "mode": "test", "epoch": 27}
{"loss": 0.0316169448196888, "acc": 0.9944394826889038, "length": 9.179832458496094, "mode": "train", "epoch": 28}
{"loss": 0.03600066900253296, "acc": 0.9935318231582642, "length": 9.582648277282715, "mode": "test", "epoch": 28}
{"loss": 0.028844399377703667, "acc": 0.9948703050613403, "length": 9.361260414123535, "mode": "train", "epoch": 29}
{"loss": 0.04743334650993347, "acc": 0.9896104335784912, "length": 11.682201385498047, "mode": "test", "epoch": 29}
{"loss": 0.03124743141233921, "acc": 0.9942095875740051, "length": 10.110922813415527, "mode": "train", "epoch": 30}
{"loss": 0.0454026535153389, "acc": 0.9883275628089905, "length": 9.51391315460205, "mode": "test", "epoch": 30}
{"loss": 0.02682451531291008, "acc": 0.995374858379364, "length": 9.700685501098633, "mode": "train", "epoch": 31}
{"loss": 0.029720937833189964, "acc": 0.9952707290649414, "length": 9.795955657958984, "mode": "test", "epoch": 31}
{"loss": 0.02319473586976528, "acc": 0.9964609146118164, "length": 9.608384132385254, "mode": "train", "epoch": 32}
{"loss": 0.029741819947957993, "acc": 0.9946785569190979, "length": 9.287665367126465, "mode": "test", "epoch": 32}
{"loss": 0.02100442163646221, "acc": 0.9968060255050659, "length": 9.379975318908691, "mode": "train", "epoch": 33}
{"loss": 0.03030318021774292, "acc": 0.9941556453704834, "length": 9.788314819335938, "mode": "test", "epoch": 33}
{"loss": 0.0230821892619133, "acc": 0.9960716962814331, "length": 10.119431495666504, "mode": "train", "epoch": 34}
{"loss": 0.0288291834294796, "acc": 0.9946138858795166, "length": 9.858203887939453, "mode": "test", "epoch": 34}
{"loss": 0.017732342705130577, "acc": 0.9974492192268372, "length": 9.189467430114746, "mode": "train", "epoch": 35}
{"loss": 0.0229170024394989, "acc": 0.9963880181312561, "length": 8.82086181640625, "mode": "test", "epoch": 35}
{"loss": 0.016950087621808052, "acc": 0.9974669814109802, "length": 9.220588684082031, "mode": "train", "epoch": 36}
{"loss": 0.025899073109030724, "acc": 0.9948288798332214, "length": 9.172758102416992, "mode": "test", "epoch": 36}
{"loss": 0.016612159088253975, "acc": 0.9976388812065125, "length": 9.756210327148438, "mode": "train", "epoch": 37}
{"loss": 0.018786147236824036, "acc": 0.9979753494262695, "length": 9.826845169067383, "mode": "test", "epoch": 37}
{"loss": 0.014303966425359249, "acc": 0.9980021715164185, "length": 9.290961265563965, "mode": "train", "epoch": 38}
{"loss": 0.018975384533405304, "acc": 0.9968336820602417, "length": 9.08762264251709, "mode": "test", "epoch": 38}
{"loss": 0.020621242001652718, "acc": 0.996010959148407, "length": 10.189114570617676, "mode": "train", "epoch": 39}
{"loss": 0.035268478095531464, "acc": 0.9922969937324524, "length": 11.76131820678711, "mode": "test", "epoch": 39}
{"loss": 0.016748877242207527, "acc": 0.9972183108329773, "length": 10.575512886047363, "mode": "train", "epoch": 40}
{"loss": 0.014689137227833271, "acc": 0.9981688261032104, "length": 10.244089126586914, "mode": "test", "epoch": 40}
{"loss": 0.01708873175084591, "acc": 0.997203528881073, "length": 10.54766845703125, "mode": "train", "epoch": 41}
{"loss": 0.027106741443276405, "acc": 0.9944682121276855, "length": 13.306949615478516, "mode": "test", "epoch": 41}
{"loss": 0.013284179382026196, "acc": 0.998291015625, "length": 10.425037384033203, "mode": "train", "epoch": 42}
{"loss": 0.014546987600624561, "acc": 0.9981859922409058, "length": 9.619521141052246, "mode": "test", "epoch": 42}
{"loss": 0.012607456184923649, "acc": 0.9983466863632202, "length": 9.738329887390137, "mode": "train", "epoch": 43}
{"loss": 0.01453796774148941, "acc": 0.997938334941864, "length": 9.764561653137207, "mode": "test", "epoch": 43}
{"loss": 0.010079270228743553, "acc": 0.9989610314369202, "length": 9.470108985900879, "mode": "train", "epoch": 44}
{"loss": 0.012438330799341202, "acc": 0.9987691640853882, "length": 9.599409103393555, "mode": "test", "epoch": 44}
{"loss": 0.010950441472232342, "acc": 0.9987290501594543, "length": 9.397016525268555, "mode": "train", "epoch": 45}
{"loss": 0.012235574424266815, "acc": 0.9990272521972656, "length": 9.71936321258545, "mode": "test", "epoch": 45}
{"loss": 0.010871690697968006, "acc": 0.9987887740135193, "length": 10.019214630126953, "mode": "train", "epoch": 46}
{"loss": 0.010715102776885033, "acc": 0.9991194605827332, "length": 10.082540512084961, "mode": "test", "epoch": 46}
{"loss": 0.0088024428114295, "acc": 0.9993440508842468, "length": 9.628289222717285, "mode": "train", "epoch": 47}
{"loss": 0.009889707900583744, "acc": 0.9991368651390076, "length": 9.582468032836914, "mode": "test", "epoch": 47}
{"loss": 0.010664509609341621, "acc": 0.9987226724624634, "length": 9.162398338317871, "mode": "train", "epoch": 48}
{"loss": 0.01496559102088213, "acc": 0.9974748492240906, "length": 8.859464645385742, "mode": "test", "epoch": 48}
{"loss": 0.009026533924043179, "acc": 0.9991403818130493, "length": 8.797365188598633, "mode": "train", "epoch": 49}
{"loss": 0.012297358363866806, "acc": 0.9987269043922424, "length": 8.722173690795898, "mode": "test", "epoch": 49}
{"loss": 0.009772357530891895, "acc": 0.9989548325538635, "length": 9.043539047241211, "mode": "train", "epoch": 50}
{"loss": 0.010564776137471199, "acc": 0.9990585446357727, "length": 9.388228416442871, "mode": "test", "epoch": 50}
{"loss": 0.008891072124242783, "acc": 0.9991711378097534, "length": 9.023048400878906, "mode": "train", "epoch": 51}
{"loss": 0.008914184756577015, "acc": 0.9992870688438416, "length": 8.790765762329102, "mode": "test", "epoch": 51}
{"loss": 0.007618665229529142, "acc": 0.9994696378707886, "length": 8.800211906433105, "mode": "train", "epoch": 52}
{"loss": 0.010914498008787632, "acc": 0.9985927939414978, "length": 8.845768928527832, "mode": "test", "epoch": 52}
{"loss": 0.007631333544850349, "acc": 0.9994879364967346, "length": 8.880450248718262, "mode": "train", "epoch": 53}
{"loss": 0.008424988016486168, "acc": 0.9993930459022522, "length": 8.857951164245605, "mode": "test", "epoch": 53}
{"loss": 0.007939556613564491, "acc": 0.9994416236877441, "length": 9.2266845703125, "mode": "train", "epoch": 54}
{"loss": 0.008113672956824303, "acc": 0.9995409250259399, "length": 8.645797729492188, "mode": "test", "epoch": 54}
{"loss": 0.008509690873324871, "acc": 0.999204695224762, "length": 8.695549011230469, "mode": "train", "epoch": 55}
{"loss": 0.009828305803239346, "acc": 0.999184787273407, "length": 8.950980186462402, "mode": "test", "epoch": 55}
{"loss": 0.00791619997471571, "acc": 0.9993962049484253, "length": 8.811287879943848, "mode": "train", "epoch": 56}
{"loss": 0.011106818914413452, "acc": 0.9986945986747742, "length": 8.810626029968262, "mode": "test", "epoch": 56}
{"loss": 0.00811352301388979, "acc": 0.9992347359657288, "length": 8.99567985534668, "mode": "train", "epoch": 57}
{"loss": 0.009852581657469273, "acc": 0.9992088079452515, "length": 8.92618179321289, "mode": "test", "epoch": 57}
{"loss": 0.0073883626610040665, "acc": 0.9995570778846741, "length": 9.494919776916504, "mode": "train", "epoch": 58}
{"loss": 0.008271089754998684, "acc": 0.9994772672653198, "length": 9.528546333312988, "mode": "test", "epoch": 58}
{"loss": 0.007668198551982641, "acc": 0.999441385269165, "length": 9.241164207458496, "mode": "train", "epoch": 59}
{"loss": 0.011083810590207577, "acc": 0.9988194108009338, "length": 9.325223922729492, "mode": "test", "epoch": 59}
{"loss": 0.013536179438233376, "acc": 0.9979735016822815, "length": 10.092087745666504, "mode": "train", "epoch": 60}
{"loss": 0.012621999718248844, "acc": 0.9986121654510498, "length": 10.323060989379883, "mode": "test", "epoch": 60}
test accuracy: 0.9955587387084961
