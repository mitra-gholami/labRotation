ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.4366348385810852, "acc": 0.7781708836555481, "length": 2.421048879623413, "mode": "train", "epoch": 1}
{"loss": 0.35152873396873474, "acc": 0.8589653372764587, "length": 2.7651853561401367, "mode": "test", "epoch": 1}
{"loss": 0.26828768849372864, "acc": 0.9070366024971008, "length": 3.163672924041748, "mode": "train", "epoch": 2}
{"loss": 0.3134104013442993, "acc": 0.8779917359352112, "length": 3.3635311126708984, "mode": "test", "epoch": 2}
{"loss": 0.21988409757614136, "acc": 0.9338813424110413, "length": 3.6924095153808594, "mode": "train", "epoch": 3}
{"loss": 0.2857646942138672, "acc": 0.9014670252799988, "length": 3.68953800201416, "mode": "test", "epoch": 3}
{"loss": 0.1948583573102951, "acc": 0.9468229413032532, "length": 3.7554900646209717, "mode": "train", "epoch": 4}
{"loss": 0.2670994997024536, "acc": 0.9151126146316528, "length": 3.7197489738464355, "mode": "test", "epoch": 4}
{"loss": 0.18469873070716858, "acc": 0.9502456188201904, "length": 3.699376344680786, "mode": "train", "epoch": 5}
{"loss": 0.26752525568008423, "acc": 0.9124332070350647, "length": 3.631833553314209, "mode": "test", "epoch": 5}
{"loss": 0.17405107617378235, "acc": 0.9541401267051697, "length": 3.672250509262085, "mode": "train", "epoch": 6}
{"loss": 0.26844096183776855, "acc": 0.9044489860534668, "length": 3.6643221378326416, "mode": "test", "epoch": 6}
{"loss": 0.16317132115364075, "acc": 0.9580384492874146, "length": 3.6993038654327393, "mode": "train", "epoch": 7}
{"loss": 0.28510040044784546, "acc": 0.901789665222168, "length": 3.675471544265747, "mode": "test", "epoch": 7}
{"loss": 0.15750232338905334, "acc": 0.9607294201850891, "length": 3.6596460342407227, "mode": "train", "epoch": 8}
{"loss": 0.2669067680835724, "acc": 0.90972900390625, "length": 3.6729540824890137, "mode": "test", "epoch": 8}
{"loss": 0.15243075788021088, "acc": 0.962849497795105, "length": 3.65187406539917, "mode": "train", "epoch": 9}
{"loss": 0.2734159231185913, "acc": 0.9112995266914368, "length": 3.622921943664551, "mode": "test", "epoch": 9}
{"loss": 0.15176455676555634, "acc": 0.9632680416107178, "length": 3.6436634063720703, "mode": "train", "epoch": 10}
{"loss": 0.2858048975467682, "acc": 0.9036576151847839, "length": 3.6568894386291504, "mode": "test", "epoch": 10}
{"loss": 0.14949165284633636, "acc": 0.9640672206878662, "length": 3.6235897541046143, "mode": "train", "epoch": 11}
{"loss": 0.30248990654945374, "acc": 0.9062935709953308, "length": 3.588674783706665, "mode": "test", "epoch": 11}
{"loss": 0.14811766147613525, "acc": 0.9644801020622253, "length": 3.621262311935425, "mode": "train", "epoch": 12}
{"loss": 0.29418259859085083, "acc": 0.9004969000816345, "length": 3.5341272354125977, "mode": "test", "epoch": 12}
{"loss": 0.14671994745731354, "acc": 0.9648880958557129, "length": 3.6246795654296875, "mode": "train", "epoch": 13}
{"loss": 0.2596908211708069, "acc": 0.91081303358078, "length": 3.590512990951538, "mode": "test", "epoch": 13}
{"loss": 0.14486908912658691, "acc": 0.9653437733650208, "length": 3.6263349056243896, "mode": "train", "epoch": 14}
{"loss": 0.23959389328956604, "acc": 0.9247829914093018, "length": 3.626838207244873, "mode": "test", "epoch": 14}
{"loss": 0.14294320344924927, "acc": 0.9656020998954773, "length": 3.636270523071289, "mode": "train", "epoch": 15}
{"loss": 0.29843178391456604, "acc": 0.8956896662712097, "length": 3.5895140171051025, "mode": "test", "epoch": 15}
{"loss": 0.14394718408584595, "acc": 0.9645569920539856, "length": 3.6359078884124756, "mode": "train", "epoch": 16}
{"loss": 0.2924327552318573, "acc": 0.904680073261261, "length": 3.5928308963775635, "mode": "test", "epoch": 16}
{"loss": 0.13769924640655518, "acc": 0.965772271156311, "length": 3.6298716068267822, "mode": "train", "epoch": 17}
{"loss": 0.2467844933271408, "acc": 0.9195021986961365, "length": 3.5996243953704834, "mode": "test", "epoch": 17}
{"loss": 0.1334703266620636, "acc": 0.9665939211845398, "length": 3.62886118888855, "mode": "train", "epoch": 18}
{"loss": 0.2783137857913971, "acc": 0.9107640981674194, "length": 3.5931105613708496, "mode": "test", "epoch": 18}
{"loss": 0.12976323068141937, "acc": 0.966829776763916, "length": 3.6329896450042725, "mode": "train", "epoch": 19}
{"loss": 0.2351616621017456, "acc": 0.9221925139427185, "length": 3.6584479808807373, "mode": "test", "epoch": 19}
{"loss": 0.12325618416070938, "acc": 0.9682812094688416, "length": 3.633039951324463, "mode": "train", "epoch": 20}
{"loss": 0.2863592803478241, "acc": 0.9068484306335449, "length": 3.620044708251953, "mode": "test", "epoch": 20}
{"loss": 0.11771296709775925, "acc": 0.9697774052619934, "length": 3.622800827026367, "mode": "train", "epoch": 21}
{"loss": 0.2894875109195709, "acc": 0.9027704000473022, "length": 3.6029012203216553, "mode": "test", "epoch": 21}
{"loss": 0.11103999614715576, "acc": 0.9715820550918579, "length": 3.6315507888793945, "mode": "train", "epoch": 22}
{"loss": 0.25628575682640076, "acc": 0.9132086038589478, "length": 3.6501357555389404, "mode": "test", "epoch": 22}
{"loss": 0.10719015449285507, "acc": 0.972883403301239, "length": 3.6303114891052246, "mode": "train", "epoch": 23}
{"loss": 0.327519029378891, "acc": 0.8935343027114868, "length": 3.5981059074401855, "mode": "test", "epoch": 23}
{"loss": 0.10214395821094513, "acc": 0.9745221138000488, "length": 3.631049156188965, "mode": "train", "epoch": 24}
{"loss": 0.2971726953983307, "acc": 0.902851402759552, "length": 3.6744325160980225, "mode": "test", "epoch": 24}
{"loss": 0.09953024983406067, "acc": 0.9754607081413269, "length": 3.6427853107452393, "mode": "train", "epoch": 25}
{"loss": 0.3040213882923126, "acc": 0.906366765499115, "length": 3.659406900405884, "mode": "test", "epoch": 25}
{"loss": 0.09365013986825943, "acc": 0.9774655103683472, "length": 3.670839786529541, "mode": "train", "epoch": 26}
{"loss": 0.3039809763431549, "acc": 0.9047867655754089, "length": 3.6226022243499756, "mode": "test", "epoch": 26}
{"loss": 0.08917644619941711, "acc": 0.979136049747467, "length": 3.6696059703826904, "mode": "train", "epoch": 27}
{"loss": 0.3801393210887909, "acc": 0.881676971912384, "length": 3.6309142112731934, "mode": "test", "epoch": 27}
{"loss": 0.08480745553970337, "acc": 0.9809933304786682, "length": 3.689061403274536, "mode": "train", "epoch": 28}
{"loss": 0.2946453094482422, "acc": 0.904037594795227, "length": 3.7106378078460693, "mode": "test", "epoch": 28}
{"loss": 0.08100625872612, "acc": 0.9824154376983643, "length": 3.6890437602996826, "mode": "train", "epoch": 29}
{"loss": 0.26791858673095703, "acc": 0.918186366558075, "length": 3.769141674041748, "mode": "test", "epoch": 29}
{"loss": 0.07925552129745483, "acc": 0.9832273125648499, "length": 3.689220666885376, "mode": "train", "epoch": 30}
{"loss": 0.328718364238739, "acc": 0.8976263403892517, "length": 3.7040841579437256, "mode": "test", "epoch": 30}
{"loss": 0.0761517733335495, "acc": 0.9841305017471313, "length": 3.6880123615264893, "mode": "train", "epoch": 31}
{"loss": 0.3474717438220978, "acc": 0.8917672634124756, "length": 3.6448209285736084, "mode": "test", "epoch": 31}
{"loss": 0.07239644974470139, "acc": 0.9855343103408813, "length": 3.692809820175171, "mode": "train", "epoch": 32}
{"loss": 0.3220764696598053, "acc": 0.89876389503479, "length": 3.694852828979492, "mode": "test", "epoch": 32}
{"loss": 0.07035107910633087, "acc": 0.986448347568512, "length": 3.700021266937256, "mode": "train", "epoch": 33}
{"loss": 0.3700404763221741, "acc": 0.8895882368087769, "length": 3.6367087364196777, "mode": "test", "epoch": 33}
{"loss": 0.06932591646909714, "acc": 0.9869139194488525, "length": 3.69149112701416, "mode": "train", "epoch": 34}
{"loss": 0.33349719643592834, "acc": 0.9025411605834961, "length": 3.6671993732452393, "mode": "test", "epoch": 34}
{"loss": 0.0672510415315628, "acc": 0.9874073266983032, "length": 3.710383415222168, "mode": "train", "epoch": 35}
{"loss": 0.3219156265258789, "acc": 0.9004395008087158, "length": 3.689338207244873, "mode": "test", "epoch": 35}
{"loss": 0.06632263958454132, "acc": 0.9878561496734619, "length": 3.699946403503418, "mode": "train", "epoch": 36}
{"loss": 0.3913765847682953, "acc": 0.8889396786689758, "length": 3.624920129776001, "mode": "test", "epoch": 36}
{"loss": 0.06492330878973007, "acc": 0.9882332682609558, "length": 3.689579486846924, "mode": "train", "epoch": 37}
{"loss": 0.3607260584831238, "acc": 0.8988465666770935, "length": 3.673593282699585, "mode": "test", "epoch": 37}
{"loss": 0.06451688706874847, "acc": 0.9884424209594727, "length": 3.7000765800476074, "mode": "train", "epoch": 38}
{"loss": 0.35381054878234863, "acc": 0.8941206336021423, "length": 3.6777093410491943, "mode": "test", "epoch": 38}
{"loss": 0.06464134156703949, "acc": 0.9885312914848328, "length": 3.6964168548583984, "mode": "train", "epoch": 39}
{"loss": 0.29913070797920227, "acc": 0.913763165473938, "length": 3.758352041244507, "mode": "test", "epoch": 39}
{"loss": 0.06375783681869507, "acc": 0.9886744618415833, "length": 3.6975529193878174, "mode": "train", "epoch": 40}
{"loss": 0.31390440464019775, "acc": 0.9078245759010315, "length": 3.690696954727173, "mode": "test", "epoch": 40}
{"loss": 0.06286989152431488, "acc": 0.9889113306999207, "length": 3.701773166656494, "mode": "train", "epoch": 41}
{"loss": 0.3064473271369934, "acc": 0.9129431247711182, "length": 3.6985692977905273, "mode": "test", "epoch": 41}
{"loss": 0.06160510331392288, "acc": 0.9894431233406067, "length": 3.690662145614624, "mode": "train", "epoch": 42}
{"loss": 0.3264206349849701, "acc": 0.9077642560005188, "length": 3.689578056335449, "mode": "test", "epoch": 42}
{"loss": 0.06346555054187775, "acc": 0.9888323545455933, "length": 3.6964335441589355, "mode": "train", "epoch": 43}
{"loss": 0.2999413013458252, "acc": 0.9140392541885376, "length": 3.723825216293335, "mode": "test", "epoch": 43}
{"loss": 0.06127625331282616, "acc": 0.9895734786987305, "length": 3.6998398303985596, "mode": "train", "epoch": 44}
{"loss": 0.25953659415245056, "acc": 0.9222942590713501, "length": 3.7472825050354004, "mode": "test", "epoch": 44}
{"loss": 0.061520349234342575, "acc": 0.9894330501556396, "length": 3.702471971511841, "mode": "train", "epoch": 45}
{"loss": 0.27380862832069397, "acc": 0.9226527810096741, "length": 3.775695323944092, "mode": "test", "epoch": 45}
{"loss": 0.06044291704893112, "acc": 0.9897973537445068, "length": 3.694504737854004, "mode": "train", "epoch": 46}
{"loss": 0.27347514033317566, "acc": 0.9187552332878113, "length": 3.629955291748047, "mode": "test", "epoch": 46}
{"loss": 0.06018390879034996, "acc": 0.989818811416626, "length": 3.6953232288360596, "mode": "train", "epoch": 47}
{"loss": 0.2983608841896057, "acc": 0.9143723845481873, "length": 3.6949727535247803, "mode": "test", "epoch": 47}
{"loss": 0.06380565464496613, "acc": 0.9888608455657959, "length": 3.707237482070923, "mode": "train", "epoch": 48}
{"loss": 0.2975158989429474, "acc": 0.9174689054489136, "length": 3.694173574447632, "mode": "test", "epoch": 48}
{"loss": 0.058942776173353195, "acc": 0.9902099370956421, "length": 3.6973776817321777, "mode": "train", "epoch": 49}
{"loss": 0.30061855912208557, "acc": 0.9188027381896973, "length": 3.72898006439209, "mode": "test", "epoch": 49}
{"loss": 0.06131235510110855, "acc": 0.9896278977394104, "length": 3.7019262313842773, "mode": "train", "epoch": 50}
{"loss": 0.2528110146522522, "acc": 0.9262593984603882, "length": 3.708040237426758, "mode": "test", "epoch": 50}
{"loss": 0.06072388216853142, "acc": 0.9897853136062622, "length": 3.701810359954834, "mode": "train", "epoch": 51}
{"loss": 0.29180222749710083, "acc": 0.9135981798171997, "length": 3.732576608657837, "mode": "test", "epoch": 51}
{"loss": 0.059036318212747574, "acc": 0.9903302192687988, "length": 3.706031084060669, "mode": "train", "epoch": 52}
{"loss": 0.2353060394525528, "acc": 0.932130753993988, "length": 3.6706361770629883, "mode": "test", "epoch": 52}
{"loss": 0.060744576156139374, "acc": 0.9898823499679565, "length": 3.701871395111084, "mode": "train", "epoch": 53}
{"loss": 0.23457376658916473, "acc": 0.9269206523895264, "length": 3.7770140171051025, "mode": "test", "epoch": 53}
{"loss": 0.062122657895088196, "acc": 0.9893612861633301, "length": 3.70094895362854, "mode": "train", "epoch": 54}
{"loss": 0.23359256982803345, "acc": 0.9334827065467834, "length": 3.7371723651885986, "mode": "test", "epoch": 54}
{"loss": 0.059002429246902466, "acc": 0.9903886914253235, "length": 3.7038991451263428, "mode": "train", "epoch": 55}
{"loss": 0.25528857111930847, "acc": 0.9272218346595764, "length": 3.701286792755127, "mode": "test", "epoch": 55}
{"loss": 0.06049911677837372, "acc": 0.9898665547370911, "length": 3.700465202331543, "mode": "train", "epoch": 56}
{"loss": 0.21785622835159302, "acc": 0.9416027665138245, "length": 3.7942774295806885, "mode": "test", "epoch": 56}
{"loss": 0.06148839369416237, "acc": 0.9897192120552063, "length": 3.7135016918182373, "mode": "train", "epoch": 57}
{"loss": 0.23477418720722198, "acc": 0.929417073726654, "length": 3.6968109607696533, "mode": "test", "epoch": 57}
{"loss": 0.059120967984199524, "acc": 0.9905499219894409, "length": 3.707165002822876, "mode": "train", "epoch": 58}
{"loss": 0.2023766040802002, "acc": 0.9456139206886292, "length": 3.7736971378326416, "mode": "test", "epoch": 58}
{"loss": 0.05872803553938866, "acc": 0.990585207939148, "length": 3.7057409286499023, "mode": "train", "epoch": 59}
{"loss": 0.22286638617515564, "acc": 0.9355947971343994, "length": 3.680986166000366, "mode": "test", "epoch": 59}
{"loss": 0.05961226671934128, "acc": 0.9902901649475098, "length": 3.7103233337402344, "mode": "train", "epoch": 60}
{"loss": 0.20493543148040771, "acc": 0.9414777159690857, "length": 3.6793878078460693, "mode": "test", "epoch": 60}
test accuracy: 0.9242611527442932
