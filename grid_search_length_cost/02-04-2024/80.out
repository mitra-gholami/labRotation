ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.3095455765724182, "acc": 0.867906391620636, "length": 3.9230942726135254, "mode": "train", "epoch": 1}
{"loss": 0.2924945652484894, "acc": 0.880261242389679, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.16175992786884308, "acc": 0.9469561576843262, "length": 3.9999732971191406, "mode": "train", "epoch": 2}
{"loss": 0.24808114767074585, "acc": 0.9059911966323853, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.11990074813365936, "acc": 0.9660243988037109, "length": 3.999995708465576, "mode": "train", "epoch": 3}
{"loss": 0.25349265336990356, "acc": 0.9099868535995483, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.09922212362289429, "acc": 0.974589467048645, "length": 3.9999990463256836, "mode": "train", "epoch": 4}
{"loss": 0.240522563457489, "acc": 0.9207077026367188, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.08891719579696655, "acc": 0.9786472916603088, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.3181152045726776, "acc": 0.8914894461631775, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.08256737142801285, "acc": 0.9807806611061096, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.28559523820877075, "acc": 0.9063382744789124, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.07901039719581604, "acc": 0.9805602431297302, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.2933492064476013, "acc": 0.8999519348144531, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.06683485209941864, "acc": 0.9849219918251038, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.2880658507347107, "acc": 0.9140664339065552, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.06255293637514114, "acc": 0.9863439798355103, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.3184259235858917, "acc": 0.9111841917037964, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.05888694152235985, "acc": 0.9874902367591858, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.3411385715007782, "acc": 0.9056603312492371, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.05809352174401283, "acc": 0.9874920845031738, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.35969284176826477, "acc": 0.8920711278915405, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.05651818960905075, "acc": 0.9875896573066711, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.29775747656822205, "acc": 0.9038471579551697, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.04594354331493378, "acc": 0.989841878414154, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.27451643347740173, "acc": 0.9107509851455688, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.03957969322800636, "acc": 0.9922365546226501, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.3464733362197876, "acc": 0.8929879665374756, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.04038690775632858, "acc": 0.9918164610862732, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.3800482451915741, "acc": 0.8864930272102356, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.03718806803226471, "acc": 0.9927855134010315, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.35773324966430664, "acc": 0.890937864780426, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.034700214862823486, "acc": 0.9929805994033813, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.33034059405326843, "acc": 0.8998717069625854, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.030185312032699585, "acc": 0.9938309192657471, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.3337782323360443, "acc": 0.9113507866859436, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.02574334293603897, "acc": 0.9948395490646362, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.43260785937309265, "acc": 0.8913730978965759, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.023477785289287567, "acc": 0.9953591823577881, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.46618780493736267, "acc": 0.8807666301727295, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.022996677085757256, "acc": 0.9952830672264099, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.43940022587776184, "acc": 0.8783917427062988, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.020450223237276077, "acc": 0.9960037469863892, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.4409141540527344, "acc": 0.8881798982620239, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.019875718280673027, "acc": 0.996214747428894, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.45370280742645264, "acc": 0.877741813659668, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.018687346950173378, "acc": 0.9965060353279114, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.465503066778183, "acc": 0.8843871355056763, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.01747969351708889, "acc": 0.9969915747642517, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.5208994746208191, "acc": 0.8728256821632385, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.017782721668481827, "acc": 0.9967531561851501, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.4200819730758667, "acc": 0.8869602084159851, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.016331573948264122, "acc": 0.9972127079963684, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.4504597783088684, "acc": 0.8882541060447693, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.0155014768242836, "acc": 0.9974905252456665, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.4139523506164551, "acc": 0.8870105147361755, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.017035648226737976, "acc": 0.9970410466194153, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.37043866515159607, "acc": 0.8988848924636841, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.016542689874768257, "acc": 0.9971392154693604, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 0.5600735545158386, "acc": 0.866836428642273, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.016243476420640945, "acc": 0.9972981810569763, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.4489773213863373, "acc": 0.8891708850860596, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.01574076898396015, "acc": 0.9973536133766174, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.38663119077682495, "acc": 0.9050604701042175, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.014139196835458279, "acc": 0.9977549910545349, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 0.41132935881614685, "acc": 0.9082638621330261, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.014853925444185734, "acc": 0.9976019859313965, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.5173270106315613, "acc": 0.8876023888587952, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.015474097803235054, "acc": 0.9974217414855957, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.40450024604797363, "acc": 0.9089658856391907, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.015382267534732819, "acc": 0.997455894947052, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.3458247780799866, "acc": 0.9136532545089722, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.013783574104309082, "acc": 0.9978499412536621, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.3447744846343994, "acc": 0.9127568006515503, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.01537581067532301, "acc": 0.9974398016929626, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.345813125371933, "acc": 0.9178773760795593, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.01548262033611536, "acc": 0.9973055124282837, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.36977168917655945, "acc": 0.9080270528793335, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.014055977575480938, "acc": 0.9977824091911316, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.47196781635284424, "acc": 0.8874058127403259, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.01646140217781067, "acc": 0.9972213506698608, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.30228105187416077, "acc": 0.9157713055610657, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.013722728006541729, "acc": 0.9979079961776733, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.4311661720275879, "acc": 0.8929756879806519, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.014022327028214931, "acc": 0.9977930784225464, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.37255388498306274, "acc": 0.9117156863212585, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.014829345047473907, "acc": 0.9975601434707642, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.34005099534988403, "acc": 0.9135590195655823, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.015582886524498463, "acc": 0.9973850250244141, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.38799113035202026, "acc": 0.9062601327896118, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.015040384605526924, "acc": 0.99744713306427, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.3457048237323761, "acc": 0.9181161522865295, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.014531849883496761, "acc": 0.9976582527160645, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.3192547857761383, "acc": 0.9209643006324768, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.015384670346975327, "acc": 0.9974899291992188, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.30083364248275757, "acc": 0.9189284443855286, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.014969217590987682, "acc": 0.997470498085022, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.3543810546398163, "acc": 0.9140425324440002, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.01653563790023327, "acc": 0.9971485137939453, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.3847019672393799, "acc": 0.9045771360397339, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.015252743847668171, "acc": 0.9973388910293579, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.3110705018043518, "acc": 0.9094793200492859, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.01549062691628933, "acc": 0.9974010586738586, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.33006471395492554, "acc": 0.9104100465774536, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.01662348210811615, "acc": 0.9970624446868896, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.27912309765815735, "acc": 0.9267449378967285, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.015903770923614502, "acc": 0.997340977191925, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.24135611951351166, "acc": 0.939407467842102, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.015466957353055477, "acc": 0.997421145439148, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.35015618801116943, "acc": 0.9165076017379761, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.01576947793364525, "acc": 0.9972608089447021, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.2673734724521637, "acc": 0.9280888438224792, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.016083458438515663, "acc": 0.9972100853919983, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.3076927959918976, "acc": 0.9218189120292664, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.016585620120167732, "acc": 0.9970905184745789, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.25278618931770325, "acc": 0.927531361579895, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.017371146008372307, "acc": 0.9969928860664368, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.2493678480386734, "acc": 0.9341341853141785, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.015518770553171635, "acc": 0.997412383556366, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.26193559169769287, "acc": 0.9316331148147583, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9365422129631042
