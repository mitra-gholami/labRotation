ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.6932628750801086, "acc": 0.5290588140487671, "length": 3.5539870262145996, "mode": "train", "epoch": 1}
{"loss": 0.6611709594726562, "acc": 0.6072781085968018, "length": 2.008680582046509, "mode": "test", "epoch": 1}
{"loss": 0.579723596572876, "acc": 0.7005788087844849, "length": 3.689606189727783, "mode": "train", "epoch": 2}
{"loss": 0.6207957863807678, "acc": 0.7313802242279053, "length": 4.920138835906982, "mode": "test", "epoch": 2}
{"loss": 0.4734121859073639, "acc": 0.7887057065963745, "length": 3.865305185317993, "mode": "train", "epoch": 3}
{"loss": 0.49639639258384705, "acc": 0.7861409783363342, "length": 2.9635417461395264, "mode": "test", "epoch": 3}
{"loss": 0.43735238909721375, "acc": 0.8078727126121521, "length": 3.624844789505005, "mode": "train", "epoch": 4}
{"loss": 0.4812077283859253, "acc": 0.7892415523529053, "length": 3.34375, "mode": "test", "epoch": 4}
{"loss": 0.3831239640712738, "acc": 0.8326779007911682, "length": 4.33395528793335, "mode": "train", "epoch": 5}
{"loss": 0.40064242482185364, "acc": 0.8357802033424377, "length": 4.61631965637207, "mode": "test", "epoch": 5}
{"loss": 0.32251009345054626, "acc": 0.8666037321090698, "length": 5.144911289215088, "mode": "train", "epoch": 6}
{"loss": 0.361709862947464, "acc": 0.8519694209098816, "length": 4.99131965637207, "mode": "test", "epoch": 6}
{"loss": 0.28932246565818787, "acc": 0.883976936340332, "length": 5.407721996307373, "mode": "train", "epoch": 7}
{"loss": 0.31760215759277344, "acc": 0.8722682595252991, "length": 4.94444465637207, "mode": "test", "epoch": 7}
{"loss": 0.25336742401123047, "acc": 0.8985076546669006, "length": 5.754012584686279, "mode": "train", "epoch": 8}
{"loss": 0.28169742226600647, "acc": 0.8886799216270447, "length": 5.52430534362793, "mode": "test", "epoch": 8}
{"loss": 0.2255011945962906, "acc": 0.9124377965927124, "length": 6.128198623657227, "mode": "train", "epoch": 9}
{"loss": 0.2533101737499237, "acc": 0.8988497853279114, "length": 6.239583492279053, "mode": "test", "epoch": 9}
{"loss": 0.20482085645198822, "acc": 0.9209608435630798, "length": 6.244749069213867, "mode": "train", "epoch": 10}
{"loss": 0.2557829022407532, "acc": 0.8980523347854614, "length": 6.114583492279053, "mode": "test", "epoch": 10}
{"loss": 0.18766430020332336, "acc": 0.9310669898986816, "length": 6.758628845214844, "mode": "train", "epoch": 11}
{"loss": 0.2362234890460968, "acc": 0.9142930507659912, "length": 6.638888835906982, "mode": "test", "epoch": 11}
{"loss": 0.1797875314950943, "acc": 0.9362368583679199, "length": 6.997964382171631, "mode": "train", "epoch": 12}
{"loss": 0.23992320895195007, "acc": 0.9049072265625, "length": 7.234375, "mode": "test", "epoch": 12}
{"loss": 0.15939070284366608, "acc": 0.9444639086723328, "length": 7.385870933532715, "mode": "train", "epoch": 13}
{"loss": 0.20791032910346985, "acc": 0.9202473759651184, "length": 7.213541507720947, "mode": "test", "epoch": 13}
{"loss": 0.14974895119667053, "acc": 0.9475937485694885, "length": 7.710946559906006, "mode": "train", "epoch": 14}
{"loss": 0.22492411732673645, "acc": 0.9212185740470886, "length": 7.65625, "mode": "test", "epoch": 14}
{"loss": 0.1415671855211258, "acc": 0.9520938396453857, "length": 7.783515453338623, "mode": "train", "epoch": 15}
{"loss": 0.22864937782287598, "acc": 0.9136312007904053, "length": 7.390625, "mode": "test", "epoch": 15}
{"loss": 0.13224802911281586, "acc": 0.9542576670646667, "length": 7.648990154266357, "mode": "train", "epoch": 16}
{"loss": 0.2004951536655426, "acc": 0.9329535365104675, "length": 7.807291507720947, "mode": "test", "epoch": 16}
{"loss": 0.12157151103019714, "acc": 0.9606817960739136, "length": 8.112015724182129, "mode": "train", "epoch": 17}
{"loss": 0.17497995495796204, "acc": 0.9448160529136658, "length": 7.78993034362793, "mode": "test", "epoch": 17}
{"loss": 0.12265187501907349, "acc": 0.9590839743614197, "length": 8.168173789978027, "mode": "train", "epoch": 18}
{"loss": 0.19510489702224731, "acc": 0.9281737804412842, "length": 8.010416984558105, "mode": "test", "epoch": 18}
{"loss": 0.10531902313232422, "acc": 0.9649414420127869, "length": 8.035962104797363, "mode": "train", "epoch": 19}
{"loss": 0.19889189302921295, "acc": 0.9239637851715088, "length": 7.953125, "mode": "test", "epoch": 19}
{"loss": 0.10650923103094101, "acc": 0.9646050930023193, "length": 7.951991558074951, "mode": "train", "epoch": 20}
{"loss": 0.1517162322998047, "acc": 0.9474961757659912, "length": 8.05555534362793, "mode": "test", "epoch": 20}
{"loss": 0.09585385769605637, "acc": 0.9701205492019653, "length": 8.90417766571045, "mode": "train", "epoch": 21}
{"loss": 0.1522550880908966, "acc": 0.9433186650276184, "length": 9.00173568725586, "mode": "test", "epoch": 21}
{"loss": 0.08422572910785675, "acc": 0.9758427143096924, "length": 9.268052101135254, "mode": "train", "epoch": 22}
{"loss": 0.17372830212116241, "acc": 0.9490261077880859, "length": 8.74131965637207, "mode": "test", "epoch": 22}
{"loss": 0.08646536618471146, "acc": 0.9734880924224854, "length": 8.220563888549805, "mode": "train", "epoch": 23}
{"loss": 0.14969570934772491, "acc": 0.9503770470619202, "length": 8.307291984558105, "mode": "test", "epoch": 23}
{"loss": 0.07538039237260818, "acc": 0.9791041016578674, "length": 8.410812377929688, "mode": "train", "epoch": 24}
{"loss": 0.12945570051670074, "acc": 0.9543185830116272, "length": 8.39236068725586, "mode": "test", "epoch": 24}
{"loss": 0.07532185316085815, "acc": 0.9786259531974792, "length": 8.728187561035156, "mode": "train", "epoch": 25}
{"loss": 0.10436379164457321, "acc": 0.9667398929595947, "length": 8.27256965637207, "mode": "test", "epoch": 25}
{"loss": 0.06774023920297623, "acc": 0.9815547466278076, "length": 8.8580961227417, "mode": "train", "epoch": 26}
{"loss": 0.09744947403669357, "acc": 0.9726047515869141, "length": 8.598958015441895, "mode": "test", "epoch": 26}
{"loss": 0.06561297923326492, "acc": 0.9830754399299622, "length": 9.086968421936035, "mode": "train", "epoch": 27}
{"loss": 0.10963783413171768, "acc": 0.9680446982383728, "length": 9.45138931274414, "mode": "test", "epoch": 27}
{"loss": 0.06199328601360321, "acc": 0.9845142364501953, "length": 9.361176490783691, "mode": "train", "epoch": 28}
{"loss": 0.1317235827445984, "acc": 0.9628120064735413, "length": 9.6875, "mode": "test", "epoch": 28}
{"loss": 0.05650951713323593, "acc": 0.98597651720047, "length": 9.503135681152344, "mode": "train", "epoch": 29}
{"loss": 0.08369359374046326, "acc": 0.9745007753372192, "length": 9.144097328186035, "mode": "test", "epoch": 29}
{"loss": 0.05620453506708145, "acc": 0.9870746731758118, "length": 9.64989948272705, "mode": "train", "epoch": 30}
{"loss": 0.1450168788433075, "acc": 0.9417588710784912, "length": 9.85069465637207, "mode": "test", "epoch": 30}
{"loss": 0.06559499353170395, "acc": 0.9833333492279053, "length": 9.500778198242188, "mode": "train", "epoch": 31}
{"loss": 0.12852488458156586, "acc": 0.9604817628860474, "length": 8.73611068725586, "mode": "test", "epoch": 31}
{"loss": 0.05887231230735779, "acc": 0.9839314818382263, "length": 9.264664649963379, "mode": "train", "epoch": 32}
{"loss": 0.09851832687854767, "acc": 0.9666748046875, "length": 9.546875, "mode": "test", "epoch": 32}
{"loss": 0.04392135888338089, "acc": 0.9913634061813354, "length": 9.635621070861816, "mode": "train", "epoch": 33}
{"loss": 0.09234222769737244, "acc": 0.9741183519363403, "length": 9.62326431274414, "mode": "test", "epoch": 33}
{"loss": 0.040120963007211685, "acc": 0.9931600093841553, "length": 9.877959251403809, "mode": "train", "epoch": 34}
{"loss": 0.1339968889951706, "acc": 0.9636746644973755, "length": 9.81944465637207, "mode": "test", "epoch": 34}
{"loss": 0.039603449404239655, "acc": 0.9931122064590454, "length": 9.865569114685059, "mode": "train", "epoch": 35}
{"loss": 0.06766481697559357, "acc": 0.9822917580604553, "length": 9.6875, "mode": "test", "epoch": 35}
{"loss": 0.040275365114212036, "acc": 0.9928826093673706, "length": 9.893301963806152, "mode": "train", "epoch": 36}
{"loss": 0.09249617159366608, "acc": 0.9730984568595886, "length": 9.70486068725586, "mode": "test", "epoch": 36}
{"loss": 0.04965904355049133, "acc": 0.988387942314148, "length": 9.75527286529541, "mode": "train", "epoch": 37}
{"loss": 0.09942473471164703, "acc": 0.9704427719116211, "length": 9.53819465637207, "mode": "test", "epoch": 37}
{"loss": 0.04554926976561546, "acc": 0.9902886152267456, "length": 9.684779167175293, "mode": "train", "epoch": 38}
{"loss": 0.09276039153337479, "acc": 0.975621223449707, "length": 9.770833015441895, "mode": "test", "epoch": 38}
{"loss": 0.03501438722014427, "acc": 0.9946590065956116, "length": 9.83043098449707, "mode": "train", "epoch": 39}
{"loss": 0.06568485498428345, "acc": 0.9830105304718018, "length": 9.432291984558105, "mode": "test", "epoch": 39}
{"loss": 0.035790782421827316, "acc": 0.9937745332717896, "length": 9.855278968811035, "mode": "train", "epoch": 40}
{"loss": 0.07451024651527405, "acc": 0.9792807102203369, "length": 10.041666984558105, "mode": "test", "epoch": 40}
{"loss": 0.04979539290070534, "acc": 0.9880753755569458, "length": 10.18244743347168, "mode": "train", "epoch": 41}
{"loss": 0.07214958965778351, "acc": 0.9808837175369263, "length": 10.02951431274414, "mode": "test", "epoch": 41}
{"loss": 0.03510754182934761, "acc": 0.9940992593765259, "length": 10.24109935760498, "mode": "train", "epoch": 42}
{"loss": 0.06110324338078499, "acc": 0.9866211414337158, "length": 9.86805534362793, "mode": "test", "epoch": 42}
{"loss": 0.030583463609218597, "acc": 0.9958333969116211, "length": 10.126500129699707, "mode": "train", "epoch": 43}
{"loss": 0.07539834082126617, "acc": 0.9811145067214966, "length": 10.097222328186035, "mode": "test", "epoch": 43}
{"loss": 0.04302266612648964, "acc": 0.991193413734436, "length": 9.894844055175781, "mode": "train", "epoch": 44}
{"loss": 0.08821982145309448, "acc": 0.9787380695343018, "length": 9.708333015441895, "mode": "test", "epoch": 44}
{"loss": 0.03348388895392418, "acc": 0.9946029782295227, "length": 10.111992835998535, "mode": "train", "epoch": 45}
{"loss": 0.0820261612534523, "acc": 0.975225031375885, "length": 10.12326431274414, "mode": "test", "epoch": 45}
{"loss": 0.03001091443002224, "acc": 0.9958153963088989, "length": 9.994729042053223, "mode": "train", "epoch": 46}
{"loss": 0.06617380678653717, "acc": 0.9828586578369141, "length": 9.85243034362793, "mode": "test", "epoch": 46}
{"loss": 0.028859388083219528, "acc": 0.9965848326683044, "length": 9.974321365356445, "mode": "train", "epoch": 47}
{"loss": 0.07187402248382568, "acc": 0.9835827946662903, "length": 9.78993034362793, "mode": "test", "epoch": 47}
{"loss": 0.028825366869568825, "acc": 0.9955856800079346, "length": 9.655457496643066, "mode": "train", "epoch": 48}
{"loss": 0.05492983013391495, "acc": 0.9862847924232483, "length": 9.510416984558105, "mode": "test", "epoch": 48}
{"loss": 0.03921137750148773, "acc": 0.9921935796737671, "length": 9.568817138671875, "mode": "train", "epoch": 49}
{"loss": 0.06201044097542763, "acc": 0.9854438304901123, "length": 9.222222328186035, "mode": "test", "epoch": 49}
{"loss": 0.024463895708322525, "acc": 0.9976189732551575, "length": 9.597972869873047, "mode": "train", "epoch": 50}
{"loss": 0.049600325524806976, "acc": 0.9895914793014526, "length": 9.614583015441895, "mode": "test", "epoch": 50}
{"loss": 0.02158021740615368, "acc": 0.9985537528991699, "length": 9.871916770935059, "mode": "train", "epoch": 51}
{"loss": 0.04948681592941284, "acc": 0.9892632961273193, "length": 9.793402671813965, "mode": "test", "epoch": 51}
{"loss": 0.019981253892183304, "acc": 0.9989036321640015, "length": 9.863996505737305, "mode": "train", "epoch": 52}
{"loss": 0.041066691279411316, "acc": 0.9918294548988342, "length": 9.43923568725586, "mode": "test", "epoch": 52}
{"loss": 0.019096285104751587, "acc": 0.9991177320480347, "length": 9.616764068603516, "mode": "train", "epoch": 53}
{"loss": 0.04488776996731758, "acc": 0.9911432266235352, "length": 9.33680534362793, "mode": "test", "epoch": 53}
{"loss": 0.027319855988025665, "acc": 0.9956653118133545, "length": 9.838552474975586, "mode": "train", "epoch": 54}
{"loss": 0.05307234078645706, "acc": 0.9872098565101624, "length": 9.651041984558105, "mode": "test", "epoch": 54}
{"loss": 0.02345994859933853, "acc": 0.9971812963485718, "length": 9.957290649414062, "mode": "train", "epoch": 55}
{"loss": 0.05067847669124603, "acc": 0.9890082478523254, "length": 9.932291984558105, "mode": "test", "epoch": 55}
{"loss": 0.018757494166493416, "acc": 0.9992918968200684, "length": 9.65758228302002, "mode": "train", "epoch": 56}
{"loss": 0.04132214933633804, "acc": 0.9935872554779053, "length": 9.197916984558105, "mode": "test", "epoch": 56}
{"loss": 0.0232511218637228, "acc": 0.9974707961082458, "length": 9.840559959411621, "mode": "train", "epoch": 57}
{"loss": 0.05578811839222908, "acc": 0.9871147871017456, "length": 10.09548568725586, "mode": "test", "epoch": 57}
{"loss": 0.03822696954011917, "acc": 0.9924705028533936, "length": 10.09428882598877, "mode": "train", "epoch": 58}
{"loss": 0.0732201412320137, "acc": 0.9790663123130798, "length": 9.8125, "mode": "test", "epoch": 58}
{"loss": 0.026140552014112473, "acc": 0.9958980679512024, "length": 9.394133567810059, "mode": "train", "epoch": 59}
{"loss": 0.047285761684179306, "acc": 0.988525390625, "length": 8.89930534362793, "mode": "test", "epoch": 59}
{"loss": 0.029260776937007904, "acc": 0.9948392510414124, "length": 8.937333106994629, "mode": "train", "epoch": 60}
{"loss": 0.06909342110157013, "acc": 0.9803711771965027, "length": 8.65451431274414, "mode": "test", "epoch": 60}
test accuracy: 0.825583279132843
