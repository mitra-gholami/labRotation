ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.7158641815185547, "acc": 0.5065975785255432, "length": 3.8828537464141846, "mode": "train", "epoch": 1}
{"loss": 0.6993377208709717, "acc": 0.5040798187255859, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6871808171272278, "acc": 0.560174286365509, "length": 1.3959681987762451, "mode": "train", "epoch": 2}
{"loss": 0.664369523525238, "acc": 0.5935356616973877, "length": 1.3055555820465088, "mode": "test", "epoch": 2}
{"loss": 0.6180309653282166, "acc": 0.6548423767089844, "length": 1.9289119243621826, "mode": "train", "epoch": 3}
{"loss": 0.6256083846092224, "acc": 0.6527370810508728, "length": 1.2673611640930176, "mode": "test", "epoch": 3}
{"loss": 0.583528995513916, "acc": 0.6963348388671875, "length": 1.8026835918426514, "mode": "train", "epoch": 4}
{"loss": 0.6037457585334778, "acc": 0.6699842214584351, "length": 1.5746527910232544, "mode": "test", "epoch": 4}
{"loss": 0.5340837836265564, "acc": 0.7411755323410034, "length": 2.029076099395752, "mode": "train", "epoch": 5}
{"loss": 0.5474419593811035, "acc": 0.7329834699630737, "length": 1.7708333730697632, "mode": "test", "epoch": 5}
{"loss": 0.5119326114654541, "acc": 0.7637683153152466, "length": 2.0266757011413574, "mode": "train", "epoch": 6}
{"loss": 0.5447849631309509, "acc": 0.738633930683136, "length": 1.8263888359069824, "mode": "test", "epoch": 6}
{"loss": 0.4926600754261017, "acc": 0.7787526249885559, "length": 2.126065492630005, "mode": "train", "epoch": 7}
{"loss": 0.5255436897277832, "acc": 0.7574083805084229, "length": 2.006944417953491, "mode": "test", "epoch": 7}
{"loss": 0.4437081217765808, "acc": 0.8087435364723206, "length": 2.387694835662842, "mode": "train", "epoch": 8}
{"loss": 0.5007877945899963, "acc": 0.7708550095558167, "length": 2.1458332538604736, "mode": "test", "epoch": 8}
{"loss": 0.41039934754371643, "acc": 0.8279324173927307, "length": 2.3871753215789795, "mode": "train", "epoch": 9}
{"loss": 0.487792432308197, "acc": 0.7811903357505798, "length": 2.1579861640930176, "mode": "test", "epoch": 9}
{"loss": 0.38760313391685486, "acc": 0.84449702501297, "length": 2.3621504306793213, "mode": "train", "epoch": 10}
{"loss": 0.4472620189189911, "acc": 0.8196777105331421, "length": 2.105902671813965, "mode": "test", "epoch": 10}
{"loss": 0.3706296980381012, "acc": 0.8543230891227722, "length": 2.364851474761963, "mode": "train", "epoch": 11}
{"loss": 0.44619104266166687, "acc": 0.8280842304229736, "length": 2.038194417953491, "mode": "test", "epoch": 11}
{"loss": 0.35685649514198303, "acc": 0.8628860116004944, "length": 2.357086420059204, "mode": "train", "epoch": 12}
{"loss": 0.4451172649860382, "acc": 0.8324407935142517, "length": 2.0677082538604736, "mode": "test", "epoch": 12}
{"loss": 0.34304553270339966, "acc": 0.8661778569221497, "length": 2.387779951095581, "mode": "train", "epoch": 13}
{"loss": 0.41470369696617126, "acc": 0.8395915031433105, "length": 2.269097328186035, "mode": "test", "epoch": 13}
{"loss": 0.3289014399051666, "acc": 0.8717207908630371, "length": 2.5822396278381348, "mode": "train", "epoch": 14}
{"loss": 0.4165618121623993, "acc": 0.8392279148101807, "length": 2.3298611640930176, "mode": "test", "epoch": 14}
{"loss": 0.3121913969516754, "acc": 0.8824561238288879, "length": 2.7288668155670166, "mode": "train", "epoch": 15}
{"loss": 0.3865130543708801, "acc": 0.8520290851593018, "length": 2.890625, "mode": "test", "epoch": 15}
{"loss": 0.2855217754840851, "acc": 0.8942413926124573, "length": 2.903859853744507, "mode": "train", "epoch": 16}
{"loss": 0.34254416823387146, "acc": 0.8722249269485474, "length": 2.788194417953491, "mode": "test", "epoch": 16}
{"loss": 0.2688154876232147, "acc": 0.9044082760810852, "length": 2.9455277919769287, "mode": "train", "epoch": 17}
{"loss": 0.3329485356807709, "acc": 0.8818278312683105, "length": 2.784722328186035, "mode": "test", "epoch": 17}
{"loss": 0.2521703243255615, "acc": 0.9099269509315491, "length": 2.9522364139556885, "mode": "train", "epoch": 18}
{"loss": 0.3062610626220703, "acc": 0.8909640908241272, "length": 2.805555582046509, "mode": "test", "epoch": 18}
{"loss": 0.2378639429807663, "acc": 0.9191588163375854, "length": 2.992603302001953, "mode": "train", "epoch": 19}
{"loss": 0.29212844371795654, "acc": 0.8923448920249939, "length": 2.8229167461395264, "mode": "test", "epoch": 19}
{"loss": 0.23550046980381012, "acc": 0.918766438961029, "length": 2.991706609725952, "mode": "train", "epoch": 20}
{"loss": 0.28509387373924255, "acc": 0.8966850638389587, "length": 2.7013888359069824, "mode": "test", "epoch": 20}
{"loss": 0.2226865440607071, "acc": 0.9245567321777344, "length": 2.9512367248535156, "mode": "train", "epoch": 21}
{"loss": 0.2719091773033142, "acc": 0.9018853306770325, "length": 2.9114582538604736, "mode": "test", "epoch": 21}
{"loss": 0.212855264544487, "acc": 0.9278131127357483, "length": 3.0654921531677246, "mode": "train", "epoch": 22}
{"loss": 0.2640933096408844, "acc": 0.9063557386398315, "length": 2.9479167461395264, "mode": "test", "epoch": 22}
{"loss": 0.2065795361995697, "acc": 0.9294916391372681, "length": 3.1442463397979736, "mode": "train", "epoch": 23}
{"loss": 0.2551257312297821, "acc": 0.9064859747886658, "length": 2.953125, "mode": "test", "epoch": 23}
{"loss": 0.19360151886940002, "acc": 0.9364710450172424, "length": 3.1840341091156006, "mode": "train", "epoch": 24}
{"loss": 0.2532122731208801, "acc": 0.9134521484375, "length": 3.0486111640930176, "mode": "test", "epoch": 24}
{"loss": 0.18703201413154602, "acc": 0.9380418658256531, "length": 3.302955389022827, "mode": "train", "epoch": 25}
{"loss": 0.24153079092502594, "acc": 0.9213134050369263, "length": 3.0798611640930176, "mode": "test", "epoch": 25}
{"loss": 0.17604947090148926, "acc": 0.9421886205673218, "length": 3.3291664123535156, "mode": "train", "epoch": 26}
{"loss": 0.22909069061279297, "acc": 0.922100305557251, "length": 3.288194417953491, "mode": "test", "epoch": 26}
{"loss": 0.17080064117908478, "acc": 0.9445870518684387, "length": 3.4742190837860107, "mode": "train", "epoch": 27}
{"loss": 0.23690634965896606, "acc": 0.9231960773468018, "length": 3.210069417953491, "mode": "test", "epoch": 27}
{"loss": 0.16533054411411285, "acc": 0.9479103088378906, "length": 3.440046548843384, "mode": "train", "epoch": 28}
{"loss": 0.20840924978256226, "acc": 0.9309868216514587, "length": 3.397569417953491, "mode": "test", "epoch": 28}
{"loss": 0.15470781922340393, "acc": 0.9503985047340393, "length": 3.5416312217712402, "mode": "train", "epoch": 29}
{"loss": 0.19654585421085358, "acc": 0.9373400211334229, "length": 3.4548611640930176, "mode": "test", "epoch": 29}
{"loss": 0.14681200683116913, "acc": 0.9535627365112305, "length": 3.6036911010742188, "mode": "train", "epoch": 30}
{"loss": 0.1934337466955185, "acc": 0.9340114593505859, "length": 3.381944417953491, "mode": "test", "epoch": 30}
{"loss": 0.14305834472179413, "acc": 0.9557685852050781, "length": 3.6285746097564697, "mode": "train", "epoch": 31}
{"loss": 0.18858246505260468, "acc": 0.9385553002357483, "length": 3.335069417953491, "mode": "test", "epoch": 31}
{"loss": 0.1340436488389969, "acc": 0.9594817161560059, "length": 3.5639400482177734, "mode": "train", "epoch": 32}
{"loss": 0.17799587547779083, "acc": 0.9450249075889587, "length": 3.390625, "mode": "test", "epoch": 32}
{"loss": 0.1297498196363449, "acc": 0.9614324569702148, "length": 3.6173088550567627, "mode": "train", "epoch": 33}
{"loss": 0.18060284852981567, "acc": 0.9438069462776184, "length": 3.4236111640930176, "mode": "test", "epoch": 33}
{"loss": 0.12378447502851486, "acc": 0.9642801284790039, "length": 3.6156439781188965, "mode": "train", "epoch": 34}
{"loss": 0.16144874691963196, "acc": 0.9500217437744141, "length": 3.503472328186035, "mode": "test", "epoch": 34}
{"loss": 0.11600945144891739, "acc": 0.96572345495224, "length": 3.6445517539978027, "mode": "train", "epoch": 35}
{"loss": 0.1510215401649475, "acc": 0.9528184533119202, "length": 3.4166667461395264, "mode": "test", "epoch": 35}
{"loss": 0.11617588996887207, "acc": 0.9652054905891418, "length": 3.6106040477752686, "mode": "train", "epoch": 36}
{"loss": 0.1675935983657837, "acc": 0.9441840052604675, "length": 3.40625, "mode": "test", "epoch": 36}
{"loss": 0.11382169276475906, "acc": 0.9670172929763794, "length": 3.650409698486328, "mode": "train", "epoch": 37}
{"loss": 0.14943979680538177, "acc": 0.9568902254104614, "length": 3.519097328186035, "mode": "test", "epoch": 37}
{"loss": 0.10368504375219345, "acc": 0.9709649085998535, "length": 3.61847186088562, "mode": "train", "epoch": 38}
{"loss": 0.15761926770210266, "acc": 0.9511637091636658, "length": 3.425347328186035, "mode": "test", "epoch": 38}
{"loss": 0.10374148190021515, "acc": 0.9711659550666809, "length": 3.614941358566284, "mode": "train", "epoch": 39}
{"loss": 0.14695021510124207, "acc": 0.9590413570404053, "length": 3.5173611640930176, "mode": "test", "epoch": 39}
{"loss": 0.09854248911142349, "acc": 0.9731855988502502, "length": 3.6783573627471924, "mode": "train", "epoch": 40}
{"loss": 0.14325211942195892, "acc": 0.9568116068840027, "length": 3.515625, "mode": "test", "epoch": 40}
{"loss": 0.09184085577726364, "acc": 0.9771572351455688, "length": 3.689577102661133, "mode": "train", "epoch": 41}
{"loss": 0.13030435144901276, "acc": 0.963623046875, "length": 3.602430582046509, "mode": "test", "epoch": 41}
{"loss": 0.09148602932691574, "acc": 0.9771227836608887, "length": 3.7217752933502197, "mode": "train", "epoch": 42}
{"loss": 0.12738318741321564, "acc": 0.9638400673866272, "length": 3.618055582046509, "mode": "test", "epoch": 42}
{"loss": 0.08512590080499649, "acc": 0.9783008694648743, "length": 3.7221648693084717, "mode": "train", "epoch": 43}
{"loss": 0.1308876872062683, "acc": 0.9657281041145325, "length": 3.581597328186035, "mode": "test", "epoch": 43}
{"loss": 0.08097831159830093, "acc": 0.9810214042663574, "length": 3.7278573513031006, "mode": "train", "epoch": 44}
{"loss": 0.12403164803981781, "acc": 0.9651286005973816, "length": 3.5295138359069824, "mode": "test", "epoch": 44}
{"loss": 0.07958868891000748, "acc": 0.981532871723175, "length": 3.7726078033447266, "mode": "train", "epoch": 45}
{"loss": 0.12868493795394897, "acc": 0.9691948294639587, "length": 3.7013888359069824, "mode": "test", "epoch": 45}
{"loss": 0.07795926183462143, "acc": 0.9815053939819336, "length": 3.766491413116455, "mode": "train", "epoch": 46}
{"loss": 0.12060149759054184, "acc": 0.9687038064002991, "length": 3.6857638359069824, "mode": "test", "epoch": 46}
{"loss": 0.07571438699960709, "acc": 0.9825918078422546, "length": 3.806500196456909, "mode": "train", "epoch": 47}
{"loss": 0.11699798703193665, "acc": 0.9729573726654053, "length": 3.621527671813965, "mode": "test", "epoch": 47}
{"loss": 0.06977932155132294, "acc": 0.984847903251648, "length": 3.784146785736084, "mode": "train", "epoch": 48}
{"loss": 0.09592457860708237, "acc": 0.9788764119148254, "length": 3.7395832538604736, "mode": "test", "epoch": 48}
{"loss": 0.06942865997552872, "acc": 0.9854292273521423, "length": 3.823763370513916, "mode": "train", "epoch": 49}
{"loss": 0.09905198961496353, "acc": 0.9788872599601746, "length": 3.7326388359069824, "mode": "test", "epoch": 49}
{"loss": 0.06606938689947128, "acc": 0.9866110682487488, "length": 3.8534083366394043, "mode": "train", "epoch": 50}
{"loss": 0.11702889949083328, "acc": 0.9730984568595886, "length": 3.756944417953491, "mode": "test", "epoch": 50}
{"loss": 0.06689517199993134, "acc": 0.9860712289810181, "length": 3.8831064701080322, "mode": "train", "epoch": 51}
{"loss": 0.10103238373994827, "acc": 0.9802896976470947, "length": 3.824652671813965, "mode": "test", "epoch": 51}
{"loss": 0.07034274190664291, "acc": 0.9843629002571106, "length": 3.855719804763794, "mode": "train", "epoch": 52}
{"loss": 0.1031302884221077, "acc": 0.978917121887207, "length": 3.772569417953491, "mode": "test", "epoch": 52}
{"loss": 0.058128274977207184, "acc": 0.9886566400527954, "length": 3.797159433364868, "mode": "train", "epoch": 53}
{"loss": 0.08331718295812607, "acc": 0.9851752519607544, "length": 3.710069417953491, "mode": "test", "epoch": 53}
{"loss": 0.05591920018196106, "acc": 0.989776611328125, "length": 3.7954039573669434, "mode": "train", "epoch": 54}
{"loss": 0.07998479902744293, "acc": 0.9837971925735474, "length": 3.7083332538604736, "mode": "test", "epoch": 54}
{"loss": 0.05507632717490196, "acc": 0.9899168014526367, "length": 3.8059165477752686, "mode": "train", "epoch": 55}
{"loss": 0.08364894241094589, "acc": 0.9854221343994141, "length": 3.7170138359069824, "mode": "test", "epoch": 55}
{"loss": 0.05621301755309105, "acc": 0.989278256893158, "length": 3.7902774810791016, "mode": "train", "epoch": 56}
{"loss": 0.09110972285270691, "acc": 0.9837862849235535, "length": 3.706597328186035, "mode": "test", "epoch": 56}
{"loss": 0.0646381601691246, "acc": 0.9854617714881897, "length": 3.789964199066162, "mode": "train", "epoch": 57}
{"loss": 0.07898181676864624, "acc": 0.9818115234375, "length": 3.725694417953491, "mode": "test", "epoch": 57}
{"loss": 0.06531829386949539, "acc": 0.9853242039680481, "length": 3.7653958797454834, "mode": "train", "epoch": 58}
{"loss": 0.07301585376262665, "acc": 0.9850695133209229, "length": 3.6701388359069824, "mode": "test", "epoch": 58}
{"loss": 0.06243154779076576, "acc": 0.9871441721916199, "length": 3.8214123249053955, "mode": "train", "epoch": 59}
{"loss": 0.07447225600481033, "acc": 0.9849039912223816, "length": 3.699652671813965, "mode": "test", "epoch": 59}
{"loss": 0.05597314611077309, "acc": 0.9895653128623962, "length": 3.7541377544403076, "mode": "train", "epoch": 60}
{"loss": 0.06810231506824493, "acc": 0.9866021275520325, "length": 3.6822917461395264, "mode": "test", "epoch": 60}
test accuracy: 0.8172643184661865
