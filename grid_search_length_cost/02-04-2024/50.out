ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 3
{"loss": 0.335575670003891, "acc": 0.852327287197113, "length": 3.872286319732666, "mode": "train", "epoch": 1}
{"loss": 0.3992909789085388, "acc": 0.8258577585220337, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.17994868755340576, "acc": 0.9453386068344116, "length": 3.999995231628418, "mode": "train", "epoch": 2}
{"loss": 0.3356150686740875, "acc": 0.8599482774734497, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.14328812062740326, "acc": 0.9618538618087769, "length": 4.0, "mode": "train", "epoch": 3}
{"loss": 0.23711875081062317, "acc": 0.9135434031486511, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.12817956507205963, "acc": 0.9666085243225098, "length": 4.0, "mode": "train", "epoch": 4}
{"loss": 0.21746434271335602, "acc": 0.9250108003616333, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.11702000349760056, "acc": 0.9705607891082764, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.18267697095870972, "acc": 0.9410125017166138, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.10882820188999176, "acc": 0.9731065034866333, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.18033571541309357, "acc": 0.9402140378952026, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.10222514718770981, "acc": 0.9755724668502808, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.167974054813385, "acc": 0.9457991123199463, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.09710925072431564, "acc": 0.9771012663841248, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.17447084188461304, "acc": 0.9461342692375183, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.09368010610342026, "acc": 0.9780077934265137, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.1449885219335556, "acc": 0.9584359526634216, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.08895837515592575, "acc": 0.9799564480781555, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.14297990500926971, "acc": 0.9565401673316956, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.08631511777639389, "acc": 0.9806588292121887, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.1230650544166565, "acc": 0.9661512970924377, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.08565954864025116, "acc": 0.9807331562042236, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.11767878383398056, "acc": 0.9687302112579346, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.08137206733226776, "acc": 0.9817796945571899, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.10305057466030121, "acc": 0.9726842641830444, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.0775819793343544, "acc": 0.9830453395843506, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.10253866016864777, "acc": 0.9735617637634277, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.07447373121976852, "acc": 0.983998715877533, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.09600961953401566, "acc": 0.9765499830245972, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.072145015001297, "acc": 0.9846600294113159, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.08359179645776749, "acc": 0.9819476008415222, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.07087496668100357, "acc": 0.984795868396759, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.08392689377069473, "acc": 0.9795793890953064, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.0661778599023819, "acc": 0.9861637353897095, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.07515143603086472, "acc": 0.983690083026886, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.0649448111653328, "acc": 0.9864736795425415, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.08122503012418747, "acc": 0.9815888404846191, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.06278398633003235, "acc": 0.9870683550834656, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.0788969174027443, "acc": 0.9816176891326904, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.06170374155044556, "acc": 0.9875412583351135, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.07713153958320618, "acc": 0.9827980995178223, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.061239853501319885, "acc": 0.9876739382743835, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.07018925994634628, "acc": 0.9847246408462524, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.06166229769587517, "acc": 0.9875032305717468, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.06630030274391174, "acc": 0.9862908124923706, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.06120758876204491, "acc": 0.9875832796096802, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.06855437904596329, "acc": 0.9857897758483887, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.059377290308475494, "acc": 0.9879699945449829, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.06325343996286392, "acc": 0.9871053099632263, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.059882767498493195, "acc": 0.9877767562866211, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.06406765431165695, "acc": 0.9865484237670898, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.06040874123573303, "acc": 0.987520694732666, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.06819203495979309, "acc": 0.98483806848526, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.05858098343014717, "acc": 0.9879820346832275, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.06515941768884659, "acc": 0.9860402941703796, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.05634625628590584, "acc": 0.9885503649711609, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.06170792132616043, "acc": 0.9875774383544922, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.054395776242017746, "acc": 0.9890819787979126, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 0.05908263102173805, "acc": 0.9881560802459717, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.05448225513100624, "acc": 0.98897385597229, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.05638248845934868, "acc": 0.9888444542884827, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.05188501998782158, "acc": 0.9895846843719482, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.06069056689739227, "acc": 0.9881578683853149, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.05103997513651848, "acc": 0.9897974133491516, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 0.05853584408760071, "acc": 0.9882136583328247, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.04938722774386406, "acc": 0.9902947545051575, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.0541730597615242, "acc": 0.9895815849304199, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.0478283129632473, "acc": 0.990780770778656, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.05306989699602127, "acc": 0.9900951981544495, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.04836481437087059, "acc": 0.9904348254203796, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.05283428356051445, "acc": 0.9898356199264526, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.04764707759022713, "acc": 0.9907328486442566, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.05361815541982651, "acc": 0.9897635579109192, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.04684329777956009, "acc": 0.9908240437507629, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.05323446914553642, "acc": 0.9889993667602539, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.0454978384077549, "acc": 0.9911664724349976, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.049233920872211456, "acc": 0.9905530214309692, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.04493730142712593, "acc": 0.9912169575691223, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.05237998068332672, "acc": 0.9898536205291748, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.0427369698882103, "acc": 0.9917786121368408, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.04742498695850372, "acc": 0.9912719130516052, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.04266279563307762, "acc": 0.9916841983795166, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.05029767379164696, "acc": 0.989983320236206, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.04096050187945366, "acc": 0.9920350909233093, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.04420473054051399, "acc": 0.9919026494026184, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.03982871025800705, "acc": 0.9923733472824097, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.04606835916638374, "acc": 0.9912341237068176, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.038444165140390396, "acc": 0.9927523732185364, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.04262985289096832, "acc": 0.9922540783882141, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.040430400520563126, "acc": 0.9920862317085266, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.0436025932431221, "acc": 0.9917874932289124, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.037903767079114914, "acc": 0.9926285743713379, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.0478937029838562, "acc": 0.9905439615249634, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.03723796457052231, "acc": 0.9928484559059143, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.041189197450876236, "acc": 0.992457926273346, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.03653031215071678, "acc": 0.9930773377418518, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.03797429800033569, "acc": 0.9930019974708557, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.035048190504312515, "acc": 0.9933891296386719, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.03972266614437103, "acc": 0.9922630786895752, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.03287271410226822, "acc": 0.9940041899681091, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.03878102824091911, "acc": 0.9930903315544128, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03605732321739197, "acc": 0.9929950833320618, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.035853710025548935, "acc": 0.9938149452209473, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03209441900253296, "acc": 0.994162917137146, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.0369747094810009, "acc": 0.9935176968574524, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.033030807971954346, "acc": 0.9939099550247192, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.03532476723194122, "acc": 0.994040310382843, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.032793570309877396, "acc": 0.9939868450164795, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.03492201864719391, "acc": 0.9939068555831909, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.03164462000131607, "acc": 0.9943953156471252, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.03320655599236488, "acc": 0.9944565892219543, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.030480002984404564, "acc": 0.9946097731590271, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.03451859578490257, "acc": 0.9937986731529236, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.033894702792167664, "acc": 0.9936330914497375, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.04500637203454971, "acc": 0.9902321100234985, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03214575722813606, "acc": 0.9940841794013977, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.033897459506988525, "acc": 0.9941193461418152, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.03268007934093475, "acc": 0.9939586520195007, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.037505511194467545, "acc": 0.9927263855934143, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9567987322807312
