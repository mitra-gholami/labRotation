ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 10
{"loss": 0.43536585569381714, "acc": 0.7944303154945374, "length": 3.9790332317352295, "mode": "train", "epoch": 1}
{"loss": 0.3349699079990387, "acc": 0.8664897680282593, "length": 4.495391845703125, "mode": "test", "epoch": 1}
{"loss": 0.2509300410747528, "acc": 0.9130250215530396, "length": 4.767124652862549, "mode": "train", "epoch": 2}
{"loss": 0.24518397450447083, "acc": 0.9169346690177917, "length": 4.463565826416016, "mode": "test", "epoch": 2}
{"loss": 0.19747501611709595, "acc": 0.9393717050552368, "length": 4.763138294219971, "mode": "train", "epoch": 3}
{"loss": 0.1975024938583374, "acc": 0.9420963525772095, "length": 4.641921043395996, "mode": "test", "epoch": 3}
{"loss": 0.17025232315063477, "acc": 0.9519468545913696, "length": 4.830953121185303, "mode": "train", "epoch": 4}
{"loss": 0.17960673570632935, "acc": 0.9494027495384216, "length": 4.751152038574219, "mode": "test", "epoch": 4}
{"loss": 0.15560129284858704, "acc": 0.9578927755355835, "length": 4.788022041320801, "mode": "train", "epoch": 5}
{"loss": 0.16486836969852448, "acc": 0.9543530941009521, "length": 4.6086907386779785, "mode": "test", "epoch": 5}
{"loss": 0.14495381712913513, "acc": 0.9619208574295044, "length": 4.7289204597473145, "mode": "train", "epoch": 6}
{"loss": 0.16194631159305573, "acc": 0.9544242024421692, "length": 4.616611480712891, "mode": "test", "epoch": 6}
{"loss": 0.13874465227127075, "acc": 0.9643709659576416, "length": 4.753572940826416, "mode": "train", "epoch": 7}
{"loss": 0.14403553307056427, "acc": 0.9630720615386963, "length": 4.6118950843811035, "mode": "test", "epoch": 7}
{"loss": 0.135271355509758, "acc": 0.9656171798706055, "length": 4.6780853271484375, "mode": "train", "epoch": 8}
{"loss": 0.1456010490655899, "acc": 0.9620111584663391, "length": 4.576180934906006, "mode": "test", "epoch": 8}
{"loss": 0.13360479474067688, "acc": 0.9658806324005127, "length": 4.637214660644531, "mode": "train", "epoch": 9}
{"loss": 0.14239442348480225, "acc": 0.9637799859046936, "length": 4.577260971069336, "mode": "test", "epoch": 9}
{"loss": 0.13113220036029816, "acc": 0.9663052558898926, "length": 4.642701625823975, "mode": "train", "epoch": 10}
{"loss": 0.14102311432361603, "acc": 0.9637850522994995, "length": 4.604262828826904, "mode": "test", "epoch": 10}
{"loss": 0.13026587665081024, "acc": 0.9664919376373291, "length": 4.630853652954102, "mode": "train", "epoch": 11}
{"loss": 0.13911357522010803, "acc": 0.9647431969642639, "length": 4.533158302307129, "mode": "test", "epoch": 11}
{"loss": 0.12832044064998627, "acc": 0.9670619964599609, "length": 4.625035762786865, "mode": "train", "epoch": 12}
{"loss": 0.13564179837703705, "acc": 0.9655503630638123, "length": 4.5914459228515625, "mode": "test", "epoch": 12}
{"loss": 0.1260467916727066, "acc": 0.9676964282989502, "length": 4.609940052032471, "mode": "train", "epoch": 13}
{"loss": 0.13141314685344696, "acc": 0.966546893119812, "length": 4.575424671173096, "mode": "test", "epoch": 13}
{"loss": 0.1252703070640564, "acc": 0.9679872393608093, "length": 4.659109592437744, "mode": "train", "epoch": 14}
{"loss": 0.14239472150802612, "acc": 0.9634284973144531, "length": 4.487543106079102, "mode": "test", "epoch": 14}
{"loss": 0.1219315230846405, "acc": 0.9690294861793518, "length": 4.580918312072754, "mode": "train", "epoch": 15}
{"loss": 0.12707266211509705, "acc": 0.9683119058609009, "length": 4.574380874633789, "mode": "test", "epoch": 15}
{"loss": 0.1194392517209053, "acc": 0.970004141330719, "length": 4.587488174438477, "mode": "train", "epoch": 16}
{"loss": 0.1262020468711853, "acc": 0.9686220288276672, "length": 4.519801139831543, "mode": "test", "epoch": 16}
{"loss": 0.1148068979382515, "acc": 0.9714785814285278, "length": 4.605525016784668, "mode": "train", "epoch": 17}
{"loss": 0.12422207742929459, "acc": 0.9698696136474609, "length": 4.531358242034912, "mode": "test", "epoch": 17}
{"loss": 0.11282067745923996, "acc": 0.972204327583313, "length": 4.604903697967529, "mode": "train", "epoch": 18}
{"loss": 0.12273828685283661, "acc": 0.969995379447937, "length": 4.581257343292236, "mode": "test", "epoch": 18}
{"loss": 0.11124809831380844, "acc": 0.9728043675422668, "length": 4.615937232971191, "mode": "train", "epoch": 19}
{"loss": 0.11649422347545624, "acc": 0.97214674949646, "length": 4.572544574737549, "mode": "test", "epoch": 19}
{"loss": 0.10824396461248398, "acc": 0.9735221862792969, "length": 4.640625953674316, "mode": "train", "epoch": 20}
{"loss": 0.11478814482688904, "acc": 0.9728314280509949, "length": 4.664602756500244, "mode": "test", "epoch": 20}
{"loss": 0.10775791108608246, "acc": 0.9734567999839783, "length": 4.682773113250732, "mode": "train", "epoch": 21}
{"loss": 0.11772654950618744, "acc": 0.970707893371582, "length": 4.667518615722656, "mode": "test", "epoch": 21}
{"loss": 0.10595375299453735, "acc": 0.9738472104072571, "length": 4.715869903564453, "mode": "train", "epoch": 22}
{"loss": 0.11130299419164658, "acc": 0.9731246829032898, "length": 4.724114418029785, "mode": "test", "epoch": 22}
{"loss": 0.10406254976987839, "acc": 0.9748059511184692, "length": 4.71204137802124, "mode": "train", "epoch": 23}
{"loss": 0.1087576150894165, "acc": 0.9741262197494507, "length": 4.635620594024658, "mode": "test", "epoch": 23}
{"loss": 0.10064879059791565, "acc": 0.9760881662368774, "length": 4.725772857666016, "mode": "train", "epoch": 24}
{"loss": 0.10449425876140594, "acc": 0.9758046269416809, "length": 4.709029197692871, "mode": "test", "epoch": 24}
{"loss": 0.0967208594083786, "acc": 0.9772695899009705, "length": 4.66088342666626, "mode": "train", "epoch": 25}
{"loss": 0.10337834805250168, "acc": 0.9761179685592651, "length": 4.6084747314453125, "mode": "test", "epoch": 25}
{"loss": 0.09691061079502106, "acc": 0.9774318933486938, "length": 4.679145336151123, "mode": "train", "epoch": 26}
{"loss": 0.1104273721575737, "acc": 0.9746391773223877, "length": 4.722926139831543, "mode": "test", "epoch": 26}
{"loss": 0.09729227423667908, "acc": 0.9774269461631775, "length": 4.689021587371826, "mode": "train", "epoch": 27}
{"loss": 0.10145217925310135, "acc": 0.9772080183029175, "length": 4.719074249267578, "mode": "test", "epoch": 27}
{"loss": 0.09366599470376968, "acc": 0.9784955382347107, "length": 4.747135162353516, "mode": "train", "epoch": 28}
{"loss": 0.09971966594457626, "acc": 0.977720320224762, "length": 4.7122697830200195, "mode": "test", "epoch": 28}
{"loss": 0.09182974696159363, "acc": 0.9789935946464539, "length": 4.720444679260254, "mode": "train", "epoch": 29}
{"loss": 0.09963953495025635, "acc": 0.9774985313415527, "length": 4.637420654296875, "mode": "test", "epoch": 29}
{"loss": 0.09010981768369675, "acc": 0.9795769453048706, "length": 4.700685977935791, "mode": "train", "epoch": 30}
{"loss": 0.09692078083753586, "acc": 0.9781622290611267, "length": 4.676159381866455, "mode": "test", "epoch": 30}
{"loss": 0.0894528403878212, "acc": 0.9797552227973938, "length": 4.685370445251465, "mode": "train", "epoch": 31}
{"loss": 0.09634023904800415, "acc": 0.9786707162857056, "length": 4.791906833648682, "mode": "test", "epoch": 31}
{"loss": 0.09064093977212906, "acc": 0.9794132113456726, "length": 4.7045392990112305, "mode": "train", "epoch": 32}
{"loss": 0.09690976142883301, "acc": 0.9788212776184082, "length": 4.675043106079102, "mode": "test", "epoch": 32}
{"loss": 0.08943305909633636, "acc": 0.9797486662864685, "length": 4.658115386962891, "mode": "train", "epoch": 33}
{"loss": 0.09576138108968735, "acc": 0.9787956476211548, "length": 4.615711212158203, "mode": "test", "epoch": 33}
{"loss": 0.08712323755025864, "acc": 0.9804073572158813, "length": 4.683685302734375, "mode": "train", "epoch": 34}
{"loss": 0.0993170291185379, "acc": 0.9779176712036133, "length": 4.63954496383667, "mode": "test", "epoch": 34}
{"loss": 0.08629652112722397, "acc": 0.9806877970695496, "length": 4.681191444396973, "mode": "train", "epoch": 35}
{"loss": 0.09111029654741287, "acc": 0.980338990688324, "length": 4.65866231918335, "mode": "test", "epoch": 35}
{"loss": 0.08604136854410172, "acc": 0.9806792736053467, "length": 4.677402019500732, "mode": "train", "epoch": 36}
{"loss": 0.09374593943357468, "acc": 0.9789682626724243, "length": 4.691424369812012, "mode": "test", "epoch": 36}
{"loss": 0.0854630172252655, "acc": 0.9808838367462158, "length": 4.67046594619751, "mode": "train", "epoch": 37}
{"loss": 0.09350094944238663, "acc": 0.9799344539642334, "length": 4.6898040771484375, "mode": "test", "epoch": 37}
{"loss": 0.0849044919013977, "acc": 0.9810145497322083, "length": 4.70033073425293, "mode": "train", "epoch": 38}
{"loss": 0.09056254476308823, "acc": 0.980618953704834, "length": 4.676843166351318, "mode": "test", "epoch": 38}
{"loss": 0.08447601646184921, "acc": 0.9811296463012695, "length": 4.673377513885498, "mode": "train", "epoch": 39}
{"loss": 0.08960556238889694, "acc": 0.980128288269043, "length": 4.628312110900879, "mode": "test", "epoch": 39}
{"loss": 0.08306549489498138, "acc": 0.9815733432769775, "length": 4.685344219207764, "mode": "train", "epoch": 40}
{"loss": 0.08918633311986923, "acc": 0.9809057116508484, "length": 4.763068675994873, "mode": "test", "epoch": 40}
{"loss": 0.08320331573486328, "acc": 0.9814628958702087, "length": 4.719622611999512, "mode": "train", "epoch": 41}
{"loss": 0.09265106916427612, "acc": 0.9796069264411926, "length": 4.6725592613220215, "mode": "test", "epoch": 41}
{"loss": 0.0841391533613205, "acc": 0.981053352355957, "length": 4.6898393630981445, "mode": "train", "epoch": 42}
{"loss": 0.08904428035020828, "acc": 0.9807376265525818, "length": 4.711549758911133, "mode": "test", "epoch": 42}
{"loss": 0.08204091340303421, "acc": 0.9816691279411316, "length": 4.700844764709473, "mode": "train", "epoch": 43}
{"loss": 0.09381430596113205, "acc": 0.9795795679092407, "length": 4.72116231918335, "mode": "test", "epoch": 43}
{"loss": 0.08398203551769257, "acc": 0.9811129570007324, "length": 4.730705738067627, "mode": "train", "epoch": 44}
{"loss": 0.09183236211538315, "acc": 0.9801667928695679, "length": 4.685699939727783, "mode": "test", "epoch": 44}
{"loss": 0.08287269622087479, "acc": 0.9814407825469971, "length": 4.692720413208008, "mode": "train", "epoch": 45}
{"loss": 0.08699430525302887, "acc": 0.9812601208686829, "length": 4.655205726623535, "mode": "test", "epoch": 45}
{"loss": 0.08078983426094055, "acc": 0.9821369647979736, "length": 4.701124668121338, "mode": "train", "epoch": 46}
{"loss": 0.08679290860891342, "acc": 0.9816015362739563, "length": 4.726490497589111, "mode": "test", "epoch": 46}
{"loss": 0.08064103126525879, "acc": 0.9820964336395264, "length": 4.7024736404418945, "mode": "train", "epoch": 47}
{"loss": 0.08996022492647171, "acc": 0.9805001616477966, "length": 4.751692295074463, "mode": "test", "epoch": 47}
{"loss": 0.08072374761104584, "acc": 0.9820908904075623, "length": 4.727194309234619, "mode": "train", "epoch": 48}
{"loss": 0.08583441376686096, "acc": 0.9817931056022644, "length": 4.652829647064209, "mode": "test", "epoch": 48}
{"loss": 0.08121936768293381, "acc": 0.9818149209022522, "length": 4.722075939178467, "mode": "train", "epoch": 49}
{"loss": 0.08821383863687515, "acc": 0.9813780188560486, "length": 4.746075630187988, "mode": "test", "epoch": 49}
{"loss": 0.0815105214715004, "acc": 0.9819445013999939, "length": 4.7616167068481445, "mode": "train", "epoch": 50}
{"loss": 0.09599238634109497, "acc": 0.9785425066947937, "length": 4.7504682540893555, "mode": "test", "epoch": 50}
{"loss": 0.08058346062898636, "acc": 0.9820578098297119, "length": 4.732446670532227, "mode": "train", "epoch": 51}
{"loss": 0.0853656753897667, "acc": 0.9816030263900757, "length": 4.706797122955322, "mode": "test", "epoch": 51}
{"loss": 0.0788559839129448, "acc": 0.9825389981269836, "length": 4.678494930267334, "mode": "train", "epoch": 52}
{"loss": 0.08440229296684265, "acc": 0.982079267501831, "length": 4.6743950843811035, "mode": "test", "epoch": 52}
{"loss": 0.08049578219652176, "acc": 0.9820742011070251, "length": 4.706777095794678, "mode": "train", "epoch": 53}
{"loss": 0.08568692207336426, "acc": 0.9815564751625061, "length": 4.6647467613220215, "mode": "test", "epoch": 53}
{"loss": 0.08183816820383072, "acc": 0.9819124937057495, "length": 4.715680122375488, "mode": "train", "epoch": 54}
{"loss": 0.0839414969086647, "acc": 0.9819722175598145, "length": 4.668022632598877, "mode": "test", "epoch": 54}
{"loss": 0.0798104852437973, "acc": 0.9823068976402283, "length": 4.724619388580322, "mode": "train", "epoch": 55}
{"loss": 0.09172967076301575, "acc": 0.9800211787223816, "length": 4.755580425262451, "mode": "test", "epoch": 55}
{"loss": 0.08054797351360321, "acc": 0.982006311416626, "length": 4.721200942993164, "mode": "train", "epoch": 56}
{"loss": 0.08526068925857544, "acc": 0.9817586541175842, "length": 4.666438579559326, "mode": "test", "epoch": 56}
{"loss": 0.07998760044574738, "acc": 0.9822220802307129, "length": 4.799047470092773, "mode": "train", "epoch": 57}
{"loss": 0.08821631222963333, "acc": 0.980283796787262, "length": 4.732934951782227, "mode": "test", "epoch": 57}
{"loss": 0.07757929712533951, "acc": 0.9827960133552551, "length": 4.722598552703857, "mode": "train", "epoch": 58}
{"loss": 0.08437725156545639, "acc": 0.9821416139602661, "length": 4.667698860168457, "mode": "test", "epoch": 58}
{"loss": 0.07774320989847183, "acc": 0.9827716946601868, "length": 4.710824012756348, "mode": "train", "epoch": 59}
{"loss": 0.08338908106088638, "acc": 0.98236083984375, "length": 4.72731876373291, "mode": "test", "epoch": 59}
{"loss": 0.07757613807916641, "acc": 0.9828439950942993, "length": 4.721158981323242, "mode": "train", "epoch": 60}
{"loss": 0.08989396691322327, "acc": 0.9805929064750671, "length": 4.785894393920898, "mode": "test", "epoch": 60}
test accuracy: 0.9578655362129211
