ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.6922658681869507, "acc": 0.5360811948776245, "length": 4.731385231018066, "mode": "train", "epoch": 1}
{"loss": 0.6636232733726501, "acc": 0.6051622033119202, "length": 2.7361111640930176, "mode": "test", "epoch": 1}
{"loss": 0.6013610363006592, "acc": 0.6686248779296875, "length": 4.277063846588135, "mode": "train", "epoch": 2}
{"loss": 0.6316143274307251, "acc": 0.6780952215194702, "length": 3.4010417461395264, "mode": "test", "epoch": 2}
{"loss": 0.4813563823699951, "acc": 0.7772526741027832, "length": 4.922922611236572, "mode": "train", "epoch": 3}
{"loss": 0.5564723014831543, "acc": 0.7696588039398193, "length": 9.135416984558105, "mode": "test", "epoch": 3}
{"loss": 0.37803682684898376, "acc": 0.8442850112915039, "length": 5.934967041015625, "mode": "train", "epoch": 4}
{"loss": 0.39039328694343567, "acc": 0.8340141773223877, "length": 9.35243034362793, "mode": "test", "epoch": 4}
{"loss": 0.3128936290740967, "acc": 0.8733797073364258, "length": 7.209518909454346, "mode": "train", "epoch": 5}
{"loss": 0.3389740586280823, "acc": 0.8595377206802368, "length": 10.121527671813965, "mode": "test", "epoch": 5}
{"loss": 0.27940213680267334, "acc": 0.8943346738815308, "length": 7.83267879486084, "mode": "train", "epoch": 6}
{"loss": 0.30345040559768677, "acc": 0.8827093839645386, "length": 10.574652671813965, "mode": "test", "epoch": 6}
{"loss": 0.2485160529613495, "acc": 0.9079365730285645, "length": 8.291269302368164, "mode": "train", "epoch": 7}
{"loss": 0.2778184711933136, "acc": 0.8915960788726807, "length": 8.760416984558105, "mode": "test", "epoch": 7}
{"loss": 0.22438685595989227, "acc": 0.9207252264022827, "length": 8.4242582321167, "mode": "train", "epoch": 8}
{"loss": 0.24644415080547333, "acc": 0.9011447429656982, "length": 8.449652671813965, "mode": "test", "epoch": 8}
{"loss": 0.20460064709186554, "acc": 0.929328203201294, "length": 8.541348457336426, "mode": "train", "epoch": 9}
{"loss": 0.24728263914585114, "acc": 0.8961425423622131, "length": 9.510416984558105, "mode": "test", "epoch": 9}
{"loss": 0.19235900044441223, "acc": 0.9306060671806335, "length": 8.489380836486816, "mode": "train", "epoch": 10}
{"loss": 0.2029120773077011, "acc": 0.9197238087654114, "length": 8.53125, "mode": "test", "epoch": 10}
{"loss": 0.16983981430530548, "acc": 0.9405413866043091, "length": 9.401253700256348, "mode": "train", "epoch": 11}
{"loss": 0.2248777598142624, "acc": 0.9136284589767456, "length": 8.565972328186035, "mode": "test", "epoch": 11}
{"loss": 0.15721331536769867, "acc": 0.9478176832199097, "length": 9.78323745727539, "mode": "train", "epoch": 12}
{"loss": 0.2012292742729187, "acc": 0.9284207224845886, "length": 9.23263931274414, "mode": "test", "epoch": 12}
{"loss": 0.14434927701950073, "acc": 0.9537420868873596, "length": 9.710587501525879, "mode": "train", "epoch": 13}
{"loss": 0.2221185266971588, "acc": 0.9229301810264587, "length": 9.79513931274414, "mode": "test", "epoch": 13}
{"loss": 0.132477805018425, "acc": 0.9585586786270142, "length": 10.342768669128418, "mode": "train", "epoch": 14}
{"loss": 0.18517524003982544, "acc": 0.9367783665657043, "length": 10.93055534362793, "mode": "test", "epoch": 14}
{"loss": 0.12166187912225723, "acc": 0.9641398191452026, "length": 10.472282409667969, "mode": "train", "epoch": 15}
{"loss": 0.17477485537528992, "acc": 0.9428574442863464, "length": 10.24131965637207, "mode": "test", "epoch": 15}
{"loss": 0.11393660306930542, "acc": 0.9673019647598267, "length": 10.91901969909668, "mode": "train", "epoch": 16}
{"loss": 0.16035230457782745, "acc": 0.9456326365470886, "length": 9.296875, "mode": "test", "epoch": 16}
{"loss": 0.11141892522573471, "acc": 0.9676758646965027, "length": 10.960378646850586, "mode": "train", "epoch": 17}
{"loss": 0.14588357508182526, "acc": 0.9452229738235474, "length": 10.895833015441895, "mode": "test", "epoch": 17}
{"loss": 0.10016541182994843, "acc": 0.9725682139396667, "length": 11.73082447052002, "mode": "train", "epoch": 18}
{"loss": 0.17545780539512634, "acc": 0.9401340484619141, "length": 11.041666984558105, "mode": "test", "epoch": 18}
{"loss": 0.08982227742671967, "acc": 0.9758720993995667, "length": 11.392659187316895, "mode": "train", "epoch": 19}
{"loss": 0.14216145873069763, "acc": 0.9528102874755859, "length": 11.421875, "mode": "test", "epoch": 19}
{"loss": 0.08350029587745667, "acc": 0.9772457480430603, "length": 11.762947082519531, "mode": "train", "epoch": 20}
{"loss": 0.1498936265707016, "acc": 0.9548909664154053, "length": 11.31944465637207, "mode": "test", "epoch": 20}
{"loss": 0.07417421042919159, "acc": 0.9806603193283081, "length": 11.824636459350586, "mode": "train", "epoch": 21}
{"loss": 0.14131876826286316, "acc": 0.9473631978034973, "length": 11.609375, "mode": "test", "epoch": 21}
{"loss": 0.07067564874887466, "acc": 0.9823443293571472, "length": 12.25904369354248, "mode": "train", "epoch": 22}
{"loss": 0.1488880217075348, "acc": 0.9463893175125122, "length": 10.93055534362793, "mode": "test", "epoch": 22}
{"loss": 0.06373784691095352, "acc": 0.9840779304504395, "length": 11.597139358520508, "mode": "train", "epoch": 23}
{"loss": 0.12021402269601822, "acc": 0.9637234210968018, "length": 10.885416984558105, "mode": "test", "epoch": 23}
{"loss": 0.05505230650305748, "acc": 0.987655758857727, "length": 12.109915733337402, "mode": "train", "epoch": 24}
{"loss": 0.14541232585906982, "acc": 0.9537190198898315, "length": 11.746527671813965, "mode": "test", "epoch": 24}
{"loss": 0.0503949411213398, "acc": 0.9897549748420715, "length": 12.352800369262695, "mode": "train", "epoch": 25}
{"loss": 0.12222786992788315, "acc": 0.9643988013267517, "length": 11.859375, "mode": "test", "epoch": 25}
{"loss": 0.0542629137635231, "acc": 0.9874035120010376, "length": 12.467094421386719, "mode": "train", "epoch": 26}
{"loss": 0.13238514959812164, "acc": 0.9599528908729553, "length": 11.97743034362793, "mode": "test", "epoch": 26}
{"loss": 0.051227521151304245, "acc": 0.9879515171051025, "length": 12.910443305969238, "mode": "train", "epoch": 27}
{"loss": 0.08422112464904785, "acc": 0.9764973521232605, "length": 12.22743034362793, "mode": "test", "epoch": 27}
{"loss": 0.04796700179576874, "acc": 0.9884100556373596, "length": 12.22057056427002, "mode": "train", "epoch": 28}
{"loss": 0.10399968177080154, "acc": 0.9706054329872131, "length": 11.859375, "mode": "test", "epoch": 28}
{"loss": 0.04082854837179184, "acc": 0.9922366738319397, "length": 12.219680786132812, "mode": "train", "epoch": 29}
{"loss": 0.06699666380882263, "acc": 0.9814155101776123, "length": 10.89236068725586, "mode": "test", "epoch": 29}
{"loss": 0.030618516728281975, "acc": 0.9957523941993713, "length": 12.066581726074219, "mode": "train", "epoch": 30}
{"loss": 0.06716061383485794, "acc": 0.9840223789215088, "length": 11.52430534362793, "mode": "test", "epoch": 30}
{"loss": 0.026799384504556656, "acc": 0.9970241189002991, "length": 12.153287887573242, "mode": "train", "epoch": 31}
{"loss": 0.06507860124111176, "acc": 0.9855007529258728, "length": 11.57118034362793, "mode": "test", "epoch": 31}
{"loss": 0.038953881710767746, "acc": 0.9918206334114075, "length": 11.633013725280762, "mode": "train", "epoch": 32}
{"loss": 0.10676664859056473, "acc": 0.9708848595619202, "length": 10.293402671813965, "mode": "test", "epoch": 32}
{"loss": 0.04236637055873871, "acc": 0.9906715750694275, "length": 10.340712547302246, "mode": "train", "epoch": 33}
{"loss": 0.0699990764260292, "acc": 0.9840306043624878, "length": 10.96006965637207, "mode": "test", "epoch": 33}
{"loss": 0.03620458394289017, "acc": 0.9928634166717529, "length": 10.911020278930664, "mode": "train", "epoch": 34}
{"loss": 0.05725006386637688, "acc": 0.9865315556526184, "length": 9.708333015441895, "mode": "test", "epoch": 34}
{"loss": 0.025417599827051163, "acc": 0.9970625042915344, "length": 10.769320487976074, "mode": "train", "epoch": 35}
{"loss": 0.05814667046070099, "acc": 0.986200749874115, "length": 10.52430534362793, "mode": "test", "epoch": 35}
{"loss": 0.020585883408784866, "acc": 0.9982542395591736, "length": 11.154953956604004, "mode": "train", "epoch": 36}
{"loss": 0.036648862063884735, "acc": 0.9935166835784912, "length": 10.421875, "mode": "test", "epoch": 36}
{"loss": 0.0183897502720356, "acc": 0.9988807439804077, "length": 10.844327926635742, "mode": "train", "epoch": 37}
{"loss": 0.03845081850886345, "acc": 0.9911540150642395, "length": 9.635416984558105, "mode": "test", "epoch": 37}
{"loss": 0.016213370487093925, "acc": 0.9992958307266235, "length": 10.430612564086914, "mode": "train", "epoch": 38}
{"loss": 0.03724800422787666, "acc": 0.9924914240837097, "length": 10.03819465637207, "mode": "test", "epoch": 38}
{"loss": 0.01612609252333641, "acc": 0.9991740584373474, "length": 10.506482124328613, "mode": "train", "epoch": 39}
{"loss": 0.03550908342003822, "acc": 0.9924153089523315, "length": 9.635416984558105, "mode": "test", "epoch": 39}
{"loss": 0.018103329464793205, "acc": 0.9981439709663391, "length": 10.142563819885254, "mode": "train", "epoch": 40}
{"loss": 0.043328460305929184, "acc": 0.9888646006584167, "length": 9.871527671813965, "mode": "test", "epoch": 40}
{"loss": 0.028013810515403748, "acc": 0.9948689937591553, "length": 9.977078437805176, "mode": "train", "epoch": 41}
{"loss": 0.05119635909795761, "acc": 0.9833577275276184, "length": 9.14756965637207, "mode": "test", "epoch": 41}
{"loss": 0.0290976595133543, "acc": 0.9952442646026611, "length": 10.342111587524414, "mode": "train", "epoch": 42}
{"loss": 0.09295740723609924, "acc": 0.9802842736244202, "length": 9.43923568725586, "mode": "test", "epoch": 42}
{"loss": 0.026710383594036102, "acc": 0.9950136542320251, "length": 9.788908958435059, "mode": "train", "epoch": 43}
{"loss": 0.05486338958144188, "acc": 0.9825710654258728, "length": 9.541666984558105, "mode": "test", "epoch": 43}
{"loss": 0.02127932943403721, "acc": 0.9971169829368591, "length": 9.484611511230469, "mode": "train", "epoch": 44}
{"loss": 0.034995075315237045, "acc": 0.9918076992034912, "length": 8.6875, "mode": "test", "epoch": 44}
{"loss": 0.014653646387159824, "acc": 0.9993799328804016, "length": 9.702834129333496, "mode": "train", "epoch": 45}
{"loss": 0.02719312161207199, "acc": 0.9951632618904114, "length": 9.151041984558105, "mode": "test", "epoch": 45}
{"loss": 0.020473647862672806, "acc": 0.9969673156738281, "length": 9.47438907623291, "mode": "train", "epoch": 46}
{"loss": 0.05119209736585617, "acc": 0.985663652420044, "length": 9.10243034362793, "mode": "test", "epoch": 46}
{"loss": 0.015747234225273132, "acc": 0.9986475110054016, "length": 9.760125160217285, "mode": "train", "epoch": 47}
{"loss": 0.038062211126089096, "acc": 0.992100715637207, "length": 8.87673568725586, "mode": "test", "epoch": 47}
{"loss": 0.019306102767586708, "acc": 0.996944010257721, "length": 9.35432243347168, "mode": "train", "epoch": 48}
{"loss": 0.029108472168445587, "acc": 0.9939968585968018, "length": 8.80555534362793, "mode": "test", "epoch": 48}
{"loss": 0.013589712791144848, "acc": 0.9990332126617432, "length": 9.389094352722168, "mode": "train", "epoch": 49}
{"loss": 0.02326141856610775, "acc": 0.9960746765136719, "length": 8.520833015441895, "mode": "test", "epoch": 49}
{"loss": 0.012364287860691547, "acc": 0.9992932677268982, "length": 8.891794204711914, "mode": "train", "epoch": 50}
{"loss": 0.026804868131875992, "acc": 0.9937580823898315, "length": 8.567708015441895, "mode": "test", "epoch": 50}
{"loss": 0.020059430971741676, "acc": 0.9970080256462097, "length": 9.238350868225098, "mode": "train", "epoch": 51}
{"loss": 0.03672927990555763, "acc": 0.9915282726287842, "length": 8.348958015441895, "mode": "test", "epoch": 51}
{"loss": 0.015423491597175598, "acc": 0.9985355138778687, "length": 10.027996063232422, "mode": "train", "epoch": 52}
{"loss": 0.023910177871584892, "acc": 0.9948431849479675, "length": 9.088541984558105, "mode": "test", "epoch": 52}
{"loss": 0.011185064911842346, "acc": 0.999534547328949, "length": 9.5386381149292, "mode": "train", "epoch": 53}
{"loss": 0.030696958303451538, "acc": 0.9925646185874939, "length": 8.93923568725586, "mode": "test", "epoch": 53}
{"loss": 0.010957933031022549, "acc": 0.9996134042739868, "length": 9.587159156799316, "mode": "train", "epoch": 54}
{"loss": 0.020197702571749687, "acc": 0.9961669445037842, "length": 9.0625, "mode": "test", "epoch": 54}
{"loss": 0.011481250636279583, "acc": 0.9991098046302795, "length": 9.214301109313965, "mode": "train", "epoch": 55}
{"loss": 0.025634340941905975, "acc": 0.9951009750366211, "length": 8.331597328186035, "mode": "test", "epoch": 55}
{"loss": 0.011923498474061489, "acc": 0.999336838722229, "length": 8.71465015411377, "mode": "train", "epoch": 56}
{"loss": 0.02058137208223343, "acc": 0.9969998598098755, "length": 8.854166984558105, "mode": "test", "epoch": 56}
{"loss": 0.01922140270471573, "acc": 0.9971494078636169, "length": 9.5431489944458, "mode": "train", "epoch": 57}
{"loss": 0.04228571057319641, "acc": 0.9901015162467957, "length": 9.05381965637207, "mode": "test", "epoch": 57}
{"loss": 0.019566619768738747, "acc": 0.9964141845703125, "length": 10.451955795288086, "mode": "train", "epoch": 58}
{"loss": 0.0282906461507082, "acc": 0.9950439929962158, "length": 9.21180534362793, "mode": "test", "epoch": 58}
{"loss": 0.0158829465508461, "acc": 0.998078465461731, "length": 9.336830139160156, "mode": "train", "epoch": 59}
{"loss": 0.030135909095406532, "acc": 0.9940049052238464, "length": 8.552083015441895, "mode": "test", "epoch": 59}
{"loss": 0.029250672087073326, "acc": 0.9939411282539368, "length": 9.009146690368652, "mode": "train", "epoch": 60}
{"loss": 0.051317498087882996, "acc": 0.986211359500885, "length": 8.80555534362793, "mode": "test", "epoch": 60}
test accuracy: 0.8895208835601807
