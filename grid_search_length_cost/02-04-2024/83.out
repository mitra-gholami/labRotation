ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.3603009581565857, "acc": 0.8398676514625549, "length": 6.043395519256592, "mode": "train", "epoch": 1}
{"loss": 0.3013792634010315, "acc": 0.8823800683021545, "length": 6.890725135803223, "mode": "test", "epoch": 1}
{"loss": 0.21130703389644623, "acc": 0.9290727376937866, "length": 7.543006896972656, "mode": "train", "epoch": 2}
{"loss": 0.2246859073638916, "acc": 0.9204787611961365, "length": 7.987236022949219, "mode": "test", "epoch": 2}
{"loss": 0.15457214415073395, "acc": 0.9545660614967346, "length": 8.910219192504883, "mode": "train", "epoch": 3}
{"loss": 0.17627832293510437, "acc": 0.9440814256668091, "length": 10.267325401306152, "mode": "test", "epoch": 3}
{"loss": 0.12199495732784271, "acc": 0.968106210231781, "length": 9.94020938873291, "mode": "train", "epoch": 4}
{"loss": 0.1779775619506836, "acc": 0.9437618255615234, "length": 10.242317199707031, "mode": "test", "epoch": 4}
{"loss": 0.10253632813692093, "acc": 0.9758592247962952, "length": 10.211345672607422, "mode": "train", "epoch": 5}
{"loss": 0.17692919075489044, "acc": 0.9414005279541016, "length": 9.864876747131348, "mode": "test", "epoch": 5}
{"loss": 0.09226792305707932, "acc": 0.9800410866737366, "length": 10.332240104675293, "mode": "train", "epoch": 6}
{"loss": 0.16465246677398682, "acc": 0.9505844712257385, "length": 10.045414924621582, "mode": "test", "epoch": 6}
{"loss": 0.092445969581604, "acc": 0.9793649911880493, "length": 9.995762825012207, "mode": "train", "epoch": 7}
{"loss": 0.18139678239822388, "acc": 0.9459646344184875, "length": 8.914412498474121, "mode": "test", "epoch": 7}
{"loss": 0.09081898629665375, "acc": 0.9781606793403625, "length": 9.892359733581543, "mode": "train", "epoch": 8}
{"loss": 0.12116461992263794, "acc": 0.9668423533439636, "length": 10.624199867248535, "mode": "test", "epoch": 8}
{"loss": 0.06760802865028381, "acc": 0.9856342077255249, "length": 10.360998153686523, "mode": "train", "epoch": 9}
{"loss": 0.11877035349607468, "acc": 0.966711699962616, "length": 11.847871780395508, "mode": "test", "epoch": 9}
{"loss": 0.058468449860811234, "acc": 0.988349199295044, "length": 11.10268783569336, "mode": "train", "epoch": 10}
{"loss": 0.08426984399557114, "acc": 0.9787593483924866, "length": 11.577064514160156, "mode": "test", "epoch": 10}
{"loss": 0.05042285472154617, "acc": 0.9913673996925354, "length": 11.624663352966309, "mode": "train", "epoch": 11}
{"loss": 0.0951550230383873, "acc": 0.9748235940933228, "length": 10.025568008422852, "mode": "test", "epoch": 11}
{"loss": 0.048888251185417175, "acc": 0.9915701150894165, "length": 11.348907470703125, "mode": "train", "epoch": 12}
{"loss": 0.07582290470600128, "acc": 0.9820192456245422, "length": 10.625519752502441, "mode": "test", "epoch": 12}
{"loss": 0.044621363282203674, "acc": 0.9927583932876587, "length": 10.824870109558105, "mode": "train", "epoch": 13}
{"loss": 0.0878300666809082, "acc": 0.9790598750114441, "length": 10.437780380249023, "mode": "test", "epoch": 13}
{"loss": 0.04815515875816345, "acc": 0.9915185570716858, "length": 10.913918495178223, "mode": "train", "epoch": 14}
{"loss": 0.09216320514678955, "acc": 0.978065550327301, "length": 10.717789649963379, "mode": "test", "epoch": 14}
{"loss": 0.04783850163221359, "acc": 0.9913542866706848, "length": 10.553840637207031, "mode": "train", "epoch": 15}
{"loss": 0.06848478317260742, "acc": 0.9854865074157715, "length": 10.275287628173828, "mode": "test", "epoch": 15}
{"loss": 0.043462514877319336, "acc": 0.9926987886428833, "length": 10.116120338439941, "mode": "train", "epoch": 16}
{"loss": 0.08380655199289322, "acc": 0.9776098728179932, "length": 9.639884948730469, "mode": "test", "epoch": 16}
{"loss": 0.03785517439246178, "acc": 0.9936453700065613, "length": 10.006869316101074, "mode": "train", "epoch": 17}
{"loss": 0.06256997585296631, "acc": 0.9849013686180115, "length": 10.238436698913574, "mode": "test", "epoch": 17}
{"loss": 0.032011304050683975, "acc": 0.994249701499939, "length": 9.952187538146973, "mode": "train", "epoch": 18}
{"loss": 0.056733280420303345, "acc": 0.987271785736084, "length": 10.08754825592041, "mode": "test", "epoch": 18}
{"loss": 0.023295404389500618, "acc": 0.9970244765281677, "length": 10.42988395690918, "mode": "train", "epoch": 19}
{"loss": 0.04942351579666138, "acc": 0.9891021251678467, "length": 10.18249797821045, "mode": "test", "epoch": 19}
{"loss": 0.022810697555541992, "acc": 0.9970013499259949, "length": 9.87867259979248, "mode": "train", "epoch": 20}
{"loss": 0.07769427448511124, "acc": 0.9822865128517151, "length": 9.686820030212402, "mode": "test", "epoch": 20}
{"loss": 0.020358193665742874, "acc": 0.9977839589118958, "length": 9.801694869995117, "mode": "train", "epoch": 21}
{"loss": 0.042518146336078644, "acc": 0.9921115636825562, "length": 10.092789649963379, "mode": "test", "epoch": 21}
{"loss": 0.02114708349108696, "acc": 0.9974780678749084, "length": 9.7783203125, "mode": "train", "epoch": 22}
{"loss": 0.04888926446437836, "acc": 0.9900288581848145, "length": 9.440421104431152, "mode": "test", "epoch": 22}
{"loss": 0.019179215654730797, "acc": 0.9980347156524658, "length": 10.069533348083496, "mode": "train", "epoch": 23}
{"loss": 0.03627171367406845, "acc": 0.9920019507408142, "length": 9.805097579956055, "mode": "test", "epoch": 23}
{"loss": 0.019085634499788284, "acc": 0.9981020092964172, "length": 10.300686836242676, "mode": "train", "epoch": 24}
{"loss": 0.02924654819071293, "acc": 0.9960137009620667, "length": 10.743517875671387, "mode": "test", "epoch": 24}
{"loss": 0.020913785323500633, "acc": 0.9976959824562073, "length": 10.883402824401855, "mode": "train", "epoch": 25}
{"loss": 0.033362872898578644, "acc": 0.9940510392189026, "length": 9.78589153289795, "mode": "test", "epoch": 25}
{"loss": 0.020807543769478798, "acc": 0.9976139068603516, "length": 10.418176651000977, "mode": "train", "epoch": 26}
{"loss": 0.028563030064105988, "acc": 0.9953902363777161, "length": 10.474871635437012, "mode": "test", "epoch": 26}
{"loss": 0.01913597621023655, "acc": 0.9980247616767883, "length": 10.480244636535645, "mode": "train", "epoch": 27}
{"loss": 0.03389650955796242, "acc": 0.9940887093544006, "length": 9.885763168334961, "mode": "test", "epoch": 27}
{"loss": 0.017468050122261047, "acc": 0.9983468055725098, "length": 9.895796775817871, "mode": "train", "epoch": 28}
{"loss": 0.038749415427446365, "acc": 0.9932027459144592, "length": 9.54965591430664, "mode": "test", "epoch": 28}
{"loss": 0.01814200170338154, "acc": 0.9980583190917969, "length": 9.463168144226074, "mode": "train", "epoch": 29}
{"loss": 0.050284191966056824, "acc": 0.990187406539917, "length": 9.465668678283691, "mode": "test", "epoch": 29}
{"loss": 0.01787889190018177, "acc": 0.9981333613395691, "length": 9.538649559020996, "mode": "train", "epoch": 30}
{"loss": 0.03256142884492874, "acc": 0.9945670366287231, "length": 9.379481315612793, "mode": "test", "epoch": 30}
{"loss": 0.017194043844938278, "acc": 0.9984092116355896, "length": 9.987138748168945, "mode": "train", "epoch": 31}
{"loss": 0.03909994289278984, "acc": 0.9937248826026917, "length": 9.694581985473633, "mode": "test", "epoch": 31}
{"loss": 0.018219923600554466, "acc": 0.9981443881988525, "length": 10.078970909118652, "mode": "train", "epoch": 32}
{"loss": 0.02722521871328354, "acc": 0.9957134127616882, "length": 9.645366668701172, "mode": "test", "epoch": 32}
{"loss": 0.015471110120415688, "acc": 0.9988371729850769, "length": 9.765602111816406, "mode": "train", "epoch": 33}
{"loss": 0.025983864441514015, "acc": 0.996716320514679, "length": 9.08254623413086, "mode": "test", "epoch": 33}
{"loss": 0.0168905071914196, "acc": 0.9983372092247009, "length": 9.424741744995117, "mode": "train", "epoch": 34}
{"loss": 0.020774252712726593, "acc": 0.9974305629730225, "length": 9.44266128540039, "mode": "test", "epoch": 34}
{"loss": 0.01589040830731392, "acc": 0.9986997842788696, "length": 9.678717613220215, "mode": "train", "epoch": 35}
{"loss": 0.02652829699218273, "acc": 0.996084988117218, "length": 10.239436149597168, "mode": "test", "epoch": 35}
{"loss": 0.01700744591653347, "acc": 0.9985149502754211, "length": 9.815022468566895, "mode": "train", "epoch": 36}
{"loss": 0.028064768761396408, "acc": 0.9957630038261414, "length": 10.044214248657227, "mode": "test", "epoch": 36}
{"loss": 0.01639709435403347, "acc": 0.9985888004302979, "length": 9.476694107055664, "mode": "train", "epoch": 37}
{"loss": 0.023001518100500107, "acc": 0.9968667030334473, "length": 9.45394515991211, "mode": "test", "epoch": 37}
{"loss": 0.015280725434422493, "acc": 0.9988455772399902, "length": 9.646136283874512, "mode": "train", "epoch": 38}
{"loss": 0.027227317914366722, "acc": 0.9972118139266968, "length": 10.689980506896973, "mode": "test", "epoch": 38}
{"loss": 0.015841657295823097, "acc": 0.9989050626754761, "length": 10.018004417419434, "mode": "train", "epoch": 39}
{"loss": 0.024797750636935234, "acc": 0.996793270111084, "length": 9.843549728393555, "mode": "test", "epoch": 39}
{"loss": 0.016646914184093475, "acc": 0.9987146258354187, "length": 10.383332252502441, "mode": "train", "epoch": 40}
{"loss": 0.02283472567796707, "acc": 0.997722327709198, "length": 10.829745292663574, "mode": "test", "epoch": 40}
{"loss": 0.02563687227666378, "acc": 0.9971544742584229, "length": 13.879203796386719, "mode": "train", "epoch": 41}
{"loss": 0.026360390707850456, "acc": 0.9969446659088135, "length": 12.65160846710205, "mode": "test", "epoch": 41}
{"loss": 0.016239291056990623, "acc": 0.9989345669746399, "length": 11.076839447021484, "mode": "train", "epoch": 42}
{"loss": 0.02602282725274563, "acc": 0.9970804452896118, "length": 9.947583198547363, "mode": "test", "epoch": 42}
{"loss": 0.015504026785492897, "acc": 0.999026358127594, "length": 10.48089599609375, "mode": "train", "epoch": 43}
{"loss": 0.01907268725335598, "acc": 0.9982772469520569, "length": 9.857754707336426, "mode": "test", "epoch": 43}
{"loss": 0.01670553907752037, "acc": 0.9986521601676941, "length": 10.395064353942871, "mode": "train", "epoch": 44}
{"loss": 0.018785947933793068, "acc": 0.9985477924346924, "length": 10.79609489440918, "mode": "test", "epoch": 44}
{"loss": 0.01915065012872219, "acc": 0.9982587695121765, "length": 11.030929565429688, "mode": "train", "epoch": 45}
{"loss": 0.026306159794330597, "acc": 0.9962349534034729, "length": 11.479352951049805, "mode": "test", "epoch": 45}
{"loss": 0.016858898103237152, "acc": 0.9986633062362671, "length": 10.834367752075195, "mode": "train", "epoch": 46}
{"loss": 0.022862346842885017, "acc": 0.9975257515907288, "length": 10.204465866088867, "mode": "test", "epoch": 46}
{"loss": 0.019701087847352028, "acc": 0.998121976852417, "length": 11.013895034790039, "mode": "train", "epoch": 47}
{"loss": 0.023185275495052338, "acc": 0.9975625276565552, "length": 11.362236022949219, "mode": "test", "epoch": 47}
{"loss": 0.017928974702954292, "acc": 0.9983987808227539, "length": 10.72854232788086, "mode": "train", "epoch": 48}
{"loss": 0.023422105237841606, "acc": 0.9972609877586365, "length": 10.473871231079102, "mode": "test", "epoch": 48}
{"loss": 0.01854892261326313, "acc": 0.9984176158905029, "length": 11.278529167175293, "mode": "train", "epoch": 49}
{"loss": 0.024033494293689728, "acc": 0.9971929788589478, "length": 11.902328491210938, "mode": "test", "epoch": 49}
{"loss": 0.03778456896543503, "acc": 0.9938833117485046, "length": 14.9382963180542, "mode": "train", "epoch": 50}
{"loss": 0.04190424457192421, "acc": 0.9934406280517578, "length": 16.672855377197266, "mode": "test", "epoch": 50}
{"loss": 0.02936721220612526, "acc": 0.9964597225189209, "length": 15.39871597290039, "mode": "train", "epoch": 51}
{"loss": 0.026785627007484436, "acc": 0.997248113155365, "length": 14.198263168334961, "mode": "test", "epoch": 51}
{"loss": 0.02062419056892395, "acc": 0.9984027743339539, "length": 13.442475318908691, "mode": "train", "epoch": 52}
{"loss": 0.02049243450164795, "acc": 0.9983910322189331, "length": 12.49699878692627, "mode": "test", "epoch": 52}
{"loss": 0.021645711734890938, "acc": 0.9980811476707458, "length": 13.431605339050293, "mode": "train", "epoch": 53}
{"loss": 0.024073351174592972, "acc": 0.9977527260780334, "length": 12.895406723022461, "mode": "test", "epoch": 53}
{"loss": 0.018534798175096512, "acc": 0.9985652565956116, "length": 12.07266902923584, "mode": "train", "epoch": 54}
{"loss": 0.018735725432634354, "acc": 0.998592734336853, "length": 11.392765998840332, "mode": "test", "epoch": 54}
{"loss": 0.029568402096629143, "acc": 0.9961786270141602, "length": 13.678510665893555, "mode": "train", "epoch": 55}
{"loss": 0.035956475883722305, "acc": 0.9951244592666626, "length": 15.510363578796387, "mode": "test", "epoch": 55}
{"loss": 0.029609156772494316, "acc": 0.9966537952423096, "length": 15.926957130432129, "mode": "train", "epoch": 56}
{"loss": 0.02643286995589733, "acc": 0.9972453117370605, "length": 14.756682395935059, "mode": "test", "epoch": 56}
{"loss": 0.02337011508643627, "acc": 0.9976476430892944, "length": 13.67476749420166, "mode": "train", "epoch": 57}
{"loss": 0.03006674535572529, "acc": 0.9960217475891113, "length": 12.930418014526367, "mode": "test", "epoch": 57}
{"loss": 0.024663399904966354, "acc": 0.997076153755188, "length": 12.997183799743652, "mode": "train", "epoch": 58}
{"loss": 0.028013087809085846, "acc": 0.9961873888969421, "length": 12.585627555847168, "mode": "test", "epoch": 58}
{"loss": 0.025182029232382774, "acc": 0.99696946144104, "length": 13.161321640014648, "mode": "train", "epoch": 59}
{"loss": 0.0526595301926136, "acc": 0.9899753928184509, "length": 13.90569019317627, "mode": "test", "epoch": 59}
{"loss": 0.02437094785273075, "acc": 0.9972977042198181, "length": 12.81174087524414, "mode": "train", "epoch": 60}
{"loss": 0.026405561715364456, "acc": 0.9969213604927063, "length": 12.902889251708984, "mode": "test", "epoch": 60}
test accuracy: 0.9965799450874329
