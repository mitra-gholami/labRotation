ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 10
{"loss": 0.5894871354103088, "acc": 0.6491148471832275, "length": 1.455345630645752, "mode": "train", "epoch": 1}
{"loss": 0.4639263451099396, "acc": 0.7912133932113647, "length": 1.7392464876174927, "mode": "test", "epoch": 1}
{"loss": 0.3316958546638489, "acc": 0.8778727054595947, "length": 2.6144933700561523, "mode": "train", "epoch": 2}
{"loss": 0.3571164309978485, "acc": 0.8662994503974915, "length": 2.5448904037475586, "mode": "test", "epoch": 2}
{"loss": 0.2617851793766022, "acc": 0.9114457964897156, "length": 2.6860382556915283, "mode": "train", "epoch": 3}
{"loss": 0.33070945739746094, "acc": 0.8780519962310791, "length": 2.6166281700134277, "mode": "test", "epoch": 3}
{"loss": 0.22293655574321747, "acc": 0.9294581413269043, "length": 2.812267303466797, "mode": "train", "epoch": 4}
{"loss": 0.30039751529693604, "acc": 0.8941823840141296, "length": 2.7494587898254395, "mode": "test", "epoch": 4}
{"loss": 0.1958748698234558, "acc": 0.9424192309379578, "length": 2.8561758995056152, "mode": "train", "epoch": 5}
{"loss": 0.2619987428188324, "acc": 0.9096720814704895, "length": 2.80899977684021, "mode": "test", "epoch": 5}
{"loss": 0.18149378895759583, "acc": 0.9485832452774048, "length": 2.8901658058166504, "mode": "train", "epoch": 6}
{"loss": 0.23173955082893372, "acc": 0.9239189624786377, "length": 2.8209078311920166, "mode": "test", "epoch": 6}
{"loss": 0.17135076224803925, "acc": 0.9530659317970276, "length": 2.9118220806121826, "mode": "train", "epoch": 7}
{"loss": 0.22913607954978943, "acc": 0.9246426820755005, "length": 2.8605659008026123, "mode": "test", "epoch": 7}
{"loss": 0.16331283748149872, "acc": 0.956291139125824, "length": 2.9355626106262207, "mode": "train", "epoch": 8}
{"loss": 0.2281540185213089, "acc": 0.9267039895057678, "length": 2.8716440200805664, "mode": "test", "epoch": 8}
{"loss": 0.15698829293251038, "acc": 0.9587078094482422, "length": 2.965991497039795, "mode": "train", "epoch": 9}
{"loss": 0.2218599170446396, "acc": 0.9308007955551147, "length": 2.950490713119507, "mode": "test", "epoch": 9}
{"loss": 0.1521102488040924, "acc": 0.9608591198921204, "length": 3.006716728210449, "mode": "train", "epoch": 10}
{"loss": 0.21083462238311768, "acc": 0.9372522830963135, "length": 2.9497690200805664, "mode": "test", "epoch": 10}
{"loss": 0.14751967787742615, "acc": 0.9624404311180115, "length": 3.023463010787964, "mode": "train", "epoch": 11}
{"loss": 0.21040959656238556, "acc": 0.93732088804245, "length": 2.974595785140991, "mode": "test", "epoch": 11}
{"loss": 0.1445196121931076, "acc": 0.9638130068778992, "length": 3.0469791889190674, "mode": "train", "epoch": 12}
{"loss": 0.203410342335701, "acc": 0.9394967555999756, "length": 3.003103256225586, "mode": "test", "epoch": 12}
{"loss": 0.14111678302288055, "acc": 0.9652529358863831, "length": 3.0559885501861572, "mode": "train", "epoch": 13}
{"loss": 0.20138494670391083, "acc": 0.9393977522850037, "length": 3.0045106410980225, "mode": "test", "epoch": 13}
{"loss": 0.13940289616584778, "acc": 0.9658651947975159, "length": 3.053241729736328, "mode": "train", "epoch": 14}
{"loss": 0.19014720618724823, "acc": 0.9429154992103577, "length": 3.0077943801879883, "mode": "test", "epoch": 14}
{"loss": 0.13692747056484222, "acc": 0.9667874574661255, "length": 3.050783395767212, "mode": "train", "epoch": 15}
{"loss": 0.1863657385110855, "acc": 0.9452536702156067, "length": 3.0194499492645264, "mode": "test", "epoch": 15}
{"loss": 0.13506361842155457, "acc": 0.9673337340354919, "length": 3.0445327758789062, "mode": "train", "epoch": 16}
{"loss": 0.183049276471138, "acc": 0.9466232061386108, "length": 3.0242133140563965, "mode": "test", "epoch": 16}
{"loss": 0.1344524770975113, "acc": 0.9676820635795593, "length": 3.06198787689209, "mode": "train", "epoch": 17}
{"loss": 0.1661602109670639, "acc": 0.9552990794181824, "length": 3.021434783935547, "mode": "test", "epoch": 17}
{"loss": 0.13271702826023102, "acc": 0.9683517813682556, "length": 3.057363986968994, "mode": "train", "epoch": 18}
{"loss": 0.17425309121608734, "acc": 0.9531695246696472, "length": 3.022120475769043, "mode": "test", "epoch": 18}
{"loss": 0.13241492211818695, "acc": 0.9683945775032043, "length": 3.0598011016845703, "mode": "train", "epoch": 19}
{"loss": 0.1621706336736679, "acc": 0.9561511874198914, "length": 3.051349639892578, "mode": "test", "epoch": 19}
{"loss": 0.130818709731102, "acc": 0.9690297842025757, "length": 3.0684242248535156, "mode": "train", "epoch": 20}
{"loss": 0.16065457463264465, "acc": 0.9568488001823425, "length": 3.0399465560913086, "mode": "test", "epoch": 20}
{"loss": 0.129916250705719, "acc": 0.9692344069480896, "length": 3.070707321166992, "mode": "train", "epoch": 21}
{"loss": 0.1586410105228424, "acc": 0.9588426351547241, "length": 3.0421478748321533, "mode": "test", "epoch": 21}
{"loss": 0.12813591957092285, "acc": 0.969841718673706, "length": 3.0721261501312256, "mode": "train", "epoch": 22}
{"loss": 0.1577412486076355, "acc": 0.9577224254608154, "length": 3.0429415702819824, "mode": "test", "epoch": 22}
{"loss": 0.1290004849433899, "acc": 0.9694865942001343, "length": 3.07527756690979, "mode": "train", "epoch": 23}
{"loss": 0.15506170690059662, "acc": 0.9597284197807312, "length": 3.0555715560913086, "mode": "test", "epoch": 23}
{"loss": 0.12924759089946747, "acc": 0.9692846536636353, "length": 3.081146717071533, "mode": "train", "epoch": 24}
{"loss": 0.16080690920352936, "acc": 0.9580113887786865, "length": 3.0708718299865723, "mode": "test", "epoch": 24}
{"loss": 0.12918943166732788, "acc": 0.9691129326820374, "length": 3.085169553756714, "mode": "train", "epoch": 25}
{"loss": 0.1561845988035202, "acc": 0.9576061964035034, "length": 3.082094430923462, "mode": "test", "epoch": 25}
{"loss": 0.1295175850391388, "acc": 0.9688268899917603, "length": 3.097818613052368, "mode": "train", "epoch": 26}
{"loss": 0.1606312096118927, "acc": 0.9571582674980164, "length": 3.081913948059082, "mode": "test", "epoch": 26}
{"loss": 0.12786546349525452, "acc": 0.9693361520767212, "length": 3.109023094177246, "mode": "train", "epoch": 27}
{"loss": 0.14478304982185364, "acc": 0.964117169380188, "length": 3.091404438018799, "mode": "test", "epoch": 27}
{"loss": 0.12552611529827118, "acc": 0.9703790545463562, "length": 3.1133646965026855, "mode": "train", "epoch": 28}
{"loss": 0.1519680917263031, "acc": 0.9624541401863098, "length": 3.1014723777770996, "mode": "test", "epoch": 28}
{"loss": 0.12433545291423798, "acc": 0.9708123207092285, "length": 3.1173667907714844, "mode": "train", "epoch": 29}
{"loss": 0.13954457640647888, "acc": 0.9660058617591858, "length": 3.095987319946289, "mode": "test", "epoch": 29}
{"loss": 0.12424591928720474, "acc": 0.9708974957466125, "length": 3.117525100708008, "mode": "train", "epoch": 30}
{"loss": 0.1394653618335724, "acc": 0.965428352355957, "length": 3.09851336479187, "mode": "test", "epoch": 30}
{"loss": 0.12251117080450058, "acc": 0.9715556502342224, "length": 3.121163845062256, "mode": "train", "epoch": 31}
{"loss": 0.145406112074852, "acc": 0.9639363884925842, "length": 3.1126227378845215, "mode": "test", "epoch": 31}
{"loss": 0.12388189136981964, "acc": 0.9710839986801147, "length": 3.1654109954833984, "mode": "train", "epoch": 32}
{"loss": 0.14180727303028107, "acc": 0.9654350876808167, "length": 3.18768048286438, "mode": "test", "epoch": 32}
{"loss": 0.12204393744468689, "acc": 0.9718217849731445, "length": 3.189558982849121, "mode": "train", "epoch": 33}
{"loss": 0.1410491019487381, "acc": 0.9664266705513, "length": 3.1863813400268555, "mode": "test", "epoch": 33}
{"loss": 0.12138018012046814, "acc": 0.972019612789154, "length": 3.1988203525543213, "mode": "train", "epoch": 34}
{"loss": 0.1342136412858963, "acc": 0.9687669277191162, "length": 3.176710367202759, "mode": "test", "epoch": 34}
{"loss": 0.11976351588964462, "acc": 0.9725151062011719, "length": 3.1936163902282715, "mode": "train", "epoch": 35}
{"loss": 0.12918290495872498, "acc": 0.9705409407615662, "length": 3.181112766265869, "mode": "test", "epoch": 35}
{"loss": 0.12060471624135971, "acc": 0.9724020957946777, "length": 3.2049472332000732, "mode": "train", "epoch": 36}
{"loss": 0.1317465752363205, "acc": 0.9695858359336853, "length": 3.1887991428375244, "mode": "test", "epoch": 36}
{"loss": 0.11895160377025604, "acc": 0.9729183912277222, "length": 3.2121171951293945, "mode": "train", "epoch": 37}
{"loss": 0.13326609134674072, "acc": 0.969183087348938, "length": 3.2071666717529297, "mode": "test", "epoch": 37}
{"loss": 0.11969529092311859, "acc": 0.9726172685623169, "length": 3.2154669761657715, "mode": "train", "epoch": 38}
{"loss": 0.13242022693157196, "acc": 0.9687275886535645, "length": 3.2090790271759033, "mode": "test", "epoch": 38}
{"loss": 0.1170458123087883, "acc": 0.9734376668930054, "length": 3.213832139968872, "mode": "train", "epoch": 39}
{"loss": 0.12635017931461334, "acc": 0.9716065526008606, "length": 3.2040271759033203, "mode": "test", "epoch": 39}
{"loss": 0.11702504754066467, "acc": 0.9734595417976379, "length": 3.214641571044922, "mode": "train", "epoch": 40}
{"loss": 0.13113266229629517, "acc": 0.9692540168762207, "length": 3.203125, "mode": "test", "epoch": 40}
{"loss": 0.11715808510780334, "acc": 0.9733288288116455, "length": 3.227780818939209, "mode": "train", "epoch": 41}
{"loss": 0.12700951099395752, "acc": 0.970650315284729, "length": 3.2038826942443848, "mode": "test", "epoch": 41}
{"loss": 0.11554167419672012, "acc": 0.9740008115768433, "length": 3.2307097911834717, "mode": "train", "epoch": 42}
{"loss": 0.12595856189727783, "acc": 0.9709497094154358, "length": 3.2199769020080566, "mode": "test", "epoch": 42}
{"loss": 0.11440033465623856, "acc": 0.9742296934127808, "length": 3.231044292449951, "mode": "train", "epoch": 43}
{"loss": 0.12306451052427292, "acc": 0.9724940061569214, "length": 3.213914632797241, "mode": "test", "epoch": 43}
{"loss": 0.11388151347637177, "acc": 0.9744434952735901, "length": 3.226219415664673, "mode": "train", "epoch": 44}
{"loss": 0.1212778240442276, "acc": 0.9733031988143921, "length": 3.2149250507354736, "mode": "test", "epoch": 44}
{"loss": 0.11382827907800674, "acc": 0.974457859992981, "length": 3.232267379760742, "mode": "train", "epoch": 45}
{"loss": 0.12667852640151978, "acc": 0.9710221290588379, "length": 3.241447687149048, "mode": "test", "epoch": 45}
{"loss": 0.1134941577911377, "acc": 0.9745367765426636, "length": 3.242093801498413, "mode": "train", "epoch": 46}
{"loss": 0.12185949832201004, "acc": 0.9731326699256897, "length": 3.233003854751587, "mode": "test", "epoch": 46}
{"loss": 0.11460397392511368, "acc": 0.9742711782455444, "length": 3.2496232986450195, "mode": "train", "epoch": 47}
{"loss": 0.12215805798768997, "acc": 0.972640872001648, "length": 3.237766981124878, "mode": "test", "epoch": 47}
{"loss": 0.11125484108924866, "acc": 0.9753873944282532, "length": 3.246428966522217, "mode": "train", "epoch": 48}
{"loss": 0.12088073790073395, "acc": 0.9731581211090088, "length": 3.239318609237671, "mode": "test", "epoch": 48}
{"loss": 0.1119934469461441, "acc": 0.9750807881355286, "length": 3.248856544494629, "mode": "train", "epoch": 49}
{"loss": 0.12150099873542786, "acc": 0.9730496406555176, "length": 3.230802536010742, "mode": "test", "epoch": 49}
{"loss": 0.11119019240140915, "acc": 0.9753603935241699, "length": 3.2459590435028076, "mode": "train", "epoch": 50}
{"loss": 0.12004058808088303, "acc": 0.9738258719444275, "length": 3.2489535808563232, "mode": "test", "epoch": 50}
{"loss": 0.1135721430182457, "acc": 0.9744654297828674, "length": 3.2481307983398438, "mode": "train", "epoch": 51}
{"loss": 0.12182232737541199, "acc": 0.9725847244262695, "length": 3.2396795749664307, "mode": "test", "epoch": 51}
{"loss": 0.111171193420887, "acc": 0.9752359986305237, "length": 3.2490346431732178, "mode": "train", "epoch": 52}
{"loss": 0.12404752522706985, "acc": 0.9725010395050049, "length": 3.237370014190674, "mode": "test", "epoch": 52}
{"loss": 0.11028549075126648, "acc": 0.9754983186721802, "length": 3.2455875873565674, "mode": "train", "epoch": 53}
{"loss": 0.116853728890419, "acc": 0.9742441773414612, "length": 3.240689992904663, "mode": "test", "epoch": 53}
{"loss": 0.10978502035140991, "acc": 0.9756984114646912, "length": 3.2522759437561035, "mode": "train", "epoch": 54}
{"loss": 0.11990978568792343, "acc": 0.9732340574264526, "length": 3.260067939758301, "mode": "test", "epoch": 54}
{"loss": 0.11175579577684402, "acc": 0.9751173257827759, "length": 3.2551074028015137, "mode": "train", "epoch": 55}
{"loss": 0.12209199368953705, "acc": 0.9730761647224426, "length": 3.2550158500671387, "mode": "test", "epoch": 55}
{"loss": 0.11016795039176941, "acc": 0.9755057096481323, "length": 3.261629343032837, "mode": "train", "epoch": 56}
{"loss": 0.11391682177782059, "acc": 0.9751175045967102, "length": 3.251659870147705, "mode": "test", "epoch": 56}
{"loss": 0.1089295819401741, "acc": 0.9759455323219299, "length": 3.261833667755127, "mode": "train", "epoch": 57}
{"loss": 0.11465583741664886, "acc": 0.9750910401344299, "length": 3.2480154037475586, "mode": "test", "epoch": 57}
{"loss": 0.10885873436927795, "acc": 0.9759728312492371, "length": 3.2552294731140137, "mode": "train", "epoch": 58}
{"loss": 0.11687937378883362, "acc": 0.9750381708145142, "length": 3.249603033065796, "mode": "test", "epoch": 58}
{"loss": 0.1097559854388237, "acc": 0.9755638837814331, "length": 3.2505080699920654, "mode": "train", "epoch": 59}
{"loss": 0.11554993689060211, "acc": 0.9750087857246399, "length": 3.2434685230255127, "mode": "test", "epoch": 59}
{"loss": 0.10774679481983185, "acc": 0.9763693809509277, "length": 3.2526931762695312, "mode": "train", "epoch": 60}
{"loss": 0.11534609645605087, "acc": 0.9753766655921936, "length": 3.2509381771087646, "mode": "test", "epoch": 60}
test accuracy: 0.9237004518508911
