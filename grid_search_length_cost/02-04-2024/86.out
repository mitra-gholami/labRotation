ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.345072478055954, "acc": 0.8495250344276428, "length": 5.789395809173584, "mode": "train", "epoch": 1}
{"loss": 0.2550407946109772, "acc": 0.9056344032287598, "length": 6.0, "mode": "test", "epoch": 1}
{"loss": 0.20468463003635406, "acc": 0.9317822456359863, "length": 5.999955654144287, "mode": "train", "epoch": 2}
{"loss": 0.20389632880687714, "acc": 0.9314044117927551, "length": 6.0, "mode": "test", "epoch": 2}
{"loss": 0.17088358104228973, "acc": 0.9470596313476562, "length": 5.999993801116943, "mode": "train", "epoch": 3}
{"loss": 0.18406444787979126, "acc": 0.941816508769989, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.1564086377620697, "acc": 0.9529250860214233, "length": 5.999999046325684, "mode": "train", "epoch": 4}
{"loss": 0.1825283169746399, "acc": 0.942345917224884, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.13858771324157715, "acc": 0.9594188332557678, "length": 6.0, "mode": "train", "epoch": 5}
{"loss": 0.17380507290363312, "acc": 0.9435654878616333, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.11638612300157547, "acc": 0.9670400619506836, "length": 6.0, "mode": "train", "epoch": 6}
{"loss": 0.16202297806739807, "acc": 0.9494543671607971, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.10574442148208618, "acc": 0.9705521464347839, "length": 6.0, "mode": "train", "epoch": 7}
{"loss": 0.17858664691448212, "acc": 0.9418123364448547, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.08861104398965836, "acc": 0.9779449701309204, "length": 6.0, "mode": "train", "epoch": 8}
{"loss": 0.13271228969097137, "acc": 0.9625220894813538, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.07868736237287521, "acc": 0.9812853932380676, "length": 6.0, "mode": "train", "epoch": 9}
{"loss": 0.14371436834335327, "acc": 0.9585745930671692, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.07024338096380234, "acc": 0.983466625213623, "length": 6.0, "mode": "train", "epoch": 10}
{"loss": 0.15278597176074982, "acc": 0.9541540741920471, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.062356673181056976, "acc": 0.9860602021217346, "length": 6.0, "mode": "train", "epoch": 11}
{"loss": 0.11353706568479538, "acc": 0.9693717360496521, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.06012296304106712, "acc": 0.9867849349975586, "length": 6.0, "mode": "train", "epoch": 12}
{"loss": 0.10426641255617142, "acc": 0.9744965434074402, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.06085851788520813, "acc": 0.9865329265594482, "length": 6.0, "mode": "train", "epoch": 13}
{"loss": 0.09948578476905823, "acc": 0.9751523733139038, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.05538097769021988, "acc": 0.9881252646446228, "length": 6.0, "mode": "train", "epoch": 14}
{"loss": 0.094143807888031, "acc": 0.9759908318519592, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.05397968366742134, "acc": 0.9880350232124329, "length": 6.0, "mode": "train", "epoch": 15}
{"loss": 0.10363402217626572, "acc": 0.9702544212341309, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.04118244722485542, "acc": 0.9909235835075378, "length": 6.0, "mode": "train", "epoch": 16}
{"loss": 0.07971818745136261, "acc": 0.97861647605896, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.030386237427592278, "acc": 0.9931467771530151, "length": 6.0, "mode": "train", "epoch": 17}
{"loss": 0.07949721068143845, "acc": 0.9782474040985107, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.024481674656271935, "acc": 0.9942564368247986, "length": 6.0, "mode": "train", "epoch": 18}
{"loss": 0.09401319921016693, "acc": 0.9696465134620667, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.017560308799147606, "acc": 0.9965506792068481, "length": 6.0, "mode": "train", "epoch": 19}
{"loss": 0.0823485404253006, "acc": 0.9764842391014099, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.016931356862187386, "acc": 0.996701717376709, "length": 6.0, "mode": "train", "epoch": 20}
{"loss": 0.10044694691896439, "acc": 0.9714037179946899, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.017683008685708046, "acc": 0.9963574409484863, "length": 6.0, "mode": "train", "epoch": 21}
{"loss": 0.13377636671066284, "acc": 0.9606467485427856, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.01456466130912304, "acc": 0.9973267316818237, "length": 6.0, "mode": "train", "epoch": 22}
{"loss": 0.12389285862445831, "acc": 0.9644155502319336, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.014977818354964256, "acc": 0.9972104430198669, "length": 6.0, "mode": "train", "epoch": 23}
{"loss": 0.08500360697507858, "acc": 0.9784780144691467, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.013670290820300579, "acc": 0.9976041316986084, "length": 6.0, "mode": "train", "epoch": 24}
{"loss": 0.08516338467597961, "acc": 0.9802049398422241, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.012864111922681332, "acc": 0.9978322386741638, "length": 6.0, "mode": "train", "epoch": 25}
{"loss": 0.11228764802217484, "acc": 0.9718770384788513, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.013159086927771568, "acc": 0.9977258443832397, "length": 6.0, "mode": "train", "epoch": 26}
{"loss": 0.09993410110473633, "acc": 0.9757663011550903, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.03295633941888809, "acc": 0.9917718172073364, "length": 6.0, "mode": "train", "epoch": 27}
{"loss": 0.06871187686920166, "acc": 0.9804837703704834, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.027587883174419403, "acc": 0.9930418133735657, "length": 6.0, "mode": "train", "epoch": 28}
{"loss": 0.05555111914873123, "acc": 0.9848163723945618, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.02399471588432789, "acc": 0.9940419793128967, "length": 6.0, "mode": "train", "epoch": 29}
{"loss": 0.05907021462917328, "acc": 0.9823873043060303, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.02208547294139862, "acc": 0.9945312142372131, "length": 6.0, "mode": "train", "epoch": 30}
{"loss": 0.04889831691980362, "acc": 0.9880134463310242, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.02327393926680088, "acc": 0.9941327571868896, "length": 6.0, "mode": "train", "epoch": 31}
{"loss": 0.04320299252867699, "acc": 0.988797664642334, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.020413720980286598, "acc": 0.9948902130126953, "length": 6.0, "mode": "train", "epoch": 32}
{"loss": 0.04408463090658188, "acc": 0.9883804321289062, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.0202926155179739, "acc": 0.9950499534606934, "length": 6.0, "mode": "train", "epoch": 33}
{"loss": 0.06412023305892944, "acc": 0.9844270944595337, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.02076316997408867, "acc": 0.9950231909751892, "length": 6.0, "mode": "train", "epoch": 34}
{"loss": 0.043054625391960144, "acc": 0.9895378947257996, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.01494732964783907, "acc": 0.9966990947723389, "length": 6.0, "mode": "train", "epoch": 35}
{"loss": 0.039973486214876175, "acc": 0.9888036847114563, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.01569068431854248, "acc": 0.9965506792068481, "length": 6.0, "mode": "train", "epoch": 36}
{"loss": 0.04783348739147186, "acc": 0.9863668084144592, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.021789979189634323, "acc": 0.9947323799133301, "length": 6.0, "mode": "train", "epoch": 37}
{"loss": 0.06314059346914291, "acc": 0.983406126499176, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.01444204431027174, "acc": 0.9969016313552856, "length": 6.0, "mode": "train", "epoch": 38}
{"loss": 0.03827532008290291, "acc": 0.9909299612045288, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.014159244485199451, "acc": 0.997043251991272, "length": 6.0, "mode": "train", "epoch": 39}
{"loss": 0.042298708111047745, "acc": 0.9898847937583923, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.01325556542724371, "acc": 0.997250497341156, "length": 6.0, "mode": "train", "epoch": 40}
{"loss": 0.05405699089169502, "acc": 0.988298237323761, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.015144567005336285, "acc": 0.9968915581703186, "length": 6.0, "mode": "train", "epoch": 41}
{"loss": 0.04096217453479767, "acc": 0.9896883368492126, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.013840259984135628, "acc": 0.9972806572914124, "length": 6.0, "mode": "train", "epoch": 42}
{"loss": 0.04826866090297699, "acc": 0.988402783870697, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.013557499274611473, "acc": 0.9974210262298584, "length": 6.0, "mode": "train", "epoch": 43}
{"loss": 0.04424988478422165, "acc": 0.9889743328094482, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.012354090809822083, "acc": 0.9976797699928284, "length": 6.0, "mode": "train", "epoch": 44}
{"loss": 0.049745749682188034, "acc": 0.9887034296989441, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.012207435443997383, "acc": 0.997654378414154, "length": 6.0, "mode": "train", "epoch": 45}
{"loss": 0.06533264368772507, "acc": 0.983574628829956, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.013074362650513649, "acc": 0.9975407123565674, "length": 6.0, "mode": "train", "epoch": 46}
{"loss": 0.042729150503873825, "acc": 0.9903622269630432, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.011965437792241573, "acc": 0.9978148341178894, "length": 6.0, "mode": "train", "epoch": 47}
{"loss": 0.03492512181401253, "acc": 0.9919086694717407, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.011135718785226345, "acc": 0.9979082942008972, "length": 6.0, "mode": "train", "epoch": 48}
{"loss": 0.03646901994943619, "acc": 0.9908295273780823, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.012267544865608215, "acc": 0.9977318048477173, "length": 6.0, "mode": "train", "epoch": 49}
{"loss": 0.05996974930167198, "acc": 0.9849627614021301, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.013233212754130363, "acc": 0.9974704384803772, "length": 6.0, "mode": "train", "epoch": 50}
{"loss": 0.03667308762669563, "acc": 0.9906349778175354, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.012809567153453827, "acc": 0.9975594282150269, "length": 6.0, "mode": "train", "epoch": 51}
{"loss": 0.03708343580365181, "acc": 0.9904906749725342, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.011032837443053722, "acc": 0.9980025887489319, "length": 6.0, "mode": "train", "epoch": 52}
{"loss": 0.033982228487730026, "acc": 0.9915417432785034, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.011141536757349968, "acc": 0.9979925751686096, "length": 6.0, "mode": "train", "epoch": 53}
{"loss": 0.04095415771007538, "acc": 0.9900614023208618, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.010159939527511597, "acc": 0.9982151985168457, "length": 6.0, "mode": "train", "epoch": 54}
{"loss": 0.02942231483757496, "acc": 0.9929617047309875, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.01234930194914341, "acc": 0.9977365732192993, "length": 6.0, "mode": "train", "epoch": 55}
{"loss": 0.04145969823002815, "acc": 0.9904745221138, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.014077268540859222, "acc": 0.9972826242446899, "length": 6.0, "mode": "train", "epoch": 56}
{"loss": 0.03259701654314995, "acc": 0.993200421333313, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.012000255286693573, "acc": 0.9978348612785339, "length": 6.0, "mode": "train", "epoch": 57}
{"loss": 0.027351681143045425, "acc": 0.9933427572250366, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.01005599182099104, "acc": 0.998216450214386, "length": 6.0, "mode": "train", "epoch": 58}
{"loss": 0.032673805952072144, "acc": 0.9917601943016052, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.011077968403697014, "acc": 0.9981076121330261, "length": 6.0, "mode": "train", "epoch": 59}
{"loss": 0.04888671636581421, "acc": 0.98928302526474, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.011882439255714417, "acc": 0.9979137182235718, "length": 6.0, "mode": "train", "epoch": 60}
{"loss": 0.028472870588302612, "acc": 0.9934951066970825, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.9803583025932312
