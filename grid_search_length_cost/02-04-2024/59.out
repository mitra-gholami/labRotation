ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 30
{"loss": 0.4334475100040436, "acc": 0.7993136048316956, "length": 7.312633991241455, "mode": "train", "epoch": 1}
{"loss": 0.40343931317329407, "acc": 0.8219178318977356, "length": 8.585919380187988, "mode": "test", "epoch": 1}
{"loss": 0.22199469804763794, "acc": 0.9286428093910217, "length": 9.189785957336426, "mode": "train", "epoch": 2}
{"loss": 0.2545495927333832, "acc": 0.9138602018356323, "length": 8.744695663452148, "mode": "test", "epoch": 2}
{"loss": 0.17673969268798828, "acc": 0.9476515054702759, "length": 9.05702018737793, "mode": "train", "epoch": 3}
{"loss": 0.22955448925495148, "acc": 0.9233880043029785, "length": 8.846997261047363, "mode": "test", "epoch": 3}
{"loss": 0.15521247684955597, "acc": 0.9555443525314331, "length": 8.93661117553711, "mode": "train", "epoch": 4}
{"loss": 0.2520885169506073, "acc": 0.9191856980323792, "length": 10.004077911376953, "mode": "test", "epoch": 4}
{"loss": 0.13860191404819489, "acc": 0.9617351293563843, "length": 8.981490135192871, "mode": "train", "epoch": 5}
{"loss": 0.20523527264595032, "acc": 0.9314467310905457, "length": 9.264145851135254, "mode": "test", "epoch": 5}
{"loss": 0.12412603199481964, "acc": 0.9673442244529724, "length": 9.21639633178711, "mode": "train", "epoch": 6}
{"loss": 0.2393314689397812, "acc": 0.9158284068107605, "length": 9.246463775634766, "mode": "test", "epoch": 6}
{"loss": 0.11558752506971359, "acc": 0.9701904058456421, "length": 9.426850318908691, "mode": "train", "epoch": 7}
{"loss": 0.19623149931430817, "acc": 0.9339166879653931, "length": 9.62319564819336, "mode": "test", "epoch": 7}
{"loss": 0.10634713619947433, "acc": 0.9731121063232422, "length": 9.609926223754883, "mode": "train", "epoch": 8}
{"loss": 0.1726115345954895, "acc": 0.943939745426178, "length": 9.77377986907959, "mode": "test", "epoch": 8}
{"loss": 0.09840136021375656, "acc": 0.976129412651062, "length": 9.466362953186035, "mode": "train", "epoch": 9}
{"loss": 0.18381135165691376, "acc": 0.9416627883911133, "length": 9.305355072021484, "mode": "test", "epoch": 9}
{"loss": 0.09027663618326187, "acc": 0.9792115092277527, "length": 9.709823608398438, "mode": "train", "epoch": 10}
{"loss": 0.17131102085113525, "acc": 0.9471889138221741, "length": 9.67198371887207, "mode": "test", "epoch": 10}
{"loss": 0.08648572862148285, "acc": 0.9805023074150085, "length": 10.158571243286133, "mode": "train", "epoch": 11}
{"loss": 0.17167843878269196, "acc": 0.9446598887443542, "length": 10.045143127441406, "mode": "test", "epoch": 11}
{"loss": 0.08462876081466675, "acc": 0.9805768728256226, "length": 10.103490829467773, "mode": "train", "epoch": 12}
{"loss": 0.1717604249715805, "acc": 0.9457483887672424, "length": 10.51551628112793, "mode": "test", "epoch": 12}
{"loss": 0.0773099958896637, "acc": 0.9824609160423279, "length": 9.734643936157227, "mode": "train", "epoch": 13}
{"loss": 0.14534129202365875, "acc": 0.9566225409507751, "length": 10.011655807495117, "mode": "test", "epoch": 13}
{"loss": 0.07392475008964539, "acc": 0.9833614230155945, "length": 9.990013122558594, "mode": "train", "epoch": 14}
{"loss": 0.1377168893814087, "acc": 0.9594361186027527, "length": 10.101616859436035, "mode": "test", "epoch": 14}
{"loss": 0.06829236447811127, "acc": 0.9850005507469177, "length": 9.971269607543945, "mode": "train", "epoch": 15}
{"loss": 0.14895696938037872, "acc": 0.9522928595542908, "length": 10.475245475769043, "mode": "test", "epoch": 15}
{"loss": 0.06636333465576172, "acc": 0.9855229258537292, "length": 10.414592742919922, "mode": "train", "epoch": 16}
{"loss": 0.13326415419578552, "acc": 0.9587596654891968, "length": 11.226255416870117, "mode": "test", "epoch": 16}
{"loss": 0.0616445392370224, "acc": 0.987183690071106, "length": 10.440730094909668, "mode": "train", "epoch": 17}
{"loss": 0.11258270591497421, "acc": 0.9684238433837891, "length": 11.067480087280273, "mode": "test", "epoch": 17}
{"loss": 0.05980590730905533, "acc": 0.9878441095352173, "length": 10.410837173461914, "mode": "train", "epoch": 18}
{"loss": 0.11379097402095795, "acc": 0.9676626324653625, "length": 10.687427520751953, "mode": "test", "epoch": 18}
{"loss": 0.05720840394496918, "acc": 0.9886814951896667, "length": 10.38585376739502, "mode": "train", "epoch": 19}
{"loss": 0.13567866384983063, "acc": 0.9566731452941895, "length": 11.024718284606934, "mode": "test", "epoch": 19}
{"loss": 0.056715644896030426, "acc": 0.9888752698898315, "length": 10.464037895202637, "mode": "train", "epoch": 20}
{"loss": 0.12366870045661926, "acc": 0.9634661674499512, "length": 11.144739151000977, "mode": "test", "epoch": 20}
{"loss": 0.05483214929699898, "acc": 0.9893171191215515, "length": 10.97390365600586, "mode": "train", "epoch": 21}
{"loss": 0.1255079060792923, "acc": 0.9620758295059204, "length": 11.450129508972168, "mode": "test", "epoch": 21}
{"loss": 0.05586841329932213, "acc": 0.9890788197517395, "length": 11.482271194458008, "mode": "train", "epoch": 22}
{"loss": 0.10734681785106659, "acc": 0.9700578451156616, "length": 13.247149467468262, "mode": "test", "epoch": 22}
{"loss": 0.052625760436058044, "acc": 0.9898719191551208, "length": 11.974225997924805, "mode": "train", "epoch": 23}
{"loss": 0.11148813366889954, "acc": 0.967233419418335, "length": 12.95969295501709, "mode": "test", "epoch": 23}
{"loss": 0.05089319497346878, "acc": 0.9899410605430603, "length": 11.557232856750488, "mode": "train", "epoch": 24}
{"loss": 0.08877071738243103, "acc": 0.9772233366966248, "length": 12.035797119140625, "mode": "test", "epoch": 24}
{"loss": 0.048558175563812256, "acc": 0.9903339147567749, "length": 11.323864936828613, "mode": "train", "epoch": 25}
{"loss": 0.1015128418803215, "acc": 0.9714614152908325, "length": 10.945077896118164, "mode": "test", "epoch": 25}
{"loss": 0.0462753102183342, "acc": 0.9907823204994202, "length": 10.577561378479004, "mode": "train", "epoch": 26}
{"loss": 0.09752574563026428, "acc": 0.9715138673782349, "length": 10.054849624633789, "mode": "test", "epoch": 26}
{"loss": 0.043393515050411224, "acc": 0.9917992949485779, "length": 10.374813079833984, "mode": "train", "epoch": 27}
{"loss": 0.0878291055560112, "acc": 0.9751826524734497, "length": 10.280817031860352, "mode": "test", "epoch": 27}
{"loss": 0.0431627556681633, "acc": 0.9918209910392761, "length": 11.108007431030273, "mode": "train", "epoch": 28}
{"loss": 0.08687948435544968, "acc": 0.9758138060569763, "length": 11.173318862915039, "mode": "test", "epoch": 28}
{"loss": 0.0420258566737175, "acc": 0.9922220706939697, "length": 11.242864608764648, "mode": "train", "epoch": 29}
{"loss": 0.07235445082187653, "acc": 0.982489824295044, "length": 10.499963760375977, "mode": "test", "epoch": 29}
{"loss": 0.041234035044908524, "acc": 0.9924806356430054, "length": 11.24237060546875, "mode": "train", "epoch": 30}
{"loss": 0.07143887132406235, "acc": 0.9827719926834106, "length": 12.967811584472656, "mode": "test", "epoch": 30}
{"loss": 0.03887052834033966, "acc": 0.9931381344795227, "length": 11.015458106994629, "mode": "train", "epoch": 31}
{"loss": 0.0707675889134407, "acc": 0.9818022847175598, "length": 11.007000923156738, "mode": "test", "epoch": 31}
{"loss": 0.040282171219587326, "acc": 0.9925169944763184, "length": 10.908731460571289, "mode": "train", "epoch": 32}
{"loss": 0.07717195898294449, "acc": 0.9793673753738403, "length": 10.886006355285645, "mode": "test", "epoch": 32}
{"loss": 0.040501534938812256, "acc": 0.9924200773239136, "length": 11.27515697479248, "mode": "train", "epoch": 33}
{"loss": 0.06859946995973587, "acc": 0.983055830001831, "length": 11.116086959838867, "mode": "test", "epoch": 33}
{"loss": 0.03735935688018799, "acc": 0.99347323179245, "length": 11.2433500289917, "mode": "train", "epoch": 34}
{"loss": 0.06123572215437889, "acc": 0.9855745434761047, "length": 11.012629508972168, "mode": "test", "epoch": 34}
{"loss": 0.03802021965384483, "acc": 0.993098795413971, "length": 11.59673023223877, "mode": "train", "epoch": 35}
{"loss": 0.06288893520832062, "acc": 0.9841678738594055, "length": 12.358545303344727, "mode": "test", "epoch": 35}
{"loss": 0.035095784813165665, "acc": 0.993929922580719, "length": 11.325251579284668, "mode": "train", "epoch": 36}
{"loss": 0.05727110430598259, "acc": 0.9864293336868286, "length": 11.580506324768066, "mode": "test", "epoch": 36}
{"loss": 0.03513519838452339, "acc": 0.9938527941703796, "length": 12.070481300354004, "mode": "train", "epoch": 37}
{"loss": 0.05114072933793068, "acc": 0.9886714220046997, "length": 11.721023559570312, "mode": "test", "epoch": 37}
{"loss": 0.03435944765806198, "acc": 0.993649959564209, "length": 11.351457595825195, "mode": "train", "epoch": 38}
{"loss": 0.05227356776595116, "acc": 0.9877188801765442, "length": 11.511077880859375, "mode": "test", "epoch": 38}
{"loss": 0.03206367790699005, "acc": 0.9944471716880798, "length": 11.130487442016602, "mode": "train", "epoch": 39}
{"loss": 0.05018426850438118, "acc": 0.9890002012252808, "length": 11.906646728515625, "mode": "test", "epoch": 39}
{"loss": 0.030622905120253563, "acc": 0.9948107600212097, "length": 10.867984771728516, "mode": "train", "epoch": 40}
{"loss": 0.04218016937375069, "acc": 0.9909511208534241, "length": 10.667256355285645, "mode": "test", "epoch": 40}
{"loss": 0.03027231991291046, "acc": 0.9947773218154907, "length": 10.397350311279297, "mode": "train", "epoch": 41}
{"loss": 0.05046786740422249, "acc": 0.9883086085319519, "length": 10.613633155822754, "mode": "test", "epoch": 41}
{"loss": 0.029500868171453476, "acc": 0.9950350522994995, "length": 10.887163162231445, "mode": "train", "epoch": 42}
{"loss": 0.04493137076497078, "acc": 0.9908708333969116, "length": 11.357101440429688, "mode": "test", "epoch": 42}
{"loss": 0.029822442680597305, "acc": 0.9947149753570557, "length": 10.441001892089844, "mode": "train", "epoch": 43}
{"loss": 0.04343682527542114, "acc": 0.9905723929405212, "length": 9.871318817138672, "mode": "test", "epoch": 43}
{"loss": 0.029154054820537567, "acc": 0.994849443435669, "length": 9.843667984008789, "mode": "train", "epoch": 44}
{"loss": 0.035957418382167816, "acc": 0.9932142496109009, "length": 9.607967376708984, "mode": "test", "epoch": 44}
{"loss": 0.029004128649830818, "acc": 0.995098352432251, "length": 10.650283813476562, "mode": "train", "epoch": 45}
{"loss": 0.03692035749554634, "acc": 0.9927989840507507, "length": 11.158090591430664, "mode": "test", "epoch": 45}
{"loss": 0.026665158569812775, "acc": 0.9958128333091736, "length": 10.936634063720703, "mode": "train", "epoch": 46}
{"loss": 0.03803008422255516, "acc": 0.9924429059028625, "length": 10.66209602355957, "mode": "test", "epoch": 46}
{"loss": 0.02786635421216488, "acc": 0.9953284859657288, "length": 10.971841812133789, "mode": "train", "epoch": 47}
{"loss": 0.03571058064699173, "acc": 0.9936452507972717, "length": 10.869731903076172, "mode": "test", "epoch": 47}
{"loss": 0.028952205553650856, "acc": 0.9950510263442993, "length": 11.005675315856934, "mode": "train", "epoch": 48}
{"loss": 0.0487501323223114, "acc": 0.9886139035224915, "length": 11.666787147521973, "mode": "test", "epoch": 48}
{"loss": 0.029358452185988426, "acc": 0.9949734807014465, "length": 11.353276252746582, "mode": "train", "epoch": 49}
{"loss": 0.04294251278042793, "acc": 0.9907875657081604, "length": 11.51551628112793, "mode": "test", "epoch": 49}
{"loss": 0.030090004205703735, "acc": 0.9946976900100708, "length": 11.316362380981445, "mode": "train", "epoch": 50}
{"loss": 0.03827078640460968, "acc": 0.9928327798843384, "length": 12.901017189025879, "mode": "test", "epoch": 50}
{"loss": 0.03209976479411125, "acc": 0.9941715002059937, "length": 11.386040687561035, "mode": "train", "epoch": 51}
{"loss": 0.041850097477436066, "acc": 0.9914270043373108, "length": 11.012521743774414, "mode": "test", "epoch": 51}
{"loss": 0.0293730478733778, "acc": 0.9949297904968262, "length": 11.452719688415527, "mode": "train", "epoch": 52}
{"loss": 0.03989725187420845, "acc": 0.9912776350975037, "length": 10.665704727172852, "mode": "test", "epoch": 52}
{"loss": 0.027501752600073814, "acc": 0.9953917264938354, "length": 10.939629554748535, "mode": "train", "epoch": 53}
{"loss": 0.037116311490535736, "acc": 0.9918413162231445, "length": 10.984338760375977, "mode": "test", "epoch": 53}
{"loss": 0.02641332522034645, "acc": 0.9956233501434326, "length": 10.99572467803955, "mode": "train", "epoch": 54}
{"loss": 0.033879127353429794, "acc": 0.9934840798377991, "length": 11.649394035339355, "mode": "test", "epoch": 54}
{"loss": 0.028097376227378845, "acc": 0.9949744939804077, "length": 11.272574424743652, "mode": "train", "epoch": 55}
{"loss": 0.03296626731753349, "acc": 0.9934422373771667, "length": 11.907368659973145, "mode": "test", "epoch": 55}
{"loss": 0.028455041348934174, "acc": 0.9949340224266052, "length": 11.601408004760742, "mode": "train", "epoch": 56}
{"loss": 0.041773632168769836, "acc": 0.990922749042511, "length": 13.91512680053711, "mode": "test", "epoch": 56}
{"loss": 0.02757592685520649, "acc": 0.9950777888298035, "length": 11.26119327545166, "mode": "train", "epoch": 57}
{"loss": 0.03025846928358078, "acc": 0.9949179291725159, "length": 13.094002723693848, "mode": "test", "epoch": 57}
{"loss": 0.0237518809735775, "acc": 0.9961735010147095, "length": 10.328042030334473, "mode": "train", "epoch": 58}
{"loss": 0.031373050063848495, "acc": 0.9937549829483032, "length": 9.98516845703125, "mode": "test", "epoch": 58}
{"loss": 0.024566423147916794, "acc": 0.9959216713905334, "length": 10.269621849060059, "mode": "train", "epoch": 59}
{"loss": 0.03792320191860199, "acc": 0.9921975135803223, "length": 10.394233703613281, "mode": "test", "epoch": 59}
{"loss": 0.026504099369049072, "acc": 0.9953044652938843, "length": 10.772902488708496, "mode": "train", "epoch": 60}
{"loss": 0.03559206426143646, "acc": 0.9930063486099243, "length": 11.356704711914062, "mode": "test", "epoch": 60}
test accuracy: 0.9865812659263611
