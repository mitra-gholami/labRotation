ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 20
{"loss": 0.6989196538925171, "acc": 0.5019813776016235, "length": 1.1171666383743286, "mode": "train", "epoch": 1}
{"loss": 0.6981396079063416, "acc": 0.5041918158531189, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6771263480186462, "acc": 0.5274614691734314, "length": 1.0452673435211182, "mode": "train", "epoch": 2}
{"loss": 0.6753721833229065, "acc": 0.5299752950668335, "length": 1.055723786354065, "mode": "test", "epoch": 2}
{"loss": 0.45398128032684326, "acc": 0.7782387137413025, "length": 1.9190007448196411, "mode": "train", "epoch": 3}
{"loss": 0.3608464300632477, "acc": 0.8598552346229553, "length": 2.358708143234253, "mode": "test", "epoch": 3}
{"loss": 0.26373231410980225, "acc": 0.9103230834007263, "length": 2.4860758781433105, "mode": "train", "epoch": 4}
{"loss": 0.32058385014533997, "acc": 0.881793200969696, "length": 2.4127378463745117, "mode": "test", "epoch": 4}
{"loss": 0.21834254264831543, "acc": 0.9335260391235352, "length": 2.5712790489196777, "mode": "train", "epoch": 5}
{"loss": 0.29136034846305847, "acc": 0.8908841609954834, "length": 2.5388553142547607, "mode": "test", "epoch": 5}
{"loss": 0.1979169398546219, "acc": 0.9435221552848816, "length": 2.6416633129119873, "mode": "train", "epoch": 6}
{"loss": 0.27000585198402405, "acc": 0.90096515417099, "length": 2.610834836959839, "mode": "test", "epoch": 6}
{"loss": 0.1878271996974945, "acc": 0.9479647278785706, "length": 2.6655049324035645, "mode": "train", "epoch": 7}
{"loss": 0.26118597388267517, "acc": 0.9074802994728088, "length": 2.627126693725586, "mode": "test", "epoch": 7}
{"loss": 0.18085773289203644, "acc": 0.9507224559783936, "length": 2.660799980163574, "mode": "train", "epoch": 8}
{"loss": 0.23781172931194305, "acc": 0.9186773896217346, "length": 2.638228178024292, "mode": "test", "epoch": 8}
{"loss": 0.17578279972076416, "acc": 0.9524222016334534, "length": 2.670020341873169, "mode": "train", "epoch": 9}
{"loss": 0.24993088841438293, "acc": 0.9104253053665161, "length": 2.6650807857513428, "mode": "test", "epoch": 9}
{"loss": 0.170716792345047, "acc": 0.9543631076812744, "length": 2.705833673477173, "mode": "train", "epoch": 10}
{"loss": 0.2338956892490387, "acc": 0.9222749471664429, "length": 2.6586649417877197, "mode": "test", "epoch": 10}
{"loss": 0.1668042093515396, "acc": 0.9558250308036804, "length": 2.731720447540283, "mode": "train", "epoch": 11}
{"loss": 0.22149276733398438, "acc": 0.9288061261177063, "length": 2.719650983810425, "mode": "test", "epoch": 11}
{"loss": 0.16245119273662567, "acc": 0.9571791887283325, "length": 2.7467336654663086, "mode": "train", "epoch": 12}
{"loss": 0.22928744554519653, "acc": 0.9213314056396484, "length": 2.745025873184204, "mode": "test", "epoch": 12}
{"loss": 0.15956875681877136, "acc": 0.9583236575126648, "length": 2.778280735015869, "mode": "train", "epoch": 13}
{"loss": 0.2313256412744522, "acc": 0.9271209239959717, "length": 2.7979023456573486, "mode": "test", "epoch": 13}
{"loss": 0.15490444004535675, "acc": 0.9603357315063477, "length": 2.810246706008911, "mode": "train", "epoch": 14}
{"loss": 0.22246778011322021, "acc": 0.9290418028831482, "length": 2.786548376083374, "mode": "test", "epoch": 14}
{"loss": 0.1525493711233139, "acc": 0.961219847202301, "length": 2.826626777648926, "mode": "train", "epoch": 15}
{"loss": 0.23503877222537994, "acc": 0.9235307574272156, "length": 2.8014345169067383, "mode": "test", "epoch": 15}
{"loss": 0.14929886162281036, "acc": 0.9624554514884949, "length": 2.8250157833099365, "mode": "train", "epoch": 16}
{"loss": 0.21948744356632233, "acc": 0.9250150918960571, "length": 2.8207180500030518, "mode": "test", "epoch": 16}
{"loss": 0.14628298580646515, "acc": 0.9638817310333252, "length": 2.832139015197754, "mode": "train", "epoch": 17}
{"loss": 0.21665392816066742, "acc": 0.9297611117362976, "length": 2.8148066997528076, "mode": "test", "epoch": 17}
{"loss": 0.14439022541046143, "acc": 0.9643966555595398, "length": 2.834723711013794, "mode": "train", "epoch": 18}
{"loss": 0.20205840468406677, "acc": 0.9346417188644409, "length": 2.81992506980896, "mode": "test", "epoch": 18}
{"loss": 0.14307163655757904, "acc": 0.9648422598838806, "length": 2.8428218364715576, "mode": "train", "epoch": 19}
{"loss": 0.19994455575942993, "acc": 0.9338219165802002, "length": 2.8178343772888184, "mode": "test", "epoch": 19}
{"loss": 0.14148782193660736, "acc": 0.9653351306915283, "length": 2.849954128265381, "mode": "train", "epoch": 20}
{"loss": 0.20209430158138275, "acc": 0.9335921406745911, "length": 2.848219394683838, "mode": "test", "epoch": 20}
{"loss": 0.1394340842962265, "acc": 0.96598219871521, "length": 2.8545570373535156, "mode": "train", "epoch": 21}
{"loss": 0.21740026772022247, "acc": 0.9360221028327942, "length": 2.855031728744507, "mode": "test", "epoch": 21}
{"loss": 0.13822264969348907, "acc": 0.9664548635482788, "length": 2.8709969520568848, "mode": "train", "epoch": 22}
{"loss": 0.21502619981765747, "acc": 0.934215247631073, "length": 2.8657727241516113, "mode": "test", "epoch": 22}
{"loss": 0.13726794719696045, "acc": 0.9667747616767883, "length": 2.8819992542266846, "mode": "train", "epoch": 23}
{"loss": 0.2056322991847992, "acc": 0.935576856136322, "length": 2.884767770767212, "mode": "test", "epoch": 23}
{"loss": 0.13598212599754333, "acc": 0.9672289490699768, "length": 2.887115716934204, "mode": "train", "epoch": 24}
{"loss": 0.19009876251220703, "acc": 0.9394499063491821, "length": 2.8800461292266846, "mode": "test", "epoch": 24}
{"loss": 0.13472771644592285, "acc": 0.9676451086997986, "length": 2.8958351612091064, "mode": "train", "epoch": 25}
{"loss": 0.19105085730552673, "acc": 0.940843403339386, "length": 2.8675389289855957, "mode": "test", "epoch": 25}
{"loss": 0.13347221910953522, "acc": 0.9680192470550537, "length": 2.8905515670776367, "mode": "train", "epoch": 26}
{"loss": 0.19445174932479858, "acc": 0.9397437572479248, "length": 2.878063678741455, "mode": "test", "epoch": 26}
{"loss": 0.1331997960805893, "acc": 0.9680699706077576, "length": 2.8875021934509277, "mode": "train", "epoch": 27}
{"loss": 0.18859301507472992, "acc": 0.9417051672935486, "length": 2.877126693725586, "mode": "test", "epoch": 27}
{"loss": 0.13226677477359772, "acc": 0.9684232473373413, "length": 2.8992764949798584, "mode": "train", "epoch": 28}
{"loss": 0.18434123694896698, "acc": 0.9455084204673767, "length": 2.877631187438965, "mode": "test", "epoch": 28}
{"loss": 0.13166770339012146, "acc": 0.9687485098838806, "length": 2.897719144821167, "mode": "train", "epoch": 29}
{"loss": 0.20691367983818054, "acc": 0.940680742263794, "length": 2.8908231258392334, "mode": "test", "epoch": 29}
{"loss": 0.13139447569847107, "acc": 0.9686726927757263, "length": 2.9055256843566895, "mode": "train", "epoch": 30}
{"loss": 0.18377470970153809, "acc": 0.9436160326004028, "length": 2.90167236328125, "mode": "test", "epoch": 30}
{"loss": 0.12986959517002106, "acc": 0.9692487716674805, "length": 2.896852493286133, "mode": "train", "epoch": 31}
{"loss": 0.17966729402542114, "acc": 0.945214033126831, "length": 2.8915441036224365, "mode": "test", "epoch": 31}
{"loss": 0.1301732212305069, "acc": 0.9690567255020142, "length": 2.902747631072998, "mode": "train", "epoch": 32}
{"loss": 0.19258877635002136, "acc": 0.9423577785491943, "length": 2.895869493484497, "mode": "test", "epoch": 32}
{"loss": 0.12935110926628113, "acc": 0.9694331288337708, "length": 2.904118537902832, "mode": "train", "epoch": 33}
{"loss": 0.17198549211025238, "acc": 0.9488136172294617, "length": 2.893021821975708, "mode": "test", "epoch": 33}
{"loss": 0.12849292159080505, "acc": 0.969739556312561, "length": 2.9077866077423096, "mode": "train", "epoch": 34}
{"loss": 0.18889406323432922, "acc": 0.9445180296897888, "length": 2.889453649520874, "mode": "test", "epoch": 34}
{"loss": 0.12774044275283813, "acc": 0.9699981212615967, "length": 2.9023349285125732, "mode": "train", "epoch": 35}
{"loss": 0.1831447184085846, "acc": 0.9454210996627808, "length": 2.88855242729187, "mode": "test", "epoch": 35}
{"loss": 0.12812480330467224, "acc": 0.9698114991188049, "length": 2.9102113246917725, "mode": "train", "epoch": 36}
{"loss": 0.17691123485565186, "acc": 0.9482830762863159, "length": 2.8915441036224365, "mode": "test", "epoch": 36}
{"loss": 0.12640172243118286, "acc": 0.9704391360282898, "length": 2.9077372550964355, "mode": "train", "epoch": 37}
{"loss": 0.18110504746437073, "acc": 0.9420726299285889, "length": 2.905637264251709, "mode": "test", "epoch": 37}
{"loss": 0.12934234738349915, "acc": 0.9691645503044128, "length": 2.9169459342956543, "mode": "train", "epoch": 38}
{"loss": 0.16818022727966309, "acc": 0.9524745941162109, "length": 2.922541856765747, "mode": "test", "epoch": 38}
{"loss": 0.13004080951213837, "acc": 0.9689005613327026, "length": 2.9187681674957275, "mode": "train", "epoch": 39}
{"loss": 0.17635023593902588, "acc": 0.94974684715271, "length": 2.8981401920318604, "mode": "test", "epoch": 39}
{"loss": 0.12569460272789001, "acc": 0.9705227017402649, "length": 2.908499002456665, "mode": "train", "epoch": 40}
{"loss": 0.16978707909584045, "acc": 0.9503018260002136, "length": 2.893526554107666, "mode": "test", "epoch": 40}
{"loss": 0.1260715126991272, "acc": 0.9703949689865112, "length": 2.9189233779907227, "mode": "train", "epoch": 41}
{"loss": 0.16473343968391418, "acc": 0.9533690810203552, "length": 2.9134228229522705, "mode": "test", "epoch": 41}
{"loss": 0.1245260238647461, "acc": 0.9709298014640808, "length": 2.915688991546631, "mode": "train", "epoch": 42}
{"loss": 0.1622735857963562, "acc": 0.9549413323402405, "length": 2.914287805557251, "mode": "test", "epoch": 42}
{"loss": 0.12409704923629761, "acc": 0.9710807800292969, "length": 2.913966178894043, "mode": "train", "epoch": 43}
{"loss": 0.1610913872718811, "acc": 0.9554162621498108, "length": 2.9018166065216064, "mode": "test", "epoch": 43}
{"loss": 0.12555895745754242, "acc": 0.9705833792686462, "length": 2.9161407947540283, "mode": "train", "epoch": 44}
{"loss": 0.1704632192850113, "acc": 0.9549825191497803, "length": 2.910719394683838, "mode": "test", "epoch": 44}
{"loss": 0.12442627549171448, "acc": 0.9707112312316895, "length": 2.915537118911743, "mode": "train", "epoch": 45}
{"loss": 0.18179382383823395, "acc": 0.9493846893310547, "length": 2.8987889289855957, "mode": "test", "epoch": 45}
{"loss": 0.12355205416679382, "acc": 0.9711177349090576, "length": 2.910008192062378, "mode": "train", "epoch": 46}
{"loss": 0.1665308177471161, "acc": 0.9534098505973816, "length": 2.911728620529175, "mode": "test", "epoch": 46}
{"loss": 0.12544064223766327, "acc": 0.9702651500701904, "length": 2.915992498397827, "mode": "train", "epoch": 47}
{"loss": 0.1682240068912506, "acc": 0.9512351155281067, "length": 2.915297031402588, "mode": "test", "epoch": 47}
{"loss": 0.12500305473804474, "acc": 0.9702246189117432, "length": 2.9116358757019043, "mode": "train", "epoch": 48}
{"loss": 0.15596239268779755, "acc": 0.9593291282653809, "length": 2.893310308456421, "mode": "test", "epoch": 48}
{"loss": 0.12493639439344406, "acc": 0.9707127213478088, "length": 2.9192216396331787, "mode": "train", "epoch": 49}
{"loss": 0.16208168864250183, "acc": 0.9532914161682129, "length": 2.9167027473449707, "mode": "test", "epoch": 49}
{"loss": 0.12327678501605988, "acc": 0.9712344408035278, "length": 2.91772198677063, "mode": "train", "epoch": 50}
{"loss": 0.15818941593170166, "acc": 0.9585461616516113, "length": 2.9062860012054443, "mode": "test", "epoch": 50}
{"loss": 0.12141577154397964, "acc": 0.9718242287635803, "length": 2.9190053939819336, "mode": "train", "epoch": 51}
{"loss": 0.158903107047081, "acc": 0.9576724767684937, "length": 2.9186489582061768, "mode": "test", "epoch": 51}
{"loss": 0.12186862528324127, "acc": 0.9716414213180542, "length": 2.9204025268554688, "mode": "train", "epoch": 52}
{"loss": 0.14689137041568756, "acc": 0.9627717733383179, "length": 2.9231185913085938, "mode": "test", "epoch": 52}
{"loss": 0.12224536389112473, "acc": 0.9715589284896851, "length": 2.928896903991699, "mode": "train", "epoch": 53}
{"loss": 0.1508510261774063, "acc": 0.9577939510345459, "length": 2.915297031402588, "mode": "test", "epoch": 53}
{"loss": 0.12208135426044464, "acc": 0.9716212153434753, "length": 2.925769805908203, "mode": "train", "epoch": 54}
{"loss": 0.15033447742462158, "acc": 0.9588180184364319, "length": 2.9211721420288086, "mode": "test", "epoch": 54}
{"loss": 0.12101495265960693, "acc": 0.972011387348175, "length": 2.9276816844940186, "mode": "train", "epoch": 55}
{"loss": 0.14979371428489685, "acc": 0.9592514038085938, "length": 2.919405937194824, "mode": "test", "epoch": 55}
{"loss": 0.12091614305973053, "acc": 0.9719346761703491, "length": 2.9273011684417725, "mode": "train", "epoch": 56}
{"loss": 0.14852389693260193, "acc": 0.961004912853241, "length": 2.9353373050689697, "mode": "test", "epoch": 56}
{"loss": 0.12089365720748901, "acc": 0.9721918702125549, "length": 2.9373130798339844, "mode": "train", "epoch": 57}
{"loss": 0.14482711255550385, "acc": 0.9634423851966858, "length": 2.9443843364715576, "mode": "test", "epoch": 57}
{"loss": 0.11944223940372467, "acc": 0.9724155068397522, "length": 2.937955617904663, "mode": "train", "epoch": 58}
{"loss": 0.14527933299541473, "acc": 0.9632384181022644, "length": 2.9364187717437744, "mode": "test", "epoch": 58}
{"loss": 0.12024947255849838, "acc": 0.9722586274147034, "length": 2.938857316970825, "mode": "train", "epoch": 59}
{"loss": 0.1451013833284378, "acc": 0.9622047543525696, "length": 2.9277682304382324, "mode": "test", "epoch": 59}
{"loss": 0.11889118701219559, "acc": 0.9725218415260315, "length": 2.936793804168701, "mode": "train", "epoch": 60}
{"loss": 0.1397262066602707, "acc": 0.9656609296798706, "length": 2.9323818683624268, "mode": "test", "epoch": 60}
test accuracy: 0.9240003228187561
