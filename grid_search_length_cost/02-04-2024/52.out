ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 10
{"loss": 0.4098791480064392, "acc": 0.8077980875968933, "length": 3.7151849269866943, "mode": "train", "epoch": 1}
{"loss": 0.35423964262008667, "acc": 0.859365701675415, "length": 3.9993512630462646, "mode": "test", "epoch": 1}
{"loss": 0.2274126559495926, "acc": 0.923953652381897, "length": 4.39655065536499, "mode": "train", "epoch": 2}
{"loss": 0.25556260347366333, "acc": 0.9067278504371643, "length": 4.609068393707275, "mode": "test", "epoch": 2}
{"loss": 0.18209175765514374, "acc": 0.9454697370529175, "length": 4.473211288452148, "mode": "train", "epoch": 3}
{"loss": 0.20675763487815857, "acc": 0.9361736178398132, "length": 4.171244144439697, "mode": "test", "epoch": 3}
{"loss": 0.15685313940048218, "acc": 0.9574605822563171, "length": 4.335049152374268, "mode": "train", "epoch": 4}
{"loss": 0.1728689819574356, "acc": 0.949214518070221, "length": 4.123630523681641, "mode": "test", "epoch": 4}
{"loss": 0.14718547463417053, "acc": 0.9611564874649048, "length": 4.197514057159424, "mode": "train", "epoch": 5}
{"loss": 0.16546210646629333, "acc": 0.9535049796104431, "length": 4.126729965209961, "mode": "test", "epoch": 5}
{"loss": 0.1447225958108902, "acc": 0.9615485668182373, "length": 4.149960517883301, "mode": "train", "epoch": 6}
{"loss": 0.1584182232618332, "acc": 0.9570803046226501, "length": 4.047145366668701, "mode": "test", "epoch": 6}
{"loss": 0.14119331538677216, "acc": 0.9626222252845764, "length": 4.132697582244873, "mode": "train", "epoch": 7}
{"loss": 0.1506769359111786, "acc": 0.960057258605957, "length": 4.053164482116699, "mode": "test", "epoch": 7}
{"loss": 0.13572636246681213, "acc": 0.9647547006607056, "length": 4.088216304779053, "mode": "train", "epoch": 8}
{"loss": 0.14375810325145721, "acc": 0.9624040126800537, "length": 3.9866278171539307, "mode": "test", "epoch": 8}
{"loss": 0.13081596791744232, "acc": 0.9662932753562927, "length": 4.029282093048096, "mode": "train", "epoch": 9}
{"loss": 0.1382720172405243, "acc": 0.9643579125404358, "length": 4.000576496124268, "mode": "test", "epoch": 9}
{"loss": 0.129100501537323, "acc": 0.9664911031723022, "length": 4.0588884353637695, "mode": "train", "epoch": 10}
{"loss": 0.13252663612365723, "acc": 0.9664627909660339, "length": 4.01751708984375, "mode": "test", "epoch": 10}
{"loss": 0.12224176526069641, "acc": 0.9692903757095337, "length": 4.129721641540527, "mode": "train", "epoch": 11}
{"loss": 0.13030476868152618, "acc": 0.9666060209274292, "length": 4.127594947814941, "mode": "test", "epoch": 11}
{"loss": 0.11758749932050705, "acc": 0.970496416091919, "length": 4.183549404144287, "mode": "train", "epoch": 12}
{"loss": 0.12866081297397614, "acc": 0.9678248763084412, "length": 4.165693283081055, "mode": "test", "epoch": 12}
{"loss": 0.11337485164403915, "acc": 0.972128689289093, "length": 4.21637487411499, "mode": "train", "epoch": 13}
{"loss": 0.11990004777908325, "acc": 0.9699193835258484, "length": 4.171712875366211, "mode": "test", "epoch": 13}
{"loss": 0.10821328312158585, "acc": 0.9740667343139648, "length": 4.226693630218506, "mode": "train", "epoch": 14}
{"loss": 0.11554752290248871, "acc": 0.971829891204834, "length": 4.162774085998535, "mode": "test", "epoch": 14}
{"loss": 0.10565469413995743, "acc": 0.9748818278312683, "length": 4.199827194213867, "mode": "train", "epoch": 15}
{"loss": 0.1103026270866394, "acc": 0.9731865525245667, "length": 4.222030162811279, "mode": "test", "epoch": 15}
{"loss": 0.10276476293802261, "acc": 0.9756823778152466, "length": 4.202691555023193, "mode": "train", "epoch": 16}
{"loss": 0.10797491669654846, "acc": 0.9746707677841187, "length": 4.189085960388184, "mode": "test", "epoch": 16}
{"loss": 0.10195959359407425, "acc": 0.9757115840911865, "length": 4.191847324371338, "mode": "train", "epoch": 17}
{"loss": 0.10468751937150955, "acc": 0.9754880666732788, "length": 4.176290512084961, "mode": "test", "epoch": 17}
{"loss": 0.09782426804304123, "acc": 0.9770673513412476, "length": 4.187431335449219, "mode": "train", "epoch": 18}
{"loss": 0.10095910727977753, "acc": 0.9773863554000854, "length": 4.150915622711182, "mode": "test", "epoch": 18}
{"loss": 0.09566699713468552, "acc": 0.9778162837028503, "length": 4.174078941345215, "mode": "train", "epoch": 19}
{"loss": 0.10111404955387115, "acc": 0.9769792556762695, "length": 4.168036460876465, "mode": "test", "epoch": 19}
{"loss": 0.09336472302675247, "acc": 0.9785192608833313, "length": 4.187363147735596, "mode": "train", "epoch": 20}
{"loss": 0.10110992938280106, "acc": 0.9772300124168396, "length": 4.221164703369141, "mode": "test", "epoch": 20}
{"loss": 0.0937114953994751, "acc": 0.9784584045410156, "length": 4.211691379547119, "mode": "train", "epoch": 21}
{"loss": 0.09674037247896194, "acc": 0.9778022170066833, "length": 4.1938796043396, "mode": "test", "epoch": 21}
{"loss": 0.09171264618635178, "acc": 0.9789698719978333, "length": 4.211048126220703, "mode": "train", "epoch": 22}
{"loss": 0.0959482342004776, "acc": 0.9784947037696838, "length": 4.20501708984375, "mode": "test", "epoch": 22}
{"loss": 0.09109913557767868, "acc": 0.9790859222412109, "length": 4.218692779541016, "mode": "train", "epoch": 23}
{"loss": 0.09477140754461288, "acc": 0.9780580997467041, "length": 4.19820499420166, "mode": "test", "epoch": 23}
{"loss": 0.08979011327028275, "acc": 0.979504406452179, "length": 4.236311912536621, "mode": "train", "epoch": 24}
{"loss": 0.09174760431051254, "acc": 0.9794563055038452, "length": 4.228662014007568, "mode": "test", "epoch": 24}
{"loss": 0.08872555196285248, "acc": 0.9798545837402344, "length": 4.251351833343506, "mode": "train", "epoch": 25}
{"loss": 0.09193286299705505, "acc": 0.9794961214065552, "length": 4.20736026763916, "mode": "test", "epoch": 25}
{"loss": 0.08703974634408951, "acc": 0.9803538918495178, "length": 4.241437911987305, "mode": "train", "epoch": 26}
{"loss": 0.08953773230314255, "acc": 0.9803745746612549, "length": 4.223543643951416, "mode": "test", "epoch": 26}
{"loss": 0.0869867354631424, "acc": 0.9803071022033691, "length": 4.246605396270752, "mode": "train", "epoch": 27}
{"loss": 0.09076106548309326, "acc": 0.9791849851608276, "length": 4.225165843963623, "mode": "test", "epoch": 27}
{"loss": 0.086277537047863, "acc": 0.9804714918136597, "length": 4.261220932006836, "mode": "train", "epoch": 28}
{"loss": 0.08900117874145508, "acc": 0.9801653623580933, "length": 4.235294342041016, "mode": "test", "epoch": 28}
{"loss": 0.08483937382698059, "acc": 0.9807060956954956, "length": 4.275450706481934, "mode": "train", "epoch": 29}
{"loss": 0.09047695994377136, "acc": 0.9799637198448181, "length": 4.327385902404785, "mode": "test", "epoch": 29}
{"loss": 0.08515096455812454, "acc": 0.9807507991790771, "length": 4.2897629737854, "mode": "train", "epoch": 30}
{"loss": 0.09205886721611023, "acc": 0.9800239205360413, "length": 4.273897171020508, "mode": "test", "epoch": 30}
{"loss": 0.08381254225969315, "acc": 0.981074333190918, "length": 4.303735256195068, "mode": "train", "epoch": 31}
{"loss": 0.08671924471855164, "acc": 0.9812172651290894, "length": 4.285971641540527, "mode": "test", "epoch": 31}
{"loss": 0.08257008343935013, "acc": 0.9813480377197266, "length": 4.322511196136475, "mode": "train", "epoch": 32}
{"loss": 0.08482671529054642, "acc": 0.98124098777771, "length": 4.293180465698242, "mode": "test", "epoch": 32}
{"loss": 0.08065806329250336, "acc": 0.9818865656852722, "length": 4.328001499176025, "mode": "train", "epoch": 33}
{"loss": 0.08324077725410461, "acc": 0.9816974997520447, "length": 4.330557823181152, "mode": "test", "epoch": 33}
{"loss": 0.07865099608898163, "acc": 0.9823967218399048, "length": 4.3234992027282715, "mode": "train", "epoch": 34}
{"loss": 0.08227961510419846, "acc": 0.981715738773346, "length": 4.3058319091796875, "mode": "test", "epoch": 34}
{"loss": 0.07993315160274506, "acc": 0.9820383191108704, "length": 4.329173564910889, "mode": "train", "epoch": 35}
{"loss": 0.08564233034849167, "acc": 0.9816970825195312, "length": 4.324430465698242, "mode": "test", "epoch": 35}
{"loss": 0.077830009162426, "acc": 0.9827012419700623, "length": 4.33330774307251, "mode": "train", "epoch": 36}
{"loss": 0.08773010969161987, "acc": 0.980589747428894, "length": 4.351860046386719, "mode": "test", "epoch": 36}
{"loss": 0.0776011273264885, "acc": 0.9826443195343018, "length": 4.342001438140869, "mode": "train", "epoch": 37}
{"loss": 0.08234690874814987, "acc": 0.9816985130310059, "length": 4.357230186462402, "mode": "test", "epoch": 37}
{"loss": 0.07508677244186401, "acc": 0.9833325743675232, "length": 4.345709800720215, "mode": "train", "epoch": 38}
{"loss": 0.07811614125967026, "acc": 0.9832914471626282, "length": 4.333008766174316, "mode": "test", "epoch": 38}
{"loss": 0.07480040192604065, "acc": 0.9833297729492188, "length": 4.348221778869629, "mode": "train", "epoch": 39}
{"loss": 0.07759187370538712, "acc": 0.9833128452301025, "length": 4.350598335266113, "mode": "test", "epoch": 39}
{"loss": 0.07402294129133224, "acc": 0.9836311936378479, "length": 4.343326091766357, "mode": "train", "epoch": 40}
{"loss": 0.07677110284566879, "acc": 0.9834192991256714, "length": 4.357770919799805, "mode": "test", "epoch": 40}
{"loss": 0.0726834088563919, "acc": 0.9838950037956238, "length": 4.361039638519287, "mode": "train", "epoch": 41}
{"loss": 0.0771750658750534, "acc": 0.9832231402397156, "length": 4.355716705322266, "mode": "test", "epoch": 41}
{"loss": 0.07129644602537155, "acc": 0.9843357801437378, "length": 4.362111568450928, "mode": "train", "epoch": 42}
{"loss": 0.07602962106466293, "acc": 0.9840179681777954, "length": 4.343389511108398, "mode": "test", "epoch": 42}
{"loss": 0.0711694061756134, "acc": 0.9843833446502686, "length": 4.341137409210205, "mode": "train", "epoch": 43}
{"loss": 0.07514739781618118, "acc": 0.98421311378479, "length": 4.343605995178223, "mode": "test", "epoch": 43}
{"loss": 0.06873151659965515, "acc": 0.9850594997406006, "length": 4.34065580368042, "mode": "train", "epoch": 44}
{"loss": 0.0736042782664299, "acc": 0.9844608902931213, "length": 4.317221641540527, "mode": "test", "epoch": 44}
{"loss": 0.06913864612579346, "acc": 0.9849746823310852, "length": 4.330078125, "mode": "train", "epoch": 45}
{"loss": 0.07505399733781815, "acc": 0.983908474445343, "length": 4.303524971008301, "mode": "test", "epoch": 45}
{"loss": 0.06778908520936966, "acc": 0.9853329658508301, "length": 4.3425750732421875, "mode": "train", "epoch": 46}
{"loss": 0.07462873309850693, "acc": 0.9833487272262573, "length": 4.329801082611084, "mode": "test", "epoch": 46}
{"loss": 0.06860896944999695, "acc": 0.9849342703819275, "length": 4.345912456512451, "mode": "train", "epoch": 47}
{"loss": 0.06994475424289703, "acc": 0.9855026602745056, "length": 4.354491233825684, "mode": "test", "epoch": 47}
{"loss": 0.06652099639177322, "acc": 0.985669732093811, "length": 4.358440399169922, "mode": "train", "epoch": 48}
{"loss": 0.07560177147388458, "acc": 0.9840922951698303, "length": 4.382136821746826, "mode": "test", "epoch": 48}
{"loss": 0.06727802008390427, "acc": 0.9855358004570007, "length": 4.349672317504883, "mode": "train", "epoch": 49}
{"loss": 0.07017411291599274, "acc": 0.9850530624389648, "length": 4.351139068603516, "mode": "test", "epoch": 49}
{"loss": 0.06544224917888641, "acc": 0.9860014319419861, "length": 4.372264862060547, "mode": "train", "epoch": 50}
{"loss": 0.07080864906311035, "acc": 0.9856270551681519, "length": 4.356293201446533, "mode": "test", "epoch": 50}
{"loss": 0.06631556153297424, "acc": 0.9857291579246521, "length": 4.3721537590026855, "mode": "train", "epoch": 51}
{"loss": 0.0672617182135582, "acc": 0.9863099455833435, "length": 4.38941764831543, "mode": "test", "epoch": 51}
{"loss": 0.06387495994567871, "acc": 0.9863799214363098, "length": 4.374619483947754, "mode": "train", "epoch": 52}
{"loss": 0.06723351031541824, "acc": 0.986670970916748, "length": 4.379073143005371, "mode": "test", "epoch": 52}
{"loss": 0.06393218785524368, "acc": 0.9863671660423279, "length": 4.367280960083008, "mode": "train", "epoch": 53}
{"loss": 0.06600601971149445, "acc": 0.986606240272522, "length": 4.354563236236572, "mode": "test", "epoch": 53}
{"loss": 0.0642666220664978, "acc": 0.9862573146820068, "length": 4.3426618576049805, "mode": "train", "epoch": 54}
{"loss": 0.06820562481880188, "acc": 0.9858772158622742, "length": 4.341371059417725, "mode": "test", "epoch": 54}
{"loss": 0.06441313028335571, "acc": 0.9862771034240723, "length": 4.384706974029541, "mode": "train", "epoch": 55}
{"loss": 0.06491488218307495, "acc": 0.9868637323379517, "length": 4.3793253898620605, "mode": "test", "epoch": 55}
{"loss": 0.061390798538923264, "acc": 0.9870518445968628, "length": 4.360900402069092, "mode": "train", "epoch": 56}
{"loss": 0.07063034176826477, "acc": 0.9847832322120667, "length": 4.3549957275390625, "mode": "test", "epoch": 56}
{"loss": 0.0665329098701477, "acc": 0.9854646325111389, "length": 4.361727714538574, "mode": "train", "epoch": 57}
{"loss": 0.07068034261465073, "acc": 0.9855221509933472, "length": 4.3816680908203125, "mode": "test", "epoch": 57}
{"loss": 0.06420581042766571, "acc": 0.9861344695091248, "length": 4.381832122802734, "mode": "train", "epoch": 58}
{"loss": 0.06753363460302353, "acc": 0.9862226843833923, "length": 4.3789286613464355, "mode": "test", "epoch": 58}
{"loss": 0.061101362109184265, "acc": 0.9872149229049683, "length": 4.390656471252441, "mode": "train", "epoch": 59}
{"loss": 0.06557834893465042, "acc": 0.9868765473365784, "length": 4.394103050231934, "mode": "test", "epoch": 59}
{"loss": 0.06332620978355408, "acc": 0.9865172505378723, "length": 4.402402877807617, "mode": "train", "epoch": 60}
{"loss": 0.07038488239049911, "acc": 0.9849432706832886, "length": 4.4156575202941895, "mode": "test", "epoch": 60}
test accuracy: 0.9520053863525391
