ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.7110421657562256, "acc": 0.5091791749000549, "length": 3.0231053829193115, "mode": "train", "epoch": 1}
{"loss": 0.699280858039856, "acc": 0.5110242962837219, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6758269667625427, "acc": 0.5915411710739136, "length": 1.5265437364578247, "mode": "train", "epoch": 2}
{"loss": 0.6170477867126465, "acc": 0.6476833820343018, "length": 1.46875, "mode": "test", "epoch": 2}
{"loss": 0.6088640689849854, "acc": 0.6607523560523987, "length": 1.6328033208847046, "mode": "train", "epoch": 3}
{"loss": 0.6203265190124512, "acc": 0.6321126818656921, "length": 1.2430555820465088, "mode": "test", "epoch": 3}
{"loss": 0.5826412439346313, "acc": 0.6948495507240295, "length": 1.7165275812149048, "mode": "train", "epoch": 4}
{"loss": 0.5829908847808838, "acc": 0.7039875984191895, "length": 1.6371527910232544, "mode": "test", "epoch": 4}
{"loss": 0.5380442142486572, "acc": 0.7401213049888611, "length": 1.962463140487671, "mode": "train", "epoch": 5}
{"loss": 0.5508830547332764, "acc": 0.7213513851165771, "length": 1.7482638359069824, "mode": "test", "epoch": 5}
{"loss": 0.5034013390541077, "acc": 0.7683040499687195, "length": 2.0311925411224365, "mode": "train", "epoch": 6}
{"loss": 0.5176395773887634, "acc": 0.7705512046813965, "length": 2.0833332538604736, "mode": "test", "epoch": 6}
{"loss": 0.48331090807914734, "acc": 0.786410927772522, "length": 2.1070449352264404, "mode": "train", "epoch": 7}
{"loss": 0.5115507245063782, "acc": 0.7739936113357544, "length": 2.024305582046509, "mode": "test", "epoch": 7}
{"loss": 0.456678181886673, "acc": 0.8006685376167297, "length": 2.031233549118042, "mode": "train", "epoch": 8}
{"loss": 0.4770366847515106, "acc": 0.8043429851531982, "length": 1.9513888359069824, "mode": "test", "epoch": 8}
{"loss": 0.42083120346069336, "acc": 0.8216478824615479, "length": 2.2415425777435303, "mode": "train", "epoch": 9}
{"loss": 0.44755351543426514, "acc": 0.7940835952758789, "length": 1.96875, "mode": "test", "epoch": 9}
{"loss": 0.38708457350730896, "acc": 0.8396058678627014, "length": 2.5001091957092285, "mode": "train", "epoch": 10}
{"loss": 0.40135133266448975, "acc": 0.8401421308517456, "length": 2.6076388359069824, "mode": "test", "epoch": 10}
{"loss": 0.35146141052246094, "acc": 0.856328547000885, "length": 3.015612840652466, "mode": "train", "epoch": 11}
{"loss": 0.3876381516456604, "acc": 0.8471761345863342, "length": 2.7951388359069824, "mode": "test", "epoch": 11}
{"loss": 0.328991174697876, "acc": 0.8675740957260132, "length": 3.205277442932129, "mode": "train", "epoch": 12}
{"loss": 0.337981253862381, "acc": 0.8734564185142517, "length": 3.222222328186035, "mode": "test", "epoch": 12}
{"loss": 0.3094595670700073, "acc": 0.8804631233215332, "length": 3.5372676849365234, "mode": "train", "epoch": 13}
{"loss": 0.33823931217193604, "acc": 0.8702528476715088, "length": 3.612847328186035, "mode": "test", "epoch": 13}
{"loss": 0.29190516471862793, "acc": 0.893031656742096, "length": 3.572788953781128, "mode": "train", "epoch": 14}
{"loss": 0.3159100413322449, "acc": 0.8838732242584229, "length": 3.4114582538604736, "mode": "test", "epoch": 14}
{"loss": 0.27638548612594604, "acc": 0.9010375738143921, "length": 3.540759325027466, "mode": "train", "epoch": 15}
{"loss": 0.3213457465171814, "acc": 0.8774440884590149, "length": 3.381944417953491, "mode": "test", "epoch": 15}
{"loss": 0.2716330289840698, "acc": 0.9045032858848572, "length": 3.574291706085205, "mode": "train", "epoch": 16}
{"loss": 0.31791257858276367, "acc": 0.8829671740531921, "length": 3.65625, "mode": "test", "epoch": 16}
{"loss": 0.2626900374889374, "acc": 0.9091893434524536, "length": 3.5937533378601074, "mode": "train", "epoch": 17}
{"loss": 0.32669126987457275, "acc": 0.8693658113479614, "length": 3.5260417461395264, "mode": "test", "epoch": 17}
{"loss": 0.25825023651123047, "acc": 0.9081706404685974, "length": 3.6595869064331055, "mode": "train", "epoch": 18}
{"loss": 0.2990933656692505, "acc": 0.8913846611976624, "length": 3.46875, "mode": "test", "epoch": 18}
{"loss": 0.24926747381687164, "acc": 0.9148941040039062, "length": 3.6582210063934326, "mode": "train", "epoch": 19}
{"loss": 0.3004237413406372, "acc": 0.8925591707229614, "length": 3.571180582046509, "mode": "test", "epoch": 19}
{"loss": 0.24314461648464203, "acc": 0.9182627201080322, "length": 3.8524818420410156, "mode": "train", "epoch": 20}
{"loss": 0.2837512493133545, "acc": 0.8982448577880859, "length": 3.6875, "mode": "test", "epoch": 20}
{"loss": 0.23737862706184387, "acc": 0.9188716411590576, "length": 3.8310763835906982, "mode": "train", "epoch": 21}
{"loss": 0.314855694770813, "acc": 0.8779486417770386, "length": 3.6857638359069824, "mode": "test", "epoch": 21}
{"loss": 0.2326619029045105, "acc": 0.9208652377128601, "length": 3.8873000144958496, "mode": "train", "epoch": 22}
{"loss": 0.29811686277389526, "acc": 0.8886991143226624, "length": 3.949652671813965, "mode": "test", "epoch": 22}
{"loss": 0.22580458223819733, "acc": 0.9247962832450867, "length": 3.940840721130371, "mode": "train", "epoch": 23}
{"loss": 0.29477134346961975, "acc": 0.8873996138572693, "length": 3.8802082538604736, "mode": "test", "epoch": 23}
{"loss": 0.2226683348417282, "acc": 0.9251091480255127, "length": 3.9451494216918945, "mode": "train", "epoch": 24}
{"loss": 0.2502990961074829, "acc": 0.9150335788726807, "length": 3.8420138359069824, "mode": "test", "epoch": 24}
{"loss": 0.21544598042964935, "acc": 0.9289573431015015, "length": 4.081116676330566, "mode": "train", "epoch": 25}
{"loss": 0.24917112290859222, "acc": 0.9201198220252991, "length": 3.953125, "mode": "test", "epoch": 25}
{"loss": 0.20961295068264008, "acc": 0.9330933690071106, "length": 4.153783321380615, "mode": "train", "epoch": 26}
{"loss": 0.2323542684316635, "acc": 0.9237331748008728, "length": 3.984375, "mode": "test", "epoch": 26}
{"loss": 0.2006252408027649, "acc": 0.9352139234542847, "length": 4.163936138153076, "mode": "train", "epoch": 27}
{"loss": 0.22517487406730652, "acc": 0.9281412959098816, "length": 4.06944465637207, "mode": "test", "epoch": 27}
{"loss": 0.18838079273700714, "acc": 0.9416583776473999, "length": 4.177164077758789, "mode": "train", "epoch": 28}
{"loss": 0.221021831035614, "acc": 0.9277180433273315, "length": 4.07118034362793, "mode": "test", "epoch": 28}
{"loss": 0.17952792346477509, "acc": 0.9446841478347778, "length": 4.255974292755127, "mode": "train", "epoch": 29}
{"loss": 0.21928392350673676, "acc": 0.9288520812988281, "length": 4.104166507720947, "mode": "test", "epoch": 29}
{"loss": 0.17365676164627075, "acc": 0.946419894695282, "length": 4.251593589782715, "mode": "train", "epoch": 30}
{"loss": 0.2230793684720993, "acc": 0.9331840872764587, "length": 4.161458492279053, "mode": "test", "epoch": 30}
{"loss": 0.16916099190711975, "acc": 0.9502601623535156, "length": 4.308096408843994, "mode": "train", "epoch": 31}
{"loss": 0.20212577283382416, "acc": 0.9337673187255859, "length": 4.206597328186035, "mode": "test", "epoch": 31}
{"loss": 0.1601557582616806, "acc": 0.9528592228889465, "length": 4.362236499786377, "mode": "train", "epoch": 32}
{"loss": 0.18891531229019165, "acc": 0.9419649839401245, "length": 4.260416507720947, "mode": "test", "epoch": 32}
{"loss": 0.1552584022283554, "acc": 0.9548191428184509, "length": 4.4036993980407715, "mode": "train", "epoch": 33}
{"loss": 0.1894356608390808, "acc": 0.9410671591758728, "length": 4.295138835906982, "mode": "test", "epoch": 33}
{"loss": 0.14678515493869781, "acc": 0.9574484825134277, "length": 4.34067440032959, "mode": "train", "epoch": 34}
{"loss": 0.17445319890975952, "acc": 0.9489826560020447, "length": 4.35243034362793, "mode": "test", "epoch": 34}
{"loss": 0.14092081785202026, "acc": 0.9620645642280579, "length": 4.371855735778809, "mode": "train", "epoch": 35}
{"loss": 0.1831417679786682, "acc": 0.9433322548866272, "length": 4.276041507720947, "mode": "test", "epoch": 35}
{"loss": 0.1375822126865387, "acc": 0.9628785252571106, "length": 4.341185569763184, "mode": "train", "epoch": 36}
{"loss": 0.17705807089805603, "acc": 0.9482476115226746, "length": 4.246527671813965, "mode": "test", "epoch": 36}
{"loss": 0.1426752507686615, "acc": 0.9604688286781311, "length": 4.404634952545166, "mode": "train", "epoch": 37}
{"loss": 0.19535253942012787, "acc": 0.9442138671875, "length": 4.34375, "mode": "test", "epoch": 37}
{"loss": 0.1368079036474228, "acc": 0.9630730152130127, "length": 4.426031112670898, "mode": "train", "epoch": 38}
{"loss": 0.16345469653606415, "acc": 0.9562012553215027, "length": 4.201388835906982, "mode": "test", "epoch": 38}
{"loss": 0.1325882524251938, "acc": 0.9646776914596558, "length": 4.343311309814453, "mode": "train", "epoch": 39}
{"loss": 0.1704164743423462, "acc": 0.9539876580238342, "length": 4.30555534362793, "mode": "test", "epoch": 39}
{"loss": 0.12718233466148376, "acc": 0.9666697978973389, "length": 4.3352155685424805, "mode": "train", "epoch": 40}
{"loss": 0.16268028318881989, "acc": 0.9510769248008728, "length": 4.347222328186035, "mode": "test", "epoch": 40}
{"loss": 0.12270260602235794, "acc": 0.9694318175315857, "length": 4.355301380157471, "mode": "train", "epoch": 41}
{"loss": 0.17245541512966156, "acc": 0.9508355259895325, "length": 4.223958492279053, "mode": "test", "epoch": 41}
{"loss": 0.12324060499668121, "acc": 0.9687021374702454, "length": 4.373177528381348, "mode": "train", "epoch": 42}
{"loss": 0.160999596118927, "acc": 0.9526963829994202, "length": 4.364583492279053, "mode": "test", "epoch": 42}
{"loss": 0.11897825449705124, "acc": 0.9700944423675537, "length": 4.3571085929870605, "mode": "train", "epoch": 43}
{"loss": 0.15878081321716309, "acc": 0.9577745795249939, "length": 4.25694465637207, "mode": "test", "epoch": 43}
{"loss": 0.1282677948474884, "acc": 0.9669376611709595, "length": 4.355868339538574, "mode": "train", "epoch": 44}
{"loss": 0.15486644208431244, "acc": 0.9581868052482605, "length": 4.22569465637207, "mode": "test", "epoch": 44}
{"loss": 0.11307559907436371, "acc": 0.9725943207740784, "length": 4.321783542633057, "mode": "train", "epoch": 45}
{"loss": 0.13762766122817993, "acc": 0.963536262512207, "length": 4.262152671813965, "mode": "test", "epoch": 45}
{"loss": 0.10932308435440063, "acc": 0.9745172262191772, "length": 4.292140483856201, "mode": "train", "epoch": 46}
{"loss": 0.13847015798091888, "acc": 0.9617730379104614, "length": 4.168402671813965, "mode": "test", "epoch": 46}
{"loss": 0.11815731227397919, "acc": 0.9704320430755615, "length": 4.342139720916748, "mode": "train", "epoch": 47}
{"loss": 0.14758926630020142, "acc": 0.9573811292648315, "length": 4.22569465637207, "mode": "test", "epoch": 47}
{"loss": 0.10755863785743713, "acc": 0.9734240174293518, "length": 4.299681663513184, "mode": "train", "epoch": 48}
{"loss": 0.13401223719120026, "acc": 0.9635903835296631, "length": 4.208333492279053, "mode": "test", "epoch": 48}
{"loss": 0.11108806729316711, "acc": 0.9697368144989014, "length": 4.285796165466309, "mode": "train", "epoch": 49}
{"loss": 0.1448480486869812, "acc": 0.9590522050857544, "length": 4.220486164093018, "mode": "test", "epoch": 49}
{"loss": 0.10379020869731903, "acc": 0.9735687375068665, "length": 4.2996826171875, "mode": "train", "epoch": 50}
{"loss": 0.14224743843078613, "acc": 0.9645237326622009, "length": 4.239583492279053, "mode": "test", "epoch": 50}
{"loss": 0.09611229598522186, "acc": 0.9763777256011963, "length": 4.293516159057617, "mode": "train", "epoch": 51}
{"loss": 0.1280863732099533, "acc": 0.9695149660110474, "length": 4.203125, "mode": "test", "epoch": 51}
{"loss": 0.09067049622535706, "acc": 0.979270875453949, "length": 4.280239582061768, "mode": "train", "epoch": 52}
{"loss": 0.14012348651885986, "acc": 0.967719316482544, "length": 4.208333492279053, "mode": "test", "epoch": 52}
{"loss": 0.08627273887395859, "acc": 0.9811277985572815, "length": 4.306425094604492, "mode": "train", "epoch": 53}
{"loss": 0.12114596366882324, "acc": 0.9717422127723694, "length": 4.177083492279053, "mode": "test", "epoch": 53}
{"loss": 0.08348151296377182, "acc": 0.9828658699989319, "length": 4.291029930114746, "mode": "train", "epoch": 54}
{"loss": 0.12087452411651611, "acc": 0.9719780683517456, "length": 4.276041507720947, "mode": "test", "epoch": 54}
{"loss": 0.08134616166353226, "acc": 0.9823702573776245, "length": 4.331456184387207, "mode": "train", "epoch": 55}
{"loss": 0.10668472945690155, "acc": 0.9756537675857544, "length": 4.279513835906982, "mode": "test", "epoch": 55}
{"loss": 0.07824379205703735, "acc": 0.9834723472595215, "length": 4.298807621002197, "mode": "train", "epoch": 56}
{"loss": 0.10502684861421585, "acc": 0.9780706763267517, "length": 4.230902671813965, "mode": "test", "epoch": 56}
{"loss": 0.08089791983366013, "acc": 0.9826505184173584, "length": 4.321768283843994, "mode": "train", "epoch": 57}
{"loss": 0.1211155354976654, "acc": 0.973719596862793, "length": 4.11805534362793, "mode": "test", "epoch": 57}
{"loss": 0.08016145974397659, "acc": 0.9836075901985168, "length": 4.318669319152832, "mode": "train", "epoch": 58}
{"loss": 0.11410954594612122, "acc": 0.9742485880851746, "length": 4.315972328186035, "mode": "test", "epoch": 58}
{"loss": 0.07450002431869507, "acc": 0.9859707951545715, "length": 4.351987361907959, "mode": "train", "epoch": 59}
{"loss": 0.12196711450815201, "acc": 0.9695801138877869, "length": 4.276041507720947, "mode": "test", "epoch": 59}
{"loss": 0.07692128419876099, "acc": 0.9847319722175598, "length": 4.348792552947998, "mode": "train", "epoch": 60}
{"loss": 0.10148514807224274, "acc": 0.9793322086334229, "length": 4.234375, "mode": "test", "epoch": 60}
test accuracy: 0.7100207805633545
