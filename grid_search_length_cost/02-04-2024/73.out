ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.3482034504413605, "acc": 0.8475223183631897, "length": 8.210223197937012, "mode": "train", "epoch": 1}
{"loss": 0.2871556878089905, "acc": 0.8921907544136047, "length": 9.061335563659668, "mode": "test", "epoch": 1}
{"loss": 0.20337536931037903, "acc": 0.9336937069892883, "length": 10.253479957580566, "mode": "train", "epoch": 2}
{"loss": 0.20534494519233704, "acc": 0.9320566654205322, "length": 10.855880737304688, "mode": "test", "epoch": 2}
{"loss": 0.16218441724777222, "acc": 0.9513161182403564, "length": 10.340622901916504, "mode": "train", "epoch": 3}
{"loss": 0.1843664050102234, "acc": 0.9417133331298828, "length": 10.199389457702637, "mode": "test", "epoch": 3}
{"loss": 0.1380707174539566, "acc": 0.9593433737754822, "length": 10.592729568481445, "mode": "train", "epoch": 4}
{"loss": 0.15380442142486572, "acc": 0.9535759091377258, "length": 11.137412071228027, "mode": "test", "epoch": 4}
{"loss": 0.11408273875713348, "acc": 0.9681010246276855, "length": 12.51882266998291, "mode": "train", "epoch": 5}
{"loss": 0.13125692307949066, "acc": 0.9628390073776245, "length": 13.732687950134277, "mode": "test", "epoch": 5}
{"loss": 0.09016425162553787, "acc": 0.9745007157325745, "length": 12.94607925415039, "mode": "train", "epoch": 6}
{"loss": 0.1084393560886383, "acc": 0.968489944934845, "length": 12.87556266784668, "mode": "test", "epoch": 6}
{"loss": 0.06012015789747238, "acc": 0.984912633895874, "length": 13.439743995666504, "mode": "train", "epoch": 7}
{"loss": 0.09008827060461044, "acc": 0.9758948683738708, "length": 13.934246063232422, "mode": "test", "epoch": 7}
{"loss": 0.04361654818058014, "acc": 0.9900075197219849, "length": 13.412430763244629, "mode": "train", "epoch": 8}
{"loss": 0.06482268869876862, "acc": 0.9843927025794983, "length": 13.634559631347656, "mode": "test", "epoch": 8}
{"loss": 0.028431249782443047, "acc": 0.99485182762146, "length": 13.074820518493652, "mode": "train", "epoch": 9}
{"loss": 0.05001993477344513, "acc": 0.9880555272102356, "length": 13.43308162689209, "mode": "test", "epoch": 9}
{"loss": 0.021985279396176338, "acc": 0.9968411326408386, "length": 13.280876159667969, "mode": "train", "epoch": 10}
{"loss": 0.03982333466410637, "acc": 0.9916452169418335, "length": 14.570693969726562, "mode": "test", "epoch": 10}
{"loss": 0.01901191845536232, "acc": 0.9974839091300964, "length": 12.940448760986328, "mode": "train", "epoch": 11}
{"loss": 0.049927566200494766, "acc": 0.9893198609352112, "length": 12.603068351745605, "mode": "test", "epoch": 11}
{"loss": 0.018464209511876106, "acc": 0.997519850730896, "length": 13.006183624267578, "mode": "train", "epoch": 12}
{"loss": 0.03213987126946449, "acc": 0.9933866262435913, "length": 12.177417755126953, "mode": "test", "epoch": 12}
{"loss": 0.016535168513655663, "acc": 0.9978905916213989, "length": 12.298309326171875, "mode": "train", "epoch": 13}
{"loss": 0.03299085050821304, "acc": 0.9937377572059631, "length": 11.79659366607666, "mode": "test", "epoch": 13}
{"loss": 0.015918493270874023, "acc": 0.9979053735733032, "length": 12.111137390136719, "mode": "train", "epoch": 14}
{"loss": 0.035410936921834946, "acc": 0.9926921725273132, "length": 12.005181312561035, "mode": "test", "epoch": 14}
{"loss": 0.013789565302431583, "acc": 0.9986117482185364, "length": 12.392099380493164, "mode": "train", "epoch": 15}
{"loss": 0.025252690538764, "acc": 0.9953107237815857, "length": 12.084833145141602, "mode": "test", "epoch": 15}
{"loss": 0.013014675118029118, "acc": 0.9985701441764832, "length": 11.641511917114258, "mode": "train", "epoch": 16}
{"loss": 0.02444065548479557, "acc": 0.9948596954345703, "length": 10.495220184326172, "mode": "test", "epoch": 16}
{"loss": 0.014450679533183575, "acc": 0.9981538653373718, "length": 11.497642517089844, "mode": "train", "epoch": 17}
{"loss": 0.027821624651551247, "acc": 0.9941620230674744, "length": 10.811415672302246, "mode": "test", "epoch": 17}
{"loss": 0.014256808906793594, "acc": 0.9982345104217529, "length": 11.381792068481445, "mode": "train", "epoch": 18}
{"loss": 0.023508287966251373, "acc": 0.9960297346115112, "length": 11.211560249328613, "mode": "test", "epoch": 18}
{"loss": 0.014291771687567234, "acc": 0.9982894062995911, "length": 11.541234016418457, "mode": "train", "epoch": 19}
{"loss": 0.01615915074944496, "acc": 0.9979661703109741, "length": 11.40596866607666, "mode": "test", "epoch": 19}
{"loss": 0.012396365404129028, "acc": 0.9988114237785339, "length": 12.207805633544922, "mode": "train", "epoch": 20}
{"loss": 0.01735612004995346, "acc": 0.9967544078826904, "length": 10.702442169189453, "mode": "test", "epoch": 20}
{"loss": 0.010778916999697685, "acc": 0.9990332722663879, "length": 11.095870018005371, "mode": "train", "epoch": 21}
{"loss": 0.018037987872958183, "acc": 0.9971181750297546, "length": 10.349654197692871, "mode": "test", "epoch": 21}
{"loss": 0.011504463851451874, "acc": 0.9988057017326355, "length": 10.891740798950195, "mode": "train", "epoch": 22}
{"loss": 0.0365680456161499, "acc": 0.9928886890411377, "length": 11.614596366882324, "mode": "test", "epoch": 22}
{"loss": 0.01135613489896059, "acc": 0.9988802075386047, "length": 11.226374626159668, "mode": "train", "epoch": 23}
{"loss": 0.01493475679308176, "acc": 0.9981637597084045, "length": 11.227706909179688, "mode": "test", "epoch": 23}
{"loss": 0.011598644778132439, "acc": 0.9987984895706177, "length": 11.167008399963379, "mode": "train", "epoch": 24}
{"loss": 0.028708426281809807, "acc": 0.9943500757217407, "length": 10.462644577026367, "mode": "test", "epoch": 24}
{"loss": 0.010253224521875381, "acc": 0.999072790145874, "length": 10.530221939086914, "mode": "train", "epoch": 25}
{"loss": 0.014505146071314812, "acc": 0.9976584911346436, "length": 10.219955444335938, "mode": "test", "epoch": 25}
{"loss": 0.009930905885994434, "acc": 0.9990716576576233, "length": 10.334071159362793, "mode": "train", "epoch": 26}
{"loss": 0.012292332015931606, "acc": 0.9985908269882202, "length": 10.174646377563477, "mode": "test", "epoch": 26}
{"loss": 0.010363216511905193, "acc": 0.9990755319595337, "length": 10.82069206237793, "mode": "train", "epoch": 27}
{"loss": 0.012053582817316055, "acc": 0.9986137747764587, "length": 10.10909366607666, "mode": "test", "epoch": 27}
{"loss": 0.010179462842643261, "acc": 0.9990237951278687, "length": 10.780030250549316, "mode": "train", "epoch": 28}
{"loss": 0.01623987779021263, "acc": 0.9977439045906067, "length": 10.41894245147705, "mode": "test", "epoch": 28}
{"loss": 0.009692486375570297, "acc": 0.9991304278373718, "length": 10.351814270019531, "mode": "train", "epoch": 29}
{"loss": 0.013248128816485405, "acc": 0.9981463551521301, "length": 10.424405097961426, "mode": "test", "epoch": 29}
{"loss": 0.010648596100509167, "acc": 0.9989273548126221, "length": 10.31998062133789, "mode": "train", "epoch": 30}
{"loss": 0.014380164444446564, "acc": 0.9983166456222534, "length": 10.681153297424316, "mode": "test", "epoch": 30}
{"loss": 0.010191145353019238, "acc": 0.9990663528442383, "length": 10.891121864318848, "mode": "train", "epoch": 31}
{"loss": 0.016885871067643166, "acc": 0.9972072839736938, "length": 10.894721984863281, "mode": "test", "epoch": 31}
{"loss": 0.012495139613747597, "acc": 0.9985104203224182, "length": 11.399477005004883, "mode": "train", "epoch": 32}
{"loss": 0.01586334779858589, "acc": 0.9977278709411621, "length": 10.694890975952148, "mode": "test", "epoch": 32}
{"loss": 0.009660704992711544, "acc": 0.9991410970687866, "length": 10.705331802368164, "mode": "train", "epoch": 33}
{"loss": 0.01197860762476921, "acc": 0.9987236857414246, "length": 10.504859924316406, "mode": "test", "epoch": 33}
{"loss": 0.008892619982361794, "acc": 0.9993149638175964, "length": 10.384970664978027, "mode": "train", "epoch": 34}
{"loss": 0.01115393452346325, "acc": 0.9989331364631653, "length": 10.566195487976074, "mode": "test", "epoch": 34}
{"loss": 0.011012645438313484, "acc": 0.9988256692886353, "length": 10.463729858398438, "mode": "train", "epoch": 35}
{"loss": 0.011301316320896149, "acc": 0.9989683628082275, "length": 10.416653633117676, "mode": "test", "epoch": 35}
{"loss": 0.009116911329329014, "acc": 0.9992315173149109, "length": 10.374466896057129, "mode": "train", "epoch": 36}
{"loss": 0.012622937560081482, "acc": 0.9983627796173096, "length": 10.058523178100586, "mode": "test", "epoch": 36}
{"loss": 0.011795575730502605, "acc": 0.9987102150917053, "length": 10.892326354980469, "mode": "train", "epoch": 37}
{"loss": 0.03642429783940315, "acc": 0.9931508898735046, "length": 13.853671073913574, "mode": "test", "epoch": 37}
{"loss": 0.12933938205242157, "acc": 0.9642270803451538, "length": 20.887554168701172, "mode": "train", "epoch": 38}
{"loss": 0.16078591346740723, "acc": 0.9462062120437622, "length": 21.0, "mode": "test", "epoch": 38}
{"loss": 0.15432655811309814, "acc": 0.9518741369247437, "length": 20.999652862548828, "mode": "train", "epoch": 39}
{"loss": 0.21252486109733582, "acc": 0.9323446750640869, "length": 21.0, "mode": "test", "epoch": 39}
{"loss": 0.2864333987236023, "acc": 0.891010046005249, "length": 20.999969482421875, "mode": "train", "epoch": 40}
{"loss": 0.32699504494667053, "acc": 0.8618674874305725, "length": 21.0, "mode": "test", "epoch": 40}
{"loss": 0.23461002111434937, "acc": 0.9119827151298523, "length": 20.999958038330078, "mode": "train", "epoch": 41}
{"loss": 0.23082683980464935, "acc": 0.9152935743331909, "length": 21.0, "mode": "test", "epoch": 41}
{"loss": 0.19470182061195374, "acc": 0.9299790263175964, "length": 21.0, "mode": "train", "epoch": 42}
{"loss": 0.24480058252811432, "acc": 0.9064187407493591, "length": 21.0, "mode": "test", "epoch": 42}
{"loss": 0.18609032034873962, "acc": 0.934633731842041, "length": 21.0, "mode": "train", "epoch": 43}
{"loss": 0.23358824849128723, "acc": 0.9170128107070923, "length": 21.0, "mode": "test", "epoch": 43}
{"loss": 0.17031355202198029, "acc": 0.9417219161987305, "length": 21.0, "mode": "train", "epoch": 44}
{"loss": 0.18767869472503662, "acc": 0.9351702332496643, "length": 21.0, "mode": "test", "epoch": 44}
{"loss": 0.1295672357082367, "acc": 0.9578036069869995, "length": 21.0, "mode": "train", "epoch": 45}
{"loss": 0.15145361423492432, "acc": 0.9500541687011719, "length": 21.0, "mode": "test", "epoch": 45}
{"loss": 0.12235129624605179, "acc": 0.9601696729660034, "length": 21.0, "mode": "train", "epoch": 46}
{"loss": 0.1532662957906723, "acc": 0.9476020336151123, "length": 21.0, "mode": "test", "epoch": 46}
{"loss": 0.10266947746276855, "acc": 0.9676628708839417, "length": 21.0, "mode": "train", "epoch": 47}
{"loss": 0.11843905597925186, "acc": 0.9625179767608643, "length": 21.0, "mode": "test", "epoch": 47}
{"loss": 0.09665046632289886, "acc": 0.9695565104484558, "length": 21.0, "mode": "train", "epoch": 48}
{"loss": 0.11932732909917831, "acc": 0.9612306952476501, "length": 21.0, "mode": "test", "epoch": 48}
{"loss": 0.07968025654554367, "acc": 0.9774316549301147, "length": 21.0, "mode": "train", "epoch": 49}
{"loss": 0.12807761132717133, "acc": 0.959933340549469, "length": 21.0, "mode": "test", "epoch": 49}
{"loss": 0.0865940973162651, "acc": 0.9746192693710327, "length": 21.0, "mode": "train", "epoch": 50}
{"loss": 0.08434280753135681, "acc": 0.9767011404037476, "length": 21.0, "mode": "test", "epoch": 50}
{"loss": 0.06651393324136734, "acc": 0.9823089838027954, "length": 21.0, "mode": "train", "epoch": 51}
{"loss": 0.09607243537902832, "acc": 0.9715797901153564, "length": 21.0, "mode": "test", "epoch": 51}
{"loss": 0.09347321838140488, "acc": 0.971411406993866, "length": 21.0, "mode": "train", "epoch": 52}
{"loss": 0.17510677874088287, "acc": 0.9390102028846741, "length": 21.0, "mode": "test", "epoch": 52}
{"loss": 0.20008662343025208, "acc": 0.9267197251319885, "length": 21.0, "mode": "train", "epoch": 53}
{"loss": 0.2330026477575302, "acc": 0.9138756394386292, "length": 21.0, "mode": "test", "epoch": 53}
{"loss": 0.2124827653169632, "acc": 0.9219306111335754, "length": 21.0, "mode": "train", "epoch": 54}
{"loss": 0.2706314027309418, "acc": 0.8938443064689636, "length": 21.0, "mode": "test", "epoch": 54}
{"loss": 0.21610142290592194, "acc": 0.9200475811958313, "length": 21.0, "mode": "train", "epoch": 55}
{"loss": 0.22468096017837524, "acc": 0.9177297353744507, "length": 21.0, "mode": "test", "epoch": 55}
{"loss": 0.2195606231689453, "acc": 0.9170083403587341, "length": 21.0, "mode": "train", "epoch": 56}
{"loss": 0.26115965843200684, "acc": 0.8987708687782288, "length": 21.0, "mode": "test", "epoch": 56}
{"loss": 0.21059785783290863, "acc": 0.9220229387283325, "length": 21.0, "mode": "train", "epoch": 57}
{"loss": 0.24936333298683167, "acc": 0.9045549035072327, "length": 21.0, "mode": "test", "epoch": 57}
{"loss": 0.21372279524803162, "acc": 0.9207033514976501, "length": 21.0, "mode": "train", "epoch": 58}
{"loss": 0.2523326575756073, "acc": 0.9043781757354736, "length": 21.0, "mode": "test", "epoch": 58}
{"loss": 0.2198449969291687, "acc": 0.9176347255706787, "length": 21.0, "mode": "train", "epoch": 59}
{"loss": 0.2587270140647888, "acc": 0.9006605744361877, "length": 21.0, "mode": "test", "epoch": 59}
{"loss": 0.2244562953710556, "acc": 0.9156553745269775, "length": 21.0, "mode": "train", "epoch": 60}
{"loss": 0.2689221203327179, "acc": 0.896664023399353, "length": 21.0, "mode": "test", "epoch": 60}
test accuracy: 0.8825007677078247
