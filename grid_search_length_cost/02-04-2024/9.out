ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.6948539614677429, "acc": 0.5352771878242493, "length": 4.007795810699463, "mode": "train", "epoch": 1}
{"loss": 0.6732636094093323, "acc": 0.5865098237991333, "length": 1.3663194179534912, "mode": "test", "epoch": 1}
{"loss": 0.6223026514053345, "acc": 0.6500716805458069, "length": 3.1978962421417236, "mode": "train", "epoch": 2}
{"loss": 0.635416567325592, "acc": 0.6393961310386658, "length": 1.6128472089767456, "mode": "test", "epoch": 2}
{"loss": 0.5738434791564941, "acc": 0.6990351676940918, "length": 2.926624298095703, "mode": "train", "epoch": 3}
{"loss": 0.692941427230835, "acc": 0.7133057117462158, "length": 8.71701431274414, "mode": "test", "epoch": 3}
{"loss": 0.4803245961666107, "acc": 0.7865620255470276, "length": 5.165970802307129, "mode": "train", "epoch": 4}
{"loss": 0.5538051128387451, "acc": 0.7637749314308167, "length": 8.041666984558105, "mode": "test", "epoch": 4}
{"loss": 0.42013606429100037, "acc": 0.8213504552841187, "length": 5.652386665344238, "mode": "train", "epoch": 5}
{"loss": 0.47273552417755127, "acc": 0.8086344599723816, "length": 10.940972328186035, "mode": "test", "epoch": 5}
{"loss": 0.3726927638053894, "acc": 0.8430564403533936, "length": 6.067607402801514, "mode": "train", "epoch": 6}
{"loss": 0.40571773052215576, "acc": 0.8332302570343018, "length": 10.17881965637207, "mode": "test", "epoch": 6}
{"loss": 0.33430930972099304, "acc": 0.8619368672370911, "length": 6.474477291107178, "mode": "train", "epoch": 7}
{"loss": 0.40280881524086, "acc": 0.8287895917892456, "length": 8.684027671813965, "mode": "test", "epoch": 7}
{"loss": 0.30788618326187134, "acc": 0.8748083710670471, "length": 6.328914642333984, "mode": "train", "epoch": 8}
{"loss": 0.3589199483394623, "acc": 0.8546441197395325, "length": 5.607638835906982, "mode": "test", "epoch": 8}
{"loss": 0.2809290587902069, "acc": 0.8884580135345459, "length": 6.618723392486572, "mode": "train", "epoch": 9}
{"loss": 0.33691781759262085, "acc": 0.8633219599723816, "length": 7.05381965637207, "mode": "test", "epoch": 9}
{"loss": 0.26179763674736023, "acc": 0.9003636240959167, "length": 7.004398345947266, "mode": "train", "epoch": 10}
{"loss": 0.31117117404937744, "acc": 0.8758842945098877, "length": 6.215277671813965, "mode": "test", "epoch": 10}
{"loss": 0.24720308184623718, "acc": 0.9083322286605835, "length": 6.977997779846191, "mode": "train", "epoch": 11}
{"loss": 0.3168390095233917, "acc": 0.8795897960662842, "length": 7.395833492279053, "mode": "test", "epoch": 11}
{"loss": 0.23413440585136414, "acc": 0.9140253663063049, "length": 7.435676574707031, "mode": "train", "epoch": 12}
{"loss": 0.31522834300994873, "acc": 0.8837592601776123, "length": 7.57118034362793, "mode": "test", "epoch": 12}
{"loss": 0.22631581127643585, "acc": 0.9181300401687622, "length": 7.412883758544922, "mode": "train", "epoch": 13}
{"loss": 0.2839266061782837, "acc": 0.8954916000366211, "length": 7.534722328186035, "mode": "test", "epoch": 13}
{"loss": 0.2115212380886078, "acc": 0.9284701347351074, "length": 7.813506603240967, "mode": "train", "epoch": 14}
{"loss": 0.27069729566574097, "acc": 0.8997395634651184, "length": 8.050347328186035, "mode": "test", "epoch": 14}
{"loss": 0.20121991634368896, "acc": 0.9330662488937378, "length": 8.330378532409668, "mode": "train", "epoch": 15}
{"loss": 0.264222115278244, "acc": 0.9039713740348816, "length": 7.296875, "mode": "test", "epoch": 15}
{"loss": 0.1941753327846527, "acc": 0.9357739090919495, "length": 7.945767402648926, "mode": "train", "epoch": 16}
{"loss": 0.2681237757205963, "acc": 0.9007650017738342, "length": 6.892361164093018, "mode": "test", "epoch": 16}
{"loss": 0.18956901133060455, "acc": 0.9378334283828735, "length": 7.754438400268555, "mode": "train", "epoch": 17}
{"loss": 0.26184892654418945, "acc": 0.9071018695831299, "length": 7.550347328186035, "mode": "test", "epoch": 17}
{"loss": 0.18041792511940002, "acc": 0.9416599273681641, "length": 7.915201187133789, "mode": "train", "epoch": 18}
{"loss": 0.25119566917419434, "acc": 0.9066731929779053, "length": 7.798611164093018, "mode": "test", "epoch": 18}
{"loss": 0.17291904985904694, "acc": 0.9443079233169556, "length": 7.921222686767578, "mode": "train", "epoch": 19}
{"loss": 0.23886878788471222, "acc": 0.9139866232872009, "length": 7.28125, "mode": "test", "epoch": 19}
{"loss": 0.1736055463552475, "acc": 0.9443119764328003, "length": 8.282998085021973, "mode": "train", "epoch": 20}
{"loss": 0.23206506669521332, "acc": 0.9160590767860413, "length": 8.043402671813965, "mode": "test", "epoch": 20}
{"loss": 0.16207420825958252, "acc": 0.9492787718772888, "length": 7.904811382293701, "mode": "train", "epoch": 21}
{"loss": 0.20682905614376068, "acc": 0.9273165464401245, "length": 7.5625, "mode": "test", "epoch": 21}
{"loss": 0.15949168801307678, "acc": 0.9509186148643494, "length": 7.841797351837158, "mode": "train", "epoch": 22}
{"loss": 0.23081858456134796, "acc": 0.9165852665901184, "length": 8.052083015441895, "mode": "test", "epoch": 22}
{"loss": 0.1495085060596466, "acc": 0.953423261642456, "length": 8.080509185791016, "mode": "train", "epoch": 23}
{"loss": 0.21602405607700348, "acc": 0.9264649152755737, "length": 8.112847328186035, "mode": "test", "epoch": 23}
{"loss": 0.1486685574054718, "acc": 0.9533227682113647, "length": 8.225834846496582, "mode": "train", "epoch": 24}
{"loss": 0.19528406858444214, "acc": 0.9316569566726685, "length": 7.895833492279053, "mode": "test", "epoch": 24}
{"loss": 0.1400538980960846, "acc": 0.9571247696876526, "length": 8.097867012023926, "mode": "train", "epoch": 25}
{"loss": 0.20384299755096436, "acc": 0.9345404505729675, "length": 7.534722328186035, "mode": "test", "epoch": 25}
{"loss": 0.14124788343906403, "acc": 0.9555606245994568, "length": 8.29907512664795, "mode": "train", "epoch": 26}
{"loss": 0.1929772049188614, "acc": 0.935907781124115, "length": 7.970486164093018, "mode": "test", "epoch": 26}
{"loss": 0.12848158180713654, "acc": 0.9611087441444397, "length": 8.354048728942871, "mode": "train", "epoch": 27}
{"loss": 0.1812366396188736, "acc": 0.9381809234619141, "length": 7.748263835906982, "mode": "test", "epoch": 27}
{"loss": 0.1194377914071083, "acc": 0.9646097421646118, "length": 8.238871574401855, "mode": "train", "epoch": 28}
{"loss": 0.20528118312358856, "acc": 0.9313910603523254, "length": 8.78993034362793, "mode": "test", "epoch": 28}
{"loss": 0.1249489113688469, "acc": 0.9625529050827026, "length": 8.253931999206543, "mode": "train", "epoch": 29}
{"loss": 0.18571966886520386, "acc": 0.9395833611488342, "length": 8.75, "mode": "test", "epoch": 29}
{"loss": 0.11025860160589218, "acc": 0.967452883720398, "length": 8.430132865905762, "mode": "train", "epoch": 30}
{"loss": 0.1677837371826172, "acc": 0.9475612640380859, "length": 8.88888931274414, "mode": "test", "epoch": 30}
{"loss": 0.10881362110376358, "acc": 0.9678784012794495, "length": 8.287205696105957, "mode": "train", "epoch": 31}
{"loss": 0.17525392770767212, "acc": 0.9459391832351685, "length": 8.815972328186035, "mode": "test", "epoch": 31}
{"loss": 0.10194627195596695, "acc": 0.9705665707588196, "length": 8.27842903137207, "mode": "train", "epoch": 32}
{"loss": 0.15456172823905945, "acc": 0.9529756903648376, "length": 8.09201431274414, "mode": "test", "epoch": 32}
{"loss": 0.0922541618347168, "acc": 0.9740657806396484, "length": 8.370972633361816, "mode": "train", "epoch": 33}
{"loss": 0.19791185855865479, "acc": 0.9416992664337158, "length": 8.059027671813965, "mode": "test", "epoch": 33}
{"loss": 0.1215779036283493, "acc": 0.9626429677009583, "length": 8.012341499328613, "mode": "train", "epoch": 34}
{"loss": 0.14476150274276733, "acc": 0.9511392116546631, "length": 7.880208492279053, "mode": "test", "epoch": 34}
{"loss": 0.08977115899324417, "acc": 0.975485622882843, "length": 8.175454139709473, "mode": "train", "epoch": 35}
{"loss": 0.1354164034128189, "acc": 0.9568333029747009, "length": 7.895833492279053, "mode": "test", "epoch": 35}
{"loss": 0.07939989864826202, "acc": 0.9785068035125732, "length": 8.368549346923828, "mode": "train", "epoch": 36}
{"loss": 0.11886395514011383, "acc": 0.9612900614738464, "length": 7.689236164093018, "mode": "test", "epoch": 36}
{"loss": 0.07359235733747482, "acc": 0.9805393218994141, "length": 8.09737491607666, "mode": "train", "epoch": 37}
{"loss": 0.12492622435092926, "acc": 0.9607313871383667, "length": 7.800347328186035, "mode": "test", "epoch": 37}
{"loss": 0.06873314827680588, "acc": 0.9823470711708069, "length": 8.258692741394043, "mode": "train", "epoch": 38}
{"loss": 0.10693346709012985, "acc": 0.9678955078125, "length": 7.94618034362793, "mode": "test", "epoch": 38}
{"loss": 0.06052780896425247, "acc": 0.9858558773994446, "length": 8.1273775100708, "mode": "train", "epoch": 39}
{"loss": 0.10784583538770676, "acc": 0.9667643308639526, "length": 7.80381965637207, "mode": "test", "epoch": 39}
{"loss": 0.05768720060586929, "acc": 0.9861589670181274, "length": 8.162158966064453, "mode": "train", "epoch": 40}
{"loss": 0.09173382818698883, "acc": 0.9735243320465088, "length": 7.628472328186035, "mode": "test", "epoch": 40}
{"loss": 0.05544676259160042, "acc": 0.9869976043701172, "length": 8.465988159179688, "mode": "train", "epoch": 41}
{"loss": 0.08677351474761963, "acc": 0.9775011539459229, "length": 8.18055534362793, "mode": "test", "epoch": 41}
{"loss": 0.05075015872716904, "acc": 0.9896963834762573, "length": 8.559179306030273, "mode": "train", "epoch": 42}
{"loss": 0.0880994126200676, "acc": 0.9729167222976685, "length": 7.918402671813965, "mode": "test", "epoch": 42}
{"loss": 0.04494071379303932, "acc": 0.991338849067688, "length": 8.26297378540039, "mode": "train", "epoch": 43}
{"loss": 0.0738150030374527, "acc": 0.9819769263267517, "length": 7.892361164093018, "mode": "test", "epoch": 43}
{"loss": 0.04653524234890938, "acc": 0.9900695085525513, "length": 8.554059028625488, "mode": "train", "epoch": 44}
{"loss": 0.07599672675132751, "acc": 0.9790499806404114, "length": 8.29513931274414, "mode": "test", "epoch": 44}
{"loss": 0.04518503323197365, "acc": 0.9907770752906799, "length": 8.595319747924805, "mode": "train", "epoch": 45}
{"loss": 0.08117359131574631, "acc": 0.9766927361488342, "length": 7.612847328186035, "mode": "test", "epoch": 45}
{"loss": 0.04168388620018959, "acc": 0.9926794171333313, "length": 8.295809745788574, "mode": "train", "epoch": 46}
{"loss": 0.07968069612979889, "acc": 0.9796521663665771, "length": 8.22569465637207, "mode": "test", "epoch": 46}
{"loss": 0.03816531226038933, "acc": 0.9935327768325806, "length": 8.3700532913208, "mode": "train", "epoch": 47}
{"loss": 0.0607246570289135, "acc": 0.9847412109375, "length": 8.13368034362793, "mode": "test", "epoch": 47}
{"loss": 0.03512009233236313, "acc": 0.994624674320221, "length": 8.401572227478027, "mode": "train", "epoch": 48}
{"loss": 0.07700563222169876, "acc": 0.9794108271598816, "length": 7.888888835906982, "mode": "test", "epoch": 48}
{"loss": 0.04243103042244911, "acc": 0.9916951060295105, "length": 8.136014938354492, "mode": "train", "epoch": 49}
{"loss": 0.05938112735748291, "acc": 0.9847276210784912, "length": 7.734375, "mode": "test", "epoch": 49}
{"loss": 0.030500153079628944, "acc": 0.9961503148078918, "length": 7.964882850646973, "mode": "train", "epoch": 50}
{"loss": 0.05064571276307106, "acc": 0.9858478903770447, "length": 7.529513835906982, "mode": "test", "epoch": 50}
{"loss": 0.026778340339660645, "acc": 0.9974839091300964, "length": 7.881976127624512, "mode": "train", "epoch": 51}
{"loss": 0.044019296765327454, "acc": 0.9894639253616333, "length": 7.454861164093018, "mode": "test", "epoch": 51}
{"loss": 0.02559085562825203, "acc": 0.9975929856300354, "length": 7.86361837387085, "mode": "train", "epoch": 52}
{"loss": 0.04393314570188522, "acc": 0.9904621839523315, "length": 7.611111164093018, "mode": "test", "epoch": 52}
{"loss": 0.02708321250975132, "acc": 0.9967303276062012, "length": 7.97449254989624, "mode": "train", "epoch": 53}
{"loss": 0.0390341691672802, "acc": 0.9917128086090088, "length": 7.480902671813965, "mode": "test", "epoch": 53}
{"loss": 0.02756716124713421, "acc": 0.9963169693946838, "length": 7.861481666564941, "mode": "train", "epoch": 54}
{"loss": 0.06651746481657028, "acc": 0.9826443195343018, "length": 7.65625, "mode": "test", "epoch": 54}
{"loss": 0.02653498947620392, "acc": 0.996698260307312, "length": 7.946500301361084, "mode": "train", "epoch": 55}
{"loss": 0.0422714427113533, "acc": 0.9917290806770325, "length": 7.449652671813965, "mode": "test", "epoch": 55}
{"loss": 0.026942601427435875, "acc": 0.9963247776031494, "length": 7.78995418548584, "mode": "train", "epoch": 56}
{"loss": 0.05243788659572601, "acc": 0.9879529476165771, "length": 7.421875, "mode": "test", "epoch": 56}
{"loss": 0.026128891855478287, "acc": 0.9966815114021301, "length": 7.79219913482666, "mode": "train", "epoch": 57}
{"loss": 0.03812296316027641, "acc": 0.9913737177848816, "length": 7.5, "mode": "test", "epoch": 57}
{"loss": 0.03275957331061363, "acc": 0.9936938881874084, "length": 7.541067600250244, "mode": "train", "epoch": 58}
{"loss": 0.08594471216201782, "acc": 0.9766656160354614, "length": 7.479166507720947, "mode": "test", "epoch": 58}
{"loss": 0.05556824430823326, "acc": 0.9868397116661072, "length": 7.868138790130615, "mode": "train", "epoch": 59}
{"loss": 0.080641970038414, "acc": 0.9774468541145325, "length": 7.21875, "mode": "test", "epoch": 59}
{"loss": 0.049979258328676224, "acc": 0.9877397418022156, "length": 8.351995468139648, "mode": "train", "epoch": 60}
{"loss": 0.06206129491329193, "acc": 0.9836208820343018, "length": 7.97569465637207, "mode": "test", "epoch": 60}
test accuracy: 0.8191283941268921
