ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.31240561604499817, "acc": 0.8652052879333496, "length": 5.778559684753418, "mode": "train", "epoch": 1}
{"loss": 0.24333609640598297, "acc": 0.9076150059700012, "length": 6.0, "mode": "test", "epoch": 1}
{"loss": 0.16151027381420135, "acc": 0.9471410512924194, "length": 5.9999542236328125, "mode": "train", "epoch": 2}
{"loss": 0.2027275264263153, "acc": 0.925943911075592, "length": 6.0, "mode": "test", "epoch": 2}
{"loss": 0.11251993477344513, "acc": 0.9658721685409546, "length": 5.999989032745361, "mode": "train", "epoch": 3}
{"loss": 0.21713869273662567, "acc": 0.9197338819503784, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.07782020419836044, "acc": 0.9789444208145142, "length": 5.999997138977051, "mode": "train", "epoch": 4}
{"loss": 0.17827782034873962, "acc": 0.9367576241493225, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.05817558243870735, "acc": 0.9869535565376282, "length": 5.999999523162842, "mode": "train", "epoch": 5}
{"loss": 0.19368581473827362, "acc": 0.9318487644195557, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.05474098026752472, "acc": 0.9880512356758118, "length": 6.0, "mode": "train", "epoch": 6}
{"loss": 0.14486849308013916, "acc": 0.9524204730987549, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.04646831005811691, "acc": 0.9909559488296509, "length": 6.0, "mode": "train", "epoch": 7}
{"loss": 0.1762506067752838, "acc": 0.944763720035553, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.044573184102773666, "acc": 0.9913733005523682, "length": 6.0, "mode": "train", "epoch": 8}
{"loss": 0.15908297896385193, "acc": 0.9480782747268677, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.04132739081978798, "acc": 0.9922017455101013, "length": 6.0, "mode": "train", "epoch": 9}
{"loss": 0.1305321305990219, "acc": 0.9559845328330994, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.040367577224969864, "acc": 0.9923712611198425, "length": 6.0, "mode": "train", "epoch": 10}
{"loss": 0.13421931862831116, "acc": 0.958031952381134, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.040017977356910706, "acc": 0.9925733804702759, "length": 6.0, "mode": "train", "epoch": 11}
{"loss": 0.14695262908935547, "acc": 0.9535939693450928, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.03763997554779053, "acc": 0.9932368397712708, "length": 6.0, "mode": "train", "epoch": 12}
{"loss": 0.1355220228433609, "acc": 0.9589319229125977, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.03517108038067818, "acc": 0.9933180212974548, "length": 6.0, "mode": "train", "epoch": 13}
{"loss": 0.133974090218544, "acc": 0.9576069116592407, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.0261458121240139, "acc": 0.9948150515556335, "length": 6.0, "mode": "train", "epoch": 14}
{"loss": 0.13584670424461365, "acc": 0.9575749635696411, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.020408084616065025, "acc": 0.9967052340507507, "length": 6.0, "mode": "train", "epoch": 15}
{"loss": 0.10922844707965851, "acc": 0.9670577049255371, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.01999756507575512, "acc": 0.9966899752616882, "length": 6.0, "mode": "train", "epoch": 16}
{"loss": 0.09687881171703339, "acc": 0.9725833535194397, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.015662485733628273, "acc": 0.9979901909828186, "length": 6.0, "mode": "train", "epoch": 17}
{"loss": 0.11200199276208878, "acc": 0.9687400460243225, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.01726466417312622, "acc": 0.9973939061164856, "length": 6.0, "mode": "train", "epoch": 18}
{"loss": 0.08521267026662827, "acc": 0.9761914014816284, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.013736862689256668, "acc": 0.9984322786331177, "length": 6.0, "mode": "train", "epoch": 19}
{"loss": 0.08390653133392334, "acc": 0.9743635058403015, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.015596778132021427, "acc": 0.9979031085968018, "length": 6.0, "mode": "train", "epoch": 20}
{"loss": 0.08784867078065872, "acc": 0.976728081703186, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.014293152838945389, "acc": 0.9982740879058838, "length": 6.0, "mode": "train", "epoch": 21}
{"loss": 0.07879463583230972, "acc": 0.9798789620399475, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.013801861554384232, "acc": 0.9984097480773926, "length": 6.0, "mode": "train", "epoch": 22}
{"loss": 0.06028330698609352, "acc": 0.9837225675582886, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.013965606689453125, "acc": 0.9982687830924988, "length": 6.0, "mode": "train", "epoch": 23}
{"loss": 0.056896161288022995, "acc": 0.9869551658630371, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.013185014948248863, "acc": 0.9984676241874695, "length": 6.0, "mode": "train", "epoch": 24}
{"loss": 0.057601068168878555, "acc": 0.9842194318771362, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.013402631506323814, "acc": 0.998484194278717, "length": 6.0, "mode": "train", "epoch": 25}
{"loss": 0.06805302202701569, "acc": 0.9837444424629211, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.01242520660161972, "acc": 0.9987022876739502, "length": 6.0, "mode": "train", "epoch": 26}
{"loss": 0.06385653465986252, "acc": 0.9847142696380615, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.012474864721298218, "acc": 0.9986231923103333, "length": 6.0, "mode": "train", "epoch": 27}
{"loss": 0.08245986700057983, "acc": 0.9797353148460388, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.012695741839706898, "acc": 0.9985826015472412, "length": 6.0, "mode": "train", "epoch": 28}
{"loss": 0.05969242751598358, "acc": 0.9868375062942505, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.013365396298468113, "acc": 0.9983938336372375, "length": 6.0, "mode": "train", "epoch": 29}
{"loss": 0.05171600356698036, "acc": 0.989036500453949, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.011536287143826485, "acc": 0.998863160610199, "length": 6.0, "mode": "train", "epoch": 30}
{"loss": 0.05340801924467087, "acc": 0.9899165034294128, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.013095604255795479, "acc": 0.9985560178756714, "length": 6.0, "mode": "train", "epoch": 31}
{"loss": 0.046097345650196075, "acc": 0.9894317388534546, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.012287532910704613, "acc": 0.998712956905365, "length": 6.0, "mode": "train", "epoch": 32}
{"loss": 0.06550813466310501, "acc": 0.9846943020820618, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.011531059630215168, "acc": 0.9988951683044434, "length": 6.0, "mode": "train", "epoch": 33}
{"loss": 0.041747063398361206, "acc": 0.9893998503684998, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.012112684547901154, "acc": 0.9986312389373779, "length": 6.0, "mode": "train", "epoch": 34}
{"loss": 0.048411495983600616, "acc": 0.9900484085083008, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.01149635761976242, "acc": 0.9988691806793213, "length": 6.0, "mode": "train", "epoch": 35}
{"loss": 0.04706892743706703, "acc": 0.9893836975097656, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.013857873156666756, "acc": 0.9982196688652039, "length": 6.0, "mode": "train", "epoch": 36}
{"loss": 0.0365276075899601, "acc": 0.9922193884849548, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.011191255412995815, "acc": 0.9989888668060303, "length": 6.0, "mode": "train", "epoch": 37}
{"loss": 0.03699891269207001, "acc": 0.99064701795578, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.012465161271393299, "acc": 0.9985387325286865, "length": 6.0, "mode": "train", "epoch": 38}
{"loss": 0.055507056415081024, "acc": 0.9853090047836304, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.012959698215126991, "acc": 0.9984676837921143, "length": 6.0, "mode": "train", "epoch": 39}
{"loss": 0.037311188876628876, "acc": 0.9927821159362793, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.013018676079809666, "acc": 0.998591959476471, "length": 6.0, "mode": "train", "epoch": 40}
{"loss": 0.04152313619852066, "acc": 0.9913233518600464, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.011522824876010418, "acc": 0.9988519549369812, "length": 6.0, "mode": "train", "epoch": 41}
{"loss": 0.055060721933841705, "acc": 0.9885118007659912, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.013375677168369293, "acc": 0.9985108375549316, "length": 6.0, "mode": "train", "epoch": 42}
{"loss": 0.037885092198848724, "acc": 0.9933010935783386, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.011690160259604454, "acc": 0.9988459348678589, "length": 6.0, "mode": "train", "epoch": 43}
{"loss": 0.03926701471209526, "acc": 0.9927961230278015, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.012881424278020859, "acc": 0.9985414743423462, "length": 6.0, "mode": "train", "epoch": 44}
{"loss": 0.03173098713159561, "acc": 0.99395352602005, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.012068673968315125, "acc": 0.9987568259239197, "length": 6.0, "mode": "train", "epoch": 45}
{"loss": 0.029653305187821388, "acc": 0.9932052493095398, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.01071921270340681, "acc": 0.9990512728691101, "length": 6.0, "mode": "train", "epoch": 46}
{"loss": 0.024127159267663956, "acc": 0.9967074394226074, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.010910515673458576, "acc": 0.9990113973617554, "length": 6.0, "mode": "train", "epoch": 47}
{"loss": 0.02859472669661045, "acc": 0.9951148629188538, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.011324894614517689, "acc": 0.9988545179367065, "length": 6.0, "mode": "train", "epoch": 48}
{"loss": 0.018963484093546867, "acc": 0.997395932674408, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.011284618638455868, "acc": 0.9989529252052307, "length": 6.0, "mode": "train", "epoch": 49}
{"loss": 0.024274099618196487, "acc": 0.9954681992530823, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.012598445639014244, "acc": 0.9985288977622986, "length": 6.0, "mode": "train", "epoch": 50}
{"loss": 0.02253095619380474, "acc": 0.9962524771690369, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.01096719317138195, "acc": 0.9989376664161682, "length": 6.0, "mode": "train", "epoch": 51}
{"loss": 0.024518681690096855, "acc": 0.996180534362793, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.011596470139920712, "acc": 0.9988465309143066, "length": 6.0, "mode": "train", "epoch": 52}
{"loss": 0.018969813361763954, "acc": 0.9973520040512085, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.010915049351751804, "acc": 0.9989655613899231, "length": 6.0, "mode": "train", "epoch": 53}
{"loss": 0.01850322261452675, "acc": 0.9973878860473633, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.011252899654209614, "acc": 0.9989628791809082, "length": 6.0, "mode": "train", "epoch": 54}
{"loss": 0.02085181698203087, "acc": 0.997347891330719, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.01266714558005333, "acc": 0.998518168926239, "length": 6.0, "mode": "train", "epoch": 55}
{"loss": 0.023916183039546013, "acc": 0.9952865242958069, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.011669260449707508, "acc": 0.9987788200378418, "length": 6.0, "mode": "train", "epoch": 56}
{"loss": 0.03298521041870117, "acc": 0.9939175248146057, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.011679448187351227, "acc": 0.9987560510635376, "length": 6.0, "mode": "train", "epoch": 57}
{"loss": 0.020352670922875404, "acc": 0.9977189898490906, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.011935888789594173, "acc": 0.9988114237785339, "length": 6.0, "mode": "train", "epoch": 58}
{"loss": 0.03229944035410881, "acc": 0.9940471649169922, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.012952467426657677, "acc": 0.9985746741294861, "length": 6.0, "mode": "train", "epoch": 59}
{"loss": 0.017171397805213928, "acc": 0.9978108406066895, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.011731167323887348, "acc": 0.9988052845001221, "length": 6.0, "mode": "train", "epoch": 60}
{"loss": 0.020872335880994797, "acc": 0.9965078234672546, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.9938451051712036
