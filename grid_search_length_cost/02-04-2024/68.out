ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.34020522236824036, "acc": 0.8528618812561035, "length": 6.393533229827881, "mode": "train", "epoch": 1}
{"loss": 0.26308566331863403, "acc": 0.9092220067977905, "length": 7.99859619140625, "mode": "test", "epoch": 1}
{"loss": 0.19556093215942383, "acc": 0.9407675862312317, "length": 8.421832084655762, "mode": "train", "epoch": 2}
{"loss": 0.24025139212608337, "acc": 0.9204398393630981, "length": 9.008905410766602, "mode": "test", "epoch": 2}
{"loss": 0.15396636724472046, "acc": 0.956392765045166, "length": 9.098767280578613, "mode": "train", "epoch": 3}
{"loss": 0.20094025135040283, "acc": 0.936161458492279, "length": 9.464457511901855, "mode": "test", "epoch": 3}
{"loss": 0.11840786039829254, "acc": 0.9685983657836914, "length": 9.911351203918457, "mode": "train", "epoch": 4}
{"loss": 0.18776443600654602, "acc": 0.9410965442657471, "length": 9.684210777282715, "mode": "test", "epoch": 4}
{"loss": 0.09142729640007019, "acc": 0.9790322184562683, "length": 10.044293403625488, "mode": "train", "epoch": 5}
{"loss": 0.15288034081459045, "acc": 0.9551985263824463, "length": 8.976451873779297, "mode": "test", "epoch": 5}
{"loss": 0.08029595762491226, "acc": 0.9830366373062134, "length": 9.941179275512695, "mode": "train", "epoch": 6}
{"loss": 0.13819007575511932, "acc": 0.9607802629470825, "length": 8.772906303405762, "mode": "test", "epoch": 6}
{"loss": 0.07331641018390656, "acc": 0.985174298286438, "length": 9.659381866455078, "mode": "train", "epoch": 7}
{"loss": 0.1687949150800705, "acc": 0.9525335431098938, "length": 9.84756088256836, "mode": "test", "epoch": 7}
{"loss": 0.06798840314149857, "acc": 0.986603319644928, "length": 9.46967887878418, "mode": "train", "epoch": 8}
{"loss": 0.13076239824295044, "acc": 0.9624917507171631, "length": 9.532132148742676, "mode": "test", "epoch": 8}
{"loss": 0.06078026443719864, "acc": 0.9878713488578796, "length": 8.96459674835205, "mode": "train", "epoch": 9}
{"loss": 0.09966567903757095, "acc": 0.9749115109443665, "length": 10.565669059753418, "mode": "test", "epoch": 9}
{"loss": 0.05095798149704933, "acc": 0.9903913140296936, "length": 9.406632423400879, "mode": "train", "epoch": 10}
{"loss": 0.09951943904161453, "acc": 0.9750862121582031, "length": 8.766206741333008, "mode": "test", "epoch": 10}
{"loss": 0.04460859298706055, "acc": 0.9923927783966064, "length": 9.15549087524414, "mode": "train", "epoch": 11}
{"loss": 0.07027772814035416, "acc": 0.9847656488418579, "length": 8.777278900146484, "mode": "test", "epoch": 11}
{"loss": 0.04055839776992798, "acc": 0.9935990571975708, "length": 9.320326805114746, "mode": "train", "epoch": 12}
{"loss": 0.06651799380779266, "acc": 0.9857156872749329, "length": 8.896742820739746, "mode": "test", "epoch": 12}
{"loss": 0.04398944228887558, "acc": 0.9923111200332642, "length": 9.174079895019531, "mode": "train", "epoch": 13}
{"loss": 0.05977976694703102, "acc": 0.9876987934112549, "length": 8.708279609680176, "mode": "test", "epoch": 13}
{"loss": 0.044744305312633514, "acc": 0.9922477602958679, "length": 10.06989574432373, "mode": "train", "epoch": 14}
{"loss": 0.08734875172376633, "acc": 0.980765163898468, "length": 8.3368501663208, "mode": "test", "epoch": 14}
{"loss": 0.038757000118494034, "acc": 0.9929890036582947, "length": 9.69620418548584, "mode": "train", "epoch": 15}
{"loss": 0.07473430037498474, "acc": 0.981808066368103, "length": 8.765003204345703, "mode": "test", "epoch": 15}
{"loss": 0.0266648530960083, "acc": 0.995550274848938, "length": 9.070212364196777, "mode": "train", "epoch": 16}
{"loss": 0.06296061724424362, "acc": 0.984969973564148, "length": 8.78125, "mode": "test", "epoch": 16}
{"loss": 0.02193419449031353, "acc": 0.9970815181732178, "length": 8.809281349182129, "mode": "train", "epoch": 17}
{"loss": 0.054624032229185104, "acc": 0.987838864326477, "length": 8.506378173828125, "mode": "test", "epoch": 17}
{"loss": 0.01996646821498871, "acc": 0.9976029396057129, "length": 8.655372619628906, "mode": "train", "epoch": 18}
{"loss": 0.04007334262132645, "acc": 0.9916531443595886, "length": 8.501323699951172, "mode": "test", "epoch": 18}
{"loss": 0.018790876492857933, "acc": 0.9978969097137451, "length": 8.505722045898438, "mode": "train", "epoch": 19}
{"loss": 0.05569259822368622, "acc": 0.9889578819274902, "length": 8.231306076049805, "mode": "test", "epoch": 19}
{"loss": 0.01813933067023754, "acc": 0.9979779124259949, "length": 8.484628677368164, "mode": "train", "epoch": 20}
{"loss": 0.04076353460550308, "acc": 0.9927799105644226, "length": 8.197809219360352, "mode": "test", "epoch": 20}
{"loss": 0.01735571213066578, "acc": 0.9980890154838562, "length": 8.265962600708008, "mode": "train", "epoch": 21}
{"loss": 0.03400269150733948, "acc": 0.9934172630310059, "length": 8.56631088256836, "mode": "test", "epoch": 21}
{"loss": 0.01670621708035469, "acc": 0.9983896613121033, "length": 8.829349517822266, "mode": "train", "epoch": 22}
{"loss": 0.03529810532927513, "acc": 0.9932171702384949, "length": 9.35610580444336, "mode": "test", "epoch": 22}
{"loss": 0.016968341544270515, "acc": 0.9983711838722229, "length": 8.856912612915039, "mode": "train", "epoch": 23}
{"loss": 0.023027129471302032, "acc": 0.997086226940155, "length": 9.002005577087402, "mode": "test", "epoch": 23}
{"loss": 0.016134755685925484, "acc": 0.9984716176986694, "length": 8.908660888671875, "mode": "train", "epoch": 24}
{"loss": 0.02310553565621376, "acc": 0.9971480965614319, "length": 9.063663482666016, "mode": "test", "epoch": 24}
{"loss": 0.014434770680963993, "acc": 0.9989785552024841, "length": 8.779047012329102, "mode": "train", "epoch": 25}
{"loss": 0.028431857004761696, "acc": 0.9943864345550537, "length": 8.410582542419434, "mode": "test", "epoch": 25}
{"loss": 0.014296909794211388, "acc": 0.9989334940910339, "length": 8.466012001037598, "mode": "train", "epoch": 26}
{"loss": 0.02491566352546215, "acc": 0.9958852529525757, "length": 8.873274803161621, "mode": "test", "epoch": 26}
{"loss": 0.01479196734726429, "acc": 0.9989323019981384, "length": 9.222257614135742, "mode": "train", "epoch": 27}
{"loss": 0.01936112903058529, "acc": 0.9981579780578613, "length": 8.593549728393555, "mode": "test", "epoch": 27}
{"loss": 0.021424541249871254, "acc": 0.9968098998069763, "length": 8.718366622924805, "mode": "train", "epoch": 28}
{"loss": 0.04186741262674332, "acc": 0.990262508392334, "length": 8.659619331359863, "mode": "test", "epoch": 28}
{"loss": 0.025916075333952904, "acc": 0.9953213930130005, "length": 8.873555183410645, "mode": "train", "epoch": 29}
{"loss": 0.01878286339342594, "acc": 0.9982531666755676, "length": 8.705512046813965, "mode": "test", "epoch": 29}
{"loss": 0.014377505518496037, "acc": 0.9988119006156921, "length": 8.503453254699707, "mode": "train", "epoch": 30}
{"loss": 0.02237437665462494, "acc": 0.9975221753120422, "length": 8.055319786071777, "mode": "test", "epoch": 30}
{"loss": 0.01384013146162033, "acc": 0.9988605976104736, "length": 7.994879245758057, "mode": "train", "epoch": 31}
{"loss": 0.01855740323662758, "acc": 0.9983358979225159, "length": 7.8421454429626465, "mode": "test", "epoch": 31}
{"loss": 0.03508881479501724, "acc": 0.9925609827041626, "length": 8.386664390563965, "mode": "train", "epoch": 32}
{"loss": 0.05197324603796005, "acc": 0.9872043132781982, "length": 8.449614524841309, "mode": "test", "epoch": 32}
{"loss": 0.031716518104076385, "acc": 0.9931281208992004, "length": 8.687088966369629, "mode": "train", "epoch": 33}
{"loss": 0.03307301551103592, "acc": 0.9934414029121399, "length": 8.692835807800293, "mode": "test", "epoch": 33}
{"loss": 0.02263319306075573, "acc": 0.9962871074676514, "length": 8.674798965454102, "mode": "train", "epoch": 34}
{"loss": 0.029983775690197945, "acc": 0.9946465492248535, "length": 8.836528778076172, "mode": "test", "epoch": 34}
{"loss": 0.019497495144605637, "acc": 0.9976205825805664, "length": 9.400717735290527, "mode": "train", "epoch": 35}
{"loss": 0.04558929428458214, "acc": 0.9915487766265869, "length": 9.102214813232422, "mode": "test", "epoch": 35}
{"loss": 0.017151789739727974, "acc": 0.9980578422546387, "length": 8.71019172668457, "mode": "train", "epoch": 36}
{"loss": 0.022222528234124184, "acc": 0.9970449209213257, "length": 8.381619453430176, "mode": "test", "epoch": 36}
{"loss": 0.01789220981299877, "acc": 0.9978166222572327, "length": 8.848947525024414, "mode": "train", "epoch": 37}
{"loss": 0.02455592155456543, "acc": 0.9960358738899231, "length": 8.371549606323242, "mode": "test", "epoch": 37}
{"loss": 0.01858719438314438, "acc": 0.997825562953949, "length": 8.879526138305664, "mode": "train", "epoch": 38}
{"loss": 0.022056570276618004, "acc": 0.99678635597229, "length": 8.767008781433105, "mode": "test", "epoch": 38}
{"loss": 0.022685501724481583, "acc": 0.9963882565498352, "length": 8.696762084960938, "mode": "train", "epoch": 39}
{"loss": 0.030030934140086174, "acc": 0.9946946501731873, "length": 8.52539348602295, "mode": "test", "epoch": 39}
{"loss": 0.016981013119220734, "acc": 0.9981812238693237, "length": 8.901556968688965, "mode": "train", "epoch": 40}
{"loss": 0.0272326972335577, "acc": 0.9962427616119385, "length": 8.55423641204834, "mode": "test", "epoch": 40}
{"loss": 0.013924812898039818, "acc": 0.998961865901947, "length": 8.771526336669922, "mode": "train", "epoch": 41}
{"loss": 0.031153574585914612, "acc": 0.9951539635658264, "length": 8.740452766418457, "mode": "test", "epoch": 41}
{"loss": 0.015642806887626648, "acc": 0.9984463453292847, "length": 8.515193939208984, "mode": "train", "epoch": 42}
{"loss": 0.02157953940331936, "acc": 0.9974247217178345, "length": 8.677069664001465, "mode": "test", "epoch": 42}
{"loss": 0.015638770535588264, "acc": 0.9985458850860596, "length": 8.925878524780273, "mode": "train", "epoch": 43}
{"loss": 0.01703692227602005, "acc": 0.9983215928077698, "length": 8.778522491455078, "mode": "test", "epoch": 43}
{"loss": 0.015049777925014496, "acc": 0.9986398220062256, "length": 8.797537803649902, "mode": "train", "epoch": 44}
{"loss": 0.01556660421192646, "acc": 0.9988327026367188, "length": 8.644576072692871, "mode": "test", "epoch": 44}
{"loss": 0.01484808698296547, "acc": 0.9986087083816528, "length": 8.482503890991211, "mode": "train", "epoch": 45}
{"loss": 0.020762057974934578, "acc": 0.9976179599761963, "length": 8.367778778076172, "mode": "test", "epoch": 45}
{"loss": 0.020482614636421204, "acc": 0.9973331689834595, "length": 8.52093505859375, "mode": "train", "epoch": 46}
{"loss": 0.028717780485749245, "acc": 0.9954633116722107, "length": 8.742980003356934, "mode": "test", "epoch": 46}
{"loss": 0.022437017410993576, "acc": 0.9968876838684082, "length": 8.878801345825195, "mode": "train", "epoch": 47}
{"loss": 0.024604717269539833, "acc": 0.9966371655464172, "length": 8.303834915161133, "mode": "test", "epoch": 47}
{"loss": 0.04457589611411095, "acc": 0.9907070398330688, "length": 10.119569778442383, "mode": "train", "epoch": 48}
{"loss": 0.13040819764137268, "acc": 0.9668734073638916, "length": 13.3096923828125, "mode": "test", "epoch": 48}
{"loss": 0.2969401180744171, "acc": 0.8787953853607178, "length": 19.10460662841797, "mode": "train", "epoch": 49}
{"loss": 0.36583414673805237, "acc": 0.8422836065292358, "length": 20.379854202270508, "mode": "test", "epoch": 49}
{"loss": 0.3040294349193573, "acc": 0.8771015405654907, "length": 20.629758834838867, "mode": "train", "epoch": 50}
{"loss": 0.35202470421791077, "acc": 0.852949321269989, "length": 20.848203659057617, "mode": "test", "epoch": 50}
{"loss": 0.25367236137390137, "acc": 0.9042248129844666, "length": 20.899627685546875, "mode": "train", "epoch": 51}
{"loss": 0.27660414576530457, "acc": 0.8939533233642578, "length": 20.837892532348633, "mode": "test", "epoch": 51}
{"loss": 0.2343492954969406, "acc": 0.9116221070289612, "length": 20.902786254882812, "mode": "train", "epoch": 52}
{"loss": 0.26788535714149475, "acc": 0.8948959708213806, "length": 20.819238662719727, "mode": "test", "epoch": 52}
{"loss": 0.20055879652500153, "acc": 0.9311302304267883, "length": 20.938159942626953, "mode": "train", "epoch": 53}
{"loss": 0.2450769692659378, "acc": 0.9157548546791077, "length": 20.98483657836914, "mode": "test", "epoch": 53}
{"loss": 0.19457095861434937, "acc": 0.9355154037475586, "length": 20.994998931884766, "mode": "train", "epoch": 54}
{"loss": 0.2881278395652771, "acc": 0.898885190486908, "length": 20.997072219848633, "mode": "test", "epoch": 54}
{"loss": 0.2505483627319336, "acc": 0.9096342921257019, "length": 20.9992733001709, "mode": "train", "epoch": 55}
{"loss": 0.28735220432281494, "acc": 0.8932427167892456, "length": 20.999277114868164, "mode": "test", "epoch": 55}
{"loss": 0.25445839762687683, "acc": 0.9062029123306274, "length": 20.99965476989746, "mode": "train", "epoch": 56}
{"loss": 0.28222715854644775, "acc": 0.8947131633758545, "length": 20.99803352355957, "mode": "test", "epoch": 56}
{"loss": 0.2213466465473175, "acc": 0.9219933152198792, "length": 20.998031616210938, "mode": "train", "epoch": 57}
{"loss": 0.25493720173835754, "acc": 0.9080072641372681, "length": 20.999116897583008, "mode": "test", "epoch": 57}
{"loss": 0.2106899917125702, "acc": 0.9279695153236389, "length": 20.99482536315918, "mode": "train", "epoch": 58}
{"loss": 0.29295840859413147, "acc": 0.8842090368270874, "length": 20.999399185180664, "mode": "test", "epoch": 58}
{"loss": 0.2908901870250702, "acc": 0.8897971510887146, "length": 20.99437713623047, "mode": "train", "epoch": 59}
{"loss": 0.2817111611366272, "acc": 0.8954459428787231, "length": 20.999317169189453, "mode": "test", "epoch": 59}
{"loss": 0.29216131567955017, "acc": 0.8874263167381287, "length": 20.99973487854004, "mode": "train", "epoch": 60}
{"loss": 0.35485729575157166, "acc": 0.856380820274353, "length": 20.99959945678711, "mode": "test", "epoch": 60}
test accuracy: 0.8427196741104126
