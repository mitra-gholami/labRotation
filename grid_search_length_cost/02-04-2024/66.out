ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.3218227028846741, "acc": 0.8642151951789856, "length": 5.797825813293457, "mode": "train", "epoch": 1}
{"loss": 0.2769257128238678, "acc": 0.8944081664085388, "length": 6.0, "mode": "test", "epoch": 1}
{"loss": 0.1889033019542694, "acc": 0.9418571591377258, "length": 5.999922275543213, "mode": "train", "epoch": 2}
{"loss": 0.2007685750722885, "acc": 0.9374138712882996, "length": 6.0, "mode": "test", "epoch": 2}
{"loss": 0.15872253477573395, "acc": 0.9555814862251282, "length": 5.999990940093994, "mode": "train", "epoch": 3}
{"loss": 0.1732897162437439, "acc": 0.9478713870048523, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.14001089334487915, "acc": 0.9608941674232483, "length": 5.999998569488525, "mode": "train", "epoch": 4}
{"loss": 0.15621893107891083, "acc": 0.9529569149017334, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.11274402588605881, "acc": 0.9690430164337158, "length": 6.0, "mode": "train", "epoch": 5}
{"loss": 0.12779036164283752, "acc": 0.9644486308097839, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.09377674013376236, "acc": 0.9747433662414551, "length": 6.0, "mode": "train", "epoch": 6}
{"loss": 0.13354697823524475, "acc": 0.9593909382820129, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.07953955978155136, "acc": 0.9800145030021667, "length": 6.0, "mode": "train", "epoch": 7}
{"loss": 0.11076511442661285, "acc": 0.9687799215316772, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.06551706790924072, "acc": 0.9849237203598022, "length": 6.0, "mode": "train", "epoch": 8}
{"loss": 0.11758777499198914, "acc": 0.965056836605072, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.058464013040065765, "acc": 0.9869544506072998, "length": 6.0, "mode": "train", "epoch": 9}
{"loss": 0.09474832564592361, "acc": 0.9750840067863464, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.0545036643743515, "acc": 0.9879182577133179, "length": 6.0, "mode": "train", "epoch": 10}
{"loss": 0.08583860099315643, "acc": 0.9770188331604004, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.04768453538417816, "acc": 0.9903002381324768, "length": 6.0, "mode": "train", "epoch": 11}
{"loss": 0.08872036635875702, "acc": 0.9768864512443542, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.04409125819802284, "acc": 0.9913231730461121, "length": 6.0, "mode": "train", "epoch": 12}
{"loss": 0.0935303270816803, "acc": 0.974591851234436, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.04258919507265091, "acc": 0.9919070601463318, "length": 6.0, "mode": "train", "epoch": 13}
{"loss": 0.08379602432250977, "acc": 0.9792694449424744, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.03896457329392433, "acc": 0.9928260445594788, "length": 6.0, "mode": "train", "epoch": 14}
{"loss": 0.07630039006471634, "acc": 0.9821982383728027, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.03933132812380791, "acc": 0.9928034543991089, "length": 6.0, "mode": "train", "epoch": 15}
{"loss": 0.0756220892071724, "acc": 0.982516348361969, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.03854798898100853, "acc": 0.992687463760376, "length": 6.0, "mode": "train", "epoch": 16}
{"loss": 0.06860119849443436, "acc": 0.9840468764305115, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.033393822610378265, "acc": 0.9931000471115112, "length": 6.0, "mode": "train", "epoch": 17}
{"loss": 0.0975661501288414, "acc": 0.9744117856025696, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.028405899181962013, "acc": 0.9940730929374695, "length": 6.0, "mode": "train", "epoch": 18}
{"loss": 0.07771920412778854, "acc": 0.9823184013366699, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.02602977864444256, "acc": 0.9949721097946167, "length": 6.0, "mode": "train", "epoch": 19}
{"loss": 0.09361085295677185, "acc": 0.9752359986305237, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.026318581774830818, "acc": 0.9946509599685669, "length": 6.0, "mode": "train", "epoch": 20}
{"loss": 0.06669878214597702, "acc": 0.9835928082466125, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.02301197126507759, "acc": 0.9958071708679199, "length": 6.0, "mode": "train", "epoch": 21}
{"loss": 0.069614477455616, "acc": 0.9823763370513916, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.0210897084325552, "acc": 0.9963884353637695, "length": 6.0, "mode": "train", "epoch": 22}
{"loss": 0.06853694468736649, "acc": 0.9829664826393127, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.01918330416083336, "acc": 0.996888279914856, "length": 6.0, "mode": "train", "epoch": 23}
{"loss": 0.05675187334418297, "acc": 0.9865217804908752, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.0345139354467392, "acc": 0.9925947785377502, "length": 6.0, "mode": "train", "epoch": 24}
{"loss": 0.05789740011096001, "acc": 0.9882162809371948, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.019926035776734352, "acc": 0.996476948261261, "length": 6.0, "mode": "train", "epoch": 25}
{"loss": 0.0675721988081932, "acc": 0.9853392243385315, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.020620785653591156, "acc": 0.9963463544845581, "length": 6.0, "mode": "train", "epoch": 26}
{"loss": 0.06238275393843651, "acc": 0.9870559573173523, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.019313085824251175, "acc": 0.9967197179794312, "length": 6.0, "mode": "train", "epoch": 27}
{"loss": 0.0725494772195816, "acc": 0.9820883274078369, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.021247142925858498, "acc": 0.9963337779045105, "length": 6.0, "mode": "train", "epoch": 28}
{"loss": 0.0617452897131443, "acc": 0.9872238636016846, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.02488093078136444, "acc": 0.9952907562255859, "length": 6.0, "mode": "train", "epoch": 29}
{"loss": 0.07129163295030594, "acc": 0.9838688969612122, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.02472185157239437, "acc": 0.9951174855232239, "length": 6.0, "mode": "train", "epoch": 30}
{"loss": 0.06871572881937027, "acc": 0.9846131205558777, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.026641743257641792, "acc": 0.9947168827056885, "length": 6.0, "mode": "train", "epoch": 31}
{"loss": 0.058977868407964706, "acc": 0.9872759580612183, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.018824830651283264, "acc": 0.9968928694725037, "length": 6.0, "mode": "train", "epoch": 32}
{"loss": 0.049924906343221664, "acc": 0.9896267056465149, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.018274186179041862, "acc": 0.9971522688865662, "length": 6.0, "mode": "train", "epoch": 33}
{"loss": 0.06394549459218979, "acc": 0.9857873916625977, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.01712208427488804, "acc": 0.997430145740509, "length": 6.0, "mode": "train", "epoch": 34}
{"loss": 0.057419922202825546, "acc": 0.9888744950294495, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.01932027004659176, "acc": 0.9967368841171265, "length": 6.0, "mode": "train", "epoch": 35}
{"loss": 0.05860061198472977, "acc": 0.9870897531509399, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.017320623621344566, "acc": 0.9973921179771423, "length": 6.0, "mode": "train", "epoch": 36}
{"loss": 0.051931578665971756, "acc": 0.9904869794845581, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.016402386128902435, "acc": 0.9976081252098083, "length": 6.0, "mode": "train", "epoch": 37}
{"loss": 0.05819535255432129, "acc": 0.9894125461578369, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.015823082998394966, "acc": 0.9977700114250183, "length": 6.0, "mode": "train", "epoch": 38}
{"loss": 0.06346797943115234, "acc": 0.987407922744751, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.01697566732764244, "acc": 0.9974446892738342, "length": 6.0, "mode": "train", "epoch": 39}
{"loss": 0.05241596698760986, "acc": 0.9891045689582825, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.01681755669414997, "acc": 0.997528612613678, "length": 6.0, "mode": "train", "epoch": 40}
{"loss": 0.054923806339502335, "acc": 0.9888144731521606, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.015373787842690945, "acc": 0.9978272914886475, "length": 6.0, "mode": "train", "epoch": 41}
{"loss": 0.04083665832877159, "acc": 0.9920915365219116, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.01825450360774994, "acc": 0.9972001910209656, "length": 6.0, "mode": "train", "epoch": 42}
{"loss": 0.05736887454986572, "acc": 0.9877680540084839, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.016935553401708603, "acc": 0.9975093603134155, "length": 6.0, "mode": "train", "epoch": 43}
{"loss": 0.050456173717975616, "acc": 0.9906970262527466, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.01626233384013176, "acc": 0.9976739883422852, "length": 6.0, "mode": "train", "epoch": 44}
{"loss": 0.0610477440059185, "acc": 0.9842190146446228, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.01916988380253315, "acc": 0.9969795346260071, "length": 6.0, "mode": "train", "epoch": 45}
{"loss": 0.061567481607198715, "acc": 0.9865157008171082, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.02550537697970867, "acc": 0.9952414035797119, "length": 6.0, "mode": "train", "epoch": 46}
{"loss": 0.05373762175440788, "acc": 0.9883103370666504, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.015760473906993866, "acc": 0.9978012442588806, "length": 6.0, "mode": "train", "epoch": 47}
{"loss": 0.04962817579507828, "acc": 0.9906629323959351, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.01492407638579607, "acc": 0.9980178475379944, "length": 6.0, "mode": "train", "epoch": 48}
{"loss": 0.03510776162147522, "acc": 0.9935179352760315, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.01882757432758808, "acc": 0.9970794916152954, "length": 6.0, "mode": "train", "epoch": 49}
{"loss": 0.03416525945067406, "acc": 0.9936259984970093, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.01564633846282959, "acc": 0.9978893399238586, "length": 6.0, "mode": "train", "epoch": 50}
{"loss": 0.04543904587626457, "acc": 0.9910612106323242, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.016326410695910454, "acc": 0.9976480007171631, "length": 6.0, "mode": "train", "epoch": 51}
{"loss": 0.050172433257102966, "acc": 0.9887225031852722, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.02043825574219227, "acc": 0.9966796040534973, "length": 6.0, "mode": "train", "epoch": 52}
{"loss": 0.03772291541099548, "acc": 0.992671549320221, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.01726727932691574, "acc": 0.9974527359008789, "length": 6.0, "mode": "train", "epoch": 53}
{"loss": 0.035926077514886856, "acc": 0.992759644985199, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.015132943168282509, "acc": 0.9979811906814575, "length": 6.0, "mode": "train", "epoch": 54}
{"loss": 0.05516419559717178, "acc": 0.9890724420547485, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.0183254424482584, "acc": 0.997046172618866, "length": 6.0, "mode": "train", "epoch": 55}
{"loss": 0.03441431000828743, "acc": 0.9935178756713867, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.020080463960766792, "acc": 0.9966163039207458, "length": 6.0, "mode": "train", "epoch": 56}
{"loss": 0.052223723381757736, "acc": 0.988900363445282, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.020318685099482536, "acc": 0.9966129660606384, "length": 6.0, "mode": "train", "epoch": 57}
{"loss": 0.045098766684532166, "acc": 0.9892565608024597, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.019583329558372498, "acc": 0.9968129992485046, "length": 6.0, "mode": "train", "epoch": 58}
{"loss": 0.037843309342861176, "acc": 0.9923055768013, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.014962177723646164, "acc": 0.9980459809303284, "length": 6.0, "mode": "train", "epoch": 59}
{"loss": 0.03284889832139015, "acc": 0.9934598803520203, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.017070846632122993, "acc": 0.9974687695503235, "length": 6.0, "mode": "train", "epoch": 60}
{"loss": 0.04104301705956459, "acc": 0.9922595024108887, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.99002605676651
