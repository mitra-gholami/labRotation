ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.5069065690040588, "acc": 0.7071582078933716, "length": 2.498384475708008, "mode": "train", "epoch": 1}
{"loss": 0.3417355716228485, "acc": 0.8602880835533142, "length": 3.882251501083374, "mode": "test", "epoch": 1}
{"loss": 0.25142085552215576, "acc": 0.9223955273628235, "length": 4.2353739738464355, "mode": "train", "epoch": 2}
{"loss": 0.2863793671131134, "acc": 0.8990426063537598, "length": 4.098076820373535, "mode": "test", "epoch": 2}
{"loss": 0.22740763425827026, "acc": 0.9328298568725586, "length": 4.129678249359131, "mode": "train", "epoch": 3}
{"loss": 0.26809999346733093, "acc": 0.9104892015457153, "length": 4.026041507720947, "mode": "test", "epoch": 3}
{"loss": 0.2169623076915741, "acc": 0.9347267746925354, "length": 4.090525150299072, "mode": "train", "epoch": 4}
{"loss": 0.27024155855178833, "acc": 0.9069948792457581, "length": 4.040785312652588, "mode": "test", "epoch": 4}
{"loss": 0.19109119474887848, "acc": 0.9429557919502258, "length": 4.23362398147583, "mode": "train", "epoch": 5}
{"loss": 0.25768089294433594, "acc": 0.9082475900650024, "length": 4.161778926849365, "mode": "test", "epoch": 5}
{"loss": 0.16918158531188965, "acc": 0.9520379304885864, "length": 4.433901309967041, "mode": "train", "epoch": 6}
{"loss": 0.22628797590732574, "acc": 0.9250303506851196, "length": 4.440023899078369, "mode": "test", "epoch": 6}
{"loss": 0.15849821269512177, "acc": 0.9574722051620483, "length": 4.494354248046875, "mode": "train", "epoch": 7}
{"loss": 0.2273205667734146, "acc": 0.925205647945404, "length": 4.43834114074707, "mode": "test", "epoch": 7}
{"loss": 0.15173828601837158, "acc": 0.9604802131652832, "length": 4.507778167724609, "mode": "train", "epoch": 8}
{"loss": 0.23871669173240662, "acc": 0.9244384765625, "length": 4.536258220672607, "mode": "test", "epoch": 8}
{"loss": 0.14619401097297668, "acc": 0.9633498191833496, "length": 4.615544319152832, "mode": "train", "epoch": 9}
{"loss": 0.23599497973918915, "acc": 0.9258716106414795, "length": 4.571434497833252, "mode": "test", "epoch": 9}
{"loss": 0.13607390224933624, "acc": 0.9684104919433594, "length": 4.699337482452393, "mode": "train", "epoch": 10}
{"loss": 0.24092885851860046, "acc": 0.9229145050048828, "length": 4.707852363586426, "mode": "test", "epoch": 10}
{"loss": 0.1279039978981018, "acc": 0.9726942777633667, "length": 4.784698963165283, "mode": "train", "epoch": 11}
{"loss": 0.19760474562644958, "acc": 0.9450294971466064, "length": 4.759174823760986, "mode": "test", "epoch": 11}
{"loss": 0.12043265253305435, "acc": 0.9754117727279663, "length": 4.792183876037598, "mode": "train", "epoch": 12}
{"loss": 0.19715723395347595, "acc": 0.9440965056419373, "length": 4.744070529937744, "mode": "test", "epoch": 12}
{"loss": 0.11131714284420013, "acc": 0.9777499437332153, "length": 4.8624348640441895, "mode": "train", "epoch": 13}
{"loss": 0.19038179516792297, "acc": 0.9451317191123962, "length": 4.83429479598999, "mode": "test", "epoch": 13}
{"loss": 0.09776569157838821, "acc": 0.9814937710762024, "length": 4.874200820922852, "mode": "train", "epoch": 14}
{"loss": 0.1694643646478653, "acc": 0.9549849033355713, "length": 5.027083396911621, "mode": "test", "epoch": 14}
{"loss": 0.08422922343015671, "acc": 0.9845600724220276, "length": 5.0580363273620605, "mode": "train", "epoch": 15}
{"loss": 0.16778475046157837, "acc": 0.9541795253753662, "length": 5.1079325675964355, "mode": "test", "epoch": 15}
{"loss": 0.06457646936178207, "acc": 0.9900731444358826, "length": 5.358775615692139, "mode": "train", "epoch": 16}
{"loss": 0.14750324189662933, "acc": 0.9632778763771057, "length": 5.531850814819336, "mode": "test", "epoch": 16}
{"loss": 0.05180857330560684, "acc": 0.9942646026611328, "length": 5.594831466674805, "mode": "train", "epoch": 17}
{"loss": 0.13646234571933746, "acc": 0.9682429432868958, "length": 5.647956848144531, "mode": "test", "epoch": 17}
{"loss": 0.04654176905751228, "acc": 0.9956839680671692, "length": 5.5548200607299805, "mode": "train", "epoch": 18}
{"loss": 0.13814671337604523, "acc": 0.9679070711135864, "length": 5.733694076538086, "mode": "test", "epoch": 18}
{"loss": 0.0425114780664444, "acc": 0.9967018961906433, "length": 5.498523712158203, "mode": "train", "epoch": 19}
{"loss": 0.14312027394771576, "acc": 0.9690079689025879, "length": 5.3848958015441895, "mode": "test", "epoch": 19}
{"loss": 0.043768398463726044, "acc": 0.9961141347885132, "length": 5.469473361968994, "mode": "train", "epoch": 20}
{"loss": 0.12252989411354065, "acc": 0.9722887873649597, "length": 5.52960729598999, "mode": "test", "epoch": 20}
{"loss": 0.03985640034079552, "acc": 0.9972789287567139, "length": 5.4727654457092285, "mode": "train", "epoch": 21}
{"loss": 0.11926154047250748, "acc": 0.975944459438324, "length": 5.626402378082275, "mode": "test", "epoch": 21}
{"loss": 0.03928946703672409, "acc": 0.9975439310073853, "length": 5.567346096038818, "mode": "train", "epoch": 22}
{"loss": 0.13082727789878845, "acc": 0.9743936657905579, "length": 5.454487323760986, "mode": "test", "epoch": 22}
{"loss": 0.03796004876494408, "acc": 0.9977485537528992, "length": 5.447890281677246, "mode": "train", "epoch": 23}
{"loss": 0.11308392882347107, "acc": 0.9799616932868958, "length": 5.488381385803223, "mode": "test", "epoch": 23}
{"loss": 0.03761354461312294, "acc": 0.9976978302001953, "length": 5.4248270988464355, "mode": "train", "epoch": 24}
{"loss": 0.1008179783821106, "acc": 0.9821021556854248, "length": 5.522956848144531, "mode": "test", "epoch": 24}
{"loss": 0.03644873946905136, "acc": 0.9980340003967285, "length": 5.444366931915283, "mode": "train", "epoch": 25}
{"loss": 0.10006750375032425, "acc": 0.9829114079475403, "length": 5.572996616363525, "mode": "test", "epoch": 25}
{"loss": 0.03707275167107582, "acc": 0.9979171752929688, "length": 5.432033538818359, "mode": "train", "epoch": 26}
{"loss": 0.09763704240322113, "acc": 0.9842075705528259, "length": 5.689383029937744, "mode": "test", "epoch": 26}
{"loss": 0.03576679155230522, "acc": 0.9980912208557129, "length": 5.396844387054443, "mode": "train", "epoch": 27}
{"loss": 0.10494429618120193, "acc": 0.9823920726776123, "length": 5.7425079345703125, "mode": "test", "epoch": 27}
{"loss": 0.03479684516787529, "acc": 0.9984115958213806, "length": 5.380590915679932, "mode": "train", "epoch": 28}
{"loss": 0.10804197192192078, "acc": 0.9839982390403748, "length": 5.447155475616455, "mode": "test", "epoch": 28}
{"loss": 0.03528799116611481, "acc": 0.9981220960617065, "length": 5.3571271896362305, "mode": "train", "epoch": 29}
{"loss": 0.11937060207128525, "acc": 0.9748857021331787, "length": 5.471955299377441, "mode": "test", "epoch": 29}
{"loss": 0.035936642438173294, "acc": 0.9980015754699707, "length": 5.433913230895996, "mode": "train", "epoch": 30}
{"loss": 0.0885499119758606, "acc": 0.9864312410354614, "length": 5.621994972229004, "mode": "test", "epoch": 30}
{"loss": 0.03491334989666939, "acc": 0.9983039498329163, "length": 5.421661853790283, "mode": "train", "epoch": 31}
{"loss": 0.10224433243274689, "acc": 0.9796067476272583, "length": 5.67143440246582, "mode": "test", "epoch": 31}
{"loss": 0.03371601924300194, "acc": 0.9986020922660828, "length": 5.399041175842285, "mode": "train", "epoch": 32}
{"loss": 0.0950014591217041, "acc": 0.9843977689743042, "length": 5.563902378082275, "mode": "test", "epoch": 32}
{"loss": 0.03399072587490082, "acc": 0.9985535144805908, "length": 5.375292778015137, "mode": "train", "epoch": 33}
{"loss": 0.09429186582565308, "acc": 0.9844653606414795, "length": 5.516626834869385, "mode": "test", "epoch": 33}
{"loss": 0.03463026508688927, "acc": 0.9983503818511963, "length": 5.3955841064453125, "mode": "train", "epoch": 34}
{"loss": 0.11373929679393768, "acc": 0.9776918292045593, "length": 5.565104007720947, "mode": "test", "epoch": 34}
{"loss": 0.033543121069669724, "acc": 0.998616099357605, "length": 5.3587775230407715, "mode": "train", "epoch": 35}
{"loss": 0.09439187496900558, "acc": 0.9805595874786377, "length": 5.53373384475708, "mode": "test", "epoch": 35}
{"loss": 0.034195028245449066, "acc": 0.998421847820282, "length": 5.379587650299072, "mode": "train", "epoch": 36}
{"loss": 0.10491084307432175, "acc": 0.9788870215415955, "length": 5.510416507720947, "mode": "test", "epoch": 36}
{"loss": 0.03310539573431015, "acc": 0.9987139701843262, "length": 5.368064880371094, "mode": "train", "epoch": 37}
{"loss": 0.08000462502241135, "acc": 0.9874939918518066, "length": 5.561418056488037, "mode": "test", "epoch": 37}
{"loss": 0.03391655161976814, "acc": 0.9985293745994568, "length": 5.412206172943115, "mode": "train", "epoch": 38}
{"loss": 0.08303076773881912, "acc": 0.9857537746429443, "length": 5.648197174072266, "mode": "test", "epoch": 38}
{"loss": 0.03381209820508957, "acc": 0.9986063838005066, "length": 5.418431282043457, "mode": "train", "epoch": 39}
{"loss": 0.08330244570970535, "acc": 0.9867440462112427, "length": 5.623317241668701, "mode": "test", "epoch": 39}
{"loss": 0.03311460465192795, "acc": 0.9987237453460693, "length": 5.3635077476501465, "mode": "train", "epoch": 40}
{"loss": 0.08239315450191498, "acc": 0.9877834320068359, "length": 5.601081848144531, "mode": "test", "epoch": 40}
{"loss": 0.0330311618745327, "acc": 0.9987429976463318, "length": 5.367999076843262, "mode": "train", "epoch": 41}
{"loss": 0.08582174777984619, "acc": 0.9845387935638428, "length": 5.5597758293151855, "mode": "test", "epoch": 41}
{"loss": 0.03264443948864937, "acc": 0.9987839460372925, "length": 5.32761812210083, "mode": "train", "epoch": 42}
{"loss": 0.09202846884727478, "acc": 0.9833465814590454, "length": 5.6505208015441895, "mode": "test", "epoch": 42}
{"loss": 0.03321918472647667, "acc": 0.9987553954124451, "length": 5.403672695159912, "mode": "train", "epoch": 43}
{"loss": 0.08452633768320084, "acc": 0.9865660667419434, "length": 5.658573627471924, "mode": "test", "epoch": 43}
{"loss": 0.03454963117837906, "acc": 0.9985001087188721, "length": 5.417884349822998, "mode": "train", "epoch": 44}
{"loss": 0.0820678099989891, "acc": 0.9844624996185303, "length": 5.568028926849365, "mode": "test", "epoch": 44}
{"loss": 0.032595135271549225, "acc": 0.9988175630569458, "length": 5.352806091308594, "mode": "train", "epoch": 45}
{"loss": 0.09470205008983612, "acc": 0.9848410487174988, "length": 5.539583206176758, "mode": "test", "epoch": 45}
{"loss": 0.0342070497572422, "acc": 0.9984341263771057, "length": 5.402185440063477, "mode": "train", "epoch": 46}
{"loss": 0.0881730392575264, "acc": 0.9877952337265015, "length": 5.549198627471924, "mode": "test", "epoch": 46}
{"loss": 0.0338507778942585, "acc": 0.9985474348068237, "length": 5.385161399841309, "mode": "train", "epoch": 47}
{"loss": 0.06389911472797394, "acc": 0.9922628402709961, "length": 5.615504741668701, "mode": "test", "epoch": 47}
{"loss": 0.0328194685280323, "acc": 0.9988600611686707, "length": 5.443953514099121, "mode": "train", "epoch": 48}
{"loss": 0.066563181579113, "acc": 0.9913485050201416, "length": 5.640384674072266, "mode": "test", "epoch": 48}
{"loss": 0.033720679581165314, "acc": 0.9986891150474548, "length": 5.427606582641602, "mode": "train", "epoch": 49}
{"loss": 0.07622501999139786, "acc": 0.989261269569397, "length": 5.561819076538086, "mode": "test", "epoch": 49}
{"loss": 0.03391479700803757, "acc": 0.9984908103942871, "length": 5.40676212310791, "mode": "train", "epoch": 50}
{"loss": 0.06787586212158203, "acc": 0.9926942586898804, "length": 5.645432472229004, "mode": "test", "epoch": 50}
{"loss": 0.03149985149502754, "acc": 0.9991562366485596, "length": 5.3740668296813965, "mode": "train", "epoch": 51}
{"loss": 0.06749210506677628, "acc": 0.9923826456069946, "length": 5.518188953399658, "mode": "test", "epoch": 51}
{"loss": 0.033145971596241, "acc": 0.9987726211547852, "length": 5.405246257781982, "mode": "train", "epoch": 52}
{"loss": 0.07314753532409668, "acc": 0.9905020594596863, "length": 5.647676467895508, "mode": "test", "epoch": 52}
{"loss": 0.03205574303865433, "acc": 0.998991072177887, "length": 5.378931999206543, "mode": "train", "epoch": 53}
{"loss": 0.07306134700775146, "acc": 0.9911181330680847, "length": 5.473517417907715, "mode": "test", "epoch": 53}
{"loss": 0.032054364681243896, "acc": 0.9989497661590576, "length": 5.376665115356445, "mode": "train", "epoch": 54}
{"loss": 0.06852350383996964, "acc": 0.987675666809082, "length": 5.554487228393555, "mode": "test", "epoch": 54}
{"loss": 0.03432139754295349, "acc": 0.9984766840934753, "length": 5.39913272857666, "mode": "train", "epoch": 55}
{"loss": 0.06795598566532135, "acc": 0.9926195740699768, "length": 5.548437595367432, "mode": "test", "epoch": 55}
{"loss": 0.13355503976345062, "acc": 0.957718014717102, "length": 6.639888286590576, "mode": "train", "epoch": 56}
{"loss": 0.17955058813095093, "acc": 0.9432225227355957, "length": 7.029407024383545, "mode": "test", "epoch": 56}
{"loss": 0.14148776233196259, "acc": 0.9534152746200562, "length": 6.858608245849609, "mode": "train", "epoch": 57}
{"loss": 0.11265405267477036, "acc": 0.9763333797454834, "length": 6.282612323760986, "mode": "test", "epoch": 57}
{"loss": 0.07755716145038605, "acc": 0.9839420318603516, "length": 6.45221471786499, "mode": "train", "epoch": 58}
{"loss": 0.0697571262717247, "acc": 0.9905641078948975, "length": 6.365384578704834, "mode": "test", "epoch": 58}
{"loss": 0.04140416160225868, "acc": 0.9971279501914978, "length": 5.923226356506348, "mode": "train", "epoch": 59}
{"loss": 0.05809692665934563, "acc": 0.993769109249115, "length": 5.867868423461914, "mode": "test", "epoch": 59}
{"loss": 0.03730199858546257, "acc": 0.9979946613311768, "length": 5.658594131469727, "mode": "train", "epoch": 60}
{"loss": 0.05415938049554825, "acc": 0.9950882196426392, "length": 5.826121807098389, "mode": "test", "epoch": 60}
test accuracy: 0.9947659969329834
