ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.4745123088359833, "acc": 0.7560476064682007, "length": 2.3761446475982666, "mode": "train", "epoch": 1}
{"loss": 0.3946552574634552, "acc": 0.8233456611633301, "length": 2.9565131664276123, "mode": "test", "epoch": 1}
{"loss": 0.3103255331516266, "acc": 0.8832519054412842, "length": 3.528085231781006, "mode": "train", "epoch": 2}
{"loss": 0.35639649629592896, "acc": 0.8559166789054871, "length": 3.7181122303009033, "mode": "test", "epoch": 2}
{"loss": 0.25324493646621704, "acc": 0.9120380878448486, "length": 3.9437360763549805, "mode": "train", "epoch": 3}
{"loss": 0.31556934118270874, "acc": 0.877800703048706, "length": 4.093430995941162, "mode": "test", "epoch": 3}
{"loss": 0.2231760323047638, "acc": 0.9278040528297424, "length": 4.254215240478516, "mode": "train", "epoch": 4}
{"loss": 0.314365416765213, "acc": 0.8808640241622925, "length": 4.206791877746582, "mode": "test", "epoch": 4}
{"loss": 0.20265989005565643, "acc": 0.9376105666160583, "length": 4.427788257598877, "mode": "train", "epoch": 5}
{"loss": 0.2812744975090027, "acc": 0.9014683365821838, "length": 4.465999603271484, "mode": "test", "epoch": 5}
{"loss": 0.19498209655284882, "acc": 0.9414010643959045, "length": 4.497169017791748, "mode": "train", "epoch": 6}
{"loss": 0.2648763358592987, "acc": 0.9070394039154053, "length": 4.605827331542969, "mode": "test", "epoch": 6}
{"loss": 0.1739133596420288, "acc": 0.9521716833114624, "length": 4.62507963180542, "mode": "train", "epoch": 7}
{"loss": 0.23046879470348358, "acc": 0.9276441335678101, "length": 4.759247303009033, "mode": "test", "epoch": 7}
{"loss": 0.15253877639770508, "acc": 0.9624237418174744, "length": 4.7122602462768555, "mode": "train", "epoch": 8}
{"loss": 0.20732995867729187, "acc": 0.9402704834938049, "length": 4.7588090896606445, "mode": "test", "epoch": 8}
{"loss": 0.13561522960662842, "acc": 0.9689601063728333, "length": 4.696520805358887, "mode": "train", "epoch": 9}
{"loss": 0.19648735225200653, "acc": 0.9446688294410706, "length": 4.6924824714660645, "mode": "test", "epoch": 9}
{"loss": 0.12105220556259155, "acc": 0.9744385480880737, "length": 4.660195350646973, "mode": "train", "epoch": 10}
{"loss": 0.18487673997879028, "acc": 0.9487518072128296, "length": 4.605229377746582, "mode": "test", "epoch": 10}
{"loss": 0.1063312515616417, "acc": 0.978836715221405, "length": 4.616435527801514, "mode": "train", "epoch": 11}
{"loss": 0.15295936167240143, "acc": 0.9632384777069092, "length": 4.696787357330322, "mode": "test", "epoch": 11}
{"loss": 0.09263097494840622, "acc": 0.9827353954315186, "length": 4.617900848388672, "mode": "train", "epoch": 12}
{"loss": 0.14102600514888763, "acc": 0.9690758585929871, "length": 4.623684406280518, "mode": "test", "epoch": 12}
{"loss": 0.08242400735616684, "acc": 0.9863179922103882, "length": 4.63320779800415, "mode": "train", "epoch": 13}
{"loss": 0.13947853446006775, "acc": 0.9711921811103821, "length": 4.638950824737549, "mode": "test", "epoch": 13}
{"loss": 0.07671375572681427, "acc": 0.9874875545501709, "length": 4.621181011199951, "mode": "train", "epoch": 14}
{"loss": 0.13625118136405945, "acc": 0.9696705341339111, "length": 4.600207328796387, "mode": "test", "epoch": 14}
{"loss": 0.0669194757938385, "acc": 0.9891982674598694, "length": 4.612318515777588, "mode": "train", "epoch": 15}
{"loss": 0.1469331979751587, "acc": 0.9676610827445984, "length": 4.607023239135742, "mode": "test", "epoch": 15}
{"loss": 0.060241762548685074, "acc": 0.9915973544120789, "length": 4.611851692199707, "mode": "train", "epoch": 16}
{"loss": 0.17407169938087463, "acc": 0.9625036120414734, "length": 4.5948662757873535, "mode": "test", "epoch": 16}
{"loss": 0.05658039450645447, "acc": 0.9926165342330933, "length": 4.608365535736084, "mode": "train", "epoch": 17}
{"loss": 0.15023019909858704, "acc": 0.963142454624176, "length": 4.605588436126709, "mode": "test", "epoch": 17}
{"loss": 0.05544375255703926, "acc": 0.9929263591766357, "length": 4.6082940101623535, "mode": "train", "epoch": 18}
{"loss": 0.14824877679347992, "acc": 0.9681277275085449, "length": 4.620456218719482, "mode": "test", "epoch": 18}
{"loss": 0.05247819051146507, "acc": 0.9933238625526428, "length": 4.600887298583984, "mode": "train", "epoch": 19}
{"loss": 0.155861958861351, "acc": 0.9650493264198303, "length": 4.588089942932129, "mode": "test", "epoch": 19}
{"loss": 0.045313071459531784, "acc": 0.9944623708724976, "length": 4.594838619232178, "mode": "train", "epoch": 20}
{"loss": 0.17105530202388763, "acc": 0.9549385905265808, "length": 4.589325428009033, "mode": "test", "epoch": 20}
{"loss": 0.03827640786767006, "acc": 0.996276319026947, "length": 4.590801239013672, "mode": "train", "epoch": 21}
{"loss": 0.1745254546403885, "acc": 0.9516142010688782, "length": 4.595184803009033, "mode": "test", "epoch": 21}
{"loss": 0.03605389967560768, "acc": 0.9969830513000488, "length": 4.59219217300415, "mode": "train", "epoch": 22}
{"loss": 0.1834288239479065, "acc": 0.9518951773643494, "length": 4.588568210601807, "mode": "test", "epoch": 22}
{"loss": 0.03499261289834976, "acc": 0.9973180890083313, "length": 4.5943193435668945, "mode": "train", "epoch": 23}
{"loss": 0.17551802098751068, "acc": 0.9535011649131775, "length": 4.586535453796387, "mode": "test", "epoch": 23}
{"loss": 0.033384330570697784, "acc": 0.9977216124534607, "length": 4.590456962585449, "mode": "train", "epoch": 24}
{"loss": 0.19116146862506866, "acc": 0.9524901509284973, "length": 4.594467639923096, "mode": "test", "epoch": 24}
{"loss": 0.03269263729453087, "acc": 0.9979471564292908, "length": 4.588919162750244, "mode": "train", "epoch": 25}
{"loss": 0.19151924550533295, "acc": 0.9595447182655334, "length": 4.589803695678711, "mode": "test", "epoch": 25}
{"loss": 0.03316009044647217, "acc": 0.9977625012397766, "length": 4.589755058288574, "mode": "train", "epoch": 26}
{"loss": 0.16677017509937286, "acc": 0.9674959778785706, "length": 4.58781099319458, "mode": "test", "epoch": 26}
{"loss": 0.031612247228622437, "acc": 0.9982222318649292, "length": 4.5928263664245605, "mode": "train", "epoch": 27}
{"loss": 0.20627102255821228, "acc": 0.9488635063171387, "length": 4.589325428009033, "mode": "test", "epoch": 27}
{"loss": 0.031150639057159424, "acc": 0.9983161091804504, "length": 4.589025497436523, "mode": "train", "epoch": 28}
{"loss": 0.1848054975271225, "acc": 0.9580977559089661, "length": 4.589285850524902, "mode": "test", "epoch": 28}
{"loss": 0.031683940440416336, "acc": 0.9980545043945312, "length": 4.590531349182129, "mode": "train", "epoch": 29}
{"loss": 0.2425607144832611, "acc": 0.9375661015510559, "length": 4.588209629058838, "mode": "test", "epoch": 29}
{"loss": 0.031017543748021126, "acc": 0.9983251094818115, "length": 4.587119102478027, "mode": "train", "epoch": 30}
{"loss": 0.17401868104934692, "acc": 0.9586917161941528, "length": 4.592992782592773, "mode": "test", "epoch": 30}
{"loss": 0.030439140275120735, "acc": 0.9984294176101685, "length": 4.587512969970703, "mode": "train", "epoch": 31}
{"loss": 0.16153381764888763, "acc": 0.9654497504234314, "length": 4.592952728271484, "mode": "test", "epoch": 31}
{"loss": 0.03079533763229847, "acc": 0.9983318448066711, "length": 4.5932464599609375, "mode": "train", "epoch": 32}
{"loss": 0.17211909592151642, "acc": 0.9671785831451416, "length": 4.593152046203613, "mode": "test", "epoch": 32}
{"loss": 0.03015558421611786, "acc": 0.9984501004219055, "length": 4.5911102294921875, "mode": "train", "epoch": 33}
{"loss": 0.15735062956809998, "acc": 0.9699316024780273, "length": 4.587213039398193, "mode": "test", "epoch": 33}
{"loss": 0.029997607693076134, "acc": 0.9985600113868713, "length": 4.595538139343262, "mode": "train", "epoch": 34}
{"loss": 0.17801214754581451, "acc": 0.9601801633834839, "length": 4.608099460601807, "mode": "test", "epoch": 34}
{"loss": 0.03067893348634243, "acc": 0.9983381032943726, "length": 4.591219425201416, "mode": "train", "epoch": 35}
{"loss": 0.16681405901908875, "acc": 0.9653968811035156, "length": 4.6103315353393555, "mode": "test", "epoch": 35}
{"loss": 0.03021516278386116, "acc": 0.9985148906707764, "length": 4.5891432762146, "mode": "train", "epoch": 36}
{"loss": 0.16579601168632507, "acc": 0.965427815914154, "length": 4.593231678009033, "mode": "test", "epoch": 36}
{"loss": 0.030049609020352364, "acc": 0.9984923601150513, "length": 4.59296989440918, "mode": "train", "epoch": 37}
{"loss": 0.14687809348106384, "acc": 0.9640299677848816, "length": 4.593630313873291, "mode": "test", "epoch": 37}
{"loss": 0.029574180021882057, "acc": 0.9985564947128296, "length": 4.592979431152344, "mode": "train", "epoch": 38}
{"loss": 0.14535464346408844, "acc": 0.9681071639060974, "length": 4.60726261138916, "mode": "test", "epoch": 38}
{"loss": 0.029662391170859337, "acc": 0.9986220002174377, "length": 4.596660137176514, "mode": "train", "epoch": 39}
{"loss": 0.1487651765346527, "acc": 0.9675392508506775, "length": 4.6181440353393555, "mode": "test", "epoch": 39}
{"loss": 0.029167165979743004, "acc": 0.9986876845359802, "length": 4.594850063323975, "mode": "train", "epoch": 40}
{"loss": 0.15772715210914612, "acc": 0.9628119468688965, "length": 4.590122699737549, "mode": "test", "epoch": 40}
{"loss": 0.03030853532254696, "acc": 0.9984111785888672, "length": 4.5898966789245605, "mode": "train", "epoch": 41}
{"loss": 0.13952836394309998, "acc": 0.9713671207427979, "length": 4.588528156280518, "mode": "test", "epoch": 41}
{"loss": 0.02941441349685192, "acc": 0.9987114667892456, "length": 4.588766574859619, "mode": "train", "epoch": 42}
{"loss": 0.16404470801353455, "acc": 0.9615791440010071, "length": 4.5888872146606445, "mode": "test", "epoch": 42}
{"loss": 0.02952534891664982, "acc": 0.9985939860343933, "length": 4.593080043792725, "mode": "train", "epoch": 43}
{"loss": 0.17075489461421967, "acc": 0.9600411057472229, "length": 4.60172176361084, "mode": "test", "epoch": 43}
{"loss": 0.03052675724029541, "acc": 0.9983855485916138, "length": 4.596948146820068, "mode": "train", "epoch": 44}
{"loss": 0.14408548176288605, "acc": 0.967674195766449, "length": 4.61116886138916, "mode": "test", "epoch": 44}
{"loss": 0.029332173988223076, "acc": 0.9986945390701294, "length": 4.5959882736206055, "mode": "train", "epoch": 45}
{"loss": 0.15533865988254547, "acc": 0.9695823192596436, "length": 4.605907440185547, "mode": "test", "epoch": 45}
{"loss": 0.029833491891622543, "acc": 0.9985378980636597, "length": 4.597943305969238, "mode": "train", "epoch": 46}
{"loss": 0.144003763794899, "acc": 0.9677899479866028, "length": 4.595424175262451, "mode": "test", "epoch": 46}
{"loss": 0.029327431693673134, "acc": 0.9986337423324585, "length": 4.595424652099609, "mode": "train", "epoch": 47}
{"loss": 0.17842024564743042, "acc": 0.9573794603347778, "length": 4.620854377746582, "mode": "test", "epoch": 47}
{"loss": 0.02899416722357273, "acc": 0.9987384676933289, "length": 4.595658779144287, "mode": "train", "epoch": 48}
{"loss": 0.15085209906101227, "acc": 0.9677103161811829, "length": 4.614038467407227, "mode": "test", "epoch": 48}
{"loss": 0.029705192893743515, "acc": 0.9985690712928772, "length": 4.600302219390869, "mode": "train", "epoch": 49}
{"loss": 0.13875891268253326, "acc": 0.9671157598495483, "length": 4.642219543457031, "mode": "test", "epoch": 49}
{"loss": 0.02968219853937626, "acc": 0.9985511302947998, "length": 4.595595836639404, "mode": "train", "epoch": 50}
{"loss": 0.1285095065832138, "acc": 0.9725436568260193, "length": 4.606943607330322, "mode": "test", "epoch": 50}
{"loss": 0.029353806748986244, "acc": 0.9986238479614258, "length": 4.590016841888428, "mode": "train", "epoch": 51}
{"loss": 0.11875693500041962, "acc": 0.9743538498878479, "length": 4.595503807067871, "mode": "test", "epoch": 51}
{"loss": 0.02985673025250435, "acc": 0.9985706210136414, "length": 4.588919162750244, "mode": "train", "epoch": 52}
{"loss": 0.14254130423069, "acc": 0.9670168161392212, "length": 4.599967956542969, "mode": "test", "epoch": 52}
{"loss": 0.02942243590950966, "acc": 0.9986047744750977, "length": 4.591158866882324, "mode": "train", "epoch": 53}
{"loss": 0.12646536529064178, "acc": 0.9765181541442871, "length": 4.629185199737549, "mode": "test", "epoch": 53}
{"loss": 0.030002787709236145, "acc": 0.9985238313674927, "length": 4.602663040161133, "mode": "train", "epoch": 54}
{"loss": 0.11614687740802765, "acc": 0.9791324138641357, "length": 4.660554885864258, "mode": "test", "epoch": 54}
{"loss": 0.029988953843712807, "acc": 0.9984075427055359, "length": 4.605453968048096, "mode": "train", "epoch": 55}
{"loss": 0.12247628718614578, "acc": 0.976667046546936, "length": 4.611607074737549, "mode": "test", "epoch": 55}
{"loss": 0.0300911758095026, "acc": 0.9983956217765808, "length": 4.59385871887207, "mode": "train", "epoch": 56}
{"loss": 0.13517509400844574, "acc": 0.9708216786384583, "length": 4.607661247253418, "mode": "test", "epoch": 56}
{"loss": 0.02878294140100479, "acc": 0.9988364577293396, "length": 4.597977638244629, "mode": "train", "epoch": 57}
{"loss": 0.1249585673213005, "acc": 0.9724686145782471, "length": 4.610969543457031, "mode": "test", "epoch": 57}
{"loss": 0.02998146414756775, "acc": 0.9984618425369263, "length": 4.604184150695801, "mode": "train", "epoch": 58}
{"loss": 0.107233427464962, "acc": 0.9806755781173706, "length": 4.646923065185547, "mode": "test", "epoch": 58}
{"loss": 0.029085876420140266, "acc": 0.9987112879753113, "length": 4.603456020355225, "mode": "train", "epoch": 59}
{"loss": 0.12211185693740845, "acc": 0.9749073386192322, "length": 4.671157360076904, "mode": "test", "epoch": 59}
{"loss": 0.029180163517594337, "acc": 0.9986774325370789, "length": 4.597599983215332, "mode": "train", "epoch": 60}
{"loss": 0.142014279961586, "acc": 0.9681159257888794, "length": 4.623525142669678, "mode": "test", "epoch": 60}
test accuracy: 0.9483605623245239
