ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.32454150915145874, "acc": 0.8625186085700989, "length": 3.920461893081665, "mode": "train", "epoch": 1}
{"loss": 0.29121270775794983, "acc": 0.8845226764678955, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.192355215549469, "acc": 0.9374564290046692, "length": 3.999983310699463, "mode": "train", "epoch": 2}
{"loss": 0.24809792637825012, "acc": 0.9106384515762329, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.1575918048620224, "acc": 0.952987790107727, "length": 3.999997615814209, "mode": "train", "epoch": 3}
{"loss": 0.24551446735858917, "acc": 0.9115493297576904, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.1359565258026123, "acc": 0.9607773423194885, "length": 3.999999523162842, "mode": "train", "epoch": 4}
{"loss": 0.213054358959198, "acc": 0.9299665093421936, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.12022142112255096, "acc": 0.9661001563072205, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.2512701153755188, "acc": 0.9146304726600647, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.10591281205415726, "acc": 0.9711853265762329, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.2800014913082123, "acc": 0.906512975692749, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.09731718897819519, "acc": 0.9745845198631287, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.2458263635635376, "acc": 0.9158581495285034, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.09222431480884552, "acc": 0.9766265153884888, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.24018758535385132, "acc": 0.9206811785697937, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.0879313126206398, "acc": 0.9779843688011169, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.26041048765182495, "acc": 0.9157086610794067, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.08023904263973236, "acc": 0.9800024628639221, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.2508971095085144, "acc": 0.9159179329872131, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.06797368079423904, "acc": 0.9844889640808105, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.24567608535289764, "acc": 0.9229573011398315, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.06706929206848145, "acc": 0.9848529696464539, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.33549198508262634, "acc": 0.9066325426101685, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.06306260824203491, "acc": 0.9861590266227722, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.2774088382720947, "acc": 0.9184609055519104, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.060221318155527115, "acc": 0.9867037534713745, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.31808412075042725, "acc": 0.9104172587394714, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.053550656884908676, "acc": 0.9877372980117798, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.34224164485931396, "acc": 0.8968531489372253, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.04722125455737114, "acc": 0.9894704818725586, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.37191838026046753, "acc": 0.9012317061424255, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.043924447149038315, "acc": 0.9903890490531921, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.31739306449890137, "acc": 0.9077107906341553, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.042506586760282516, "acc": 0.990631639957428, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.3246707320213318, "acc": 0.9092275500297546, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.03944191336631775, "acc": 0.9911351203918457, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.36130380630493164, "acc": 0.9024273753166199, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.03540433198213577, "acc": 0.9914765357971191, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.3168904185295105, "acc": 0.9050860404968262, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.0308849960565567, "acc": 0.9926238656044006, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.4033907651901245, "acc": 0.8929069638252258, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.025463372468948364, "acc": 0.9942865371704102, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.36870384216308594, "acc": 0.9002631306648254, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.024993466213345528, "acc": 0.9944412708282471, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.4244112968444824, "acc": 0.8753288388252258, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.022326644510030746, "acc": 0.9953938126564026, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.37557095289230347, "acc": 0.9024314880371094, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.020817464217543602, "acc": 0.9958415031433105, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.42780810594558716, "acc": 0.8933573365211487, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.020774908363819122, "acc": 0.9957319498062134, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.3572753071784973, "acc": 0.8994898796081543, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.018773257732391357, "acc": 0.996519148349762, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.43010181188583374, "acc": 0.8789123296737671, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.0203053317964077, "acc": 0.9958966970443726, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.43159329891204834, "acc": 0.8816008567810059, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.020170951262116432, "acc": 0.9959073662757874, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.4245331287384033, "acc": 0.8904517889022827, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.017885083332657814, "acc": 0.9967337846755981, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 0.40886813402175903, "acc": 0.8874780535697937, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.01873265951871872, "acc": 0.996368944644928, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.4124388098716736, "acc": 0.884026288986206, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.01747349463403225, "acc": 0.9967330694198608, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.3607437312602997, "acc": 0.9028220772743225, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.018616370856761932, "acc": 0.9964182376861572, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 0.41578200459480286, "acc": 0.8906150460243225, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.018563149496912956, "acc": 0.9962839484214783, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.4944457709789276, "acc": 0.8721361756324768, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.017882317304611206, "acc": 0.9966088533401489, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.4424842894077301, "acc": 0.8831812143325806, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.017891129478812218, "acc": 0.9966015815734863, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.39769142866134644, "acc": 0.899168848991394, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.01761162467300892, "acc": 0.9967184662818909, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.41078639030456543, "acc": 0.8979592323303223, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.01661101169884205, "acc": 0.9969382882118225, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.494168221950531, "acc": 0.8670738935470581, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.017056407406926155, "acc": 0.9967735409736633, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.39109113812446594, "acc": 0.9005661010742188, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.021986044943332672, "acc": 0.9955518841743469, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.42391589283943176, "acc": 0.8788864016532898, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.016436127945780754, "acc": 0.9969237446784973, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.475345253944397, "acc": 0.8880640268325806, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.0169661995023489, "acc": 0.9969017505645752, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.43762949109077454, "acc": 0.8913066387176514, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.01971585303544998, "acc": 0.9960135817527771, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.4694575071334839, "acc": 0.8742246627807617, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.0166444294154644, "acc": 0.9968373775482178, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.46308407187461853, "acc": 0.8851780295372009, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.016986768692731857, "acc": 0.9968627095222473, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.36757948994636536, "acc": 0.8966776132583618, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.016616949811577797, "acc": 0.9968400001525879, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.3946340084075928, "acc": 0.9018117189407349, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.01563534326851368, "acc": 0.9971203207969666, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.38811516761779785, "acc": 0.8980209231376648, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.01918657496571541, "acc": 0.9963411688804626, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.4274592995643616, "acc": 0.8729433417320251, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.017703134566545486, "acc": 0.9965223670005798, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.3974798917770386, "acc": 0.8886319994926453, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.016857391223311424, "acc": 0.9968027472496033, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.3410620391368866, "acc": 0.9094645977020264, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.01911121793091297, "acc": 0.9963657259941101, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.3874537944793701, "acc": 0.8847575783729553, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.01688484475016594, "acc": 0.9967323541641235, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.3763251304626465, "acc": 0.9060487747192383, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.015940161421895027, "acc": 0.997105062007904, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.3256283700466156, "acc": 0.9100286364555359, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.01999235898256302, "acc": 0.9959803819656372, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.41744470596313477, "acc": 0.8871093392372131, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.016600338742136955, "acc": 0.9968339800834656, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.3878495693206787, "acc": 0.8985410332679749, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.018938714638352394, "acc": 0.9961791038513184, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.3420886695384979, "acc": 0.9083962440490723, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.018717462196946144, "acc": 0.9963438510894775, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.3313245177268982, "acc": 0.915276288986206, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.017003364861011505, "acc": 0.9967921376228333, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.4161042869091034, "acc": 0.8910354971885681, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.01785825751721859, "acc": 0.996580183506012, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.3396335244178772, "acc": 0.9053810834884644, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.017030276358127594, "acc": 0.9966959357261658, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.33497127890586853, "acc": 0.911742627620697, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9103814363479614
