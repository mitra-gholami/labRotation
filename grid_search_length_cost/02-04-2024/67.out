ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.31270769238471985, "acc": 0.8663225173950195, "length": 7.639923095703125, "mode": "train", "epoch": 1}
{"loss": 0.25158223509788513, "acc": 0.9056240320205688, "length": 8.983194351196289, "mode": "test", "epoch": 1}
{"loss": 0.1615239679813385, "acc": 0.9517537951469421, "length": 9.719278335571289, "mode": "train", "epoch": 2}
{"loss": 0.18134507536888123, "acc": 0.9411118030548096, "length": 9.88724422454834, "mode": "test", "epoch": 2}
{"loss": 0.11054396629333496, "acc": 0.972080647945404, "length": 10.559133529663086, "mode": "train", "epoch": 3}
{"loss": 0.1777433305978775, "acc": 0.9429776072502136, "length": 10.188780784606934, "mode": "test", "epoch": 3}
{"loss": 0.07742147147655487, "acc": 0.981269896030426, "length": 10.668389320373535, "mode": "train", "epoch": 4}
{"loss": 0.12182426452636719, "acc": 0.963908851146698, "length": 10.870558738708496, "mode": "test", "epoch": 4}
{"loss": 0.04141058772802353, "acc": 0.9928118586540222, "length": 10.930282592773438, "mode": "train", "epoch": 5}
{"loss": 0.08164890855550766, "acc": 0.9801497459411621, "length": 10.999959945678711, "mode": "test", "epoch": 5}
{"loss": 0.02673010714352131, "acc": 0.9971420764923096, "length": 10.987133979797363, "mode": "train", "epoch": 6}
{"loss": 0.03504203259944916, "acc": 0.9939439296722412, "length": 10.999719619750977, "mode": "test", "epoch": 6}
{"loss": 0.024273483082652092, "acc": 0.9975209832191467, "length": 10.998997688293457, "mode": "train", "epoch": 7}
{"loss": 0.030522814020514488, "acc": 0.9952585101127625, "length": 11.0, "mode": "test", "epoch": 7}
{"loss": 0.022952748462557793, "acc": 0.9976403713226318, "length": 10.999824523925781, "mode": "train", "epoch": 8}
{"loss": 0.03995073214173317, "acc": 0.9928196668624878, "length": 11.0, "mode": "test", "epoch": 8}
{"loss": 0.019815519452095032, "acc": 0.9983021020889282, "length": 10.99992847442627, "mode": "train", "epoch": 9}
{"loss": 0.025470785796642303, "acc": 0.9967108964920044, "length": 11.0, "mode": "test", "epoch": 9}
{"loss": 0.0186008308082819, "acc": 0.9985724687576294, "length": 10.9999418258667, "mode": "train", "epoch": 10}
{"loss": 0.02039242908358574, "acc": 0.9984575510025024, "length": 11.0, "mode": "test", "epoch": 10}
{"loss": 0.018705204129219055, "acc": 0.9985050559043884, "length": 10.99998664855957, "mode": "train", "epoch": 11}
{"loss": 0.020984312519431114, "acc": 0.9980313181877136, "length": 11.0, "mode": "test", "epoch": 11}
{"loss": 0.018041515722870827, "acc": 0.9986125826835632, "length": 10.99999713897705, "mode": "train", "epoch": 12}
{"loss": 0.021503770723938942, "acc": 0.9976111650466919, "length": 11.0, "mode": "test", "epoch": 12}
{"loss": 0.017085375264286995, "acc": 0.9988965392112732, "length": 11.0, "mode": "train", "epoch": 13}
{"loss": 0.017834456637501717, "acc": 0.9988415837287903, "length": 11.0, "mode": "test", "epoch": 13}
{"loss": 0.016996797174215317, "acc": 0.9988632202148438, "length": 11.0, "mode": "train", "epoch": 14}
{"loss": 0.021453263238072395, "acc": 0.9981953501701355, "length": 11.0, "mode": "test", "epoch": 14}
{"loss": 0.01729588396847248, "acc": 0.9987385869026184, "length": 11.0, "mode": "train", "epoch": 15}
{"loss": 0.01750236749649048, "acc": 0.9989315867424011, "length": 11.0, "mode": "test", "epoch": 15}
{"loss": 0.015796281397342682, "acc": 0.9990792870521545, "length": 11.0, "mode": "train", "epoch": 16}
{"loss": 0.019254617393016815, "acc": 0.9984075427055359, "length": 11.0, "mode": "test", "epoch": 16}
{"loss": 0.015352861024439335, "acc": 0.9992285370826721, "length": 11.0, "mode": "train", "epoch": 17}
{"loss": 0.01736762747168541, "acc": 0.9988476634025574, "length": 11.0, "mode": "test", "epoch": 17}
{"loss": 0.02290225215256214, "acc": 0.996997058391571, "length": 11.0, "mode": "train", "epoch": 18}
{"loss": 0.03899611905217171, "acc": 0.992511510848999, "length": 11.0, "mode": "test", "epoch": 18}
{"loss": 0.02403121441602707, "acc": 0.9963847994804382, "length": 11.0, "mode": "train", "epoch": 19}
{"loss": 0.030132068321108818, "acc": 0.995742678642273, "length": 11.0, "mode": "test", "epoch": 19}
{"loss": 0.016923896968364716, "acc": 0.9986705780029297, "length": 11.0, "mode": "train", "epoch": 20}
{"loss": 0.018319478258490562, "acc": 0.9987415671348572, "length": 11.0, "mode": "test", "epoch": 20}
{"loss": 0.016194099560379982, "acc": 0.9989518523216248, "length": 11.0, "mode": "train", "epoch": 21}
{"loss": 0.020289404317736626, "acc": 0.9981874823570251, "length": 11.0, "mode": "test", "epoch": 21}
{"loss": 0.01539523620158434, "acc": 0.9991526007652283, "length": 11.0, "mode": "train", "epoch": 22}
{"loss": 0.022670000791549683, "acc": 0.9979373812675476, "length": 11.0, "mode": "test", "epoch": 22}
{"loss": 0.014612587168812752, "acc": 0.9993686079978943, "length": 11.0, "mode": "train", "epoch": 23}
{"loss": 0.020034147426486015, "acc": 0.9987436532974243, "length": 11.0, "mode": "test", "epoch": 23}
{"loss": 0.014722218737006187, "acc": 0.9992885589599609, "length": 11.0, "mode": "train", "epoch": 24}
{"loss": 0.016068775206804276, "acc": 0.9991216659545898, "length": 11.0, "mode": "test", "epoch": 24}
{"loss": 0.01485405396670103, "acc": 0.9993119835853577, "length": 11.0, "mode": "train", "epoch": 25}
{"loss": 0.018450308591127396, "acc": 0.9988937377929688, "length": 11.0, "mode": "test", "epoch": 25}
{"loss": 0.015569721348583698, "acc": 0.9991393089294434, "length": 11.0, "mode": "train", "epoch": 26}
{"loss": 0.037870828062295914, "acc": 0.9936899542808533, "length": 11.0, "mode": "test", "epoch": 26}
{"loss": 0.01618821546435356, "acc": 0.9988171458244324, "length": 11.0, "mode": "train", "epoch": 27}
{"loss": 0.015746859833598137, "acc": 0.9991496205329895, "length": 11.0, "mode": "test", "epoch": 27}
{"loss": 0.019701115787029266, "acc": 0.9981397986412048, "length": 11.0, "mode": "train", "epoch": 28}
{"loss": 0.015960637480020523, "acc": 0.999291718006134, "length": 11.0, "mode": "test", "epoch": 28}
{"loss": 0.01438149530440569, "acc": 0.9993420243263245, "length": 11.0, "mode": "train", "epoch": 29}
{"loss": 0.015683293342590332, "acc": 0.9992358684539795, "length": 11.0, "mode": "test", "epoch": 29}
{"loss": 0.015193433500826359, "acc": 0.999235987663269, "length": 11.0, "mode": "train", "epoch": 30}
{"loss": 0.014162762090563774, "acc": 0.999491810798645, "length": 11.0, "mode": "test", "epoch": 30}
{"loss": 0.014411808922886848, "acc": 0.9993593096733093, "length": 11.0, "mode": "train", "epoch": 31}
{"loss": 0.01584494672715664, "acc": 0.9991537928581238, "length": 11.0, "mode": "test", "epoch": 31}
{"loss": 0.015239344909787178, "acc": 0.9991958737373352, "length": 11.0, "mode": "train", "epoch": 32}
{"loss": 0.01688455045223236, "acc": 0.9989576935768127, "length": 11.0, "mode": "test", "epoch": 32}
{"loss": 0.01339712180197239, "acc": 0.9995812177658081, "length": 11.0, "mode": "train", "epoch": 33}
{"loss": 0.019433528184890747, "acc": 0.998477578163147, "length": 11.0, "mode": "test", "epoch": 33}
{"loss": 0.01786828599870205, "acc": 0.9984198212623596, "length": 11.0, "mode": "train", "epoch": 34}
{"loss": 0.024889228865504265, "acc": 0.9973052144050598, "length": 11.0, "mode": "test", "epoch": 34}
{"loss": 0.019407054409384727, "acc": 0.9980270862579346, "length": 11.0, "mode": "train", "epoch": 35}
{"loss": 0.039241254329681396, "acc": 0.9933817982673645, "length": 11.0, "mode": "test", "epoch": 35}
{"loss": 0.021562961861491203, "acc": 0.9974530339241028, "length": 11.0, "mode": "train", "epoch": 36}
{"loss": 0.01972340978682041, "acc": 0.9984655976295471, "length": 11.0, "mode": "test", "epoch": 36}
{"loss": 0.014454832300543785, "acc": 0.9993306398391724, "length": 11.0, "mode": "train", "epoch": 37}
{"loss": 0.014462248422205448, "acc": 0.999433696269989, "length": 11.0, "mode": "test", "epoch": 37}
{"loss": 0.014170372858643532, "acc": 0.999407947063446, "length": 11.0, "mode": "train", "epoch": 38}
{"loss": 0.022651663050055504, "acc": 0.9979012608528137, "length": 11.0, "mode": "test", "epoch": 38}
{"loss": 0.01473297644406557, "acc": 0.9992085695266724, "length": 11.0, "mode": "train", "epoch": 39}
{"loss": 0.01887761615216732, "acc": 0.99845951795578, "length": 11.0, "mode": "test", "epoch": 39}
{"loss": 0.016389476135373116, "acc": 0.9987652897834778, "length": 11.0, "mode": "train", "epoch": 40}
{"loss": 0.016240717843174934, "acc": 0.9991536140441895, "length": 11.0, "mode": "test", "epoch": 40}
{"loss": 0.014720197767019272, "acc": 0.9992585778236389, "length": 11.0, "mode": "train", "epoch": 41}
{"loss": 0.018925385549664497, "acc": 0.9981994032859802, "length": 11.0, "mode": "test", "epoch": 41}
{"loss": 0.015237401239573956, "acc": 0.9991698861122131, "length": 11.0, "mode": "train", "epoch": 42}
{"loss": 0.022817306220531464, "acc": 0.9974672198295593, "length": 11.0, "mode": "test", "epoch": 42}
{"loss": 0.015725137665867805, "acc": 0.999043881893158, "length": 11.0, "mode": "train", "epoch": 43}
{"loss": 0.015840688720345497, "acc": 0.9990977644920349, "length": 11.0, "mode": "test", "epoch": 43}
{"loss": 0.014337494038045406, "acc": 0.9993793368339539, "length": 11.0, "mode": "train", "epoch": 44}
{"loss": 0.018357668071985245, "acc": 0.998733639717102, "length": 11.0, "mode": "test", "epoch": 44}
{"loss": 0.014058759436011314, "acc": 0.9994345307350159, "length": 11.0, "mode": "train", "epoch": 45}
{"loss": 0.016473861411213875, "acc": 0.9990716576576233, "length": 11.0, "mode": "test", "epoch": 45}
{"loss": 0.018251216039061546, "acc": 0.9984578490257263, "length": 11.0, "mode": "train", "epoch": 46}
{"loss": 0.01563172973692417, "acc": 0.9992236495018005, "length": 11.0, "mode": "test", "epoch": 46}
{"loss": 0.014130610041320324, "acc": 0.999407947063446, "length": 11.0, "mode": "train", "epoch": 47}
{"loss": 0.014726519584655762, "acc": 0.9993898272514343, "length": 11.0, "mode": "test", "epoch": 47}
{"loss": 0.013267545960843563, "acc": 0.9996013045310974, "length": 11.0, "mode": "train", "epoch": 48}
{"loss": 0.013778365217149258, "acc": 0.9995818138122559, "length": 11.0, "mode": "test", "epoch": 48}
{"loss": 0.018314488232135773, "acc": 0.9985231757164001, "length": 11.0, "mode": "train", "epoch": 49}
{"loss": 0.01833776943385601, "acc": 0.9986815452575684, "length": 11.0, "mode": "test", "epoch": 49}
{"loss": 0.024676119908690453, "acc": 0.9965817332267761, "length": 11.0, "mode": "train", "epoch": 50}
{"loss": 0.0719803124666214, "acc": 0.983826756477356, "length": 11.0, "mode": "test", "epoch": 50}
{"loss": 0.03174314647912979, "acc": 0.994360625743866, "length": 11.0, "mode": "train", "epoch": 51}
{"loss": 0.02278161607682705, "acc": 0.9974611401557922, "length": 11.0, "mode": "test", "epoch": 51}
{"loss": 0.01655721850693226, "acc": 0.9987084865570068, "length": 11.0, "mode": "train", "epoch": 52}
{"loss": 0.017020804807543755, "acc": 0.9986615180969238, "length": 11.0, "mode": "test", "epoch": 52}
{"loss": 0.013466894626617432, "acc": 0.999518096446991, "length": 11.0, "mode": "train", "epoch": 53}
{"loss": 0.015018090605735779, "acc": 0.9992536902427673, "length": 11.0, "mode": "test", "epoch": 53}
{"loss": 0.03627500683069229, "acc": 0.992915153503418, "length": 11.0, "mode": "train", "epoch": 54}
{"loss": 0.0739625096321106, "acc": 0.9812300801277161, "length": 11.0, "mode": "test", "epoch": 54}
{"loss": 0.06757547706365585, "acc": 0.9835062623023987, "length": 11.0, "mode": "train", "epoch": 55}
{"loss": 0.06341908127069473, "acc": 0.9851372241973877, "length": 11.0, "mode": "test", "epoch": 55}
{"loss": 0.05058569461107254, "acc": 0.9886254668235779, "length": 11.0, "mode": "train", "epoch": 56}
{"loss": 0.048791442066431046, "acc": 0.9896486401557922, "length": 11.0, "mode": "test", "epoch": 56}
{"loss": 0.033271674066782, "acc": 0.9936700463294983, "length": 11.0, "mode": "train", "epoch": 57}
{"loss": 0.02634436823427677, "acc": 0.9966850280761719, "length": 11.0, "mode": "test", "epoch": 57}
{"loss": 0.017289763316512108, "acc": 0.9986385107040405, "length": 11.0, "mode": "train", "epoch": 58}
{"loss": 0.018836788833141327, "acc": 0.9983375072479248, "length": 11.0, "mode": "test", "epoch": 58}
{"loss": 0.022183220833539963, "acc": 0.9971363544464111, "length": 11.0, "mode": "train", "epoch": 59}
{"loss": 0.02200605534017086, "acc": 0.9970110058784485, "length": 11.0, "mode": "test", "epoch": 59}
{"loss": 0.01703011244535446, "acc": 0.9986865520477295, "length": 11.0, "mode": "train", "epoch": 60}
{"loss": 0.017794284969568253, "acc": 0.9983635544776917, "length": 11.0, "mode": "test", "epoch": 60}
test accuracy: 0.9981546401977539
