ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 30
{"loss": 0.42653098702430725, "acc": 0.8025696277618408, "length": 4.114858627319336, "mode": "train", "epoch": 1}
{"loss": 0.32730528712272644, "acc": 0.8778784871101379, "length": 5.7779340744018555, "mode": "test", "epoch": 1}
{"loss": 0.23867017030715942, "acc": 0.9209741950035095, "length": 5.7302656173706055, "mode": "train", "epoch": 2}
{"loss": 0.2633266746997833, "acc": 0.9107009172439575, "length": 5.472786903381348, "mode": "test", "epoch": 2}
{"loss": 0.19117248058319092, "acc": 0.9433438181877136, "length": 5.816921234130859, "mode": "train", "epoch": 3}
{"loss": 0.21080242097377777, "acc": 0.934748113155365, "length": 5.580450057983398, "mode": "test", "epoch": 3}
{"loss": 0.17001618444919586, "acc": 0.9517943263053894, "length": 5.69815731048584, "mode": "train", "epoch": 4}
{"loss": 0.18461033701896667, "acc": 0.9447590708732605, "length": 5.429534435272217, "mode": "test", "epoch": 4}
{"loss": 0.1573592573404312, "acc": 0.9562850594520569, "length": 5.560643672943115, "mode": "train", "epoch": 5}
{"loss": 0.18194210529327393, "acc": 0.9425343871116638, "length": 5.315707683563232, "mode": "test", "epoch": 5}
{"loss": 0.14473675191402435, "acc": 0.9610505104064941, "length": 5.519578456878662, "mode": "train", "epoch": 6}
{"loss": 0.16499915719032288, "acc": 0.9535900950431824, "length": 5.382857322692871, "mode": "test", "epoch": 6}
{"loss": 0.13586077094078064, "acc": 0.9642357230186462, "length": 5.49302864074707, "mode": "train", "epoch": 7}
{"loss": 0.15994618833065033, "acc": 0.9536700248718262, "length": 5.275230884552002, "mode": "test", "epoch": 7}
{"loss": 0.12603828310966492, "acc": 0.9668834805488586, "length": 5.507056713104248, "mode": "train", "epoch": 8}
{"loss": 0.14668972790241241, "acc": 0.959226667881012, "length": 5.627054691314697, "mode": "test", "epoch": 8}
{"loss": 0.11193154752254486, "acc": 0.9723670482635498, "length": 5.7087812423706055, "mode": "train", "epoch": 9}
{"loss": 0.13431520760059357, "acc": 0.9634827971458435, "length": 5.961649417877197, "mode": "test", "epoch": 9}
{"loss": 0.10322529822587967, "acc": 0.9756761789321899, "length": 5.72455358505249, "mode": "train", "epoch": 10}
{"loss": 0.12769022583961487, "acc": 0.9653128385543823, "length": 5.604959487915039, "mode": "test", "epoch": 10}
{"loss": 0.09749589115381241, "acc": 0.9771504402160645, "length": 5.6858038902282715, "mode": "train", "epoch": 11}
{"loss": 0.11857453733682632, "acc": 0.9696985483169556, "length": 5.746864318847656, "mode": "test", "epoch": 11}
{"loss": 0.09261567890644073, "acc": 0.978856086730957, "length": 5.744871139526367, "mode": "train", "epoch": 12}
{"loss": 0.11343182623386383, "acc": 0.9716694951057434, "length": 6.067870616912842, "mode": "test", "epoch": 12}
{"loss": 0.08676661550998688, "acc": 0.9809182286262512, "length": 5.705099582672119, "mode": "train", "epoch": 13}
{"loss": 0.1086580827832222, "acc": 0.9725418090820312, "length": 6.021374225616455, "mode": "test", "epoch": 13}
{"loss": 0.08418282121419907, "acc": 0.9816556572914124, "length": 5.662964344024658, "mode": "train", "epoch": 14}
{"loss": 0.10543756186962128, "acc": 0.9727727174758911, "length": 5.783556938171387, "mode": "test", "epoch": 14}
{"loss": 0.08237262815237045, "acc": 0.9822198152542114, "length": 5.65819787979126, "mode": "train", "epoch": 15}
{"loss": 0.09756322205066681, "acc": 0.9764435887336731, "length": 5.643129825592041, "mode": "test", "epoch": 15}
{"loss": 0.07969192415475845, "acc": 0.9829733371734619, "length": 5.633109092712402, "mode": "train", "epoch": 16}
{"loss": 0.09552006423473358, "acc": 0.9746680855751038, "length": 5.566608905792236, "mode": "test", "epoch": 16}
{"loss": 0.07669416069984436, "acc": 0.9838330149650574, "length": 5.615931510925293, "mode": "train", "epoch": 17}
{"loss": 0.0866408571600914, "acc": 0.9795894622802734, "length": 5.705774307250977, "mode": "test", "epoch": 17}
{"loss": 0.0718347579240799, "acc": 0.9852045774459839, "length": 5.635061264038086, "mode": "train", "epoch": 18}
{"loss": 0.08800877630710602, "acc": 0.9784844517707825, "length": 5.59220027923584, "mode": "test", "epoch": 18}
{"loss": 0.07044324278831482, "acc": 0.9856414794921875, "length": 5.653073787689209, "mode": "train", "epoch": 19}
{"loss": 0.10647838562726974, "acc": 0.973355770111084, "length": 6.099913597106934, "mode": "test", "epoch": 19}
{"loss": 0.06768824905157089, "acc": 0.986251175403595, "length": 5.638832092285156, "mode": "train", "epoch": 20}
{"loss": 0.08389105647802353, "acc": 0.9792641401290894, "length": 5.891327857971191, "mode": "test", "epoch": 20}
{"loss": 0.06735128164291382, "acc": 0.9862675666809082, "length": 5.635482311248779, "mode": "train", "epoch": 21}
{"loss": 0.08188574761152267, "acc": 0.9802623987197876, "length": 5.548370838165283, "mode": "test", "epoch": 21}
{"loss": 0.06436285376548767, "acc": 0.9870177507400513, "length": 5.605501174926758, "mode": "train", "epoch": 22}
{"loss": 0.08814467489719391, "acc": 0.978034257888794, "length": 5.486844062805176, "mode": "test", "epoch": 22}
{"loss": 0.06402222812175751, "acc": 0.9870083928108215, "length": 5.604894638061523, "mode": "train", "epoch": 23}
{"loss": 0.08200674504041672, "acc": 0.9804245829582214, "length": 5.4960713386535645, "mode": "test", "epoch": 23}
{"loss": 0.06143924966454506, "acc": 0.9877312183380127, "length": 5.592777729034424, "mode": "train", "epoch": 24}
{"loss": 0.07830899208784103, "acc": 0.9814229011535645, "length": 5.4829511642456055, "mode": "test", "epoch": 24}
{"loss": 0.0591709278523922, "acc": 0.9882010221481323, "length": 5.5657172203063965, "mode": "train", "epoch": 25}
{"loss": 0.0752033144235611, "acc": 0.9825831651687622, "length": 5.663098335266113, "mode": "test", "epoch": 25}
{"loss": 0.058681849390268326, "acc": 0.9883168339729309, "length": 5.621584415435791, "mode": "train", "epoch": 26}
{"loss": 0.066622793674469, "acc": 0.985784649848938, "length": 5.835315704345703, "mode": "test", "epoch": 26}
{"loss": 0.05436395853757858, "acc": 0.9895822405815125, "length": 5.579377174377441, "mode": "train", "epoch": 27}
{"loss": 0.06825664639472961, "acc": 0.9845682382583618, "length": 5.44932222366333, "mode": "test", "epoch": 27}
{"loss": 0.05433761328458786, "acc": 0.9895928502082825, "length": 5.587703227996826, "mode": "train", "epoch": 28}
{"loss": 0.06350520998239517, "acc": 0.9865131974220276, "length": 5.535539150238037, "mode": "test", "epoch": 28}
{"loss": 0.05245330184698105, "acc": 0.9900762438774109, "length": 5.5827178955078125, "mode": "train", "epoch": 29}
{"loss": 0.06180249899625778, "acc": 0.9870357513427734, "length": 5.526708602905273, "mode": "test", "epoch": 29}
{"loss": 0.05217381566762924, "acc": 0.989976704120636, "length": 5.573388576507568, "mode": "train", "epoch": 30}
{"loss": 0.06391310691833496, "acc": 0.9851087331771851, "length": 5.437536239624023, "mode": "test", "epoch": 30}
{"loss": 0.04936479777097702, "acc": 0.9907869100570679, "length": 5.5994553565979, "mode": "train", "epoch": 31}
{"loss": 0.0585319846868515, "acc": 0.9880772233009338, "length": 5.529195308685303, "mode": "test", "epoch": 31}
{"loss": 0.050309956073760986, "acc": 0.9904828667640686, "length": 5.592563629150391, "mode": "train", "epoch": 32}
{"loss": 0.06468874216079712, "acc": 0.9863024353981018, "length": 5.560445308685303, "mode": "test", "epoch": 32}
{"loss": 0.04791282117366791, "acc": 0.9912548661231995, "length": 5.575058460235596, "mode": "train", "epoch": 33}
{"loss": 0.05672460421919823, "acc": 0.988923192024231, "length": 5.680110931396484, "mode": "test", "epoch": 33}
{"loss": 0.04738384857773781, "acc": 0.991304337978363, "length": 5.553903579711914, "mode": "train", "epoch": 34}
{"loss": 0.055592335760593414, "acc": 0.9900707006454468, "length": 5.521374225616455, "mode": "test", "epoch": 34}
{"loss": 0.04749751091003418, "acc": 0.9913234114646912, "length": 5.544070243835449, "mode": "train", "epoch": 35}
{"loss": 0.05554116517305374, "acc": 0.9892982840538025, "length": 5.562103748321533, "mode": "test", "epoch": 35}
{"loss": 0.04595512896776199, "acc": 0.9915956854820251, "length": 5.519664287567139, "mode": "train", "epoch": 36}
{"loss": 0.05664033070206642, "acc": 0.9894272685050964, "length": 5.767841815948486, "mode": "test", "epoch": 36}
{"loss": 0.046070970594882965, "acc": 0.9915654063224792, "length": 5.52087926864624, "mode": "train", "epoch": 37}
{"loss": 0.04884931445121765, "acc": 0.9912840127944946, "length": 5.5561203956604, "mode": "test", "epoch": 37}
{"loss": 0.045067884027957916, "acc": 0.9917989373207092, "length": 5.531972885131836, "mode": "train", "epoch": 38}
{"loss": 0.05286090821027756, "acc": 0.9899425506591797, "length": 5.491854190826416, "mode": "test", "epoch": 38}
{"loss": 0.04484529793262482, "acc": 0.9918688535690308, "length": 5.498175144195557, "mode": "train", "epoch": 39}
{"loss": 0.04627992957830429, "acc": 0.9919919371604919, "length": 5.742502689361572, "mode": "test", "epoch": 39}
{"loss": 0.04355795681476593, "acc": 0.9921240210533142, "length": 5.509861469268799, "mode": "train", "epoch": 40}
{"loss": 0.04848264530301094, "acc": 0.991135835647583, "length": 5.497368812561035, "mode": "test", "epoch": 40}
{"loss": 0.04392000660300255, "acc": 0.9919053316116333, "length": 5.542775630950928, "mode": "train", "epoch": 41}
{"loss": 0.047198932617902756, "acc": 0.9916086196899414, "length": 5.452422142028809, "mode": "test", "epoch": 41}
{"loss": 0.04299255087971687, "acc": 0.9921659231185913, "length": 5.513440132141113, "mode": "train", "epoch": 42}
{"loss": 0.04610486701130867, "acc": 0.9918901920318604, "length": 5.449610710144043, "mode": "test", "epoch": 42}
{"loss": 0.04435807466506958, "acc": 0.9918174743652344, "length": 5.537050724029541, "mode": "train", "epoch": 43}
{"loss": 0.04817257449030876, "acc": 0.9910246133804321, "length": 5.433102607727051, "mode": "test", "epoch": 43}
{"loss": 0.04163537174463272, "acc": 0.9924803376197815, "length": 5.542381286621094, "mode": "train", "epoch": 44}
{"loss": 0.045238204300403595, "acc": 0.9917177557945251, "length": 5.485690593719482, "mode": "test", "epoch": 44}
{"loss": 0.04177486523985863, "acc": 0.9923149347305298, "length": 5.49320650100708, "mode": "train", "epoch": 45}
{"loss": 0.05008815973997116, "acc": 0.9910576343536377, "length": 5.581422805786133, "mode": "test", "epoch": 45}
{"loss": 0.04232729971408844, "acc": 0.992139458656311, "length": 5.5104804039001465, "mode": "train", "epoch": 46}
{"loss": 0.044809263199567795, "acc": 0.9920353889465332, "length": 5.469795227050781, "mode": "test", "epoch": 46}
{"loss": 0.039515480399131775, "acc": 0.9928302764892578, "length": 5.486185550689697, "mode": "train", "epoch": 47}
{"loss": 0.04219307005405426, "acc": 0.992608904838562, "length": 5.426074028015137, "mode": "test", "epoch": 47}
{"loss": 0.04274073615670204, "acc": 0.991828203201294, "length": 5.481321334838867, "mode": "train", "epoch": 48}
{"loss": 0.045579079538583755, "acc": 0.9915855526924133, "length": 5.458189010620117, "mode": "test", "epoch": 48}
{"loss": 0.039903122931718826, "acc": 0.9926102757453918, "length": 5.482645511627197, "mode": "train", "epoch": 49}
{"loss": 0.04327227920293808, "acc": 0.9919703006744385, "length": 5.474084377288818, "mode": "test", "epoch": 49}
{"loss": 0.03947785496711731, "acc": 0.9926583170890808, "length": 5.557679176330566, "mode": "train", "epoch": 50}
{"loss": 0.04514824599027634, "acc": 0.9919624328613281, "length": 5.6020402908325195, "mode": "test", "epoch": 50}
{"loss": 0.037825264036655426, "acc": 0.9929689168930054, "length": 5.470627307891846, "mode": "train", "epoch": 51}
{"loss": 0.0430629700422287, "acc": 0.9922322630882263, "length": 5.461180686950684, "mode": "test", "epoch": 51}
{"loss": 0.03691745176911354, "acc": 0.9932096600532532, "length": 5.491376876831055, "mode": "train", "epoch": 52}
{"loss": 0.03968150168657303, "acc": 0.993060290813446, "length": 5.52029275894165, "mode": "test", "epoch": 52}
{"loss": 0.0374026820063591, "acc": 0.9930068850517273, "length": 5.499377727508545, "mode": "train", "epoch": 53}
{"loss": 0.044268324971199036, "acc": 0.9911428093910217, "length": 5.4881415367126465, "mode": "test", "epoch": 53}
{"loss": 0.03559421747922897, "acc": 0.9934265613555908, "length": 5.472508430480957, "mode": "train", "epoch": 54}
{"loss": 0.03742391988635063, "acc": 0.9933941960334778, "length": 5.603229522705078, "mode": "test", "epoch": 54}
{"loss": 0.03643420711159706, "acc": 0.9932560920715332, "length": 5.6004252433776855, "mode": "train", "epoch": 55}
{"loss": 0.03997815027832985, "acc": 0.9929384589195251, "length": 5.484861373901367, "mode": "test", "epoch": 55}
{"loss": 0.033317312598228455, "acc": 0.9941313862800598, "length": 5.469400405883789, "mode": "train", "epoch": 56}
{"loss": 0.04067914932966232, "acc": 0.9932717084884644, "length": 5.56206750869751, "mode": "test", "epoch": 56}
{"loss": 0.0341496579349041, "acc": 0.9937822818756104, "length": 5.4809889793396, "mode": "train", "epoch": 57}
{"loss": 0.042240243405103683, "acc": 0.9927278757095337, "length": 5.457864761352539, "mode": "test", "epoch": 57}
{"loss": 0.032928965985774994, "acc": 0.9940360188484192, "length": 5.452877521514893, "mode": "train", "epoch": 58}
{"loss": 0.03876670449972153, "acc": 0.9932980537414551, "length": 5.471705436706543, "mode": "test", "epoch": 58}
{"loss": 0.03288686275482178, "acc": 0.9941110014915466, "length": 5.4493184089660645, "mode": "train", "epoch": 59}
{"loss": 0.03599957004189491, "acc": 0.993981659412384, "length": 5.417063236236572, "mode": "test", "epoch": 59}
{"loss": 0.031174104660749435, "acc": 0.9945351481437683, "length": 5.42771577835083, "mode": "train", "epoch": 60}
{"loss": 0.03648890182375908, "acc": 0.9935493469238281, "length": 5.409890651702881, "mode": "test", "epoch": 60}
test accuracy: 0.9623963832855225
