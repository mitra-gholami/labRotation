ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.6880807876586914, "acc": 0.5490177273750305, "length": 4.3589186668396, "mode": "train", "epoch": 1}
{"loss": 0.6580862402915955, "acc": 0.6192871928215027, "length": 2.0572917461395264, "mode": "test", "epoch": 1}
{"loss": 0.6076204180717468, "acc": 0.6660265326499939, "length": 4.253668785095215, "mode": "train", "epoch": 2}
{"loss": 0.6320831179618835, "acc": 0.6464789509773254, "length": 1.6961805820465088, "mode": "test", "epoch": 2}
{"loss": 0.5461686849594116, "acc": 0.7231115102767944, "length": 4.239292144775391, "mode": "train", "epoch": 3}
{"loss": 0.8234065175056458, "acc": 0.6771321296691895, "length": 14.140625, "mode": "test", "epoch": 3}
{"loss": 0.4540786147117615, "acc": 0.7936211824417114, "length": 6.187337398529053, "mode": "train", "epoch": 4}
{"loss": 0.7127508521080017, "acc": 0.7436931133270264, "length": 13.697916984558105, "mode": "test", "epoch": 4}
{"loss": 0.4028216004371643, "acc": 0.8251447677612305, "length": 7.843638896942139, "mode": "train", "epoch": 5}
{"loss": 0.6282384395599365, "acc": 0.7794840335845947, "length": 16.0625, "mode": "test", "epoch": 5}
{"loss": 0.3463633358478546, "acc": 0.8583335876464844, "length": 9.510004043579102, "mode": "train", "epoch": 6}
{"loss": 0.6001295447349548, "acc": 0.7980197072029114, "length": 15.307291984558105, "mode": "test", "epoch": 6}
{"loss": 0.3199169933795929, "acc": 0.8737906217575073, "length": 9.000028610229492, "mode": "train", "epoch": 7}
{"loss": 0.5032985210418701, "acc": 0.8047064542770386, "length": 11.89756965637207, "mode": "test", "epoch": 7}
{"loss": 0.29069653153419495, "acc": 0.8877219557762146, "length": 9.994722366333008, "mode": "train", "epoch": 8}
{"loss": 0.397896945476532, "acc": 0.8538275957107544, "length": 12.84548568725586, "mode": "test", "epoch": 8}
{"loss": 0.2646375000476837, "acc": 0.8995216488838196, "length": 10.333390235900879, "mode": "train", "epoch": 9}
{"loss": 0.2944129407405853, "acc": 0.8897677659988403, "length": 11.824652671813965, "mode": "test", "epoch": 9}
{"loss": 0.23792874813079834, "acc": 0.9126266241073608, "length": 10.38719654083252, "mode": "train", "epoch": 10}
{"loss": 0.31467580795288086, "acc": 0.8814941644668579, "length": 10.668402671813965, "mode": "test", "epoch": 10}
{"loss": 0.22037601470947266, "acc": 0.9222779870033264, "length": 10.405357360839844, "mode": "train", "epoch": 11}
{"loss": 0.2628435492515564, "acc": 0.9007893800735474, "length": 13.072916984558105, "mode": "test", "epoch": 11}
{"loss": 0.202511265873909, "acc": 0.930173397064209, "length": 11.094826698303223, "mode": "train", "epoch": 12}
{"loss": 0.2425101101398468, "acc": 0.912999153137207, "length": 13.09548568725586, "mode": "test", "epoch": 12}
{"loss": 0.18815138936042786, "acc": 0.9368273615837097, "length": 11.306096076965332, "mode": "train", "epoch": 13}
{"loss": 0.26944461464881897, "acc": 0.9111355543136597, "length": 13.09201431274414, "mode": "test", "epoch": 13}
{"loss": 0.18595726788043976, "acc": 0.9383169412612915, "length": 11.46607494354248, "mode": "train", "epoch": 14}
{"loss": 0.2384772002696991, "acc": 0.9162299036979675, "length": 13.90625, "mode": "test", "epoch": 14}
{"loss": 0.17174012959003448, "acc": 0.9431772232055664, "length": 11.419034004211426, "mode": "train", "epoch": 15}
{"loss": 0.22638705372810364, "acc": 0.9233182072639465, "length": 13.729166984558105, "mode": "test", "epoch": 15}
{"loss": 0.1691100150346756, "acc": 0.9431380033493042, "length": 11.391030311584473, "mode": "train", "epoch": 16}
{"loss": 0.20916177332401276, "acc": 0.9298664927482605, "length": 13.25, "mode": "test", "epoch": 16}
{"loss": 0.1528182476758957, "acc": 0.9507694840431213, "length": 11.696123123168945, "mode": "train", "epoch": 17}
{"loss": 0.20105063915252686, "acc": 0.9292318820953369, "length": 12.66319465637207, "mode": "test", "epoch": 17}
{"loss": 0.14614787697792053, "acc": 0.9533435106277466, "length": 11.643766403198242, "mode": "train", "epoch": 18}
{"loss": 0.19509060680866241, "acc": 0.933436393737793, "length": 12.53298568725586, "mode": "test", "epoch": 18}
{"loss": 0.13480688631534576, "acc": 0.9596511125564575, "length": 11.598344802856445, "mode": "train", "epoch": 19}
{"loss": 0.18770836293697357, "acc": 0.9379097819328308, "length": 12.24305534362793, "mode": "test", "epoch": 19}
{"loss": 0.13132193684577942, "acc": 0.9601813554763794, "length": 12.597308158874512, "mode": "train", "epoch": 20}
{"loss": 0.17333795130252838, "acc": 0.9413982033729553, "length": 12.802083015441895, "mode": "test", "epoch": 20}
{"loss": 0.12382180243730545, "acc": 0.9626353979110718, "length": 12.810845375061035, "mode": "train", "epoch": 21}
{"loss": 0.18083681166172028, "acc": 0.9424832463264465, "length": 12.58506965637207, "mode": "test", "epoch": 21}
{"loss": 0.11848380416631699, "acc": 0.9646487236022949, "length": 13.194353103637695, "mode": "train", "epoch": 22}
{"loss": 0.17597876489162445, "acc": 0.9437254667282104, "length": 14.505208015441895, "mode": "test", "epoch": 22}
{"loss": 0.1062370166182518, "acc": 0.9695688486099243, "length": 12.9782075881958, "mode": "train", "epoch": 23}
{"loss": 0.1741245985031128, "acc": 0.9455973505973816, "length": 13.572916984558105, "mode": "test", "epoch": 23}
{"loss": 0.10064013302326202, "acc": 0.9718920588493347, "length": 13.515095710754395, "mode": "train", "epoch": 24}
{"loss": 0.1951131373643875, "acc": 0.9307590126991272, "length": 14.50868034362793, "mode": "test", "epoch": 24}
{"loss": 0.09964727610349655, "acc": 0.9722868204116821, "length": 13.583348274230957, "mode": "train", "epoch": 25}
{"loss": 0.1654774695634842, "acc": 0.9456787109375, "length": 14.817708015441895, "mode": "test", "epoch": 25}
{"loss": 0.1019761711359024, "acc": 0.9710912704467773, "length": 12.851309776306152, "mode": "train", "epoch": 26}
{"loss": 0.14393150806427002, "acc": 0.9541367292404175, "length": 12.12673568725586, "mode": "test", "epoch": 26}
{"loss": 0.09024996310472488, "acc": 0.9767947793006897, "length": 12.498750686645508, "mode": "train", "epoch": 27}
{"loss": 0.13275985419750214, "acc": 0.9551650285720825, "length": 12.19618034362793, "mode": "test", "epoch": 27}
{"loss": 0.07783232629299164, "acc": 0.9794740676879883, "length": 13.135688781738281, "mode": "train", "epoch": 28}
{"loss": 0.13824626803398132, "acc": 0.954427182674408, "length": 12.831597328186035, "mode": "test", "epoch": 28}
{"loss": 0.07614324986934662, "acc": 0.9796145558357239, "length": 13.010168075561523, "mode": "train", "epoch": 29}
{"loss": 0.1358156055212021, "acc": 0.9560953974723816, "length": 12.432291984558105, "mode": "test", "epoch": 29}
{"loss": 0.06982909142971039, "acc": 0.9823700189590454, "length": 13.367135047912598, "mode": "train", "epoch": 30}
{"loss": 0.10842511057853699, "acc": 0.9662976861000061, "length": 12.958333015441895, "mode": "test", "epoch": 30}
{"loss": 0.06229584664106369, "acc": 0.9838776588439941, "length": 13.08565616607666, "mode": "train", "epoch": 31}
{"loss": 0.10069036483764648, "acc": 0.9725124835968018, "length": 12.875, "mode": "test", "epoch": 31}
{"loss": 0.05880541726946831, "acc": 0.9850925803184509, "length": 14.01179313659668, "mode": "train", "epoch": 32}
{"loss": 0.12017222493886948, "acc": 0.961878776550293, "length": 15.09375, "mode": "test", "epoch": 32}
{"loss": 0.05888098478317261, "acc": 0.9846104383468628, "length": 13.667724609375, "mode": "train", "epoch": 33}
{"loss": 0.10499488562345505, "acc": 0.9712049961090088, "length": 11.229166984558105, "mode": "test", "epoch": 33}
{"loss": 0.05043699964880943, "acc": 0.9877074956893921, "length": 12.886738777160645, "mode": "train", "epoch": 34}
{"loss": 0.10215078294277191, "acc": 0.9720975160598755, "length": 12.31423568725586, "mode": "test", "epoch": 34}
{"loss": 0.046112608164548874, "acc": 0.989168643951416, "length": 12.799715995788574, "mode": "train", "epoch": 35}
{"loss": 0.102201446890831, "acc": 0.9739285707473755, "length": 12.41319465637207, "mode": "test", "epoch": 35}
{"loss": 0.04495652765035629, "acc": 0.9901745915412903, "length": 13.501380920410156, "mode": "train", "epoch": 36}
{"loss": 0.09775932878255844, "acc": 0.9729953408241272, "length": 12.130208015441895, "mode": "test", "epoch": 36}
{"loss": 0.061802688986063004, "acc": 0.9830160140991211, "length": 13.517293930053711, "mode": "train", "epoch": 37}
{"loss": 0.13261131942272186, "acc": 0.9585123062133789, "length": 12.807291984558105, "mode": "test", "epoch": 37}
{"loss": 0.05400900915265083, "acc": 0.9863811135292053, "length": 12.289998054504395, "mode": "train", "epoch": 38}
{"loss": 0.10138115286827087, "acc": 0.9727131724357605, "length": 12.309027671813965, "mode": "test", "epoch": 38}
{"loss": 0.04141470044851303, "acc": 0.9911209344863892, "length": 11.90886402130127, "mode": "train", "epoch": 39}
{"loss": 0.07466711848974228, "acc": 0.9816271662712097, "length": 11.315972328186035, "mode": "test", "epoch": 39}
{"loss": 0.04453132301568985, "acc": 0.9902948141098022, "length": 12.820144653320312, "mode": "train", "epoch": 40}
{"loss": 0.07886140048503876, "acc": 0.9770209193229675, "length": 12.807291984558105, "mode": "test", "epoch": 40}
{"loss": 0.031398918479681015, "acc": 0.9952940344810486, "length": 12.642474174499512, "mode": "train", "epoch": 41}
{"loss": 0.06951907277107239, "acc": 0.9822808504104614, "length": 11.322916984558105, "mode": "test", "epoch": 41}
{"loss": 0.03001296892762184, "acc": 0.9957709312438965, "length": 12.204141616821289, "mode": "train", "epoch": 42}
{"loss": 0.0674106776714325, "acc": 0.9840195775032043, "length": 11.95138931274414, "mode": "test", "epoch": 42}
{"loss": 0.03253252059221268, "acc": 0.9945854544639587, "length": 12.843719482421875, "mode": "train", "epoch": 43}
{"loss": 0.06416472792625427, "acc": 0.983119010925293, "length": 11.614583015441895, "mode": "test", "epoch": 43}
{"loss": 0.02518843114376068, "acc": 0.9967165589332581, "length": 12.06691837310791, "mode": "train", "epoch": 44}
{"loss": 0.06195875629782677, "acc": 0.9860649108886719, "length": 11.331597328186035, "mode": "test", "epoch": 44}
{"loss": 0.040995191782712936, "acc": 0.9915099740028381, "length": 12.62697696685791, "mode": "train", "epoch": 45}
{"loss": 0.09667817503213882, "acc": 0.970057487487793, "length": 12.786458015441895, "mode": "test", "epoch": 45}
{"loss": 0.03664848580956459, "acc": 0.9921778440475464, "length": 13.246905326843262, "mode": "train", "epoch": 46}
{"loss": 0.06789758801460266, "acc": 0.9829834699630737, "length": 12.17361068725586, "mode": "test", "epoch": 46}
{"loss": 0.026632755994796753, "acc": 0.9962440729141235, "length": 12.381941795349121, "mode": "train", "epoch": 47}
{"loss": 0.060159701853990555, "acc": 0.9878717064857483, "length": 10.902777671813965, "mode": "test", "epoch": 47}
{"loss": 0.025115279480814934, "acc": 0.9963648915290833, "length": 11.687273025512695, "mode": "train", "epoch": 48}
{"loss": 0.07329649478197098, "acc": 0.9828179478645325, "length": 11.33680534362793, "mode": "test", "epoch": 48}
{"loss": 0.025105467066168785, "acc": 0.9965524077415466, "length": 12.750081062316895, "mode": "train", "epoch": 49}
{"loss": 0.061805229634046555, "acc": 0.9857910871505737, "length": 12.255208015441895, "mode": "test", "epoch": 49}
{"loss": 0.024485601112246513, "acc": 0.9962520003318787, "length": 12.153191566467285, "mode": "train", "epoch": 50}
{"loss": 0.04646798595786095, "acc": 0.9912598133087158, "length": 11.27256965637207, "mode": "test", "epoch": 50}
{"loss": 0.027292950078845024, "acc": 0.9951775670051575, "length": 11.988999366760254, "mode": "train", "epoch": 51}
{"loss": 0.07762265205383301, "acc": 0.9768473505973816, "length": 12.208333015441895, "mode": "test", "epoch": 51}
{"loss": 0.024802392348647118, "acc": 0.9964450597763062, "length": 12.276968955993652, "mode": "train", "epoch": 52}
{"loss": 0.047066669911146164, "acc": 0.98828125, "length": 11.802083015441895, "mode": "test", "epoch": 52}
{"loss": 0.025659671053290367, "acc": 0.9957537055015564, "length": 12.059525489807129, "mode": "train", "epoch": 53}
{"loss": 0.06248584762215614, "acc": 0.9864745736122131, "length": 11.380208015441895, "mode": "test", "epoch": 53}
{"loss": 0.04372195526957512, "acc": 0.9895964860916138, "length": 11.962766647338867, "mode": "train", "epoch": 54}
{"loss": 0.06049152836203575, "acc": 0.9854763746261597, "length": 11.770833015441895, "mode": "test", "epoch": 54}
{"loss": 0.021579870954155922, "acc": 0.9975355863571167, "length": 11.417802810668945, "mode": "train", "epoch": 55}
{"loss": 0.042998865246772766, "acc": 0.9914333820343018, "length": 10.45138931274414, "mode": "test", "epoch": 55}
{"loss": 0.017262769863009453, "acc": 0.9983981847763062, "length": 10.85493278503418, "mode": "train", "epoch": 56}
{"loss": 0.047780245542526245, "acc": 0.9914008378982544, "length": 10.3125, "mode": "test", "epoch": 56}
{"loss": 0.019267920404672623, "acc": 0.9979739189147949, "length": 10.943594932556152, "mode": "train", "epoch": 57}
{"loss": 0.04193226620554924, "acc": 0.9922987818717957, "length": 10.371527671813965, "mode": "test", "epoch": 57}
{"loss": 0.015763964504003525, "acc": 0.9989103674888611, "length": 10.688517570495605, "mode": "train", "epoch": 58}
{"loss": 0.03968299925327301, "acc": 0.9929279685020447, "length": 9.86805534362793, "mode": "test", "epoch": 58}
{"loss": 0.01384938694536686, "acc": 0.999363362789154, "length": 10.352880477905273, "mode": "train", "epoch": 59}
{"loss": 0.03836728632450104, "acc": 0.9934624433517456, "length": 9.762152671813965, "mode": "test", "epoch": 59}
{"loss": 0.01660713367164135, "acc": 0.9980855584144592, "length": 10.437392234802246, "mode": "train", "epoch": 60}
{"loss": 0.046937741339206696, "acc": 0.9906522035598755, "length": 9.6875, "mode": "test", "epoch": 60}
test accuracy: 0.7770082354545593
