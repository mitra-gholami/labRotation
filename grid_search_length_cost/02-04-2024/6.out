ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.6971853971481323, "acc": 0.516633152961731, "length": 2.898897886276245, "mode": "train", "epoch": 1}
{"loss": 0.6770095229148865, "acc": 0.5892360210418701, "length": 1.4375, "mode": "test", "epoch": 1}
{"loss": 0.6211007237434387, "acc": 0.6557074785232544, "length": 3.033496379852295, "mode": "train", "epoch": 2}
{"loss": 0.5786147117614746, "acc": 0.7143527269363403, "length": 3.4826388359069824, "mode": "test", "epoch": 2}
{"loss": 0.513769805431366, "acc": 0.7501720786094666, "length": 3.792344331741333, "mode": "train", "epoch": 3}
{"loss": 0.4959675967693329, "acc": 0.7767496109008789, "length": 4.637152671813965, "mode": "test", "epoch": 3}
{"loss": 0.43526262044906616, "acc": 0.8075594902038574, "length": 4.6400146484375, "mode": "train", "epoch": 4}
{"loss": 0.511897623538971, "acc": 0.7917805910110474, "length": 5.07118034362793, "mode": "test", "epoch": 4}
{"loss": 0.3941328525543213, "acc": 0.8319376111030579, "length": 4.962343692779541, "mode": "train", "epoch": 5}
{"loss": 0.5174296498298645, "acc": 0.7742105722427368, "length": 5.565972328186035, "mode": "test", "epoch": 5}
{"loss": 0.36019930243492126, "acc": 0.8484320640563965, "length": 5.11250638961792, "mode": "train", "epoch": 6}
{"loss": 0.500901460647583, "acc": 0.8176053166389465, "length": 5.86805534362793, "mode": "test", "epoch": 6}
{"loss": 0.33611372113227844, "acc": 0.8630688786506653, "length": 5.2895402908325195, "mode": "train", "epoch": 7}
{"loss": 0.43842169642448425, "acc": 0.8175429105758667, "length": 5.826388835906982, "mode": "test", "epoch": 7}
{"loss": 0.30748820304870605, "acc": 0.8747929930686951, "length": 5.4410247802734375, "mode": "train", "epoch": 8}
{"loss": 0.38922178745269775, "acc": 0.8323784470558167, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.27628183364868164, "acc": 0.8911157846450806, "length": 5.873981475830078, "mode": "train", "epoch": 9}
{"loss": 0.38695675134658813, "acc": 0.8390624523162842, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.25598809123039246, "acc": 0.9021958112716675, "length": 5.957447052001953, "mode": "train", "epoch": 10}
{"loss": 0.30427253246307373, "acc": 0.8881077170372009, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.24171122908592224, "acc": 0.9085420370101929, "length": 5.980045318603516, "mode": "train", "epoch": 11}
{"loss": 0.2842724323272705, "acc": 0.8965277075767517, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.22559228539466858, "acc": 0.9169945120811462, "length": 5.985960483551025, "mode": "train", "epoch": 12}
{"loss": 0.2672106623649597, "acc": 0.9019097089767456, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.2151719033718109, "acc": 0.9232246279716492, "length": 5.990498065948486, "mode": "train", "epoch": 13}
{"loss": 0.2706628739833832, "acc": 0.9010416865348816, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.20572593808174133, "acc": 0.9267449975013733, "length": 5.993114948272705, "mode": "train", "epoch": 14}
{"loss": 0.24426038563251495, "acc": 0.9171874523162842, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.1996314823627472, "acc": 0.9286183714866638, "length": 5.9937262535095215, "mode": "train", "epoch": 15}
{"loss": 0.2727423310279846, "acc": 0.9011284708976746, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.1865927278995514, "acc": 0.933799147605896, "length": 5.994961261749268, "mode": "train", "epoch": 16}
{"loss": 0.2504819333553314, "acc": 0.9146702289581299, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.17718182504177094, "acc": 0.9377163648605347, "length": 5.996123790740967, "mode": "train", "epoch": 17}
{"loss": 0.20792943239212036, "acc": 0.9278646111488342, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.168373703956604, "acc": 0.9435267448425293, "length": 5.9964423179626465, "mode": "train", "epoch": 18}
{"loss": 0.2077975571155548, "acc": 0.9228298664093018, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.16756658256053925, "acc": 0.9403877854347229, "length": 5.997496128082275, "mode": "train", "epoch": 19}
{"loss": 0.22402964532375336, "acc": 0.9204860329627991, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.15896065533161163, "acc": 0.9446002840995789, "length": 5.997458457946777, "mode": "train", "epoch": 20}
{"loss": 0.20152126252651215, "acc": 0.9205729365348816, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.15137560665607452, "acc": 0.9480957984924316, "length": 5.997981548309326, "mode": "train", "epoch": 21}
{"loss": 0.20575837790966034, "acc": 0.9314236044883728, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.14736853539943695, "acc": 0.9504122138023376, "length": 5.99825382232666, "mode": "train", "epoch": 22}
{"loss": 0.19653910398483276, "acc": 0.9338541030883789, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.14384393393993378, "acc": 0.9516487717628479, "length": 5.998661518096924, "mode": "train", "epoch": 23}
{"loss": 0.180197075009346, "acc": 0.9398438334465027, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.13684000074863434, "acc": 0.9551359415054321, "length": 5.998714447021484, "mode": "train", "epoch": 24}
{"loss": 0.17543959617614746, "acc": 0.9486110210418701, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.12896709144115448, "acc": 0.959601104259491, "length": 5.998875141143799, "mode": "train", "epoch": 25}
{"loss": 0.15635426342487335, "acc": 0.9483506679534912, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.1304796189069748, "acc": 0.9582633376121521, "length": 5.998894691467285, "mode": "train", "epoch": 26}
{"loss": 0.15482009947299957, "acc": 0.9510416388511658, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.12364540249109268, "acc": 0.9602755904197693, "length": 5.99912166595459, "mode": "train", "epoch": 27}
{"loss": 0.1698470562696457, "acc": 0.9442709684371948, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.11905329674482346, "acc": 0.9621990323066711, "length": 5.999050617218018, "mode": "train", "epoch": 28}
{"loss": 0.1541634052991867, "acc": 0.9597222208976746, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.10892828553915024, "acc": 0.9680241942405701, "length": 5.9989237785339355, "mode": "train", "epoch": 29}
{"loss": 0.14407029747962952, "acc": 0.9617187976837158, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.10287372022867203, "acc": 0.9690955281257629, "length": 5.999335765838623, "mode": "train", "epoch": 30}
{"loss": 0.1334524303674698, "acc": 0.9601563215255737, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.09454243630170822, "acc": 0.9721366763114929, "length": 5.9993462562561035, "mode": "train", "epoch": 31}
{"loss": 0.13575425744056702, "acc": 0.9536459445953369, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.08676796406507492, "acc": 0.9758456945419312, "length": 5.999297142028809, "mode": "train", "epoch": 32}
{"loss": 0.13733315467834473, "acc": 0.9603297710418701, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.09053462743759155, "acc": 0.9721367955207825, "length": 5.99937105178833, "mode": "train", "epoch": 33}
{"loss": 0.11980301886796951, "acc": 0.9638020396232605, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.08288148790597916, "acc": 0.9757386445999146, "length": 5.999491214752197, "mode": "train", "epoch": 34}
{"loss": 0.09774794429540634, "acc": 0.9670138955116272, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.07506491243839264, "acc": 0.9787810444831848, "length": 5.999526500701904, "mode": "train", "epoch": 35}
{"loss": 0.11771057546138763, "acc": 0.9669271111488342, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.0747600570321083, "acc": 0.97828209400177, "length": 5.999642372131348, "mode": "train", "epoch": 36}
{"loss": 0.11214026808738708, "acc": 0.9664061665534973, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.06990306824445724, "acc": 0.9815731048583984, "length": 5.999593257904053, "mode": "train", "epoch": 37}
{"loss": 0.10458258539438248, "acc": 0.9685763120651245, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.06648273020982742, "acc": 0.9817437529563904, "length": 5.999721527099609, "mode": "train", "epoch": 38}
{"loss": 0.10744588822126389, "acc": 0.9685763120651245, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.07048813253641129, "acc": 0.9789499044418335, "length": 5.9996442794799805, "mode": "train", "epoch": 39}
{"loss": 0.1136261522769928, "acc": 0.9666666388511658, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.0697665736079216, "acc": 0.980180561542511, "length": 5.9997148513793945, "mode": "train", "epoch": 40}
{"loss": 0.0901055559515953, "acc": 0.972569465637207, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.0587240569293499, "acc": 0.9842843413352966, "length": 5.99977970123291, "mode": "train", "epoch": 41}
{"loss": 0.09352134168148041, "acc": 0.9697049260139465, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.05374547839164734, "acc": 0.9863203167915344, "length": 5.9997687339782715, "mode": "train", "epoch": 42}
{"loss": 0.07772604376077652, "acc": 0.9792532324790955, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.05202193930745125, "acc": 0.9883856177330017, "length": 5.999793529510498, "mode": "train", "epoch": 43}
{"loss": 0.08834622800350189, "acc": 0.9707464575767517, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.051872335374355316, "acc": 0.9866289496421814, "length": 5.999810218811035, "mode": "train", "epoch": 44}
{"loss": 0.07592833787202835, "acc": 0.9749131798744202, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.044347506016492844, "acc": 0.9905633330345154, "length": 5.9998345375061035, "mode": "train", "epoch": 45}
{"loss": 0.08155204355716705, "acc": 0.9789929986000061, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.04236842319369316, "acc": 0.9912880659103394, "length": 5.9998273849487305, "mode": "train", "epoch": 46}
{"loss": 0.07547738403081894, "acc": 0.9822048544883728, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.0344717763364315, "acc": 0.994723379611969, "length": 5.999908447265625, "mode": "train", "epoch": 47}
{"loss": 0.06352681666612625, "acc": 0.9824652075767517, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.03444201499223709, "acc": 0.9940537810325623, "length": 5.99990701675415, "mode": "train", "epoch": 48}
{"loss": 0.062054507434368134, "acc": 0.9822916388511658, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.03367363288998604, "acc": 0.9941378235816956, "length": 5.999922752380371, "mode": "train", "epoch": 49}
{"loss": 0.060260526835918427, "acc": 0.9837672710418701, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.030824357643723488, "acc": 0.9956445693969727, "length": 5.999917030334473, "mode": "train", "epoch": 50}
{"loss": 0.06858804076910019, "acc": 0.9834200739860535, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.03199898824095726, "acc": 0.9947239756584167, "length": 5.9999284744262695, "mode": "train", "epoch": 51}
{"loss": 0.07184704393148422, "acc": 0.9835069179534912, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.03182919695973396, "acc": 0.994417667388916, "length": 5.999940395355225, "mode": "train", "epoch": 52}
{"loss": 0.0669170543551445, "acc": 0.9859374165534973, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.03191214054822922, "acc": 0.9945851564407349, "length": 5.999948978424072, "mode": "train", "epoch": 53}
{"loss": 0.09496452659368515, "acc": 0.9713541865348816, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.029593337327241898, "acc": 0.9957002997398376, "length": 5.9999284744262695, "mode": "train", "epoch": 54}
{"loss": 0.04817018657922745, "acc": 0.9906250834465027, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.02770833857357502, "acc": 0.9957558512687683, "length": 5.99992036819458, "mode": "train", "epoch": 55}
{"loss": 0.05776982754468918, "acc": 0.9866319298744202, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.03402767702937126, "acc": 0.9923807382583618, "length": 5.999941825866699, "mode": "train", "epoch": 56}
{"loss": 0.04979826882481575, "acc": 0.9880208969116211, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.1157337874174118, "acc": 0.9671577215194702, "length": 5.999942302703857, "mode": "train", "epoch": 57}
{"loss": 0.13049834966659546, "acc": 0.9585936665534973, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.09029608964920044, "acc": 0.9729868769645691, "length": 5.999874591827393, "mode": "train", "epoch": 58}
{"loss": 0.09808845818042755, "acc": 0.9691840410232544, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.04652978107333183, "acc": 0.9872184991836548, "length": 5.999936580657959, "mode": "train", "epoch": 59}
{"loss": 0.07728458195924759, "acc": 0.9789063334465027, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.03865421190857887, "acc": 0.9903444051742554, "length": 5.9999589920043945, "mode": "train", "epoch": 60}
{"loss": 0.0518156960606575, "acc": 0.9871528148651123, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.8455738425254822
