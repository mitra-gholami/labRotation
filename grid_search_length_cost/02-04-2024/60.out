ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.4853243827819824, "acc": 0.7347012162208557, "length": 2.169245958328247, "mode": "train", "epoch": 1}
{"loss": 0.379523366689682, "acc": 0.8323143124580383, "length": 3.0845870971679688, "mode": "test", "epoch": 1}
{"loss": 0.26268038153648376, "acc": 0.9076179265975952, "length": 3.426306962966919, "mode": "train", "epoch": 2}
{"loss": 0.3417298495769501, "acc": 0.853546679019928, "length": 3.570742607116699, "mode": "test", "epoch": 2}
{"loss": 0.2124248743057251, "acc": 0.9328822493553162, "length": 3.674558162689209, "mode": "train", "epoch": 3}
{"loss": 0.3029336631298065, "acc": 0.8824660778045654, "length": 3.669814348220825, "mode": "test", "epoch": 3}
{"loss": 0.18768632411956787, "acc": 0.9458346962928772, "length": 3.749786615371704, "mode": "train", "epoch": 4}
{"loss": 0.26960596442222595, "acc": 0.9019116759300232, "length": 3.7941741943359375, "mode": "test", "epoch": 4}
{"loss": 0.16474032402038574, "acc": 0.9561432600021362, "length": 3.8267982006073, "mode": "train", "epoch": 5}
{"loss": 0.2514515221118927, "acc": 0.9174138903617859, "length": 3.8424296379089355, "mode": "test", "epoch": 5}
{"loss": 0.1497533917427063, "acc": 0.9631377458572388, "length": 3.860383987426758, "mode": "train", "epoch": 6}
{"loss": 0.24545778334140778, "acc": 0.9238432049751282, "length": 3.8485915660858154, "mode": "test", "epoch": 6}
{"loss": 0.1422726809978485, "acc": 0.9665524959564209, "length": 3.8590080738067627, "mode": "train", "epoch": 7}
{"loss": 0.25633031129837036, "acc": 0.918839156627655, "length": 3.861715793609619, "mode": "test", "epoch": 7}
{"loss": 0.13911165297031403, "acc": 0.9674966335296631, "length": 3.873154640197754, "mode": "train", "epoch": 8}
{"loss": 0.26967427134513855, "acc": 0.9104028940200806, "length": 3.876600503921509, "mode": "test", "epoch": 8}
{"loss": 0.12668128311634064, "acc": 0.9712282419204712, "length": 3.870349168777466, "mode": "train", "epoch": 9}
{"loss": 0.25840505957603455, "acc": 0.9231598377227783, "length": 3.8557538986206055, "mode": "test", "epoch": 9}
{"loss": 0.11839761584997177, "acc": 0.973817765712738, "length": 3.867035388946533, "mode": "train", "epoch": 10}
{"loss": 0.25638654828071594, "acc": 0.9181849360466003, "length": 3.892885684967041, "mode": "test", "epoch": 10}
{"loss": 0.11193566769361496, "acc": 0.9749677777290344, "length": 3.8796584606170654, "mode": "train", "epoch": 11}
{"loss": 0.28471195697784424, "acc": 0.9069940447807312, "length": 3.8824424743652344, "mode": "test", "epoch": 11}
{"loss": 0.10178617388010025, "acc": 0.977166473865509, "length": 3.8871138095855713, "mode": "train", "epoch": 12}
{"loss": 0.27927276492118835, "acc": 0.9066491723060608, "length": 3.911451578140259, "mode": "test", "epoch": 12}
{"loss": 0.08804888278245926, "acc": 0.9804418087005615, "length": 3.9029295444488525, "mode": "train", "epoch": 13}
{"loss": 0.27083060145378113, "acc": 0.9110418558120728, "length": 3.9103312492370605, "mode": "test", "epoch": 13}
{"loss": 0.07770222425460815, "acc": 0.984227180480957, "length": 3.9115521907806396, "mode": "train", "epoch": 14}
{"loss": 0.27497753500938416, "acc": 0.9170616865158081, "length": 3.9283370971679688, "mode": "test", "epoch": 14}
{"loss": 0.07429979741573334, "acc": 0.9853785634040833, "length": 3.9020941257476807, "mode": "train", "epoch": 15}
{"loss": 0.269758015871048, "acc": 0.9162644743919373, "length": 3.9494638442993164, "mode": "test", "epoch": 15}
{"loss": 0.06756675243377686, "acc": 0.9876327514648438, "length": 3.9067232608795166, "mode": "train", "epoch": 16}
{"loss": 0.2833666205406189, "acc": 0.9153504371643066, "length": 3.9503841400146484, "mode": "test", "epoch": 16}
{"loss": 0.06225508451461792, "acc": 0.9878966212272644, "length": 3.913662910461426, "mode": "train", "epoch": 17}
{"loss": 0.3285732567310333, "acc": 0.8942887783050537, "length": 3.8922054767608643, "mode": "test", "epoch": 17}
{"loss": 0.0561056025326252, "acc": 0.9894030094146729, "length": 3.9123754501342773, "mode": "train", "epoch": 18}
{"loss": 0.2835370600223541, "acc": 0.9105039238929749, "length": 3.8774807453155518, "mode": "test", "epoch": 18}
{"loss": 0.05119423568248749, "acc": 0.9912829995155334, "length": 3.9166393280029297, "mode": "train", "epoch": 19}
{"loss": 0.30930590629577637, "acc": 0.8993048071861267, "length": 3.916213274002075, "mode": "test", "epoch": 19}
{"loss": 0.048095013946294785, "acc": 0.992143452167511, "length": 3.925724506378174, "mode": "train", "epoch": 20}
{"loss": 0.27981844544410706, "acc": 0.9125028848648071, "length": 3.9541053771972656, "mode": "test", "epoch": 20}
{"loss": 0.047905463725328445, "acc": 0.9923179149627686, "length": 3.9311928749084473, "mode": "train", "epoch": 21}
{"loss": 0.31695178151130676, "acc": 0.9078347086906433, "length": 3.9592669010162354, "mode": "test", "epoch": 21}
{"loss": 0.04632149636745453, "acc": 0.9927924275398254, "length": 3.921637773513794, "mode": "train", "epoch": 22}
{"loss": 0.2958982586860657, "acc": 0.9095205068588257, "length": 3.9513444900512695, "mode": "test", "epoch": 22}
{"loss": 0.04429992288351059, "acc": 0.9935488700866699, "length": 3.933689832687378, "mode": "train", "epoch": 23}
{"loss": 0.28919219970703125, "acc": 0.9241514801979065, "length": 3.9118518829345703, "mode": "test", "epoch": 23}
{"loss": 0.04629679024219513, "acc": 0.992968738079071, "length": 3.93066668510437, "mode": "train", "epoch": 24}
{"loss": 0.2938438057899475, "acc": 0.9245854020118713, "length": 3.955465793609619, "mode": "test", "epoch": 24}
{"loss": 0.04241911321878433, "acc": 0.9941471219062805, "length": 3.934598207473755, "mode": "train", "epoch": 25}
{"loss": 0.3946191370487213, "acc": 0.9016823172569275, "length": 3.9738717079162598, "mode": "test", "epoch": 25}
{"loss": 0.042126160115003586, "acc": 0.9941422343254089, "length": 3.9496617317199707, "mode": "train", "epoch": 26}
{"loss": 0.3600442707538605, "acc": 0.8995062112808228, "length": 3.9815940856933594, "mode": "test", "epoch": 26}
{"loss": 0.04179898649454117, "acc": 0.9942649006843567, "length": 3.9488110542297363, "mode": "train", "epoch": 27}
{"loss": 0.2954496145248413, "acc": 0.9205907583236694, "length": 3.974271774291992, "mode": "test", "epoch": 27}
{"loss": 0.041903965175151825, "acc": 0.994352400302887, "length": 3.9479289054870605, "mode": "train", "epoch": 28}
{"loss": 0.2972365915775299, "acc": 0.9190456867218018, "length": 3.968950033187866, "mode": "test", "epoch": 28}
{"loss": 0.04175522178411484, "acc": 0.9943493008613586, "length": 3.9437637329101562, "mode": "train", "epoch": 29}
{"loss": 0.3202410042285919, "acc": 0.9125325679779053, "length": 3.958106517791748, "mode": "test", "epoch": 29}
{"loss": 0.03909347951412201, "acc": 0.9951640963554382, "length": 3.9448013305664062, "mode": "train", "epoch": 30}
{"loss": 0.26177090406417847, "acc": 0.928458571434021, "length": 3.9700703620910645, "mode": "test", "epoch": 30}
{"loss": 0.04134223237633705, "acc": 0.9943327307701111, "length": 3.952629327774048, "mode": "train", "epoch": 31}
{"loss": 0.3251194357872009, "acc": 0.9177322387695312, "length": 3.977792978286743, "mode": "test", "epoch": 31}
{"loss": 0.04066143557429314, "acc": 0.9946897029876709, "length": 3.9568631649017334, "mode": "train", "epoch": 32}
{"loss": 0.2826622426509857, "acc": 0.9253494739532471, "length": 3.9744317531585693, "mode": "test", "epoch": 32}
{"loss": 0.03984980657696724, "acc": 0.99478679895401, "length": 3.966623306274414, "mode": "train", "epoch": 33}
{"loss": 0.30971717834472656, "acc": 0.9166490435600281, "length": 3.973311424255371, "mode": "test", "epoch": 33}
{"loss": 0.03911447152495384, "acc": 0.9950243234634399, "length": 3.956413984298706, "mode": "train", "epoch": 34}
{"loss": 0.2885659635066986, "acc": 0.9220917224884033, "length": 3.9737515449523926, "mode": "test", "epoch": 34}
{"loss": 0.039781711995601654, "acc": 0.9949555397033691, "length": 3.9557530879974365, "mode": "train", "epoch": 35}
{"loss": 0.30142515897750854, "acc": 0.9269481897354126, "length": 3.9729113578796387, "mode": "test", "epoch": 35}
{"loss": 0.040920618921518326, "acc": 0.9946693181991577, "length": 3.967538833618164, "mode": "train", "epoch": 36}
{"loss": 0.2566266357898712, "acc": 0.9381997585296631, "length": 3.9817540645599365, "mode": "test", "epoch": 36}
{"loss": 0.04009474813938141, "acc": 0.9947969317436218, "length": 3.9599015712738037, "mode": "train", "epoch": 37}
{"loss": 0.31261351704597473, "acc": 0.916562020778656, "length": 3.9752321243286133, "mode": "test", "epoch": 37}
{"loss": 0.03861726447939873, "acc": 0.9952632784843445, "length": 3.9663212299346924, "mode": "train", "epoch": 38}
{"loss": 0.289377361536026, "acc": 0.9211998581886292, "length": 3.9798736572265625, "mode": "test", "epoch": 38}
{"loss": 0.03756655752658844, "acc": 0.9954971075057983, "length": 3.97123122215271, "mode": "train", "epoch": 39}
{"loss": 0.24366921186447144, "acc": 0.943730890750885, "length": 3.984955072402954, "mode": "test", "epoch": 39}
{"loss": 0.039393797516822815, "acc": 0.9951947331428528, "length": 3.969834089279175, "mode": "train", "epoch": 40}
{"loss": 0.26573070883750916, "acc": 0.9301067590713501, "length": 3.9915173053741455, "mode": "test", "epoch": 40}
{"loss": 0.036699265241622925, "acc": 0.9959040880203247, "length": 3.9779067039489746, "mode": "train", "epoch": 41}
{"loss": 0.2754225432872772, "acc": 0.9371247887611389, "length": 3.987596035003662, "mode": "test", "epoch": 41}
{"loss": 0.037864215672016144, "acc": 0.9955033659934998, "length": 3.974931001663208, "mode": "train", "epoch": 42}
{"loss": 0.2651587128639221, "acc": 0.9309674501419067, "length": 3.9877960681915283, "mode": "test", "epoch": 42}
{"loss": 0.0382753349840641, "acc": 0.9954983592033386, "length": 3.975726366043091, "mode": "train", "epoch": 43}
{"loss": 0.24470070004463196, "acc": 0.9412146806716919, "length": 3.9833946228027344, "mode": "test", "epoch": 43}
{"loss": 0.03733905032277107, "acc": 0.9956756830215454, "length": 3.9845597743988037, "mode": "train", "epoch": 44}
{"loss": 0.2547597587108612, "acc": 0.940872073173523, "length": 3.9931979179382324, "mode": "test", "epoch": 44}
{"loss": 0.036576755344867706, "acc": 0.9959564208984375, "length": 3.9817097187042236, "mode": "train", "epoch": 45}
{"loss": 0.25626498460769653, "acc": 0.9357420802116394, "length": 3.976792573928833, "mode": "test", "epoch": 45}
{"loss": 0.03804498538374901, "acc": 0.9957103729248047, "length": 3.980600118637085, "mode": "train", "epoch": 46}
{"loss": 0.25598564743995667, "acc": 0.9368642568588257, "length": 3.993717908859253, "mode": "test", "epoch": 46}
{"loss": 0.03708428516983986, "acc": 0.9957889914512634, "length": 3.9893224239349365, "mode": "train", "epoch": 47}
{"loss": 0.2173108160495758, "acc": 0.9459700584411621, "length": 3.9977993965148926, "mode": "test", "epoch": 47}
{"loss": 0.03547358512878418, "acc": 0.9963458776473999, "length": 3.9846646785736084, "mode": "train", "epoch": 48}
{"loss": 0.22629407048225403, "acc": 0.9433922171592712, "length": 3.997199058532715, "mode": "test", "epoch": 48}
{"loss": 0.035747505724430084, "acc": 0.9962443113327026, "length": 3.99155330657959, "mode": "train", "epoch": 49}
{"loss": 0.21810483932495117, "acc": 0.95062255859375, "length": 3.9995999336242676, "mode": "test", "epoch": 49}
{"loss": 0.036780454218387604, "acc": 0.9959414005279541, "length": 3.9881181716918945, "mode": "train", "epoch": 50}
{"loss": 0.2952415943145752, "acc": 0.9256921410560608, "length": 3.9932377338409424, "mode": "test", "epoch": 50}
{"loss": 0.03553823381662369, "acc": 0.996295690536499, "length": 3.995509624481201, "mode": "train", "epoch": 51}
{"loss": 0.23501528799533844, "acc": 0.9378219842910767, "length": 3.999919891357422, "mode": "test", "epoch": 51}
{"loss": 0.036592062562704086, "acc": 0.9959582686424255, "length": 3.9945173263549805, "mode": "train", "epoch": 52}
{"loss": 0.22722139954566956, "acc": 0.9502960443496704, "length": 3.999799966812134, "mode": "test", "epoch": 52}
{"loss": 0.03482374548912048, "acc": 0.99644535779953, "length": 3.996469020843506, "mode": "train", "epoch": 53}
{"loss": 0.23847661912441254, "acc": 0.9384915828704834, "length": 3.999880075454712, "mode": "test", "epoch": 53}
{"loss": 0.03726011887192726, "acc": 0.995842456817627, "length": 3.995932102203369, "mode": "train", "epoch": 54}
{"loss": 0.23070892691612244, "acc": 0.9392305612564087, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.03698047623038292, "acc": 0.9959923624992371, "length": 3.9989025592803955, "mode": "train", "epoch": 55}
{"loss": 0.21926821768283844, "acc": 0.95032799243927, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.03544937074184418, "acc": 0.9964916110038757, "length": 3.9997949600219727, "mode": "train", "epoch": 56}
{"loss": 0.21893532574176788, "acc": 0.9480533599853516, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.039218585938215256, "acc": 0.9953509569168091, "length": 3.9998273849487305, "mode": "train", "epoch": 57}
{"loss": 0.23950381577014923, "acc": 0.9435819387435913, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.03644319996237755, "acc": 0.9961438179016113, "length": 3.9999547004699707, "mode": "train", "epoch": 58}
{"loss": 0.2129739373922348, "acc": 0.9549636244773865, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.037184927612543106, "acc": 0.996042788028717, "length": 3.999966621398926, "mode": "train", "epoch": 59}
{"loss": 0.22373096644878387, "acc": 0.9473630785942078, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.03832927718758583, "acc": 0.995608389377594, "length": 3.999990940093994, "mode": "train", "epoch": 60}
{"loss": 0.22379347681999207, "acc": 0.9455325603485107, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9424200057983398
