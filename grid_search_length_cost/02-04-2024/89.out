ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.32193902134895325, "acc": 0.861880898475647, "length": 10.759597778320312, "mode": "train", "epoch": 1}
{"loss": 0.29415884613990784, "acc": 0.8835349082946777, "length": 12.149670600891113, "mode": "test", "epoch": 1}
{"loss": 0.16885465383529663, "acc": 0.9487312436103821, "length": 11.915281295776367, "mode": "train", "epoch": 2}
{"loss": 0.21792128682136536, "acc": 0.9254756569862366, "length": 11.71120834350586, "mode": "test", "epoch": 2}
{"loss": 0.1271561235189438, "acc": 0.9668200612068176, "length": 11.94943904876709, "mode": "train", "epoch": 3}
{"loss": 0.17689962685108185, "acc": 0.9467325806617737, "length": 11.162066459655762, "mode": "test", "epoch": 3}
{"loss": 0.09431720525026321, "acc": 0.9770815968513489, "length": 12.026226043701172, "mode": "train", "epoch": 4}
{"loss": 0.17711830139160156, "acc": 0.9472095966339111, "length": 13.293084144592285, "mode": "test", "epoch": 4}
{"loss": 0.07412613928318024, "acc": 0.9841411709785461, "length": 12.329612731933594, "mode": "train", "epoch": 5}
{"loss": 0.14124111831188202, "acc": 0.9607137441635132, "length": 13.111842155456543, "mode": "test", "epoch": 5}
{"loss": 0.06494196504354477, "acc": 0.9869664311408997, "length": 11.400629997253418, "mode": "train", "epoch": 6}
{"loss": 0.11052802950143814, "acc": 0.9708313345909119, "length": 10.8279447555542, "mode": "test", "epoch": 6}
{"loss": 0.059558119624853134, "acc": 0.9884587526321411, "length": 11.299750328063965, "mode": "train", "epoch": 7}
{"loss": 0.13956524431705475, "acc": 0.958533763885498, "length": 9.903762817382812, "mode": "test", "epoch": 7}
{"loss": 0.04141513630747795, "acc": 0.9915121793746948, "length": 11.258525848388672, "mode": "train", "epoch": 8}
{"loss": 0.10011973232030869, "acc": 0.9699797630310059, "length": 11.265885353088379, "mode": "test", "epoch": 8}
{"loss": 0.02228744886815548, "acc": 0.9967817068099976, "length": 11.387153625488281, "mode": "train", "epoch": 9}
{"loss": 0.07664740830659866, "acc": 0.9791516661643982, "length": 11.939545631408691, "mode": "test", "epoch": 9}
{"loss": 0.01902194693684578, "acc": 0.997408926486969, "length": 10.811495780944824, "mode": "train", "epoch": 10}
{"loss": 0.05251334607601166, "acc": 0.9868879318237305, "length": 10.464177131652832, "mode": "test", "epoch": 10}
{"loss": 0.016468873247504234, "acc": 0.9978158473968506, "length": 10.180618286132812, "mode": "train", "epoch": 11}
{"loss": 0.09723570942878723, "acc": 0.9705134630203247, "length": 10.567152976989746, "mode": "test", "epoch": 11}
{"loss": 0.015439865179359913, "acc": 0.9980080723762512, "length": 10.416679382324219, "mode": "train", "epoch": 12}
{"loss": 0.040562551468610764, "acc": 0.9906985759735107, "length": 11.377206802368164, "mode": "test", "epoch": 12}
{"loss": 0.015197833999991417, "acc": 0.9979543089866638, "length": 9.890304565429688, "mode": "train", "epoch": 13}
{"loss": 0.07034465670585632, "acc": 0.979680061340332, "length": 9.341262817382812, "mode": "test", "epoch": 13}
{"loss": 0.012788948602974415, "acc": 0.9985178112983704, "length": 9.643068313598633, "mode": "train", "epoch": 14}
{"loss": 0.03301159664988518, "acc": 0.9937614798545837, "length": 10.875882148742676, "mode": "test", "epoch": 14}
{"loss": 0.01187262125313282, "acc": 0.9987365007400513, "length": 9.862922668457031, "mode": "train", "epoch": 15}
{"loss": 0.02350221760571003, "acc": 0.9949684739112854, "length": 9.350930213928223, "mode": "test", "epoch": 15}
{"loss": 0.012261117808520794, "acc": 0.9986194372177124, "length": 9.705921173095703, "mode": "train", "epoch": 16}
{"loss": 0.083431676030159, "acc": 0.9770932197570801, "length": 10.034459114074707, "mode": "test", "epoch": 16}
{"loss": 0.011067611165344715, "acc": 0.9987980723381042, "length": 9.50529956817627, "mode": "train", "epoch": 17}
{"loss": 0.022252216935157776, "acc": 0.9955936670303345, "length": 9.638559341430664, "mode": "test", "epoch": 17}
{"loss": 0.012047119438648224, "acc": 0.9985319972038269, "length": 9.591779708862305, "mode": "train", "epoch": 18}
{"loss": 0.026942623779177666, "acc": 0.9950183033943176, "length": 10.044568061828613, "mode": "test", "epoch": 18}
{"loss": 0.011362508870661259, "acc": 0.9988300800323486, "length": 10.477261543273926, "mode": "train", "epoch": 19}
{"loss": 0.018057527020573616, "acc": 0.9969893097877502, "length": 10.582597732543945, "mode": "test", "epoch": 19}
{"loss": 0.009586608037352562, "acc": 0.999204158782959, "length": 9.897042274475098, "mode": "train", "epoch": 20}
{"loss": 0.01411042083054781, "acc": 0.9983052611351013, "length": 9.266928672790527, "mode": "test", "epoch": 20}
{"loss": 0.011109143495559692, "acc": 0.9986920356750488, "length": 9.097952842712402, "mode": "train", "epoch": 21}
{"loss": 0.03359239920973778, "acc": 0.994383692741394, "length": 9.049823760986328, "mode": "test", "epoch": 21}
{"loss": 0.010588529519736767, "acc": 0.9988512396812439, "length": 9.647017478942871, "mode": "train", "epoch": 22}
{"loss": 0.02986556850373745, "acc": 0.9933124780654907, "length": 9.824975967407227, "mode": "test", "epoch": 22}
{"loss": 0.01049342006444931, "acc": 0.998915433883667, "length": 9.774955749511719, "mode": "train", "epoch": 23}
{"loss": 0.01884271390736103, "acc": 0.9975163340568542, "length": 9.261713981628418, "mode": "test", "epoch": 23}
{"loss": 0.009371696971356869, "acc": 0.9991344809532166, "length": 9.062812805175781, "mode": "train", "epoch": 24}
{"loss": 0.017831813544034958, "acc": 0.9966806173324585, "length": 9.16551685333252, "mode": "test", "epoch": 24}
{"loss": 0.009050569497048855, "acc": 0.9991724491119385, "length": 9.16541576385498, "mode": "train", "epoch": 25}
{"loss": 0.01031185407191515, "acc": 0.9989432096481323, "length": 9.114209175109863, "mode": "test", "epoch": 25}
{"loss": 0.008840923197567463, "acc": 0.99919593334198, "length": 8.953916549682617, "mode": "train", "epoch": 26}
{"loss": 0.014318306930363178, "acc": 0.9981729984283447, "length": 8.918806076049805, "mode": "test", "epoch": 26}
{"loss": 0.009993046522140503, "acc": 0.9989629983901978, "length": 9.231821060180664, "mode": "train", "epoch": 27}
{"loss": 0.015133775770664215, "acc": 0.9975243806838989, "length": 8.855864524841309, "mode": "test", "epoch": 27}
{"loss": 0.008799757808446884, "acc": 0.9991529583930969, "length": 8.952203750610352, "mode": "train", "epoch": 28}
{"loss": 0.018237166106700897, "acc": 0.9972496032714844, "length": 9.472721099853516, "mode": "test", "epoch": 28}
{"loss": 0.01023060828447342, "acc": 0.9988735914230347, "length": 9.29813003540039, "mode": "train", "epoch": 29}
{"loss": 0.015875881537795067, "acc": 0.997277021408081, "length": 9.370867729187012, "mode": "test", "epoch": 29}
{"loss": 0.008572430349886417, "acc": 0.9992566704750061, "length": 8.900275230407715, "mode": "train", "epoch": 30}
{"loss": 0.017773283645510674, "acc": 0.9976505637168884, "length": 8.673298835754395, "mode": "test", "epoch": 30}
{"loss": 0.008530033752322197, "acc": 0.9992042779922485, "length": 8.798368453979492, "mode": "train", "epoch": 31}
{"loss": 0.014728412963449955, "acc": 0.998127281665802, "length": 8.696927070617676, "mode": "test", "epoch": 31}
{"loss": 0.009176403284072876, "acc": 0.999081552028656, "length": 8.977079391479492, "mode": "train", "epoch": 32}
{"loss": 0.01319708488881588, "acc": 0.9985531568527222, "length": 8.861641883850098, "mode": "test", "epoch": 32}
{"loss": 0.007754676975309849, "acc": 0.9994004368782043, "length": 8.994600296020508, "mode": "train", "epoch": 33}
{"loss": 0.011790027841925621, "acc": 0.9986060857772827, "length": 8.717144966125488, "mode": "test", "epoch": 33}
{"loss": 0.009195102378726006, "acc": 0.9989359974861145, "length": 8.430135726928711, "mode": "train", "epoch": 34}
{"loss": 0.023737948387861252, "acc": 0.9954364895820618, "length": 8.676629066467285, "mode": "test", "epoch": 34}
{"loss": 0.009653231129050255, "acc": 0.998877763748169, "length": 8.89065170288086, "mode": "train", "epoch": 35}
{"loss": 0.010748665779829025, "acc": 0.9987518787384033, "length": 9.224004745483398, "mode": "test", "epoch": 35}
{"loss": 0.011833801865577698, "acc": 0.9984940886497498, "length": 9.316307067871094, "mode": "train", "epoch": 36}
{"loss": 0.012402499094605446, "acc": 0.9986915588378906, "length": 10.334724426269531, "mode": "test", "epoch": 36}
{"loss": 0.011593622155487537, "acc": 0.9985862374305725, "length": 10.11446475982666, "mode": "train", "epoch": 37}
{"loss": 0.023794103413820267, "acc": 0.9960798621177673, "length": 12.10983657836914, "mode": "test", "epoch": 37}
{"loss": 0.012166261672973633, "acc": 0.99863201379776, "length": 11.688385963439941, "mode": "train", "epoch": 38}
{"loss": 0.017537672072649002, "acc": 0.9978176951408386, "length": 12.661946296691895, "mode": "test", "epoch": 38}
{"loss": 0.013567492365837097, "acc": 0.9984129071235657, "length": 12.088732719421387, "mode": "train", "epoch": 39}
{"loss": 0.01724005863070488, "acc": 0.997776985168457, "length": 12.194319725036621, "mode": "test", "epoch": 39}
{"loss": 0.009621396660804749, "acc": 0.9992172122001648, "length": 11.2979097366333, "mode": "train", "epoch": 40}
{"loss": 0.010479011572897434, "acc": 0.999100387096405, "length": 11.798820495605469, "mode": "test", "epoch": 40}
{"loss": 0.015874607488512993, "acc": 0.9978291988372803, "length": 12.712693214416504, "mode": "train", "epoch": 41}
{"loss": 0.013624929822981358, "acc": 0.9985279440879822, "length": 12.825898170471191, "mode": "test", "epoch": 41}
{"loss": 0.010435232892632484, "acc": 0.9989767074584961, "length": 11.521547317504883, "mode": "train", "epoch": 42}
{"loss": 0.018405457958579063, "acc": 0.9975849986076355, "length": 10.495948791503906, "mode": "test", "epoch": 42}
{"loss": 0.009207076393067837, "acc": 0.9991485476493835, "length": 10.3344087600708, "mode": "train", "epoch": 43}
{"loss": 0.01181624736636877, "acc": 0.9989020824432373, "length": 9.9220552444458, "mode": "test", "epoch": 43}
{"loss": 0.009665963239967823, "acc": 0.9990572333335876, "length": 9.958224296569824, "mode": "train", "epoch": 44}
{"loss": 0.013067170046269894, "acc": 0.9982681274414062, "length": 10.505335807800293, "mode": "test", "epoch": 44}
{"loss": 0.010567759163677692, "acc": 0.9989317059516907, "length": 10.813375473022461, "mode": "train", "epoch": 45}
{"loss": 0.011223412118852139, "acc": 0.9990365505218506, "length": 10.285822868347168, "mode": "test", "epoch": 45}
{"loss": 0.009186265990138054, "acc": 0.9992346167564392, "length": 10.270608901977539, "mode": "train", "epoch": 46}
{"loss": 0.012452619150280952, "acc": 0.9987688660621643, "length": 9.591142654418945, "mode": "test", "epoch": 46}
{"loss": 0.01253306120634079, "acc": 0.9983917474746704, "length": 10.515746116638184, "mode": "train", "epoch": 47}
{"loss": 0.030453670769929886, "acc": 0.9938350319862366, "length": 15.117258071899414, "mode": "test", "epoch": 47}
{"loss": 0.012229295447468758, "acc": 0.9985673427581787, "length": 11.7763671875, "mode": "train", "epoch": 48}
{"loss": 0.011471930891275406, "acc": 0.9989424347877502, "length": 11.115412712097168, "mode": "test", "epoch": 48}
{"loss": 0.03267131745815277, "acc": 0.9933252930641174, "length": 14.748994827270508, "mode": "train", "epoch": 49}
{"loss": 0.19138570129871368, "acc": 0.9420178532600403, "length": 30.87740707397461, "mode": "test", "epoch": 49}
{"loss": 0.15145504474639893, "acc": 0.9543027281761169, "length": 30.941770553588867, "mode": "train", "epoch": 50}
{"loss": 0.14253130555152893, "acc": 0.956180214881897, "length": 30.99823570251465, "mode": "test", "epoch": 50}
{"loss": 0.10443227738142014, "acc": 0.9699733257293701, "length": 30.992708206176758, "mode": "train", "epoch": 51}
{"loss": 0.14530788362026215, "acc": 0.9548279643058777, "length": 31.0, "mode": "test", "epoch": 51}
{"loss": 0.14065153896808624, "acc": 0.9563155770301819, "length": 30.997663497924805, "mode": "train", "epoch": 52}
{"loss": 0.16203321516513824, "acc": 0.9484066963195801, "length": 30.998916625976562, "mode": "test", "epoch": 52}
{"loss": 0.14355000853538513, "acc": 0.955323338508606, "length": 30.999217987060547, "mode": "train", "epoch": 53}
{"loss": 0.19955362379550934, "acc": 0.9309859871864319, "length": 30.998876571655273, "mode": "test", "epoch": 53}
{"loss": 0.18523016571998596, "acc": 0.9369909167289734, "length": 30.999685287475586, "mode": "train", "epoch": 54}
{"loss": 0.23956657946109772, "acc": 0.913795530796051, "length": 31.0, "mode": "test", "epoch": 54}
{"loss": 0.2658851444721222, "acc": 0.8944444060325623, "length": 30.99982261657715, "mode": "train", "epoch": 55}
{"loss": 0.389590859413147, "acc": 0.8292362689971924, "length": 31.0, "mode": "test", "epoch": 55}
{"loss": 0.3107604384422302, "acc": 0.8722676038742065, "length": 30.99995994567871, "mode": "train", "epoch": 56}
{"loss": 0.3412429392337799, "acc": 0.8548639416694641, "length": 31.0, "mode": "test", "epoch": 56}
{"loss": 0.27360230684280396, "acc": 0.8919965028762817, "length": 30.999950408935547, "mode": "train", "epoch": 57}
{"loss": 0.3079778552055359, "acc": 0.873164713382721, "length": 31.0, "mode": "test", "epoch": 57}
{"loss": 0.24525965750217438, "acc": 0.9074766635894775, "length": 30.999982833862305, "mode": "train", "epoch": 58}
{"loss": 0.27793824672698975, "acc": 0.8944039344787598, "length": 31.0, "mode": "test", "epoch": 58}
{"loss": 0.24876455962657928, "acc": 0.9080756902694702, "length": 30.99998664855957, "mode": "train", "epoch": 59}
{"loss": 0.28764310479164124, "acc": 0.8906149864196777, "length": 31.0, "mode": "test", "epoch": 59}
{"loss": 0.25872740149497986, "acc": 0.9028348922729492, "length": 30.999996185302734, "mode": "train", "epoch": 60}
{"loss": 0.30174675583839417, "acc": 0.8793907165527344, "length": 31.0, "mode": "test", "epoch": 60}
test accuracy: 0.8632737994194031
