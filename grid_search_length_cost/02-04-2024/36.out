ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 5
{"loss": 0.39599642157554626, "acc": 0.8214197158813477, "length": 5.615180015563965, "mode": "train", "epoch": 1}
{"loss": 0.3300400972366333, "acc": 0.8743439316749573, "length": 6.0, "mode": "test", "epoch": 1}
{"loss": 0.24279367923736572, "acc": 0.9195461273193359, "length": 5.999959468841553, "mode": "train", "epoch": 2}
{"loss": 0.23736238479614258, "acc": 0.9229184985160828, "length": 6.0, "mode": "test", "epoch": 2}
{"loss": 0.20063459873199463, "acc": 0.9385393261909485, "length": 5.999993324279785, "mode": "train", "epoch": 3}
{"loss": 0.21895438432693481, "acc": 0.9303795695304871, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.18584781885147095, "acc": 0.9443445801734924, "length": 5.999998569488525, "mode": "train", "epoch": 4}
{"loss": 0.1896015703678131, "acc": 0.9446547031402588, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.16457997262477875, "acc": 0.9532859921455383, "length": 6.0, "mode": "train", "epoch": 5}
{"loss": 0.20055609941482544, "acc": 0.9389598369598389, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.1557459980249405, "acc": 0.956622838973999, "length": 6.0, "mode": "train", "epoch": 6}
{"loss": 0.17233100533485413, "acc": 0.9506775140762329, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.1425798535346985, "acc": 0.9615662097930908, "length": 6.0, "mode": "train", "epoch": 7}
{"loss": 0.1683059185743332, "acc": 0.9524276256561279, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.13306929171085358, "acc": 0.9648616909980774, "length": 6.0, "mode": "train", "epoch": 8}
{"loss": 0.16307570040225983, "acc": 0.9547216892242432, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.1272035539150238, "acc": 0.9668134450912476, "length": 6.0, "mode": "train", "epoch": 9}
{"loss": 0.14530368149280548, "acc": 0.9601733088493347, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.11705583333969116, "acc": 0.9700471758842468, "length": 6.0, "mode": "train", "epoch": 10}
{"loss": 0.13496051728725433, "acc": 0.9648013710975647, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.10998700559139252, "acc": 0.9727581739425659, "length": 6.0, "mode": "train", "epoch": 11}
{"loss": 0.12202868610620499, "acc": 0.9696636199951172, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.10547608137130737, "acc": 0.9745075106620789, "length": 6.0, "mode": "train", "epoch": 12}
{"loss": 0.12452381104230881, "acc": 0.9660612344741821, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.09925667196512222, "acc": 0.9761245250701904, "length": 6.0, "mode": "train", "epoch": 13}
{"loss": 0.12660005688667297, "acc": 0.9651203155517578, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.09549643099308014, "acc": 0.9775201082229614, "length": 6.0, "mode": "train", "epoch": 14}
{"loss": 0.11260145157575607, "acc": 0.9724192023277283, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.09151151776313782, "acc": 0.9786349534988403, "length": 6.0, "mode": "train", "epoch": 15}
{"loss": 0.1307796686887741, "acc": 0.9618691205978394, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.08950057625770569, "acc": 0.9792001843452454, "length": 6.0, "mode": "train", "epoch": 16}
{"loss": 0.11192364990711212, "acc": 0.971291184425354, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.08415310084819794, "acc": 0.9809266924858093, "length": 6.0, "mode": "train", "epoch": 17}
{"loss": 0.11595971137285233, "acc": 0.9692906737327576, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.08067406713962555, "acc": 0.9821341633796692, "length": 6.0, "mode": "train", "epoch": 18}
{"loss": 0.09957048296928406, "acc": 0.9754974246025085, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.07932313531637192, "acc": 0.9827234148979187, "length": 6.0, "mode": "train", "epoch": 19}
{"loss": 0.09951840341091156, "acc": 0.9753965735435486, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.07775555551052094, "acc": 0.9830910563468933, "length": 6.0, "mode": "train", "epoch": 20}
{"loss": 0.09680904448032379, "acc": 0.9768903851509094, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.07437804341316223, "acc": 0.9843237400054932, "length": 6.0, "mode": "train", "epoch": 21}
{"loss": 0.09638102352619171, "acc": 0.9771627187728882, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.07217521965503693, "acc": 0.9850487112998962, "length": 6.0, "mode": "train", "epoch": 22}
{"loss": 0.08822085708379745, "acc": 0.9806229472160339, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.07210305333137512, "acc": 0.9851905703544617, "length": 6.0, "mode": "train", "epoch": 23}
{"loss": 0.09529987722635269, "acc": 0.9772310853004456, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.06959958374500275, "acc": 0.9858428835868835, "length": 6.0, "mode": "train", "epoch": 24}
{"loss": 0.09214361011981964, "acc": 0.9787106513977051, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.06837497651576996, "acc": 0.9862478375434875, "length": 6.0, "mode": "train", "epoch": 25}
{"loss": 0.08221230655908585, "acc": 0.9830809235572815, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.06903611123561859, "acc": 0.9860832095146179, "length": 6.0, "mode": "train", "epoch": 26}
{"loss": 0.07925960421562195, "acc": 0.9833495020866394, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.06833598017692566, "acc": 0.9863301515579224, "length": 6.0, "mode": "train", "epoch": 27}
{"loss": 0.08246827125549316, "acc": 0.9819888472557068, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.0671280026435852, "acc": 0.9867110252380371, "length": 6.0, "mode": "train", "epoch": 28}
{"loss": 0.07766666263341904, "acc": 0.9840380549430847, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.06662192940711975, "acc": 0.9869296550750732, "length": 6.0, "mode": "train", "epoch": 29}
{"loss": 0.07666179537773132, "acc": 0.9844345450401306, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.0684327557682991, "acc": 0.9862280488014221, "length": 6.0, "mode": "train", "epoch": 30}
{"loss": 0.07685405015945435, "acc": 0.9846453070640564, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.06657140702009201, "acc": 0.9867601990699768, "length": 6.0, "mode": "train", "epoch": 31}
{"loss": 0.07336410135030746, "acc": 0.9850867986679077, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.06579412519931793, "acc": 0.9870028495788574, "length": 6.0, "mode": "train", "epoch": 32}
{"loss": 0.08363395929336548, "acc": 0.9824358820915222, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.06559305638074875, "acc": 0.9870232939720154, "length": 6.0, "mode": "train", "epoch": 33}
{"loss": 0.07736333459615707, "acc": 0.9840055704116821, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.06592299789190292, "acc": 0.9868503212928772, "length": 6.0, "mode": "train", "epoch": 34}
{"loss": 0.07362277060747147, "acc": 0.9849319458007812, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.06383852660655975, "acc": 0.9874582886695862, "length": 6.0, "mode": "train", "epoch": 35}
{"loss": 0.07343344390392303, "acc": 0.9849337339401245, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.06358397006988525, "acc": 0.9873681664466858, "length": 6.0, "mode": "train", "epoch": 36}
{"loss": 0.07354369759559631, "acc": 0.9848706126213074, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.06369531899690628, "acc": 0.9872967600822449, "length": 6.0, "mode": "train", "epoch": 37}
{"loss": 0.0722554549574852, "acc": 0.984432578086853, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.062153205275535583, "acc": 0.9876132607460022, "length": 6.0, "mode": "train", "epoch": 38}
{"loss": 0.07094778120517731, "acc": 0.9857085347175598, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.06219407543540001, "acc": 0.9877549409866333, "length": 6.0, "mode": "train", "epoch": 39}
{"loss": 0.07414805144071579, "acc": 0.9843029975891113, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.0629226565361023, "acc": 0.9872192144393921, "length": 6.0, "mode": "train", "epoch": 40}
{"loss": 0.07445977628231049, "acc": 0.9850813150405884, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.05968182533979416, "acc": 0.9882547855377197, "length": 6.0, "mode": "train", "epoch": 41}
{"loss": 0.0682612881064415, "acc": 0.9869791865348816, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.06788552552461624, "acc": 0.9854200482368469, "length": 6.0, "mode": "train", "epoch": 42}
{"loss": 0.09577345103025436, "acc": 0.9767354726791382, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.06934727728366852, "acc": 0.9846973419189453, "length": 6.0, "mode": "train", "epoch": 43}
{"loss": 0.07803183794021606, "acc": 0.9824160933494568, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.0623638778924942, "acc": 0.9872534871101379, "length": 6.0, "mode": "train", "epoch": 44}
{"loss": 0.067347452044487, "acc": 0.9866908192634583, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.06151195988059044, "acc": 0.9873722791671753, "length": 6.0, "mode": "train", "epoch": 45}
{"loss": 0.07040248066186905, "acc": 0.9861196875572205, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.05926555395126343, "acc": 0.9881701469421387, "length": 6.0, "mode": "train", "epoch": 46}
{"loss": 0.06851138174533844, "acc": 0.9861356019973755, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.05828463286161423, "acc": 0.9883480072021484, "length": 6.0, "mode": "train", "epoch": 47}
{"loss": 0.06338869035243988, "acc": 0.9879180788993835, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.058988988399505615, "acc": 0.9880738854408264, "length": 6.0, "mode": "train", "epoch": 48}
{"loss": 0.0686558410525322, "acc": 0.98623126745224, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.05744154751300812, "acc": 0.9886261224746704, "length": 6.0, "mode": "train", "epoch": 49}
{"loss": 0.06724753230810165, "acc": 0.9861429333686829, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.05739319697022438, "acc": 0.9883929491043091, "length": 6.0, "mode": "train", "epoch": 50}
{"loss": 0.06399082392454147, "acc": 0.9871774315834045, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.056758224964141846, "acc": 0.9884740710258484, "length": 6.0, "mode": "train", "epoch": 51}
{"loss": 0.06683695316314697, "acc": 0.9867053031921387, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.05742896720767021, "acc": 0.988373875617981, "length": 6.0, "mode": "train", "epoch": 52}
{"loss": 0.06374797224998474, "acc": 0.987179160118103, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.05905506759881973, "acc": 0.9876883029937744, "length": 6.0, "mode": "train", "epoch": 53}
{"loss": 0.0710645243525505, "acc": 0.9849842190742493, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.056789569556713104, "acc": 0.9883238673210144, "length": 6.0, "mode": "train", "epoch": 54}
{"loss": 0.06454551964998245, "acc": 0.9871413707733154, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.05755132436752319, "acc": 0.9882469773292542, "length": 6.0, "mode": "train", "epoch": 55}
{"loss": 0.06985574960708618, "acc": 0.9856961369514465, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.05554916337132454, "acc": 0.9887839555740356, "length": 6.0, "mode": "train", "epoch": 56}
{"loss": 0.05978499725461006, "acc": 0.9883686304092407, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.055398598313331604, "acc": 0.9888195395469666, "length": 6.0, "mode": "train", "epoch": 57}
{"loss": 0.06290540099143982, "acc": 0.9868152141571045, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.05549296736717224, "acc": 0.9887311458587646, "length": 6.0, "mode": "train", "epoch": 58}
{"loss": 0.06316744536161423, "acc": 0.9873954057693481, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.053352538496255875, "acc": 0.9894075989723206, "length": 6.0, "mode": "train", "epoch": 59}
{"loss": 0.06384525448083878, "acc": 0.9870477318763733, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.053074102848768234, "acc": 0.9893048405647278, "length": 6.0, "mode": "train", "epoch": 60}
{"loss": 0.06074291095137596, "acc": 0.9878640174865723, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.9610273838043213
