ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.6958056092262268, "acc": 0.5245243310928345, "length": 3.964280843734741, "mode": "train", "epoch": 1}
{"loss": 0.6882072687149048, "acc": 0.5404106974601746, "length": 1.03125, "mode": "test", "epoch": 1}
{"loss": 0.6300497651100159, "acc": 0.639721691608429, "length": 3.2154622077941895, "mode": "train", "epoch": 2}
{"loss": 0.6405782103538513, "acc": 0.6405273675918579, "length": 1.5069444179534912, "mode": "test", "epoch": 2}
{"loss": 0.5658754706382751, "acc": 0.7091861367225647, "length": 3.604551315307617, "mode": "train", "epoch": 3}
{"loss": 0.6417496800422668, "acc": 0.7063910365104675, "length": 12.583333015441895, "mode": "test", "epoch": 3}
{"loss": 0.4827435314655304, "acc": 0.774932324886322, "length": 4.5863542556762695, "mode": "train", "epoch": 4}
{"loss": 0.5368025302886963, "acc": 0.7572781443595886, "length": 7.166666507720947, "mode": "test", "epoch": 4}
{"loss": 0.4023430049419403, "acc": 0.8293841481208801, "length": 5.731378078460693, "mode": "train", "epoch": 5}
{"loss": 0.457720547914505, "acc": 0.8095784783363342, "length": 5.637152671813965, "mode": "test", "epoch": 5}
{"loss": 0.34871241450309753, "acc": 0.8548542261123657, "length": 6.343024253845215, "mode": "train", "epoch": 6}
{"loss": 0.4536823630332947, "acc": 0.8206000328063965, "length": 6.123263835906982, "mode": "test", "epoch": 6}
{"loss": 0.30576202273368835, "acc": 0.8781746625900269, "length": 7.143266201019287, "mode": "train", "epoch": 7}
{"loss": 0.4370204210281372, "acc": 0.8136935234069824, "length": 7.706597328186035, "mode": "test", "epoch": 7}
{"loss": 0.25938689708709717, "acc": 0.9005429148674011, "length": 8.197901725769043, "mode": "train", "epoch": 8}
{"loss": 0.38687047362327576, "acc": 0.8288058638572693, "length": 7.979166507720947, "mode": "test", "epoch": 8}
{"loss": 0.23167921602725983, "acc": 0.9119178056716919, "length": 8.731471061706543, "mode": "train", "epoch": 9}
{"loss": 0.334663987159729, "acc": 0.8633436560630798, "length": 8.380208015441895, "mode": "test", "epoch": 9}
{"loss": 0.20735688507556915, "acc": 0.9251829385757446, "length": 8.64437484741211, "mode": "train", "epoch": 10}
{"loss": 0.2670350670814514, "acc": 0.9003744125366211, "length": 7.68055534362793, "mode": "test", "epoch": 10}
{"loss": 0.18763741850852966, "acc": 0.9336442947387695, "length": 9.079511642456055, "mode": "train", "epoch": 11}
{"loss": 0.24022068083286285, "acc": 0.9072591066360474, "length": 8.96180534362793, "mode": "test", "epoch": 11}
{"loss": 0.16885042190551758, "acc": 0.9433186650276184, "length": 9.161012649536133, "mode": "train", "epoch": 12}
{"loss": 0.23481382429599762, "acc": 0.9128010869026184, "length": 8.82118034362793, "mode": "test", "epoch": 12}
{"loss": 0.14933346211910248, "acc": 0.953392505645752, "length": 9.618301391601562, "mode": "train", "epoch": 13}
{"loss": 0.23362118005752563, "acc": 0.9188259840011597, "length": 8.322916984558105, "mode": "test", "epoch": 13}
{"loss": 0.14669892191886902, "acc": 0.9530773758888245, "length": 9.54057788848877, "mode": "train", "epoch": 14}
{"loss": 0.2087128907442093, "acc": 0.9303086400032043, "length": 9.23611068725586, "mode": "test", "epoch": 14}
{"loss": 0.12406700104475021, "acc": 0.9654273986816406, "length": 9.786300659179688, "mode": "train", "epoch": 15}
{"loss": 0.2153298705816269, "acc": 0.9214898347854614, "length": 9.565972328186035, "mode": "test", "epoch": 15}
{"loss": 0.1176302582025528, "acc": 0.9670542478561401, "length": 10.054810523986816, "mode": "train", "epoch": 16}
{"loss": 0.19613562524318695, "acc": 0.9328070878982544, "length": 9.119791984558105, "mode": "test", "epoch": 16}
{"loss": 0.11240854114294052, "acc": 0.969866156578064, "length": 10.25025749206543, "mode": "train", "epoch": 17}
{"loss": 0.203703373670578, "acc": 0.9331109523773193, "length": 9.050347328186035, "mode": "test", "epoch": 17}
{"loss": 0.10311309248209, "acc": 0.9731788635253906, "length": 10.250663757324219, "mode": "train", "epoch": 18}
{"loss": 0.18134066462516785, "acc": 0.9378390908241272, "length": 9.526041984558105, "mode": "test", "epoch": 18}
{"loss": 0.098506398499012, "acc": 0.9744873046875, "length": 9.9509916305542, "mode": "train", "epoch": 19}
{"loss": 0.18269236385822296, "acc": 0.9376112818717957, "length": 9.62326431274414, "mode": "test", "epoch": 19}
{"loss": 0.08977196365594864, "acc": 0.9783524870872498, "length": 10.190950393676758, "mode": "train", "epoch": 20}
{"loss": 0.18869343400001526, "acc": 0.9420844316482544, "length": 9.833333015441895, "mode": "test", "epoch": 20}
{"loss": 0.09006880223751068, "acc": 0.9779857993125916, "length": 10.036575317382812, "mode": "train", "epoch": 21}
{"loss": 0.17145293951034546, "acc": 0.9480060935020447, "length": 10.09201431274414, "mode": "test", "epoch": 21}
{"loss": 0.08229802548885345, "acc": 0.9790993928909302, "length": 9.377942085266113, "mode": "train", "epoch": 22}
{"loss": 0.1557961106300354, "acc": 0.9527994990348816, "length": 9.94444465637207, "mode": "test", "epoch": 22}
{"loss": 0.07820630073547363, "acc": 0.9804167151451111, "length": 10.174307823181152, "mode": "train", "epoch": 23}
{"loss": 0.1546819508075714, "acc": 0.9512939453125, "length": 11.083333015441895, "mode": "test", "epoch": 23}
{"loss": 0.07260408252477646, "acc": 0.9829626679420471, "length": 10.948518753051758, "mode": "train", "epoch": 24}
{"loss": 0.1342494934797287, "acc": 0.9586426615715027, "length": 10.91319465637207, "mode": "test", "epoch": 24}
{"loss": 0.06471595913171768, "acc": 0.985161304473877, "length": 10.67017936706543, "mode": "train", "epoch": 25}
{"loss": 0.15191605687141418, "acc": 0.9511528015136719, "length": 10.26388931274414, "mode": "test", "epoch": 25}
{"loss": 0.05893956497311592, "acc": 0.9870866537094116, "length": 10.787003517150879, "mode": "train", "epoch": 26}
{"loss": 0.12060148268938065, "acc": 0.9628716707229614, "length": 9.916666984558105, "mode": "test", "epoch": 26}
{"loss": 0.05205591395497322, "acc": 0.9902669191360474, "length": 10.245271682739258, "mode": "train", "epoch": 27}
{"loss": 0.12627913057804108, "acc": 0.9587781429290771, "length": 10.145833015441895, "mode": "test", "epoch": 27}
{"loss": 0.045878857374191284, "acc": 0.9917163848876953, "length": 10.381657600402832, "mode": "train", "epoch": 28}
{"loss": 0.11108474433422089, "acc": 0.9653782248497009, "length": 9.833333015441895, "mode": "test", "epoch": 28}
{"loss": 0.03939342498779297, "acc": 0.9951006174087524, "length": 9.973028182983398, "mode": "train", "epoch": 29}
{"loss": 0.09006275981664658, "acc": 0.9746554493904114, "length": 9.76388931274414, "mode": "test", "epoch": 29}
{"loss": 0.04152563959360123, "acc": 0.9934515357017517, "length": 10.01884937286377, "mode": "train", "epoch": 30}
{"loss": 0.0901828184723854, "acc": 0.9748100638389587, "length": 10.309027671813965, "mode": "test", "epoch": 30}
{"loss": 0.03955863043665886, "acc": 0.9944599270820618, "length": 10.021960258483887, "mode": "train", "epoch": 31}
{"loss": 0.11561255902051926, "acc": 0.9652099609375, "length": 10.64930534362793, "mode": "test", "epoch": 31}
{"loss": 0.0676019936800003, "acc": 0.9820516705513, "length": 10.223320960998535, "mode": "train", "epoch": 32}
{"loss": 0.14136463403701782, "acc": 0.9552353620529175, "length": 8.84201431274414, "mode": "test", "epoch": 32}
{"loss": 0.05438214913010597, "acc": 0.9869126081466675, "length": 9.963247299194336, "mode": "train", "epoch": 33}
{"loss": 0.09805116057395935, "acc": 0.9729682207107544, "length": 9.784722328186035, "mode": "test", "epoch": 33}
{"loss": 0.0392090380191803, "acc": 0.9943172335624695, "length": 9.965479850769043, "mode": "train", "epoch": 34}
{"loss": 0.07883193343877792, "acc": 0.9807888865470886, "length": 9.33506965637207, "mode": "test", "epoch": 34}
{"loss": 0.030374500900506973, "acc": 0.9965500235557556, "length": 9.741279602050781, "mode": "train", "epoch": 35}
{"loss": 0.08011933416128159, "acc": 0.9766356945037842, "length": 8.940972328186035, "mode": "test", "epoch": 35}
{"loss": 0.027605202049016953, "acc": 0.9980863928794861, "length": 9.5965576171875, "mode": "train", "epoch": 36}
{"loss": 0.0754222720861435, "acc": 0.9771891832351685, "length": 9.13194465637207, "mode": "test", "epoch": 36}
{"loss": 0.027110109105706215, "acc": 0.9973575472831726, "length": 9.58692741394043, "mode": "train", "epoch": 37}
{"loss": 0.06028589978814125, "acc": 0.9851915836334229, "length": 9.286458015441895, "mode": "test", "epoch": 37}
{"loss": 0.04359012842178345, "acc": 0.9900392889976501, "length": 9.668238639831543, "mode": "train", "epoch": 38}
{"loss": 0.09378962963819504, "acc": 0.9736626744270325, "length": 8.902777671813965, "mode": "test", "epoch": 38}
{"loss": 0.031274158507585526, "acc": 0.9958478212356567, "length": 9.076951026916504, "mode": "train", "epoch": 39}
{"loss": 0.06953223049640656, "acc": 0.9823080897331238, "length": 9.088541984558105, "mode": "test", "epoch": 39}
{"loss": 0.024863282218575478, "acc": 0.9975553750991821, "length": 9.083413124084473, "mode": "train", "epoch": 40}
{"loss": 0.05021904781460762, "acc": 0.9884331822395325, "length": 8.89930534362793, "mode": "test", "epoch": 40}
{"loss": 0.024520093575119972, "acc": 0.9972847700119019, "length": 9.007360458374023, "mode": "train", "epoch": 41}
{"loss": 0.04276652634143829, "acc": 0.990147590637207, "length": 9.020833015441895, "mode": "test", "epoch": 41}
{"loss": 0.02522917091846466, "acc": 0.9970716238021851, "length": 9.273200035095215, "mode": "train", "epoch": 42}
{"loss": 0.0572873018682003, "acc": 0.9846571683883667, "length": 8.96875, "mode": "test", "epoch": 42}
{"loss": 0.0256950706243515, "acc": 0.9974761605262756, "length": 9.223576545715332, "mode": "train", "epoch": 43}
{"loss": 0.08179190754890442, "acc": 0.979736328125, "length": 9.68923568725586, "mode": "test", "epoch": 43}
{"loss": 0.028744222596287727, "acc": 0.9960497617721558, "length": 9.802614212036133, "mode": "train", "epoch": 44}
{"loss": 0.07378818839788437, "acc": 0.9826253056526184, "length": 8.527777671813965, "mode": "test", "epoch": 44}
{"loss": 0.028559794649481773, "acc": 0.9959645867347717, "length": 8.765101432800293, "mode": "train", "epoch": 45}
{"loss": 0.05947328358888626, "acc": 0.9814479351043701, "length": 8.77256965637207, "mode": "test", "epoch": 45}
{"loss": 0.024519944563508034, "acc": 0.9971046447753906, "length": 8.76426887512207, "mode": "train", "epoch": 46}
{"loss": 0.04727981612086296, "acc": 0.9882948398590088, "length": 8.362847328186035, "mode": "test", "epoch": 46}
{"loss": 0.01792077161371708, "acc": 0.9995457530021667, "length": 8.503983497619629, "mode": "train", "epoch": 47}
{"loss": 0.029866695404052734, "acc": 0.9955188035964966, "length": 7.954861164093018, "mode": "test", "epoch": 47}
{"loss": 0.019194496795535088, "acc": 0.9984450936317444, "length": 8.192712783813477, "mode": "train", "epoch": 48}
{"loss": 0.042773451656103134, "acc": 0.9901096820831299, "length": 8.262152671813965, "mode": "test", "epoch": 48}
{"loss": 0.019195156171917915, "acc": 0.9986159205436707, "length": 8.619588851928711, "mode": "train", "epoch": 49}
{"loss": 0.035837139934301376, "acc": 0.9905869960784912, "length": 8.494791984558105, "mode": "test", "epoch": 49}
{"loss": 0.01640642248094082, "acc": 0.9994324445724487, "length": 8.457871437072754, "mode": "train", "epoch": 50}
{"loss": 0.0323462076485157, "acc": 0.9944390058517456, "length": 7.942708492279053, "mode": "test", "epoch": 50}
{"loss": 0.017860082909464836, "acc": 0.9989231824874878, "length": 8.149984359741211, "mode": "train", "epoch": 51}
{"loss": 0.05548953637480736, "acc": 0.9879665374755859, "length": 9.12673568725586, "mode": "test", "epoch": 51}
{"loss": 0.027480406686663628, "acc": 0.9946395754814148, "length": 8.353283882141113, "mode": "train", "epoch": 52}
{"loss": 0.03580568730831146, "acc": 0.9929850101470947, "length": 8.05381965637207, "mode": "test", "epoch": 52}
{"loss": 0.02578338049352169, "acc": 0.9959936141967773, "length": 9.015591621398926, "mode": "train", "epoch": 53}
{"loss": 0.03938199579715729, "acc": 0.9933757781982422, "length": 8.369791984558105, "mode": "test", "epoch": 53}
{"loss": 0.01841120421886444, "acc": 0.9986383318901062, "length": 8.554291725158691, "mode": "train", "epoch": 54}
{"loss": 0.026773730292916298, "acc": 0.9971734285354614, "length": 8.401041984558105, "mode": "test", "epoch": 54}
{"loss": 0.01802569068968296, "acc": 0.9988700747489929, "length": 8.45687484741211, "mode": "train", "epoch": 55}
{"loss": 0.03851499781012535, "acc": 0.9910102486610413, "length": 8.161458015441895, "mode": "test", "epoch": 55}
{"loss": 0.021083487197756767, "acc": 0.9974080324172974, "length": 8.189791679382324, "mode": "train", "epoch": 56}
{"loss": 0.04559261351823807, "acc": 0.9895616173744202, "length": 8.28125, "mode": "test", "epoch": 56}
{"loss": 0.021685423329472542, "acc": 0.9969239830970764, "length": 8.332104682922363, "mode": "train", "epoch": 57}
{"loss": 0.040998056530952454, "acc": 0.9899982810020447, "length": 8.097222328186035, "mode": "test", "epoch": 57}
{"loss": 0.016150854527950287, "acc": 0.9991852045059204, "length": 8.313830375671387, "mode": "train", "epoch": 58}
{"loss": 0.03611195087432861, "acc": 0.9931396842002869, "length": 8.090277671813965, "mode": "test", "epoch": 58}
{"loss": 0.0162480678409338, "acc": 0.9988371729850769, "length": 7.943821907043457, "mode": "train", "epoch": 59}
{"loss": 0.020133445039391518, "acc": 0.9975016713142395, "length": 7.80381965637207, "mode": "test", "epoch": 59}
{"loss": 0.015331724658608437, "acc": 0.9990110397338867, "length": 7.736922264099121, "mode": "train", "epoch": 60}
{"loss": 0.025076238438487053, "acc": 0.9957058429718018, "length": 7.552083492279053, "mode": "test", "epoch": 60}
test accuracy: 0.8658913373947144
