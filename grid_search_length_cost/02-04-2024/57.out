ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 10
{"loss": 0.46732234954833984, "acc": 0.7684146165847778, "length": 2.0784223079681396, "mode": "train", "epoch": 1}
{"loss": 0.40202540159225464, "acc": 0.8169775009155273, "length": 2.290682554244995, "mode": "test", "epoch": 1}
{"loss": 0.3240211308002472, "acc": 0.872279167175293, "length": 2.791184425354004, "mode": "train", "epoch": 2}
{"loss": 0.2948698103427887, "acc": 0.8897477388381958, "length": 2.8238046169281006, "mode": "test", "epoch": 2}
{"loss": 0.2668290138244629, "acc": 0.9048975706100464, "length": 3.0655970573425293, "mode": "train", "epoch": 3}
{"loss": 0.2660011351108551, "acc": 0.9053695797920227, "length": 3.090221881866455, "mode": "test", "epoch": 3}
{"loss": 0.22770649194717407, "acc": 0.922492265701294, "length": 3.793449640274048, "mode": "train", "epoch": 4}
{"loss": 0.2415984869003296, "acc": 0.9147441983222961, "length": 4.111499309539795, "mode": "test", "epoch": 4}
{"loss": 0.18162207305431366, "acc": 0.9411928057670593, "length": 4.41640043258667, "mode": "train", "epoch": 5}
{"loss": 0.19752293825149536, "acc": 0.9346218109130859, "length": 4.636880874633789, "mode": "test", "epoch": 5}
{"loss": 0.1484200656414032, "acc": 0.9561045169830322, "length": 5.020519256591797, "mode": "train", "epoch": 6}
{"loss": 0.17030149698257446, "acc": 0.9478505253791809, "length": 5.111823081970215, "mode": "test", "epoch": 6}
{"loss": 0.12669019401073456, "acc": 0.9650751948356628, "length": 5.418410778045654, "mode": "train", "epoch": 7}
{"loss": 0.14791841804981232, "acc": 0.9585665464401245, "length": 5.222998142242432, "mode": "test", "epoch": 7}
{"loss": 0.1118083968758583, "acc": 0.9711742997169495, "length": 5.63763427734375, "mode": "train", "epoch": 8}
{"loss": 0.12768664956092834, "acc": 0.9653040170669556, "length": 5.317324161529541, "mode": "test", "epoch": 8}
{"loss": 0.10151363909244537, "acc": 0.9745484590530396, "length": 5.78622579574585, "mode": "train", "epoch": 9}
{"loss": 0.1154601126909256, "acc": 0.970855712890625, "length": 6.022429466247559, "mode": "test", "epoch": 9}
{"loss": 0.09167295694351196, "acc": 0.9779514074325562, "length": 5.896385669708252, "mode": "train", "epoch": 10}
{"loss": 0.110632985830307, "acc": 0.9725733995437622, "length": 5.826936721801758, "mode": "test", "epoch": 10}
{"loss": 0.08642616122961044, "acc": 0.9800105690956116, "length": 5.925541877746582, "mode": "train", "epoch": 11}
{"loss": 0.10216657817363739, "acc": 0.9756088852882385, "length": 5.659058094024658, "mode": "test", "epoch": 11}
{"loss": 0.08149685710668564, "acc": 0.9818342328071594, "length": 5.910588264465332, "mode": "train", "epoch": 12}
{"loss": 0.08970911055803299, "acc": 0.9795622229576111, "length": 5.831581115722656, "mode": "test", "epoch": 12}
{"loss": 0.07948458939790726, "acc": 0.9823607206344604, "length": 5.845694065093994, "mode": "train", "epoch": 13}
{"loss": 0.09029573202133179, "acc": 0.9790268540382385, "length": 5.77419376373291, "mode": "test", "epoch": 13}
{"loss": 0.07546180486679077, "acc": 0.9835832715034485, "length": 5.881743431091309, "mode": "train", "epoch": 14}
{"loss": 0.08810391277074814, "acc": 0.979698896408081, "length": 5.740819454193115, "mode": "test", "epoch": 14}
{"loss": 0.07384978979825974, "acc": 0.9840095639228821, "length": 5.8521270751953125, "mode": "train", "epoch": 15}
{"loss": 0.08145163208246231, "acc": 0.9827348589897156, "length": 5.712665557861328, "mode": "test", "epoch": 15}
{"loss": 0.07268824428319931, "acc": 0.9843912124633789, "length": 5.810882091522217, "mode": "train", "epoch": 16}
{"loss": 0.08192938566207886, "acc": 0.9825662970542908, "length": 5.741899490356445, "mode": "test", "epoch": 16}
{"loss": 0.06955210864543915, "acc": 0.98551344871521, "length": 5.743366241455078, "mode": "train", "epoch": 17}
{"loss": 0.07802850753068924, "acc": 0.9835083484649658, "length": 5.73621129989624, "mode": "test", "epoch": 17}
{"loss": 0.06895136833190918, "acc": 0.9856246113777161, "length": 5.801062107086182, "mode": "train", "epoch": 18}
{"loss": 0.07734217494726181, "acc": 0.9835872650146484, "length": 5.907438278198242, "mode": "test", "epoch": 18}
{"loss": 0.06799210608005524, "acc": 0.9859256744384766, "length": 5.920416831970215, "mode": "train", "epoch": 19}
{"loss": 0.07258644700050354, "acc": 0.9848023056983948, "length": 5.866395473480225, "mode": "test", "epoch": 19}
{"loss": 0.06734201312065125, "acc": 0.9860544800758362, "length": 5.845259189605713, "mode": "train", "epoch": 20}
{"loss": 0.07392385601997375, "acc": 0.9852083921432495, "length": 5.831401348114014, "mode": "test", "epoch": 20}
{"loss": 0.06529483944177628, "acc": 0.986458420753479, "length": 5.764810562133789, "mode": "train", "epoch": 21}
{"loss": 0.07186181843280792, "acc": 0.9854639172554016, "length": 5.942252159118652, "mode": "test", "epoch": 21}
{"loss": 0.06602345407009125, "acc": 0.9861587882041931, "length": 5.877383232116699, "mode": "train", "epoch": 22}
{"loss": 0.074380062520504, "acc": 0.9845651388168335, "length": 5.781394004821777, "mode": "test", "epoch": 22}
{"loss": 0.0643402636051178, "acc": 0.9866200685501099, "length": 5.762832164764404, "mode": "train", "epoch": 23}
{"loss": 0.06970234215259552, "acc": 0.9866002798080444, "length": 5.560735702514648, "mode": "test", "epoch": 23}
{"loss": 0.06278480589389801, "acc": 0.9869804382324219, "length": 5.726119041442871, "mode": "train", "epoch": 24}
{"loss": 0.06782316416501999, "acc": 0.9867298007011414, "length": 5.726202487945557, "mode": "test", "epoch": 24}
{"loss": 0.06226957589387894, "acc": 0.9870544075965881, "length": 5.697274684906006, "mode": "train", "epoch": 25}
{"loss": 0.06936906278133392, "acc": 0.9859781861305237, "length": 5.816532135009766, "mode": "test", "epoch": 25}
{"loss": 0.060395341366529465, "acc": 0.9874852299690247, "length": 5.734984874725342, "mode": "train", "epoch": 26}
{"loss": 0.06569264084100723, "acc": 0.9867390990257263, "length": 5.771061420440674, "mode": "test", "epoch": 26}
{"loss": 0.0603170208632946, "acc": 0.9873787760734558, "length": 5.777933597564697, "mode": "train", "epoch": 27}
{"loss": 0.06449558585882187, "acc": 0.9871610999107361, "length": 5.861139297485352, "mode": "test", "epoch": 27}
{"loss": 0.05892287567257881, "acc": 0.987699031829834, "length": 5.7888970375061035, "mode": "train", "epoch": 28}
{"loss": 0.06197841838002205, "acc": 0.9879010319709778, "length": 5.652973651885986, "mode": "test", "epoch": 28}
{"loss": 0.056843921542167664, "acc": 0.9881935715675354, "length": 5.7893290519714355, "mode": "train", "epoch": 29}
{"loss": 0.062389176338911057, "acc": 0.9874658584594727, "length": 5.793166637420654, "mode": "test", "epoch": 29}
{"loss": 0.0568779781460762, "acc": 0.988240659236908, "length": 5.819949150085449, "mode": "train", "epoch": 30}
{"loss": 0.06428130716085434, "acc": 0.9868761301040649, "length": 5.79611873626709, "mode": "test", "epoch": 30}
{"loss": 0.05541108921170235, "acc": 0.9885452389717102, "length": 5.781696319580078, "mode": "train", "epoch": 31}
{"loss": 0.05882785841822624, "acc": 0.9885453581809998, "length": 5.707877159118652, "mode": "test", "epoch": 31}
{"loss": 0.053144365549087524, "acc": 0.9891960620880127, "length": 5.8391923904418945, "mode": "train", "epoch": 32}
{"loss": 0.058288149535655975, "acc": 0.9887992739677429, "length": 5.746471881866455, "mode": "test", "epoch": 32}
{"loss": 0.05347521975636482, "acc": 0.9889872074127197, "length": 5.837345123291016, "mode": "train", "epoch": 33}
{"loss": 0.05964738875627518, "acc": 0.9882041215896606, "length": 6.0443549156188965, "mode": "test", "epoch": 33}
{"loss": 0.051848866045475006, "acc": 0.9894354939460754, "length": 5.889671802520752, "mode": "train", "epoch": 34}
{"loss": 0.05735395476222038, "acc": 0.9887984991073608, "length": 5.8334174156188965, "mode": "test", "epoch": 34}
{"loss": 0.051313795149326324, "acc": 0.9894673824310303, "length": 5.820581436157227, "mode": "train", "epoch": 35}
{"loss": 0.055845655500888824, "acc": 0.9887972474098206, "length": 5.65808629989624, "mode": "test", "epoch": 35}
{"loss": 0.04915842413902283, "acc": 0.9899599552154541, "length": 5.856258392333984, "mode": "train", "epoch": 36}
{"loss": 0.052754055708646774, "acc": 0.9894785284996033, "length": 5.794174671173096, "mode": "test", "epoch": 36}
{"loss": 0.04876112937927246, "acc": 0.9900391101837158, "length": 5.904796123504639, "mode": "train", "epoch": 37}
{"loss": 0.055904820561409, "acc": 0.9884517192840576, "length": 5.8467020988464355, "mode": "test", "epoch": 37}
{"loss": 0.047741442918777466, "acc": 0.9902206063270569, "length": 5.8471503257751465, "mode": "train", "epoch": 38}
{"loss": 0.053198959678411484, "acc": 0.9896882176399231, "length": 5.80393123626709, "mode": "test", "epoch": 38}
{"loss": 0.04671558365225792, "acc": 0.9905117750167847, "length": 5.897281169891357, "mode": "train", "epoch": 39}
{"loss": 0.05171744525432587, "acc": 0.9896833896636963, "length": 5.887456893920898, "mode": "test", "epoch": 39}
{"loss": 0.046192992478609085, "acc": 0.9905208945274353, "length": 5.878913402557373, "mode": "train", "epoch": 40}
{"loss": 0.052402105182409286, "acc": 0.9897271990776062, "length": 6.058467864990234, "mode": "test", "epoch": 40}
{"loss": 0.04508812725543976, "acc": 0.9907254576683044, "length": 5.880496978759766, "mode": "train", "epoch": 41}
{"loss": 0.04864373803138733, "acc": 0.9905545711517334, "length": 5.855594635009766, "mode": "test", "epoch": 41}
{"loss": 0.0454082116484642, "acc": 0.9905685782432556, "length": 5.925251007080078, "mode": "train", "epoch": 42}
{"loss": 0.04877559840679169, "acc": 0.990454912185669, "length": 5.829385280609131, "mode": "test", "epoch": 42}
{"loss": 0.04452010616660118, "acc": 0.9909217357635498, "length": 5.967431545257568, "mode": "train", "epoch": 43}
{"loss": 0.052094414830207825, "acc": 0.9891217947006226, "length": 5.987687110900879, "mode": "test", "epoch": 43}
{"loss": 0.043995849788188934, "acc": 0.9910405278205872, "length": 5.891174793243408, "mode": "train", "epoch": 44}
{"loss": 0.049691904336214066, "acc": 0.9896909594535828, "length": 5.861391067504883, "mode": "test", "epoch": 44}
{"loss": 0.04345962405204773, "acc": 0.9911394715309143, "length": 5.931596755981445, "mode": "train", "epoch": 45}
{"loss": 0.048969998955726624, "acc": 0.9903572201728821, "length": 5.978470802307129, "mode": "test", "epoch": 45}
{"loss": 0.04193253815174103, "acc": 0.9916471242904663, "length": 5.988117218017578, "mode": "train", "epoch": 46}
{"loss": 0.04557665437459946, "acc": 0.991472601890564, "length": 6.062824249267578, "mode": "test", "epoch": 46}
{"loss": 0.041592132300138474, "acc": 0.9917424321174622, "length": 5.95529317855835, "mode": "train", "epoch": 47}
{"loss": 0.047001589089632034, "acc": 0.9912008047103882, "length": 5.982142925262451, "mode": "test", "epoch": 47}
{"loss": 0.040256302803754807, "acc": 0.9921083450317383, "length": 5.930832386016846, "mode": "train", "epoch": 48}
{"loss": 0.045229196548461914, "acc": 0.9914222955703735, "length": 5.874819755554199, "mode": "test", "epoch": 48}
{"loss": 0.040080804377794266, "acc": 0.9921465516090393, "length": 5.896266937255859, "mode": "train", "epoch": 49}
{"loss": 0.04573646932840347, "acc": 0.9915263056755066, "length": 5.812067985534668, "mode": "test", "epoch": 49}
{"loss": 0.040407951921224594, "acc": 0.992015540599823, "length": 5.877536296844482, "mode": "train", "epoch": 50}
{"loss": 0.04422534629702568, "acc": 0.9915355443954468, "length": 5.849186420440674, "mode": "test", "epoch": 50}
{"loss": 0.040021106600761414, "acc": 0.9920947551727295, "length": 5.9120707511901855, "mode": "train", "epoch": 51}
{"loss": 0.04417530447244644, "acc": 0.9915573596954346, "length": 5.793670654296875, "mode": "test", "epoch": 51}
{"loss": 0.04026632755994797, "acc": 0.9921033382415771, "length": 5.996726989746094, "mode": "train", "epoch": 52}
{"loss": 0.04566555097699165, "acc": 0.9913235902786255, "length": 5.872659683227539, "mode": "test", "epoch": 52}
{"loss": 0.03956782817840576, "acc": 0.9923377633094788, "length": 5.890322208404541, "mode": "train", "epoch": 53}
{"loss": 0.04385458678007126, "acc": 0.9921603798866272, "length": 5.925943374633789, "mode": "test", "epoch": 53}
{"loss": 0.038189686834812164, "acc": 0.9926594495773315, "length": 5.888935089111328, "mode": "train", "epoch": 54}
{"loss": 0.04471881315112114, "acc": 0.99144047498703, "length": 5.839825630187988, "mode": "test", "epoch": 54}
{"loss": 0.038647137582302094, "acc": 0.9925004243850708, "length": 5.868036270141602, "mode": "train", "epoch": 55}
{"loss": 0.04431059956550598, "acc": 0.9918953776359558, "length": 5.835505485534668, "mode": "test", "epoch": 55}
{"loss": 0.03881724923849106, "acc": 0.9923555850982666, "length": 5.878468990325928, "mode": "train", "epoch": 56}
{"loss": 0.04422305151820183, "acc": 0.9919531345367432, "length": 5.941100120544434, "mode": "test", "epoch": 56}
{"loss": 0.037139132618904114, "acc": 0.9928525686264038, "length": 5.941897392272949, "mode": "train", "epoch": 57}
{"loss": 0.04397100582718849, "acc": 0.991722583770752, "length": 5.983942985534668, "mode": "test", "epoch": 57}
{"loss": 0.03715207427740097, "acc": 0.9928658604621887, "length": 5.930544376373291, "mode": "train", "epoch": 58}
{"loss": 0.042291104793548584, "acc": 0.9923272728919983, "length": 5.990711212158203, "mode": "test", "epoch": 58}
{"loss": 0.03685499727725983, "acc": 0.9928692579269409, "length": 5.910491466522217, "mode": "train", "epoch": 59}
{"loss": 0.04275386407971382, "acc": 0.9919715523719788, "length": 5.9225592613220215, "mode": "test", "epoch": 59}
{"loss": 0.038788050413131714, "acc": 0.9923670291900635, "length": 5.90000057220459, "mode": "train", "epoch": 60}
{"loss": 0.04475247114896774, "acc": 0.9912007451057434, "length": 5.871147632598877, "mode": "test", "epoch": 60}
test accuracy: 0.9649614691734314
