ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.4745815098285675, "acc": 0.7443996667861938, "length": 2.2619080543518066, "mode": "train", "epoch": 1}
{"loss": 0.38709113001823425, "acc": 0.8348252177238464, "length": 2.9559621810913086, "mode": "test", "epoch": 1}
{"loss": 0.2765142023563385, "acc": 0.9071481227874756, "length": 3.3192923069000244, "mode": "train", "epoch": 2}
{"loss": 0.32203978300094604, "acc": 0.88234543800354, "length": 3.270740032196045, "mode": "test", "epoch": 2}
{"loss": 0.2482355386018753, "acc": 0.9208614230155945, "length": 3.4098618030548096, "mode": "train", "epoch": 3}
{"loss": 0.3200053572654724, "acc": 0.8793744444847107, "length": 3.562220335006714, "mode": "test", "epoch": 3}
{"loss": 0.21754594147205353, "acc": 0.9323167204856873, "length": 3.8905441761016846, "mode": "train", "epoch": 4}
{"loss": 0.3033965229988098, "acc": 0.8903394937515259, "length": 3.9517662525177, "mode": "test", "epoch": 4}
{"loss": 0.1884167194366455, "acc": 0.9469007849693298, "length": 4.132411479949951, "mode": "train", "epoch": 5}
{"loss": 0.2925344407558441, "acc": 0.9038912653923035, "length": 4.1605658531188965, "mode": "test", "epoch": 5}
{"loss": 0.17741793394088745, "acc": 0.9503465294837952, "length": 4.134212017059326, "mode": "train", "epoch": 6}
{"loss": 0.28390151262283325, "acc": 0.9033767580986023, "length": 4.0459160804748535, "mode": "test", "epoch": 6}
{"loss": 0.17075587809085846, "acc": 0.9526562094688416, "length": 4.128001689910889, "mode": "train", "epoch": 7}
{"loss": 0.3033653497695923, "acc": 0.8935356140136719, "length": 4.064658164978027, "mode": "test", "epoch": 7}
{"loss": 0.16316932439804077, "acc": 0.9563013911247253, "length": 4.128021717071533, "mode": "train", "epoch": 8}
{"loss": 0.3064478039741516, "acc": 0.9031534194946289, "length": 4.116528034210205, "mode": "test", "epoch": 8}
{"loss": 0.1581307202577591, "acc": 0.9587303400039673, "length": 4.122178077697754, "mode": "train", "epoch": 9}
{"loss": 0.2746971845626831, "acc": 0.9141855239868164, "length": 4.030650615692139, "mode": "test", "epoch": 9}
{"loss": 0.15410993993282318, "acc": 0.9601417779922485, "length": 4.077651023864746, "mode": "train", "epoch": 10}
{"loss": 0.28207889199256897, "acc": 0.9126463532447815, "length": 4.043917655944824, "mode": "test", "epoch": 10}
{"loss": 0.1494038999080658, "acc": 0.961548388004303, "length": 4.07864236831665, "mode": "train", "epoch": 11}
{"loss": 0.30292943120002747, "acc": 0.8979109525680542, "length": 3.9953243732452393, "mode": "test", "epoch": 11}
{"loss": 0.1403292864561081, "acc": 0.9652851223945618, "length": 4.062304496765137, "mode": "train", "epoch": 12}
{"loss": 0.26298627257347107, "acc": 0.9162937998771667, "length": 4.07336950302124, "mode": "test", "epoch": 12}
{"loss": 0.1360464245080948, "acc": 0.9660630822181702, "length": 4.024068832397461, "mode": "train", "epoch": 13}
{"loss": 0.26380589604377747, "acc": 0.9183777570724487, "length": 4.011868476867676, "mode": "test", "epoch": 13}
{"loss": 0.12696442008018494, "acc": 0.9678397178649902, "length": 4.01607608795166, "mode": "train", "epoch": 14}
{"loss": 0.276242196559906, "acc": 0.9001666903495789, "length": 4.078284740447998, "mode": "test", "epoch": 14}
{"loss": 0.11455224454402924, "acc": 0.9717315435409546, "length": 4.043677806854248, "mode": "train", "epoch": 15}
{"loss": 0.3024047017097473, "acc": 0.8940068483352661, "length": 4.099823951721191, "mode": "test", "epoch": 15}
{"loss": 0.1039794385433197, "acc": 0.9760090708732605, "length": 4.0729756355285645, "mode": "train", "epoch": 16}
{"loss": 0.27765554189682007, "acc": 0.9117119312286377, "length": 4.038362979888916, "mode": "test", "epoch": 16}
{"loss": 0.09614356607198715, "acc": 0.9793451428413391, "length": 4.065256118774414, "mode": "train", "epoch": 17}
{"loss": 0.2712990939617157, "acc": 0.9203206896781921, "length": 4.126878261566162, "mode": "test", "epoch": 17}
{"loss": 0.09157296270132065, "acc": 0.9812696576118469, "length": 4.091065883636475, "mode": "train", "epoch": 18}
{"loss": 0.2585611939430237, "acc": 0.9234121441841125, "length": 4.085078239440918, "mode": "test", "epoch": 18}
{"loss": 0.08866669982671738, "acc": 0.9823732972145081, "length": 4.1017985343933105, "mode": "train", "epoch": 19}
{"loss": 0.2405192255973816, "acc": 0.9266911745071411, "length": 4.189178466796875, "mode": "test", "epoch": 19}
{"loss": 0.08445093780755997, "acc": 0.983839213848114, "length": 4.116820812225342, "mode": "train", "epoch": 20}
{"loss": 0.31814301013946533, "acc": 0.91359543800354, "length": 4.076966285705566, "mode": "test", "epoch": 20}
{"loss": 0.08309653401374817, "acc": 0.984345018863678, "length": 4.100793361663818, "mode": "train", "epoch": 21}
{"loss": 0.2599165737628937, "acc": 0.9245157241821289, "length": 4.1120123863220215, "mode": "test", "epoch": 21}
{"loss": 0.08036526292562485, "acc": 0.9852467775344849, "length": 4.095491886138916, "mode": "train", "epoch": 22}
{"loss": 0.21602346003055573, "acc": 0.9379659295082092, "length": 4.121043682098389, "mode": "test", "epoch": 22}
{"loss": 0.08104633539915085, "acc": 0.9849889874458313, "length": 4.091086387634277, "mode": "train", "epoch": 23}
{"loss": 0.2726861536502838, "acc": 0.9219139218330383, "length": 4.110174179077148, "mode": "test", "epoch": 23}
{"loss": 0.07882221043109894, "acc": 0.9857679009437561, "length": 4.086015701293945, "mode": "train", "epoch": 24}
{"loss": 0.21945121884346008, "acc": 0.9371619820594788, "length": 4.120044708251953, "mode": "test", "epoch": 24}
{"loss": 0.07650201767683029, "acc": 0.9866300225257874, "length": 4.088567733764648, "mode": "train", "epoch": 25}
{"loss": 0.3260782063007355, "acc": 0.905102014541626, "length": 4.150295734405518, "mode": "test", "epoch": 25}
{"loss": 0.07594374567270279, "acc": 0.9868955016136169, "length": 4.102994918823242, "mode": "train", "epoch": 26}
{"loss": 0.2975119948387146, "acc": 0.9238916635513306, "length": 4.120604038238525, "mode": "test", "epoch": 26}
{"loss": 0.07552116364240646, "acc": 0.98702073097229, "length": 4.102644443511963, "mode": "train", "epoch": 27}
{"loss": 0.2971639931201935, "acc": 0.9203469157218933, "length": 4.154052257537842, "mode": "test", "epoch": 27}
{"loss": 0.07389194518327713, "acc": 0.9873110055923462, "length": 4.086638927459717, "mode": "train", "epoch": 28}
{"loss": 0.27335289120674133, "acc": 0.9225453734397888, "length": 4.132352828979492, "mode": "test", "epoch": 28}
{"loss": 0.0726325586438179, "acc": 0.9874046444892883, "length": 4.085113525390625, "mode": "train", "epoch": 29}
{"loss": 0.28611478209495544, "acc": 0.9179362654685974, "length": 4.141224384307861, "mode": "test", "epoch": 29}
{"loss": 0.0695529505610466, "acc": 0.9878731966018677, "length": 4.073909282684326, "mode": "train", "epoch": 30}
{"loss": 0.308546245098114, "acc": 0.912338376045227, "length": 4.3115010261535645, "mode": "test", "epoch": 30}
{"loss": 0.06664393842220306, "acc": 0.9885381460189819, "length": 4.090402126312256, "mode": "train", "epoch": 31}
{"loss": 0.32083767652511597, "acc": 0.9091816544532776, "length": 4.179347991943359, "mode": "test", "epoch": 31}
{"loss": 0.06381314247846603, "acc": 0.9890689253807068, "length": 4.077314853668213, "mode": "train", "epoch": 32}
{"loss": 0.3546103239059448, "acc": 0.8982281684875488, "length": 4.111812591552734, "mode": "test", "epoch": 32}
{"loss": 0.06109597161412239, "acc": 0.9899593591690063, "length": 4.0791144371032715, "mode": "train", "epoch": 33}
{"loss": 0.2943861484527588, "acc": 0.9135432243347168, "length": 4.156809329986572, "mode": "test", "epoch": 33}
{"loss": 0.0638495460152626, "acc": 0.9890604019165039, "length": 4.088466644287109, "mode": "train", "epoch": 34}
{"loss": 0.31989356875419617, "acc": 0.9016024470329285, "length": 4.1919355392456055, "mode": "test", "epoch": 34}
{"loss": 0.05889393761754036, "acc": 0.9905681610107422, "length": 4.075555324554443, "mode": "train", "epoch": 35}
{"loss": 0.41794273257255554, "acc": 0.8795408010482788, "length": 4.168638229370117, "mode": "test", "epoch": 35}
{"loss": 0.05829482153058052, "acc": 0.9907288551330566, "length": 4.062997817993164, "mode": "train", "epoch": 36}
{"loss": 0.38399356603622437, "acc": 0.891610324382782, "length": 4.1485772132873535, "mode": "test", "epoch": 36}
{"loss": 0.05919431522488594, "acc": 0.9900239706039429, "length": 4.070871829986572, "mode": "train", "epoch": 37}
{"loss": 0.4131730794906616, "acc": 0.890899658203125, "length": 4.122881889343262, "mode": "test", "epoch": 37}
{"loss": 0.05502424016594887, "acc": 0.9905521273612976, "length": 4.051712512969971, "mode": "train", "epoch": 38}
{"loss": 0.3825451135635376, "acc": 0.8904574513435364, "length": 4.173793315887451, "mode": "test", "epoch": 38}
{"loss": 0.0528537854552269, "acc": 0.9910035133361816, "length": 4.0615153312683105, "mode": "train", "epoch": 39}
{"loss": 0.32460370659828186, "acc": 0.9006884694099426, "length": 4.140864849090576, "mode": "test", "epoch": 39}
{"loss": 0.050459347665309906, "acc": 0.9915388822555542, "length": 4.05757474899292, "mode": "train", "epoch": 40}
{"loss": 0.39917996525764465, "acc": 0.8882279396057129, "length": 4.111852645874023, "mode": "test", "epoch": 40}
{"loss": 0.04891379177570343, "acc": 0.9921354055404663, "length": 4.061518669128418, "mode": "train", "epoch": 41}
{"loss": 0.3735729455947876, "acc": 0.8976691961288452, "length": 4.139825820922852, "mode": "test", "epoch": 41}
{"loss": 0.0473581962287426, "acc": 0.9924094080924988, "length": 4.077095985412598, "mode": "train", "epoch": 42}
{"loss": 0.3507425785064697, "acc": 0.8948225378990173, "length": 4.200647354125977, "mode": "test", "epoch": 42}
{"loss": 0.04600057005882263, "acc": 0.9930316209793091, "length": 4.092278957366943, "mode": "train", "epoch": 43}
{"loss": 0.3504961133003235, "acc": 0.8944021463394165, "length": 4.19828987121582, "mode": "test", "epoch": 43}
{"loss": 0.045594722032547, "acc": 0.9931210875511169, "length": 4.092486381530762, "mode": "train", "epoch": 44}
{"loss": 0.37649232149124146, "acc": 0.8953196406364441, "length": 4.104219913482666, "mode": "test", "epoch": 44}
{"loss": 0.04314064607024193, "acc": 0.9938055276870728, "length": 4.088197708129883, "mode": "train", "epoch": 45}
{"loss": 0.36868715286254883, "acc": 0.8894050717353821, "length": 4.130035400390625, "mode": "test", "epoch": 45}
{"loss": 0.043955978006124496, "acc": 0.9935759902000427, "length": 4.108072280883789, "mode": "train", "epoch": 46}
{"loss": 0.40347689390182495, "acc": 0.8804358839988708, "length": 4.191895961761475, "mode": "test", "epoch": 46}
{"loss": 0.043357349932193756, "acc": 0.9938489198684692, "length": 4.11719274520874, "mode": "train", "epoch": 47}
{"loss": 0.4090803265571594, "acc": 0.8844681978225708, "length": 4.142942905426025, "mode": "test", "epoch": 47}
{"loss": 0.04268696531653404, "acc": 0.9940225481987, "length": 4.1241559982299805, "mode": "train", "epoch": 48}
{"loss": 0.33785220980644226, "acc": 0.900226891040802, "length": 4.157369136810303, "mode": "test", "epoch": 48}
{"loss": 0.042010750621557236, "acc": 0.994255542755127, "length": 4.123943328857422, "mode": "train", "epoch": 49}
{"loss": 0.2873881459236145, "acc": 0.9197387099266052, "length": 4.127757549285889, "mode": "test", "epoch": 49}
{"loss": 0.044407304376363754, "acc": 0.9935585260391235, "length": 4.117462635040283, "mode": "train", "epoch": 50}
{"loss": 0.40293341875076294, "acc": 0.894117534160614, "length": 4.123481273651123, "mode": "test", "epoch": 50}
{"loss": 0.04670092463493347, "acc": 0.9927527904510498, "length": 4.119962215423584, "mode": "train", "epoch": 51}
{"loss": 0.5107799768447876, "acc": 0.8720108866691589, "length": 4.161524772644043, "mode": "test", "epoch": 51}
{"loss": 0.042425159364938736, "acc": 0.9940139055252075, "length": 4.113482475280762, "mode": "train", "epoch": 52}
{"loss": 0.3331456780433655, "acc": 0.8979787826538086, "length": 4.105498790740967, "mode": "test", "epoch": 52}
{"loss": 0.04292619973421097, "acc": 0.993769109249115, "length": 4.109264373779297, "mode": "train", "epoch": 53}
{"loss": 0.33762016892433167, "acc": 0.9011232852935791, "length": 4.150575637817383, "mode": "test", "epoch": 53}
{"loss": 0.04112546518445015, "acc": 0.9943599104881287, "length": 4.1107869148254395, "mode": "train", "epoch": 54}
{"loss": 0.27828291058540344, "acc": 0.9124173521995544, "length": 4.192814826965332, "mode": "test", "epoch": 54}
{"loss": 0.04256158322095871, "acc": 0.9939469695091248, "length": 4.127490043640137, "mode": "train", "epoch": 55}
{"loss": 0.30703625082969666, "acc": 0.91321861743927, "length": 4.2227463722229, "mode": "test", "epoch": 55}
{"loss": 0.04134213551878929, "acc": 0.9942840337753296, "length": 4.118805408477783, "mode": "train", "epoch": 56}
{"loss": 0.2987746000289917, "acc": 0.9186963438987732, "length": 4.143661975860596, "mode": "test", "epoch": 56}
{"loss": 0.04205269366502762, "acc": 0.9940851330757141, "length": 4.13734245300293, "mode": "train", "epoch": 57}
{"loss": 0.3458140194416046, "acc": 0.9053528904914856, "length": 4.164522171020508, "mode": "test", "epoch": 57}
{"loss": 0.04108696058392525, "acc": 0.9944149255752563, "length": 4.154318809509277, "mode": "train", "epoch": 58}
{"loss": 0.3306300938129425, "acc": 0.9091006517410278, "length": 4.1432623863220215, "mode": "test", "epoch": 58}
{"loss": 0.039977964013814926, "acc": 0.994696319103241, "length": 4.144719123840332, "mode": "train", "epoch": 59}
{"loss": 0.29765617847442627, "acc": 0.9154378175735474, "length": 4.14470100402832, "mode": "test", "epoch": 59}
{"loss": 0.0414116270840168, "acc": 0.9942220449447632, "length": 4.138922691345215, "mode": "train", "epoch": 60}
{"loss": 0.2998984158039093, "acc": 0.9161830544471741, "length": 4.255035400390625, "mode": "test", "epoch": 60}
test accuracy: 0.9133100509643555
