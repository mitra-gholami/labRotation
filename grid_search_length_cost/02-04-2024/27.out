ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.6947316527366638, "acc": 0.5276428461074829, "length": 3.832131862640381, "mode": "train", "epoch": 1}
{"loss": 0.6644244194030762, "acc": 0.6104301810264587, "length": 2.293402671813965, "mode": "test", "epoch": 1}
{"loss": 0.6179332733154297, "acc": 0.6543934941291809, "length": 3.020206928253174, "mode": "train", "epoch": 2}
{"loss": 0.6067813038825989, "acc": 0.6665391325950623, "length": 1.6527777910232544, "mode": "test", "epoch": 2}
{"loss": 0.5451338291168213, "acc": 0.7345463633537292, "length": 3.0928564071655273, "mode": "train", "epoch": 3}
{"loss": 0.5551522970199585, "acc": 0.7499023675918579, "length": 3.2517361640930176, "mode": "test", "epoch": 3}
{"loss": 0.4562188684940338, "acc": 0.7936784029006958, "length": 3.8504879474639893, "mode": "train", "epoch": 4}
{"loss": 0.4815801978111267, "acc": 0.7879748344421387, "length": 4.434027671813965, "mode": "test", "epoch": 4}
{"loss": 0.39400938153266907, "acc": 0.8266481161117554, "length": 4.374910354614258, "mode": "train", "epoch": 5}
{"loss": 0.38364723324775696, "acc": 0.8370035886764526, "length": 4.114583492279053, "mode": "test", "epoch": 5}
{"loss": 0.340408593416214, "acc": 0.8552719354629517, "length": 5.095957279205322, "mode": "train", "epoch": 6}
{"loss": 0.33675968647003174, "acc": 0.8603244423866272, "length": 4.802083492279053, "mode": "test", "epoch": 6}
{"loss": 0.30548879504203796, "acc": 0.8724091649055481, "length": 5.354247570037842, "mode": "train", "epoch": 7}
{"loss": 0.3200953006744385, "acc": 0.8707193732261658, "length": 5.826388835906982, "mode": "test", "epoch": 7}
{"loss": 0.27649015188217163, "acc": 0.8859898447990417, "length": 6.276485443115234, "mode": "train", "epoch": 8}
{"loss": 0.3312978446483612, "acc": 0.8665472865104675, "length": 6.277777671813965, "mode": "test", "epoch": 8}
{"loss": 0.25962692499160767, "acc": 0.8974694609642029, "length": 6.913857936859131, "mode": "train", "epoch": 9}
{"loss": 0.3158324360847473, "acc": 0.8718125820159912, "length": 7.21875, "mode": "test", "epoch": 9}
{"loss": 0.2382601797580719, "acc": 0.9068626761436462, "length": 7.376579761505127, "mode": "train", "epoch": 10}
{"loss": 0.2889440655708313, "acc": 0.8910157084465027, "length": 7.699652671813965, "mode": "test", "epoch": 10}
{"loss": 0.21984626352787018, "acc": 0.91690993309021, "length": 8.245906829833984, "mode": "train", "epoch": 11}
{"loss": 0.3369387984275818, "acc": 0.8753499388694763, "length": 8.296875, "mode": "test", "epoch": 11}
{"loss": 0.20296593010425568, "acc": 0.9262402057647705, "length": 8.567121505737305, "mode": "train", "epoch": 12}
{"loss": 0.2997390925884247, "acc": 0.8990614414215088, "length": 9.125, "mode": "test", "epoch": 12}
{"loss": 0.18566803634166718, "acc": 0.9347373843193054, "length": 9.247919082641602, "mode": "train", "epoch": 13}
{"loss": 0.2619328796863556, "acc": 0.9019531607627869, "length": 9.00173568725586, "mode": "test", "epoch": 13}
{"loss": 0.17092324793338776, "acc": 0.9422380328178406, "length": 9.38446044921875, "mode": "train", "epoch": 14}
{"loss": 0.2436489760875702, "acc": 0.9204480648040771, "length": 9.43923568725586, "mode": "test", "epoch": 14}
{"loss": 0.15849804878234863, "acc": 0.9463635683059692, "length": 9.667622566223145, "mode": "train", "epoch": 15}
{"loss": 0.2045656442642212, "acc": 0.923008918762207, "length": 9.96006965637207, "mode": "test", "epoch": 15}
{"loss": 0.1440238207578659, "acc": 0.9520825147628784, "length": 9.879706382751465, "mode": "train", "epoch": 16}
{"loss": 0.2151070237159729, "acc": 0.9202880859375, "length": 9.86805534362793, "mode": "test", "epoch": 16}
{"loss": 0.14111696183681488, "acc": 0.9533610939979553, "length": 9.914019584655762, "mode": "train", "epoch": 17}
{"loss": 0.1842576414346695, "acc": 0.9385198950767517, "length": 9.97569465637207, "mode": "test", "epoch": 17}
{"loss": 0.12486176937818527, "acc": 0.9586495161056519, "length": 9.9812650680542, "mode": "train", "epoch": 18}
{"loss": 0.1688646525144577, "acc": 0.9430529475212097, "length": 9.80555534362793, "mode": "test", "epoch": 18}
{"loss": 0.10298467427492142, "acc": 0.9683355689048767, "length": 10.09282398223877, "mode": "train", "epoch": 19}
{"loss": 0.16865211725234985, "acc": 0.945353090763092, "length": 9.942708015441895, "mode": "test", "epoch": 19}
{"loss": 0.10183840990066528, "acc": 0.9682908654212952, "length": 10.091967582702637, "mode": "train", "epoch": 20}
{"loss": 0.14437741041183472, "acc": 0.9542914628982544, "length": 9.911458015441895, "mode": "test", "epoch": 20}
{"loss": 0.08717694133520126, "acc": 0.9737261533737183, "length": 10.148523330688477, "mode": "train", "epoch": 21}
{"loss": 0.14828698337078094, "acc": 0.9498480558395386, "length": 9.91319465637207, "mode": "test", "epoch": 21}
{"loss": 0.07745546102523804, "acc": 0.9778140187263489, "length": 10.275813102722168, "mode": "train", "epoch": 22}
{"loss": 0.1338556706905365, "acc": 0.9549045562744141, "length": 10.286458015441895, "mode": "test", "epoch": 22}
{"loss": 0.07432860136032104, "acc": 0.9804383516311646, "length": 10.418387413024902, "mode": "train", "epoch": 23}
{"loss": 0.14156419038772583, "acc": 0.9508273005485535, "length": 10.5625, "mode": "test", "epoch": 23}
{"loss": 0.07075957208871841, "acc": 0.979739248752594, "length": 10.443403244018555, "mode": "train", "epoch": 24}
{"loss": 0.11837877333164215, "acc": 0.9619764685630798, "length": 10.479166984558105, "mode": "test", "epoch": 24}
{"loss": 0.05484529584646225, "acc": 0.9879721999168396, "length": 10.531315803527832, "mode": "train", "epoch": 25}
{"loss": 0.09830120950937271, "acc": 0.9699381589889526, "length": 10.385416984558105, "mode": "test", "epoch": 25}
{"loss": 0.049479447305202484, "acc": 0.9896671772003174, "length": 10.620738983154297, "mode": "train", "epoch": 26}
{"loss": 0.08960356563329697, "acc": 0.9724881052970886, "length": 10.512152671813965, "mode": "test", "epoch": 26}
{"loss": 0.05127375200390816, "acc": 0.9878794550895691, "length": 10.64311695098877, "mode": "train", "epoch": 27}
{"loss": 0.10564853250980377, "acc": 0.9690810441970825, "length": 10.625, "mode": "test", "epoch": 27}
{"loss": 0.0460476391017437, "acc": 0.9906607866287231, "length": 10.707060813903809, "mode": "train", "epoch": 28}
{"loss": 0.08853419870138168, "acc": 0.9730930328369141, "length": 10.578125, "mode": "test", "epoch": 28}
{"loss": 0.048922497779130936, "acc": 0.9881171584129333, "length": 10.672924041748047, "mode": "train", "epoch": 29}
{"loss": 0.10654860734939575, "acc": 0.9686334133148193, "length": 10.71701431274414, "mode": "test", "epoch": 29}
{"loss": 0.04006689786911011, "acc": 0.992125391960144, "length": 10.708288192749023, "mode": "train", "epoch": 30}
{"loss": 0.09277193993330002, "acc": 0.9764484763145447, "length": 10.597222328186035, "mode": "test", "epoch": 30}
{"loss": 0.03417646139860153, "acc": 0.9940546154975891, "length": 10.72142505645752, "mode": "train", "epoch": 31}
{"loss": 0.07248863577842712, "acc": 0.9790689945220947, "length": 10.83680534362793, "mode": "test", "epoch": 31}
{"loss": 0.031320102512836456, "acc": 0.9949575066566467, "length": 10.825286865234375, "mode": "train", "epoch": 32}
{"loss": 0.06359376758337021, "acc": 0.9828694462776184, "length": 10.817708015441895, "mode": "test", "epoch": 32}
{"loss": 0.051554031670093536, "acc": 0.9865114092826843, "length": 10.633251190185547, "mode": "train", "epoch": 33}
{"loss": 0.09018294513225555, "acc": 0.9691975116729736, "length": 10.621527671813965, "mode": "test", "epoch": 33}
{"loss": 0.041816774755716324, "acc": 0.9906230568885803, "length": 10.476317405700684, "mode": "train", "epoch": 34}
{"loss": 0.08623474091291428, "acc": 0.9746907353401184, "length": 10.50868034362793, "mode": "test", "epoch": 34}
{"loss": 0.029004575684666634, "acc": 0.995895504951477, "length": 10.708654403686523, "mode": "train", "epoch": 35}
{"loss": 0.0688762292265892, "acc": 0.9826714396476746, "length": 10.65798568725586, "mode": "test", "epoch": 35}
{"loss": 0.023090358823537827, "acc": 0.9978585243225098, "length": 10.804901123046875, "mode": "train", "epoch": 36}
{"loss": 0.06105803698301315, "acc": 0.9838406443595886, "length": 10.77256965637207, "mode": "test", "epoch": 36}
{"loss": 0.024618277326226234, "acc": 0.9964914917945862, "length": 10.846656799316406, "mode": "train", "epoch": 37}
{"loss": 0.06337516754865646, "acc": 0.9825955629348755, "length": 10.793402671813965, "mode": "test", "epoch": 37}
{"loss": 0.02386055700480938, "acc": 0.9966058135032654, "length": 10.82697582244873, "mode": "train", "epoch": 38}
{"loss": 0.0712282732129097, "acc": 0.9755370616912842, "length": 10.78819465637207, "mode": "test", "epoch": 38}
{"loss": 0.02633567340672016, "acc": 0.995708167552948, "length": 10.81058406829834, "mode": "train", "epoch": 39}
{"loss": 0.05158650875091553, "acc": 0.9854736328125, "length": 10.78819465637207, "mode": "test", "epoch": 39}
{"loss": 0.025325920432806015, "acc": 0.9959163665771484, "length": 10.785964012145996, "mode": "train", "epoch": 40}
{"loss": 0.06496715545654297, "acc": 0.9836533665657043, "length": 10.807291984558105, "mode": "test", "epoch": 40}
{"loss": 0.02058173529803753, "acc": 0.9976715445518494, "length": 10.852937698364258, "mode": "train", "epoch": 41}
{"loss": 0.04255981370806694, "acc": 0.9919162392616272, "length": 10.82986068725586, "mode": "test", "epoch": 41}
{"loss": 0.018873566761612892, "acc": 0.9985603094100952, "length": 10.885086059570312, "mode": "train", "epoch": 42}
{"loss": 0.035475537180900574, "acc": 0.9920110702514648, "length": 10.87326431274414, "mode": "test", "epoch": 42}
{"loss": 0.024954846128821373, "acc": 0.9962161183357239, "length": 10.907657623291016, "mode": "train", "epoch": 43}
{"loss": 0.04600288346409798, "acc": 0.9904270172119141, "length": 10.85763931274414, "mode": "test", "epoch": 43}
{"loss": 0.020448196679353714, "acc": 0.997585117816925, "length": 10.887752532958984, "mode": "train", "epoch": 44}
{"loss": 0.05457333102822304, "acc": 0.9878879189491272, "length": 10.847222328186035, "mode": "test", "epoch": 44}
{"loss": 0.027585864067077637, "acc": 0.994499146938324, "length": 10.815103530883789, "mode": "train", "epoch": 45}
{"loss": 0.06720415502786636, "acc": 0.9858235120773315, "length": 10.723958015441895, "mode": "test", "epoch": 45}
{"loss": 0.0487188883125782, "acc": 0.9868293404579163, "length": 10.549467086791992, "mode": "train", "epoch": 46}
{"loss": 0.06536643207073212, "acc": 0.9835284352302551, "length": 10.64756965637207, "mode": "test", "epoch": 46}
{"loss": 0.031101036816835403, "acc": 0.9940828680992126, "length": 10.718567848205566, "mode": "train", "epoch": 47}
{"loss": 0.07245966047048569, "acc": 0.9813856482505798, "length": 10.43576431274414, "mode": "test", "epoch": 47}
{"loss": 0.02160925790667534, "acc": 0.9972617030143738, "length": 10.704330444335938, "mode": "train", "epoch": 48}
{"loss": 0.03947077691555023, "acc": 0.9924994707107544, "length": 10.828125, "mode": "test", "epoch": 48}
{"loss": 0.018969237804412842, "acc": 0.9978485703468323, "length": 10.870033264160156, "mode": "train", "epoch": 49}
{"loss": 0.05872046947479248, "acc": 0.9856336116790771, "length": 10.854166984558105, "mode": "test", "epoch": 49}
{"loss": 0.025531886145472527, "acc": 0.9954054355621338, "length": 10.880727767944336, "mode": "train", "epoch": 50}
{"loss": 0.07072480022907257, "acc": 0.9836155772209167, "length": 10.847222328186035, "mode": "test", "epoch": 50}
{"loss": 0.02595730684697628, "acc": 0.9954026341438293, "length": 10.864030838012695, "mode": "train", "epoch": 51}
{"loss": 0.06003229320049286, "acc": 0.9829130172729492, "length": 10.81423568725586, "mode": "test", "epoch": 51}
{"loss": 0.022194985300302505, "acc": 0.9965386390686035, "length": 10.872868537902832, "mode": "train", "epoch": 52}
{"loss": 0.06138090789318085, "acc": 0.9825303554534912, "length": 10.887152671813965, "mode": "test", "epoch": 52}
{"loss": 0.0225874911993742, "acc": 0.9963755011558533, "length": 10.922950744628906, "mode": "train", "epoch": 53}
{"loss": 0.043330296874046326, "acc": 0.990044355392456, "length": 10.902777671813965, "mode": "test", "epoch": 53}
{"loss": 0.01219565887004137, "acc": 0.9996787309646606, "length": 10.926276206970215, "mode": "train", "epoch": 54}
{"loss": 0.031324610114097595, "acc": 0.993443489074707, "length": 10.88194465637207, "mode": "test", "epoch": 54}
{"loss": 0.012536749243736267, "acc": 0.9995135068893433, "length": 10.927620887756348, "mode": "train", "epoch": 55}
{"loss": 0.03358982875943184, "acc": 0.9944525957107544, "length": 10.909722328186035, "mode": "test", "epoch": 55}
{"loss": 0.0132138067856431, "acc": 0.9993101358413696, "length": 10.95263671875, "mode": "train", "epoch": 56}
{"loss": 0.039285436272621155, "acc": 0.9922877550125122, "length": 10.901041984558105, "mode": "test", "epoch": 56}
{"loss": 0.011181114241480827, "acc": 0.9996161460876465, "length": 10.940140724182129, "mode": "train", "epoch": 57}
{"loss": 0.03679894283413887, "acc": 0.9929903745651245, "length": 10.916666984558105, "mode": "test", "epoch": 57}
{"loss": 0.011208164505660534, "acc": 0.9996126294136047, "length": 10.96030330657959, "mode": "train", "epoch": 58}
{"loss": 0.03578256815671921, "acc": 0.9932617545127869, "length": 10.90625, "mode": "test", "epoch": 58}
{"loss": 0.022049594670534134, "acc": 0.9961500763893127, "length": 10.939616203308105, "mode": "train", "epoch": 59}
{"loss": 0.05217240750789642, "acc": 0.9887044429779053, "length": 10.88368034362793, "mode": "test", "epoch": 59}
{"loss": 0.027040893211960793, "acc": 0.9948014616966248, "length": 10.899985313415527, "mode": "train", "epoch": 60}
{"loss": 0.047098953276872635, "acc": 0.9863444566726685, "length": 10.956597328186035, "mode": "test", "epoch": 60}
test accuracy: 0.7495312094688416
