ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 10
{"loss": 0.4140092730522156, "acc": 0.8099647164344788, "length": 5.413671016693115, "mode": "train", "epoch": 1}
{"loss": 0.3342701196670532, "acc": 0.8658702373504639, "length": 6.863452434539795, "mode": "test", "epoch": 1}
{"loss": 0.22781895101070404, "acc": 0.9244184494018555, "length": 7.462909698486328, "mode": "train", "epoch": 2}
{"loss": 0.23505660891532898, "acc": 0.9199755787849426, "length": 7.55845832824707, "mode": "test", "epoch": 2}
{"loss": 0.1981482356786728, "acc": 0.9392533302307129, "length": 7.780275821685791, "mode": "train", "epoch": 3}
{"loss": 0.22388789057731628, "acc": 0.9302514791488647, "length": 7.535544395446777, "mode": "test", "epoch": 3}
{"loss": 0.17972451448440552, "acc": 0.9471496343612671, "length": 7.818323135375977, "mode": "train", "epoch": 4}
{"loss": 0.20222625136375427, "acc": 0.9386337399482727, "length": 8.067154884338379, "mode": "test", "epoch": 4}
{"loss": 0.1670384407043457, "acc": 0.9515140056610107, "length": 8.351960182189941, "mode": "train", "epoch": 5}
{"loss": 0.1930231899023056, "acc": 0.9399281144142151, "length": 8.71481704711914, "mode": "test", "epoch": 5}
{"loss": 0.1504245400428772, "acc": 0.9580709338188171, "length": 8.473076820373535, "mode": "train", "epoch": 6}
{"loss": 0.17141377925872803, "acc": 0.947993278503418, "length": 8.190134048461914, "mode": "test", "epoch": 6}
{"loss": 0.1376713514328003, "acc": 0.9630200266838074, "length": 8.596735000610352, "mode": "train", "epoch": 7}
{"loss": 0.155806303024292, "acc": 0.9551361799240112, "length": 8.35926628112793, "mode": "test", "epoch": 7}
{"loss": 0.1290794163942337, "acc": 0.966370701789856, "length": 8.670117378234863, "mode": "train", "epoch": 8}
{"loss": 0.14230985939502716, "acc": 0.9618546366691589, "length": 8.441974639892578, "mode": "test", "epoch": 8}
{"loss": 0.12086501717567444, "acc": 0.9691045880317688, "length": 8.58464527130127, "mode": "train", "epoch": 9}
{"loss": 0.14266124367713928, "acc": 0.9628741145133972, "length": 9.017212867736816, "mode": "test", "epoch": 9}
{"loss": 0.11860471218824387, "acc": 0.9693223237991333, "length": 9.342375755310059, "mode": "train", "epoch": 10}
{"loss": 0.13486790657043457, "acc": 0.9624320864677429, "length": 9.863524436950684, "mode": "test", "epoch": 10}
{"loss": 0.10655051469802856, "acc": 0.973807692527771, "length": 9.619690895080566, "mode": "train", "epoch": 11}
{"loss": 0.1283835619688034, "acc": 0.9661489129066467, "length": 9.418338775634766, "mode": "test", "epoch": 11}
{"loss": 0.100264772772789, "acc": 0.9761461019515991, "length": 9.750313758850098, "mode": "train", "epoch": 12}
{"loss": 0.11518853157758713, "acc": 0.97005695104599, "length": 9.714924812316895, "mode": "test", "epoch": 12}
{"loss": 0.09189163893461227, "acc": 0.9791343212127686, "length": 9.619550704956055, "mode": "train", "epoch": 13}
{"loss": 0.10575785487890244, "acc": 0.9745560884475708, "length": 9.347394943237305, "mode": "test", "epoch": 13}
{"loss": 0.09200257807970047, "acc": 0.978942334651947, "length": 9.392435073852539, "mode": "train", "epoch": 14}
{"loss": 0.10020920634269714, "acc": 0.9765979051589966, "length": 9.096240043640137, "mode": "test", "epoch": 14}
{"loss": 0.08696184307336807, "acc": 0.9805182814598083, "length": 9.281347274780273, "mode": "train", "epoch": 15}
{"loss": 0.10183247178792953, "acc": 0.9752275943756104, "length": 9.501407623291016, "mode": "test", "epoch": 15}
{"loss": 0.08577214181423187, "acc": 0.9808791875839233, "length": 9.635082244873047, "mode": "train", "epoch": 16}
{"loss": 0.10020559281110764, "acc": 0.9763200283050537, "length": 9.186128616333008, "mode": "test", "epoch": 16}
{"loss": 0.08208748698234558, "acc": 0.9818468689918518, "length": 9.222393989562988, "mode": "train", "epoch": 17}
{"loss": 0.0926983654499054, "acc": 0.979037880897522, "length": 9.153507232666016, "mode": "test", "epoch": 17}
{"loss": 0.0816204845905304, "acc": 0.982028603553772, "length": 9.209558486938477, "mode": "train", "epoch": 18}
{"loss": 0.09148763865232468, "acc": 0.978577196598053, "length": 8.933783531188965, "mode": "test", "epoch": 18}
{"loss": 0.07738544791936874, "acc": 0.9831847548484802, "length": 9.270767211914062, "mode": "train", "epoch": 19}
{"loss": 0.09940380603075027, "acc": 0.9755105376243591, "length": 10.323506355285645, "mode": "test", "epoch": 19}
{"loss": 0.08032986521720886, "acc": 0.981897234916687, "length": 10.166069030761719, "mode": "train", "epoch": 20}
{"loss": 0.08739373087882996, "acc": 0.9805434346199036, "length": 10.116628646850586, "mode": "test", "epoch": 20}
{"loss": 0.07330437004566193, "acc": 0.9841919541358948, "length": 10.022370338439941, "mode": "train", "epoch": 21}
{"loss": 0.08270221948623657, "acc": 0.982093870639801, "length": 9.150909423828125, "mode": "test", "epoch": 21}
{"loss": 0.07020501047372818, "acc": 0.9849454164505005, "length": 9.26547908782959, "mode": "train", "epoch": 22}
{"loss": 0.08088129013776779, "acc": 0.9818170070648193, "length": 9.655131340026855, "mode": "test", "epoch": 22}
{"loss": 0.06876551359891891, "acc": 0.9852634072303772, "length": 9.274626731872559, "mode": "train", "epoch": 23}
{"loss": 0.08027812838554382, "acc": 0.9821372628211975, "length": 9.661301612854004, "mode": "test", "epoch": 23}
{"loss": 0.06437468528747559, "acc": 0.9867793321609497, "length": 9.986239433288574, "mode": "train", "epoch": 24}
{"loss": 0.07510338723659515, "acc": 0.9847407937049866, "length": 10.607137680053711, "mode": "test", "epoch": 24}
{"loss": 0.059813547879457474, "acc": 0.9881036877632141, "length": 10.169473648071289, "mode": "train", "epoch": 25}
{"loss": 0.06351172924041748, "acc": 0.9880889654159546, "length": 9.811814308166504, "mode": "test", "epoch": 25}
{"loss": 0.05795660242438316, "acc": 0.988569438457489, "length": 10.296232223510742, "mode": "train", "epoch": 26}
{"loss": 0.06554056704044342, "acc": 0.9875805377960205, "length": 10.630773544311523, "mode": "test", "epoch": 26}
{"loss": 0.05573084205389023, "acc": 0.9891780018806458, "length": 10.317785263061523, "mode": "train", "epoch": 27}
{"loss": 0.06541388481855392, "acc": 0.986607551574707, "length": 10.497257232666016, "mode": "test", "epoch": 27}
{"loss": 0.056177861988544464, "acc": 0.9890998601913452, "length": 10.418893814086914, "mode": "train", "epoch": 28}
{"loss": 0.0617828331887722, "acc": 0.9871536493301392, "length": 10.090682983398438, "mode": "test", "epoch": 28}
{"loss": 0.05304257199168205, "acc": 0.989754855632782, "length": 10.093109130859375, "mode": "train", "epoch": 29}
{"loss": 0.059673722833395004, "acc": 0.9887529611587524, "length": 9.972575187683105, "mode": "test", "epoch": 29}
{"loss": 0.05335260182619095, "acc": 0.9895957708358765, "length": 9.991714477539062, "mode": "train", "epoch": 30}
{"loss": 0.05580782890319824, "acc": 0.9895324110984802, "length": 10.221203804016113, "mode": "test", "epoch": 30}
{"loss": 0.0518123097717762, "acc": 0.9900169968605042, "length": 10.308079719543457, "mode": "train", "epoch": 31}
{"loss": 0.058651167899370193, "acc": 0.9881067276000977, "length": 10.538755416870117, "mode": "test", "epoch": 31}
{"loss": 0.050891123712062836, "acc": 0.9901720285415649, "length": 10.418644905090332, "mode": "train", "epoch": 32}
{"loss": 0.05798383429646492, "acc": 0.9886370301246643, "length": 10.733689308166504, "mode": "test", "epoch": 32}
{"loss": 0.04855049401521683, "acc": 0.9907368421554565, "length": 10.537092208862305, "mode": "train", "epoch": 33}
{"loss": 0.05507565662264824, "acc": 0.9894369840621948, "length": 10.585846900939941, "mode": "test", "epoch": 33}
{"loss": 0.048028841614723206, "acc": 0.9908624887466431, "length": 10.556946754455566, "mode": "train", "epoch": 34}
{"loss": 0.05803674831986427, "acc": 0.9878442287445068, "length": 10.807303428649902, "mode": "test", "epoch": 34}
{"loss": 0.04605162888765335, "acc": 0.9911929368972778, "length": 10.29047679901123, "mode": "train", "epoch": 35}
{"loss": 0.05268779397010803, "acc": 0.9893258810043335, "length": 10.436056137084961, "mode": "test", "epoch": 35}
{"loss": 0.04537919536232948, "acc": 0.991065263748169, "length": 10.187491416931152, "mode": "train", "epoch": 36}
{"loss": 0.05373318865895271, "acc": 0.9888449907302856, "length": 10.125288963317871, "mode": "test", "epoch": 36}
{"loss": 0.04187764972448349, "acc": 0.9916788935661316, "length": 10.301153182983398, "mode": "train", "epoch": 37}
{"loss": 0.05514254420995712, "acc": 0.9886514544487, "length": 10.493721008300781, "mode": "test", "epoch": 37}
{"loss": 0.03997388482093811, "acc": 0.9919251799583435, "length": 10.617868423461914, "mode": "train", "epoch": 38}
{"loss": 0.054676949977874756, "acc": 0.9875094294548035, "length": 10.562716484069824, "mode": "test", "epoch": 38}
{"loss": 0.03798725828528404, "acc": 0.992531418800354, "length": 10.637103080749512, "mode": "train", "epoch": 39}
{"loss": 0.0418316014111042, "acc": 0.9911511540412903, "length": 10.5682373046875, "mode": "test", "epoch": 39}
{"loss": 0.033701032400131226, "acc": 0.9935483932495117, "length": 10.723438262939453, "mode": "train", "epoch": 40}
{"loss": 0.040896039456129074, "acc": 0.9923049211502075, "length": 10.815495491027832, "mode": "test", "epoch": 40}
{"loss": 0.03429939225316048, "acc": 0.9934929609298706, "length": 10.860630989074707, "mode": "train", "epoch": 41}
{"loss": 0.0404178723692894, "acc": 0.9920137524604797, "length": 10.885392189025879, "mode": "test", "epoch": 41}
{"loss": 0.03383205831050873, "acc": 0.9933636784553528, "length": 10.882118225097656, "mode": "train", "epoch": 42}
{"loss": 0.04215428605675697, "acc": 0.9911965727806091, "length": 10.893404006958008, "mode": "test", "epoch": 42}
{"loss": 0.03401939570903778, "acc": 0.9932103157043457, "length": 10.843159675598145, "mode": "train", "epoch": 43}
{"loss": 0.046514324843883514, "acc": 0.9906561374664307, "length": 10.856740951538086, "mode": "test", "epoch": 43}
{"loss": 0.030231216922402382, "acc": 0.9944387078285217, "length": 10.860602378845215, "mode": "train", "epoch": 44}
{"loss": 0.035557880997657776, "acc": 0.9930813908576965, "length": 10.828197479248047, "mode": "test", "epoch": 44}
{"loss": 0.029273804277181625, "acc": 0.9946357011795044, "length": 10.872917175292969, "mode": "train", "epoch": 45}
{"loss": 0.037278443574905396, "acc": 0.9924269914627075, "length": 10.902605056762695, "mode": "test", "epoch": 45}
{"loss": 0.02950696460902691, "acc": 0.9942781925201416, "length": 10.919252395629883, "mode": "train", "epoch": 46}
{"loss": 0.03380012884736061, "acc": 0.9940781593322754, "length": 10.939701080322266, "mode": "test", "epoch": 46}
{"loss": 0.028722956776618958, "acc": 0.9945733547210693, "length": 10.900358200073242, "mode": "train", "epoch": 47}
{"loss": 0.04375537112355232, "acc": 0.9898566603660583, "length": 10.771074295043945, "mode": "test", "epoch": 47}
{"loss": 0.027514275163412094, "acc": 0.9947355389595032, "length": 10.860462188720703, "mode": "train", "epoch": 48}
{"loss": 0.03221944347023964, "acc": 0.9943975806236267, "length": 10.897336959838867, "mode": "test", "epoch": 48}
{"loss": 0.024188421666622162, "acc": 0.9956234693527222, "length": 10.944674491882324, "mode": "train", "epoch": 49}
{"loss": 0.02994547039270401, "acc": 0.9945261478424072, "length": 10.954134941101074, "mode": "test", "epoch": 49}
{"loss": 0.022535381838679314, "acc": 0.9960231781005859, "length": 10.902939796447754, "mode": "train", "epoch": 50}
{"loss": 0.029802724719047546, "acc": 0.9943499565124512, "length": 10.864282608032227, "mode": "test", "epoch": 50}
{"loss": 0.025022873654961586, "acc": 0.9952645301818848, "length": 10.864640235900879, "mode": "train", "epoch": 51}
{"loss": 0.03671390935778618, "acc": 0.9930078983306885, "length": 10.875974655151367, "mode": "test", "epoch": 51}
{"loss": 0.024600429460406303, "acc": 0.9953957200050354, "length": 10.857083320617676, "mode": "train", "epoch": 52}
{"loss": 0.04418753832578659, "acc": 0.9903676509857178, "length": 10.970878601074219, "mode": "test", "epoch": 52}
{"loss": 0.023302335292100906, "acc": 0.9957456588745117, "length": 10.954368591308594, "mode": "train", "epoch": 53}
{"loss": 0.027923371642827988, "acc": 0.9943655729293823, "length": 10.956588745117188, "mode": "test", "epoch": 53}
{"loss": 0.023672103881835938, "acc": 0.9956324696540833, "length": 10.955700874328613, "mode": "train", "epoch": 54}
{"loss": 0.029398685321211815, "acc": 0.9940915703773499, "length": 10.959511756896973, "mode": "test", "epoch": 54}
{"loss": 0.021194878965616226, "acc": 0.9962377548217773, "length": 10.958257675170898, "mode": "train", "epoch": 55}
{"loss": 0.029054738581180573, "acc": 0.9938768148422241, "length": 10.965682983398438, "mode": "test", "epoch": 55}
{"loss": 0.022461753338575363, "acc": 0.9958457946777344, "length": 10.970346450805664, "mode": "train", "epoch": 56}
{"loss": 0.025719765573740005, "acc": 0.9958741068840027, "length": 10.973224639892578, "mode": "test", "epoch": 56}
{"loss": 0.017995458096265793, "acc": 0.9971700310707092, "length": 10.979411125183105, "mode": "train", "epoch": 57}
{"loss": 0.023008910939097404, "acc": 0.9965211153030396, "length": 10.996247291564941, "mode": "test", "epoch": 57}
{"loss": 0.018596138805150986, "acc": 0.9968787431716919, "length": 10.992966651916504, "mode": "train", "epoch": 58}
{"loss": 0.024723945185542107, "acc": 0.9953053593635559, "length": 11.0, "mode": "test", "epoch": 58}
{"loss": 0.02718353271484375, "acc": 0.9945913553237915, "length": 10.997817993164062, "mode": "train", "epoch": 59}
{"loss": 0.0314677432179451, "acc": 0.9927553534507751, "length": 10.987874984741211, "mode": "test", "epoch": 59}
{"loss": 0.024322079494595528, "acc": 0.9952806830406189, "length": 10.985158920288086, "mode": "train", "epoch": 60}
{"loss": 0.032868243753910065, "acc": 0.9926482439041138, "length": 10.99523639678955, "mode": "test", "epoch": 60}
test accuracy: 0.9859746098518372
