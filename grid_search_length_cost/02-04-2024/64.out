ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.46337631344795227, "acc": 0.7626636028289795, "length": 2.2753539085388184, "mode": "train", "epoch": 1}
{"loss": 0.3885657787322998, "acc": 0.8306599259376526, "length": 2.5288093090057373, "mode": "test", "epoch": 1}
{"loss": 0.2952273488044739, "acc": 0.8919597268104553, "length": 3.031057357788086, "mode": "train", "epoch": 2}
{"loss": 0.33103084564208984, "acc": 0.8716157078742981, "length": 3.229433536529541, "mode": "test", "epoch": 2}
{"loss": 0.24511916935443878, "acc": 0.9199212789535522, "length": 3.5082225799560547, "mode": "train", "epoch": 3}
{"loss": 0.2953912913799286, "acc": 0.8948769569396973, "length": 3.5495357513427734, "mode": "test", "epoch": 3}
{"loss": 0.2239760160446167, "acc": 0.9300974011421204, "length": 3.6000797748565674, "mode": "train", "epoch": 4}
{"loss": 0.278799444437027, "acc": 0.905195415019989, "length": 3.6121959686279297, "mode": "test", "epoch": 4}
{"loss": 0.2111750841140747, "acc": 0.9360206127166748, "length": 3.6128809452056885, "mode": "train", "epoch": 5}
{"loss": 0.2715747058391571, "acc": 0.9072942137718201, "length": 3.5905089378356934, "mode": "test", "epoch": 5}
{"loss": 0.1982428878545761, "acc": 0.93928062915802, "length": 3.6097073554992676, "mode": "train", "epoch": 6}
{"loss": 0.2639419138431549, "acc": 0.9069095253944397, "length": 3.609795093536377, "mode": "test", "epoch": 6}
{"loss": 0.18063457310199738, "acc": 0.9443947672843933, "length": 3.613219738006592, "mode": "train", "epoch": 7}
{"loss": 0.25061100721359253, "acc": 0.9132178425788879, "length": 3.5967910289764404, "mode": "test", "epoch": 7}
{"loss": 0.1636594980955124, "acc": 0.9506335258483887, "length": 3.631181001663208, "mode": "train", "epoch": 8}
{"loss": 0.25654226541519165, "acc": 0.9098576307296753, "length": 3.591949462890625, "mode": "test", "epoch": 8}
{"loss": 0.14888997375965118, "acc": 0.9581097960472107, "length": 3.647813320159912, "mode": "train", "epoch": 9}
{"loss": 0.25156736373901367, "acc": 0.9145992398262024, "length": 3.6193981170654297, "mode": "test", "epoch": 9}
{"loss": 0.13503491878509521, "acc": 0.964766800403595, "length": 3.696937322616577, "mode": "train", "epoch": 10}
{"loss": 0.23359829187393188, "acc": 0.9242439866065979, "length": 3.6719751358032227, "mode": "test", "epoch": 10}
{"loss": 0.12362726777791977, "acc": 0.9696484804153442, "length": 3.748084306716919, "mode": "train", "epoch": 11}
{"loss": 0.2371518909931183, "acc": 0.9279898405075073, "length": 3.752600908279419, "mode": "test", "epoch": 11}
{"loss": 0.1159953773021698, "acc": 0.9733673930168152, "length": 3.774449110031128, "mode": "train", "epoch": 12}
{"loss": 0.22647394239902496, "acc": 0.9328311085700989, "length": 3.77152681350708, "mode": "test", "epoch": 12}
{"loss": 0.10994520038366318, "acc": 0.9759593605995178, "length": 3.7683095932006836, "mode": "train", "epoch": 13}
{"loss": 0.24458639323711395, "acc": 0.9304973483085632, "length": 3.808258533477783, "mode": "test", "epoch": 13}
{"loss": 0.10611267387866974, "acc": 0.9776007533073425, "length": 3.7718303203582764, "mode": "train", "epoch": 14}
{"loss": 0.23398229479789734, "acc": 0.9321702718734741, "length": 3.7880520820617676, "mode": "test", "epoch": 14}
{"loss": 0.10105868428945541, "acc": 0.9795277714729309, "length": 3.7678027153015137, "mode": "train", "epoch": 15}
{"loss": 0.2352108657360077, "acc": 0.9377896785736084, "length": 3.784771203994751, "mode": "test", "epoch": 15}
{"loss": 0.09956763684749603, "acc": 0.9800097346305847, "length": 3.7552568912506104, "mode": "train", "epoch": 16}
{"loss": 0.2277962863445282, "acc": 0.9334167242050171, "length": 3.7487595081329346, "mode": "test", "epoch": 16}
{"loss": 0.0957830399274826, "acc": 0.9812943339347839, "length": 3.746159076690674, "mode": "train", "epoch": 17}
{"loss": 0.21866221725940704, "acc": 0.9385867714881897, "length": 3.7614035606384277, "mode": "test", "epoch": 17}
{"loss": 0.09597199410200119, "acc": 0.9811638593673706, "length": 3.7384917736053467, "mode": "train", "epoch": 18}
{"loss": 0.22839699685573578, "acc": 0.9388396739959717, "length": 3.750040054321289, "mode": "test", "epoch": 18}
{"loss": 0.09356247633695602, "acc": 0.9816214442253113, "length": 3.727510690689087, "mode": "train", "epoch": 19}
{"loss": 0.23368582129478455, "acc": 0.9334537982940674, "length": 3.765004873275757, "mode": "test", "epoch": 19}
{"loss": 0.08964791148900986, "acc": 0.9817059636116028, "length": 3.7415623664855957, "mode": "train", "epoch": 20}
{"loss": 0.2643466591835022, "acc": 0.9287224411964417, "length": 3.7514405250549316, "mode": "test", "epoch": 20}
{"loss": 0.08379912376403809, "acc": 0.9834060072898865, "length": 3.728889226913452, "mode": "train", "epoch": 21}
{"loss": 0.24445557594299316, "acc": 0.9355011582374573, "length": 3.756442070007324, "mode": "test", "epoch": 21}
{"loss": 0.07995299994945526, "acc": 0.9850397109985352, "length": 3.736534833908081, "mode": "train", "epoch": 22}
{"loss": 0.24440063536167145, "acc": 0.9365784525871277, "length": 3.7819302082061768, "mode": "test", "epoch": 22}
{"loss": 0.07826980948448181, "acc": 0.9856616258621216, "length": 3.7326250076293945, "mode": "train", "epoch": 23}
{"loss": 0.2429637461900711, "acc": 0.9366169571876526, "length": 3.7592430114746094, "mode": "test", "epoch": 23}
{"loss": 0.07734892517328262, "acc": 0.9860929250717163, "length": 3.7404048442840576, "mode": "train", "epoch": 24}
{"loss": 0.2509651780128479, "acc": 0.93192058801651, "length": 3.682138204574585, "mode": "test", "epoch": 24}
{"loss": 0.07607374340295792, "acc": 0.9865624904632568, "length": 3.7366323471069336, "mode": "train", "epoch": 25}
{"loss": 0.2472587525844574, "acc": 0.9314776062965393, "length": 3.7219109535217285, "mode": "test", "epoch": 25}
{"loss": 0.07480879873037338, "acc": 0.9869164228439331, "length": 3.7375011444091797, "mode": "train", "epoch": 26}
{"loss": 0.24502532184123993, "acc": 0.9348757863044739, "length": 3.739436626434326, "mode": "test", "epoch": 26}
{"loss": 0.07497965544462204, "acc": 0.9866988062858582, "length": 3.743415355682373, "mode": "train", "epoch": 27}
{"loss": 0.27855488657951355, "acc": 0.9293813109397888, "length": 3.762523889541626, "mode": "test", "epoch": 27}
{"loss": 0.07196610420942307, "acc": 0.9872786402702332, "length": 3.7533674240112305, "mode": "train", "epoch": 28}
{"loss": 0.261467844247818, "acc": 0.9292065501213074, "length": 3.742037534713745, "mode": "test", "epoch": 28}
{"loss": 0.07056174427270889, "acc": 0.9875204563140869, "length": 3.738971471786499, "mode": "train", "epoch": 29}
{"loss": 0.24518103897571564, "acc": 0.9323360919952393, "length": 3.7951743602752686, "mode": "test", "epoch": 29}
{"loss": 0.07046795636415482, "acc": 0.9874556660652161, "length": 3.7451655864715576, "mode": "train", "epoch": 30}
{"loss": 0.24951863288879395, "acc": 0.9275401830673218, "length": 3.736715793609619, "mode": "test", "epoch": 30}
{"loss": 0.06834394484758377, "acc": 0.9881669878959656, "length": 3.739211082458496, "mode": "train", "epoch": 31}
{"loss": 0.22759124636650085, "acc": 0.9372856616973877, "length": 3.7315540313720703, "mode": "test", "epoch": 31}
{"loss": 0.06780809164047241, "acc": 0.988264262676239, "length": 3.7513086795806885, "mode": "train", "epoch": 32}
{"loss": 0.24159395694732666, "acc": 0.9349097013473511, "length": 3.6881401538848877, "mode": "test", "epoch": 32}
{"loss": 0.06683860719203949, "acc": 0.9884856939315796, "length": 3.7573204040527344, "mode": "train", "epoch": 33}
{"loss": 0.2339446097612381, "acc": 0.9392295479774475, "length": 3.7506401538848877, "mode": "test", "epoch": 33}
{"loss": 0.06580769270658493, "acc": 0.9886918663978577, "length": 3.7668087482452393, "mode": "train", "epoch": 34}
{"loss": 0.22610417008399963, "acc": 0.9408209323883057, "length": 3.7681658267974854, "mode": "test", "epoch": 34}
{"loss": 0.06227791681885719, "acc": 0.9892696142196655, "length": 3.761427879333496, "mode": "train", "epoch": 35}
{"loss": 0.27619993686676025, "acc": 0.9211010932922363, "length": 3.7908129692077637, "mode": "test", "epoch": 35}
{"loss": 0.0619831345975399, "acc": 0.9882283210754395, "length": 3.794414520263672, "mode": "train", "epoch": 36}
{"loss": 0.29272735118865967, "acc": 0.9142357707023621, "length": 3.8091788291931152, "mode": "test", "epoch": 36}
{"loss": 0.056486405432224274, "acc": 0.9894911050796509, "length": 3.8280396461486816, "mode": "train", "epoch": 37}
{"loss": 0.2657319903373718, "acc": 0.9234845042228699, "length": 3.885563373565674, "mode": "test", "epoch": 37}
{"loss": 0.05235281214118004, "acc": 0.9908439517021179, "length": 3.8237226009368896, "mode": "train", "epoch": 38}
{"loss": 0.25891852378845215, "acc": 0.9204953908920288, "length": 3.836787700653076, "mode": "test", "epoch": 38}
{"loss": 0.04914754629135132, "acc": 0.9918944835662842, "length": 3.820847511291504, "mode": "train", "epoch": 39}
{"loss": 0.3033573627471924, "acc": 0.9064338207244873, "length": 3.776808500289917, "mode": "test", "epoch": 39}
{"loss": 0.04450647160410881, "acc": 0.993131697177887, "length": 3.8160197734832764, "mode": "train", "epoch": 40}
{"loss": 0.275639146566391, "acc": 0.9167411923408508, "length": 3.8209426403045654, "mode": "test", "epoch": 40}
{"loss": 0.047323741018772125, "acc": 0.9924077391624451, "length": 3.8038229942321777, "mode": "train", "epoch": 41}
{"loss": 0.24380332231521606, "acc": 0.9393466711044312, "length": 3.785731315612793, "mode": "test", "epoch": 41}
{"loss": 0.04254726320505142, "acc": 0.9940077066421509, "length": 3.8140504360198975, "mode": "train", "epoch": 42}
{"loss": 0.26206174492836, "acc": 0.9284929633140564, "length": 3.8005361557006836, "mode": "test", "epoch": 42}
{"loss": 0.04216015338897705, "acc": 0.9939925670623779, "length": 3.7979204654693604, "mode": "train", "epoch": 43}
{"loss": 0.3012596368789673, "acc": 0.9171757102012634, "length": 3.7566821575164795, "mode": "test", "epoch": 43}
{"loss": 0.04293178766965866, "acc": 0.9940342307090759, "length": 3.802746534347534, "mode": "train", "epoch": 44}
{"loss": 0.26380088925361633, "acc": 0.9257975816726685, "length": 3.805457830429077, "mode": "test", "epoch": 44}
{"loss": 0.040362805128097534, "acc": 0.9947308301925659, "length": 3.8098506927490234, "mode": "train", "epoch": 45}
{"loss": 0.37608835101127625, "acc": 0.8941238522529602, "length": 3.8149406909942627, "mode": "test", "epoch": 45}
{"loss": 0.0406598225235939, "acc": 0.9945586919784546, "length": 3.81363582611084, "mode": "train", "epoch": 46}
{"loss": 0.28787124156951904, "acc": 0.9263851642608643, "length": 3.7890524864196777, "mode": "test", "epoch": 46}
{"loss": 0.0405888594686985, "acc": 0.9946492910385132, "length": 3.8183529376983643, "mode": "train", "epoch": 47}
{"loss": 0.29913678765296936, "acc": 0.9148665070533752, "length": 3.8229434490203857, "mode": "test", "epoch": 47}
{"loss": 0.041256215423345566, "acc": 0.9944112300872803, "length": 3.8072869777679443, "mode": "train", "epoch": 48}
{"loss": 0.2565821707248688, "acc": 0.9342014193534851, "length": 3.7844510078430176, "mode": "test", "epoch": 48}
{"loss": 0.03830541670322418, "acc": 0.9952053427696228, "length": 3.7905685901641846, "mode": "train", "epoch": 49}
{"loss": 0.30402618646621704, "acc": 0.913414478302002, "length": 3.789492607116699, "mode": "test", "epoch": 49}
{"loss": 0.04145710915327072, "acc": 0.9943557977676392, "length": 3.8087756633758545, "mode": "train", "epoch": 50}
{"loss": 0.24781545996665955, "acc": 0.943176805973053, "length": 3.857154369354248, "mode": "test", "epoch": 50}
{"loss": 0.040805067867040634, "acc": 0.9944764375686646, "length": 3.826070547103882, "mode": "train", "epoch": 51}
{"loss": 0.2860078513622284, "acc": 0.9208915829658508, "length": 3.786491632461548, "mode": "test", "epoch": 51}
{"loss": 0.036979660391807556, "acc": 0.9956730604171753, "length": 3.819016456604004, "mode": "train", "epoch": 52}
{"loss": 0.24986706674098969, "acc": 0.9345532059669495, "length": 3.821502923965454, "mode": "test", "epoch": 52}
{"loss": 0.03985052555799484, "acc": 0.994867205619812, "length": 3.842653274536133, "mode": "train", "epoch": 53}
{"loss": 0.2511577010154724, "acc": 0.9353587031364441, "length": 3.846590995788574, "mode": "test", "epoch": 53}
{"loss": 0.04068600758910179, "acc": 0.9946421980857849, "length": 3.829657793045044, "mode": "train", "epoch": 54}
{"loss": 0.25595805048942566, "acc": 0.9338061809539795, "length": 3.8511123657226562, "mode": "test", "epoch": 54}
{"loss": 0.04109085351228714, "acc": 0.9945192337036133, "length": 3.825787305831909, "mode": "train", "epoch": 55}
{"loss": 0.2752978503704071, "acc": 0.928571343421936, "length": 3.854673385620117, "mode": "test", "epoch": 55}
{"loss": 0.039758212864398956, "acc": 0.9949873089790344, "length": 3.830258846282959, "mode": "train", "epoch": 56}
{"loss": 0.2853180170059204, "acc": 0.9166590571403503, "length": 3.8235435485839844, "mode": "test", "epoch": 56}
{"loss": 0.03953578695654869, "acc": 0.9948869347572327, "length": 3.845242977142334, "mode": "train", "epoch": 57}
{"loss": 0.246077299118042, "acc": 0.9277400970458984, "length": 3.8783211708068848, "mode": "test", "epoch": 57}
{"loss": 0.04431668668985367, "acc": 0.9935638904571533, "length": 3.8495407104492188, "mode": "train", "epoch": 58}
{"loss": 0.27995565533638, "acc": 0.9214716553688049, "length": 3.817941665649414, "mode": "test", "epoch": 58}
{"loss": 0.038756754249334335, "acc": 0.9951916933059692, "length": 3.8437867164611816, "mode": "train", "epoch": 59}
{"loss": 0.2501460313796997, "acc": 0.931405246257782, "length": 3.835787534713745, "mode": "test", "epoch": 59}
{"loss": 0.03924626111984253, "acc": 0.9950203895568848, "length": 3.838348627090454, "mode": "train", "epoch": 60}
{"loss": 0.23825596272945404, "acc": 0.9380701780319214, "length": 3.8263845443725586, "mode": "test", "epoch": 60}
test accuracy: 0.9326813817024231
