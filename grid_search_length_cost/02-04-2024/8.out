ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.6979762315750122, "acc": 0.5231268405914307, "length": 3.863654613494873, "mode": "train", "epoch": 1}
{"loss": 0.6881601810455322, "acc": 0.5501410961151123, "length": 1.0625, "mode": "test", "epoch": 1}
{"loss": 0.6248197555541992, "acc": 0.6564082503318787, "length": 3.541943311691284, "mode": "train", "epoch": 2}
{"loss": 0.6070476174354553, "acc": 0.683018684387207, "length": 2.024305582046509, "mode": "test", "epoch": 2}
{"loss": 0.5387877821922302, "acc": 0.732789158821106, "length": 3.6144158840179443, "mode": "train", "epoch": 3}
{"loss": 0.630329966545105, "acc": 0.7358696460723877, "length": 6.982638835906982, "mode": "test", "epoch": 3}
{"loss": 0.4495362639427185, "acc": 0.7935625910758972, "length": 4.496486186981201, "mode": "train", "epoch": 4}
{"loss": 0.5325832962989807, "acc": 0.7672771215438843, "length": 7.33680534362793, "mode": "test", "epoch": 4}
{"loss": 0.40301018953323364, "acc": 0.8301609754562378, "length": 4.896503925323486, "mode": "train", "epoch": 5}
{"loss": 0.4973818063735962, "acc": 0.7882053256034851, "length": 7.80381965637207, "mode": "test", "epoch": 5}
{"loss": 0.3747645914554596, "acc": 0.8434150815010071, "length": 4.978856086730957, "mode": "train", "epoch": 6}
{"loss": 0.39935994148254395, "acc": 0.8291477560997009, "length": 4.434027671813965, "mode": "test", "epoch": 6}
{"loss": 0.34970560669898987, "acc": 0.8559344410896301, "length": 5.303323268890381, "mode": "train", "epoch": 7}
{"loss": 0.3707270324230194, "acc": 0.8446858525276184, "length": 4.965277671813965, "mode": "test", "epoch": 7}
{"loss": 0.328996866941452, "acc": 0.8689255118370056, "length": 5.424117565155029, "mode": "train", "epoch": 8}
{"loss": 0.3809272050857544, "acc": 0.8428520560264587, "length": 6.810763835906982, "mode": "test", "epoch": 8}
{"loss": 0.31252729892730713, "acc": 0.8752504587173462, "length": 5.8268351554870605, "mode": "train", "epoch": 9}
{"loss": 0.34390074014663696, "acc": 0.8645291328430176, "length": 6.27430534362793, "mode": "test", "epoch": 9}
{"loss": 0.29949331283569336, "acc": 0.8834616541862488, "length": 5.857606887817383, "mode": "train", "epoch": 10}
{"loss": 0.31272757053375244, "acc": 0.8757595419883728, "length": 5.901041507720947, "mode": "test", "epoch": 10}
{"loss": 0.2861959636211395, "acc": 0.8910244107246399, "length": 5.812420845031738, "mode": "train", "epoch": 11}
{"loss": 0.30538874864578247, "acc": 0.8797146677970886, "length": 6.050347328186035, "mode": "test", "epoch": 11}
{"loss": 0.2718925178050995, "acc": 0.8975138068199158, "length": 5.891623497009277, "mode": "train", "epoch": 12}
{"loss": 0.3044709861278534, "acc": 0.8803874254226685, "length": 6.986111164093018, "mode": "test", "epoch": 12}
{"loss": 0.25842657685279846, "acc": 0.9038845300674438, "length": 6.227534770965576, "mode": "train", "epoch": 13}
{"loss": 0.29770252108573914, "acc": 0.8884901404380798, "length": 7.97743034362793, "mode": "test", "epoch": 13}
{"loss": 0.24209333956241608, "acc": 0.9116430878639221, "length": 6.252494812011719, "mode": "train", "epoch": 14}
{"loss": 0.28526556491851807, "acc": 0.8898627161979675, "length": 7.215277671813965, "mode": "test", "epoch": 14}
{"loss": 0.22662122547626495, "acc": 0.9198716878890991, "length": 6.316182613372803, "mode": "train", "epoch": 15}
{"loss": 0.25448694825172424, "acc": 0.9067299962043762, "length": 7.744791507720947, "mode": "test", "epoch": 15}
{"loss": 0.21589355170726776, "acc": 0.9245588779449463, "length": 6.14571475982666, "mode": "train", "epoch": 16}
{"loss": 0.2563835382461548, "acc": 0.9015896320343018, "length": 7.671875, "mode": "test", "epoch": 16}
{"loss": 0.2099924087524414, "acc": 0.9276719689369202, "length": 6.130772590637207, "mode": "train", "epoch": 17}
{"loss": 0.23931461572647095, "acc": 0.9108561277389526, "length": 8.71701431274414, "mode": "test", "epoch": 17}
{"loss": 0.19895493984222412, "acc": 0.9321459531784058, "length": 6.279317378997803, "mode": "train", "epoch": 18}
{"loss": 0.2469387650489807, "acc": 0.9144747853279114, "length": 6.89756965637207, "mode": "test", "epoch": 18}
{"loss": 0.19289346039295197, "acc": 0.9342305064201355, "length": 6.1757731437683105, "mode": "train", "epoch": 19}
{"loss": 0.2247200608253479, "acc": 0.9170708060264587, "length": 5.798611164093018, "mode": "test", "epoch": 19}
{"loss": 0.18477463722229004, "acc": 0.9373167157173157, "length": 6.1632080078125, "mode": "train", "epoch": 20}
{"loss": 0.215298593044281, "acc": 0.9214789271354675, "length": 6.661458492279053, "mode": "test", "epoch": 20}
{"loss": 0.17862634360790253, "acc": 0.9402900338172913, "length": 6.10383415222168, "mode": "train", "epoch": 21}
{"loss": 0.20720401406288147, "acc": 0.9270318150520325, "length": 6.111111164093018, "mode": "test", "epoch": 21}
{"loss": 0.1655409187078476, "acc": 0.9447280168533325, "length": 6.2542500495910645, "mode": "train", "epoch": 22}
{"loss": 0.20454518496990204, "acc": 0.9274413585662842, "length": 6.192708492279053, "mode": "test", "epoch": 22}
{"loss": 0.1584925800561905, "acc": 0.947772204875946, "length": 6.000535011291504, "mode": "train", "epoch": 23}
{"loss": 0.200718492269516, "acc": 0.9341986179351807, "length": 6.765625, "mode": "test", "epoch": 23}
{"loss": 0.14711084961891174, "acc": 0.9522207975387573, "length": 6.428492546081543, "mode": "train", "epoch": 24}
{"loss": 0.204549178481102, "acc": 0.9321749210357666, "length": 7.119791507720947, "mode": "test", "epoch": 24}
{"loss": 0.13839849829673767, "acc": 0.9566124081611633, "length": 6.384605884552002, "mode": "train", "epoch": 25}
{"loss": 0.17788872122764587, "acc": 0.9392117261886597, "length": 5.795138835906982, "mode": "test", "epoch": 25}
{"loss": 0.13099706172943115, "acc": 0.9598702192306519, "length": 6.240660667419434, "mode": "train", "epoch": 26}
{"loss": 0.16011019051074982, "acc": 0.9457709193229675, "length": 6.201388835906982, "mode": "test", "epoch": 26}
{"loss": 0.12026184797286987, "acc": 0.9641036987304688, "length": 6.312652111053467, "mode": "train", "epoch": 27}
{"loss": 0.15710724890232086, "acc": 0.9484564661979675, "length": 6.145833492279053, "mode": "test", "epoch": 27}
{"loss": 0.11110760271549225, "acc": 0.9675483107566833, "length": 6.2922186851501465, "mode": "train", "epoch": 28}
{"loss": 0.1482602208852768, "acc": 0.9508626461029053, "length": 5.947916507720947, "mode": "test", "epoch": 28}
{"loss": 0.10637333244085312, "acc": 0.9684018492698669, "length": 6.3164215087890625, "mode": "train", "epoch": 29}
{"loss": 0.15332669019699097, "acc": 0.9518202543258667, "length": 6.963541507720947, "mode": "test", "epoch": 29}
{"loss": 0.10145840048789978, "acc": 0.9705705642700195, "length": 6.346894264221191, "mode": "train", "epoch": 30}
{"loss": 0.13816873729228973, "acc": 0.9549235105514526, "length": 6.0625, "mode": "test", "epoch": 30}
{"loss": 0.09265977144241333, "acc": 0.9744760990142822, "length": 6.35602331161499, "mode": "train", "epoch": 31}
{"loss": 0.13437339663505554, "acc": 0.9584066867828369, "length": 6.645833492279053, "mode": "test", "epoch": 31}
{"loss": 0.0903751403093338, "acc": 0.9744195938110352, "length": 6.574516773223877, "mode": "train", "epoch": 32}
{"loss": 0.12218703329563141, "acc": 0.9606227874755859, "length": 6.109375, "mode": "test", "epoch": 32}
{"loss": 0.08469737321138382, "acc": 0.977507472038269, "length": 6.304760932922363, "mode": "train", "epoch": 33}
{"loss": 0.12774908542633057, "acc": 0.9591363072395325, "length": 6.689236164093018, "mode": "test", "epoch": 33}
{"loss": 0.07902784645557404, "acc": 0.9790850877761841, "length": 6.5497612953186035, "mode": "train", "epoch": 34}
{"loss": 0.12341385334730148, "acc": 0.9644314646720886, "length": 6.421875, "mode": "test", "epoch": 34}
{"loss": 0.07448217272758484, "acc": 0.9806162714958191, "length": 6.40879487991333, "mode": "train", "epoch": 35}
{"loss": 0.12271629273891449, "acc": 0.9645399451255798, "length": 6.154513835906982, "mode": "test", "epoch": 35}
{"loss": 0.07070772349834442, "acc": 0.9816972017288208, "length": 6.272242546081543, "mode": "train", "epoch": 36}
{"loss": 0.10932355374097824, "acc": 0.9686034321784973, "length": 6.388888835906982, "mode": "test", "epoch": 36}
{"loss": 0.06829085946083069, "acc": 0.9822463989257812, "length": 6.497082710266113, "mode": "train", "epoch": 37}
{"loss": 0.10644970089197159, "acc": 0.9685791730880737, "length": 6.16319465637207, "mode": "test", "epoch": 37}
{"loss": 0.06312626600265503, "acc": 0.9847148060798645, "length": 6.240947246551514, "mode": "train", "epoch": 38}
{"loss": 0.11448843032121658, "acc": 0.9690783023834229, "length": 6.409722328186035, "mode": "test", "epoch": 38}
{"loss": 0.058720238506793976, "acc": 0.986253559589386, "length": 6.255517482757568, "mode": "train", "epoch": 39}
{"loss": 0.10442255437374115, "acc": 0.9708930253982544, "length": 6.078125, "mode": "test", "epoch": 39}
{"loss": 0.05718737840652466, "acc": 0.9875385165214539, "length": 6.3664870262146, "mode": "train", "epoch": 40}
{"loss": 0.1101779118180275, "acc": 0.9661457538604736, "length": 5.748263835906982, "mode": "test", "epoch": 40}
{"loss": 0.06154165044426918, "acc": 0.984466552734375, "length": 6.5299391746521, "mode": "train", "epoch": 41}
{"loss": 0.10639394819736481, "acc": 0.9702664613723755, "length": 5.970486164093018, "mode": "test", "epoch": 41}
{"loss": 0.0576653853058815, "acc": 0.9860495328903198, "length": 6.614187717437744, "mode": "train", "epoch": 42}
{"loss": 0.1139654740691185, "acc": 0.9683837890625, "length": 6.515625, "mode": "test", "epoch": 42}
{"loss": 0.05877864733338356, "acc": 0.9859472513198853, "length": 6.448413848876953, "mode": "train", "epoch": 43}
{"loss": 0.09877882897853851, "acc": 0.9703911542892456, "length": 6.96006965637207, "mode": "test", "epoch": 43}
{"loss": 0.05202187970280647, "acc": 0.9872376918792725, "length": 6.386083602905273, "mode": "train", "epoch": 44}
{"loss": 0.09239593148231506, "acc": 0.9750487208366394, "length": 6.123263835906982, "mode": "test", "epoch": 44}
{"loss": 0.04395311325788498, "acc": 0.9912375807762146, "length": 6.323731422424316, "mode": "train", "epoch": 45}
{"loss": 0.0838099792599678, "acc": 0.9774658679962158, "length": 6.171875, "mode": "test", "epoch": 45}
{"loss": 0.03937558829784393, "acc": 0.9922983646392822, "length": 6.148695468902588, "mode": "train", "epoch": 46}
{"loss": 0.08645478636026382, "acc": 0.9797309041023254, "length": 6.177083492279053, "mode": "test", "epoch": 46}
{"loss": 0.04334641247987747, "acc": 0.9908234477043152, "length": 6.116498947143555, "mode": "train", "epoch": 47}
{"loss": 0.08579475432634354, "acc": 0.9773329496383667, "length": 5.986111164093018, "mode": "test", "epoch": 47}
{"loss": 0.03978936746716499, "acc": 0.9918003678321838, "length": 6.236822605133057, "mode": "train", "epoch": 48}
{"loss": 0.07345549762248993, "acc": 0.9833793640136719, "length": 6.050347328186035, "mode": "test", "epoch": 48}
{"loss": 0.04075874388217926, "acc": 0.9913826584815979, "length": 6.113219738006592, "mode": "train", "epoch": 49}
{"loss": 0.06898286193609238, "acc": 0.9795626401901245, "length": 5.965277671813965, "mode": "test", "epoch": 49}
{"loss": 0.06414993107318878, "acc": 0.9838865399360657, "length": 6.495037078857422, "mode": "train", "epoch": 50}
{"loss": 0.07988258451223373, "acc": 0.9804605841636658, "length": 6.00694465637207, "mode": "test", "epoch": 50}
{"loss": 0.04112451151013374, "acc": 0.9911350011825562, "length": 6.322815418243408, "mode": "train", "epoch": 51}
{"loss": 0.07061883807182312, "acc": 0.9800130128860474, "length": 6.355902671813965, "mode": "test", "epoch": 51}
{"loss": 0.0344514362514019, "acc": 0.9934993982315063, "length": 6.308891773223877, "mode": "train", "epoch": 52}
{"loss": 0.05528479069471359, "acc": 0.9847222566604614, "length": 5.875, "mode": "test", "epoch": 52}
{"loss": 0.030402204021811485, "acc": 0.9947001934051514, "length": 6.109589576721191, "mode": "train", "epoch": 53}
{"loss": 0.04439316689968109, "acc": 0.9888129830360413, "length": 5.75, "mode": "test", "epoch": 53}
{"loss": 0.0328846201300621, "acc": 0.9938546419143677, "length": 6.000072956085205, "mode": "train", "epoch": 54}
{"loss": 0.056519076228141785, "acc": 0.9856932759284973, "length": 5.99305534362793, "mode": "test", "epoch": 54}
{"loss": 0.030514853075146675, "acc": 0.9941858053207397, "length": 6.319332599639893, "mode": "train", "epoch": 55}
{"loss": 0.053391966968774796, "acc": 0.9844998121261597, "length": 5.800347328186035, "mode": "test", "epoch": 55}
{"loss": 0.027265314012765884, "acc": 0.9957697987556458, "length": 5.940598964691162, "mode": "train", "epoch": 56}
{"loss": 0.05228631943464279, "acc": 0.987060546875, "length": 5.862847328186035, "mode": "test", "epoch": 56}
{"loss": 0.023883473128080368, "acc": 0.9970489144325256, "length": 5.922676086425781, "mode": "train", "epoch": 57}
{"loss": 0.041018612682819366, "acc": 0.9906927943229675, "length": 5.75694465637207, "mode": "test", "epoch": 57}
{"loss": 0.022803762927651405, "acc": 0.9971466064453125, "length": 5.865666389465332, "mode": "train", "epoch": 58}
{"loss": 0.044715479016304016, "acc": 0.9893609285354614, "length": 5.661458492279053, "mode": "test", "epoch": 58}
{"loss": 0.022804420441389084, "acc": 0.9970545768737793, "length": 5.8241801261901855, "mode": "train", "epoch": 59}
{"loss": 0.04635263979434967, "acc": 0.9895913600921631, "length": 5.565972328186035, "mode": "test", "epoch": 59}
{"loss": 0.03460123389959335, "acc": 0.9919904470443726, "length": 5.8557233810424805, "mode": "train", "epoch": 60}
{"loss": 0.05286188796162605, "acc": 0.9846570491790771, "length": 5.612847328186035, "mode": "test", "epoch": 60}
test accuracy: 0.8105112910270691
