ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.4942128360271454, "acc": 0.7405472993850708, "length": 1.962333083152771, "mode": "train", "epoch": 1}
{"loss": 0.4137743413448334, "acc": 0.8107450008392334, "length": 2.219831705093384, "mode": "test", "epoch": 1}
{"loss": 0.3626566231250763, "acc": 0.852742612361908, "length": 2.453643321990967, "mode": "train", "epoch": 2}
{"loss": 0.3703485429286957, "acc": 0.8476105332374573, "length": 2.579326868057251, "mode": "test", "epoch": 2}
{"loss": 0.3289923071861267, "acc": 0.8734200596809387, "length": 2.6393966674804688, "mode": "train", "epoch": 3}
{"loss": 0.3599036931991577, "acc": 0.8493441343307495, "length": 2.595512866973877, "mode": "test", "epoch": 3}
{"loss": 0.3212684392929077, "acc": 0.8747920393943787, "length": 2.610990524291992, "mode": "train", "epoch": 4}
{"loss": 0.3572258949279785, "acc": 0.8511858582496643, "length": 2.6181089878082275, "mode": "test", "epoch": 4}
{"loss": 0.31346395611763, "acc": 0.8773021697998047, "length": 2.6926233768463135, "mode": "train", "epoch": 5}
{"loss": 0.36354944109916687, "acc": 0.8457859754562378, "length": 2.792187452316284, "mode": "test", "epoch": 5}
{"loss": 0.27628451585769653, "acc": 0.9020299911499023, "length": 3.131223201751709, "mode": "train", "epoch": 6}
{"loss": 0.3575448989868164, "acc": 0.8528246879577637, "length": 3.119671583175659, "mode": "test", "epoch": 6}
{"loss": 0.25059598684310913, "acc": 0.919033408164978, "length": 3.5583674907684326, "mode": "train", "epoch": 7}
{"loss": 0.32271453738212585, "acc": 0.8807653188705444, "length": 3.6131811141967773, "mode": "test", "epoch": 7}
{"loss": 0.23919224739074707, "acc": 0.9247496128082275, "length": 3.6229770183563232, "mode": "train", "epoch": 8}
{"loss": 0.2936238646507263, "acc": 0.8983027338981628, "length": 3.5304486751556396, "mode": "test", "epoch": 8}
{"loss": 0.23467910289764404, "acc": 0.9262893199920654, "length": 3.5571579933166504, "mode": "train", "epoch": 9}
{"loss": 0.2806212604045868, "acc": 0.9020373225212097, "length": 3.5002403259277344, "mode": "test", "epoch": 9}
{"loss": 0.2284248173236847, "acc": 0.9282515048980713, "length": 3.5419464111328125, "mode": "train", "epoch": 10}
{"loss": 0.2826414406299591, "acc": 0.9009467363357544, "length": 3.5225160121917725, "mode": "test", "epoch": 10}
{"loss": 0.22474411129951477, "acc": 0.9295514225959778, "length": 3.542529821395874, "mode": "train", "epoch": 11}
{"loss": 0.2729697525501251, "acc": 0.909041166305542, "length": 3.510777235031128, "mode": "test", "epoch": 11}
{"loss": 0.21203438937664032, "acc": 0.934624433517456, "length": 3.544285774230957, "mode": "train", "epoch": 12}
{"loss": 0.28602510690689087, "acc": 0.8927133679389954, "length": 3.5375800132751465, "mode": "test", "epoch": 12}
{"loss": 0.1976477950811386, "acc": 0.9420851469039917, "length": 3.5473175048828125, "mode": "train", "epoch": 13}
{"loss": 0.27459123730659485, "acc": 0.9019055366516113, "length": 3.523317337036133, "mode": "test", "epoch": 13}
{"loss": 0.1932714283466339, "acc": 0.9442481994628906, "length": 3.539393186569214, "mode": "train", "epoch": 14}
{"loss": 0.2933170795440674, "acc": 0.8944570422172546, "length": 3.5189502239227295, "mode": "test", "epoch": 14}
{"loss": 0.1920466423034668, "acc": 0.9450263977050781, "length": 3.542536497116089, "mode": "train", "epoch": 15}
{"loss": 0.29794207215309143, "acc": 0.9016110301017761, "length": 3.5201523303985596, "mode": "test", "epoch": 15}
{"loss": 0.18834160268306732, "acc": 0.9462595582008362, "length": 3.5484232902526855, "mode": "train", "epoch": 16}
{"loss": 0.28226998448371887, "acc": 0.8959162831306458, "length": 3.584054470062256, "mode": "test", "epoch": 16}
{"loss": 0.18549320101737976, "acc": 0.9470576643943787, "length": 3.557297468185425, "mode": "train", "epoch": 17}
{"loss": 0.27233967185020447, "acc": 0.9025834202766418, "length": 3.518749952316284, "mode": "test", "epoch": 17}
{"loss": 0.18055059015750885, "acc": 0.9493454098701477, "length": 3.54388165473938, "mode": "train", "epoch": 18}
{"loss": 0.2958856523036957, "acc": 0.8991239666938782, "length": 3.5154647827148438, "mode": "test", "epoch": 18}
{"loss": 0.17838548123836517, "acc": 0.95030677318573, "length": 3.530118227005005, "mode": "train", "epoch": 19}
{"loss": 0.3138357102870941, "acc": 0.8835757374763489, "length": 3.5471553802490234, "mode": "test", "epoch": 19}
{"loss": 0.17427006363868713, "acc": 0.9522775411605835, "length": 3.537086248397827, "mode": "train", "epoch": 20}
{"loss": 0.2824788987636566, "acc": 0.900675356388092, "length": 3.5362179279327393, "mode": "test", "epoch": 20}
{"loss": 0.1731673777103424, "acc": 0.9527941942214966, "length": 3.5395195484161377, "mode": "train", "epoch": 21}
{"loss": 0.3020891547203064, "acc": 0.8929520845413208, "length": 3.5352563858032227, "mode": "test", "epoch": 21}
{"loss": 0.17161346971988678, "acc": 0.9533877372741699, "length": 3.5338428020477295, "mode": "train", "epoch": 22}
{"loss": 0.29297056794166565, "acc": 0.9025243520736694, "length": 3.53000807762146, "mode": "test", "epoch": 22}
{"loss": 0.1719944030046463, "acc": 0.9532816410064697, "length": 3.5535624027252197, "mode": "train", "epoch": 23}
{"loss": 0.27907076478004456, "acc": 0.9056779742240906, "length": 3.5261619091033936, "mode": "test", "epoch": 23}
{"loss": 0.16880345344543457, "acc": 0.9546511173248291, "length": 3.5397393703460693, "mode": "train", "epoch": 24}
{"loss": 0.2826015055179596, "acc": 0.90362548828125, "length": 3.551201820373535, "mode": "test", "epoch": 24}
{"loss": 0.1683536171913147, "acc": 0.9548116326332092, "length": 3.538616895675659, "mode": "train", "epoch": 25}
{"loss": 0.2706353962421417, "acc": 0.9109349846839905, "length": 3.5422675609588623, "mode": "test", "epoch": 25}
{"loss": 0.166651651263237, "acc": 0.9556758999824524, "length": 3.5359110832214355, "mode": "train", "epoch": 26}
{"loss": 0.27660104632377625, "acc": 0.9108448028564453, "length": 3.525320529937744, "mode": "test", "epoch": 26}
{"loss": 0.1666484773159027, "acc": 0.9558206796646118, "length": 3.5368285179138184, "mode": "train", "epoch": 27}
{"loss": 0.32659846544265747, "acc": 0.8975505828857422, "length": 3.5358974933624268, "mode": "test", "epoch": 27}
{"loss": 0.1660827249288559, "acc": 0.9564551115036011, "length": 3.5400948524475098, "mode": "train", "epoch": 28}
{"loss": 0.26884350180625916, "acc": 0.9083467125892639, "length": 3.5452723503112793, "mode": "test", "epoch": 28}
{"loss": 0.16375909745693207, "acc": 0.9573447108268738, "length": 3.5422263145446777, "mode": "train", "epoch": 29}
{"loss": 0.26804178953170776, "acc": 0.9127892851829529, "length": 3.5339744091033936, "mode": "test", "epoch": 29}
{"loss": 0.16185221076011658, "acc": 0.9579653739929199, "length": 3.537245273590088, "mode": "train", "epoch": 30}
{"loss": 0.31567898392677307, "acc": 0.897369384765625, "length": 3.5321714878082275, "mode": "test", "epoch": 30}
{"loss": 0.16042214632034302, "acc": 0.9584579467773438, "length": 3.541196584701538, "mode": "train", "epoch": 31}
{"loss": 0.3051918148994446, "acc": 0.9010589718818665, "length": 3.52099347114563, "mode": "test", "epoch": 31}
{"loss": 0.1592460721731186, "acc": 0.9587246179580688, "length": 3.5429749488830566, "mode": "train", "epoch": 32}
{"loss": 0.3256351947784424, "acc": 0.8950908780097961, "length": 3.536057710647583, "mode": "test", "epoch": 32}
{"loss": 0.15929272770881653, "acc": 0.9585899710655212, "length": 3.54720401763916, "mode": "train", "epoch": 33}
{"loss": 0.273982971906662, "acc": 0.9039924144744873, "length": 3.537299633026123, "mode": "test", "epoch": 33}
{"loss": 0.1581631302833557, "acc": 0.958652138710022, "length": 3.5431015491485596, "mode": "train", "epoch": 34}
{"loss": 0.2836383879184723, "acc": 0.9042845368385315, "length": 3.5394229888916016, "mode": "test", "epoch": 34}
{"loss": 0.1563727855682373, "acc": 0.9589852094650269, "length": 3.5423684120178223, "mode": "train", "epoch": 35}
{"loss": 0.30837830901145935, "acc": 0.8931810259819031, "length": 3.5401041507720947, "mode": "test", "epoch": 35}
{"loss": 0.1554672122001648, "acc": 0.9590882658958435, "length": 3.5444397926330566, "mode": "train", "epoch": 36}
{"loss": 0.2811495363712311, "acc": 0.9083311557769775, "length": 3.5422275066375732, "mode": "test", "epoch": 36}
{"loss": 0.15389297902584076, "acc": 0.9591681361198425, "length": 3.5417463779449463, "mode": "train", "epoch": 37}
{"loss": 0.2644025683403015, "acc": 0.9086559414863586, "length": 3.5405046939849854, "mode": "test", "epoch": 37}
{"loss": 0.15200847387313843, "acc": 0.9594334959983826, "length": 3.545292377471924, "mode": "train", "epoch": 38}
{"loss": 0.2759762108325958, "acc": 0.9114172458648682, "length": 3.542027235031128, "mode": "test", "epoch": 38}
{"loss": 0.15014229714870453, "acc": 0.9599995017051697, "length": 3.5431666374206543, "mode": "train", "epoch": 39}
{"loss": 0.2912433445453644, "acc": 0.9038786888122559, "length": 3.5392627716064453, "mode": "test", "epoch": 39}
{"loss": 0.14764294028282166, "acc": 0.9607288241386414, "length": 3.5429763793945312, "mode": "train", "epoch": 40}
{"loss": 0.2723940908908844, "acc": 0.9065684080123901, "length": 3.53661847114563, "mode": "test", "epoch": 40}
{"loss": 0.14760419726371765, "acc": 0.9607163071632385, "length": 3.544612407684326, "mode": "train", "epoch": 41}
{"loss": 0.30050185322761536, "acc": 0.8948832154273987, "length": 3.542508125305176, "mode": "test", "epoch": 41}
{"loss": 0.14503484964370728, "acc": 0.961296558380127, "length": 3.5471930503845215, "mode": "train", "epoch": 42}
{"loss": 0.3222755789756775, "acc": 0.8931499719619751, "length": 3.5524840354919434, "mode": "test", "epoch": 42}
{"loss": 0.1456887423992157, "acc": 0.9610077142715454, "length": 3.5529274940490723, "mode": "train", "epoch": 43}
{"loss": 0.27950045466423035, "acc": 0.8980448246002197, "length": 3.5431089401245117, "mode": "test", "epoch": 43}
{"loss": 0.1422894299030304, "acc": 0.9622679948806763, "length": 3.552521228790283, "mode": "train", "epoch": 44}
{"loss": 0.30527305603027344, "acc": 0.8958009481430054, "length": 3.5484375953674316, "mode": "test", "epoch": 44}
{"loss": 0.1417774260044098, "acc": 0.9624621868133545, "length": 3.549386501312256, "mode": "train", "epoch": 45}
{"loss": 0.3152672350406647, "acc": 0.8944124579429626, "length": 3.5453124046325684, "mode": "test", "epoch": 45}
{"loss": 0.13997772336006165, "acc": 0.9629839658737183, "length": 3.5502772331237793, "mode": "train", "epoch": 46}
{"loss": 0.32483863830566406, "acc": 0.8872330784797668, "length": 3.5484776496887207, "mode": "test", "epoch": 46}
{"loss": 0.14010630548000336, "acc": 0.9629073143005371, "length": 3.5489628314971924, "mode": "train", "epoch": 47}
{"loss": 0.2517191767692566, "acc": 0.9162362813949585, "length": 3.546233892440796, "mode": "test", "epoch": 47}
{"loss": 0.1397494077682495, "acc": 0.9628565907478333, "length": 3.549447536468506, "mode": "train", "epoch": 48}
{"loss": 0.31267717480659485, "acc": 0.8897650241851807, "length": 3.5574519634246826, "mode": "test", "epoch": 48}
{"loss": 0.1381649374961853, "acc": 0.9633923768997192, "length": 3.551438331604004, "mode": "train", "epoch": 49}
{"loss": 0.29527023434638977, "acc": 0.892246663570404, "length": 3.5476362705230713, "mode": "test", "epoch": 49}
{"loss": 0.13965488970279694, "acc": 0.9627758860588074, "length": 3.5548524856567383, "mode": "train", "epoch": 50}
{"loss": 0.29194849729537964, "acc": 0.8948644399642944, "length": 3.5556490421295166, "mode": "test", "epoch": 50}
{"loss": 0.1403418481349945, "acc": 0.962099552154541, "length": 3.553753614425659, "mode": "train", "epoch": 51}
{"loss": 0.30626967549324036, "acc": 0.8909659385681152, "length": 3.5542469024658203, "mode": "test", "epoch": 51}
{"loss": 0.1379913091659546, "acc": 0.9629568457603455, "length": 3.555934429168701, "mode": "train", "epoch": 52}
{"loss": 0.28531184792518616, "acc": 0.8981858491897583, "length": 3.5544071197509766, "mode": "test", "epoch": 52}
{"loss": 0.136967733502388, "acc": 0.9633172750473022, "length": 3.557948589324951, "mode": "train", "epoch": 53}
{"loss": 0.32201871275901794, "acc": 0.8845512866973877, "length": 3.549238681793213, "mode": "test", "epoch": 53}
{"loss": 0.1375296711921692, "acc": 0.9629426598548889, "length": 3.5624520778656006, "mode": "train", "epoch": 54}
{"loss": 0.3811019957065582, "acc": 0.8827646374702454, "length": 3.5500800609588623, "mode": "test", "epoch": 54}
{"loss": 0.13702085614204407, "acc": 0.9634135365486145, "length": 3.557709217071533, "mode": "train", "epoch": 55}
{"loss": 0.29953107237815857, "acc": 0.8946417570114136, "length": 3.5530848503112793, "mode": "test", "epoch": 55}
{"loss": 0.13573578000068665, "acc": 0.9634419083595276, "length": 3.5584309101104736, "mode": "train", "epoch": 56}
{"loss": 0.2975409924983978, "acc": 0.8976420760154724, "length": 3.551041603088379, "mode": "test", "epoch": 56}
{"loss": 0.13505545258522034, "acc": 0.9640315771102905, "length": 3.559138774871826, "mode": "train", "epoch": 57}
{"loss": 0.30607300996780396, "acc": 0.8882525563240051, "length": 3.5659053325653076, "mode": "test", "epoch": 57}
{"loss": 0.13464854657649994, "acc": 0.9641925096511841, "length": 3.5607211589813232, "mode": "train", "epoch": 58}
{"loss": 0.29046860337257385, "acc": 0.898344874382019, "length": 3.551081657409668, "mode": "test", "epoch": 58}
{"loss": 0.13452598452568054, "acc": 0.964154839515686, "length": 3.5612902641296387, "mode": "train", "epoch": 59}
{"loss": 0.3333917558193207, "acc": 0.8794698715209961, "length": 3.5567708015441895, "mode": "test", "epoch": 59}
{"loss": 0.13378390669822693, "acc": 0.964337170124054, "length": 3.563399314880371, "mode": "train", "epoch": 60}
{"loss": 0.308767706155777, "acc": 0.8954624533653259, "length": 3.558974266052246, "mode": "test", "epoch": 60}
test accuracy: 0.8847872614860535
