ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.46781623363494873, "acc": 0.7570081949234009, "length": 2.6062116622924805, "mode": "train", "epoch": 1}
{"loss": 0.3646824359893799, "acc": 0.8530806303024292, "length": 3.641848564147949, "mode": "test", "epoch": 1}
{"loss": 0.263470858335495, "acc": 0.9105459451675415, "length": 4.155135631561279, "mode": "train", "epoch": 2}
{"loss": 0.2927664518356323, "acc": 0.8951067924499512, "length": 4.209082126617432, "mode": "test", "epoch": 2}
{"loss": 0.22142067551612854, "acc": 0.9318020939826965, "length": 4.420464038848877, "mode": "train", "epoch": 3}
{"loss": 0.26240262389183044, "acc": 0.9114916324615479, "length": 4.660421848297119, "mode": "test", "epoch": 3}
{"loss": 0.18914228677749634, "acc": 0.946889340877533, "length": 4.630157470703125, "mode": "train", "epoch": 4}
{"loss": 0.2447938174009323, "acc": 0.9196611046791077, "length": 4.599526405334473, "mode": "test", "epoch": 4}
{"loss": 0.17298176884651184, "acc": 0.9540852308273315, "length": 4.658586025238037, "mode": "train", "epoch": 5}
{"loss": 0.2296563982963562, "acc": 0.9284849762916565, "length": 4.672576904296875, "mode": "test", "epoch": 5}
{"loss": 0.16244453191757202, "acc": 0.9577008485794067, "length": 4.695627212524414, "mode": "train", "epoch": 6}
{"loss": 0.22684346139431, "acc": 0.9281362891197205, "length": 4.724165439605713, "mode": "test", "epoch": 6}
{"loss": 0.14882053434848785, "acc": 0.9617599248886108, "length": 4.8188157081604, "mode": "train", "epoch": 7}
{"loss": 0.22432349622249603, "acc": 0.9279584288597107, "length": 4.918806076049805, "mode": "test", "epoch": 7}
{"loss": 0.1322464793920517, "acc": 0.9670939445495605, "length": 5.109346866607666, "mode": "train", "epoch": 8}
{"loss": 0.23335790634155273, "acc": 0.925938606262207, "length": 5.221919059753418, "mode": "test", "epoch": 8}
{"loss": 0.11676595360040665, "acc": 0.972191572189331, "length": 5.300747394561768, "mode": "train", "epoch": 9}
{"loss": 0.2106313854455948, "acc": 0.9326366186141968, "length": 5.388438701629639, "mode": "test", "epoch": 9}
{"loss": 0.1027379184961319, "acc": 0.97740238904953, "length": 5.4172797203063965, "mode": "train", "epoch": 10}
{"loss": 0.2043410837650299, "acc": 0.9371485114097595, "length": 5.449855804443359, "mode": "test", "epoch": 10}
{"loss": 0.09054756164550781, "acc": 0.9824247360229492, "length": 5.529228210449219, "mode": "train", "epoch": 11}
{"loss": 0.20004399120807648, "acc": 0.9404737949371338, "length": 5.600890636444092, "mode": "test", "epoch": 11}
{"loss": 0.081478551030159, "acc": 0.9857555627822876, "length": 5.594985008239746, "mode": "train", "epoch": 12}
{"loss": 0.21202218532562256, "acc": 0.9356504678726196, "length": 5.53847074508667, "mode": "test", "epoch": 12}
{"loss": 0.07594586908817291, "acc": 0.9880642890930176, "length": 5.6020708084106445, "mode": "train", "epoch": 13}
{"loss": 0.18424460291862488, "acc": 0.9456764459609985, "length": 5.6338653564453125, "mode": "test", "epoch": 13}
{"loss": 0.07086194306612015, "acc": 0.9899358749389648, "length": 5.64682674407959, "mode": "train", "epoch": 14}
{"loss": 0.163465216755867, "acc": 0.9533349871635437, "length": 5.651115417480469, "mode": "test", "epoch": 14}
{"loss": 0.0673590898513794, "acc": 0.9910610318183899, "length": 5.640168190002441, "mode": "train", "epoch": 15}
{"loss": 0.15592944622039795, "acc": 0.9591971039772034, "length": 5.645178318023682, "mode": "test", "epoch": 15}
{"loss": 0.06484360247850418, "acc": 0.9918555021286011, "length": 5.597195148468018, "mode": "train", "epoch": 16}
{"loss": 0.17639967799186707, "acc": 0.9502285122871399, "length": 5.548379421234131, "mode": "test", "epoch": 16}
{"loss": 0.0667598769068718, "acc": 0.9910793304443359, "length": 5.602133750915527, "mode": "train", "epoch": 17}
{"loss": 0.17957015335559845, "acc": 0.9508464932441711, "length": 5.54119873046875, "mode": "test", "epoch": 17}
{"loss": 0.060885459184646606, "acc": 0.9929031729698181, "length": 5.55501651763916, "mode": "train", "epoch": 18}
{"loss": 0.1566353142261505, "acc": 0.9616315364837646, "length": 5.701861381530762, "mode": "test", "epoch": 18}
{"loss": 0.060988448560237885, "acc": 0.99275803565979, "length": 5.593593597412109, "mode": "train", "epoch": 19}
{"loss": 0.16455061733722687, "acc": 0.9593316316604614, "length": 5.620426654815674, "mode": "test", "epoch": 19}
{"loss": 0.0585169717669487, "acc": 0.9931831359863281, "length": 5.541018962860107, "mode": "train", "epoch": 20}
{"loss": 0.1458539515733719, "acc": 0.9629620909690857, "length": 5.594913482666016, "mode": "test", "epoch": 20}
{"loss": 0.05590198561549187, "acc": 0.9928443431854248, "length": 5.584206581115723, "mode": "train", "epoch": 21}
{"loss": 0.15369047224521637, "acc": 0.9602264165878296, "length": 5.728939533233643, "mode": "test", "epoch": 21}
{"loss": 0.04606856033205986, "acc": 0.9956223964691162, "length": 5.630404949188232, "mode": "train", "epoch": 22}
{"loss": 0.1431806981563568, "acc": 0.9646838307380676, "length": 5.681883811950684, "mode": "test", "epoch": 22}
{"loss": 0.041375014930963516, "acc": 0.997063934803009, "length": 5.609549045562744, "mode": "train", "epoch": 23}
{"loss": 0.11306429654359818, "acc": 0.9775340557098389, "length": 5.67305850982666, "mode": "test", "epoch": 23}
{"loss": 0.04086815565824509, "acc": 0.9971523284912109, "length": 5.616914749145508, "mode": "train", "epoch": 24}
{"loss": 0.11510439217090607, "acc": 0.9736586809158325, "length": 5.6669206619262695, "mode": "test", "epoch": 24}
{"loss": 0.04033215716481209, "acc": 0.997303307056427, "length": 5.590574264526367, "mode": "train", "epoch": 25}
{"loss": 0.10452341288328171, "acc": 0.9804555177688599, "length": 5.740492820739746, "mode": "test", "epoch": 25}
{"loss": 0.03854241594672203, "acc": 0.9977357387542725, "length": 5.569662570953369, "mode": "train", "epoch": 26}
{"loss": 0.10024799406528473, "acc": 0.9803000688552856, "length": 5.640805721282959, "mode": "test", "epoch": 26}
{"loss": 0.038088444620370865, "acc": 0.997763991355896, "length": 5.562424182891846, "mode": "train", "epoch": 27}
{"loss": 0.08687929809093475, "acc": 0.9831310510635376, "length": 5.689345359802246, "mode": "test", "epoch": 27}
{"loss": 0.03734974190592766, "acc": 0.9979840517044067, "length": 5.601075172424316, "mode": "train", "epoch": 28}
{"loss": 0.10856983810663223, "acc": 0.9777149558067322, "length": 5.7366414070129395, "mode": "test", "epoch": 28}
{"loss": 0.03731517121195793, "acc": 0.9979546666145325, "length": 5.526337623596191, "mode": "train", "epoch": 29}
{"loss": 0.09039438515901566, "acc": 0.9850199818611145, "length": 5.604581356048584, "mode": "test", "epoch": 29}
{"loss": 0.03600040450692177, "acc": 0.9981907606124878, "length": 5.511209011077881, "mode": "train", "epoch": 30}
{"loss": 0.08772151172161102, "acc": 0.9848421216011047, "length": 5.634707927703857, "mode": "test", "epoch": 30}
{"loss": 0.035820845514535904, "acc": 0.9982442259788513, "length": 5.50166130065918, "mode": "train", "epoch": 31}
{"loss": 0.09428509324789047, "acc": 0.9839074611663818, "length": 5.635710716247559, "mode": "test", "epoch": 31}
{"loss": 0.035826675593853, "acc": 0.9982278347015381, "length": 5.490540504455566, "mode": "train", "epoch": 32}
{"loss": 0.08272699266672134, "acc": 0.9871532320976257, "length": 5.643172264099121, "mode": "test", "epoch": 32}
{"loss": 0.03515896946191788, "acc": 0.9984288215637207, "length": 5.509504795074463, "mode": "train", "epoch": 33}
{"loss": 0.10122509300708771, "acc": 0.9844216704368591, "length": 5.613968372344971, "mode": "test", "epoch": 33}
{"loss": 0.03533108904957771, "acc": 0.9983528256416321, "length": 5.493375301361084, "mode": "train", "epoch": 34}
{"loss": 0.08586563169956207, "acc": 0.9870471358299255, "length": 5.640805721282959, "mode": "test", "epoch": 34}
{"loss": 0.03534290939569473, "acc": 0.9984264969825745, "length": 5.549986362457275, "mode": "train", "epoch": 35}
{"loss": 0.08774157613515854, "acc": 0.9859881401062012, "length": 5.686978340148926, "mode": "test", "epoch": 35}
{"loss": 0.0349818617105484, "acc": 0.9984385371208191, "length": 5.511049270629883, "mode": "train", "epoch": 36}
{"loss": 0.09162989258766174, "acc": 0.9835895895957947, "length": 5.668525218963623, "mode": "test", "epoch": 36}
{"loss": 0.03468471020460129, "acc": 0.9985215067863464, "length": 5.503478527069092, "mode": "train", "epoch": 37}
{"loss": 0.08570035547018051, "acc": 0.9862126111984253, "length": 5.651355743408203, "mode": "test", "epoch": 37}
{"loss": 0.034501269459724426, "acc": 0.9985583424568176, "length": 5.513827323913574, "mode": "train", "epoch": 38}
{"loss": 0.0772264152765274, "acc": 0.9881496429443359, "length": 5.607870578765869, "mode": "test", "epoch": 38}
{"loss": 0.034598104655742645, "acc": 0.998489260673523, "length": 5.461630821228027, "mode": "train", "epoch": 39}
{"loss": 0.08308436721563339, "acc": 0.9861340522766113, "length": 5.624157428741455, "mode": "test", "epoch": 39}
{"loss": 0.033634793013334274, "acc": 0.9986853003501892, "length": 5.4931206703186035, "mode": "train", "epoch": 40}
{"loss": 0.08090047538280487, "acc": 0.9876865148544312, "length": 5.631097793579102, "mode": "test", "epoch": 40}
{"loss": 0.03290066123008728, "acc": 0.9987779259681702, "length": 5.436421871185303, "mode": "train", "epoch": 41}
{"loss": 0.06523731350898743, "acc": 0.9915454387664795, "length": 5.600368976593018, "mode": "test", "epoch": 41}
{"loss": 0.032837625592947006, "acc": 0.9988434910774231, "length": 5.44377326965332, "mode": "train", "epoch": 42}
{"loss": 0.062383223325014114, "acc": 0.9931013584136963, "length": 5.661826133728027, "mode": "test", "epoch": 42}
{"loss": 0.03361525759100914, "acc": 0.9987430572509766, "length": 5.504018783569336, "mode": "train", "epoch": 43}
{"loss": 0.06954646110534668, "acc": 0.9897565841674805, "length": 5.659098148345947, "mode": "test", "epoch": 43}
{"loss": 0.034548141062259674, "acc": 0.9985110759735107, "length": 5.509596347808838, "mode": "train", "epoch": 44}
{"loss": 0.06923092156648636, "acc": 0.990912914276123, "length": 5.631057262420654, "mode": "test", "epoch": 44}
{"loss": 0.03338388353586197, "acc": 0.9987430572509766, "length": 5.481630325317383, "mode": "train", "epoch": 45}
{"loss": 0.0668453648686409, "acc": 0.9922363758087158, "length": 5.65211820602417, "mode": "test", "epoch": 45}
{"loss": 0.032762158662080765, "acc": 0.9988675713539124, "length": 5.443401336669922, "mode": "train", "epoch": 46}
{"loss": 0.06082066148519516, "acc": 0.9929456114768982, "length": 5.624679088592529, "mode": "test", "epoch": 46}
{"loss": 0.0325448215007782, "acc": 0.9989438056945801, "length": 5.456214904785156, "mode": "train", "epoch": 47}
{"loss": 0.06043366715312004, "acc": 0.9938535690307617, "length": 5.6184210777282715, "mode": "test", "epoch": 47}
{"loss": 0.0319993756711483, "acc": 0.9990079998970032, "length": 5.4241509437561035, "mode": "train", "epoch": 48}
{"loss": 0.0577520914375782, "acc": 0.9946146607398987, "length": 5.648949146270752, "mode": "test", "epoch": 48}
{"loss": 0.032505687326192856, "acc": 0.9989643692970276, "length": 5.4485955238342285, "mode": "train", "epoch": 49}
{"loss": 0.06470026820898056, "acc": 0.9922797083854675, "length": 5.545852184295654, "mode": "test", "epoch": 49}
{"loss": 0.03251888230443001, "acc": 0.9988618493080139, "length": 5.416024208068848, "mode": "train", "epoch": 50}
{"loss": 0.05324624106287956, "acc": 0.9946449398994446, "length": 5.604300498962402, "mode": "test", "epoch": 50}
{"loss": 0.032058168202638626, "acc": 0.9989760518074036, "length": 5.4324445724487305, "mode": "train", "epoch": 51}
{"loss": 0.07349907606840134, "acc": 0.9886212348937988, "length": 5.556362152099609, "mode": "test", "epoch": 51}
{"loss": 0.03140603378415108, "acc": 0.9991021752357483, "length": 5.389784812927246, "mode": "train", "epoch": 52}
{"loss": 0.05308197811245918, "acc": 0.9955761432647705, "length": 5.60133171081543, "mode": "test", "epoch": 52}
{"loss": 0.031771451234817505, "acc": 0.9990207552909851, "length": 5.394976615905762, "mode": "train", "epoch": 53}
{"loss": 0.05167720839381218, "acc": 0.9955722689628601, "length": 5.560774803161621, "mode": "test", "epoch": 53}
{"loss": 0.032428666949272156, "acc": 0.9989097714424133, "length": 5.425933361053467, "mode": "train", "epoch": 54}
{"loss": 0.053125668317079544, "acc": 0.9950976967811584, "length": 5.657413482666016, "mode": "test", "epoch": 54}
{"loss": 0.0374755784869194, "acc": 0.9977177381515503, "length": 5.437569618225098, "mode": "train", "epoch": 55}
{"loss": 0.05501783639192581, "acc": 0.994353175163269, "length": 5.591904640197754, "mode": "test", "epoch": 55}
{"loss": 0.034122467041015625, "acc": 0.9984825849533081, "length": 5.449198246002197, "mode": "train", "epoch": 56}
{"loss": 0.06238129734992981, "acc": 0.9934982061386108, "length": 5.700216770172119, "mode": "test", "epoch": 56}
{"loss": 0.03658166155219078, "acc": 0.9979071617126465, "length": 5.467038154602051, "mode": "train", "epoch": 57}
{"loss": 0.05714205279946327, "acc": 0.9936391115188599, "length": 5.63326358795166, "mode": "test", "epoch": 57}
{"loss": 0.034645888954401016, "acc": 0.9983639717102051, "length": 5.453437805175781, "mode": "train", "epoch": 58}
{"loss": 0.05876439809799194, "acc": 0.9942430257797241, "length": 5.674342155456543, "mode": "test", "epoch": 58}
{"loss": 0.03537396341562271, "acc": 0.9982777237892151, "length": 5.477200031280518, "mode": "train", "epoch": 59}
{"loss": 0.05772016942501068, "acc": 0.9947629570960999, "length": 5.673860549926758, "mode": "test", "epoch": 59}
{"loss": 0.035760506987571716, "acc": 0.9980383515357971, "length": 5.464670181274414, "mode": "train", "epoch": 60}
{"loss": 0.0670936182141304, "acc": 0.9926486611366272, "length": 5.6433329582214355, "mode": "test", "epoch": 60}
test accuracy: 0.989978551864624
