ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 20
{"loss": 0.4422980546951294, "acc": 0.7820496559143066, "length": 2.8911197185516357, "mode": "train", "epoch": 1}
{"loss": 0.36948269605636597, "acc": 0.8499931693077087, "length": 4.130921840667725, "mode": "test", "epoch": 1}
{"loss": 0.24961872398853302, "acc": 0.9145526885986328, "length": 4.918801784515381, "mode": "train", "epoch": 2}
{"loss": 0.314634770154953, "acc": 0.881264328956604, "length": 5.177176475524902, "mode": "test", "epoch": 2}
{"loss": 0.19211462140083313, "acc": 0.9413983821868896, "length": 5.536159515380859, "mode": "train", "epoch": 3}
{"loss": 0.2440817803144455, "acc": 0.9181350469589233, "length": 5.8772406578063965, "mode": "test", "epoch": 3}
{"loss": 0.1644333004951477, "acc": 0.9543401598930359, "length": 5.793038368225098, "mode": "train", "epoch": 4}
{"loss": 0.22883222997188568, "acc": 0.9256719350814819, "length": 5.648967742919922, "mode": "test", "epoch": 4}
{"loss": 0.13963717222213745, "acc": 0.9663344621658325, "length": 6.02955436706543, "mode": "train", "epoch": 5}
{"loss": 0.20736368000507355, "acc": 0.9359427094459534, "length": 6.175896167755127, "mode": "test", "epoch": 5}
{"loss": 0.11913858354091644, "acc": 0.9743195176124573, "length": 6.26539945602417, "mode": "train", "epoch": 6}
{"loss": 0.21070505678653717, "acc": 0.9318355917930603, "length": 6.331106185913086, "mode": "test", "epoch": 6}
{"loss": 0.09690970927476883, "acc": 0.9817288517951965, "length": 6.282294750213623, "mode": "train", "epoch": 7}
{"loss": 0.2091096043586731, "acc": 0.9346451759338379, "length": 6.122639179229736, "mode": "test", "epoch": 7}
{"loss": 0.08591284602880478, "acc": 0.9853387475013733, "length": 6.299224376678467, "mode": "train", "epoch": 8}
{"loss": 0.18896634876728058, "acc": 0.9446154236793518, "length": 6.342949867248535, "mode": "test", "epoch": 8}
{"loss": 0.0749594196677208, "acc": 0.9878646731376648, "length": 6.284923553466797, "mode": "train", "epoch": 9}
{"loss": 0.16945780813694, "acc": 0.9518437385559082, "length": 6.17469596862793, "mode": "test", "epoch": 9}
{"loss": 0.06198639050126076, "acc": 0.9915967583656311, "length": 6.28776216506958, "mode": "train", "epoch": 10}
{"loss": 0.17028270661830902, "acc": 0.9512854218482971, "length": 6.160531520843506, "mode": "test", "epoch": 10}
{"loss": 0.05802222341299057, "acc": 0.9928905963897705, "length": 6.254693508148193, "mode": "train", "epoch": 11}
{"loss": 0.14522093534469604, "acc": 0.9611650109291077, "length": 6.156010150909424, "mode": "test", "epoch": 11}
{"loss": 0.04956453666090965, "acc": 0.9956029057502747, "length": 6.1431498527526855, "mode": "train", "epoch": 12}
{"loss": 0.14547164738178253, "acc": 0.9652142524719238, "length": 6.159971237182617, "mode": "test", "epoch": 12}
{"loss": 0.04999272897839546, "acc": 0.9953333139419556, "length": 6.131333351135254, "mode": "train", "epoch": 13}
{"loss": 0.11458232253789902, "acc": 0.9730179309844971, "length": 6.143245697021484, "mode": "test", "epoch": 13}
{"loss": 0.04658360779285431, "acc": 0.9962981939315796, "length": 6.068367004394531, "mode": "train", "epoch": 14}
{"loss": 0.13362418115139008, "acc": 0.9671919345855713, "length": 5.944662094116211, "mode": "test", "epoch": 14}
{"loss": 0.04443388432264328, "acc": 0.9967050552368164, "length": 6.006558418273926, "mode": "train", "epoch": 15}
{"loss": 0.10291531682014465, "acc": 0.9789831042289734, "length": 5.97387170791626, "mode": "test", "epoch": 15}
{"loss": 0.0431099459528923, "acc": 0.9969407320022583, "length": 5.966311454772949, "mode": "train", "epoch": 16}
{"loss": 0.10796257853507996, "acc": 0.9770288467407227, "length": 5.993037700653076, "mode": "test", "epoch": 16}
{"loss": 0.039387281984090805, "acc": 0.9979555010795593, "length": 5.951961994171143, "mode": "train", "epoch": 17}
{"loss": 0.09672454744577408, "acc": 0.9793469309806824, "length": 5.817141532897949, "mode": "test", "epoch": 17}
{"loss": 0.042920198291540146, "acc": 0.996925950050354, "length": 5.943039417266846, "mode": "train", "epoch": 18}
{"loss": 0.10531607270240784, "acc": 0.9787299633026123, "length": 5.956826210021973, "mode": "test", "epoch": 18}
{"loss": 0.039039213210344315, "acc": 0.9979180097579956, "length": 5.879229545593262, "mode": "train", "epoch": 19}
{"loss": 0.08373720943927765, "acc": 0.9854816794395447, "length": 5.845670700073242, "mode": "test", "epoch": 19}
{"loss": 0.043015461415052414, "acc": 0.9967731833457947, "length": 5.860864639282227, "mode": "train", "epoch": 20}
{"loss": 0.10342303663492203, "acc": 0.9794328212738037, "length": 5.928657054901123, "mode": "test", "epoch": 20}
{"loss": 0.04386072978377342, "acc": 0.9965993165969849, "length": 5.87445068359375, "mode": "train", "epoch": 21}
{"loss": 0.12195493280887604, "acc": 0.9743920564651489, "length": 5.86375617980957, "mode": "test", "epoch": 21}
{"loss": 0.04053565859794617, "acc": 0.9974366426467896, "length": 5.862289905548096, "mode": "train", "epoch": 22}
{"loss": 0.09010516107082367, "acc": 0.9840339422225952, "length": 5.76792573928833, "mode": "test", "epoch": 22}
{"loss": 0.04463915526866913, "acc": 0.9962454438209534, "length": 5.7831902503967285, "mode": "train", "epoch": 23}
{"loss": 0.07295926660299301, "acc": 0.9883154630661011, "length": 5.715348720550537, "mode": "test", "epoch": 23}
{"loss": 0.04267938435077667, "acc": 0.9967678785324097, "length": 5.7893500328063965, "mode": "train", "epoch": 24}
{"loss": 0.0770047977566719, "acc": 0.9879694581031799, "length": 5.7183098793029785, "mode": "test", "epoch": 24}
{"loss": 0.038895897567272186, "acc": 0.9977525472640991, "length": 5.732780456542969, "mode": "train", "epoch": 25}
{"loss": 0.10593025386333466, "acc": 0.9798654913902283, "length": 5.635003089904785, "mode": "test", "epoch": 25}
{"loss": 0.04210110381245613, "acc": 0.9965670108795166, "length": 5.676563262939453, "mode": "train", "epoch": 26}
{"loss": 0.08095157146453857, "acc": 0.9864104986190796, "length": 5.685579299926758, "mode": "test", "epoch": 26}
{"loss": 0.038706619292497635, "acc": 0.9976251721382141, "length": 5.69585657119751, "mode": "train", "epoch": 27}
{"loss": 0.06974529474973679, "acc": 0.9910305738449097, "length": 5.648407459259033, "mode": "test", "epoch": 27}
{"loss": 0.03773625195026398, "acc": 0.9977869987487793, "length": 5.645549297332764, "mode": "train", "epoch": 28}
{"loss": 0.0765267014503479, "acc": 0.9891196489334106, "length": 5.693141937255859, "mode": "test", "epoch": 28}
{"loss": 0.039049237966537476, "acc": 0.9976215958595276, "length": 5.688769340515137, "mode": "train", "epoch": 29}
{"loss": 0.07601495832204819, "acc": 0.9903627038002014, "length": 5.733874797821045, "mode": "test", "epoch": 29}
{"loss": 0.03952296823263168, "acc": 0.9974972605705261, "length": 5.680758476257324, "mode": "train", "epoch": 30}
{"loss": 0.06651172041893005, "acc": 0.9922149181365967, "length": 5.637604236602783, "mode": "test", "epoch": 30}
{"loss": 0.03835887089371681, "acc": 0.9977796077728271, "length": 5.682161331176758, "mode": "train", "epoch": 31}
{"loss": 0.06106971204280853, "acc": 0.9926878809928894, "length": 5.851872444152832, "mode": "test", "epoch": 31}
{"loss": 0.03701763227581978, "acc": 0.9979587197303772, "length": 5.62913703918457, "mode": "train", "epoch": 32}
{"loss": 0.05878627300262451, "acc": 0.9930965304374695, "length": 5.6843791007995605, "mode": "test", "epoch": 32}
{"loss": 0.03796977177262306, "acc": 0.9978392124176025, "length": 5.621604919433594, "mode": "train", "epoch": 33}
{"loss": 0.06344343721866608, "acc": 0.992842972278595, "length": 5.752200603485107, "mode": "test", "epoch": 33}
{"loss": 0.03764038160443306, "acc": 0.9977906942367554, "length": 5.602955341339111, "mode": "train", "epoch": 34}
{"loss": 0.06911683082580566, "acc": 0.991604745388031, "length": 5.735235214233398, "mode": "test", "epoch": 34}
{"loss": 0.034620631486177444, "acc": 0.9986181259155273, "length": 5.605795383453369, "mode": "train", "epoch": 35}
{"loss": 0.07254024595022202, "acc": 0.9898144602775574, "length": 5.60915470123291, "mode": "test", "epoch": 35}
{"loss": 0.03594227135181427, "acc": 0.9982414841651917, "length": 5.626391887664795, "mode": "train", "epoch": 36}
{"loss": 0.06331196427345276, "acc": 0.9921135902404785, "length": 5.592029571533203, "mode": "test", "epoch": 36}
{"loss": 0.035608649253845215, "acc": 0.9983574151992798, "length": 5.597988605499268, "mode": "train", "epoch": 37}
{"loss": 0.06648550182580948, "acc": 0.9922419190406799, "length": 5.642165660858154, "mode": "test", "epoch": 37}
{"loss": 0.035564977675676346, "acc": 0.9983387589454651, "length": 5.554794788360596, "mode": "train", "epoch": 38}
{"loss": 0.05353647843003273, "acc": 0.9951850175857544, "length": 5.6933817863464355, "mode": "test", "epoch": 38}
{"loss": 0.036220356822013855, "acc": 0.9981203079223633, "length": 5.528496265411377, "mode": "train", "epoch": 39}
{"loss": 0.05916064977645874, "acc": 0.9937554001808167, "length": 5.570382595062256, "mode": "test", "epoch": 39}
{"loss": 0.037301864475011826, "acc": 0.9978533983230591, "length": 5.553870677947998, "mode": "train", "epoch": 40}
{"loss": 0.06068769469857216, "acc": 0.9932045936584473, "length": 5.782810688018799, "mode": "test", "epoch": 40}
{"loss": 0.03484179079532623, "acc": 0.9985178112983704, "length": 5.586273670196533, "mode": "train", "epoch": 41}
{"loss": 0.05617915838956833, "acc": 0.9942579865455627, "length": 5.629881381988525, "mode": "test", "epoch": 41}
{"loss": 0.03452198952436447, "acc": 0.998551607131958, "length": 5.542916774749756, "mode": "train", "epoch": 42}
{"loss": 0.06009884551167488, "acc": 0.9932529926300049, "length": 5.708906650543213, "mode": "test", "epoch": 42}
{"loss": 0.036708712577819824, "acc": 0.9980034232139587, "length": 5.6287312507629395, "mode": "train", "epoch": 43}
{"loss": 0.06600119173526764, "acc": 0.9926965832710266, "length": 5.61627721786499, "mode": "test", "epoch": 43}
{"loss": 0.034439388662576675, "acc": 0.9986041784286499, "length": 5.584934234619141, "mode": "train", "epoch": 44}
{"loss": 0.07384273409843445, "acc": 0.990835964679718, "length": 5.770166397094727, "mode": "test", "epoch": 44}
{"loss": 0.047504667192697525, "acc": 0.9951807856559753, "length": 5.689017295837402, "mode": "train", "epoch": 45}
{"loss": 0.07455628365278244, "acc": 0.9899159073829651, "length": 5.69110107421875, "mode": "test", "epoch": 45}
{"loss": 0.03886369243264198, "acc": 0.9973424673080444, "length": 5.571228981018066, "mode": "train", "epoch": 46}
{"loss": 0.06019974127411842, "acc": 0.9930365085601807, "length": 5.710387229919434, "mode": "test", "epoch": 46}
{"loss": 0.03861590847373009, "acc": 0.9973983764648438, "length": 5.573390960693359, "mode": "train", "epoch": 47}
{"loss": 0.05597907677292824, "acc": 0.9948464035987854, "length": 5.6057538986206055, "mode": "test", "epoch": 47}
{"loss": 0.038379792124032974, "acc": 0.9973219633102417, "length": 5.528148174285889, "mode": "train", "epoch": 48}
{"loss": 0.055227603763341904, "acc": 0.9939368963241577, "length": 5.757482528686523, "mode": "test", "epoch": 48}
{"loss": 0.03839844837784767, "acc": 0.9974746704101562, "length": 5.602476119995117, "mode": "train", "epoch": 49}
{"loss": 0.060477208346128464, "acc": 0.9939194321632385, "length": 5.6111555099487305, "mode": "test", "epoch": 49}
{"loss": 0.03607836738228798, "acc": 0.9981268048286438, "length": 5.568428039550781, "mode": "train", "epoch": 50}
{"loss": 0.062361620366573334, "acc": 0.9922128319740295, "length": 5.649087905883789, "mode": "test", "epoch": 50}
{"loss": 0.03574851527810097, "acc": 0.998136043548584, "length": 5.552585601806641, "mode": "train", "epoch": 51}
{"loss": 0.049752604216337204, "acc": 0.9956870675086975, "length": 5.667853832244873, "mode": "test", "epoch": 51}
{"loss": 0.036919452250003815, "acc": 0.9978542923927307, "length": 5.517655372619629, "mode": "train", "epoch": 52}
{"loss": 0.05185185745358467, "acc": 0.9952011108398438, "length": 5.626200199127197, "mode": "test", "epoch": 52}
{"loss": 0.037402428686618805, "acc": 0.9976810216903687, "length": 5.510833740234375, "mode": "train", "epoch": 53}
{"loss": 0.05501437187194824, "acc": 0.9946545362472534, "length": 5.607394218444824, "mode": "test", "epoch": 53}
{"loss": 0.036063168197870255, "acc": 0.9979852437973022, "length": 5.50676155090332, "mode": "train", "epoch": 54}
{"loss": 0.056208688765764236, "acc": 0.9943481683731079, "length": 5.665132999420166, "mode": "test", "epoch": 54}
{"loss": 0.03605050593614578, "acc": 0.9980802536010742, "length": 5.532664775848389, "mode": "train", "epoch": 55}
{"loss": 0.05446990579366684, "acc": 0.9940521717071533, "length": 5.688740253448486, "mode": "test", "epoch": 55}
{"loss": 0.035028841346502304, "acc": 0.9983628392219543, "length": 5.552315711975098, "mode": "train", "epoch": 56}
{"loss": 0.04710712656378746, "acc": 0.9965760111808777, "length": 5.630321502685547, "mode": "test", "epoch": 56}
{"loss": 0.035947125405073166, "acc": 0.9980832934379578, "length": 5.496800899505615, "mode": "train", "epoch": 57}
{"loss": 0.05390412360429764, "acc": 0.9953094124794006, "length": 5.547055244445801, "mode": "test", "epoch": 57}
{"loss": 0.033246707171201706, "acc": 0.9987937808036804, "length": 5.507139682769775, "mode": "train", "epoch": 58}
{"loss": 0.046548567712306976, "acc": 0.9965935349464417, "length": 5.597551345825195, "mode": "test", "epoch": 58}
{"loss": 0.034293364733457565, "acc": 0.9985601305961609, "length": 5.519070148468018, "mode": "train", "epoch": 59}
{"loss": 0.06585976481437683, "acc": 0.9921869039535522, "length": 5.6424055099487305, "mode": "test", "epoch": 59}
{"loss": 0.03590477630496025, "acc": 0.998124361038208, "length": 5.556856155395508, "mode": "train", "epoch": 60}
{"loss": 0.05289333313703537, "acc": 0.9946281313896179, "length": 5.582706451416016, "mode": "test", "epoch": 60}
test accuracy: 0.9956955909729004
