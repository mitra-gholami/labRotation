ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.7091251015663147, "acc": 0.5140107274055481, "length": 2.895585060119629, "mode": "train", "epoch": 1}
{"loss": 0.6992779970169067, "acc": 0.5065104365348816, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6786383986473083, "acc": 0.576396107673645, "length": 1.4684066772460938, "mode": "train", "epoch": 2}
{"loss": 0.6331925988197327, "acc": 0.6443195939064026, "length": 1.5347222089767456, "mode": "test", "epoch": 2}
{"loss": 0.5941449999809265, "acc": 0.6878227591514587, "length": 1.6533160209655762, "mode": "train", "epoch": 3}
{"loss": 0.5978771448135376, "acc": 0.7067708373069763, "length": 1.3680555820465088, "mode": "test", "epoch": 3}
{"loss": 0.5824968218803406, "acc": 0.7035335302352905, "length": 1.4137564897537231, "mode": "train", "epoch": 4}
{"loss": 0.6177100539207458, "acc": 0.6460964679718018, "length": 1.3298611640930176, "mode": "test", "epoch": 4}
{"loss": 0.5610135197639465, "acc": 0.7223587036132812, "length": 1.4640905857086182, "mode": "train", "epoch": 5}
{"loss": 0.5471851229667664, "acc": 0.7339870929718018, "length": 1.4965277910232544, "mode": "test", "epoch": 5}
{"loss": 0.5151445269584656, "acc": 0.7428298592567444, "length": 1.4685072898864746, "mode": "train", "epoch": 6}
{"loss": 0.5254204273223877, "acc": 0.7369846105575562, "length": 1.3663194179534912, "mode": "test", "epoch": 6}
{"loss": 0.5039919018745422, "acc": 0.7464890480041504, "length": 1.4920088052749634, "mode": "train", "epoch": 7}
{"loss": 0.5168449878692627, "acc": 0.7431207299232483, "length": 1.4270833730697632, "mode": "test", "epoch": 7}
{"loss": 0.49546483159065247, "acc": 0.7495288252830505, "length": 1.4986062049865723, "mode": "train", "epoch": 8}
{"loss": 0.5191717147827148, "acc": 0.7441163063049316, "length": 1.4444444179534912, "mode": "test", "epoch": 8}
{"loss": 0.4929451644420624, "acc": 0.7557223439216614, "length": 1.524071455001831, "mode": "train", "epoch": 9}
{"loss": 0.5207751393318176, "acc": 0.7440864443778992, "length": 1.4270833730697632, "mode": "test", "epoch": 9}
{"loss": 0.48098069429397583, "acc": 0.7672465443611145, "length": 1.637729525566101, "mode": "train", "epoch": 10}
{"loss": 0.555690348148346, "acc": 0.7312797904014587, "length": 1.6614583730697632, "mode": "test", "epoch": 10}
{"loss": 0.44324925541877747, "acc": 0.8037432432174683, "length": 1.9506863355636597, "mode": "train", "epoch": 11}
{"loss": 0.481514573097229, "acc": 0.7928602695465088, "length": 1.8576388359069824, "mode": "test", "epoch": 11}
{"loss": 0.4016669690608978, "acc": 0.8313381671905518, "length": 2.2090015411376953, "mode": "train", "epoch": 12}
{"loss": 0.44470468163490295, "acc": 0.8099067211151123, "length": 2.069444417953491, "mode": "test", "epoch": 12}
{"loss": 0.3764002323150635, "acc": 0.8451523184776306, "length": 2.3701653480529785, "mode": "train", "epoch": 13}
{"loss": 0.43942198157310486, "acc": 0.8175427913665771, "length": 2.3125, "mode": "test", "epoch": 13}
{"loss": 0.3582519292831421, "acc": 0.8565757274627686, "length": 2.436403274536133, "mode": "train", "epoch": 14}
{"loss": 0.41638103127479553, "acc": 0.8320204615592957, "length": 2.203125, "mode": "test", "epoch": 14}
{"loss": 0.34597915410995483, "acc": 0.8628642559051514, "length": 2.468047618865967, "mode": "train", "epoch": 15}
{"loss": 0.40222471952438354, "acc": 0.828241765499115, "length": 2.258680582046509, "mode": "test", "epoch": 15}
{"loss": 0.3276910185813904, "acc": 0.873448371887207, "length": 2.5564682483673096, "mode": "train", "epoch": 16}
{"loss": 0.38155096769332886, "acc": 0.8485731482505798, "length": 2.460069417953491, "mode": "test", "epoch": 16}
{"loss": 0.31234902143478394, "acc": 0.8845697045326233, "length": 2.627101182937622, "mode": "train", "epoch": 17}
{"loss": 0.37604543566703796, "acc": 0.8553819060325623, "length": 2.4826388359069824, "mode": "test", "epoch": 17}
{"loss": 0.30679193139076233, "acc": 0.8864704370498657, "length": 2.6279823780059814, "mode": "train", "epoch": 18}
{"loss": 0.36769217252731323, "acc": 0.8618137836456299, "length": 2.496527671813965, "mode": "test", "epoch": 18}
{"loss": 0.2924824655056, "acc": 0.89435213804245, "length": 2.6634023189544678, "mode": "train", "epoch": 19}
{"loss": 0.3478585183620453, "acc": 0.8714599609375, "length": 2.586805582046509, "mode": "test", "epoch": 19}
{"loss": 0.2835446000099182, "acc": 0.8977683782577515, "length": 2.6925127506256104, "mode": "train", "epoch": 20}
{"loss": 0.34734511375427246, "acc": 0.8744223117828369, "length": 2.581597328186035, "mode": "test", "epoch": 20}
{"loss": 0.27604901790618896, "acc": 0.9020592570304871, "length": 2.7076127529144287, "mode": "train", "epoch": 21}
{"loss": 0.3301509618759155, "acc": 0.883675217628479, "length": 2.618055582046509, "mode": "test", "epoch": 21}
{"loss": 0.26706624031066895, "acc": 0.9066714644432068, "length": 2.7417898178100586, "mode": "train", "epoch": 22}
{"loss": 0.33451977372169495, "acc": 0.8785183429718018, "length": 2.6267361640930176, "mode": "test", "epoch": 22}
{"loss": 0.26271378993988037, "acc": 0.907707691192627, "length": 2.7982938289642334, "mode": "train", "epoch": 23}
{"loss": 0.31965434551239014, "acc": 0.8828341960906982, "length": 2.850694417953491, "mode": "test", "epoch": 23}
{"loss": 0.2515151798725128, "acc": 0.9113108515739441, "length": 2.9155378341674805, "mode": "train", "epoch": 24}
{"loss": 0.30868232250213623, "acc": 0.8895346522331238, "length": 2.836805582046509, "mode": "test", "epoch": 24}
{"loss": 0.239563450217247, "acc": 0.918381929397583, "length": 2.951838254928589, "mode": "train", "epoch": 25}
{"loss": 0.31169208884239197, "acc": 0.8827364444732666, "length": 2.821180582046509, "mode": "test", "epoch": 25}
{"loss": 0.23435771465301514, "acc": 0.9217238426208496, "length": 2.9524030685424805, "mode": "train", "epoch": 26}
{"loss": 0.28696632385253906, "acc": 0.8957140445709229, "length": 2.855902671813965, "mode": "test", "epoch": 26}
{"loss": 0.22791022062301636, "acc": 0.9242812991142273, "length": 2.950671672821045, "mode": "train", "epoch": 27}
{"loss": 0.26906248927116394, "acc": 0.9084500074386597, "length": 2.835069417953491, "mode": "test", "epoch": 27}
{"loss": 0.21935567259788513, "acc": 0.9283571839332581, "length": 2.965851068496704, "mode": "train", "epoch": 28}
{"loss": 0.2780582010746002, "acc": 0.9060330986976624, "length": 2.8385417461395264, "mode": "test", "epoch": 28}
{"loss": 0.21478180587291718, "acc": 0.9293197989463806, "length": 3.0322206020355225, "mode": "train", "epoch": 29}
{"loss": 0.2685343623161316, "acc": 0.9085123538970947, "length": 2.96875, "mode": "test", "epoch": 29}
{"loss": 0.20936574041843414, "acc": 0.9322850108146667, "length": 3.084064245223999, "mode": "train", "epoch": 30}
{"loss": 0.271486759185791, "acc": 0.9096028804779053, "length": 2.9704861640930176, "mode": "test", "epoch": 30}
{"loss": 0.2061494141817093, "acc": 0.9332141280174255, "length": 3.087662935256958, "mode": "train", "epoch": 31}
{"loss": 0.27209967374801636, "acc": 0.8982990980148315, "length": 2.991319417953491, "mode": "test", "epoch": 31}
{"loss": 0.19986502826213837, "acc": 0.932981014251709, "length": 3.2112550735473633, "mode": "train", "epoch": 32}
{"loss": 0.25921255350112915, "acc": 0.9111762642860413, "length": 2.9861111640930176, "mode": "test", "epoch": 32}
{"loss": 0.19602444767951965, "acc": 0.9355694055557251, "length": 3.219574213027954, "mode": "train", "epoch": 33}
{"loss": 0.24555158615112305, "acc": 0.918614387512207, "length": 3.0833332538604736, "mode": "test", "epoch": 33}
{"loss": 0.19065505266189575, "acc": 0.9373125433921814, "length": 3.277830123901367, "mode": "train", "epoch": 34}
{"loss": 0.24664776027202606, "acc": 0.9173067808151245, "length": 3.1232638359069824, "mode": "test", "epoch": 34}
{"loss": 0.18043206632137299, "acc": 0.9407089352607727, "length": 3.326763153076172, "mode": "train", "epoch": 35}
{"loss": 0.24332891404628754, "acc": 0.9149115681648254, "length": 3.21875, "mode": "test", "epoch": 35}
{"loss": 0.17293450236320496, "acc": 0.945090115070343, "length": 3.3986356258392334, "mode": "train", "epoch": 36}
{"loss": 0.228852778673172, "acc": 0.9241861701011658, "length": 3.331597328186035, "mode": "test", "epoch": 36}
{"loss": 0.16821572184562683, "acc": 0.9454748034477234, "length": 3.5090181827545166, "mode": "train", "epoch": 37}
{"loss": 0.21114328503608704, "acc": 0.9329617619514465, "length": 3.477430582046509, "mode": "test", "epoch": 37}
{"loss": 0.16288425028324127, "acc": 0.9487625956535339, "length": 3.502535581588745, "mode": "train", "epoch": 38}
{"loss": 0.2079010009765625, "acc": 0.9323866367340088, "length": 3.305555582046509, "mode": "test", "epoch": 38}
{"loss": 0.15444254875183105, "acc": 0.9509670734405518, "length": 3.543388843536377, "mode": "train", "epoch": 39}
{"loss": 0.19446074962615967, "acc": 0.9415039420127869, "length": 3.3489582538604736, "mode": "test", "epoch": 39}
{"loss": 0.1493326872587204, "acc": 0.9528185725212097, "length": 3.6099460124969482, "mode": "train", "epoch": 40}
{"loss": 0.18403209745883942, "acc": 0.9415446519851685, "length": 3.397569417953491, "mode": "test", "epoch": 40}
{"loss": 0.14025022089481354, "acc": 0.9580955505371094, "length": 3.6341540813446045, "mode": "train", "epoch": 41}
{"loss": 0.19497662782669067, "acc": 0.938563346862793, "length": 3.4947917461395264, "mode": "test", "epoch": 41}
{"loss": 0.13412413001060486, "acc": 0.9610738158226013, "length": 3.727490186691284, "mode": "train", "epoch": 42}
{"loss": 0.17700448632240295, "acc": 0.9457491636276245, "length": 3.5677082538604736, "mode": "test", "epoch": 42}
{"loss": 0.12957146763801575, "acc": 0.9621261954307556, "length": 3.7381844520568848, "mode": "train", "epoch": 43}
{"loss": 0.1682993769645691, "acc": 0.9488959908485413, "length": 3.550347328186035, "mode": "test", "epoch": 43}
{"loss": 0.12804682552814484, "acc": 0.9620949029922485, "length": 3.7882487773895264, "mode": "train", "epoch": 44}
{"loss": 0.1696232706308365, "acc": 0.9478542804718018, "length": 3.585069417953491, "mode": "test", "epoch": 44}
{"loss": 0.12044109404087067, "acc": 0.9647404551506042, "length": 3.7598884105682373, "mode": "train", "epoch": 45}
{"loss": 0.16430868208408356, "acc": 0.9507649540901184, "length": 3.5451388359069824, "mode": "test", "epoch": 45}
{"loss": 0.11305470764636993, "acc": 0.9696328639984131, "length": 3.709700107574463, "mode": "train", "epoch": 46}
{"loss": 0.15276271104812622, "acc": 0.955601692199707, "length": 3.5642361640930176, "mode": "test", "epoch": 46}
{"loss": 0.11293136328458786, "acc": 0.9694525599479675, "length": 3.763340711593628, "mode": "train", "epoch": 47}
{"loss": 0.15778431296348572, "acc": 0.9526746273040771, "length": 3.7135417461395264, "mode": "test", "epoch": 47}
{"loss": 0.11234370619058609, "acc": 0.9684567451477051, "length": 3.8520963191986084, "mode": "train", "epoch": 48}
{"loss": 0.14216329157352448, "acc": 0.9593234658241272, "length": 3.6232638359069824, "mode": "test", "epoch": 48}
{"loss": 0.10445267707109451, "acc": 0.9719931483268738, "length": 3.814798593521118, "mode": "train", "epoch": 49}
{"loss": 0.1438884288072586, "acc": 0.9604628086090088, "length": 3.6892361640930176, "mode": "test", "epoch": 49}
{"loss": 0.1052197590470314, "acc": 0.9728006720542908, "length": 3.9055593013763428, "mode": "train", "epoch": 50}
{"loss": 0.13876162469387054, "acc": 0.9599257707595825, "length": 3.753472328186035, "mode": "test", "epoch": 50}
{"loss": 0.09380322694778442, "acc": 0.9763857126235962, "length": 3.985973834991455, "mode": "train", "epoch": 51}
{"loss": 0.12709170579910278, "acc": 0.964447557926178, "length": 3.777777671813965, "mode": "test", "epoch": 51}
{"loss": 0.09649208188056946, "acc": 0.9758719205856323, "length": 3.926192283630371, "mode": "train", "epoch": 52}
{"loss": 0.15418128669261932, "acc": 0.9550591707229614, "length": 3.5920138359069824, "mode": "test", "epoch": 52}
{"loss": 0.10518842190504074, "acc": 0.9710056781768799, "length": 3.9776997566223145, "mode": "train", "epoch": 53}
{"loss": 0.13694794476032257, "acc": 0.9623778462409973, "length": 3.8541667461395264, "mode": "test", "epoch": 53}
{"loss": 0.09998861700296402, "acc": 0.9752916693687439, "length": 4.076116561889648, "mode": "train", "epoch": 54}
{"loss": 0.1292162835597992, "acc": 0.9653183817863464, "length": 4.059027671813965, "mode": "test", "epoch": 54}
{"loss": 0.08689309656620026, "acc": 0.9794934391975403, "length": 4.1913604736328125, "mode": "train", "epoch": 55}
{"loss": 0.13045908510684967, "acc": 0.9653212428092957, "length": 4.019097328186035, "mode": "test", "epoch": 55}
{"loss": 0.08147742599248886, "acc": 0.9823707938194275, "length": 4.2237868309021, "mode": "train", "epoch": 56}
{"loss": 0.11905903369188309, "acc": 0.9685086011886597, "length": 4.16493034362793, "mode": "test", "epoch": 56}
{"loss": 0.07946359366178513, "acc": 0.9814821481704712, "length": 4.218840599060059, "mode": "train", "epoch": 57}
{"loss": 0.10697449743747711, "acc": 0.9705864787101746, "length": 4.154513835906982, "mode": "test", "epoch": 57}
{"loss": 0.07644316554069519, "acc": 0.9830598831176758, "length": 4.229029655456543, "mode": "train", "epoch": 58}
{"loss": 0.11021172255277634, "acc": 0.9699705839157104, "length": 4.050347328186035, "mode": "test", "epoch": 58}
{"loss": 0.07846078276634216, "acc": 0.982210099697113, "length": 4.16215181350708, "mode": "train", "epoch": 59}
{"loss": 0.11165779083967209, "acc": 0.9722277522087097, "length": 4.03125, "mode": "test", "epoch": 59}
{"loss": 0.07455814629793167, "acc": 0.9847366809844971, "length": 4.18942928314209, "mode": "train", "epoch": 60}
{"loss": 0.10653498768806458, "acc": 0.9716986417770386, "length": 4.19618034362793, "mode": "test", "epoch": 60}
test accuracy: 0.7693911194801331
