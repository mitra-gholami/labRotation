ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.32231754064559937, "acc": 0.8625333905220032, "length": 3.955388069152832, "mode": "train", "epoch": 1}
{"loss": 0.30160433053970337, "acc": 0.8740977644920349, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.20801331102848053, "acc": 0.9277102947235107, "length": 3.9999754428863525, "mode": "train", "epoch": 2}
{"loss": 0.30078938603401184, "acc": 0.878351092338562, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.16078248620033264, "acc": 0.9501484036445618, "length": 3.9999966621398926, "mode": "train", "epoch": 3}
{"loss": 0.32985058426856995, "acc": 0.8729693293571472, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.1381925344467163, "acc": 0.9613571166992188, "length": 3.9999992847442627, "mode": "train", "epoch": 4}
{"loss": 0.24155056476593018, "acc": 0.9075643420219421, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.12256752699613571, "acc": 0.9686233401298523, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.25853171944618225, "acc": 0.9073764681816101, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.11837855726480484, "acc": 0.9698007106781006, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.2200116515159607, "acc": 0.9229692816734314, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.11526299268007278, "acc": 0.9701716303825378, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.24402105808258057, "acc": 0.9171895980834961, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.10225861519575119, "acc": 0.9717236757278442, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.2820374071598053, "acc": 0.9049034714698792, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.08533555269241333, "acc": 0.9769182801246643, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.27834343910217285, "acc": 0.9054278135299683, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.08261352777481079, "acc": 0.978244960308075, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.25785157084465027, "acc": 0.9113678336143494, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.0701824352145195, "acc": 0.9830515384674072, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.30531519651412964, "acc": 0.8970951437950134, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.06645370274782181, "acc": 0.9846157431602478, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.29970571398735046, "acc": 0.90843665599823, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.06261339783668518, "acc": 0.9858771562576294, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.310486376285553, "acc": 0.9079325199127197, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.06019528955221176, "acc": 0.9866078495979309, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.28741130232810974, "acc": 0.9136404395103455, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.0579545795917511, "acc": 0.9872139692306519, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.2556231915950775, "acc": 0.9215710163116455, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.05509836599230766, "acc": 0.9878307580947876, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.2575323283672333, "acc": 0.9179136753082275, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.051965221762657166, "acc": 0.9884514808654785, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.27800077199935913, "acc": 0.9209527373313904, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.048411380499601364, "acc": 0.9883173704147339, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.3202449679374695, "acc": 0.9006142616271973, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.0393264964222908, "acc": 0.9898642301559448, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.33325913548469543, "acc": 0.8950263857841492, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.031105617061257362, "acc": 0.9920345544815063, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.38066041469573975, "acc": 0.8865556716918945, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.02905457653105259, "acc": 0.9927958846092224, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.44672250747680664, "acc": 0.8663653135299683, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.028743144124746323, "acc": 0.9927912354469299, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.34791409969329834, "acc": 0.8994739055633545, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.022357722744345665, "acc": 0.9947780966758728, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.3485927879810333, "acc": 0.9020747542381287, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.020096076652407646, "acc": 0.9954861998558044, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.34739360213279724, "acc": 0.9000139236450195, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.019155114889144897, "acc": 0.9958475828170776, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.3553891181945801, "acc": 0.9079124927520752, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.01794624887406826, "acc": 0.9960976243019104, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.428384393453598, "acc": 0.8802517652511597, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.024631693959236145, "acc": 0.9943147301673889, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.3204145133495331, "acc": 0.9116778373718262, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.017676042392849922, "acc": 0.9962283372879028, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.35672900080680847, "acc": 0.9121399521827698, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.017586736008524895, "acc": 0.9962649941444397, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.34626489877700806, "acc": 0.9085527062416077, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.016050074249505997, "acc": 0.9967342615127563, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 0.359229177236557, "acc": 0.8991316556930542, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.016673844307661057, "acc": 0.9965023398399353, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.41148772835731506, "acc": 0.8887424468994141, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.02157091535627842, "acc": 0.9949874877929688, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.35764601826667786, "acc": 0.9103153347969055, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.023686407133936882, "acc": 0.9944307804107666, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 0.3607977628707886, "acc": 0.8976131677627563, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.01587291806936264, "acc": 0.9966543316841125, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.31569987535476685, "acc": 0.9200063347816467, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.015346328727900982, "acc": 0.9967809319496155, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.2743872106075287, "acc": 0.9239315986633301, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.014913077466189861, "acc": 0.996878445148468, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.3944030702114105, "acc": 0.8989676833152771, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.01477314718067646, "acc": 0.997065007686615, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.3200944662094116, "acc": 0.9169595241546631, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.014235376380383968, "acc": 0.997089684009552, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.3365909159183502, "acc": 0.9168214201927185, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.014914055354893208, "acc": 0.9969096779823303, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.3700188994407654, "acc": 0.8983413577079773, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.013219747692346573, "acc": 0.997379720211029, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.3556242287158966, "acc": 0.9097251892089844, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.014741990715265274, "acc": 0.996997058391571, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.3129780888557434, "acc": 0.9151687622070312, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.01372938510030508, "acc": 0.9972609281539917, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.3239292800426483, "acc": 0.920264482498169, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.016493171453475952, "acc": 0.996383547782898, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.3060424327850342, "acc": 0.919674277305603, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.01698281429708004, "acc": 0.9963769316673279, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.349966824054718, "acc": 0.9133803248405457, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.013570982962846756, "acc": 0.9972856640815735, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.36522960662841797, "acc": 0.9028448462486267, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.014487240463495255, "acc": 0.9970502853393555, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.2806990146636963, "acc": 0.9267784953117371, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.014692393131554127, "acc": 0.9970064759254456, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.299442321062088, "acc": 0.9250579476356506, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.014226405881345272, "acc": 0.9970570802688599, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.27151399850845337, "acc": 0.9330745339393616, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.016450565308332443, "acc": 0.9965676665306091, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.2691124379634857, "acc": 0.9275587797164917, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.015092078596353531, "acc": 0.9969242811203003, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.23947013914585114, "acc": 0.9364696741104126, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.016048969700932503, "acc": 0.9966529607772827, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.309787392616272, "acc": 0.9143664240837097, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.014222478494048119, "acc": 0.9970483183860779, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.3524738848209381, "acc": 0.9018205404281616, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.015467586927115917, "acc": 0.9968443512916565, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.3314281404018402, "acc": 0.923993706703186, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.014738061465322971, "acc": 0.9968737363815308, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.30686062574386597, "acc": 0.9275949001312256, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.016270503401756287, "acc": 0.9965435862541199, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.2643831670284271, "acc": 0.9218830466270447, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.01574832759797573, "acc": 0.9967349767684937, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.3175015151500702, "acc": 0.9117677211761475, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.01646353118121624, "acc": 0.9964690208435059, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.30734261870384216, "acc": 0.9222390055656433, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.017343515530228615, "acc": 0.9962836503982544, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.3078809678554535, "acc": 0.9151567816734314, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.01656835339963436, "acc": 0.9965155720710754, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.3120901584625244, "acc": 0.9161072373390198, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.01632157526910305, "acc": 0.9965929985046387, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.2660619914531708, "acc": 0.9282809495925903, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9169033169746399
