ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.3044348955154419, "acc": 0.8720175623893738, "length": 5.740262985229492, "mode": "train", "epoch": 1}
{"loss": 0.2858532667160034, "acc": 0.8884095549583435, "length": 5.987844944000244, "mode": "test", "epoch": 1}
{"loss": 0.1727689802646637, "acc": 0.9463307857513428, "length": 5.9977593421936035, "mode": "train", "epoch": 2}
{"loss": 0.2640412449836731, "acc": 0.8944680094718933, "length": 6.0, "mode": "test", "epoch": 2}
{"loss": 0.13363556563854218, "acc": 0.9635336399078369, "length": 5.999884128570557, "mode": "train", "epoch": 3}
{"loss": 0.19640877842903137, "acc": 0.9362725615501404, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.11924349516630173, "acc": 0.9687970876693726, "length": 5.999964237213135, "mode": "train", "epoch": 4}
{"loss": 0.16733869910240173, "acc": 0.9464017152786255, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.0977308377623558, "acc": 0.9747644662857056, "length": 5.999961853027344, "mode": "train", "epoch": 5}
{"loss": 0.15634030103683472, "acc": 0.947121798992157, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.08497942984104156, "acc": 0.9800683259963989, "length": 5.999993324279785, "mode": "train", "epoch": 6}
{"loss": 0.13324980437755585, "acc": 0.9602234959602356, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.07960423082113266, "acc": 0.982011616230011, "length": 5.999999523162842, "mode": "train", "epoch": 7}
{"loss": 0.12482637166976929, "acc": 0.9650813937187195, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.07107508927583694, "acc": 0.9836879968643188, "length": 6.0, "mode": "train", "epoch": 8}
{"loss": 0.11566531658172607, "acc": 0.9682124853134155, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.06014673784375191, "acc": 0.9862180352210999, "length": 6.0, "mode": "train", "epoch": 9}
{"loss": 0.12762805819511414, "acc": 0.9626161456108093, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.0444733127951622, "acc": 0.9905566573143005, "length": 6.0, "mode": "train", "epoch": 10}
{"loss": 0.11206170916557312, "acc": 0.9674142003059387, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.03940623253583908, "acc": 0.9921066761016846, "length": 6.0, "mode": "train", "epoch": 11}
{"loss": 0.10148617625236511, "acc": 0.9749559164047241, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.03262351080775261, "acc": 0.9932570457458496, "length": 6.0, "mode": "train", "epoch": 12}
{"loss": 0.09949356317520142, "acc": 0.9715259671211243, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.021916665136814117, "acc": 0.9954421520233154, "length": 6.0, "mode": "train", "epoch": 13}
{"loss": 0.0830996185541153, "acc": 0.9780548214912415, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.017304476350545883, "acc": 0.9968023896217346, "length": 6.0, "mode": "train", "epoch": 14}
{"loss": 0.06690073758363724, "acc": 0.9828586578369141, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.015521523542702198, "acc": 0.9973257184028625, "length": 6.0, "mode": "train", "epoch": 15}
{"loss": 0.06251528114080429, "acc": 0.9835125207901001, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.014349500648677349, "acc": 0.9975101351737976, "length": 6.0, "mode": "train", "epoch": 16}
{"loss": 0.05528287589550018, "acc": 0.9839298725128174, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.014232288114726543, "acc": 0.997575044631958, "length": 6.0, "mode": "train", "epoch": 17}
{"loss": 0.06219381093978882, "acc": 0.984878420829773, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.013752820901572704, "acc": 0.9976760149002075, "length": 6.0, "mode": "train", "epoch": 18}
{"loss": 0.06013952195644379, "acc": 0.9841964244842529, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.014836529269814491, "acc": 0.9973725080490112, "length": 6.0, "mode": "train", "epoch": 19}
{"loss": 0.05133000388741493, "acc": 0.9877628087997437, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.012141257524490356, "acc": 0.9980242252349854, "length": 6.0, "mode": "train", "epoch": 20}
{"loss": 0.06818368285894394, "acc": 0.9836390018463135, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.014543226920068264, "acc": 0.9974199533462524, "length": 6.0, "mode": "train", "epoch": 21}
{"loss": 0.05243627354502678, "acc": 0.9860197305679321, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.01398975308984518, "acc": 0.9976130127906799, "length": 6.0, "mode": "train", "epoch": 22}
{"loss": 0.0419861301779747, "acc": 0.9902780652046204, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.010774939320981503, "acc": 0.9983870387077332, "length": 6.0, "mode": "train", "epoch": 23}
{"loss": 0.05885009840130806, "acc": 0.9846137166023254, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.01169896312057972, "acc": 0.9981311559677124, "length": 6.0, "mode": "train", "epoch": 24}
{"loss": 0.041136011481285095, "acc": 0.9915236234664917, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.009806746616959572, "acc": 0.998504102230072, "length": 6.0, "mode": "train", "epoch": 25}
{"loss": 0.05591270700097084, "acc": 0.9847118854522705, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.010109752416610718, "acc": 0.9985107779502869, "length": 6.0, "mode": "train", "epoch": 26}
{"loss": 0.053498607128858566, "acc": 0.9873877167701721, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.00995776429772377, "acc": 0.998615026473999, "length": 6.0, "mode": "train", "epoch": 27}
{"loss": 0.04748457297682762, "acc": 0.9881377816200256, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.009798540733754635, "acc": 0.998555600643158, "length": 6.0, "mode": "train", "epoch": 28}
{"loss": 0.058030735701322556, "acc": 0.985628604888916, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.014359499327838421, "acc": 0.9972535371780396, "length": 6.0, "mode": "train", "epoch": 29}
{"loss": 0.04726903513073921, "acc": 0.9897724986076355, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.009746480733156204, "acc": 0.9985608458518982, "length": 6.0, "mode": "train", "epoch": 30}
{"loss": 0.043010275810956955, "acc": 0.9911625981330872, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.009628953412175179, "acc": 0.998585045337677, "length": 6.0, "mode": "train", "epoch": 31}
{"loss": 0.04490974172949791, "acc": 0.9879071116447449, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.009608668275177479, "acc": 0.9986443519592285, "length": 6.0, "mode": "train", "epoch": 32}
{"loss": 0.06376001983880997, "acc": 0.9857490062713623, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.01184255350381136, "acc": 0.9981364011764526, "length": 6.0, "mode": "train", "epoch": 33}
{"loss": 0.031715210527181625, "acc": 0.9936938881874084, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.012126623652875423, "acc": 0.9979593753814697, "length": 6.0, "mode": "train", "epoch": 34}
{"loss": 0.04646271467208862, "acc": 0.9888278245925903, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.010762201622128487, "acc": 0.9983429908752441, "length": 6.0, "mode": "train", "epoch": 35}
{"loss": 0.0415380634367466, "acc": 0.9904444217681885, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.009521551430225372, "acc": 0.9985916614532471, "length": 6.0, "mode": "train", "epoch": 36}
{"loss": 0.03811702877283096, "acc": 0.9907012581825256, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.009017563425004482, "acc": 0.9987480044364929, "length": 6.0, "mode": "train", "epoch": 37}
{"loss": 0.03984062373638153, "acc": 0.9898548722267151, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.009163683280348778, "acc": 0.9987172484397888, "length": 6.0, "mode": "train", "epoch": 38}
{"loss": 0.04129462316632271, "acc": 0.9906912446022034, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.008623797446489334, "acc": 0.9987913966178894, "length": 6.0, "mode": "train", "epoch": 39}
{"loss": 0.04776093363761902, "acc": 0.9895218014717102, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.011917057447135448, "acc": 0.9980409145355225, "length": 6.0, "mode": "train", "epoch": 40}
{"loss": 0.03885633125901222, "acc": 0.9903362393379211, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.010024386458098888, "acc": 0.9984386563301086, "length": 6.0, "mode": "train", "epoch": 41}
{"loss": 0.040379080921411514, "acc": 0.9907213449478149, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.00918851513415575, "acc": 0.9986765384674072, "length": 6.0, "mode": "train", "epoch": 42}
{"loss": 0.029002904891967773, "acc": 0.9931403398513794, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.012968363240361214, "acc": 0.9978309869766235, "length": 6.0, "mode": "train", "epoch": 43}
{"loss": 0.031556978821754456, "acc": 0.9935474991798401, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.009605721570551395, "acc": 0.9985636472702026, "length": 6.0, "mode": "train", "epoch": 44}
{"loss": 0.024747652933001518, "acc": 0.9950777888298035, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.01089832279831171, "acc": 0.9982407093048096, "length": 6.0, "mode": "train", "epoch": 45}
{"loss": 0.0436750128865242, "acc": 0.9905347228050232, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.008865201845765114, "acc": 0.9987968802452087, "length": 6.0, "mode": "train", "epoch": 46}
{"loss": 0.029326699674129486, "acc": 0.9946105480194092, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.018825314939022064, "acc": 0.9962623119354248, "length": 6.0, "mode": "train", "epoch": 47}
{"loss": 0.03163518011569977, "acc": 0.9933569431304932, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.012842503376305103, "acc": 0.9976658821105957, "length": 6.0, "mode": "train", "epoch": 48}
{"loss": 0.041129302233457565, "acc": 0.9922295808792114, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.011716346256434917, "acc": 0.9980596303939819, "length": 6.0, "mode": "train", "epoch": 49}
{"loss": 0.024578383192420006, "acc": 0.9956536293029785, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.01043821219354868, "acc": 0.9983998537063599, "length": 6.0, "mode": "train", "epoch": 50}
{"loss": 0.02668031118810177, "acc": 0.9948933124542236, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.011569339781999588, "acc": 0.9981123805046082, "length": 6.0, "mode": "train", "epoch": 51}
{"loss": 0.025689808651804924, "acc": 0.9949975609779358, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.010114951059222221, "acc": 0.9986009001731873, "length": 6.0, "mode": "train", "epoch": 52}
{"loss": 0.03448083624243736, "acc": 0.993738055229187, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.010264383628964424, "acc": 0.9984753131866455, "length": 6.0, "mode": "train", "epoch": 53}
{"loss": 0.024434344843029976, "acc": 0.9951480031013489, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.010072924196720123, "acc": 0.9985528588294983, "length": 6.0, "mode": "train", "epoch": 54}
{"loss": 0.03209984675049782, "acc": 0.9942575097084045, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.01078929752111435, "acc": 0.9984138607978821, "length": 6.0, "mode": "train", "epoch": 55}
{"loss": 0.026879070326685905, "acc": 0.9950899481773376, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.009287448599934578, "acc": 0.9986591935157776, "length": 6.0, "mode": "train", "epoch": 56}
{"loss": 0.02249850705265999, "acc": 0.9962833523750305, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.010835622437298298, "acc": 0.9984070658683777, "length": 6.0, "mode": "train", "epoch": 57}
{"loss": 0.024661395698785782, "acc": 0.9957998394966125, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.011201107874512672, "acc": 0.9981010556221008, "length": 6.0, "mode": "train", "epoch": 58}
{"loss": 0.021170414984226227, "acc": 0.9968810081481934, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.01059564109891653, "acc": 0.998336911201477, "length": 6.0, "mode": "train", "epoch": 59}
{"loss": 0.021988466382026672, "acc": 0.9962090849876404, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.011249874718487263, "acc": 0.9981933236122131, "length": 6.0, "mode": "train", "epoch": 60}
{"loss": 0.02799892984330654, "acc": 0.9950256943702698, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.9936639666557312
