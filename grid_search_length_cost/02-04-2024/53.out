ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 20
{"loss": 0.41817784309387207, "acc": 0.8063080906867981, "length": 4.698514461517334, "mode": "train", "epoch": 1}
{"loss": 0.3911605775356293, "acc": 0.8360169529914856, "length": 5.609177112579346, "mode": "test", "epoch": 1}
{"loss": 0.22145986557006836, "acc": 0.9291512370109558, "length": 5.926896095275879, "mode": "train", "epoch": 2}
{"loss": 0.2692195475101471, "acc": 0.9046308398246765, "length": 5.949654579162598, "mode": "test", "epoch": 2}
{"loss": 0.1826045662164688, "acc": 0.9462686777114868, "length": 6.136817455291748, "mode": "train", "epoch": 3}
{"loss": 0.22901701927185059, "acc": 0.9280462861061096, "length": 6.399417400360107, "mode": "test", "epoch": 3}
{"loss": 0.1588798314332962, "acc": 0.9566383957862854, "length": 6.356382846832275, "mode": "train", "epoch": 4}
{"loss": 0.17948725819587708, "acc": 0.948073148727417, "length": 5.9708356857299805, "mode": "test", "epoch": 4}
{"loss": 0.14282876253128052, "acc": 0.9625157713890076, "length": 6.335826873779297, "mode": "train", "epoch": 5}
{"loss": 0.17922773957252502, "acc": 0.9466229677200317, "length": 6.212169170379639, "mode": "test", "epoch": 5}
{"loss": 0.13338342308998108, "acc": 0.9655967950820923, "length": 6.36722993850708, "mode": "train", "epoch": 6}
{"loss": 0.15828940272331238, "acc": 0.9540706872940063, "length": 6.16225528717041, "mode": "test", "epoch": 6}
{"loss": 0.1253824234008789, "acc": 0.9681124687194824, "length": 6.470967769622803, "mode": "train", "epoch": 7}
{"loss": 0.15342803299427032, "acc": 0.9571992754936218, "length": 6.354142665863037, "mode": "test", "epoch": 7}
{"loss": 0.11904982477426529, "acc": 0.9702086448669434, "length": 6.570887088775635, "mode": "train", "epoch": 8}
{"loss": 0.1430077701807022, "acc": 0.9615703225135803, "length": 6.41890811920166, "mode": "test", "epoch": 8}
{"loss": 0.1111488789319992, "acc": 0.9729464650154114, "length": 6.6446757316589355, "mode": "train", "epoch": 9}
{"loss": 0.13806629180908203, "acc": 0.9643809795379639, "length": 6.481048583984375, "mode": "test", "epoch": 9}
{"loss": 0.10372941195964813, "acc": 0.9754517078399658, "length": 6.6607985496521, "mode": "train", "epoch": 10}
{"loss": 0.14368310570716858, "acc": 0.9587430357933044, "length": 6.45609188079834, "mode": "test", "epoch": 10}
{"loss": 0.09681738168001175, "acc": 0.9774706363677979, "length": 6.707420825958252, "mode": "train", "epoch": 11}
{"loss": 0.1163012683391571, "acc": 0.9702614545822144, "length": 6.723964214324951, "mode": "test", "epoch": 11}
{"loss": 0.09195201098918915, "acc": 0.9789043664932251, "length": 6.825109958648682, "mode": "train", "epoch": 12}
{"loss": 0.1169460266828537, "acc": 0.9698893427848816, "length": 6.828322887420654, "mode": "test", "epoch": 12}
{"loss": 0.08484473824501038, "acc": 0.9810432195663452, "length": 6.758265018463135, "mode": "train", "epoch": 13}
{"loss": 0.13339544832706451, "acc": 0.96221524477005, "length": 6.739966869354248, "mode": "test", "epoch": 13}
{"loss": 0.07958865165710449, "acc": 0.9829118847846985, "length": 6.735133171081543, "mode": "train", "epoch": 14}
{"loss": 0.09830101579427719, "acc": 0.9775338768959045, "length": 6.480077743530273, "mode": "test", "epoch": 14}
{"loss": 0.0762244239449501, "acc": 0.9840214252471924, "length": 6.796815872192383, "mode": "train", "epoch": 15}
{"loss": 0.10049383342266083, "acc": 0.9751901626586914, "length": 6.539736747741699, "mode": "test", "epoch": 15}
{"loss": 0.07563742250204086, "acc": 0.9839141368865967, "length": 6.705026626586914, "mode": "train", "epoch": 16}
{"loss": 0.09325516223907471, "acc": 0.9776757955551147, "length": 6.517405033111572, "mode": "test", "epoch": 16}
{"loss": 0.07144951820373535, "acc": 0.9849663972854614, "length": 6.672165870666504, "mode": "train", "epoch": 17}
{"loss": 0.096529521048069, "acc": 0.9763667583465576, "length": 6.51265811920166, "mode": "test", "epoch": 17}
{"loss": 0.06784638017416, "acc": 0.9860441088676453, "length": 6.79543924331665, "mode": "train", "epoch": 18}
{"loss": 0.09432625025510788, "acc": 0.9779393672943115, "length": 6.536140441894531, "mode": "test", "epoch": 18}
{"loss": 0.06505060195922852, "acc": 0.9869087934494019, "length": 6.742260456085205, "mode": "train", "epoch": 19}
{"loss": 0.0854562371969223, "acc": 0.9795063138008118, "length": 6.4487199783325195, "mode": "test", "epoch": 19}
{"loss": 0.06248101592063904, "acc": 0.9877558946609497, "length": 6.612271308898926, "mode": "train", "epoch": 20}
{"loss": 0.07663902640342712, "acc": 0.9832764267921448, "length": 6.369965553283691, "mode": "test", "epoch": 20}
{"loss": 0.06037188321352005, "acc": 0.9884491562843323, "length": 6.5633111000061035, "mode": "train", "epoch": 21}
{"loss": 0.07600974291563034, "acc": 0.9842665791511536, "length": 6.538442134857178, "mode": "test", "epoch": 21}
{"loss": 0.059301670640707016, "acc": 0.988723635673523, "length": 6.588427543640137, "mode": "train", "epoch": 22}
{"loss": 0.06948859989643097, "acc": 0.9855416417121887, "length": 6.52459716796875, "mode": "test", "epoch": 22}
{"loss": 0.05830780044198036, "acc": 0.9890551567077637, "length": 6.612142086029053, "mode": "train", "epoch": 23}
{"loss": 0.07103247940540314, "acc": 0.9857693314552307, "length": 6.585587024688721, "mode": "test", "epoch": 23}
{"loss": 0.057150114327669144, "acc": 0.9893540740013123, "length": 6.663898944854736, "mode": "train", "epoch": 24}
{"loss": 0.0650923103094101, "acc": 0.9874390363693237, "length": 6.590801239013672, "mode": "test", "epoch": 24}
{"loss": 0.0558590292930603, "acc": 0.989779531955719, "length": 6.649422645568848, "mode": "train", "epoch": 25}
{"loss": 0.06680053472518921, "acc": 0.9874183535575867, "length": 6.469936847686768, "mode": "test", "epoch": 25}
{"loss": 0.05606946721673012, "acc": 0.9895832538604736, "length": 6.6521992683410645, "mode": "train", "epoch": 26}
{"loss": 0.06456898897886276, "acc": 0.9877865314483643, "length": 6.64992094039917, "mode": "test", "epoch": 26}
{"loss": 0.05429714918136597, "acc": 0.9899494647979736, "length": 6.591974258422852, "mode": "train", "epoch": 27}
{"loss": 0.06580718606710434, "acc": 0.9861828684806824, "length": 6.383055210113525, "mode": "test", "epoch": 27}
{"loss": 0.05381781980395317, "acc": 0.9898151159286499, "length": 6.538644313812256, "mode": "train", "epoch": 28}
{"loss": 0.06193153187632561, "acc": 0.9879844188690186, "length": 6.500107765197754, "mode": "test", "epoch": 28}
{"loss": 0.05206950753927231, "acc": 0.9901244640350342, "length": 6.553403854370117, "mode": "train", "epoch": 29}
{"loss": 0.058945104479789734, "acc": 0.9879359006881714, "length": 6.407148838043213, "mode": "test", "epoch": 29}
{"loss": 0.050052210688591, "acc": 0.9905807375907898, "length": 6.625280380249023, "mode": "train", "epoch": 30}
{"loss": 0.05781016871333122, "acc": 0.9893152713775635, "length": 6.582602024078369, "mode": "test", "epoch": 30}
{"loss": 0.04878048598766327, "acc": 0.9909512400627136, "length": 6.581252098083496, "mode": "train", "epoch": 31}
{"loss": 0.06025925651192665, "acc": 0.9887444376945496, "length": 6.543440818786621, "mode": "test", "epoch": 31}
{"loss": 0.04989084601402283, "acc": 0.9905700087547302, "length": 6.6436591148376465, "mode": "train", "epoch": 32}
{"loss": 0.06072554364800453, "acc": 0.9881190657615662, "length": 6.509098052978516, "mode": "test", "epoch": 32}
{"loss": 0.04686835780739784, "acc": 0.9915035963058472, "length": 6.627368450164795, "mode": "train", "epoch": 33}
{"loss": 0.0622032955288887, "acc": 0.9875641465187073, "length": 6.598173141479492, "mode": "test", "epoch": 33}
{"loss": 0.04701942205429077, "acc": 0.9914385080337524, "length": 6.701290130615234, "mode": "train", "epoch": 34}
{"loss": 0.058005690574645996, "acc": 0.989111602306366, "length": 6.615434169769287, "mode": "test", "epoch": 34}
{"loss": 0.04541873186826706, "acc": 0.9918254017829895, "length": 6.717113494873047, "mode": "train", "epoch": 35}
{"loss": 0.05158264935016632, "acc": 0.9906083345413208, "length": 6.594325542449951, "mode": "test", "epoch": 35}
{"loss": 0.045316580682992935, "acc": 0.9918712973594666, "length": 6.704723834991455, "mode": "train", "epoch": 36}
{"loss": 0.055059123784303665, "acc": 0.9889129400253296, "length": 6.61834716796875, "mode": "test", "epoch": 36}
{"loss": 0.04337982088327408, "acc": 0.9921082854270935, "length": 6.6946940422058105, "mode": "train", "epoch": 37}
{"loss": 0.05401070415973663, "acc": 0.9896701574325562, "length": 7.326057434082031, "mode": "test", "epoch": 37}
{"loss": 0.0429280623793602, "acc": 0.9922849535942078, "length": 6.890892028808594, "mode": "train", "epoch": 38}
{"loss": 0.049768779426813126, "acc": 0.9908401370048523, "length": 6.736262798309326, "mode": "test", "epoch": 38}
{"loss": 0.041473571211099625, "acc": 0.9925593137741089, "length": 6.704925060272217, "mode": "train", "epoch": 39}
{"loss": 0.05189356580376625, "acc": 0.9902591109275818, "length": 6.627193450927734, "mode": "test", "epoch": 39}
{"loss": 0.040537942200899124, "acc": 0.9927253127098083, "length": 6.821506977081299, "mode": "train", "epoch": 40}
{"loss": 0.0456635020673275, "acc": 0.991792619228363, "length": 6.722561836242676, "mode": "test", "epoch": 40}
{"loss": 0.03970177844166756, "acc": 0.9930360913276672, "length": 6.872080326080322, "mode": "train", "epoch": 41}
{"loss": 0.04640820994973183, "acc": 0.9919612407684326, "length": 6.768771648406982, "mode": "test", "epoch": 41}
{"loss": 0.03964866325259209, "acc": 0.9930439591407776, "length": 6.911161422729492, "mode": "train", "epoch": 42}
{"loss": 0.04681266471743584, "acc": 0.991199254989624, "length": 6.905818462371826, "mode": "test", "epoch": 42}
{"loss": 0.03813593089580536, "acc": 0.9934431910514832, "length": 6.947844505310059, "mode": "train", "epoch": 43}
{"loss": 0.04027806594967842, "acc": 0.9933622479438782, "length": 6.797828197479248, "mode": "test", "epoch": 43}
{"loss": 0.03904102370142937, "acc": 0.9930915236473083, "length": 6.8746562004089355, "mode": "train", "epoch": 44}
{"loss": 0.0481131486594677, "acc": 0.9904734492301941, "length": 7.057789325714111, "mode": "test", "epoch": 44}
{"loss": 0.036911141127347946, "acc": 0.9937375783920288, "length": 7.058513641357422, "mode": "train", "epoch": 45}
{"loss": 0.04244064539670944, "acc": 0.9929444193840027, "length": 7.114715099334717, "mode": "test", "epoch": 45}
{"loss": 0.036701466888189316, "acc": 0.993714451789856, "length": 7.00388240814209, "mode": "train", "epoch": 46}
{"loss": 0.04112586751580238, "acc": 0.9929391741752625, "length": 6.930163860321045, "mode": "test", "epoch": 46}
{"loss": 0.03726402670145035, "acc": 0.993435800075531, "length": 6.977208614349365, "mode": "train", "epoch": 47}
{"loss": 0.04185255244374275, "acc": 0.9926681518554688, "length": 6.879890441894531, "mode": "test", "epoch": 47}
{"loss": 0.03417307138442993, "acc": 0.9942744970321655, "length": 7.051901340484619, "mode": "train", "epoch": 48}
{"loss": 0.04114939272403717, "acc": 0.9926974773406982, "length": 7.06282377243042, "mode": "test", "epoch": 48}
{"loss": 0.034131553024053574, "acc": 0.9942086935043335, "length": 7.052346229553223, "mode": "train", "epoch": 49}
{"loss": 0.038645222783088684, "acc": 0.9935369491577148, "length": 7.039952754974365, "mode": "test", "epoch": 49}
{"loss": 0.03372655063867569, "acc": 0.9942103624343872, "length": 6.890465259552002, "mode": "train", "epoch": 50}
{"loss": 0.037937015295028687, "acc": 0.993602454662323, "length": 6.926388263702393, "mode": "test", "epoch": 50}
{"loss": 0.03275996446609497, "acc": 0.9944339394569397, "length": 6.977810382843018, "mode": "train", "epoch": 51}
{"loss": 0.03984875604510307, "acc": 0.9927849173545837, "length": 7.064873218536377, "mode": "test", "epoch": 51}
{"loss": 0.03248802572488785, "acc": 0.9944939613342285, "length": 7.095182418823242, "mode": "train", "epoch": 52}
{"loss": 0.04094584286212921, "acc": 0.9928824305534363, "length": 7.4508056640625, "mode": "test", "epoch": 52}
{"loss": 0.03221623972058296, "acc": 0.9946310520172119, "length": 7.557620048522949, "mode": "train", "epoch": 53}
{"loss": 0.038616809993982315, "acc": 0.9936295747756958, "length": 7.37395715713501, "mode": "test", "epoch": 53}
{"loss": 0.03011426515877247, "acc": 0.9950234889984131, "length": 7.269817352294922, "mode": "train", "epoch": 54}
{"loss": 0.036679547280073166, "acc": 0.9935259222984314, "length": 7.16890811920166, "mode": "test", "epoch": 54}
{"loss": 0.030078303068876266, "acc": 0.9950564503669739, "length": 7.163597106933594, "mode": "train", "epoch": 55}
{"loss": 0.033918801695108414, "acc": 0.9944344162940979, "length": 7.00032377243042, "mode": "test", "epoch": 55}
{"loss": 0.031217847019433975, "acc": 0.9946569800376892, "length": 7.1799845695495605, "mode": "train", "epoch": 56}
{"loss": 0.04166052117943764, "acc": 0.9921141266822815, "length": 7.516038417816162, "mode": "test", "epoch": 56}
{"loss": 0.03303102031350136, "acc": 0.9941934943199158, "length": 7.5016770362854, "mode": "train", "epoch": 57}
{"loss": 0.03896498307585716, "acc": 0.9929558634757996, "length": 7.3409810066223145, "mode": "test", "epoch": 57}
{"loss": 0.030565354973077774, "acc": 0.9947288036346436, "length": 7.403196334838867, "mode": "train", "epoch": 58}
{"loss": 0.03738367184996605, "acc": 0.9930567145347595, "length": 7.355293273925781, "mode": "test", "epoch": 58}
{"loss": 0.03288368880748749, "acc": 0.994112491607666, "length": 7.661017417907715, "mode": "train", "epoch": 59}
{"loss": 0.04053746908903122, "acc": 0.9928590059280396, "length": 7.772619247436523, "mode": "test", "epoch": 59}
{"loss": 0.028414038941264153, "acc": 0.9954705834388733, "length": 7.600503921508789, "mode": "train", "epoch": 60}
{"loss": 0.03312208503484726, "acc": 0.9942838549613953, "length": 7.556962013244629, "mode": "test", "epoch": 60}
test accuracy: 0.9824947714805603
