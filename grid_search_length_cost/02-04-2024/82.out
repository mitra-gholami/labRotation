ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 10
{"loss": 0.33022236824035645, "acc": 0.8563950061798096, "length": 6.931143283843994, "mode": "train", "epoch": 1}
{"loss": 0.3041055202484131, "acc": 0.8820863366127014, "length": 9.256410598754883, "mode": "test", "epoch": 1}
{"loss": 0.18767257034778595, "acc": 0.9431562423706055, "length": 9.57269287109375, "mode": "train", "epoch": 2}
{"loss": 0.21126443147659302, "acc": 0.9293139576911926, "length": 9.828245162963867, "mode": "test", "epoch": 2}
{"loss": 0.1410927176475525, "acc": 0.9605380892753601, "length": 10.090612411499023, "mode": "train", "epoch": 3}
{"loss": 0.19317689538002014, "acc": 0.9372195601463318, "length": 10.036458015441895, "mode": "test", "epoch": 3}
{"loss": 0.10769269615411758, "acc": 0.9728041291236877, "length": 10.461451530456543, "mode": "train", "epoch": 4}
{"loss": 0.16696546971797943, "acc": 0.9455167055130005, "length": 10.181449890136719, "mode": "test", "epoch": 4}
{"loss": 0.09589201956987381, "acc": 0.9777783751487732, "length": 10.575014114379883, "mode": "train", "epoch": 5}
{"loss": 0.15063171088695526, "acc": 0.9541463255882263, "length": 10.594230651855469, "mode": "test", "epoch": 5}
{"loss": 0.0814662054181099, "acc": 0.9822868704795837, "length": 10.71833610534668, "mode": "train", "epoch": 6}
{"loss": 0.11963776499032974, "acc": 0.9659728407859802, "length": 10.680849075317383, "mode": "test", "epoch": 6}
{"loss": 0.06448700278997421, "acc": 0.9870071411132812, "length": 10.758292198181152, "mode": "train", "epoch": 7}
{"loss": 0.11380337178707123, "acc": 0.9686657190322876, "length": 10.634174346923828, "mode": "test", "epoch": 7}
{"loss": 0.056092265993356705, "acc": 0.9895610809326172, "length": 10.76130199432373, "mode": "train", "epoch": 8}
{"loss": 0.08536313474178314, "acc": 0.9775212407112122, "length": 10.809374809265137, "mode": "test", "epoch": 8}
{"loss": 0.04610467329621315, "acc": 0.9925426840782166, "length": 10.775976181030273, "mode": "train", "epoch": 9}
{"loss": 0.07598092406988144, "acc": 0.9834117889404297, "length": 10.787740707397461, "mode": "test", "epoch": 9}
{"loss": 0.03745518624782562, "acc": 0.9938592910766602, "length": 10.76340103149414, "mode": "train", "epoch": 10}
{"loss": 0.08188864588737488, "acc": 0.9745871424674988, "length": 10.783293724060059, "mode": "test", "epoch": 10}
{"loss": 0.026100894436240196, "acc": 0.9967333674430847, "length": 10.757964134216309, "mode": "train", "epoch": 11}
{"loss": 0.07239442318677902, "acc": 0.9791854619979858, "length": 10.777764320373535, "mode": "test", "epoch": 11}
{"loss": 0.023865344002842903, "acc": 0.9973681569099426, "length": 10.781208038330078, "mode": "train", "epoch": 12}
{"loss": 0.05320722609758377, "acc": 0.9862166047096252, "length": 10.734615325927734, "mode": "test", "epoch": 12}
{"loss": 0.02194441668689251, "acc": 0.9978644847869873, "length": 10.754144668579102, "mode": "train", "epoch": 13}
{"loss": 0.06047511845827103, "acc": 0.9823175668716431, "length": 10.758413314819336, "mode": "test", "epoch": 13}
{"loss": 0.021827513352036476, "acc": 0.9977250099182129, "length": 10.75395393371582, "mode": "train", "epoch": 14}
{"loss": 0.06961727887392044, "acc": 0.9809522032737732, "length": 10.812820434570312, "mode": "test", "epoch": 14}
{"loss": 0.018892860040068626, "acc": 0.9984775185585022, "length": 10.804487228393555, "mode": "train", "epoch": 15}
{"loss": 0.05603907257318497, "acc": 0.9846243858337402, "length": 10.834135055541992, "mode": "test", "epoch": 15}
{"loss": 0.019978750497102737, "acc": 0.9981075525283813, "length": 10.841560363769531, "mode": "train", "epoch": 16}
{"loss": 0.05586966872215271, "acc": 0.9855021238327026, "length": 10.878205299377441, "mode": "test", "epoch": 16}
{"loss": 0.018574584275484085, "acc": 0.9985606074333191, "length": 10.828116416931152, "mode": "train", "epoch": 17}
{"loss": 0.043007511645555496, "acc": 0.9895362854003906, "length": 10.918709754943848, "mode": "test", "epoch": 17}
{"loss": 0.01695333980023861, "acc": 0.9988784790039062, "length": 10.807740211486816, "mode": "train", "epoch": 18}
{"loss": 0.049484733492136, "acc": 0.9869205355644226, "length": 10.841987609863281, "mode": "test", "epoch": 18}
{"loss": 0.01782034896314144, "acc": 0.9987160563468933, "length": 10.80696964263916, "mode": "train", "epoch": 19}
{"loss": 0.04061886668205261, "acc": 0.9904797077178955, "length": 10.858133316040039, "mode": "test", "epoch": 19}
{"loss": 0.016923673450946808, "acc": 0.9988338351249695, "length": 10.82046127319336, "mode": "train", "epoch": 20}
{"loss": 0.03843114525079727, "acc": 0.9916814565658569, "length": 10.860095977783203, "mode": "test", "epoch": 20}
{"loss": 0.017276862636208534, "acc": 0.9988114237785339, "length": 10.840377807617188, "mode": "train", "epoch": 21}
{"loss": 0.057438455522060394, "acc": 0.9832432866096497, "length": 10.865425109863281, "mode": "test", "epoch": 21}
{"loss": 0.016533905640244484, "acc": 0.9989132881164551, "length": 10.845267295837402, "mode": "train", "epoch": 22}
{"loss": 0.045805372297763824, "acc": 0.9879856109619141, "length": 10.865345001220703, "mode": "test", "epoch": 22}
{"loss": 0.015861595049500465, "acc": 0.9990171194076538, "length": 10.87199878692627, "mode": "train", "epoch": 23}
{"loss": 0.0431160070002079, "acc": 0.9887100458145142, "length": 10.845833778381348, "mode": "test", "epoch": 23}
{"loss": 0.01739613711833954, "acc": 0.998753547668457, "length": 10.859968185424805, "mode": "train", "epoch": 24}
{"loss": 0.03541700914502144, "acc": 0.9940146207809448, "length": 10.800360679626465, "mode": "test", "epoch": 24}
{"loss": 0.018884999677538872, "acc": 0.9982091784477234, "length": 10.878678321838379, "mode": "train", "epoch": 25}
{"loss": 0.032527584582567215, "acc": 0.994207501411438, "length": 10.946514129638672, "mode": "test", "epoch": 25}
{"loss": 0.01591447740793228, "acc": 0.9990220069885254, "length": 10.891719818115234, "mode": "train", "epoch": 26}
{"loss": 0.03438214585185051, "acc": 0.9922760725021362, "length": 10.923196792602539, "mode": "test", "epoch": 26}
{"loss": 0.018918374553322792, "acc": 0.9982975721359253, "length": 10.892288208007812, "mode": "train", "epoch": 27}
{"loss": 0.03847433254122734, "acc": 0.9928591251373291, "length": 10.850120544433594, "mode": "test", "epoch": 27}
{"loss": 0.015293228439986706, "acc": 0.9991419315338135, "length": 10.879249572753906, "mode": "train", "epoch": 28}
{"loss": 0.028191693127155304, "acc": 0.9957584738731384, "length": 10.969951629638672, "mode": "test", "epoch": 28}
{"loss": 0.017804907634854317, "acc": 0.9985750913619995, "length": 10.923785209655762, "mode": "train", "epoch": 29}
{"loss": 0.024967320263385773, "acc": 0.9968464970588684, "length": 10.996834754943848, "mode": "test", "epoch": 29}
{"loss": 0.015513541176915169, "acc": 0.999143660068512, "length": 10.968316078186035, "mode": "train", "epoch": 30}
{"loss": 0.029487648978829384, "acc": 0.9952322244644165, "length": 10.996794700622559, "mode": "test", "epoch": 30}
{"loss": 0.015663079917430878, "acc": 0.9991533756256104, "length": 10.928022384643555, "mode": "train", "epoch": 31}
{"loss": 0.018544211983680725, "acc": 0.9986342787742615, "length": 10.965224266052246, "mode": "test", "epoch": 31}
{"loss": 0.015763642266392708, "acc": 0.9990783929824829, "length": 10.9556884765625, "mode": "train", "epoch": 32}
{"loss": 0.021397262811660767, "acc": 0.9978913068771362, "length": 10.998517990112305, "mode": "test", "epoch": 32}
{"loss": 0.01568634808063507, "acc": 0.9991132616996765, "length": 10.9818696975708, "mode": "train", "epoch": 33}
{"loss": 0.021069971844553947, "acc": 0.9976581931114197, "length": 11.0, "mode": "test", "epoch": 33}
{"loss": 0.015614194795489311, "acc": 0.9991331696510315, "length": 10.979972839355469, "mode": "train", "epoch": 34}
{"loss": 0.023674258962273598, "acc": 0.9975427985191345, "length": 10.999319076538086, "mode": "test", "epoch": 34}
{"loss": 0.014623441733419895, "acc": 0.9993120431900024, "length": 10.97890853881836, "mode": "train", "epoch": 35}
{"loss": 0.019714802503585815, "acc": 0.9985436201095581, "length": 10.999919891357422, "mode": "test", "epoch": 35}
{"loss": 0.017842920497059822, "acc": 0.9986432790756226, "length": 10.943239212036133, "mode": "train", "epoch": 36}
{"loss": 0.017586126923561096, "acc": 0.9986591339111328, "length": 10.995793342590332, "mode": "test", "epoch": 36}
{"loss": 0.014623983763158321, "acc": 0.9993409514427185, "length": 10.977314949035645, "mode": "train", "epoch": 37}
{"loss": 0.017217643558979034, "acc": 0.9987560510635376, "length": 10.999919891357422, "mode": "test", "epoch": 37}
{"loss": 0.015233023092150688, "acc": 0.9992077946662903, "length": 10.99170970916748, "mode": "train", "epoch": 38}
{"loss": 0.019115285947918892, "acc": 0.9981409311294556, "length": 10.999959945678711, "mode": "test", "epoch": 38}
{"loss": 0.014483146369457245, "acc": 0.999365508556366, "length": 10.990221977233887, "mode": "train", "epoch": 39}
{"loss": 0.018670961260795593, "acc": 0.9984394311904907, "length": 11.0, "mode": "test", "epoch": 39}
{"loss": 0.014216861687600613, "acc": 0.9994292259216309, "length": 10.997654914855957, "mode": "train", "epoch": 40}
{"loss": 0.015152460895478725, "acc": 0.9991305470466614, "length": 11.0, "mode": "test", "epoch": 40}
{"loss": 0.01920241490006447, "acc": 0.9982460737228394, "length": 10.999394416809082, "mode": "train", "epoch": 41}
{"loss": 0.04461650922894478, "acc": 0.9920333623886108, "length": 11.0, "mode": "test", "epoch": 41}
{"loss": 0.01839352957904339, "acc": 0.9983205199241638, "length": 10.999813079833984, "mode": "train", "epoch": 42}
{"loss": 0.017913762480020523, "acc": 0.9987539649009705, "length": 11.0, "mode": "test", "epoch": 42}
{"loss": 0.0192386656999588, "acc": 0.9979908466339111, "length": 10.99989128112793, "mode": "train", "epoch": 43}
{"loss": 0.023196805268526077, "acc": 0.996833086013794, "length": 11.0, "mode": "test", "epoch": 43}
{"loss": 0.015457083471119404, "acc": 0.9990953207015991, "length": 10.999981880187988, "mode": "train", "epoch": 44}
{"loss": 0.020070811733603477, "acc": 0.9982792139053345, "length": 11.0, "mode": "test", "epoch": 44}
{"loss": 0.014553222805261612, "acc": 0.9993481040000916, "length": 10.999994277954102, "mode": "train", "epoch": 45}
{"loss": 0.01580393873155117, "acc": 0.9992087483406067, "length": 11.0, "mode": "test", "epoch": 45}
{"loss": 0.014330812729895115, "acc": 0.9993654489517212, "length": 10.999984741210938, "mode": "train", "epoch": 46}
{"loss": 0.018216660246253014, "acc": 0.9983693361282349, "length": 11.0, "mode": "test", "epoch": 46}
{"loss": 0.018316833302378654, "acc": 0.9983592629432678, "length": 10.999983787536621, "mode": "train", "epoch": 47}
{"loss": 0.0261512603610754, "acc": 0.9968388676643372, "length": 11.0, "mode": "test", "epoch": 47}
{"loss": 0.01612013392150402, "acc": 0.9989816546440125, "length": 10.999990463256836, "mode": "train", "epoch": 48}
{"loss": 0.015249774791300297, "acc": 0.9994071125984192, "length": 11.0, "mode": "test", "epoch": 48}
{"loss": 0.016308793798089027, "acc": 0.9989571571350098, "length": 10.999988555908203, "mode": "train", "epoch": 49}
{"loss": 0.016545690596103668, "acc": 0.9989583492279053, "length": 11.0, "mode": "test", "epoch": 49}
{"loss": 0.015202741138637066, "acc": 0.9991753697395325, "length": 10.999981880187988, "mode": "train", "epoch": 50}
{"loss": 0.02345260977745056, "acc": 0.9974159598350525, "length": 11.0, "mode": "test", "epoch": 50}
{"loss": 0.016389284282922745, "acc": 0.9988998174667358, "length": 10.99999713897705, "mode": "train", "epoch": 51}
{"loss": 0.02456294745206833, "acc": 0.9971895813941956, "length": 11.0, "mode": "test", "epoch": 51}
{"loss": 0.017129093408584595, "acc": 0.9986648559570312, "length": 10.999998092651367, "mode": "train", "epoch": 52}
{"loss": 0.02008669264614582, "acc": 0.9980087876319885, "length": 11.0, "mode": "test", "epoch": 52}
{"loss": 0.014629309996962547, "acc": 0.9993007779121399, "length": 11.0, "mode": "train", "epoch": 53}
{"loss": 0.017571743577718735, "acc": 0.9986177682876587, "length": 11.0, "mode": "test", "epoch": 53}
{"loss": 0.016409263014793396, "acc": 0.998819887638092, "length": 11.0, "mode": "train", "epoch": 54}
{"loss": 0.0251848753541708, "acc": 0.9969310164451599, "length": 11.0, "mode": "test", "epoch": 54}
{"loss": 0.02452828921377659, "acc": 0.9967880249023438, "length": 11.0, "mode": "train", "epoch": 55}
{"loss": 0.028600245714187622, "acc": 0.9961698055267334, "length": 11.0, "mode": "test", "epoch": 55}
{"loss": 0.018078623339533806, "acc": 0.9984240531921387, "length": 11.0, "mode": "train", "epoch": 56}
{"loss": 0.020302223041653633, "acc": 0.9982733130455017, "length": 11.0, "mode": "test", "epoch": 56}
{"loss": 0.015787377953529358, "acc": 0.9989685416221619, "length": 11.0, "mode": "train", "epoch": 57}
{"loss": 0.019174637272953987, "acc": 0.9982552528381348, "length": 11.0, "mode": "test", "epoch": 57}
{"loss": 0.014809494838118553, "acc": 0.9992787837982178, "length": 11.0, "mode": "train", "epoch": 58}
{"loss": 0.015156530775129795, "acc": 0.9990323781967163, "length": 11.0, "mode": "test", "epoch": 58}
{"loss": 0.014474347233772278, "acc": 0.9993735551834106, "length": 11.0, "mode": "train", "epoch": 59}
{"loss": 0.01679360494017601, "acc": 0.9989363551139832, "length": 11.0, "mode": "test", "epoch": 59}
{"loss": 0.016285249963402748, "acc": 0.9990111589431763, "length": 11.0, "mode": "train", "epoch": 60}
{"loss": 0.017889173701405525, "acc": 0.9988080859184265, "length": 11.0, "mode": "test", "epoch": 60}
test accuracy: 0.9986205101013184
