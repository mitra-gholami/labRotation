ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=20"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 20
{"loss": 0.4323226809501648, "acc": 0.7985262274742126, "length": 3.9931769371032715, "mode": "train", "epoch": 1}
{"loss": 0.32849106192588806, "acc": 0.8717573881149292, "length": 4.847962379455566, "mode": "test", "epoch": 1}
{"loss": 0.2614694833755493, "acc": 0.9096593856811523, "length": 5.249492645263672, "mode": "train", "epoch": 2}
{"loss": 0.2580150067806244, "acc": 0.9101662635803223, "length": 5.184439659118652, "mode": "test", "epoch": 2}
{"loss": 0.21987378597259521, "acc": 0.9299150705337524, "length": 5.213309288024902, "mode": "train", "epoch": 3}
{"loss": 0.2223977893590927, "acc": 0.92832350730896, "length": 5.102858543395996, "mode": "test", "epoch": 3}
{"loss": 0.1929473727941513, "acc": 0.9406774044036865, "length": 5.249780178070068, "mode": "train", "epoch": 4}
{"loss": 0.19705386459827423, "acc": 0.9402240514755249, "length": 5.035678386688232, "mode": "test", "epoch": 4}
{"loss": 0.16280895471572876, "acc": 0.9545662999153137, "length": 5.2421746253967285, "mode": "train", "epoch": 5}
{"loss": 0.17314502596855164, "acc": 0.952094554901123, "length": 5.045146942138672, "mode": "test", "epoch": 5}
{"loss": 0.1493782252073288, "acc": 0.9601721167564392, "length": 5.236817359924316, "mode": "train", "epoch": 6}
{"loss": 0.16389799118041992, "acc": 0.9545093178749084, "length": 5.0517354011535645, "mode": "test", "epoch": 6}
{"loss": 0.1400311142206192, "acc": 0.9632887840270996, "length": 5.170812129974365, "mode": "train", "epoch": 7}
{"loss": 0.1555379033088684, "acc": 0.9557849764823914, "length": 5.08244514465332, "mode": "test", "epoch": 7}
{"loss": 0.13411299884319305, "acc": 0.9652817845344543, "length": 5.161497592926025, "mode": "train", "epoch": 8}
{"loss": 0.15084418654441833, "acc": 0.960242748260498, "length": 4.966553688049316, "mode": "test", "epoch": 8}
{"loss": 0.12888169288635254, "acc": 0.9669098258018494, "length": 5.200273513793945, "mode": "train", "epoch": 9}
{"loss": 0.14846257865428925, "acc": 0.9586740136146545, "length": 5.003636360168457, "mode": "test", "epoch": 9}
{"loss": 0.12412197887897491, "acc": 0.9683977365493774, "length": 5.252023696899414, "mode": "train", "epoch": 10}
{"loss": 0.13614259660243988, "acc": 0.965705156326294, "length": 5.0783772468566895, "mode": "test", "epoch": 10}
{"loss": 0.12431517243385315, "acc": 0.9682122468948364, "length": 5.220824241638184, "mode": "train", "epoch": 11}
{"loss": 0.13132309913635254, "acc": 0.9645651578903198, "length": 5.047595024108887, "mode": "test", "epoch": 11}
{"loss": 0.11641302704811096, "acc": 0.9710942506790161, "length": 5.19541072845459, "mode": "train", "epoch": 12}
{"loss": 0.13718153536319733, "acc": 0.9635089635848999, "length": 5.041726589202881, "mode": "test", "epoch": 12}
{"loss": 0.11348577588796616, "acc": 0.9719781875610352, "length": 5.199260234832764, "mode": "train", "epoch": 13}
{"loss": 0.12783394753932953, "acc": 0.9670467972755432, "length": 5.187067985534668, "mode": "test", "epoch": 13}
{"loss": 0.10936181247234344, "acc": 0.973334789276123, "length": 5.218329906463623, "mode": "train", "epoch": 14}
{"loss": 0.1214609369635582, "acc": 0.9692813754081726, "length": 5.175799369812012, "mode": "test", "epoch": 14}
{"loss": 0.1051807627081871, "acc": 0.974750280380249, "length": 5.21466064453125, "mode": "train", "epoch": 15}
{"loss": 0.11901365220546722, "acc": 0.9706115126609802, "length": 5.123019695281982, "mode": "test", "epoch": 15}
{"loss": 0.10244228690862656, "acc": 0.9755002856254578, "length": 5.231532573699951, "mode": "train", "epoch": 16}
{"loss": 0.11040099710226059, "acc": 0.9731777310371399, "length": 5.223862171173096, "mode": "test", "epoch": 16}
{"loss": 0.10018881410360336, "acc": 0.9762564301490784, "length": 5.259890079498291, "mode": "train", "epoch": 17}
{"loss": 0.11856839060783386, "acc": 0.9660099148750305, "length": 5.222926139831543, "mode": "test", "epoch": 17}
{"loss": 0.09962721914052963, "acc": 0.9761964678764343, "length": 5.337581157684326, "mode": "train", "epoch": 18}
{"loss": 0.10981548577547073, "acc": 0.9730609059333801, "length": 5.261484622955322, "mode": "test", "epoch": 18}
{"loss": 0.09587361663579941, "acc": 0.97748863697052, "length": 5.395171165466309, "mode": "train", "epoch": 19}
{"loss": 0.10558398813009262, "acc": 0.9751143455505371, "length": 5.2412872314453125, "mode": "test", "epoch": 19}
{"loss": 0.09301255643367767, "acc": 0.9783213138580322, "length": 5.333640098571777, "mode": "train", "epoch": 20}
{"loss": 0.10717018693685532, "acc": 0.9733461737632751, "length": 5.279053688049316, "mode": "test", "epoch": 20}
{"loss": 0.09080491960048676, "acc": 0.9790641069412231, "length": 5.410811424255371, "mode": "train", "epoch": 21}
{"loss": 0.0983864814043045, "acc": 0.9782124161720276, "length": 5.363839149475098, "mode": "test", "epoch": 21}
{"loss": 0.08706819266080856, "acc": 0.9802640676498413, "length": 5.504565715789795, "mode": "train", "epoch": 22}
{"loss": 0.09983434528112411, "acc": 0.9756461977958679, "length": 5.494563579559326, "mode": "test", "epoch": 22}
{"loss": 0.08333271741867065, "acc": 0.9816765785217285, "length": 5.476884365081787, "mode": "train", "epoch": 23}
{"loss": 0.0983215793967247, "acc": 0.9752928018569946, "length": 5.4921875, "mode": "test", "epoch": 23}
{"loss": 0.0831136405467987, "acc": 0.9817910194396973, "length": 5.464883804321289, "mode": "train", "epoch": 24}
{"loss": 0.08931557089090347, "acc": 0.9800497889518738, "length": 5.374855995178223, "mode": "test", "epoch": 24}
{"loss": 0.08427561819553375, "acc": 0.9814150333404541, "length": 5.515909671783447, "mode": "train", "epoch": 25}
{"loss": 0.10054076462984085, "acc": 0.9773845672607422, "length": 5.660390377044678, "mode": "test", "epoch": 25}
{"loss": 0.08297686278820038, "acc": 0.9816796779632568, "length": 5.565088272094727, "mode": "train", "epoch": 26}
{"loss": 0.08979547023773193, "acc": 0.9807196259498596, "length": 5.432999610900879, "mode": "test", "epoch": 26}
{"loss": 0.07990214228630066, "acc": 0.9826394319534302, "length": 5.521487236022949, "mode": "train", "epoch": 27}
{"loss": 0.08844735473394394, "acc": 0.9800669550895691, "length": 5.536074161529541, "mode": "test", "epoch": 27}
{"loss": 0.07837934792041779, "acc": 0.9831575155258179, "length": 5.546606063842773, "mode": "train", "epoch": 28}
{"loss": 0.0838213637471199, "acc": 0.9819115996360779, "length": 5.464897632598877, "mode": "test", "epoch": 28}
{"loss": 0.07888451218605042, "acc": 0.9828175902366638, "length": 5.561489105224609, "mode": "train", "epoch": 29}
{"loss": 0.08495961129665375, "acc": 0.9811640977859497, "length": 5.479370594024658, "mode": "test", "epoch": 29}
{"loss": 0.07628025114536285, "acc": 0.9834485054016113, "length": 5.5890045166015625, "mode": "train", "epoch": 30}
{"loss": 0.0819372609257698, "acc": 0.981865644454956, "length": 5.48005485534668, "mode": "test", "epoch": 30}
{"loss": 0.07385468482971191, "acc": 0.9840921759605408, "length": 5.621917724609375, "mode": "train", "epoch": 31}
{"loss": 0.07974997907876968, "acc": 0.9822803139686584, "length": 5.542698860168457, "mode": "test", "epoch": 31}
{"loss": 0.0752662643790245, "acc": 0.9835202693939209, "length": 5.676887512207031, "mode": "train", "epoch": 32}
{"loss": 0.08359036594629288, "acc": 0.9817644357681274, "length": 5.876620292663574, "mode": "test", "epoch": 32}
{"loss": 0.07347354292869568, "acc": 0.9840824007987976, "length": 5.690310001373291, "mode": "train", "epoch": 33}
{"loss": 0.08334072679281235, "acc": 0.9819362163543701, "length": 5.744311809539795, "mode": "test", "epoch": 33}
{"loss": 0.07168885320425034, "acc": 0.9845813512802124, "length": 5.7312726974487305, "mode": "train", "epoch": 34}
{"loss": 0.07786694169044495, "acc": 0.9825019836425781, "length": 5.8828125, "mode": "test", "epoch": 34}
{"loss": 0.07130039483308792, "acc": 0.9848726391792297, "length": 5.730161666870117, "mode": "train", "epoch": 35}
{"loss": 0.075901098549366, "acc": 0.9837671518325806, "length": 5.698120594024658, "mode": "test", "epoch": 35}
{"loss": 0.06877407431602478, "acc": 0.985651969909668, "length": 5.743916034698486, "mode": "train", "epoch": 36}
{"loss": 0.07287482917308807, "acc": 0.984836995601654, "length": 5.712341785430908, "mode": "test", "epoch": 36}
{"loss": 0.06790515035390854, "acc": 0.9859196543693542, "length": 5.7877197265625, "mode": "train", "epoch": 37}
{"loss": 0.07290303707122803, "acc": 0.985185980796814, "length": 5.8959174156188965, "mode": "test", "epoch": 37}
{"loss": 0.06681276112794876, "acc": 0.9861086010932922, "length": 5.737923622131348, "mode": "train", "epoch": 38}
{"loss": 0.07355058938264847, "acc": 0.9847131967544556, "length": 5.653189659118652, "mode": "test", "epoch": 38}
{"loss": 0.0687326043844223, "acc": 0.9855545163154602, "length": 5.771641731262207, "mode": "train", "epoch": 39}
{"loss": 0.07445383071899414, "acc": 0.9842107892036438, "length": 5.703449249267578, "mode": "test", "epoch": 39}
{"loss": 0.06659122556447983, "acc": 0.9861557483673096, "length": 5.828904151916504, "mode": "train", "epoch": 40}
{"loss": 0.07617171108722687, "acc": 0.9843928813934326, "length": 5.793742656707764, "mode": "test", "epoch": 40}
{"loss": 0.06612291187047958, "acc": 0.986119270324707, "length": 5.753045082092285, "mode": "train", "epoch": 41}
{"loss": 0.07401259988546371, "acc": 0.9841629266738892, "length": 5.808827877044678, "mode": "test", "epoch": 41}
{"loss": 0.06609760224819183, "acc": 0.9861993193626404, "length": 5.798273086547852, "mode": "train", "epoch": 42}
{"loss": 0.0719471350312233, "acc": 0.9845616817474365, "length": 5.748307704925537, "mode": "test", "epoch": 42}
{"loss": 0.06466434895992279, "acc": 0.9864882230758667, "length": 5.772113800048828, "mode": "train", "epoch": 43}
{"loss": 0.07645545154809952, "acc": 0.983503520488739, "length": 6.086477756500244, "mode": "test", "epoch": 43}
{"loss": 0.06602597236633301, "acc": 0.9860351085662842, "length": 5.804101467132568, "mode": "train", "epoch": 44}
{"loss": 0.07330433279275894, "acc": 0.9846085906028748, "length": 5.690380096435547, "mode": "test", "epoch": 44}
{"loss": 0.06488192826509476, "acc": 0.9863483309745789, "length": 5.813251972198486, "mode": "train", "epoch": 45}
{"loss": 0.07343767583370209, "acc": 0.9845768213272095, "length": 5.72839879989624, "mode": "test", "epoch": 45}
{"loss": 0.06560783088207245, "acc": 0.986108660697937, "length": 5.82794189453125, "mode": "train", "epoch": 46}
{"loss": 0.0715475007891655, "acc": 0.9857577085494995, "length": 5.750648021697998, "mode": "test", "epoch": 46}
{"loss": 0.0690411627292633, "acc": 0.9852088093757629, "length": 5.835156440734863, "mode": "train", "epoch": 47}
{"loss": 0.07810589671134949, "acc": 0.983430802822113, "length": 5.846594333648682, "mode": "test", "epoch": 47}
{"loss": 0.0663742870092392, "acc": 0.9858551025390625, "length": 5.841484069824219, "mode": "train", "epoch": 48}
{"loss": 0.06883110851049423, "acc": 0.986007034778595, "length": 6.084641456604004, "mode": "test", "epoch": 48}
{"loss": 0.06550490856170654, "acc": 0.9859519004821777, "length": 5.856947422027588, "mode": "train", "epoch": 49}
{"loss": 0.07122764736413956, "acc": 0.9847338795661926, "length": 5.7631049156188965, "mode": "test", "epoch": 49}
{"loss": 0.06469033658504486, "acc": 0.9863093495368958, "length": 5.924898147583008, "mode": "train", "epoch": 50}
{"loss": 0.07025444507598877, "acc": 0.9859626293182373, "length": 5.876980304718018, "mode": "test", "epoch": 50}
{"loss": 0.0639873743057251, "acc": 0.9866676926612854, "length": 5.926187038421631, "mode": "train", "epoch": 51}
{"loss": 0.0667172372341156, "acc": 0.9864909052848816, "length": 5.882200241088867, "mode": "test", "epoch": 51}
{"loss": 0.06182480230927467, "acc": 0.9872404932975769, "length": 5.860836029052734, "mode": "train", "epoch": 52}
{"loss": 0.07654570788145065, "acc": 0.9823084473609924, "length": 5.901641845703125, "mode": "test", "epoch": 52}
{"loss": 0.0658656433224678, "acc": 0.9859471917152405, "length": 5.852488994598389, "mode": "train", "epoch": 53}
{"loss": 0.06894224882125854, "acc": 0.9859862327575684, "length": 5.757236480712891, "mode": "test", "epoch": 53}
{"loss": 0.062050286680459976, "acc": 0.9871335029602051, "length": 5.844308376312256, "mode": "train", "epoch": 54}
{"loss": 0.06763392686843872, "acc": 0.986143946647644, "length": 5.969146251678467, "mode": "test", "epoch": 54}
{"loss": 0.061624810099601746, "acc": 0.9873141646385193, "length": 5.868993759155273, "mode": "train", "epoch": 55}
{"loss": 0.06782408803701401, "acc": 0.9862198233604431, "length": 5.805335521697998, "mode": "test", "epoch": 55}
{"loss": 0.06063482537865639, "acc": 0.9875917434692383, "length": 5.900334358215332, "mode": "train", "epoch": 56}
{"loss": 0.06741011887788773, "acc": 0.9861024022102356, "length": 5.891165256500244, "mode": "test", "epoch": 56}
{"loss": 0.06238745152950287, "acc": 0.9870534539222717, "length": 5.901200771331787, "mode": "train", "epoch": 57}
{"loss": 0.06774835288524628, "acc": 0.9862043261528015, "length": 5.763140678405762, "mode": "test", "epoch": 57}
{"loss": 0.06022840365767479, "acc": 0.9875871539115906, "length": 5.920049667358398, "mode": "train", "epoch": 58}
{"loss": 0.06369642913341522, "acc": 0.9878897070884705, "length": 5.8927130699157715, "mode": "test", "epoch": 58}
{"loss": 0.05957797169685364, "acc": 0.9879206418991089, "length": 5.934175491333008, "mode": "train", "epoch": 59}
{"loss": 0.06327400356531143, "acc": 0.9870741963386536, "length": 5.838745594024658, "mode": "test", "epoch": 59}
{"loss": 0.060004472732543945, "acc": 0.9876096844673157, "length": 5.9088053703308105, "mode": "train", "epoch": 60}
{"loss": 0.0657472312450409, "acc": 0.9868320822715759, "length": 5.793022632598877, "mode": "test", "epoch": 60}
test accuracy: 0.9584658145904541
