ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.7152068018913269, "acc": 0.5084220170974731, "length": 4.0006022453308105, "mode": "train", "epoch": 1}
{"loss": 0.6944394707679749, "acc": 0.5355902910232544, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6752079725265503, "acc": 0.5924747586250305, "length": 1.5947620868682861, "mode": "train", "epoch": 2}
{"loss": 0.6565248966217041, "acc": 0.6224338412284851, "length": 1.3975694179534912, "mode": "test", "epoch": 2}
{"loss": 0.6086717247962952, "acc": 0.6677137017250061, "length": 2.037307024002075, "mode": "train", "epoch": 3}
{"loss": 0.6899805068969727, "acc": 0.6192627549171448, "length": 1.1961805820465088, "mode": "test", "epoch": 3}
{"loss": 0.5880252718925476, "acc": 0.6862769722938538, "length": 1.8219873905181885, "mode": "train", "epoch": 4}
{"loss": 0.7124388217926025, "acc": 0.6141790747642517, "length": 1.2118055820465088, "mode": "test", "epoch": 4}
{"loss": 0.5702217817306519, "acc": 0.7169232964515686, "length": 1.929031252861023, "mode": "train", "epoch": 5}
{"loss": 0.63004469871521, "acc": 0.6869004368782043, "length": 1.5451388359069824, "mode": "test", "epoch": 5}
{"loss": 0.5338067412376404, "acc": 0.7483691573143005, "length": 2.0362207889556885, "mode": "train", "epoch": 6}
{"loss": 0.5508682131767273, "acc": 0.7197699546813965, "length": 1.875, "mode": "test", "epoch": 6}
{"loss": 0.5023571252822876, "acc": 0.7695801258087158, "length": 2.1484410762786865, "mode": "train", "epoch": 7}
{"loss": 0.5325630903244019, "acc": 0.738018274307251, "length": 1.8315972089767456, "mode": "test", "epoch": 7}
{"loss": 0.47355586290359497, "acc": 0.7880093455314636, "length": 2.1523382663726807, "mode": "train", "epoch": 8}
{"loss": 0.5366874933242798, "acc": 0.7662272453308105, "length": 2.0520832538604736, "mode": "test", "epoch": 8}
{"loss": 0.42778709530830383, "acc": 0.81783127784729, "length": 2.4046382904052734, "mode": "train", "epoch": 9}
{"loss": 0.42970696091651917, "acc": 0.8248426914215088, "length": 2.2986111640930176, "mode": "test", "epoch": 9}
{"loss": 0.3891676068305969, "acc": 0.8384100198745728, "length": 2.5378026962280273, "mode": "train", "epoch": 10}
{"loss": 0.41550180315971375, "acc": 0.8167968988418579, "length": 2.284722328186035, "mode": "test", "epoch": 10}
{"loss": 0.3638915717601776, "acc": 0.8492544293403625, "length": 2.5714666843414307, "mode": "train", "epoch": 11}
{"loss": 0.41707226634025574, "acc": 0.8249619603157043, "length": 2.378472328186035, "mode": "test", "epoch": 11}
{"loss": 0.3409738540649414, "acc": 0.8631605505943298, "length": 2.715759515762329, "mode": "train", "epoch": 12}
{"loss": 0.41260215640068054, "acc": 0.8359184861183167, "length": 2.5625, "mode": "test", "epoch": 12}
{"loss": 0.3153438866138458, "acc": 0.8775977492332458, "length": 2.935513973236084, "mode": "train", "epoch": 13}
{"loss": 0.3745591342449188, "acc": 0.8577636480331421, "length": 2.6770832538604736, "mode": "test", "epoch": 13}
{"loss": 0.2970349192619324, "acc": 0.8865243792533875, "length": 3.00740385055542, "mode": "train", "epoch": 14}
{"loss": 0.34802940487861633, "acc": 0.8649170398712158, "length": 2.710069417953491, "mode": "test", "epoch": 14}
{"loss": 0.2797299921512604, "acc": 0.8957537412643433, "length": 3.1513330936431885, "mode": "train", "epoch": 15}
{"loss": 0.3495434820652008, "acc": 0.8718316555023193, "length": 2.972222328186035, "mode": "test", "epoch": 15}
{"loss": 0.2624768614768982, "acc": 0.9049439430236816, "length": 3.307316303253174, "mode": "train", "epoch": 16}
{"loss": 0.3322201371192932, "acc": 0.8800862431526184, "length": 3.0989582538604736, "mode": "test", "epoch": 16}
{"loss": 0.2505050301551819, "acc": 0.911472499370575, "length": 3.433623790740967, "mode": "train", "epoch": 17}
{"loss": 0.3008807897567749, "acc": 0.8861762881278992, "length": 3.144097328186035, "mode": "test", "epoch": 17}
{"loss": 0.23540674149990082, "acc": 0.9192352890968323, "length": 3.4543135166168213, "mode": "train", "epoch": 18}
{"loss": 0.282340407371521, "acc": 0.8994058966636658, "length": 3.3697917461395264, "mode": "test", "epoch": 18}
{"loss": 0.22154606878757477, "acc": 0.9254254102706909, "length": 3.5589611530303955, "mode": "train", "epoch": 19}
{"loss": 0.2598509192466736, "acc": 0.9104002714157104, "length": 3.272569417953491, "mode": "test", "epoch": 19}
{"loss": 0.20835408568382263, "acc": 0.9307029843330383, "length": 3.514557123184204, "mode": "train", "epoch": 20}
{"loss": 0.2843621075153351, "acc": 0.9101318717002869, "length": 3.387152671813965, "mode": "test", "epoch": 20}
{"loss": 0.205781027674675, "acc": 0.9324670433998108, "length": 3.510122776031494, "mode": "train", "epoch": 21}
{"loss": 0.2744804322719574, "acc": 0.9042617082595825, "length": 3.418402671813965, "mode": "test", "epoch": 21}
{"loss": 0.19160199165344238, "acc": 0.938227653503418, "length": 3.6361308097839355, "mode": "train", "epoch": 22}
{"loss": 0.238627091050148, "acc": 0.9227837324142456, "length": 3.394097328186035, "mode": "test", "epoch": 22}
{"loss": 0.18227550387382507, "acc": 0.9436348676681519, "length": 3.6313557624816895, "mode": "train", "epoch": 23}
{"loss": 0.23376144468784332, "acc": 0.925623893737793, "length": 3.6822917461395264, "mode": "test", "epoch": 23}
{"loss": 0.17652037739753723, "acc": 0.9441426992416382, "length": 3.6645286083221436, "mode": "train", "epoch": 24}
{"loss": 0.21136492490768433, "acc": 0.9302355647087097, "length": 3.506944417953491, "mode": "test", "epoch": 24}
{"loss": 0.16555576026439667, "acc": 0.9476443529129028, "length": 3.64589262008667, "mode": "train", "epoch": 25}
{"loss": 0.2100660800933838, "acc": 0.9327121376991272, "length": 3.5572917461395264, "mode": "test", "epoch": 25}
{"loss": 0.15776169300079346, "acc": 0.9523605108261108, "length": 3.745758295059204, "mode": "train", "epoch": 26}
{"loss": 0.19956636428833008, "acc": 0.9378526210784912, "length": 3.4739582538604736, "mode": "test", "epoch": 26}
{"loss": 0.1530475616455078, "acc": 0.955075740814209, "length": 3.69358491897583, "mode": "train", "epoch": 27}
{"loss": 0.1951288878917694, "acc": 0.9324219226837158, "length": 3.65625, "mode": "test", "epoch": 27}
{"loss": 0.14954784512519836, "acc": 0.9557676315307617, "length": 3.743948459625244, "mode": "train", "epoch": 28}
{"loss": 0.19800695776939392, "acc": 0.9382568001747131, "length": 3.5763888359069824, "mode": "test", "epoch": 28}
{"loss": 0.14103034138679504, "acc": 0.958949625492096, "length": 3.7948460578918457, "mode": "train", "epoch": 29}
{"loss": 0.18347801268100739, "acc": 0.9466904401779175, "length": 3.6232638359069824, "mode": "test", "epoch": 29}
{"loss": 0.13562998175621033, "acc": 0.9612721800804138, "length": 3.8401482105255127, "mode": "train", "epoch": 30}
{"loss": 0.1697901487350464, "acc": 0.9475476741790771, "length": 3.8611111640930176, "mode": "test", "epoch": 30}
{"loss": 0.13367483019828796, "acc": 0.9599129557609558, "length": 3.8581762313842773, "mode": "train", "epoch": 31}
{"loss": 0.1833362579345703, "acc": 0.9387776255607605, "length": 3.703125, "mode": "test", "epoch": 31}
{"loss": 0.12625083327293396, "acc": 0.9650811553001404, "length": 3.877960681915283, "mode": "train", "epoch": 32}
{"loss": 0.15864239633083344, "acc": 0.9534178972244263, "length": 3.7204861640930176, "mode": "test", "epoch": 32}
{"loss": 0.12600478529930115, "acc": 0.9648195505142212, "length": 3.8496789932250977, "mode": "train", "epoch": 33}
{"loss": 0.16523391008377075, "acc": 0.9515326023101807, "length": 3.8454861640930176, "mode": "test", "epoch": 33}
{"loss": 0.12023042142391205, "acc": 0.9659807085990906, "length": 3.8559536933898926, "mode": "train", "epoch": 34}
{"loss": 0.1607336401939392, "acc": 0.9513264894485474, "length": 3.6666667461395264, "mode": "test", "epoch": 34}
{"loss": 0.11448913812637329, "acc": 0.9699937105178833, "length": 3.9006545543670654, "mode": "train", "epoch": 35}
{"loss": 0.15758752822875977, "acc": 0.9525852203369141, "length": 3.944444417953491, "mode": "test", "epoch": 35}
{"loss": 0.1148577481508255, "acc": 0.9690032601356506, "length": 3.9016013145446777, "mode": "train", "epoch": 36}
{"loss": 0.15214978158473969, "acc": 0.9550157189369202, "length": 3.772569417953491, "mode": "test", "epoch": 36}
{"loss": 0.11971153318881989, "acc": 0.9656229615211487, "length": 3.887859344482422, "mode": "train", "epoch": 37}
{"loss": 0.13998915255069733, "acc": 0.9612955451011658, "length": 3.6666667461395264, "mode": "test", "epoch": 37}
{"loss": 0.11046214401721954, "acc": 0.9701042771339417, "length": 3.8657066822052, "mode": "train", "epoch": 38}
{"loss": 0.1574307084083557, "acc": 0.9482855200767517, "length": 3.8385417461395264, "mode": "test", "epoch": 38}
{"loss": 0.10463368892669678, "acc": 0.9723537564277649, "length": 3.8975019454956055, "mode": "train", "epoch": 39}
{"loss": 0.1490558683872223, "acc": 0.9560818076133728, "length": 3.6892361640930176, "mode": "test", "epoch": 39}
{"loss": 0.10322044789791107, "acc": 0.972874641418457, "length": 3.8916919231414795, "mode": "train", "epoch": 40}
{"loss": 0.1305222362279892, "acc": 0.9623181819915771, "length": 3.8298611640930176, "mode": "test", "epoch": 40}
{"loss": 0.09715302288532257, "acc": 0.9759424924850464, "length": 3.9269044399261475, "mode": "train", "epoch": 41}
{"loss": 0.14136150479316711, "acc": 0.9629638195037842, "length": 3.725694417953491, "mode": "test", "epoch": 41}
{"loss": 0.0938246101140976, "acc": 0.9774057269096375, "length": 3.867429733276367, "mode": "train", "epoch": 42}
{"loss": 0.13278032839298248, "acc": 0.9629638195037842, "length": 3.8107638359069824, "mode": "test", "epoch": 42}
{"loss": 0.08752679079771042, "acc": 0.9793314337730408, "length": 3.898076295852661, "mode": "train", "epoch": 43}
{"loss": 0.12863631546497345, "acc": 0.9558187127113342, "length": 3.765625, "mode": "test", "epoch": 43}
{"loss": 0.08785255998373032, "acc": 0.9786065220832825, "length": 3.879110813140869, "mode": "train", "epoch": 44}
{"loss": 0.13596747815608978, "acc": 0.9623479843139648, "length": 3.793402671813965, "mode": "test", "epoch": 44}
{"loss": 0.08683933317661285, "acc": 0.9790135025978088, "length": 3.876603841781616, "mode": "train", "epoch": 45}
{"loss": 0.11727134138345718, "acc": 0.9648491740226746, "length": 3.796875, "mode": "test", "epoch": 45}
{"loss": 0.0837632566690445, "acc": 0.9797201752662659, "length": 3.8650546073913574, "mode": "train", "epoch": 46}
{"loss": 0.1344422549009323, "acc": 0.9573649168014526, "length": 3.7638888359069824, "mode": "test", "epoch": 46}
{"loss": 0.08111955970525742, "acc": 0.9803721308708191, "length": 3.8772523403167725, "mode": "train", "epoch": 47}
{"loss": 0.1408267766237259, "acc": 0.9597194194793701, "length": 3.75, "mode": "test", "epoch": 47}
{"loss": 0.07830767333507538, "acc": 0.9828176498413086, "length": 3.9356706142425537, "mode": "train", "epoch": 48}
{"loss": 0.12153792381286621, "acc": 0.9705050587654114, "length": 3.7760417461395264, "mode": "test", "epoch": 48}
{"loss": 0.07490169256925583, "acc": 0.983606219291687, "length": 3.882086753845215, "mode": "train", "epoch": 49}
{"loss": 0.10904517769813538, "acc": 0.9696506857872009, "length": 3.8142361640930176, "mode": "test", "epoch": 49}
{"loss": 0.07032592594623566, "acc": 0.9847341775894165, "length": 3.848076105117798, "mode": "train", "epoch": 50}
{"loss": 0.0983634740114212, "acc": 0.973841667175293, "length": 3.7447917461395264, "mode": "test", "epoch": 50}
{"loss": 0.06917047500610352, "acc": 0.9851037263870239, "length": 3.880358934402466, "mode": "train", "epoch": 51}
{"loss": 0.09236347675323486, "acc": 0.9765381217002869, "length": 3.7673611640930176, "mode": "test", "epoch": 51}
{"loss": 0.07165652513504028, "acc": 0.9849300384521484, "length": 3.8933932781219482, "mode": "train", "epoch": 52}
{"loss": 0.0994194895029068, "acc": 0.9737331867218018, "length": 3.909722328186035, "mode": "test", "epoch": 52}
{"loss": 0.07023446261882782, "acc": 0.984724223613739, "length": 3.9269447326660156, "mode": "train", "epoch": 53}
{"loss": 0.10060127079486847, "acc": 0.9759141206741333, "length": 3.793402671813965, "mode": "test", "epoch": 53}
{"loss": 0.06397747248411179, "acc": 0.9868936538696289, "length": 3.932863235473633, "mode": "train", "epoch": 54}
{"loss": 0.08915272355079651, "acc": 0.9757974147796631, "length": 3.765625, "mode": "test", "epoch": 54}
{"loss": 0.06394459307193756, "acc": 0.9864997267723083, "length": 3.933962106704712, "mode": "train", "epoch": 55}
{"loss": 0.09113423526287079, "acc": 0.9779431819915771, "length": 3.909722328186035, "mode": "test", "epoch": 55}
{"loss": 0.0646766647696495, "acc": 0.985929548740387, "length": 3.958757162094116, "mode": "train", "epoch": 56}
{"loss": 0.08326062560081482, "acc": 0.9805202484130859, "length": 3.789930582046509, "mode": "test", "epoch": 56}
{"loss": 0.05839478597044945, "acc": 0.9886794686317444, "length": 3.949223756790161, "mode": "train", "epoch": 57}
{"loss": 0.07841075956821442, "acc": 0.9789441227912903, "length": 3.769097328186035, "mode": "test", "epoch": 57}
{"loss": 0.0590774230659008, "acc": 0.9883381724357605, "length": 3.992776393890381, "mode": "train", "epoch": 58}
{"loss": 0.0864444375038147, "acc": 0.9809921979904175, "length": 3.8854167461395264, "mode": "test", "epoch": 58}
{"loss": 0.061255697160959244, "acc": 0.9872745871543884, "length": 3.985299825668335, "mode": "train", "epoch": 59}
{"loss": 0.08009061962366104, "acc": 0.9835421442985535, "length": 3.855902671813965, "mode": "test", "epoch": 59}
{"loss": 0.05653047561645508, "acc": 0.9899052381515503, "length": 4.040443420410156, "mode": "train", "epoch": 60}
{"loss": 0.07418522238731384, "acc": 0.9845485687255859, "length": 3.918402671813965, "mode": "test", "epoch": 60}
test accuracy: 0.8530771732330322
