ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.6913020014762878, "acc": 0.526365339756012, "length": 3.3998634815216064, "mode": "train", "epoch": 1}
{"loss": 0.6557309627532959, "acc": 0.6334527134895325, "length": 2.890625, "mode": "test", "epoch": 1}
{"loss": 0.5927002429962158, "acc": 0.6885848045349121, "length": 3.5635993480682373, "mode": "train", "epoch": 2}
{"loss": 0.5339396595954895, "acc": 0.7566243410110474, "length": 4.8125, "mode": "test", "epoch": 2}
{"loss": 0.4592927396297455, "acc": 0.8068627715110779, "length": 4.803090572357178, "mode": "train", "epoch": 3}
{"loss": 0.43065330386161804, "acc": 0.8247721195220947, "length": 5.263888835906982, "mode": "test", "epoch": 3}
{"loss": 0.37011218070983887, "acc": 0.8486425876617432, "length": 5.3197126388549805, "mode": "train", "epoch": 4}
{"loss": 0.4277696907520294, "acc": 0.8180013298988342, "length": 5.93055534362793, "mode": "test", "epoch": 4}
{"loss": 0.31132856011390686, "acc": 0.8735272288322449, "length": 5.616921424865723, "mode": "train", "epoch": 5}
{"loss": 0.35645124316215515, "acc": 0.8639675378799438, "length": 5.920138835906982, "mode": "test", "epoch": 5}
{"loss": 0.27213120460510254, "acc": 0.8924732208251953, "length": 5.694253921508789, "mode": "train", "epoch": 6}
{"loss": 0.35420727729797363, "acc": 0.8498290181159973, "length": 5.88194465637207, "mode": "test", "epoch": 6}
{"loss": 0.24863871932029724, "acc": 0.905924916267395, "length": 5.728067398071289, "mode": "train", "epoch": 7}
{"loss": 0.372003436088562, "acc": 0.8253689408302307, "length": 5.947916507720947, "mode": "test", "epoch": 7}
{"loss": 0.23001429438591003, "acc": 0.9170778393745422, "length": 5.822896957397461, "mode": "train", "epoch": 8}
{"loss": 0.3313800096511841, "acc": 0.8605767488479614, "length": 5.982638835906982, "mode": "test", "epoch": 8}
{"loss": 0.2107488214969635, "acc": 0.9234861135482788, "length": 5.886760234832764, "mode": "train", "epoch": 9}
{"loss": 0.3427557945251465, "acc": 0.8555636405944824, "length": 5.980902671813965, "mode": "test", "epoch": 9}
{"loss": 0.20098823308944702, "acc": 0.926223635673523, "length": 5.931967258453369, "mode": "train", "epoch": 10}
{"loss": 0.333337664604187, "acc": 0.8493055105209351, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.1911238133907318, "acc": 0.9298830628395081, "length": 5.946948051452637, "mode": "train", "epoch": 11}
{"loss": 0.2847477197647095, "acc": 0.8900172710418701, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.18379782140254974, "acc": 0.9336526393890381, "length": 5.9598388671875, "mode": "train", "epoch": 12}
{"loss": 0.3153216540813446, "acc": 0.8614583015441895, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.16944439709186554, "acc": 0.9396606683731079, "length": 5.976048469543457, "mode": "train", "epoch": 13}
{"loss": 0.26842090487480164, "acc": 0.9085938334465027, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.15962336957454681, "acc": 0.9453942775726318, "length": 5.985564708709717, "mode": "train", "epoch": 14}
{"loss": 0.2737177908420563, "acc": 0.9084202647209167, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.14484015107154846, "acc": 0.9500617980957031, "length": 5.990009307861328, "mode": "train", "epoch": 15}
{"loss": 0.22354862093925476, "acc": 0.9230902194976807, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.13844473659992218, "acc": 0.9534283876419067, "length": 5.99330997467041, "mode": "train", "epoch": 16}
{"loss": 0.28523749113082886, "acc": 0.9019964933395386, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.1325443834066391, "acc": 0.9573218822479248, "length": 5.993980407714844, "mode": "train", "epoch": 17}
{"loss": 0.2298494428396225, "acc": 0.9197048544883728, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.12397947162389755, "acc": 0.9602716565132141, "length": 5.995994567871094, "mode": "train", "epoch": 18}
{"loss": 0.19866988062858582, "acc": 0.9276039600372314, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.1161542758345604, "acc": 0.9629842638969421, "length": 5.9971022605896, "mode": "train", "epoch": 19}
{"loss": 0.15970955789089203, "acc": 0.9469618201255798, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.10748180001974106, "acc": 0.9672578573226929, "length": 5.996683597564697, "mode": "train", "epoch": 20}
{"loss": 0.17090566456317902, "acc": 0.9476563334465027, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.10722453892230988, "acc": 0.9669496417045593, "length": 5.99705171585083, "mode": "train", "epoch": 21}
{"loss": 0.1830773800611496, "acc": 0.9478297829627991, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.09872692823410034, "acc": 0.9709972143173218, "length": 5.997807025909424, "mode": "train", "epoch": 22}
{"loss": 0.14204509556293488, "acc": 0.960850715637207, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.09060761332511902, "acc": 0.9743393659591675, "length": 5.998236656188965, "mode": "train", "epoch": 23}
{"loss": 0.15551722049713135, "acc": 0.9519097208976746, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.07881926745176315, "acc": 0.9798774719238281, "length": 5.998655796051025, "mode": "train", "epoch": 24}
{"loss": 0.1259666085243225, "acc": 0.9627605080604553, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.0765928104519844, "acc": 0.9790699481964111, "length": 5.998610973358154, "mode": "train", "epoch": 25}
{"loss": 0.1260133534669876, "acc": 0.9659721851348877, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.0732603520154953, "acc": 0.980301022529602, "length": 5.999030590057373, "mode": "train", "epoch": 26}
{"loss": 0.12482798099517822, "acc": 0.9682290554046631, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.06788834929466248, "acc": 0.982137143611908, "length": 5.999101161956787, "mode": "train", "epoch": 27}
{"loss": 0.109416164457798, "acc": 0.968663215637207, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.07398559898138046, "acc": 0.9798029661178589, "length": 5.9991068840026855, "mode": "train", "epoch": 28}
{"loss": 0.12050522863864899, "acc": 0.9604166746139526, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.0631687119603157, "acc": 0.9833346009254456, "length": 5.9992499351501465, "mode": "train", "epoch": 29}
{"loss": 0.10015331953763962, "acc": 0.9692708253860474, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.06069837510585785, "acc": 0.9840047359466553, "length": 5.999359607696533, "mode": "train", "epoch": 30}
{"loss": 0.11163640022277832, "acc": 0.9670138955116272, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.0526004284620285, "acc": 0.9857527017593384, "length": 5.999259948730469, "mode": "train", "epoch": 31}
{"loss": 0.08404501527547836, "acc": 0.9754340648651123, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.052075278013944626, "acc": 0.9858962893486023, "length": 5.999463081359863, "mode": "train", "epoch": 32}
{"loss": 0.09522666782140732, "acc": 0.9675347208976746, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.0450674444437027, "acc": 0.9889790415763855, "length": 5.999461650848389, "mode": "train", "epoch": 33}
{"loss": 0.0892288014292717, "acc": 0.9769965410232544, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.04585583135485649, "acc": 0.987567663192749, "length": 5.99964714050293, "mode": "train", "epoch": 34}
{"loss": 0.09944668412208557, "acc": 0.9647572040557861, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.04497748240828514, "acc": 0.9878194332122803, "length": 5.999707221984863, "mode": "train", "epoch": 35}
{"loss": 0.08407656848430634, "acc": 0.9772568941116333, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.03444784879684448, "acc": 0.9924609065055847, "length": 5.999738693237305, "mode": "train", "epoch": 36}
{"loss": 0.08487270027399063, "acc": 0.9747394919395447, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.04008457809686661, "acc": 0.9907358288764954, "length": 5.999675273895264, "mode": "train", "epoch": 37}
{"loss": 0.0700969398021698, "acc": 0.9802950620651245, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.03389132767915726, "acc": 0.9926003813743591, "length": 5.999783039093018, "mode": "train", "epoch": 38}
{"loss": 0.06644623726606369, "acc": 0.9848959445953369, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.03562203049659729, "acc": 0.9920429587364197, "length": 5.999732494354248, "mode": "train", "epoch": 39}
{"loss": 0.07620657980442047, "acc": 0.9744792580604553, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.03092768043279648, "acc": 0.9934352040290833, "length": 5.9998250007629395, "mode": "train", "epoch": 40}
{"loss": 0.065550796687603, "acc": 0.9809896945953369, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.026943735778331757, "acc": 0.9947422742843628, "length": 5.999846458435059, "mode": "train", "epoch": 41}
{"loss": 0.05344829335808754, "acc": 0.9848090410232544, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.02554216794669628, "acc": 0.9948524832725525, "length": 5.999817371368408, "mode": "train", "epoch": 42}
{"loss": 0.05129898339509964, "acc": 0.9873263239860535, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.0300873015075922, "acc": 0.9933532476425171, "length": 5.999874591827393, "mode": "train", "epoch": 43}
{"loss": 0.059303801506757736, "acc": 0.9761284589767456, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.041844408959150314, "acc": 0.9887404441833496, "length": 5.9998908042907715, "mode": "train", "epoch": 44}
{"loss": 0.06608226895332336, "acc": 0.9787326455116272, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.038961365818977356, "acc": 0.9902976751327515, "length": 5.9999284744262695, "mode": "train", "epoch": 45}
{"loss": 0.1450316607952118, "acc": 0.9674479365348816, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.0659080520272255, "acc": 0.9819316864013672, "length": 5.9999098777771, "mode": "train", "epoch": 46}
{"loss": 0.04820264130830765, "acc": 0.9858507513999939, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.02683648094534874, "acc": 0.9941607117652893, "length": 5.999917507171631, "mode": "train", "epoch": 47}
{"loss": 0.027082975953817368, "acc": 0.9947049021720886, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.0199652798473835, "acc": 0.996911883354187, "length": 5.999926567077637, "mode": "train", "epoch": 48}
{"loss": 0.03178934007883072, "acc": 0.9943576455116272, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.022639919072389603, "acc": 0.9963569045066833, "length": 5.99993896484375, "mode": "train", "epoch": 49}
{"loss": 0.03069373220205307, "acc": 0.9946179986000061, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.017662078142166138, "acc": 0.997525155544281, "length": 5.999969482421875, "mode": "train", "epoch": 50}
{"loss": 0.026910193264484406, "acc": 0.9959200620651245, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.016705133020877838, "acc": 0.997775673866272, "length": 5.999980926513672, "mode": "train", "epoch": 51}
{"loss": 0.03916965052485466, "acc": 0.9914931058883667, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.01536029763519764, "acc": 0.9981369972229004, "length": 5.999975204467773, "mode": "train", "epoch": 52}
{"loss": 0.046513959765434265, "acc": 0.9896702170372009, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.011390285566449165, "acc": 0.9994983077049255, "length": 5.999969005584717, "mode": "train", "epoch": 53}
{"loss": 0.03382318466901779, "acc": 0.9937499165534973, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.01250030193477869, "acc": 0.9987483620643616, "length": 5.999975681304932, "mode": "train", "epoch": 54}
{"loss": 0.04021317511796951, "acc": 0.9915797710418701, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.0135456258431077, "acc": 0.997970700263977, "length": 5.999987602233887, "mode": "train", "epoch": 55}
{"loss": 0.039666417986154556, "acc": 0.9913194179534912, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.01751093752682209, "acc": 0.9971644878387451, "length": 5.9999871253967285, "mode": "train", "epoch": 56}
{"loss": 0.04112749546766281, "acc": 0.9911457896232605, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.018861204385757446, "acc": 0.9957188963890076, "length": 5.999969482421875, "mode": "train", "epoch": 57}
{"loss": 0.04708424583077431, "acc": 0.9883681535720825, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.016375750303268433, "acc": 0.9969698786735535, "length": 5.999984264373779, "mode": "train", "epoch": 58}
{"loss": 0.04665528982877731, "acc": 0.9893229603767395, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.017900602892041206, "acc": 0.9965808391571045, "length": 5.999985694885254, "mode": "train", "epoch": 59}
{"loss": 0.04091803357005119, "acc": 0.9906250834465027, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.010733204893767834, "acc": 0.9993317127227783, "length": 5.9999799728393555, "mode": "train", "epoch": 60}
{"loss": 0.028957460075616837, "acc": 0.9943576455116272, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.8200833797454834
