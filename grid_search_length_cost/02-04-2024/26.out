ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=5"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 5
{"loss": 0.6857075095176697, "acc": 0.5536653995513916, "length": 4.124770641326904, "mode": "train", "epoch": 1}
{"loss": 0.6278444528579712, "acc": 0.6813828945159912, "length": 4.17881965637207, "mode": "test", "epoch": 1}
{"loss": 0.5045387148857117, "acc": 0.763621985912323, "length": 5.191578388214111, "mode": "train", "epoch": 2}
{"loss": 0.4643506407737732, "acc": 0.7979166507720947, "length": 5.94618034362793, "mode": "test", "epoch": 2}
{"loss": 0.3712804317474365, "acc": 0.8455379009246826, "length": 5.861015796661377, "mode": "train", "epoch": 3}
{"loss": 0.41095370054244995, "acc": 0.8366318345069885, "length": 6.0, "mode": "test", "epoch": 3}
{"loss": 0.3179084062576294, "acc": 0.870281457901001, "length": 5.966109752655029, "mode": "train", "epoch": 4}
{"loss": 0.3740655183792114, "acc": 0.8542535305023193, "length": 6.0, "mode": "test", "epoch": 4}
{"loss": 0.29280248284339905, "acc": 0.8844287991523743, "length": 5.985543727874756, "mode": "train", "epoch": 5}
{"loss": 0.34050947427749634, "acc": 0.8673611879348755, "length": 6.0, "mode": "test", "epoch": 5}
{"loss": 0.269575834274292, "acc": 0.8979582786560059, "length": 5.9905104637146, "mode": "train", "epoch": 6}
{"loss": 0.333221435546875, "acc": 0.8755208849906921, "length": 6.0, "mode": "test", "epoch": 6}
{"loss": 0.24843743443489075, "acc": 0.9074739217758179, "length": 5.993671894073486, "mode": "train", "epoch": 7}
{"loss": 0.3300502896308899, "acc": 0.8673612475395203, "length": 6.0, "mode": "test", "epoch": 7}
{"loss": 0.23989394307136536, "acc": 0.9124290347099304, "length": 5.995187282562256, "mode": "train", "epoch": 8}
{"loss": 0.3276411294937134, "acc": 0.8763889670372009, "length": 6.0, "mode": "test", "epoch": 8}
{"loss": 0.23038780689239502, "acc": 0.9174085855484009, "length": 5.996241569519043, "mode": "train", "epoch": 9}
{"loss": 0.3414091467857361, "acc": 0.8570311665534973, "length": 6.0, "mode": "test", "epoch": 9}
{"loss": 0.22409610450267792, "acc": 0.9216397404670715, "length": 5.9971747398376465, "mode": "train", "epoch": 10}
{"loss": 0.31441450119018555, "acc": 0.8822916150093079, "length": 6.0, "mode": "test", "epoch": 10}
{"loss": 0.21789737045764923, "acc": 0.9244056344032288, "length": 5.997732162475586, "mode": "train", "epoch": 11}
{"loss": 0.3079855144023895, "acc": 0.890625, "length": 6.0, "mode": "test", "epoch": 11}
{"loss": 0.2043507695198059, "acc": 0.9315182566642761, "length": 5.998016834259033, "mode": "train", "epoch": 12}
{"loss": 0.3175347149372101, "acc": 0.8754340410232544, "length": 6.0, "mode": "test", "epoch": 12}
{"loss": 0.1966172158718109, "acc": 0.9329104423522949, "length": 5.998610973358154, "mode": "train", "epoch": 13}
{"loss": 0.3098351061344147, "acc": 0.8798611164093018, "length": 6.0, "mode": "test", "epoch": 13}
{"loss": 0.19042246043682098, "acc": 0.9358338117599487, "length": 5.998726844787598, "mode": "train", "epoch": 14}
{"loss": 0.29285332560539246, "acc": 0.8963542580604553, "length": 6.0, "mode": "test", "epoch": 14}
{"loss": 0.19166956841945648, "acc": 0.9342958927154541, "length": 5.998992919921875, "mode": "train", "epoch": 15}
{"loss": 0.2932533323764801, "acc": 0.8938368558883667, "length": 6.0, "mode": "test", "epoch": 15}
{"loss": 0.17891794443130493, "acc": 0.9395381212234497, "length": 5.999260902404785, "mode": "train", "epoch": 16}
{"loss": 0.2797216475009918, "acc": 0.9047742486000061, "length": 6.0, "mode": "test", "epoch": 16}
{"loss": 0.17148880660533905, "acc": 0.9434523582458496, "length": 5.999303340911865, "mode": "train", "epoch": 17}
{"loss": 0.29926782846450806, "acc": 0.8992186784744263, "length": 6.0, "mode": "test", "epoch": 17}
{"loss": 0.1725224107503891, "acc": 0.9425166845321655, "length": 5.999406337738037, "mode": "train", "epoch": 18}
{"loss": 0.2771563231945038, "acc": 0.8978300094604492, "length": 6.0, "mode": "test", "epoch": 18}
{"loss": 0.1638709157705307, "acc": 0.9454142451286316, "length": 5.999564170837402, "mode": "train", "epoch": 19}
{"loss": 0.2679712772369385, "acc": 0.8949652910232544, "length": 6.0, "mode": "test", "epoch": 19}
{"loss": 0.16267745196819305, "acc": 0.9448091387748718, "length": 5.999640464782715, "mode": "train", "epoch": 20}
{"loss": 0.2609974145889282, "acc": 0.9223090410232544, "length": 6.0, "mode": "test", "epoch": 20}
{"loss": 0.15866099298000336, "acc": 0.9462670683860779, "length": 5.999485015869141, "mode": "train", "epoch": 21}
{"loss": 0.23920872807502747, "acc": 0.9093749523162842, "length": 6.0, "mode": "test", "epoch": 21}
{"loss": 0.14427074790000916, "acc": 0.9542089104652405, "length": 5.999716758728027, "mode": "train", "epoch": 22}
{"loss": 0.23448926210403442, "acc": 0.9201388955116272, "length": 6.0, "mode": "test", "epoch": 22}
{"loss": 0.14357662200927734, "acc": 0.9535502791404724, "length": 5.999802112579346, "mode": "train", "epoch": 23}
{"loss": 0.2281953990459442, "acc": 0.9259549379348755, "length": 6.0, "mode": "test", "epoch": 23}
{"loss": 0.13910359144210815, "acc": 0.9543775320053101, "length": 5.999814033508301, "mode": "train", "epoch": 24}
{"loss": 0.23044627904891968, "acc": 0.9230902791023254, "length": 6.0, "mode": "test", "epoch": 24}
{"loss": 0.12923024594783783, "acc": 0.9587047696113586, "length": 5.999827861785889, "mode": "train", "epoch": 25}
{"loss": 0.18529126048088074, "acc": 0.9350695013999939, "length": 6.0, "mode": "test", "epoch": 25}
{"loss": 0.12562958896160126, "acc": 0.9605525135993958, "length": 5.999853610992432, "mode": "train", "epoch": 26}
{"loss": 0.21449226140975952, "acc": 0.9278646111488342, "length": 6.0, "mode": "test", "epoch": 26}
{"loss": 0.12112627178430557, "acc": 0.9602757096290588, "length": 5.999820232391357, "mode": "train", "epoch": 27}
{"loss": 0.21632836759090424, "acc": 0.9294271469116211, "length": 6.0, "mode": "test", "epoch": 27}
{"loss": 0.1125958189368248, "acc": 0.9663689136505127, "length": 5.999885559082031, "mode": "train", "epoch": 28}
{"loss": 0.19734781980514526, "acc": 0.929774284362793, "length": 6.0, "mode": "test", "epoch": 28}
{"loss": 0.1074652224779129, "acc": 0.9669758081436157, "length": 5.9998955726623535, "mode": "train", "epoch": 29}
{"loss": 0.18367081880569458, "acc": 0.9315103888511658, "length": 6.0, "mode": "test", "epoch": 29}
{"loss": 0.1003839522600174, "acc": 0.9689330458641052, "length": 5.999908447265625, "mode": "train", "epoch": 30}
{"loss": 0.15657812356948853, "acc": 0.9459202289581299, "length": 6.0, "mode": "test", "epoch": 30}
{"loss": 0.09057683497667313, "acc": 0.9731782674789429, "length": 5.999925136566162, "mode": "train", "epoch": 31}
{"loss": 0.1589420884847641, "acc": 0.9513021111488342, "length": 6.0, "mode": "test", "epoch": 31}
{"loss": 0.08904851227998734, "acc": 0.9726550579071045, "length": 5.999940872192383, "mode": "train", "epoch": 32}
{"loss": 0.18831492960453033, "acc": 0.9365451335906982, "length": 6.0, "mode": "test", "epoch": 32}
{"loss": 0.08992506563663483, "acc": 0.9720759987831116, "length": 5.999926567077637, "mode": "train", "epoch": 33}
{"loss": 0.19360283017158508, "acc": 0.94140625, "length": 6.0, "mode": "test", "epoch": 33}
{"loss": 0.08455442637205124, "acc": 0.9735925793647766, "length": 5.999949932098389, "mode": "train", "epoch": 34}
{"loss": 0.17728427052497864, "acc": 0.9464409351348877, "length": 6.0, "mode": "test", "epoch": 34}
{"loss": 0.0778999775648117, "acc": 0.9764867424964905, "length": 5.999949932098389, "mode": "train", "epoch": 35}
{"loss": 0.13812793791294098, "acc": 0.9580729603767395, "length": 6.0, "mode": "test", "epoch": 35}
{"loss": 0.06719008833169937, "acc": 0.9806767106056213, "length": 5.999963283538818, "mode": "train", "epoch": 36}
{"loss": 0.13287952542304993, "acc": 0.9589410424232483, "length": 6.0, "mode": "test", "epoch": 36}
{"loss": 0.06863006949424744, "acc": 0.9797393679618835, "length": 5.999955654144287, "mode": "train", "epoch": 37}
{"loss": 0.13113641738891602, "acc": 0.9562499523162842, "length": 6.0, "mode": "test", "epoch": 37}
{"loss": 0.06308634579181671, "acc": 0.9823300838470459, "length": 5.999957084655762, "mode": "train", "epoch": 38}
{"loss": 0.12337936460971832, "acc": 0.960850715637207, "length": 6.0, "mode": "test", "epoch": 38}
{"loss": 0.06466572731733322, "acc": 0.9819998145103455, "length": 5.999967575073242, "mode": "train", "epoch": 39}
{"loss": 0.12496844679117203, "acc": 0.9615452289581299, "length": 6.0, "mode": "test", "epoch": 39}
{"loss": 0.051687899976968765, "acc": 0.9864334464073181, "length": 5.999908447265625, "mode": "train", "epoch": 40}
{"loss": 0.10399571061134338, "acc": 0.9722223281860352, "length": 6.0, "mode": "test", "epoch": 40}
{"loss": 0.05529811978340149, "acc": 0.98470139503479, "length": 5.999975681304932, "mode": "train", "epoch": 41}
{"loss": 0.12830452620983124, "acc": 0.9611111879348755, "length": 6.0, "mode": "test", "epoch": 41}
{"loss": 0.05169665068387985, "acc": 0.9869338274002075, "length": 5.999973297119141, "mode": "train", "epoch": 42}
{"loss": 0.10357332974672318, "acc": 0.9685763120651245, "length": 6.0, "mode": "test", "epoch": 42}
{"loss": 0.04317820817232132, "acc": 0.9903245568275452, "length": 5.999982833862305, "mode": "train", "epoch": 43}
{"loss": 0.08835825324058533, "acc": 0.972569465637207, "length": 6.0, "mode": "test", "epoch": 43}
{"loss": 0.042406115680933, "acc": 0.9888632297515869, "length": 5.999974250793457, "mode": "train", "epoch": 44}
{"loss": 0.11070673167705536, "acc": 0.9685763120651245, "length": 6.0, "mode": "test", "epoch": 44}
{"loss": 0.040595006197690964, "acc": 0.9913714528083801, "length": 5.999975681304932, "mode": "train", "epoch": 45}
{"loss": 0.0857652947306633, "acc": 0.9770833253860474, "length": 6.0, "mode": "test", "epoch": 45}
{"loss": 0.03812361881136894, "acc": 0.9922814965248108, "length": 5.999983787536621, "mode": "train", "epoch": 46}
{"loss": 0.13045169413089752, "acc": 0.9632813334465027, "length": 6.0, "mode": "test", "epoch": 46}
{"loss": 0.06377197802066803, "acc": 0.9821105003356934, "length": 5.999979496002197, "mode": "train", "epoch": 47}
{"loss": 0.11217471212148666, "acc": 0.9720485210418701, "length": 6.0, "mode": "test", "epoch": 47}
{"loss": 0.04585797339677811, "acc": 0.9875404238700867, "length": 5.999976634979248, "mode": "train", "epoch": 48}
{"loss": 0.09620586037635803, "acc": 0.9710069298744202, "length": 6.0, "mode": "test", "epoch": 48}
{"loss": 0.038148459047079086, "acc": 0.9913159012794495, "length": 5.99996280670166, "mode": "train", "epoch": 49}
{"loss": 0.08461961150169373, "acc": 0.9769096374511719, "length": 6.0, "mode": "test", "epoch": 49}
{"loss": 0.028233947232365608, "acc": 0.9952867031097412, "length": 5.999485492706299, "mode": "train", "epoch": 50}
{"loss": 0.08778520673513412, "acc": 0.9776909351348877, "length": 6.0, "mode": "test", "epoch": 50}
{"loss": 0.02990785986185074, "acc": 0.9946799278259277, "length": 5.999992370605469, "mode": "train", "epoch": 51}
{"loss": 0.08430454879999161, "acc": 0.9802950620651245, "length": 6.0, "mode": "test", "epoch": 51}
{"loss": 0.027567526325583458, "acc": 0.9954241514205933, "length": 5.999995231628418, "mode": "train", "epoch": 52}
{"loss": 0.08241726458072662, "acc": 0.9796875715255737, "length": 6.0, "mode": "test", "epoch": 52}
{"loss": 0.02431068755686283, "acc": 0.9956997632980347, "length": 5.999991416931152, "mode": "train", "epoch": 53}
{"loss": 0.06945740431547165, "acc": 0.9774305820465088, "length": 6.0, "mode": "test", "epoch": 53}
{"loss": 0.02597638964653015, "acc": 0.995286226272583, "length": 5.999989032745361, "mode": "train", "epoch": 54}
{"loss": 0.07662446051836014, "acc": 0.9823785424232483, "length": 6.0, "mode": "test", "epoch": 54}
{"loss": 0.027353202924132347, "acc": 0.9949273467063904, "length": 5.999980926513672, "mode": "train", "epoch": 55}
{"loss": 0.07582300156354904, "acc": 0.9799479246139526, "length": 6.0, "mode": "test", "epoch": 55}
{"loss": 0.0349062941968441, "acc": 0.9919508695602417, "length": 5.999982833862305, "mode": "train", "epoch": 56}
{"loss": 0.09574845433235168, "acc": 0.9718750715255737, "length": 6.0, "mode": "test", "epoch": 56}
{"loss": 0.03146578371524811, "acc": 0.9936586618423462, "length": 5.9999799728393555, "mode": "train", "epoch": 57}
{"loss": 0.08356114476919174, "acc": 0.9842013120651245, "length": 6.0, "mode": "test", "epoch": 57}
{"loss": 0.026249732822179794, "acc": 0.9958654046058655, "length": 5.999996185302734, "mode": "train", "epoch": 58}
{"loss": 0.07687106728553772, "acc": 0.9794270396232605, "length": 6.0, "mode": "test", "epoch": 58}
{"loss": 0.025977786630392075, "acc": 0.995534360408783, "length": 5.9999918937683105, "mode": "train", "epoch": 59}
{"loss": 0.061935849487781525, "acc": 0.9839410781860352, "length": 6.0, "mode": "test", "epoch": 59}
{"loss": 0.022941643372178078, "acc": 0.995644748210907, "length": 5.999996662139893, "mode": "train", "epoch": 60}
{"loss": 0.062202971428632736, "acc": 0.9877604246139526, "length": 6.0, "mode": "test", "epoch": 60}
test accuracy: 0.7731897234916687
