ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.6807026863098145, "acc": 0.5608242750167847, "length": 3.3507723808288574, "mode": "train", "epoch": 1}
{"loss": 0.5968825221061707, "acc": 0.6786646842956543, "length": 3.78947377204895, "mode": "test", "epoch": 1}
{"loss": 0.5639777183532715, "acc": 0.7122423648834229, "length": 3.611084222793579, "mode": "train", "epoch": 2}
{"loss": 0.5362448692321777, "acc": 0.7597219347953796, "length": 3.692434310913086, "mode": "test", "epoch": 2}
{"loss": 0.4416162669658661, "acc": 0.8018534779548645, "length": 3.901690721511841, "mode": "train", "epoch": 3}
{"loss": 0.4145616590976715, "acc": 0.8203124403953552, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.3464186489582062, "acc": 0.8560770750045776, "length": 3.9903645515441895, "mode": "train", "epoch": 4}
{"loss": 0.35992395877838135, "acc": 0.849753201007843, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.31913748383522034, "acc": 0.8714752793312073, "length": 3.9956600666046143, "mode": "train", "epoch": 5}
{"loss": 0.3278805911540985, "acc": 0.8663650155067444, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.2936622202396393, "acc": 0.8830393552780151, "length": 3.9971835613250732, "mode": "train", "epoch": 6}
{"loss": 0.34442269802093506, "acc": 0.8592104911804199, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.26817023754119873, "acc": 0.8983984589576721, "length": 3.9975638389587402, "mode": "train", "epoch": 7}
{"loss": 0.2999093234539032, "acc": 0.8870888948440552, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.24560211598873138, "acc": 0.9090025424957275, "length": 3.9981014728546143, "mode": "train", "epoch": 8}
{"loss": 0.3173366189002991, "acc": 0.8791118264198303, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.22536341845989227, "acc": 0.9206852912902832, "length": 3.9988954067230225, "mode": "train", "epoch": 9}
{"loss": 0.29111313819885254, "acc": 0.8720394968986511, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.21611659228801727, "acc": 0.9239587187767029, "length": 3.999129056930542, "mode": "train", "epoch": 10}
{"loss": 0.30623671412467957, "acc": 0.8837993741035461, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.20714129507541656, "acc": 0.9281595945358276, "length": 3.9992218017578125, "mode": "train", "epoch": 11}
{"loss": 0.26367777585983276, "acc": 0.8962170481681824, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.19428062438964844, "acc": 0.9332165718078613, "length": 3.99953556060791, "mode": "train", "epoch": 12}
{"loss": 0.2896830439567566, "acc": 0.8909539580345154, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.18866857886314392, "acc": 0.9329740405082703, "length": 3.99967622756958, "mode": "train", "epoch": 13}
{"loss": 0.23877738416194916, "acc": 0.9215460419654846, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.18704754114151, "acc": 0.9333875775337219, "length": 3.9997220039367676, "mode": "train", "epoch": 14}
{"loss": 0.26238155364990234, "acc": 0.9057565927505493, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.1737867146730423, "acc": 0.9372859597206116, "length": 3.999765157699585, "mode": "train", "epoch": 15}
{"loss": 0.23271337151527405, "acc": 0.9217928051948547, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.16516068577766418, "acc": 0.9436271786689758, "length": 3.999837875366211, "mode": "train", "epoch": 16}
{"loss": 0.2269233614206314, "acc": 0.9203125834465027, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.15556290745735168, "acc": 0.9462357759475708, "length": 3.9998860359191895, "mode": "train", "epoch": 17}
{"loss": 0.22598189115524292, "acc": 0.9113487601280212, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.1482781171798706, "acc": 0.9476903676986694, "length": 3.9998958110809326, "mode": "train", "epoch": 18}
{"loss": 0.24527928233146667, "acc": 0.9071546792984009, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.14437469840049744, "acc": 0.9490630030632019, "length": 3.999901056289673, "mode": "train", "epoch": 19}
{"loss": 0.22563078999519348, "acc": 0.921875, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.14054521918296814, "acc": 0.9509850740432739, "length": 3.999933958053589, "mode": "train", "epoch": 20}
{"loss": 0.19125179946422577, "acc": 0.9391446113586426, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.13066181540489197, "acc": 0.9569952487945557, "length": 3.9999465942382812, "mode": "train", "epoch": 21}
{"loss": 0.18914154171943665, "acc": 0.931167721748352, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.12629452347755432, "acc": 0.9586965441703796, "length": 3.999946355819702, "mode": "train", "epoch": 22}
{"loss": 0.21817360818386078, "acc": 0.9208059906959534, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.11789751052856445, "acc": 0.9614685773849487, "length": 3.9999516010284424, "mode": "train", "epoch": 23}
{"loss": 0.20584292709827423, "acc": 0.9295229911804199, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.11086858063936234, "acc": 0.9641305804252625, "length": 3.999952554702759, "mode": "train", "epoch": 24}
{"loss": 0.21389903128147125, "acc": 0.9258223176002502, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.10652118176221848, "acc": 0.9654753804206848, "length": 3.9999563694000244, "mode": "train", "epoch": 25}
{"loss": 0.18013609945774078, "acc": 0.9369242787361145, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1011139452457428, "acc": 0.967890739440918, "length": 3.999967098236084, "mode": "train", "epoch": 26}
{"loss": 0.15859808027744293, "acc": 0.9490131735801697, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.09275751560926437, "acc": 0.9712116122245789, "length": 3.9999725818634033, "mode": "train", "epoch": 27}
{"loss": 0.14782464504241943, "acc": 0.9542763233184814, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.0898740217089653, "acc": 0.9718703031539917, "length": 3.9999747276306152, "mode": "train", "epoch": 28}
{"loss": 0.14171898365020752, "acc": 0.9514802694320679, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.0882669985294342, "acc": 0.9711021780967712, "length": 3.9999802112579346, "mode": "train", "epoch": 29}
{"loss": 0.17015835642814636, "acc": 0.9440788626670837, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.08901921659708023, "acc": 0.9716509580612183, "length": 3.9999778270721436, "mode": "train", "epoch": 30}
{"loss": 0.15037262439727783, "acc": 0.9519736766815186, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.07954800873994827, "acc": 0.9752461314201355, "length": 3.99998140335083, "mode": "train", "epoch": 31}
{"loss": 0.13436131179332733, "acc": 0.9568256735801697, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.07269236445426941, "acc": 0.9782098531723022, "length": 3.9999840259552, "mode": "train", "epoch": 32}
{"loss": 0.14077383279800415, "acc": 0.9593750834465027, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.07125096023082733, "acc": 0.9779630303382874, "length": 3.9999876022338867, "mode": "train", "epoch": 33}
{"loss": 0.12749488651752472, "acc": 0.959457278251648, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.06415421515703201, "acc": 0.9824088215827942, "length": 3.9999892711639404, "mode": "train", "epoch": 34}
{"loss": 0.12731030583381653, "acc": 0.9674342274665833, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.0579451285302639, "acc": 0.9847416281700134, "length": 3.9999899864196777, "mode": "train", "epoch": 35}
{"loss": 0.12197989225387573, "acc": 0.9655428528785706, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.05891876295208931, "acc": 0.9832870960235596, "length": 3.999990940093994, "mode": "train", "epoch": 36}
{"loss": 0.117218516767025, "acc": 0.9605262279510498, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.052367642521858215, "acc": 0.9860314726829529, "length": 3.9999940395355225, "mode": "train", "epoch": 37}
{"loss": 0.12074410170316696, "acc": 0.9607729911804199, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.0536450520157814, "acc": 0.9855102300643921, "length": 3.9999938011169434, "mode": "train", "epoch": 38}
{"loss": 0.12242839485406876, "acc": 0.9571546316146851, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.055421993136405945, "acc": 0.9838910698890686, "length": 3.9999947547912598, "mode": "train", "epoch": 39}
{"loss": 0.10776672512292862, "acc": 0.9620887637138367, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.04660794511437416, "acc": 0.9878701567649841, "length": 3.999995708465576, "mode": "train", "epoch": 40}
{"loss": 0.10120479762554169, "acc": 0.9634868502616882, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.04887086898088455, "acc": 0.9878427386283875, "length": 3.999995231628418, "mode": "train", "epoch": 41}
{"loss": 0.09443539381027222, "acc": 0.9694900512695312, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.04725002497434616, "acc": 0.9864982962608337, "length": 3.9999969005584717, "mode": "train", "epoch": 42}
{"loss": 0.09738892316818237, "acc": 0.9684210419654846, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.04136651009321213, "acc": 0.9900107979774475, "length": 3.999997138977051, "mode": "train", "epoch": 43}
{"loss": 0.09977881610393524, "acc": 0.9693257212638855, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.035802457481622696, "acc": 0.9915476441383362, "length": 3.999997854232788, "mode": "train", "epoch": 44}
{"loss": 0.0724480152130127, "acc": 0.9787006378173828, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.030731692910194397, "acc": 0.9932764768600464, "length": 3.999997615814209, "mode": "train", "epoch": 45}
{"loss": 0.08926691859960556, "acc": 0.9671052694320679, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.028204893693327904, "acc": 0.9940174221992493, "length": 3.999997615814209, "mode": "train", "epoch": 46}
{"loss": 0.07745333760976791, "acc": 0.9751644134521484, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.03266032412648201, "acc": 0.9921513199806213, "length": 3.999997138977051, "mode": "train", "epoch": 47}
{"loss": 0.10127869993448257, "acc": 0.9674341082572937, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.038298092782497406, "acc": 0.9906145930290222, "length": 3.999997138977051, "mode": "train", "epoch": 48}
{"loss": 0.08499320596456528, "acc": 0.9787829518318176, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.032260507345199585, "acc": 0.9922611713409424, "length": 3.9999992847442627, "mode": "train", "epoch": 49}
{"loss": 0.05997362360358238, "acc": 0.983717143535614, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.02683594636619091, "acc": 0.9945114850997925, "length": 3.9999992847442627, "mode": "train", "epoch": 50}
{"loss": 0.05438524857163429, "acc": 0.9873355031013489, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.022001931443810463, "acc": 0.9961854219436646, "length": 3.999999761581421, "mode": "train", "epoch": 51}
{"loss": 0.062028463929891586, "acc": 0.9860197305679321, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.021294845268130302, "acc": 0.9963499307632446, "length": 3.999997854232788, "mode": "train", "epoch": 52}
{"loss": 0.04966651275753975, "acc": 0.9885690808296204, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.030103255063295364, "acc": 0.9931118488311768, "length": 3.999999761581421, "mode": "train", "epoch": 53}
{"loss": 0.0794825330376625, "acc": 0.9796874523162842, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.029828084632754326, "acc": 0.9933589100837708, "length": 3.999999523162842, "mode": "train", "epoch": 54}
{"loss": 0.05402856692671776, "acc": 0.9851153492927551, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.017896054312586784, "acc": 0.9975849986076355, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.04721996933221817, "acc": 0.988980233669281, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.017304619774222374, "acc": 0.9973105788230896, "length": 3.999997854232788, "mode": "train", "epoch": 56}
{"loss": 0.050628021359443665, "acc": 0.9870887398719788, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.030489858239889145, "acc": 0.992782711982727, "length": 3.999999761581421, "mode": "train", "epoch": 57}
{"loss": 0.06649242341518402, "acc": 0.981167733669281, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.03870853781700134, "acc": 0.989022970199585, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.08348283916711807, "acc": 0.9782895445823669, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03263295814394951, "acc": 0.9920143485069275, "length": 3.999999761581421, "mode": "train", "epoch": 59}
{"loss": 0.04981071501970291, "acc": 0.9870887398719788, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.02468382753431797, "acc": 0.995060384273529, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.041586630046367645, "acc": 0.9892268776893616, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8216666579246521
