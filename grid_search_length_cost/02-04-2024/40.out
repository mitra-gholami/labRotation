ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 3
{"loss": 0.34764137864112854, "acc": 0.8503565788269043, "length": 3.902193069458008, "mode": "train", "epoch": 1}
{"loss": 0.33220532536506653, "acc": 0.8712270259857178, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.20486360788345337, "acc": 0.9335330128669739, "length": 3.9999947547912598, "mode": "train", "epoch": 2}
{"loss": 0.2848733961582184, "acc": 0.8874874711036682, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.17281408607959747, "acc": 0.9478758573532104, "length": 3.9999992847442627, "mode": "train", "epoch": 3}
{"loss": 0.24861833453178406, "acc": 0.9180840253829956, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.14333978295326233, "acc": 0.9598186016082764, "length": 4.0, "mode": "train", "epoch": 4}
{"loss": 0.21036145091056824, "acc": 0.9241054058074951, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.12485724687576294, "acc": 0.9678898453712463, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.16027086973190308, "acc": 0.9531447887420654, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.11823296546936035, "acc": 0.9700769186019897, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.15252111852169037, "acc": 0.9558126330375671, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.11047378182411194, "acc": 0.9719023108482361, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.14994770288467407, "acc": 0.9534580707550049, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.10141699761152267, "acc": 0.9754537343978882, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.13008594512939453, "acc": 0.9637871384620667, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.09741796553134918, "acc": 0.9768478870391846, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.11706472933292389, "acc": 0.9688292741775513, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.09698475897312164, "acc": 0.9769625067710876, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.10979313403367996, "acc": 0.9723952412605286, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.0927891880273819, "acc": 0.9782416224479675, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.11252658069133759, "acc": 0.9714051485061646, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.09117166697978973, "acc": 0.9783944487571716, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.09929095953702927, "acc": 0.9761790037155151, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.08728209137916565, "acc": 0.979674220085144, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.08948584645986557, "acc": 0.9793851375579834, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.08399312198162079, "acc": 0.9809053540229797, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.08963847905397415, "acc": 0.9798352122306824, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.08228188753128052, "acc": 0.9810642600059509, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.08787618577480316, "acc": 0.9802239537239075, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.07789772003889084, "acc": 0.9821454882621765, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.0889870896935463, "acc": 0.980209469795227, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.07576344162225723, "acc": 0.9829713702201843, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.09264148026704788, "acc": 0.978774905204773, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.07229340076446533, "acc": 0.9840058088302612, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.09032958000898361, "acc": 0.9759020209312439, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.07096552103757858, "acc": 0.9841275215148926, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.08647273480892181, "acc": 0.9807422757148743, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.06796927750110626, "acc": 0.985109269618988, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.10266134887933731, "acc": 0.969765305519104, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.06609062105417252, "acc": 0.9857034683227539, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.0945034846663475, "acc": 0.9735005497932434, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.06431650370359421, "acc": 0.9860231280326843, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.10772153735160828, "acc": 0.9654072523117065, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.06388285756111145, "acc": 0.9860537648200989, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.09219314903020859, "acc": 0.9763734936714172, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.062106017023324966, "acc": 0.9866275787353516, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.11023037880659103, "acc": 0.964921236038208, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.06127869337797165, "acc": 0.9866942167282104, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.09669937938451767, "acc": 0.9710289239883423, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.06052346155047417, "acc": 0.98673015832901, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.10137111693620682, "acc": 0.9697275757789612, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.05877695977687836, "acc": 0.9872554540634155, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.11159469932317734, "acc": 0.9651172757148743, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.05807513743638992, "acc": 0.9873394966125488, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.09918633848428726, "acc": 0.972008228302002, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.05724472180008888, "acc": 0.9875181913375854, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.09072080254554749, "acc": 0.9765372276306152, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.05656743422150612, "acc": 0.9876962304115295, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 0.10360952466726303, "acc": 0.9670038819313049, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.05694182589650154, "acc": 0.9873627424240112, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.09552156925201416, "acc": 0.974186360836029, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.05450011417269707, "acc": 0.9882454872131348, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.1029960885643959, "acc": 0.9699183106422424, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.05278291925787926, "acc": 0.9885849952697754, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 0.08894534409046173, "acc": 0.9724672436714172, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.05603722855448723, "acc": 0.9875913858413696, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.0978507325053215, "acc": 0.9723952412605286, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.05552670359611511, "acc": 0.9873974919319153, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.08435572683811188, "acc": 0.9788019061088562, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.0519881509244442, "acc": 0.9885154366493225, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.09567400813102722, "acc": 0.971351146697998, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.055455245077610016, "acc": 0.9874389171600342, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.09212676435709, "acc": 0.9726977348327637, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.05183371901512146, "acc": 0.9885664582252502, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.08289115875959396, "acc": 0.977318525314331, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.05102996900677681, "acc": 0.9888098835945129, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.08463732153177261, "acc": 0.9738658666610718, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.051376570016145706, "acc": 0.9884117245674133, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.08092200756072998, "acc": 0.9765462279319763, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.04761040583252907, "acc": 0.9895810484886169, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.07661570608615875, "acc": 0.9791547656059265, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.04917963221669197, "acc": 0.9890905618667603, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.07100242376327515, "acc": 0.981489360332489, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.047968506813049316, "acc": 0.9894850850105286, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.07012965530157089, "acc": 0.9827044010162354, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.0493633933365345, "acc": 0.9889910817146301, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.0825008824467659, "acc": 0.9774895310401917, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.05220950394868851, "acc": 0.9880009293556213, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.07056324928998947, "acc": 0.9812572598457336, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.05051456019282341, "acc": 0.9884644746780396, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.07108214497566223, "acc": 0.9817378520965576, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.0463072843849659, "acc": 0.989726185798645, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.06280870735645294, "acc": 0.984020471572876, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.04532760754227638, "acc": 0.9901021718978882, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.06370092928409576, "acc": 0.9851562976837158, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.04785725846886635, "acc": 0.9894179701805115, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.07072371244430542, "acc": 0.9813165664672852, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04788098484277725, "acc": 0.9892812967300415, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.06051865220069885, "acc": 0.9841302037239075, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04543161764740944, "acc": 0.9901165962219238, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.06707343459129333, "acc": 0.9836854934692383, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.04531139135360718, "acc": 0.990192711353302, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.05988120660185814, "acc": 0.9854549765586853, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.04471888020634651, "acc": 0.9901783466339111, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.06268174946308136, "acc": 0.9856531023979187, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.04561019688844681, "acc": 0.9900896549224854, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.057224832475185394, "acc": 0.9863353967666626, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.051750510931015015, "acc": 0.9882246255874634, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.06571144610643387, "acc": 0.982339084148407, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.048013247549533844, "acc": 0.9893226623535156, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.05988363176584244, "acc": 0.9852245450019836, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.04596218839287758, "acc": 0.9896446466445923, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.05572731792926788, "acc": 0.9865784049034119, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.0483546145260334, "acc": 0.9890058636665344, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.07198929041624069, "acc": 0.9795344471931458, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.045507583767175674, "acc": 0.9898293018341064, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.06288179010152817, "acc": 0.9832841753959656, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.04420141130685806, "acc": 0.990384042263031, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.05046167969703674, "acc": 0.9890227913856506, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9458892345428467
