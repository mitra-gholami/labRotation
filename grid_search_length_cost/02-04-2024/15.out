ndevices 0
# ["--attributes=3", "--values=4", "--context_unaware=True", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 3
{"loss": 0.7050384283065796, "acc": 0.5086589455604553, "length": 2.0605692863464355, "mode": "train", "epoch": 1}
{"loss": 0.693199872970581, "acc": 0.5362847447395325, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6874094009399414, "acc": 0.5641872882843018, "length": 1.3571958541870117, "mode": "train", "epoch": 2}
{"loss": 0.6352927684783936, "acc": 0.6706516742706299, "length": 1.9635416269302368, "mode": "test", "epoch": 2}
{"loss": 0.5911713242530823, "acc": 0.697232186794281, "length": 2.3784632682800293, "mode": "train", "epoch": 3}
{"loss": 0.5742037296295166, "acc": 0.7363227009773254, "length": 2.659722328186035, "mode": "test", "epoch": 3}
{"loss": 0.4908274710178375, "acc": 0.7846982479095459, "length": 2.8789262771606445, "mode": "train", "epoch": 4}
{"loss": 0.4968053996562958, "acc": 0.8010389804840088, "length": 3.03125, "mode": "test", "epoch": 4}
{"loss": 0.43066540360450745, "acc": 0.820216953754425, "length": 3.109302043914795, "mode": "train", "epoch": 5}
{"loss": 0.4840584993362427, "acc": 0.8031466007232666, "length": 3.1197917461395264, "mode": "test", "epoch": 5}
{"loss": 0.3947613835334778, "acc": 0.8378732800483704, "length": 3.2161102294921875, "mode": "train", "epoch": 6}
{"loss": 0.4967762529850006, "acc": 0.7979600429534912, "length": 3.2291667461395264, "mode": "test", "epoch": 6}
{"loss": 0.3605588972568512, "acc": 0.855550229549408, "length": 3.5002217292785645, "mode": "train", "epoch": 7}
{"loss": 0.48945242166519165, "acc": 0.7793918251991272, "length": 3.6979167461395264, "mode": "test", "epoch": 7}
{"loss": 0.3259851634502411, "acc": 0.8726736307144165, "length": 3.8337485790252686, "mode": "train", "epoch": 8}
{"loss": 0.4056480824947357, "acc": 0.8392360210418701, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.2965058386325836, "acc": 0.8834781050682068, "length": 3.978754997253418, "mode": "train", "epoch": 9}
{"loss": 0.4111814796924591, "acc": 0.822048544883728, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.273368775844574, "acc": 0.8980900645256042, "length": 3.9926764965057373, "mode": "train", "epoch": 10}
{"loss": 0.3734687864780426, "acc": 0.8560764789581299, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.2552541196346283, "acc": 0.9060671329498291, "length": 3.9956271648406982, "mode": "train", "epoch": 11}
{"loss": 0.33377546072006226, "acc": 0.8710936903953552, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.239849254488945, "acc": 0.9128944873809814, "length": 3.9963912963867188, "mode": "train", "epoch": 12}
{"loss": 0.3145304024219513, "acc": 0.8768229484558105, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.227235808968544, "acc": 0.9204044342041016, "length": 3.9974141120910645, "mode": "train", "epoch": 13}
{"loss": 0.28558090329170227, "acc": 0.9012153148651123, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.21510197222232819, "acc": 0.9259728789329529, "length": 3.9983229637145996, "mode": "train", "epoch": 14}
{"loss": 0.29724815487861633, "acc": 0.8911459445953369, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.20516200363636017, "acc": 0.9306968450546265, "length": 3.998361587524414, "mode": "train", "epoch": 15}
{"loss": 0.2780792713165283, "acc": 0.9058159589767456, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.1901247501373291, "acc": 0.9364084601402283, "length": 3.9990439414978027, "mode": "train", "epoch": 16}
{"loss": 0.2733050286769867, "acc": 0.9126735329627991, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.18644440174102783, "acc": 0.9396326541900635, "length": 3.9992995262145996, "mode": "train", "epoch": 17}
{"loss": 0.2721354365348816, "acc": 0.9000867009162903, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.1757896989583969, "acc": 0.942626953125, "length": 3.9994473457336426, "mode": "train", "epoch": 18}
{"loss": 0.2796543836593628, "acc": 0.9025174379348755, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.1736108511686325, "acc": 0.9442634582519531, "length": 3.9995105266571045, "mode": "train", "epoch": 19}
{"loss": 0.2564769983291626, "acc": 0.9112846851348877, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.16773301362991333, "acc": 0.9463168978691101, "length": 3.9995949268341064, "mode": "train", "epoch": 20}
{"loss": 0.27624019980430603, "acc": 0.8988714218139648, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.15401425957679749, "acc": 0.9532058835029602, "length": 3.9996182918548584, "mode": "train", "epoch": 21}
{"loss": 0.2255900502204895, "acc": 0.9208332896232605, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.14556436240673065, "acc": 0.9549497961997986, "length": 3.999650239944458, "mode": "train", "epoch": 22}
{"loss": 0.24645516276359558, "acc": 0.9171874523162842, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.14417196810245514, "acc": 0.9557085633277893, "length": 3.9997754096984863, "mode": "train", "epoch": 23}
{"loss": 0.24284213781356812, "acc": 0.9220486879348755, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.13642747700214386, "acc": 0.9606339335441589, "length": 3.9997940063476562, "mode": "train", "epoch": 24}
{"loss": 0.2175278663635254, "acc": 0.9234374165534973, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.13742944598197937, "acc": 0.9581480622291565, "length": 3.9998438358306885, "mode": "train", "epoch": 25}
{"loss": 0.2147858887910843, "acc": 0.9318576455116272, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1283210813999176, "acc": 0.9617736339569092, "length": 3.999866485595703, "mode": "train", "epoch": 26}
{"loss": 0.19841502606868744, "acc": 0.9328124523162842, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.11699514091014862, "acc": 0.9670003056526184, "length": 3.9998528957366943, "mode": "train", "epoch": 27}
{"loss": 0.17569191753864288, "acc": 0.9437500834465027, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.12031695991754532, "acc": 0.9634888172149658, "length": 3.9998745918273926, "mode": "train", "epoch": 28}
{"loss": 0.20703494548797607, "acc": 0.9329862594604492, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.11324118822813034, "acc": 0.9689903855323792, "length": 3.999845266342163, "mode": "train", "epoch": 29}
{"loss": 0.19422949850559235, "acc": 0.9333333969116211, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1032993420958519, "acc": 0.9713992476463318, "length": 3.9998655319213867, "mode": "train", "epoch": 30}
{"loss": 0.1900411993265152, "acc": 0.9362847208976746, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.09631127119064331, "acc": 0.9750849604606628, "length": 3.999910354614258, "mode": "train", "epoch": 31}
{"loss": 0.1711340695619583, "acc": 0.9488714933395386, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.09101057052612305, "acc": 0.9764412641525269, "length": 3.9999194145202637, "mode": "train", "epoch": 32}
{"loss": 0.15970459580421448, "acc": 0.9487847089767456, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.08649641275405884, "acc": 0.9799569845199585, "length": 3.999924898147583, "mode": "train", "epoch": 33}
{"loss": 0.13978108763694763, "acc": 0.9644097089767456, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.08287268131971359, "acc": 0.9808175563812256, "length": 3.9999477863311768, "mode": "train", "epoch": 34}
{"loss": 0.13079077005386353, "acc": 0.9617187976837158, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.07903353124856949, "acc": 0.9823647737503052, "length": 3.999934673309326, "mode": "train", "epoch": 35}
{"loss": 0.11998413503170013, "acc": 0.9724825620651245, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.07268163561820984, "acc": 0.9864081144332886, "length": 3.9999561309814453, "mode": "train", "epoch": 36}
{"loss": 0.12445209920406342, "acc": 0.9713541865348816, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.07586527615785599, "acc": 0.9836986660957336, "length": 3.999972105026245, "mode": "train", "epoch": 37}
{"loss": 0.11303986608982086, "acc": 0.9743055701255798, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.0690685287117958, "acc": 0.9842225909233093, "length": 3.9999561309814453, "mode": "train", "epoch": 38}
{"loss": 0.09790391474962234, "acc": 0.9782117009162903, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.06412810832262039, "acc": 0.9887622594833374, "length": 3.9999730587005615, "mode": "train", "epoch": 39}
{"loss": 0.08484075218439102, "acc": 0.9822916388511658, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.05694865435361862, "acc": 0.9912531971931458, "length": 3.9999797344207764, "mode": "train", "epoch": 40}
{"loss": 0.10026926547288895, "acc": 0.98046875, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.061024364084005356, "acc": 0.9897876381874084, "length": 3.9999849796295166, "mode": "train", "epoch": 41}
{"loss": 0.10081926733255386, "acc": 0.9769096374511719, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.054902225732803345, "acc": 0.9910058379173279, "length": 3.9999897480010986, "mode": "train", "epoch": 42}
{"loss": 0.09234932065010071, "acc": 0.9812499284744263, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.054154735058546066, "acc": 0.9919450879096985, "length": 3.9999794960021973, "mode": "train", "epoch": 43}
{"loss": 0.09138592332601547, "acc": 0.9809027910232544, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.05085539445281029, "acc": 0.99277663230896, "length": 3.9999892711639404, "mode": "train", "epoch": 44}
{"loss": 0.08261042833328247, "acc": 0.9837672710418701, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.051618583500385284, "acc": 0.9917806386947632, "length": 3.9999897480010986, "mode": "train", "epoch": 45}
{"loss": 0.09140913188457489, "acc": 0.9786458611488342, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.0473024956882, "acc": 0.9932199716567993, "length": 3.999993324279785, "mode": "train", "epoch": 46}
{"loss": 0.07861767709255219, "acc": 0.9846353530883789, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.05233648046851158, "acc": 0.9916149377822876, "length": 3.999993085861206, "mode": "train", "epoch": 47}
{"loss": 0.09724744409322739, "acc": 0.980381965637207, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.048636749386787415, "acc": 0.9934967160224915, "length": 3.9999942779541016, "mode": "train", "epoch": 48}
{"loss": 0.08100693672895432, "acc": 0.9841146469116211, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.051189176738262177, "acc": 0.9927775263786316, "length": 3.999995470046997, "mode": "train", "epoch": 49}
{"loss": 0.08291489630937576, "acc": 0.9842013120651245, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.049881625920534134, "acc": 0.9933030605316162, "length": 3.9999940395355225, "mode": "train", "epoch": 50}
{"loss": 0.09091050922870636, "acc": 0.9815971851348877, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.04609840363264084, "acc": 0.9940497875213623, "length": 3.9999921321868896, "mode": "train", "epoch": 51}
{"loss": 0.07125966995954514, "acc": 0.9861111044883728, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.044737376272678375, "acc": 0.9943820834159851, "length": 3.9999942779541016, "mode": "train", "epoch": 52}
{"loss": 0.08159486949443817, "acc": 0.9859376549720764, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.04602010175585747, "acc": 0.9933308959007263, "length": 3.9999959468841553, "mode": "train", "epoch": 53}
{"loss": 0.08083199709653854, "acc": 0.9870659708976746, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.049911025911569595, "acc": 0.9923626184463501, "length": 3.9999966621398926, "mode": "train", "epoch": 54}
{"loss": 0.08392935246229172, "acc": 0.984809160232544, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.043196067214012146, "acc": 0.994327187538147, "length": 3.9999959468841553, "mode": "train", "epoch": 55}
{"loss": 0.0582953616976738, "acc": 0.9919271469116211, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.04016720503568649, "acc": 0.995185136795044, "length": 3.9999983310699463, "mode": "train", "epoch": 56}
{"loss": 0.07703549414873123, "acc": 0.984375, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.045751165598630905, "acc": 0.992831289768219, "length": 3.99998140335083, "mode": "train", "epoch": 57}
{"loss": 0.08070820569992065, "acc": 0.9868054986000061, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.045782361179590225, "acc": 0.9939953684806824, "length": 3.999998092651367, "mode": "train", "epoch": 58}
{"loss": 0.07718820124864578, "acc": 0.9848958253860474, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.04451395571231842, "acc": 0.9931653738021851, "length": 3.9999988079071045, "mode": "train", "epoch": 59}
{"loss": 0.09282411634922028, "acc": 0.9859374165534973, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.05347898602485657, "acc": 0.9908964037895203, "length": 3.9999992847442627, "mode": "train", "epoch": 60}
{"loss": 0.06586340814828873, "acc": 0.9877604246139526, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7974576354026794
