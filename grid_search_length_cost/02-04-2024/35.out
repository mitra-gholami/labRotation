ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.001", "--max_mess_len=3"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 3
{"loss": 0.3707626163959503, "acc": 0.8393921256065369, "length": 3.8731606006622314, "mode": "train", "epoch": 1}
{"loss": 0.32558000087738037, "acc": 0.8678525686264038, "length": 4.0, "mode": "test", "epoch": 1}
{"loss": 0.21693648397922516, "acc": 0.9269784092903137, "length": 3.9999947547912598, "mode": "train", "epoch": 2}
{"loss": 0.2650410234928131, "acc": 0.8978878855705261, "length": 4.0, "mode": "test", "epoch": 2}
{"loss": 0.16851958632469177, "acc": 0.9502978324890137, "length": 3.999999523162842, "mode": "train", "epoch": 3}
{"loss": 0.22883734107017517, "acc": 0.9165873527526855, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.14339177310466766, "acc": 0.9607563018798828, "length": 4.0, "mode": "train", "epoch": 4}
{"loss": 0.2125854641199112, "acc": 0.9259966611862183, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.12718334794044495, "acc": 0.9664266109466553, "length": 4.0, "mode": "train", "epoch": 5}
{"loss": 0.1830258071422577, "acc": 0.9373072385787964, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.10807223618030548, "acc": 0.973301112651825, "length": 4.0, "mode": "train", "epoch": 6}
{"loss": 0.17939026653766632, "acc": 0.9394301176071167, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.09851010888814926, "acc": 0.9767608046531677, "length": 4.0, "mode": "train", "epoch": 7}
{"loss": 0.1665622442960739, "acc": 0.9466388821601868, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.09221582859754562, "acc": 0.9784544110298157, "length": 4.0, "mode": "train", "epoch": 8}
{"loss": 0.14632548391819, "acc": 0.9530494213104248, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.08702101558446884, "acc": 0.9802243113517761, "length": 4.0, "mode": "train", "epoch": 9}
{"loss": 0.1510937362909317, "acc": 0.9547001719474792, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.08579244464635849, "acc": 0.9806057214736938, "length": 4.0, "mode": "train", "epoch": 10}
{"loss": 0.1136917695403099, "acc": 0.9708460569381714, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.082086943089962, "acc": 0.9816148281097412, "length": 4.0, "mode": "train", "epoch": 11}
{"loss": 0.11369594186544418, "acc": 0.9707089066505432, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.08027753978967667, "acc": 0.9820322394371033, "length": 4.0, "mode": "train", "epoch": 12}
{"loss": 0.11677901446819305, "acc": 0.9690528512001038, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.07740280777215958, "acc": 0.98249351978302, "length": 4.0, "mode": "train", "epoch": 13}
{"loss": 0.10750652104616165, "acc": 0.971064031124115, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.07337550073862076, "acc": 0.9837024807929993, "length": 4.0, "mode": "train", "epoch": 14}
{"loss": 0.10541767627000809, "acc": 0.9746233820915222, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.0700620785355568, "acc": 0.9846280217170715, "length": 4.0, "mode": "train", "epoch": 15}
{"loss": 0.10589244961738586, "acc": 0.9722697734832764, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.06823383271694183, "acc": 0.9852045774459839, "length": 4.0, "mode": "train", "epoch": 16}
{"loss": 0.10864449292421341, "acc": 0.9695915579795837, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.06586062163114548, "acc": 0.9858611226081848, "length": 4.0, "mode": "train", "epoch": 17}
{"loss": 0.09249971807003021, "acc": 0.9757605195045471, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.0643620565533638, "acc": 0.9863566160202026, "length": 4.0, "mode": "train", "epoch": 18}
{"loss": 0.09668778628110886, "acc": 0.9743943810462952, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.06162770837545395, "acc": 0.9872204065322876, "length": 4.0, "mode": "train", "epoch": 19}
{"loss": 0.09535753726959229, "acc": 0.973970890045166, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.06141943484544754, "acc": 0.9872153997421265, "length": 4.0, "mode": "train", "epoch": 20}
{"loss": 0.09696682542562485, "acc": 0.9717326164245605, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.06099165976047516, "acc": 0.9873769879341125, "length": 4.0, "mode": "train", "epoch": 21}
{"loss": 0.08929510414600372, "acc": 0.9771319627761841, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.06063413992524147, "acc": 0.9874047040939331, "length": 4.0, "mode": "train", "epoch": 22}
{"loss": 0.08632014691829681, "acc": 0.9763840436935425, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.05808215215802193, "acc": 0.9880809187889099, "length": 4.0, "mode": "train", "epoch": 23}
{"loss": 0.0774196982383728, "acc": 0.9801903963088989, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.05787893757224083, "acc": 0.9879735112190247, "length": 4.0, "mode": "train", "epoch": 24}
{"loss": 0.07741578668355942, "acc": 0.981570839881897, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.055386096239089966, "acc": 0.9886071085929871, "length": 4.0, "mode": "train", "epoch": 25}
{"loss": 0.06982202082872391, "acc": 0.9841136932373047, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.05147406458854675, "acc": 0.989811897277832, "length": 4.0, "mode": "train", "epoch": 26}
{"loss": 0.06812192499637604, "acc": 0.9840884208679199, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.05160833150148392, "acc": 0.9896558523178101, "length": 4.0, "mode": "train", "epoch": 27}
{"loss": 0.07166662812232971, "acc": 0.9831981062889099, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.04986656829714775, "acc": 0.9903259873390198, "length": 4.0, "mode": "train", "epoch": 28}
{"loss": 0.06611177325248718, "acc": 0.9853499531745911, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.048792436718940735, "acc": 0.990604043006897, "length": 4.0, "mode": "train", "epoch": 29}
{"loss": 0.06422919034957886, "acc": 0.9854832887649536, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.04751819744706154, "acc": 0.9909842014312744, "length": 4.0, "mode": "train", "epoch": 30}
{"loss": 0.06565039604902267, "acc": 0.9855069518089294, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.04775163158774376, "acc": 0.9907963275909424, "length": 4.0, "mode": "train", "epoch": 31}
{"loss": 0.06550862640142441, "acc": 0.9846272468566895, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.04729883745312691, "acc": 0.9908827543258667, "length": 4.0, "mode": "train", "epoch": 32}
{"loss": 0.05799826979637146, "acc": 0.9881308078765869, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.0460788793861866, "acc": 0.9911519289016724, "length": 4.0, "mode": "train", "epoch": 33}
{"loss": 0.0559927374124527, "acc": 0.9868152141571045, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.04622780904173851, "acc": 0.9910065531730652, "length": 4.0, "mode": "train", "epoch": 34}
{"loss": 0.05993322283029556, "acc": 0.9881505966186523, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.0458412691950798, "acc": 0.9911994338035583, "length": 4.0, "mode": "train", "epoch": 35}
{"loss": 0.053900569677352905, "acc": 0.989745557308197, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.04599945619702339, "acc": 0.9909861087799072, "length": 4.0, "mode": "train", "epoch": 36}
{"loss": 0.05278489366173744, "acc": 0.9896014332771301, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.04527715966105461, "acc": 0.9912191033363342, "length": 4.0, "mode": "train", "epoch": 37}
{"loss": 0.055212780833244324, "acc": 0.9886534214019775, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.0449129082262516, "acc": 0.991267740726471, "length": 4.0, "mode": "train", "epoch": 38}
{"loss": 0.05428057163953781, "acc": 0.9883182644844055, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.04808194562792778, "acc": 0.9901841878890991, "length": 4.0, "mode": "train", "epoch": 39}
{"loss": 0.06787307560443878, "acc": 0.9852598309516907, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.04734283685684204, "acc": 0.990295946598053, "length": 4.0, "mode": "train", "epoch": 40}
{"loss": 0.06125181168317795, "acc": 0.9869971871376038, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.044544804841279984, "acc": 0.991269588470459, "length": 4.0, "mode": "train", "epoch": 41}
{"loss": 0.05553504824638367, "acc": 0.988572359085083, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.042992208153009415, "acc": 0.9918437600135803, "length": 4.0, "mode": "train", "epoch": 42}
{"loss": 0.05207279697060585, "acc": 0.9895778298377991, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.04450514167547226, "acc": 0.9912029504776001, "length": 4.0, "mode": "train", "epoch": 43}
{"loss": 0.05449957773089409, "acc": 0.988352358341217, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.04268258064985275, "acc": 0.9917206168174744, "length": 4.0, "mode": "train", "epoch": 44}
{"loss": 0.04912007600069046, "acc": 0.9909422397613525, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04118727892637253, "acc": 0.9921116828918457, "length": 4.0, "mode": "train", "epoch": 45}
{"loss": 0.04956990107893944, "acc": 0.9902176260948181, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.040749434381723404, "acc": 0.9922474026679993, "length": 4.0, "mode": "train", "epoch": 46}
{"loss": 0.0466582328081131, "acc": 0.9912881851196289, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.04139912500977516, "acc": 0.9919741153717041, "length": 4.0, "mode": "train", "epoch": 47}
{"loss": 0.047056835144758224, "acc": 0.9904088377952576, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.040071748197078705, "acc": 0.9923157691955566, "length": 4.0, "mode": "train", "epoch": 48}
{"loss": 0.046490829437971115, "acc": 0.9909963011741638, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.040031056851148605, "acc": 0.99229896068573, "length": 4.0, "mode": "train", "epoch": 49}
{"loss": 0.0424535758793354, "acc": 0.9920721054077148, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.03921078145503998, "acc": 0.9925915002822876, "length": 4.0, "mode": "train", "epoch": 50}
{"loss": 0.046953797340393066, "acc": 0.9913585186004639, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.0389988087117672, "acc": 0.9925470352172852, "length": 4.0, "mode": "train", "epoch": 51}
{"loss": 0.04291224107146263, "acc": 0.9920451045036316, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03776433691382408, "acc": 0.9928767681121826, "length": 4.0, "mode": "train", "epoch": 52}
{"loss": 0.04499027505517006, "acc": 0.9915819764137268, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.03782808780670166, "acc": 0.9927716851234436, "length": 4.0, "mode": "train", "epoch": 53}
{"loss": 0.04961489140987396, "acc": 0.990203320980072, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.038643836975097656, "acc": 0.9925470352172852, "length": 4.0, "mode": "train", "epoch": 54}
{"loss": 0.04668202996253967, "acc": 0.9909494519233704, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.036302804946899414, "acc": 0.993139922618866, "length": 4.0, "mode": "train", "epoch": 55}
{"loss": 0.04228903353214264, "acc": 0.9919334053993225, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.03921731561422348, "acc": 0.9923404455184937, "length": 4.0, "mode": "train", "epoch": 56}
{"loss": 0.04234578460454941, "acc": 0.9920217990875244, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.03728373721241951, "acc": 0.9928053021430969, "length": 4.0, "mode": "train", "epoch": 57}
{"loss": 0.04568235203623772, "acc": 0.991376519203186, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.0376744382083416, "acc": 0.9926377534866333, "length": 4.0, "mode": "train", "epoch": 58}
{"loss": 0.04714876785874367, "acc": 0.990610659122467, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03661661222577095, "acc": 0.9929187297821045, "length": 4.0, "mode": "train", "epoch": 59}
{"loss": 0.04099801555275917, "acc": 0.9922921061515808, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.03609877824783325, "acc": 0.9931164979934692, "length": 4.0, "mode": "train", "epoch": 60}
{"loss": 0.03968214988708496, "acc": 0.9927406907081604, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9426262974739075
