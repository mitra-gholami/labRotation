ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 30
{"loss": 0.6557057499885559, "acc": 0.5745027661323547, "length": 1.3509198427200317, "mode": "train", "epoch": 1}
{"loss": 0.5398629903793335, "acc": 0.7288573384284973, "length": 1.8994659185409546, "mode": "test", "epoch": 1}
{"loss": 0.33166608214378357, "acc": 0.8791272640228271, "length": 2.866539478302002, "mode": "train", "epoch": 2}
{"loss": 0.3363938629627228, "acc": 0.8716415166854858, "length": 3.0024538040161133, "mode": "test", "epoch": 2}
{"loss": 0.2273927479982376, "acc": 0.9286376237869263, "length": 3.143052339553833, "mode": "train", "epoch": 3}
{"loss": 0.2868644893169403, "acc": 0.8941887617111206, "length": 3.0711605548858643, "mode": "test", "epoch": 3}
{"loss": 0.1918071210384369, "acc": 0.9462238550186157, "length": 3.2704265117645264, "mode": "train", "epoch": 4}
{"loss": 0.26932406425476074, "acc": 0.9037994146347046, "length": 3.2865185737609863, "mode": "test", "epoch": 4}
{"loss": 0.17430290579795837, "acc": 0.953517496585846, "length": 3.380201816558838, "mode": "train", "epoch": 5}
{"loss": 0.28086888790130615, "acc": 0.8974825739860535, "length": 3.3325634002685547, "mode": "test", "epoch": 5}
{"loss": 0.16411074995994568, "acc": 0.9571701288223267, "length": 3.400151014328003, "mode": "train", "epoch": 6}
{"loss": 0.2627074122428894, "acc": 0.9017796516418457, "length": 3.359663724899292, "mode": "test", "epoch": 6}
{"loss": 0.15502086281776428, "acc": 0.9602392911911011, "length": 3.3969476222991943, "mode": "train", "epoch": 7}
{"loss": 0.25681692361831665, "acc": 0.9100731611251831, "length": 3.380051851272583, "mode": "test", "epoch": 7}
{"loss": 0.14581820368766785, "acc": 0.9636709094047546, "length": 3.4041748046875, "mode": "train", "epoch": 8}
{"loss": 0.24703869223594666, "acc": 0.9176164269447327, "length": 3.3901920318603516, "mode": "test", "epoch": 8}
{"loss": 0.1386425793170929, "acc": 0.966424286365509, "length": 3.4074578285217285, "mode": "train", "epoch": 9}
{"loss": 0.22318410873413086, "acc": 0.9282053709030151, "length": 3.3849596977233887, "mode": "test", "epoch": 9}
{"loss": 0.13210944831371307, "acc": 0.9689860343933105, "length": 3.4083597660064697, "mode": "train", "epoch": 10}
{"loss": 0.21159616112709045, "acc": 0.9309753179550171, "length": 3.3831913471221924, "mode": "test", "epoch": 10}
{"loss": 0.1282830536365509, "acc": 0.9703692197799683, "length": 3.404691696166992, "mode": "train", "epoch": 11}
{"loss": 0.2062746286392212, "acc": 0.9348340630531311, "length": 3.39080548286438, "mode": "test", "epoch": 11}
{"loss": 0.1252017468214035, "acc": 0.9714783430099487, "length": 3.4142374992370605, "mode": "train", "epoch": 12}
{"loss": 0.18606935441493988, "acc": 0.9442852735519409, "length": 3.39430570602417, "mode": "test", "epoch": 12}
{"loss": 0.12193605303764343, "acc": 0.9725684523582458, "length": 3.4003612995147705, "mode": "train", "epoch": 13}
{"loss": 0.19645775854587555, "acc": 0.9404266476631165, "length": 3.3755412101745605, "mode": "test", "epoch": 13}
{"loss": 0.1197347417473793, "acc": 0.973150908946991, "length": 3.4060275554656982, "mode": "train", "epoch": 14}
{"loss": 0.1793418973684311, "acc": 0.9467479586601257, "length": 3.390841484069824, "mode": "test", "epoch": 14}
{"loss": 0.11816659569740295, "acc": 0.9736342430114746, "length": 3.4068689346313477, "mode": "train", "epoch": 15}
{"loss": 0.17468905448913574, "acc": 0.9510336518287659, "length": 3.392068386077881, "mode": "test", "epoch": 15}
{"loss": 0.11574350297451019, "acc": 0.9744319915771484, "length": 3.4004220962524414, "mode": "train", "epoch": 16}
{"loss": 0.16703031957149506, "acc": 0.9539188146591187, "length": 3.389759063720703, "mode": "test", "epoch": 16}
{"loss": 0.11439870297908783, "acc": 0.9748575687408447, "length": 3.4010422229766846, "mode": "train", "epoch": 17}
{"loss": 0.16508686542510986, "acc": 0.9562597274780273, "length": 3.3880269527435303, "mode": "test", "epoch": 17}
{"loss": 0.11122303456068039, "acc": 0.975805401802063, "length": 3.3944311141967773, "mode": "train", "epoch": 18}
{"loss": 0.15651527047157288, "acc": 0.9577726125717163, "length": 3.39798641204834, "mode": "test", "epoch": 18}
{"loss": 0.11159831285476685, "acc": 0.9753632545471191, "length": 3.403785467147827, "mode": "train", "epoch": 19}
{"loss": 0.15765760838985443, "acc": 0.955558717250824, "length": 3.388604164123535, "mode": "test", "epoch": 19}
{"loss": 0.10809437930583954, "acc": 0.9766885042190552, "length": 3.3973805904388428, "mode": "train", "epoch": 20}
{"loss": 0.15198008716106415, "acc": 0.9584272503852844, "length": 3.3955326080322266, "mode": "test", "epoch": 20}
{"loss": 0.10826315730810165, "acc": 0.9766178727149963, "length": 3.4008262157440186, "mode": "train", "epoch": 21}
{"loss": 0.15385833382606506, "acc": 0.9590075612068176, "length": 3.3987081050872803, "mode": "test", "epoch": 21}
{"loss": 0.10517571866512299, "acc": 0.9775431752204895, "length": 3.398590326309204, "mode": "train", "epoch": 22}
{"loss": 0.16465343534946442, "acc": 0.9536913633346558, "length": 3.4012341499328613, "mode": "test", "epoch": 22}
{"loss": 0.10471179336309433, "acc": 0.9777927398681641, "length": 3.40793776512146, "mode": "train", "epoch": 23}
{"loss": 0.15552915632724762, "acc": 0.95490962266922, "length": 3.3939449787139893, "mode": "test", "epoch": 23}
{"loss": 0.10413489490747452, "acc": 0.9779768586158752, "length": 3.406926155090332, "mode": "train", "epoch": 24}
{"loss": 0.15990214049816132, "acc": 0.9546852707862854, "length": 3.399935007095337, "mode": "test", "epoch": 24}
{"loss": 0.10317790508270264, "acc": 0.9784148931503296, "length": 3.4091591835021973, "mode": "train", "epoch": 25}
{"loss": 0.14858846366405487, "acc": 0.9594480395317078, "length": 3.401703119277954, "mode": "test", "epoch": 25}
{"loss": 0.10198041796684265, "acc": 0.978689968585968, "length": 3.408231496810913, "mode": "train", "epoch": 26}
{"loss": 0.14189985394477844, "acc": 0.9636107683181763, "length": 3.408090353012085, "mode": "test", "epoch": 26}
{"loss": 0.1014588475227356, "acc": 0.978736937046051, "length": 3.4110960960388184, "mode": "train", "epoch": 27}
{"loss": 0.14508391916751862, "acc": 0.9603735208511353, "length": 3.4190242290496826, "mode": "test", "epoch": 27}
{"loss": 0.0990704670548439, "acc": 0.9796899557113647, "length": 3.4158101081848145, "mode": "train", "epoch": 28}
{"loss": 0.13311085104942322, "acc": 0.9680085778236389, "length": 3.4082345962524414, "mode": "test", "epoch": 28}
{"loss": 0.10008301585912704, "acc": 0.9792884588241577, "length": 3.4225878715515137, "mode": "train", "epoch": 29}
{"loss": 0.1313636153936386, "acc": 0.9681172966957092, "length": 3.4194934368133545, "mode": "test", "epoch": 29}
{"loss": 0.09914318472146988, "acc": 0.9796448945999146, "length": 3.4156317710876465, "mode": "train", "epoch": 30}
{"loss": 0.13322709500789642, "acc": 0.9675041437149048, "length": 3.4127092361450195, "mode": "test", "epoch": 30}
{"loss": 0.09805257618427277, "acc": 0.979985773563385, "length": 3.418534517288208, "mode": "train", "epoch": 31}
{"loss": 0.13453659415245056, "acc": 0.9660646915435791, "length": 3.418879985809326, "mode": "test", "epoch": 31}
{"loss": 0.09686263650655746, "acc": 0.9803820848464966, "length": 3.4244916439056396, "mode": "train", "epoch": 32}
{"loss": 0.1260370910167694, "acc": 0.9700251221656799, "length": 3.4138641357421875, "mode": "test", "epoch": 32}
{"loss": 0.09613855183124542, "acc": 0.9805247187614441, "length": 3.430068254470825, "mode": "train", "epoch": 33}
{"loss": 0.12405413389205933, "acc": 0.9704825282096863, "length": 3.4303910732269287, "mode": "test", "epoch": 33}
{"loss": 0.09576376527547836, "acc": 0.980567455291748, "length": 3.4300105571746826, "mode": "train", "epoch": 34}
{"loss": 0.12554968893527985, "acc": 0.9702975749969482, "length": 3.4441397190093994, "mode": "test", "epoch": 34}
{"loss": 0.0956389531493187, "acc": 0.9807690382003784, "length": 3.4325153827667236, "mode": "train", "epoch": 35}
{"loss": 0.1252947598695755, "acc": 0.9709699749946594, "length": 3.425086498260498, "mode": "test", "epoch": 35}
{"loss": 0.09451858699321747, "acc": 0.9811422824859619, "length": 3.430468797683716, "mode": "train", "epoch": 36}
{"loss": 0.11944614350795746, "acc": 0.9716803431510925, "length": 3.4183385372161865, "mode": "test", "epoch": 36}
{"loss": 0.09421779215335846, "acc": 0.9812054634094238, "length": 3.4308297634124756, "mode": "train", "epoch": 37}
{"loss": 0.1144166961312294, "acc": 0.975045382976532, "length": 3.4299581050872803, "mode": "test", "epoch": 37}
{"loss": 0.09340965747833252, "acc": 0.9814272522926331, "length": 3.4314050674438477, "mode": "train", "epoch": 38}
{"loss": 0.11330423504114151, "acc": 0.9756215810775757, "length": 3.424292802810669, "mode": "test", "epoch": 38}
{"loss": 0.09333447366952896, "acc": 0.9814229011535645, "length": 3.43872332572937, "mode": "train", "epoch": 39}
{"loss": 0.12540949881076813, "acc": 0.970254123210907, "length": 3.443923234939575, "mode": "test", "epoch": 39}
{"loss": 0.09445539116859436, "acc": 0.9809752106666565, "length": 3.437082052230835, "mode": "train", "epoch": 40}
{"loss": 0.11343494057655334, "acc": 0.975674033164978, "length": 3.4346492290496826, "mode": "test", "epoch": 40}
{"loss": 0.09307124465703964, "acc": 0.9813596606254578, "length": 3.436729669570923, "mode": "train", "epoch": 41}
{"loss": 0.11415687948465347, "acc": 0.9742702841758728, "length": 3.4293086528778076, "mode": "test", "epoch": 41}
{"loss": 0.09228795766830444, "acc": 0.9816370010375977, "length": 3.4396798610687256, "mode": "train", "epoch": 42}
{"loss": 0.11460664868354797, "acc": 0.9738958477973938, "length": 3.4346492290496826, "mode": "test", "epoch": 42}
{"loss": 0.0922856256365776, "acc": 0.9817006587982178, "length": 3.4402575492858887, "mode": "train", "epoch": 43}
{"loss": 0.11049909889698029, "acc": 0.9763587713241577, "length": 3.436020612716675, "mode": "test", "epoch": 43}
{"loss": 0.093222476541996, "acc": 0.9813241362571716, "length": 3.4453234672546387, "mode": "train", "epoch": 44}
{"loss": 0.11363856494426727, "acc": 0.9746767282485962, "length": 3.445366621017456, "mode": "test", "epoch": 44}
{"loss": 0.0916365310549736, "acc": 0.9818354845046997, "length": 3.450676202774048, "mode": "train", "epoch": 45}
{"loss": 0.10858713090419769, "acc": 0.9777605533599854, "length": 3.4394845962524414, "mode": "test", "epoch": 45}
{"loss": 0.09125413745641708, "acc": 0.9820362329483032, "length": 3.4463565349578857, "mode": "train", "epoch": 46}
{"loss": 0.10980040580034256, "acc": 0.9758617877960205, "length": 3.456516981124878, "mode": "test", "epoch": 46}
{"loss": 0.09119326621294022, "acc": 0.9820133447647095, "length": 3.4542133808135986, "mode": "train", "epoch": 47}
{"loss": 0.10585754364728928, "acc": 0.9781402349472046, "length": 3.4469544887542725, "mode": "test", "epoch": 47}
{"loss": 0.0909065529704094, "acc": 0.9820672273635864, "length": 3.4470176696777344, "mode": "train", "epoch": 48}
{"loss": 0.1133146584033966, "acc": 0.9767735600471497, "length": 3.453810691833496, "mode": "test", "epoch": 48}
{"loss": 0.08998967707157135, "acc": 0.9824187755584717, "length": 3.449646234512329, "mode": "train", "epoch": 49}
{"loss": 0.10401641577482224, "acc": 0.9786426424980164, "length": 3.454857110977173, "mode": "test", "epoch": 49}
{"loss": 0.09574542194604874, "acc": 0.9805228114128113, "length": 3.456434965133667, "mode": "train", "epoch": 50}
{"loss": 0.10745081305503845, "acc": 0.9771512746810913, "length": 3.44944429397583, "mode": "test", "epoch": 50}
{"loss": 0.09386245161294937, "acc": 0.9810695052146912, "length": 3.451517105102539, "mode": "train", "epoch": 51}
{"loss": 0.11173425614833832, "acc": 0.9761991500854492, "length": 3.4537744522094727, "mode": "test", "epoch": 51}
{"loss": 0.09203718602657318, "acc": 0.9816890954971313, "length": 3.4514002799987793, "mode": "train", "epoch": 52}
{"loss": 0.10725811868906021, "acc": 0.9771462082862854, "length": 3.4494802951812744, "mode": "test", "epoch": 52}
{"loss": 0.09087070822715759, "acc": 0.9821197390556335, "length": 3.4527432918548584, "mode": "train", "epoch": 53}
{"loss": 0.10595731437206268, "acc": 0.979434609413147, "length": 3.449841260910034, "mode": "test", "epoch": 53}
{"loss": 0.09010111540555954, "acc": 0.9824284315109253, "length": 3.448927402496338, "mode": "train", "epoch": 54}
{"loss": 0.10856769979000092, "acc": 0.9771859049797058, "length": 3.447892665863037, "mode": "test", "epoch": 54}
{"loss": 0.08975405991077423, "acc": 0.9825460910797119, "length": 3.449559211730957, "mode": "train", "epoch": 55}
{"loss": 0.10885842144489288, "acc": 0.9763643145561218, "length": 3.451284646987915, "mode": "test", "epoch": 55}
{"loss": 0.08934471756219864, "acc": 0.9824850559234619, "length": 3.453507661819458, "mode": "train", "epoch": 56}
{"loss": 0.10164858400821686, "acc": 0.9801517128944397, "length": 3.45662522315979, "mode": "test", "epoch": 56}
{"loss": 0.08901958912611008, "acc": 0.9827254414558411, "length": 3.4541265964508057, "mode": "train", "epoch": 57}
{"loss": 0.10165274143218994, "acc": 0.9803969264030457, "length": 3.4517898559570312, "mode": "test", "epoch": 57}
{"loss": 0.08872770518064499, "acc": 0.9827786087989807, "length": 3.454159736633301, "mode": "train", "epoch": 58}
{"loss": 0.10327600687742233, "acc": 0.9781083464622498, "length": 3.4514288902282715, "mode": "test", "epoch": 58}
{"loss": 0.0894893929362297, "acc": 0.9825469255447388, "length": 3.4496870040893555, "mode": "train", "epoch": 59}
{"loss": 0.10480695217847824, "acc": 0.979655921459198, "length": 3.448866844177246, "mode": "test", "epoch": 59}
{"loss": 0.08989045023918152, "acc": 0.9824095964431763, "length": 3.4522273540496826, "mode": "train", "epoch": 60}
{"loss": 0.09988291561603546, "acc": 0.9794542789459229, "length": 3.4538466930389404, "mode": "test", "epoch": 60}
test accuracy: 0.9194822907447815
