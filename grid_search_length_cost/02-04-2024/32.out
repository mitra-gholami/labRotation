ndevices 0
# ["--attributes=3", "--values=16", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.005", "--max_mess_len=10"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 52
message length 10
{"loss": 0.6986843943595886, "acc": 0.5020979642868042, "length": 1.071456789970398, "mode": "train", "epoch": 1}
{"loss": 0.6980317831039429, "acc": 0.5056354999542236, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6959932446479797, "acc": 0.5096296072006226, "length": 1.0183236598968506, "mode": "train", "epoch": 2}
{"loss": 0.6504874229431152, "acc": 0.6379616856575012, "length": 1.4852581024169922, "mode": "test", "epoch": 2}
{"loss": 0.3631943464279175, "acc": 0.8546466827392578, "length": 2.3079142570495605, "mode": "train", "epoch": 3}
{"loss": 0.30921557545661926, "acc": 0.8894854784011841, "length": 2.49542236328125, "mode": "test", "epoch": 3}
{"loss": 0.24437697231769562, "acc": 0.9215338230133057, "length": 2.5686841011047363, "mode": "train", "epoch": 4}
{"loss": 0.2622380256652832, "acc": 0.912276566028595, "length": 2.548551082611084, "mode": "test", "epoch": 4}
{"loss": 0.2086523175239563, "acc": 0.9382089376449585, "length": 2.6069247722625732, "mode": "train", "epoch": 5}
{"loss": 0.2315816879272461, "acc": 0.9280208349227905, "length": 2.57846736907959, "mode": "test", "epoch": 5}
{"loss": 0.1877763867378235, "acc": 0.9470290541648865, "length": 2.6454977989196777, "mode": "train", "epoch": 6}
{"loss": 0.23427297174930573, "acc": 0.9207417368888855, "length": 2.6238465309143066, "mode": "test", "epoch": 6}
{"loss": 0.17253117263317108, "acc": 0.9535301923751831, "length": 2.6797008514404297, "mode": "train", "epoch": 7}
{"loss": 0.20309701561927795, "acc": 0.9390158653259277, "length": 2.6717848777770996, "mode": "test", "epoch": 7}
{"loss": 0.16397850215435028, "acc": 0.9565962553024292, "length": 2.702456474304199, "mode": "train", "epoch": 8}
{"loss": 0.20983226597309113, "acc": 0.9356802105903625, "length": 2.683427095413208, "mode": "test", "epoch": 8}
{"loss": 0.1578575074672699, "acc": 0.9591188430786133, "length": 2.715716600418091, "mode": "train", "epoch": 9}
{"loss": 0.2079349011182785, "acc": 0.9325091242790222, "length": 2.6964027881622314, "mode": "test", "epoch": 9}
{"loss": 0.15358193218708038, "acc": 0.9609929919242859, "length": 2.723156690597534, "mode": "train", "epoch": 10}
{"loss": 0.21067021787166595, "acc": 0.9246912002563477, "length": 2.698385238647461, "mode": "test", "epoch": 10}
{"loss": 0.1495705544948578, "acc": 0.9626762270927429, "length": 2.732051372528076, "mode": "train", "epoch": 11}
{"loss": 0.20595131814479828, "acc": 0.9310771822929382, "length": 2.728842258453369, "mode": "test", "epoch": 11}
{"loss": 0.14697325229644775, "acc": 0.9635130167007446, "length": 2.743131399154663, "mode": "train", "epoch": 12}
{"loss": 0.21706074476242065, "acc": 0.9277622699737549, "length": 2.7577133178710938, "mode": "test", "epoch": 12}
{"loss": 0.14444036781787872, "acc": 0.964262068271637, "length": 2.755549669265747, "mode": "train", "epoch": 13}
{"loss": 0.19303829967975616, "acc": 0.9397088885307312, "length": 2.7420341968536377, "mode": "test", "epoch": 13}
{"loss": 0.14155027270317078, "acc": 0.9654964804649353, "length": 2.759542465209961, "mode": "train", "epoch": 14}
{"loss": 0.1992661952972412, "acc": 0.9361259937286377, "length": 2.7419981956481934, "mode": "test", "epoch": 14}
{"loss": 0.140000581741333, "acc": 0.965931236743927, "length": 2.754194736480713, "mode": "train", "epoch": 15}
{"loss": 0.18914104998111725, "acc": 0.9424818158149719, "length": 2.7515859603881836, "mode": "test", "epoch": 15}
{"loss": 0.13854587078094482, "acc": 0.9663445353507996, "length": 2.7560153007507324, "mode": "train", "epoch": 16}
{"loss": 0.19314591586589813, "acc": 0.9400312304496765, "length": 2.7432236671447754, "mode": "test", "epoch": 16}
{"loss": 0.13659316301345825, "acc": 0.9670380353927612, "length": 2.7646403312683105, "mode": "train", "epoch": 17}
{"loss": 0.21147331595420837, "acc": 0.933885395526886, "length": 2.7508649826049805, "mode": "test", "epoch": 17}
{"loss": 0.13462024927139282, "acc": 0.9677232503890991, "length": 2.7638602256774902, "mode": "train", "epoch": 18}
{"loss": 0.20527130365371704, "acc": 0.9360631704330444, "length": 2.7594075202941895, "mode": "test", "epoch": 18}
{"loss": 0.13306361436843872, "acc": 0.9681939482688904, "length": 2.7664425373077393, "mode": "train", "epoch": 19}
{"loss": 0.20882411301136017, "acc": 0.9281440377235413, "length": 2.7667603492736816, "mode": "test", "epoch": 19}
{"loss": 0.13278481364250183, "acc": 0.9682735204696655, "length": 2.7658491134643555, "mode": "train", "epoch": 20}
{"loss": 0.19559000432491302, "acc": 0.9368706345558167, "length": 2.76070499420166, "mode": "test", "epoch": 20}
{"loss": 0.13123591244220734, "acc": 0.9687614440917969, "length": 2.7673707008361816, "mode": "train", "epoch": 21}
{"loss": 0.20544591546058655, "acc": 0.9307531118392944, "length": 2.7675893306732178, "mode": "test", "epoch": 21}
{"loss": 0.1302931159734726, "acc": 0.9691964387893677, "length": 2.767975330352783, "mode": "train", "epoch": 22}
{"loss": 0.20235750079154968, "acc": 0.935962975025177, "length": 2.772491455078125, "mode": "test", "epoch": 22}
{"loss": 0.12984517216682434, "acc": 0.969244122505188, "length": 2.7670204639434814, "mode": "train", "epoch": 23}
{"loss": 0.1865147054195404, "acc": 0.9405481219291687, "length": 2.7606329917907715, "mode": "test", "epoch": 23}
{"loss": 0.12979291379451752, "acc": 0.9691365957260132, "length": 2.767667770385742, "mode": "train", "epoch": 24}
{"loss": 0.21479375660419464, "acc": 0.9296410083770752, "length": 2.766472101211548, "mode": "test", "epoch": 24}
{"loss": 0.12870459258556366, "acc": 0.9694781303405762, "length": 2.760976552963257, "mode": "train", "epoch": 25}
{"loss": 0.19950060546398163, "acc": 0.9362260103225708, "length": 2.7596957683563232, "mode": "test", "epoch": 25}
{"loss": 0.12820491194725037, "acc": 0.9696862697601318, "length": 2.770695686340332, "mode": "train", "epoch": 26}
{"loss": 0.21473510563373566, "acc": 0.9352604150772095, "length": 2.7815744876861572, "mode": "test", "epoch": 26}
{"loss": 0.12867501378059387, "acc": 0.9694071412086487, "length": 2.7739717960357666, "mode": "train", "epoch": 27}
{"loss": 0.18927817046642303, "acc": 0.9424538016319275, "length": 2.7690672874450684, "mode": "test", "epoch": 27}
{"loss": 0.12737588584423065, "acc": 0.9700733423233032, "length": 2.774120330810547, "mode": "train", "epoch": 28}
{"loss": 0.20108512043952942, "acc": 0.9324633479118347, "length": 2.7734644412994385, "mode": "test", "epoch": 28}
{"loss": 0.12707406282424927, "acc": 0.9699830412864685, "length": 2.7774624824523926, "mode": "train", "epoch": 29}
{"loss": 0.1902923434972763, "acc": 0.941961407661438, "length": 2.783592939376831, "mode": "test", "epoch": 29}
{"loss": 0.1268230676651001, "acc": 0.9701700210571289, "length": 2.77939772605896, "mode": "train", "epoch": 30}
{"loss": 0.20630407333374023, "acc": 0.9395405650138855, "length": 2.7840614318847656, "mode": "test", "epoch": 30}
{"loss": 0.12704749405384064, "acc": 0.9700276851654053, "length": 2.780442476272583, "mode": "train", "epoch": 31}
{"loss": 0.18656077980995178, "acc": 0.9415613412857056, "length": 2.7767446041107178, "mode": "test", "epoch": 31}
{"loss": 0.12644243240356445, "acc": 0.9701874256134033, "length": 2.7834746837615967, "mode": "train", "epoch": 32}
{"loss": 0.2087513506412506, "acc": 0.9364351630210876, "length": 2.7970011234283447, "mode": "test", "epoch": 32}
{"loss": 0.12527844309806824, "acc": 0.9704660177230835, "length": 2.7927465438842773, "mode": "train", "epoch": 33}
{"loss": 0.185895174741745, "acc": 0.9459132552146912, "length": 2.807634115219116, "mode": "test", "epoch": 33}
{"loss": 0.12441693991422653, "acc": 0.9708163738250732, "length": 2.795452833175659, "mode": "train", "epoch": 34}
{"loss": 0.19500327110290527, "acc": 0.9371599555015564, "length": 2.78409743309021, "mode": "test", "epoch": 34}
{"loss": 0.12432029843330383, "acc": 0.9707670211791992, "length": 2.788231134414673, "mode": "train", "epoch": 35}
{"loss": 0.192781001329422, "acc": 0.9392438530921936, "length": 2.7841334342956543, "mode": "test", "epoch": 35}
{"loss": 0.12419261783361435, "acc": 0.9708530306816101, "length": 2.7927842140197754, "mode": "train", "epoch": 36}
{"loss": 0.198592871427536, "acc": 0.935689389705658, "length": 2.776492118835449, "mode": "test", "epoch": 36}
{"loss": 0.1250823736190796, "acc": 0.9704274535179138, "length": 2.7924375534057617, "mode": "train", "epoch": 37}
{"loss": 0.20511747896671295, "acc": 0.9416204690933228, "length": 2.7891435623168945, "mode": "test", "epoch": 37}
{"loss": 0.1244603842496872, "acc": 0.9706486463546753, "length": 2.784240961074829, "mode": "train", "epoch": 38}
{"loss": 0.1942124217748642, "acc": 0.9395297765731812, "length": 2.78125, "mode": "test", "epoch": 38}
{"loss": 0.12299562990665436, "acc": 0.9710054993629456, "length": 2.786334276199341, "mode": "train", "epoch": 39}
{"loss": 0.1908261924982071, "acc": 0.9441894292831421, "length": 2.7914865016937256, "mode": "test", "epoch": 39}
{"loss": 0.12404102087020874, "acc": 0.9706677198410034, "length": 2.7939422130584717, "mode": "train", "epoch": 40}
{"loss": 0.18108521401882172, "acc": 0.9438872337341309, "length": 2.7951629161834717, "mode": "test", "epoch": 40}
{"loss": 0.12266705930233002, "acc": 0.9712437391281128, "length": 2.793346881866455, "mode": "train", "epoch": 41}
{"loss": 0.1700383424758911, "acc": 0.9503297209739685, "length": 2.8012542724609375, "mode": "test", "epoch": 41}
{"loss": 0.12207948416471481, "acc": 0.9713260531425476, "length": 2.795642614364624, "mode": "train", "epoch": 42}
{"loss": 0.17795690894126892, "acc": 0.9486824870109558, "length": 2.809147834777832, "mode": "test", "epoch": 42}
{"loss": 0.12211176007986069, "acc": 0.9712119698524475, "length": 2.796037435531616, "mode": "train", "epoch": 43}
{"loss": 0.1696876883506775, "acc": 0.9509637951850891, "length": 2.7961721420288086, "mode": "test", "epoch": 43}
{"loss": 0.12121164798736572, "acc": 0.9714242219924927, "length": 2.791755437850952, "mode": "train", "epoch": 44}
{"loss": 0.18407253921031952, "acc": 0.9456281661987305, "length": 2.801903009414673, "mode": "test", "epoch": 44}
{"loss": 0.12119142711162567, "acc": 0.9713480472564697, "length": 2.7927651405334473, "mode": "train", "epoch": 45}
{"loss": 0.15824252367019653, "acc": 0.9534838795661926, "length": 2.7920632362365723, "mode": "test", "epoch": 45}
{"loss": 0.12073442339897156, "acc": 0.9716320633888245, "length": 2.8044848442077637, "mode": "train", "epoch": 46}
{"loss": 0.16870279610157013, "acc": 0.9487308859825134, "length": 2.798334836959839, "mode": "test", "epoch": 46}
{"loss": 0.12048018723726273, "acc": 0.9715836048126221, "length": 2.8004207611083984, "mode": "train", "epoch": 47}
{"loss": 0.15572896599769592, "acc": 0.9564544558525085, "length": 2.8011462688446045, "mode": "test", "epoch": 47}
{"loss": 0.12197982519865036, "acc": 0.9711322784423828, "length": 2.807781934738159, "mode": "train", "epoch": 48}
{"loss": 0.17060509324073792, "acc": 0.9497674107551575, "length": 2.806192398071289, "mode": "test", "epoch": 48}
{"loss": 0.1210760846734047, "acc": 0.9714893102645874, "length": 2.8024396896362305, "mode": "train", "epoch": 49}
{"loss": 0.16203491389751434, "acc": 0.9543470144271851, "length": 2.8069491386413574, "mode": "test", "epoch": 49}
{"loss": 0.12004151195287704, "acc": 0.9717233777046204, "length": 2.8079464435577393, "mode": "train", "epoch": 50}
{"loss": 0.16873352229595184, "acc": 0.9502344131469727, "length": 2.805759906768799, "mode": "test", "epoch": 50}
{"loss": 0.11962706595659256, "acc": 0.9719623923301697, "length": 2.8032686710357666, "mode": "train", "epoch": 51}
{"loss": 0.15719449520111084, "acc": 0.958318829536438, "length": 2.7957756519317627, "mode": "test", "epoch": 51}
{"loss": 0.11855735629796982, "acc": 0.9722109436988831, "length": 2.8035361766815186, "mode": "train", "epoch": 52}
{"loss": 0.18072828650474548, "acc": 0.9426445364952087, "length": 2.802119493484497, "mode": "test", "epoch": 52}
{"loss": 0.11905410140752792, "acc": 0.9719380736351013, "length": 2.802572250366211, "mode": "train", "epoch": 53}
{"loss": 0.1638329178094864, "acc": 0.9510618448257446, "length": 2.81423020362854, "mode": "test", "epoch": 53}
{"loss": 0.11854518949985504, "acc": 0.9721752405166626, "length": 2.816171884536743, "mode": "train", "epoch": 54}
{"loss": 0.1680014431476593, "acc": 0.9501283764839172, "length": 2.81819486618042, "mode": "test", "epoch": 54}
{"loss": 0.11869736760854721, "acc": 0.9720999598503113, "length": 2.812908172607422, "mode": "train", "epoch": 55}
{"loss": 0.16448183357715607, "acc": 0.9502769112586975, "length": 2.810481548309326, "mode": "test", "epoch": 55}
{"loss": 0.11886145174503326, "acc": 0.9720540642738342, "length": 2.813716173171997, "mode": "train", "epoch": 56}
{"loss": 0.15442143380641937, "acc": 0.9576016068458557, "length": 2.8159961700439453, "mode": "test", "epoch": 56}
{"loss": 0.11884210258722305, "acc": 0.9720801711082458, "length": 2.8171346187591553, "mode": "train", "epoch": 57}
{"loss": 0.1604166030883789, "acc": 0.9548267126083374, "length": 2.8130767345428467, "mode": "test", "epoch": 57}
{"loss": 0.11994249373674393, "acc": 0.9712061285972595, "length": 2.8060107231140137, "mode": "train", "epoch": 58}
{"loss": 0.17042751610279083, "acc": 0.9469569325447083, "length": 2.816068410873413, "mode": "test", "epoch": 58}
{"loss": 0.1193142905831337, "acc": 0.9714087843894958, "length": 2.8094215393066406, "mode": "train", "epoch": 59}
{"loss": 0.14947421848773956, "acc": 0.9609552621841431, "length": 2.819852828979492, "mode": "test", "epoch": 59}
{"loss": 0.11943554878234863, "acc": 0.9715947508811951, "length": 2.8082470893859863, "mode": "train", "epoch": 60}
{"loss": 0.16165736317634583, "acc": 0.954144299030304, "length": 2.8144824504852295, "mode": "test", "epoch": 60}
test accuracy: 0.9147293567657471
