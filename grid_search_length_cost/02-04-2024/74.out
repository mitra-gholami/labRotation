ndevices 0
# ["--attributes=5", "--values=4", "--context_unaware=False", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=2", "--length_cost=0.0005", "--max_mess_len=30"]
Creating train_ds and val_ds...

Creating test_ds...
vocab size 16
message length 30
{"loss": 0.31038904190063477, "acc": 0.8712596297264099, "length": 10.767233848571777, "mode": "train", "epoch": 1}
{"loss": 0.3444088101387024, "acc": 0.8645176291465759, "length": 12.254894256591797, "mode": "test", "epoch": 1}
{"loss": 0.1830689162015915, "acc": 0.9436261057853699, "length": 12.100593566894531, "mode": "train", "epoch": 2}
{"loss": 0.2854556739330292, "acc": 0.8945005536079407, "length": 15.569439888000488, "mode": "test", "epoch": 2}
{"loss": 0.13522973656654358, "acc": 0.9621177315711975, "length": 12.543840408325195, "mode": "train", "epoch": 3}
{"loss": 0.2241286188364029, "acc": 0.9260047674179077, "length": 14.35341739654541, "mode": "test", "epoch": 3}
{"loss": 0.1056097075343132, "acc": 0.9728615880012512, "length": 13.329015731811523, "mode": "train", "epoch": 4}
{"loss": 0.18555757403373718, "acc": 0.9401723146438599, "length": 14.613205909729004, "mode": "test", "epoch": 4}
{"loss": 0.07526807487010956, "acc": 0.9823319315910339, "length": 13.32396125793457, "mode": "train", "epoch": 5}
{"loss": 0.1793859302997589, "acc": 0.9420062303543091, "length": 13.77647590637207, "mode": "test", "epoch": 5}
{"loss": 0.049815427511930466, "acc": 0.990790843963623, "length": 13.339004516601562, "mode": "train", "epoch": 6}
{"loss": 0.10387489199638367, "acc": 0.9708361029624939, "length": 13.024871826171875, "mode": "test", "epoch": 6}
{"loss": 0.04304327070713043, "acc": 0.992362916469574, "length": 12.718844413757324, "mode": "train", "epoch": 7}
{"loss": 0.11755645275115967, "acc": 0.9679948687553406, "length": 12.202824592590332, "mode": "test", "epoch": 7}
{"loss": 0.036962736397981644, "acc": 0.9930247664451599, "length": 12.203032493591309, "mode": "train", "epoch": 8}
{"loss": 0.10254867374897003, "acc": 0.9693616032600403, "length": 12.102575302124023, "mode": "test", "epoch": 8}
{"loss": 0.02131694182753563, "acc": 0.9967489838600159, "length": 11.38919734954834, "mode": "train", "epoch": 9}
{"loss": 0.06384184956550598, "acc": 0.983039140701294, "length": 11.764081001281738, "mode": "test", "epoch": 9}
{"loss": 0.017440399155020714, "acc": 0.997744083404541, "length": 11.210744857788086, "mode": "train", "epoch": 10}
{"loss": 0.06993062794208527, "acc": 0.9808861017227173, "length": 10.674101829528809, "mode": "test", "epoch": 10}
{"loss": 0.014679744839668274, "acc": 0.9983574748039246, "length": 11.084110260009766, "mode": "train", "epoch": 11}
{"loss": 0.05795454978942871, "acc": 0.9848929047584534, "length": 11.1692476272583, "mode": "test", "epoch": 11}
{"loss": 0.013385819271206856, "acc": 0.998502790927887, "length": 10.44355583190918, "mode": "train", "epoch": 12}
{"loss": 0.062177807092666626, "acc": 0.9831289052963257, "length": 9.78574275970459, "mode": "test", "epoch": 12}
{"loss": 0.013298428617417812, "acc": 0.9983812570571899, "length": 10.07546615600586, "mode": "train", "epoch": 13}
{"loss": 0.030233263969421387, "acc": 0.9935611486434937, "length": 9.92923641204834, "mode": "test", "epoch": 13}
{"loss": 0.011133302003145218, "acc": 0.9988712668418884, "length": 10.011707305908203, "mode": "train", "epoch": 14}
{"loss": 0.028513459488749504, "acc": 0.9934751391410828, "length": 9.792963981628418, "mode": "test", "epoch": 14}
{"loss": 0.011712238192558289, "acc": 0.9986501336097717, "length": 9.675541877746582, "mode": "train", "epoch": 15}
{"loss": 0.051120683550834656, "acc": 0.9854385256767273, "length": 9.582036018371582, "mode": "test", "epoch": 15}
{"loss": 0.012021178379654884, "acc": 0.9986519813537598, "length": 10.225931167602539, "mode": "train", "epoch": 16}
{"loss": 0.03941056877374649, "acc": 0.990487813949585, "length": 11.228538513183594, "mode": "test", "epoch": 16}
{"loss": 0.01165103167295456, "acc": 0.9986748695373535, "length": 10.194395065307617, "mode": "train", "epoch": 17}
{"loss": 0.017130006104707718, "acc": 0.997380793094635, "length": 9.286946296691895, "mode": "test", "epoch": 17}
{"loss": 0.009559627622365952, "acc": 0.9991017580032349, "length": 9.192049026489258, "mode": "train", "epoch": 18}
{"loss": 0.02257583849132061, "acc": 0.9954634308815002, "length": 9.545851707458496, "mode": "test", "epoch": 18}
{"loss": 0.01025738287717104, "acc": 0.9989438056945801, "length": 9.265926361083984, "mode": "train", "epoch": 19}
{"loss": 0.07809674739837646, "acc": 0.9792390465736389, "length": 9.17069149017334, "mode": "test", "epoch": 19}
{"loss": 0.009623843245208263, "acc": 0.9990085363388062, "length": 9.030924797058105, "mode": "train", "epoch": 20}
{"loss": 0.0154398363083601, "acc": 0.997840940952301, "length": 8.80283260345459, "mode": "test", "epoch": 20}
{"loss": 0.008442145772278309, "acc": 0.9993417263031006, "length": 9.070128440856934, "mode": "train", "epoch": 21}
{"loss": 0.01383040752261877, "acc": 0.998172402381897, "length": 8.856987953186035, "mode": "test", "epoch": 21}
{"loss": 0.013117409311234951, "acc": 0.9981066584587097, "length": 9.081634521484375, "mode": "train", "epoch": 22}
{"loss": 0.030848700553178787, "acc": 0.9931927919387817, "length": 9.822809219360352, "mode": "test", "epoch": 22}
{"loss": 0.01313315611332655, "acc": 0.99796062707901, "length": 9.23088550567627, "mode": "train", "epoch": 23}
{"loss": 0.02266252599656582, "acc": 0.9954079389572144, "length": 8.63972282409668, "mode": "test", "epoch": 23}
{"loss": 0.008749575354158878, "acc": 0.9992271661758423, "length": 9.000536918640137, "mode": "train", "epoch": 24}
{"loss": 0.01297710184007883, "acc": 0.9984765648841858, "length": 9.932847023010254, "mode": "test", "epoch": 24}
{"loss": 0.009314007125794888, "acc": 0.9990587830543518, "length": 8.927088737487793, "mode": "train", "epoch": 25}
{"loss": 0.013796794228255749, "acc": 0.9980446696281433, "length": 8.88803768157959, "mode": "test", "epoch": 25}
{"loss": 0.010077917017042637, "acc": 0.9988776445388794, "length": 9.014063835144043, "mode": "train", "epoch": 26}
{"loss": 0.011870447546243668, "acc": 0.9989063143730164, "length": 9.280688285827637, "mode": "test", "epoch": 26}
{"loss": 0.008156838826835155, "acc": 0.9993167519569397, "length": 8.756940841674805, "mode": "train", "epoch": 27}
{"loss": 0.018658418208360672, "acc": 0.9968647360801697, "length": 8.703706741333008, "mode": "test", "epoch": 27}
{"loss": 0.007950297556817532, "acc": 0.9993354678153992, "length": 8.666158676147461, "mode": "train", "epoch": 28}
{"loss": 0.013659779913723469, "acc": 0.9972760677337646, "length": 8.707076072692871, "mode": "test", "epoch": 28}
{"loss": 0.009455072693526745, "acc": 0.9989544749259949, "length": 8.469198226928711, "mode": "train", "epoch": 29}
{"loss": 0.05466103553771973, "acc": 0.9867057800292969, "length": 8.259748458862305, "mode": "test", "epoch": 29}
{"loss": 0.009762398898601532, "acc": 0.9988573789596558, "length": 8.61712646484375, "mode": "train", "epoch": 30}
{"loss": 0.011611341498792171, "acc": 0.9986329674720764, "length": 8.58897590637207, "mode": "test", "epoch": 30}
{"loss": 0.007901111617684364, "acc": 0.999320924282074, "length": 8.215210914611816, "mode": "train", "epoch": 31}
{"loss": 0.013605059124529362, "acc": 0.9976537227630615, "length": 7.967667102813721, "mode": "test", "epoch": 31}
{"loss": 0.008356365375220776, "acc": 0.9991803169250488, "length": 8.11587905883789, "mode": "train", "epoch": 32}
{"loss": 0.02025773748755455, "acc": 0.9963080883026123, "length": 8.179156303405762, "mode": "test", "epoch": 32}
{"loss": 0.07717521488666534, "acc": 0.9751400351524353, "length": 16.035215377807617, "mode": "train", "epoch": 33}
{"loss": 0.08328627049922943, "acc": 0.9720868468284607, "length": 17.01797103881836, "mode": "test", "epoch": 33}
{"loss": 0.07094138860702515, "acc": 0.975714385509491, "length": 14.5326566696167, "mode": "train", "epoch": 34}
{"loss": 0.07380425184965134, "acc": 0.9760121703147888, "length": 14.393814086914062, "mode": "test", "epoch": 34}
{"loss": 0.038305919617414474, "acc": 0.988917887210846, "length": 12.746203422546387, "mode": "train", "epoch": 35}
{"loss": 0.02073783054947853, "acc": 0.9963692426681519, "length": 10.699414253234863, "mode": "test", "epoch": 35}
{"loss": 0.014224367216229439, "acc": 0.9976767301559448, "length": 11.048194885253906, "mode": "train", "epoch": 36}
{"loss": 0.011892003007233143, "acc": 0.9988463521003723, "length": 9.843629837036133, "mode": "test", "epoch": 36}
{"loss": 0.008561931550502777, "acc": 0.999241292476654, "length": 9.288414001464844, "mode": "train", "epoch": 37}
{"loss": 0.00831836648285389, "acc": 0.9993903040885925, "length": 8.8254976272583, "mode": "test", "epoch": 37}
{"loss": 0.011298920959234238, "acc": 0.9983701705932617, "length": 9.878447532653809, "mode": "train", "epoch": 38}
{"loss": 0.02312532439827919, "acc": 0.9954662919044495, "length": 12.177149772644043, "mode": "test", "epoch": 38}
{"loss": 0.018201591446995735, "acc": 0.9963861703872681, "length": 11.367435455322266, "mode": "train", "epoch": 39}
{"loss": 0.019829101860523224, "acc": 0.996756911277771, "length": 10.827703475952148, "mode": "test", "epoch": 39}
{"loss": 0.01956828311085701, "acc": 0.9960070252418518, "length": 10.835021018981934, "mode": "train", "epoch": 40}
{"loss": 0.033519502729177475, "acc": 0.9933730959892273, "length": 16.078907012939453, "mode": "test", "epoch": 40}
{"loss": 0.019920198246836662, "acc": 0.9960454702377319, "length": 12.578165054321289, "mode": "train", "epoch": 41}
{"loss": 0.013336049392819405, "acc": 0.9980510473251343, "length": 10.486762046813965, "mode": "test", "epoch": 41}
{"loss": 0.01709158904850483, "acc": 0.9971925020217896, "length": 12.487101554870605, "mode": "train", "epoch": 42}
{"loss": 0.02116340398788452, "acc": 0.9969106316566467, "length": 11.438061714172363, "mode": "test", "epoch": 42}
{"loss": 0.019508354365825653, "acc": 0.9963502287864685, "length": 10.969120025634766, "mode": "train", "epoch": 43}
{"loss": 0.10781281441450119, "acc": 0.9627010226249695, "length": 14.051347732543945, "mode": "test", "epoch": 43}
{"loss": 0.051496461033821106, "acc": 0.9830886721611023, "length": 14.120208740234375, "mode": "train", "epoch": 44}
{"loss": 0.06382479518651962, "acc": 0.9789906144142151, "length": 18.087411880493164, "mode": "test", "epoch": 44}
{"loss": 0.03526397794485092, "acc": 0.9896974563598633, "length": 13.966691017150879, "mode": "train", "epoch": 45}
{"loss": 0.02085406892001629, "acc": 0.9964814186096191, "length": 12.72392463684082, "mode": "test", "epoch": 45}
{"loss": 0.01817234233021736, "acc": 0.9966703653335571, "length": 11.869558334350586, "mode": "train", "epoch": 46}
{"loss": 0.0186019130051136, "acc": 0.9968371391296387, "length": 11.079228401184082, "mode": "test", "epoch": 46}
{"loss": 0.012415178120136261, "acc": 0.998336136341095, "length": 9.916836738586426, "mode": "train", "epoch": 47}
{"loss": 0.011622421443462372, "acc": 0.9987083077430725, "length": 10.094511985778809, "mode": "test", "epoch": 47}
{"loss": 0.008610247634351254, "acc": 0.999193012714386, "length": 9.23065185546875, "mode": "train", "epoch": 48}
{"loss": 0.010111771523952484, "acc": 0.9988192319869995, "length": 8.685654640197754, "mode": "test", "epoch": 48}
{"loss": 0.019997889176011086, "acc": 0.9963284134864807, "length": 10.346171379089355, "mode": "train", "epoch": 49}
{"loss": 0.025769079104065895, "acc": 0.9950969219207764, "length": 11.887435913085938, "mode": "test", "epoch": 49}
{"loss": 0.04428854212164879, "acc": 0.9898484349250793, "length": 16.29973602294922, "mode": "train", "epoch": 50}
{"loss": 0.11925332993268967, "acc": 0.9652062654495239, "length": 27.148948669433594, "mode": "test", "epoch": 50}
{"loss": 0.0781712755560875, "acc": 0.9798023700714111, "length": 23.496225357055664, "mode": "train", "epoch": 51}
{"loss": 0.1578410416841507, "acc": 0.9550619721412659, "length": 27.989368438720703, "mode": "test", "epoch": 51}
{"loss": 0.14069679379463196, "acc": 0.9579282402992249, "length": 28.821487426757812, "mode": "train", "epoch": 52}
{"loss": 0.17617736756801605, "acc": 0.946163535118103, "length": 29.833078384399414, "mode": "test", "epoch": 52}
{"loss": 0.13999639451503754, "acc": 0.9560297131538391, "length": 28.69343376159668, "mode": "train", "epoch": 53}
{"loss": 0.1718544363975525, "acc": 0.9427985548973083, "length": 29.754894256591797, "mode": "test", "epoch": 53}
{"loss": 0.16377058625221252, "acc": 0.9460692405700684, "length": 28.681936264038086, "mode": "train", "epoch": 54}
{"loss": 0.20189151167869568, "acc": 0.9315833449363708, "length": 29.122352600097656, "mode": "test", "epoch": 54}
{"loss": 0.16920796036720276, "acc": 0.9428046345710754, "length": 29.365196228027344, "mode": "train", "epoch": 55}
{"loss": 0.2421891838312149, "acc": 0.9144479632377625, "length": 30.18754005432129, "mode": "test", "epoch": 55}
{"loss": 0.19836758077144623, "acc": 0.9297076463699341, "length": 29.522518157958984, "mode": "train", "epoch": 56}
{"loss": 0.25267505645751953, "acc": 0.9066648483276367, "length": 30.266366958618164, "mode": "test", "epoch": 56}
{"loss": 0.2441176027059555, "acc": 0.909980058670044, "length": 30.255329132080078, "mode": "train", "epoch": 57}
{"loss": 0.29300573468208313, "acc": 0.8889407515525818, "length": 30.57477569580078, "mode": "test", "epoch": 57}
{"loss": 0.25816890597343445, "acc": 0.9030939936637878, "length": 30.638986587524414, "mode": "train", "epoch": 58}
{"loss": 0.30421847105026245, "acc": 0.8788379430770874, "length": 30.985557556152344, "mode": "test", "epoch": 58}
{"loss": 0.28415530920028687, "acc": 0.8894652128219604, "length": 30.966894149780273, "mode": "train", "epoch": 59}
{"loss": 0.3194897770881653, "acc": 0.8691578507423401, "length": 30.991134643554688, "mode": "test", "epoch": 59}
{"loss": 0.2605975866317749, "acc": 0.9015232920646667, "length": 30.986328125, "mode": "train", "epoch": 60}
{"loss": 0.27829718589782715, "acc": 0.8948167562484741, "length": 30.97917938232422, "mode": "test", "epoch": 60}
test accuracy: 0.8745721578598022
